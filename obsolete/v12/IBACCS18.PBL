.------------------------------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  04.07.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from r5.09
.------------------------------------------------------------------------------
. V6.00.06  11.03.1996 B.G.Ackland
.           Copy Actuals Options
. V6.00.05  14.12.1993 B.G.Ackland
.           Exit on Screen 6
. V6.00.04  01.11.1993 B.G.Ackland
.           Change "Procedure" to Patient Service
. V6.00.03  27.09.1993 B.G.Ackland
.           New Program Generation Options
.------------------------------------------------------------------------------
RECCOUNT  FORM      8
.------------------------------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACCS18
.   Function      :   Costing Model Creation                  
.   Generated  On :   08/07/2002
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CCS18TDF    
          INC       CCSCALFD/INC
          INC       CCSCDTFD/INC
          INC       CCSCMAFD/INC
          INC       CCSCMBFD/INC
          INC       CCSCMCFD/INC
          INC       CCSCMDFD/INC
          INC       CCSCMEFD/INC
          INC       CCSCMFFD/INC
          INC       CCSCMNFD/INC
          INC       CCSCONFD/INC
          INC       CCSDCOFD/INC
          INC       CCSDPTFD/INC
          INC       CCSGILFD/INC
          INC       CCSGKMFD/INC
          INC       CCSGPFFD/INC
          INC       CCSPCDFD/INC
          INC       CCSPDPFD/INC
          INC       CCSPFKFD/INC
          INC       CCSPKYFD/INC
          INC       CCSPROFD/INC
          INC       CCSPSDFD/INC
          INC       CCSSDCFD/INC
.=========================
.Local Variable Definition
.-------------------------
.
.Word Processor File * Scr 01 Fld    11
.
NAMCCMN1  INIT      "Wccmn1"
FILCCMN1  DIM       8
.
LOADNAME  DIM      40 * Scr 02 Fld     3
FROMCMOD  DIM       4 * Scr 03 Fld     1
TOCMOD    DIM       4 * Scr 03 Fld     3
COPYYEAR  DIM       4 * Scr 07 Fld     6
TOYEAR    DIM       4 * Scr 07 Fld     7
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACCS18"
PRGNAM    INIT      "Costing Model Creation                  "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILCCMN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening ccscalaf";
          OPEN      CCSCALA1,"ccscalaf"
          DISPLAY   *P56:24,"Opening ccscalaf";
          OPEN      CCSCALA2,"ccscalaf"
          DISPLAY   *P56:24,"Opening ccscalaf";
          OPEN      CCSCALA3,"ccscalaf"
          DISPLAY   *P56:24,"Opening ccscdtaf";
          OPEN      CCSCDTA1,"ccscdtaf"
          DISPLAY   *P56:24,"Opening ccscmaaf";
          OPEN      CCSCMAA1,"ccscmaaf"
          DISPLAY   *P56:24,"Opening ccscmnaf";
          OPEN      CCSCMNA1,"ccscmnaf"
          DISPLAY   *P56:24,"Opening ccsdcoaf";
          OPEN      CCSDCOA1,"ccsdcoaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA1,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA2,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA3,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA4,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccsgilaf";
          OPEN      CCSGILA1,"ccsgilaf"
          DISPLAY   *P56:24,"Opening ccsgilaf";
          OPEN      CCSGILA2,"ccsgilaf"
          DISPLAY   *P56:24,"Opening ccsgkmaf";
          OPEN      CCSGKMA1,"ccsgkmaf"
          DISPLAY   *P56:24,"Opening ccsgkmaf";
          OPEN      CCSGKMA2,"ccsgkmaf"
          DISPLAY   *P56:24,"Opening ccsgpfaf";
          OPEN      CCSGPFA1,"ccsgpfaf"
          DISPLAY   *P56:24,"Opening ccspcdaf";
          OPEN      CCSPCDA1,"ccspcdaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA1,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA2,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA3,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA4,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspfkaf";
          OPEN      CCSPFKA1,"ccspfkaf"
          DISPLAY   *P56:24,"Opening ccspkyaf";
          OPEN      CCSPKYA1,"ccspkyaf"
          DISPLAY   *P56:24,"Opening ccspkyaf";
          OPEN      CCSPKYA2,"ccspkyaf"
          DISPLAY   *P56:24,"Opening ccsproaf";
          OPEN      CCSPROA1,"ccsproaf"
          DISPLAY   *P56:24,"Opening ccspsdaf";
          OPEN      CCSPSDA1,"ccspsdaf"
          DISPLAY   *P56:24,"Opening ccssdcaf";
          OPEN      CCSSDCA1,"ccssdcaf"
.--------------------------------------------------------
. Initialise Wp Filename for Notes                              
.--------------------------------------------------------
          PACK      FILCCMN1,NAMCCMN1,PORT
          REP       " 0",FILCCMN1
          DISPLAY   *P56:24,"Create & Open ",FILCCMN1;
          PREP      TEMPWORD,FILCCMN1
.
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Cost Model Creation Options        
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Create/Modify Cost Model Code      
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Load Department Costs              
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Copy Department Cost Model         
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Copy Patient Service Usage Model   
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * Load Patient Service Volumes       
          ENDIF
          MATCH     "06",SCRID
          IF         @EQUAL
            CALL       PS06L000   * Clear Volumes                      
          ENDIF
          MATCH     "07",SCRID
          IF         @EQUAL
            CALL       PS07L000   * Copy Actual Dept Costs             
          ENDIF
          MATCH     "08",SCRID
          IF         @EQUAL
            CALL       PS08L000   * Copy Patient Service Actuals       
          ENDIF
          RETURN
.--------------------------------
. Screen - Cost Model Creation Options        
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Cost Model Creation Options        
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Cost Model Creation Options        
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Cost Model Creation Options        
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Cost Model Creation Options        
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Cost Model Creation Options        
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Cost Model Creation Options        
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Cost Model Creation Options        
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L101,SF00L102,SF00L103,SF00L104:
                            SF00L105,SF00L106,SF00L107,SF00L108:
                            SF00L109,SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC04L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          CALL      SC05L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L106
          CALL      SC06L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L107
          CALL      SC07L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L108
          CALL      SC08L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L109
          MOVE      ZERO,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Create/Modify Cost Model Code      
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Create/Modify Cost Model Code      
.-------------------------------------------------------
CF01L000  COMPARE   ZERO,ACCEPT
              GOTO      CF01L999 IF EQUAL
          MOVE      SP70,CCMACOM 
          MOVE      SP70,CCMADES 
          MOVE      SP70,CCMAUR1 
          MOVE      SP70,CCMAUR2 
          MOVE      SP70,CCMAUD1 
          MOVE      SP70,CCMAUD2 
          MOVE      SP70,CCMAUC1 
          MOVE      SP70,CCMAUC2 
          MOVE      SP70,CCMAUY1 
          MOVE      SP70,CCMAUY2 
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Create/Modify Cost Model Code      
.--------------------------------------------------------
KY01L000
.
KY01L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      NCMOD000
          BRANCH    EXIT,KY01L900,KY01L900
          MOVE      OVRCD,ACCEPT
          MOVE      CCMACOM,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Create/Modify Cost Model Code      
.---------------------------------------------------------
WP01L000
          PREP     TEMPWORD,FILCCMN1
          PACK     KEY7,CCMACOM,SP70
          MOVE     KEY7,SAVKEY80
          SETLPTR  SAVKEY80,4 
          CALL      RDCCMN1 
          IF        OVRCD=0
            CALL      RPCCMN1 
          ENDIF
WP01L100
          CALL     RKCCMN1 
          BRANCH   OVRCD,WP01L105
          PACK     KEY7,CCMNCOM,CCMNLIN
          MATCH    SAVKEY80,KEY7    
          GOTO     WP01L105 IF NOT EQUAL
          PACK     VAR,CCMNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     CCMNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP01L100
WP01L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Create/Modify Cost Model Code      
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Create/Modify Cost Model Code      
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Create/Modify Cost Model Code      
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L101,PS01L102,PS01L103:
                            PS01L104,PS01L105,PS01L106,PS01L107:
                            PS01L108,PS01L109,PS01L110,PS01L999:
                            PS01L999,PS01L999,PS01L999
          GOTO     PS01L999
.
PS01L101
          MOVE      CCMADES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      CCMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      CCMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          UNPACK    CCMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          UNPACK    CCMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      CCMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      CCMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCMAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE     FILCCMN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Create/Modify Cost Model Code      
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L104,SF01L105,SF01L106,SF01L107:
                            SF01L108,SF01L109,SF01L110,SF01L111:
                            SF01L112,SF01L113,SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L101,SF01L102,SF01L103:
                            SF01L104,SF01L105,SF01L106,SF01L107:
                            SF01L108,SF01L109,SF01L110,SF01L020:
                            SF01L020,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          CALL     SELECTED
          STRIP     CCMADES 
          SFORMAT   VAR,SCPSLEN
          MOVE      CCMADES,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CCMADES 
          SFORMAT   VAR,127
          ENDSET    CCMADES 
          APPEND    SP70,CCMADES 
          RESET     CCMADES 
          CMATCH    EXITCHAR,CCMADES 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CCMADES 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L101
            ENDIF
          ENDIF
          MOVE      CCMADES,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L102
          CALL     SELECTED
          STRIP     CCMAUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      CCMAUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CCMAUR1 
          SFORMAT   VAR,127
          ENDSET    CCMAUR1 
          APPEND    SP70,CCMAUR1 
          RESET     CCMAUR1 
          CMATCH    EXITCHAR,CCMAUR1 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CCMAUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L102
            ENDIF
          ENDIF
          MOVE      CCMAUR1,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L103
          CALL     SELECTED
          STRIP     CCMAUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      CCMAUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CCMAUR2 
          SFORMAT   VAR,127
          ENDSET    CCMAUR2 
          APPEND    SP70,CCMAUR2 
          RESET     CCMAUR2 
          CMATCH    EXITCHAR,CCMAUR2 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CCMAUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L103
            ENDIF
          ENDIF
          MOVE      CCMAUR2,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L104
          CALL     SELECTED
          CALL      KEYDATE
          PACK      CCMAUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    CCMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L105
          CALL     SELECTED
          CALL      KEYDATE
          PACK      CCMAUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    CCMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L106
          CALL     SELECTED
          STRIP     CCMAUC1 
          SFORMAT   VAR,SCPSLEN
          MOVE      CCMAUC1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CCMAUC1 
          SFORMAT   VAR,127
          ENDSET    CCMAUC1 
          APPEND    SP70,CCMAUC1 
          RESET     CCMAUC1 
          CMATCH    EXITCHAR,CCMAUC1 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CCMAUC1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L106
            ENDIF
          ENDIF
          MOVE      CCMAUC1,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L107
          CALL     SELECTED
          STRIP     CCMAUC2 
          SFORMAT   VAR,SCPSLEN
          MOVE      CCMAUC2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CCMAUC2 
          SFORMAT   VAR,127
          ENDSET    CCMAUC2 
          APPEND    SP70,CCMAUC2 
          RESET     CCMAUC2 
          CMATCH    EXITCHAR,CCMAUC2 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CCMAUC2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L107
            ENDIF
          ENDIF
          MOVE      CCMAUC2,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L108
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CCMAUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCMAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L109
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CCMAUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L110
          CALL      NOWP0000
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 7",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "14",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILCCMN1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILCCMN1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          GOTO     SF01L001
.
SF01L111
          CALL      POST0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L112
          CALL      DELT0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L113
          MOVE      ONE,EXIT
          GOTO      SF01L999
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Load Department Costs              
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
          CALL      MVACCEPT
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Load Department Costs              
.-------------------------------------------------------
CF02L000  COMPARE   ZERO,ACCEPT
              GOTO      CF02L999 IF EQUAL
          MOVE      SP70,CCCAPER 
          MOVE      SP70,LOADNAME
          MOVE      SP70,CCCADES 
          MOVE      SP70,CCCAFDT 
          MOVE      SP70,CCCATDT 
          MOVE      SP70,CCCAYEAR
          MOVE      SP70,CCMACOM 
          MOVE      SP70,CCMADES 
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Load Department Costs              
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Load Department Costs              
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Load Department Costs              
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Load Department Costs              
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Load Department Costs              
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L101,PS02L102,PS02L999:
                            PS02L999,PS02L103,PS02L104,PS02L105:
                            PS02L999,PS02L106,PS02L107,PS02L108
          GOTO     PS02L999
.
PS02L101
          MOVE      CCCAPER,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      LOADNAME,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      CCCADES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          UNPACK    CCCAFDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          UNPACK    CCCATDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      CCCAYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      CCMACOM,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      CCMADES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Load Department Costs              
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102,SF02L103:
                            SF02L104,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L105,SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L101,SF02L102,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L105,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCCADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCCAFDT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCCATDT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCCAYEAR
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EPERD000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L101
            ENDIF
            BRANCH    EXIT,SF02L101,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      CCCAPER,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCCADES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            UNPACK    CCCAFDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            UNPACK    CCCATDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCCAYEAR,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L102
          CALL     SELECTED
          STRIP     LOADNAME
          SFORMAT   VAR,SCPSLEN
          MOVE      LOADNAME,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,LOADNAME
          SFORMAT   VAR,127
          ENDSET    LOADNAME
          APPEND    SP70,LOADNAME
          RESET     LOADNAME
          CMATCH    EXITCHAR,LOADNAME
          GOTO      SF02L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,LOADNAME
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L102
            ENDIF
          ENDIF
          MOVE      LOADNAME,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L103
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L104
          CALL      LOAD0000
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L105
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECMOD000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L105
            ENDIF
            BRANCH    EXIT,SF02L105,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      CCMACOM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCMADES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
SF02L990  MOVE      FOUR,EXIT * Exit Char Exit
SF02L999  RETURN
.--------------------------------
. Screen - Copy Department Cost Model         
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "14",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC03L200
          CALL      CF03L000 * Clear Fields
          CALL      MVACCEPT
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Copy Department Cost Model         
.-------------------------------------------------------
CF03L000
          MOVE      SP70,FROMCMOD
          MOVE      SP70,CCMADES 
          MOVE      SP70,TOCMOD  
          MOVE      SP70,CCMADES 
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Copy Department Cost Model         
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Copy Department Cost Model         
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Copy Department Cost Model         
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Copy Department Cost Model         
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Copy Department Cost Model         
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L101,PS03L102,PS03L103,PS03L104:
                            PS03L999,PS03L999,PS03L999
          GOTO     PS03L999
.
PS03L101
          MOVE      FROMCMOD,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      CCMADES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      TOCMOD,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      CCMADES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Copy Department Cost Model         
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L101,SF03L006,SF03L102,SF03L006:
                            SF03L006,SF03L103,SF03L104
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L101,SF03L020,SF03L102,SF03L020:
                            SF03L020,SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCCMAA00
          MOVE      CCMACOM,FROMCMOD
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L101
            ENDIF
            BRANCH    EXIT,SF03L101,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      FROMCMOD,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCMADES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L102
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCCMAA00
          MOVE      CCMACOM,TOCMOD
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L102
            ENDIF
            BRANCH    EXIT,SF03L102,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      TOCMOD,VAR       
          CALL      DISPITEM
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCMADES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L103
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      CDEP0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF03L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF03L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF03L999
          ENDIF
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF03L000
          ENDIF
          GOTO      SF03L001
SF03L990  MOVE      FOUR,EXIT * Exit Char Exit
SF03L999  RETURN
.--------------------------------
. Screen - Copy Patient Service Usage Model   
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "14",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC04L200
          CALL      CF04L000 * Clear Fields
          CALL      MVACCEPT
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Copy Patient Service Usage Model   
.-------------------------------------------------------
CF04L000
          MOVE      SP70,FROMCMOD
          MOVE      SP70,TOCMOD  
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Copy Patient Service Usage Model   
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Copy Patient Service Usage Model   
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Copy Patient Service Usage Model   
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Copy Patient Service Usage Model   
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Copy Patient Service Usage Model   
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L101,PS04L102,PS04L103,PS04L104:
                            PS04L999,PS04L999,PS04L999
          GOTO     PS04L999
.
PS04L101
          MOVE      FROMCMOD,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      CCMADES,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      TOCMOD,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L104
          MOVE      CCMADES,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Copy Patient Service Usage Model   
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L101,SF04L006,SF04L102,SF04L006:
                            SF04L006,SF04L103,SF04L104
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L101,SF04L020,SF04L102,SF04L020:
                            SF04L020,SF04L020,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCCMAA00
          MOVE      CCMACOM,FROMCMOD
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L101
            ENDIF
            BRANCH    EXIT,SF04L101,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      FROMCMOD,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCMADES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
.
SF04L102
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCCMAA00
          MOVE      CCMACOM,TOCMOD
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L102
            ENDIF
            BRANCH    EXIT,SF04L102,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      TOCMOD,VAR       
          CALL      DISPITEM
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCMADES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
.
SF04L103
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      CPRO0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF04L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF04L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF04L999
          ENDIF
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF04L000
          ENDIF
          GOTO      SF04L001
SF04L990  MOVE      FOUR,EXIT * Exit Char Exit
SF04L999  RETURN
.--------------------------------
. Screen - Load Patient Service Volumes       
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC05L200
          CALL      CF05L000 * Clear Fields
          CALL      MVACCEPT
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Load Patient Service Volumes       
.-------------------------------------------------------
CF05L000
          MOVE      SP70,CCMACOM 
          MOVE      SP70,LOADNAME
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Load Patient Service Volumes       
.--------------------------------------------------------
KY05L000
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : Load Patient Service Volumes       
.---------------------------------------------------------
WP05L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Load Patient Service Volumes       
.---------------------------------------------------------
LM05L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Load Patient Service Volumes       
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Load Patient Service Volumes       
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L999,PS05L999,PS05L999,PS05L101:
                            PS05L102,PS05L999,PS05L103,PS05L104
          GOTO     PS05L999
.
PS05L101
          MOVE      CCMACOM,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L102
          MOVE      LOADNAME,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L103
          MOVE      CCMADES,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L104
          MOVE      CCCOYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : Load Patient Service Volumes       
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L006,SF05L101,SF05L102,SF05L103:
                            SF05L104,SF05L006,SF05L006,SF05L006
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L020,SF05L020,SF05L020,SF05L103:
                            SF05L104,SF05L020,SF05L020,SF05L020
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          GOTO     SF05L001
.
SF05L101
          MOVE      ZERO,EXIT
          GOTO      SF05L999
.
SF05L102
          CALL      PLOD0000
          MOVE      ZERO,EXIT
          GOTO      SF05L999
.
SF05L103
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCCOYEAR
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECMOD000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L103
            ENDIF
            BRANCH    EXIT,SF05L103,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      CCMACOM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCMADES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCCOYEAR,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF05L001
.
SF05L104
          CALL     SELECTED
          STRIP     LOADNAME
          SFORMAT   VAR,SCPSLEN
          MOVE      LOADNAME,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,LOADNAME
          SFORMAT   VAR,127
          ENDSET    LOADNAME
          APPEND    SP70,LOADNAME
          RESET     LOADNAME
          CMATCH    EXITCHAR,LOADNAME
          GOTO      SF05L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,LOADNAME
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L104
            ENDIF
          ENDIF
          MOVE      LOADNAME,VAR     
          CALL      DISPITEM
          GOTO     SF05L001
SF05L990  MOVE      FOUR,EXIT * Exit Char Exit
SF05L999  RETURN
.--------------------------------
. Screen - Clear Volumes                      
.--------------------------------
SC06L000
SC06L100
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC06L200
          CALL      CF06L000 * Clear Fields
          CALL      MVACCEPT
SC06L300
          CALL      KY06L000 * Enter Key Fields
          BRANCH    EXIT,SC06L999,SC06L999
SC06L400
          CALL      WP06L000 * Load any WP Details
SC06L500
          CALL      LM06L000 * Load any Batch Details
SC06L600
          CALL      DF06L000 * Display Fields
SC06L700
          CALL      SF06L000 * Select Fields
          BRANCH    EXIT,SC06L100,SC06L100,SC06L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC06L800
SC06L900
SC06L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Clear Volumes                      
.-------------------------------------------------------
CF06L000
          MOVE      SP70,CCMACOM 
          MOVE      SP70,CCCAPER 
          MOVE      SP70,CCMADES 
          MOVE      SP70,CCCOYEAR
          MOVE      SP70,CCCADES 
CF06L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Clear Volumes                      
.--------------------------------------------------------
KY06L000
          MOVE      ZERO,EXIT
          GOTO      KY06L999
.
KY06L900  MOVE      ONE,EXIT
KY06L999  RETURN
.---------------------------------------------------------
. Load WP files for : Clear Volumes                      
.---------------------------------------------------------
WP06L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Clear Volumes                      
.---------------------------------------------------------
LM06L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Clear Volumes                      
.---------------------------------------------------------
DF06L000
          BRANCH   ACCEPT,DF06L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF06L900
          MATCH    PRGID,SCPSPID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF06L010 IF NOT EQUAL
.
          CALL     PS06L000 * Display Field
          GOTO     DF06L010
DF06L900
DF06L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Clear Volumes                      
.---------------------------------------------------------
PS06L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS06L999,PS06L999,PS06L999,PS06L101:
                            PS06L102,PS06L999,PS06L103,PS06L104:
                            PS06L105
          GOTO     PS06L999
.
PS06L101
          MOVE      CCMACOM,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L102
          MOVE      CCCAPER,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L103
          MOVE      CCMADES,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L104
          MOVE      CCCOYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L105
          MOVE      CCCADES,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
PS06L999
          RETURN
.---------------------------------------------------------
. Selections for : Clear Volumes                      
.---------------------------------------------------------
SF06L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF06L001  BRANCH   ACCEPT,SF06L020
.
SF06L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L006,SF06L101,SF06L102,SF06L103:
                            SF06L104,SF06L006,SF06L006,SF06L006:
                            SF06L006
SF06L006  BEEP
          GOTO     SF06L005
SF06L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF06L090
          MATCH    PRGID,SCSLPID
          GOTO     SF06L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF06L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L020,SF06L020,SF06L020,SF06L103:
                            SF06L104,SF06L020,SF06L020,SF06L020:
                            SF06L020
          GOTO     SF06L020
SF06L090  MOVE     ZERO,ACCEPT
          GOTO     SF06L001
.
SF06L101
          MOVE      ZERO,EXIT
          GOTO      SF06L999
.
SF06L102
          CALL      CLRPR000
          MOVE      ZERO,EXIT
          GOTO      SF06L999
.
SF06L103
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCCOYEAR
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECMOD000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF06L103
            ENDIF
            BRANCH    EXIT,SF06L103,SF06L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF06L990 IF EQUAL
          ENDIF
          MOVE      CCMACOM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCMADES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCCOYEAR,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF06L001
.
SF06L104
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCCADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KPERD000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF06L104
            ENDIF
            BRANCH    EXIT,SF06L104,SF06L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF06L990 IF EQUAL
          ENDIF
          MOVE      CCCAPER,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCCADES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF06L001
SF06L990  MOVE      FOUR,EXIT * Exit Char Exit
SF06L999  RETURN
.--------------------------------
. Screen - Copy Actual Dept Costs             
.--------------------------------
SC07L000
SC07L100
          MOVE      "07",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC07L200
          CALL      CF07L000 * Clear Fields
          CALL      MVACCEPT
SC07L300
          CALL      KY07L000 * Enter Key Fields
          BRANCH    EXIT,SC07L999,SC07L999
SC07L400
          CALL      WP07L000 * Load any WP Details
SC07L500
          CALL      LM07L000 * Load any Batch Details
SC07L600
          CALL      DF07L000 * Display Fields
SC07L700
          CALL      SF07L000 * Select Fields
          BRANCH    EXIT,SC07L100,SC07L100,SC07L200
SC07L800
SC07L900
SC07L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Copy Actual Dept Costs             
.-------------------------------------------------------
CF07L000
          MOVE      SP70,CCMACOM 
          MOVE      SP70,CCMADES 
          MOVE      SP70,COPYYEAR
          MOVE      SP70,TOYEAR  
CF07L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Copy Actual Dept Costs             
.--------------------------------------------------------
KY07L000
          MOVE      ZERO,EXIT
          GOTO      KY07L999
.
KY07L900  MOVE      ONE,EXIT
KY07L999  RETURN
.---------------------------------------------------------
. Load WP files for : Copy Actual Dept Costs             
.---------------------------------------------------------
WP07L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Copy Actual Dept Costs             
.---------------------------------------------------------
LM07L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Copy Actual Dept Costs             
.---------------------------------------------------------
DF07L000
          BRANCH   ACCEPT,DF07L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF07L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF07L900
          MATCH    PRGID,SCPSPID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF07L010 IF NOT EQUAL
.
          CALL     PS07L000 * Display Field
          GOTO     DF07L010
DF07L900
DF07L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Copy Actual Dept Costs             
.---------------------------------------------------------
PS07L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS07L999,PS07L999,PS07L999,PS07L101:
                            PS07L102,PS07L103,PS07L104
          GOTO     PS07L999
.
PS07L101
          MOVE      CCMACOM,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L102
          MOVE      CCMADES,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L103
          MOVE      COPYYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L104
          MOVE      TOYEAR,VAR       
          CALL      DISPITEM
          GOTO     PS07L999
PS07L999
          RETURN
.---------------------------------------------------------
. Selections for : Copy Actual Dept Costs             
.---------------------------------------------------------
SF07L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF07L001  BRANCH   ACCEPT,SF07L020
.
SF07L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L006,SF07L101,SF07L102,SF07L103:
                            SF07L006,SF07L104,SF07L105
SF07L006  BEEP
          GOTO     SF07L005
SF07L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF07L090
          MATCH    PRGID,SCSLPID
          GOTO     SF07L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF07L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L020,SF07L020,SF07L020,SF07L103:
                            SF07L020,SF07L104,SF07L105
          GOTO     SF07L020
SF07L090  MOVE     ZERO,ACCEPT
          GOTO     SF07L001
.
SF07L101
          MOVE      ZERO,EXIT
          GOTO      SF07L999
.
SF07L102
          CALL      CDAC0000
          MOVE      ZERO,EXIT
          GOTO      SF07L999
.
SF07L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECMOD000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF07L103
            ENDIF
            BRANCH    EXIT,SF07L103,SF07L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF07L990 IF EQUAL
          ENDIF
          MOVE      CCMACOM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCMADES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF07L001
.
SF07L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCCCAB00
          MOVE      CCCAYEAR,COPYYEAR
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF07L104
            ENDIF
            BRANCH    EXIT,SF07L104,SF07L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF07L990 IF EQUAL
          ENDIF
          MOVE      COPYYEAR,VAR     
          CALL      DISPITEM
          GOTO     SF07L001
.
SF07L105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCCCAB00
          MOVE      CCCAYEAR,TOYEAR
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF07L105
            ENDIF
            BRANCH    EXIT,SF07L105,SF07L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF07L990 IF EQUAL
          ENDIF
          MOVE      TOYEAR,VAR       
          CALL      DISPITEM
          GOTO     SF07L001
SF07L990  MOVE      ONE,EXIT * Exit Char Restart
SF07L999  RETURN
.--------------------------------
. Screen - Copy Patient Service Actuals       
.--------------------------------
SC08L000
SC08L100
          MOVE      "08",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC08L200
          CALL      CF08L000 * Clear Fields
          CALL      MVACCEPT
SC08L300
          CALL      KY08L000 * Enter Key Fields
          BRANCH    EXIT,SC08L999,SC08L999
SC08L400
          CALL      WP08L000 * Load any WP Details
SC08L500
          CALL      LM08L000 * Load any Batch Details
SC08L600
          CALL      DF08L000 * Display Fields
SC08L700
          CALL      SF08L000 * Select Fields
          BRANCH    EXIT,SC08L100,SC08L100,SC08L200
SC08L800
SC08L900
SC08L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Copy Patient Service Actuals       
.-------------------------------------------------------
CF08L000
          MOVE      SP70,CCMACOM 
          MOVE      SP70,CCMADES 
          MOVE      SP70,COPYYEAR
          MOVE      SP70,TOYEAR  
CF08L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Copy Patient Service Actuals       
.--------------------------------------------------------
KY08L000
          MOVE      ZERO,EXIT
          GOTO      KY08L999
.
KY08L900  MOVE      ONE,EXIT
KY08L999  RETURN
.---------------------------------------------------------
. Load WP files for : Copy Patient Service Actuals       
.---------------------------------------------------------
WP08L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Copy Patient Service Actuals       
.---------------------------------------------------------
LM08L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Copy Patient Service Actuals       
.---------------------------------------------------------
DF08L000
          BRANCH   ACCEPT,DF08L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF08L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF08L900
          MATCH    PRGID,SCPSPID
          GOTO     DF08L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF08L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF08L010 IF NOT EQUAL
.
          CALL     PS08L000 * Display Field
          GOTO     DF08L010
DF08L900
DF08L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Copy Patient Service Actuals       
.---------------------------------------------------------
PS08L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS08L999,PS08L999,PS08L999,PS08L101:
                            PS08L102,PS08L103,PS08L104
          GOTO     PS08L999
.
PS08L101
          MOVE      CCMACOM,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L102
          MOVE      CCMADES,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L103
          MOVE      COPYYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L104
          MOVE      TOYEAR,VAR       
          CALL      DISPITEM
          GOTO     PS08L999
PS08L999
          RETURN
.---------------------------------------------------------
. Selections for : Copy Patient Service Actuals       
.---------------------------------------------------------
SF08L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF08L001  BRANCH   ACCEPT,SF08L020
.
SF08L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF08L006,SF08L101,SF08L102,SF08L103:
                            SF08L006,SF08L104,SF08L105
SF08L006  BEEP
          GOTO     SF08L005
SF08L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF08L090
          MATCH    PRGID,SCSLPID
          GOTO     SF08L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF08L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF08L020,SF08L020,SF08L020,SF08L103:
                            SF08L020,SF08L104,SF08L105
          GOTO     SF08L020
SF08L090  MOVE     ZERO,ACCEPT
          GOTO     SF08L001
.
SF08L101
          MOVE      ZERO,EXIT
          GOTO      SF08L999
.
SF08L102
          CALL      CPAC0000
          MOVE      ZERO,EXIT
          GOTO      SF08L999
.
SF08L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECMOD000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF08L103
            ENDIF
            BRANCH    EXIT,SF08L103,SF08L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF08L990 IF EQUAL
          ENDIF
          MOVE      CCMACOM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCMADES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF08L001
.
SF08L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCCCAB00
          MOVE      CCCAYEAR,COPYYEAR
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF08L104
            ENDIF
            BRANCH    EXIT,SF08L104,SF08L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF08L990 IF EQUAL
          ENDIF
          MOVE      COPYYEAR,VAR     
          CALL      DISPITEM
          GOTO     SF08L001
.
SF08L105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCCCAB00
          MOVE      CCCAYEAR,TOYEAR
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF08L105
            ENDIF
            BRANCH    EXIT,SF08L105,SF08L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF08L990 IF EQUAL
          ENDIF
          MOVE      TOYEAR,VAR       
          CALL      DISPITEM
          GOTO     SF08L001
SF08L990  MOVE      ONE,EXIT * Exit Char Restart
SF08L999  RETURN
.@@@@@ Function Restart Point @@@@@

NOWP0000  IF       ACCEPT=1
            PREP    TEMPWORD,FILCCMN1
            CLOSE   TEMPWORD
            CALL    SELECTED
            IF      EXIT=0
              MOVE     FILCCMN1,WORDNAME
              CALL     DISPWORD
            ENDIF
            MOVE    "99999",SCSLITM
          ENDIF
          RETURN
NCMOD000  MOVE      TWO,CKEYTYP
          CALL      KCCMAA00
          BRANCH    EXIT,NCMOD999,NCMOD999
.
          IF        OVRCD=1
            REP       UPPLOW,CCMACOM
          ENDIF
.
NCMOD999  RETURN
POST0000  PACK     KEY4,CCMACOM
          CALL     RACCMA1
          IF       OVRCD=0
            CALL     UPCCMA1
            GOTO     POST1000
          ENDIF
.
          MOVE     "ccmb",KEY4
          PACK     FILENAME,KEY4,CCMACOM
          REP      " 0",FILENAME
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     CCSCMBA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=1
            PACK     COMMAND,SGENISB,FILENAME,CCMBIDX
            EXECUTE  COMMAND,TASKID
            MOVE     ZERO,OVRCD
            TRAP     OVERCOND IF IO
            OPEN     CCSCMBA1,FILENAME
            TRAPCLR  IO
            IF       OVRCD=1
              BEEP
              MOVE     "Unable to Create Costing Model Files - ",DISPMSG
              CALL     MESSAGE1
              GOTO     POST9999
            ENDIF
          ENDIF
          CLOSE    CCSCMBA1
          CALL     WRCCMA1
.
          MOVE     "ccmc",KEY4
          PACK     FILENAME,KEY4,CCMACOM
          REP      " 0",FILENAME
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     CCSCMCA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=1
            PACK     COMMAND,SGENISB,FILENAME,CCMCIDX
            EXECUTE  COMMAND,TASKID
          ELSE
            CLOSE    CCSCMCA1
          ENDIF
.
          MOVE     "ccmd",KEY4
          PACK     FILENAME,KEY4,CCMACOM
          REP      " 0",FILENAME
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     CCSCMDA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=1
            PACK     COMMAND,SGENISB,FILENAME,CCMDIDX
            EXECUTE  COMMAND,TASKID
          ELSE
            CLOSE    CCSCMDA1
          ENDIF
.
          MOVE     "ccme",KEY4
          PACK     FILENAME,KEY4,CCMACOM
          REP      " 0",FILENAME
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     CCSCMEA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=1
            PACK     COMMAND,SGENISB,FILENAME,CCMEIDX
            EXECUTE  COMMAND,TASKID
          ELSE
            CLOSE    CCSCMEA1
          ENDIF
.
          MOVE     "ccmf",KEY4
          PACK     FILENAME,KEY4,CCMACOM
          REP      " 0",FILENAME
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     CCSCMFA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=1
            PACK     COMMAND,SGENISB,FILENAME,CCMFIDX1
            EXECUTE  COMMAND,TASKID
            CLEAR    COMMAND
            APPEND   "isadd ",COMMAND
            APPEND   FILENAME,COMMAND
            APPEND   CCMFIDX2,COMMAND
            RESET    COMMAND
            EXECUTE  COMMAND,TASKID
          ELSE
            CLOSE    CCSCMFA1
          ENDIF
.
. Save Notes
.-----------
POST1000  PACK      KEY7,CCMACOM,SP70
          CALL      RSCCMN1
POST1100  CALL      RKCCMN1
          BRANCH    OVRCD,POST1190
          MATCH     CCMNCOM,CCMACOM
          GOTO      POST1190 IF NOT EQUAL
          PACK      KEY7,CCMNCOM,CCMNLIN
          CALL      DECCMN1
          GOTO      POST1100
.
POST1190  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILCCMN1
          TRAPCLR   IO
          BRANCH    OVRCD,POST9999
          MOVE      ZERO,F3
POST1200  READ      TEMPWORD,SEQ;CCMNDAT
          GOTO      POST9999 IF OVER
          MOVE      F3,CCMNLIN
          PACK      KEY7,CCMACOM,CCMNLIN
          UNPACK    KEY7,CCMNCOM,CCMNLIN
          CALL      WRCCMN1
          ADD       ONE,F3
          GOTO      POST1200
.
POST9999  RETURN
DELT0000  MOVE     SP70,DISPMSG
          CALL     MESSAGE2
          CALL     DELQST
          CALL     MESSAGE3
          BRANCH   CEXIT,DELT1000,DELT9000,DELT9100
.
DELT1000  PACK     KEY4,CCMACOM
          CALL     RACCMA1
          IF       OVRCD=0
            CALL     DECCMA1
          ENDIF
          PACK     KEY7,CCMACOM,SP70
          CALL     RSCCMN1
.
DELT1100  CALL     RKCCMN1
          BRANCH   OVRCD,DELT1200
          MATCH    CCMACOM,CCMNCOM
          GOTO     DELT1200 IF NOT EQUAL
          PACK     KEY7,CCMNCOM,CCMNLIN
          CALL     DECCMN1
          GOTO     DELT1100
.
DELT1200  CALL     MESSAGE2
          MOVE     "39",CCOL
          MOVE     "24",CVERT
          DISPLAY  *P1:24,*EL,"Erase Costing Model Files Now (":
                   *V2LON,"Y",*HOFF,"/",*V2LON,"N",*HOFF,") ? "
          CALL     YORN0000
          CALL     MESSAGE3
          IF       FYESNO=1
            MOVE     "ccmb",KEY4
            PACK     FILENAME,KEY4,CCMACOM
            REP      " 0",FILENAME
            OPEN     CCSCMBA1,FILENAME
            CLOSE    CCSCMBA1,DELETE
.
            MOVE     "ccmc",KEY4
            PACK     FILENAME,KEY4,CCMACOM
            REP      " 0",FILENAME
            OPEN     CCSCMCA1,FILENAME
            CLOSE    CCSCMCA1,DELETE
.
            MOVE     "ccmd",KEY4
            PACK     FILENAME,KEY4,CCMACOM
            REP      " 0",FILENAME
            OPEN     CCSCMDA1,FILENAME
            CLOSE    CCSCMDA1,DELETE
.
            MOVE     "ccme",KEY4
            PACK     FILENAME,KEY4,CCMACOM
            REP      " 0",FILENAME
            OPEN     CCSCMEA1,FILENAME
            CLOSE    CCSCMEA1,DELETE
.
            MOVE     "ccmf",KEY4
            PACK     FILENAME,KEY4,CCMACOM
            REP      " 0",FILENAME
            OPEN     CCSCMFA1,FILENAME
            CLOSE    CCSCMFA1,DELETE
          ENDIF
.
          MOVE     TWO,EXIT
          GOTO     DELT9999
DELT9000  MOVE     ONE,EXIT
          GOTO     DELT9999
DELT9100  MOVE     TWO,EXIT
          GOTO     DELT9999
DELT9999  RETURN
.----------------------------------------
. Move one to accept to for insert mode
.----------------------------------------
MVACCEPT  MOVE      ONE,ACCEPT
          RETURN
.------------------------------------------------------------
. Enter Period to Load Blank for Annual Amounts
.------------------------------------------------------------
EPERD000  MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;CCCOYEAR,CCCOPER,CCCODIR
          MOVE      CCCOYEAR,CCCAYEAR
          CALL      KCCCAA00
          BRANCH    EXIT,EPERD000,EPERD999
          GOTO      EPERD999
.
EPERD999  RETURN
.----------------------------------------
. Load General Ledger Costs
.----------------------------------------
LOAD0000  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          DISPLAY   *P1:24,*EL,"Checking Load File :"
          STRIP     LOADNAME
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCSTMPAF,LOADNAME
          TRAPCLR   IO
          BRANCH    OVRCD,LOAG9000
.
. Check Format of File
.----------------------
LOAD1000  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CCSTMPAF,SEQ;CCGKKEY,CCTMTOT
          GOTO      LOAD2000 IF OVER
          TRAPCLR   FORMAT
          BRANCH    OVRCD,LOAD9500
          DISPLAY   *P30:24,CCGKKEY
          GOTO      LOAD1000
.
. Clear Current Costs
.---------------------
LOAD2000  CALL      CLRDC000        * Clear Department Costs
          OPEN      CCSTMPAF,LOADNAME
          DISPLAY   *P1:24,*EL,"Loading Period Costs :"
.
. Create file to Store Left overs (Rounding Errors)
.---------------------------------------------------
          PACK      REMFNAME,REMDFILE,CCCAYEAR,CCCAPER
          REP       " 0",REMFNAME
          PREP      CCSREMAF,REMFNAME
.
. Load Costs from Tempory File
.------------------------------
LOAD3000  READ      CCSTMPAF,SEQ;CCGKKEY,CCTMTOT
          GOTO      LOAD6000 IF OVER
          MOVE      CCTMTOT,CCTMREM
.
          PACK      KEY34,CCGKKEY,SP70
          CALL      RSCCGI1
LOAD4000  CALL      RKCCGI1
          BRANCH    OVRCD,LOAD5000
          MATCH     CCGIKEY,CCGKKEY
          GOTO      LOAD5000 IF NOT EQUAL
.
          DISPLAY   *P30:24,CCGKKEY,CCGIHCD,CCGIDPT
          ASSIGN    CCGIPER*CCTMTOT,CCTMAMT
          SUB       CCTMAMT,CCTMREM
.
          PACK      KEY20,CCGIHCD,CCGIDPT,CCCAYEAR,CCCAPER,CCGICTY
          CALL      RDCCMB1
          IF        OVRCD=0
            ADD       CCTMAMT,CCMBDIR
            CALL      UPCCMB1
          ELSE
            UNPACK    KEY20,CCMBHCD,CCMBDPT,CCMBYEAR,CCMBPER,CCMBCTY
            MOVE      ZERO,CCMBFLX
            MOVE      ZERO,CCMBIND
            MOVE      CCTMAMT,CCMBDIR
            CALL      WRCCMB1
          ENDIF
          GOTO      LOAD4000
.
LOAD5000  IF        !(CCTMREM=0)
            WRITE     CCSREMAF,SEQ;CCGKKEY,CCTMREM  * Save Remainder
          ENDIF
          GOTO      LOAD3000
.
. Complete
.---------------------
LOAD6000
          CALL      MESSAGE3
          MOVE      "Load Complete. - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          MOVE      "Run Cost Allocation to Update Summary Files.- ",DISPMSG
          BEEP
          CALL      MESSAGE1
          GOTO      LOAD9999
.
LOAG9000  CALL      MESSAGE3
          BEEP
          MOVE      "File Not Found. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      LOAD9999
.
LOAD9500  CALL      MESSAGE3
          BEEP
          MOVE      "File Format Incorrect. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      LOAD9999
.
LOAD9999  RETURN
.------------------------------------------------------------
. Clear Detail Level Costs for a Month
.------------------------------------------------------------
CLRDC000  DISPLAY   *P1:24,*EL,"Clearing Department Costs :"
          PACK      KEY10,SP70
          CALL      RSCCDP1
CLRDC100  CALL      RKCCDP1
          BRANCH    OVRCD,CLRDC999
.
          DISPLAY   *P28:24,CCDPHCD,"/",CCDPDPT
          PACK      KEY16,CCDPHCD,CCDPDPT,CCCAYEAR,CCCAPER,SP70
          PACK      KEY20,CCDPHCD,CCDPDPT,CCCAYEAR,CCCAPER,SP70
          CALL      RSCCMB1
CLRDC200  CALL      RKCCMB1
          BRANCH    OVRCD,CLRDC100
          PACK      KEY20,CCMBHCD,CCMBDPT,CCMBYEAR,CCMBPER,SP70
          MATCH     KEY16,KEY20
          GOTO      CLRDC100 IF NOT EQUAL
          MOVE      ZERO,CCMBFLX
          MOVE      ZERO,CCMBDIR
          MOVE      ZERO,CCMBIND
          CALL      UPCCMB1
          GOTO      CLRDC200
.
CLRDC999  RETURN
ECMOD000  MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;CCCOYEAR,CCCOPER,CCCODIR
          MOVE      CCCOYEAR,CCCAYEAR
          MOVE      ZERO,CKEYTYP
          CALL      CCSMOPCL    * Close Model
          CALL      KCCMAA00
          BRANCH    EXIT,ECMOD000,ECMOD999
.
          CALL      CCSMOPOP    * Open Model
          IF        EXIT=1
            MOVE      "Unable to Open Cost Model Files. - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      ECMOD000
          ENDIF
          GOTO      ECMOD999
.
ECMOD999  RETURN

.----------------------------------------
. Copy Departmental Cost Model
.----------------------------------------
CDEP0000  MATCH     FROMCMOD,TOCMOD
          IF        @EQUAL
            BEEP
            MOVE      "From and to Models the Same. Copy Invalid - ",DISPMSG
            CALL      MESSAGE1
            MOVE      ONE,EXIT
            GOTO      CDEP9999
          ENDIF
.
          MOVE      "cp",KEY2
.
          MOVE      " ccmb",KEY5
          MOVE      ".dat",KEY4
          PACK      COMMAND,KEY2,KEY5,FROMCMOD,KEY4,KEY5,TOCMOD,KEY4
          DISPLAY   *P1:3;
          EXECUTE   COMMAND,TASKID
.
          MOVE      ".idx",KEY4
          PACK      COMMAND,KEY2,KEY5,FROMCMOD,KEY4,KEY5,TOCMOD,KEY4
          DISPLAY   *P1:4;
          EXECUTE   COMMAND,TASKID
.
          MOVE      " ccmc",KEY5
          MOVE      ".dat",KEY4
          PACK      COMMAND,KEY2,KEY5,FROMCMOD,KEY4,KEY5,TOCMOD,KEY4
          DISPLAY   *P1:5;
          EXECUTE   COMMAND,TASKID
.
          MOVE      ".idx",KEY4
          PACK      COMMAND,KEY2,KEY5,FROMCMOD,KEY4,KEY5,TOCMOD,KEY4
          DISPLAY   *P1:6;
          EXECUTE   COMMAND,TASKID
.
          MOVE      " ccmf",KEY5
          MOVE      ".dat",KEY4
          PACK      COMMAND,KEY2,KEY5,FROMCMOD,KEY4,KEY5,TOCMOD,KEY4
          DISPLAY   *P1:7;
          EXECUTE   COMMAND,TASKID
.
          MOVE      ".idx",KEY4
          PACK      COMMAND,KEY2,KEY5,FROMCMOD,KEY4,KEY5,TOCMOD,KEY4
          DISPLAY   *P1:8;
          EXECUTE   COMMAND,TASKID
.
          MOVE      "Copy Complete. - ",DISPMSG
          CALL      MESSAGE1
          MOVE      ZERO,EXIT
          GOTO      CDEP9999
.
CDEP9999  RETURN
.----------------------------------------
. Copy Departmental Cost Model
.----------------------------------------
CPRO0000  MATCH     FROMCMOD,TOCMOD
          IF        @EQUAL
            BEEP
            MOVE      "From and to Models the Same. Copy Invalid - ",DISPMSG
            CALL      MESSAGE1
            MOVE      ONE,EXIT
            GOTO      CPRO9999
          ENDIF
.
          MOVE      "cp",KEY2
.
          MOVE      " ccmd",KEY5
          MOVE      ".dat",KEY4
          PACK      COMMAND,KEY2,KEY5,FROMCMOD,KEY4,KEY5,TOCMOD,KEY4
          DISPLAY   *P1:3;
          EXECUTE   COMMAND,TASKID
.
          MOVE      ".idx",KEY4
          PACK      COMMAND,KEY2,KEY5,FROMCMOD,KEY4,KEY5,TOCMOD,KEY4
          DISPLAY   *P1:4;
          EXECUTE   COMMAND,TASKID
.
          MOVE      " ccme",KEY5
          MOVE      ".dat",KEY4
          PACK      COMMAND,KEY2,KEY5,FROMCMOD,KEY4,KEY5,TOCMOD,KEY4
          DISPLAY   *P1:5;
          EXECUTE   COMMAND,TASKID
.
          MOVE      ".idx",KEY4
          PACK      COMMAND,KEY2,KEY5,FROMCMOD,KEY4,KEY5,TOCMOD,KEY4
          DISPLAY   *P1:6;
          EXECUTE   COMMAND,TASKID
.
          MOVE      "Copy Complete. - ",DISPMSG
          CALL      MESSAGE1
          MOVE      ZERO,EXIT
          GOTO      CPRO9999
.
CPRO9999  RETURN
DEFAULTN    MOVE     ANSN,DEFYESNO
            RETURN
.----------------------------------------
. Load Interface Volume Budget File
.----------------------------------------
PLOD0000  CALL     CHECK000   * Check File is od Correct Format
          BRANCH   EXIT,PLOD9999
.
          CALL     SCANU000    * Scan Utilisation
          DISPLAY  *P1:24,"Load Complete - ";
          CALL     HITENTER
.
PLOD9999  RETURN
.
.-----------------------------------------
. Scan File
.-----------------------------------------
SCANU000  DISPLAY   *P1:24,*EL,"Loading Pat. Serv. Volumes : "
          OPEN      CCSTMPAF,LOADNAME
          MOVE      ZERO,SECTOR
.
SCANU100  READ      CCSTMPAF,SEQ;PROCKY20,F2,KEY4,F8P2
          GOTO      SCANU999 IF OVER
          ADD       ONE,SECTOR
.
          IF        (SECTOR%100.0)=0
            DISPLAY   *P50:24,*V2LON,SECTOR
          ENDIF
.
          COMPARE   ZERO,F2
          GOTO      SCANU200 IF EQUAL
.
          MOVE      F2,CCCAPER
          REP       " 0",CCCAPER
          PACK      KEY6,CCCAYEAR,CCCAPER
          CALL      RDCCCA1
          IF        OVRCD=0
            MOVE      F8P2,TOTALQTY
            CALL      LOADU000               * Load Patient Service
          ENDIF
.
          GOTO      SCANU100
.
SCANU200  CALL      RDCCPR1                * Read Profile Record
          CALL      PROFL000               * Calculate period Amounts
          MOVE      ZERO,F2
SCANU210  ADD       ONE,F2
          IF        F2>13
            GOTO      SCANU100
          ENDIF
          MOVE      F2,CCCAPER
          REP       " 0",CCCAPER
          PACK      KEY6,CCCAYEAR,CCCAPER
          CALL      RDCCCA1
          IF        OVRCD=0
            LOAD      TOTALQTY,F2,AM01,AM02,AM03,AM04,AM05,AM06:
                                  AM07,AM08,AM09,AM10,AM11,AM12,AM13
            CALL      LOADU000               * Load Patient Service
          ENDIF
          GOTO      SCANU210
.
SCANU999  RETURN
.------------------------------------------------------------
. Load Utilisation Details
.------------------------------------------------------------
LOADU000  PACK      KEY18,PROCKY20,SP70
          CALL      RDCCPD1                * Check for Vaild Patient Service Key
          BRANCH    OVRCD,LOADU100
.
          CALL      SUMPR000               * Update Patient Service Summary
          CALL      GENPR000               * Determine Synthetic Patient Service
.
LOADU100  PACK      KEY38,PROCKY20,SP70
          CALL      RSCCPK1
LOADU200  CALL      RKCCPK1
          BRANCH    OVRCD,LOADU999         * No More Related Patient Service
          MATCH     CCPKFKY,PROCKY20        * No More Related Patient Service
          GOTO      LOADU999 IF NOT EQUAL
.
          PACK      KEY18,CCPKHCD,CCPKDPT,CCPKPCD
          CALL      RDCCPD1                * Check for Vaild Patient Service Key
          BRANCH    OVRCD,LOADU200
.
          CALL      SUMPR000               * Update Patient Service Summary
.
          CALL      GENPR000               * Determine Synthetic Patient Service
.
          GOTO      LOADU200               * Next Record
.
LOADU999  RETURN
.------------------------------------------------------------
. Check for Generated Patient Service
.------------------------------------------------------------
GENPR000  PACK      KEY36,CCPDHCD,CCPDDPT,CCPDPCD,SP70
          PACK      KEY18,CCPDHCD,CCPDDPT,CCPDPCD,SP70
          CALL      RSCCGP1
GENPR100  CALL      RKCCGP1
          BRANCH    OVRCD,GENPR999
          PACK      KEY36,CCGPHCD,CCGPDPT,CCGPPCD,SP70
          MATCH     KEY18,KEY36
          GOTO      GENPR999 IF NOT EQUAL
.
          CALL      SUMGP000                * Update Summary
.
          GOTO      GENPR100
.
GENPR999  RETURN
.------------------------------------------------------------
. Write or Update Patient Service Summary Record with Quantity
.------------------------------------------------------------
SUMPR000  PACK      KEY24,CCPDHCD,CCPDDPT,CCCAYEAR,CCCAPER,CCPDPCD
          CALL      RDCCME1
          IF        OVRCD=0
            ADD       TOTALQTY,CCMEQTY
            CALL      UPCCME1
          ELSE
            UNPACK    KEY24,CCMEHCD,CCMEDPT,CCMEYEAR,CCMEPER,CCMEPCD
            MOVE      TOTALQTY,CCMEQTY
            MOVE      ZERO,CCMECST
            MOVE      ZERO,CCMEFLX
            MOVE      SP70,CCMESPA
            CALL      WRCCME1
          ENDIF
          RETURN
.-------------------------------------------------------------------------------
. Write or Update Patient Service Summary Record with Quantity for Generated Pat
.-------------------------------------------------------------------------------
SUMGP000  PACK      KEY24,CCGPGHCD,CCGPGDPT,CCCAYEAR,CCCAPER,CCGPGPCD
          CALL      RDCCME1
          IF        OVRCD=0
            ASSIGN    CCMEQTY+(CCGPGQTY*TOTALQTY),CCMEQTY
            CALL      UPCCME1
          ELSE
            UNPACK    KEY24,CCMEHCD,CCMEDPT,CCMEYEAR,CCMEPER,CCMEPCD
            ASSIGN    CCGPGQTY*TOTALQTY,CCMEQTY
            MOVE      ZERO,CCMECST
            MOVE      ZERO,CCMEFLX
            MOVE      SP70,CCMESPA
            CALL      WRCCME1
          ENDIF
          RETURN
.------------------------------------------------------------
. Check File Format
.------------------------------------------------------------
CHECK000  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          DISPLAY   *P1:24,*EL,"Checking Load File :"
          STRIP     LOADNAME
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCSTMPAF,LOADNAME
          TRAPCLR   IO
          BRANCH    OVRCD,CHECK900
.
. Check Format of File
.----------------------
          MOVE      ZERO,SECTOR
CHECK100  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CCSTMPAF,SEQ;PROCKY20,F2,KEY4,F8P2
          GOTO      CHECK200 IF OVER
          TRAPCLR   FORMAT
          BRANCH    OVRCD,CHECK950
          IF        F2=0
            CALL      RDCCPR1
            BRANCH    OVRCD,CHECK960
          ELSE
            MOVE      F2,CCCAPER
            REP       " 0",CCCAPER
            PACK      KEY6,CCCAYEAR,CCCAPER
            CALL      RDCCCA1
            BRANCH    OVRCD,CHECK970
          ENDIF
          ADD       ONE,SECTOR
          IF        (SECTOR%100=0)
            DISPLAY   *P50:24,*V2LON,SECTOR
          ENDIF
          GOTO      CHECK100
.
CHECK200  MOVE      ZERO,EXIT
          GOTO      LOAD9999
.
CHECK900  BEEP
          MOVE      "File Not Found. - ",DISPMSG
          CALL      MESSAGE1
          MOVE      ONE,EXIT
          GOTO      LOAD9999
.
CHECK950  BEEP
          CLEAR     DISPMSG
          APPEND    "File Format Incorrect. Record ",DISPMSG
          APPEND    SECTOR,DISPMSG
          APPEND    " - ",DISPMSG
          RESET     DISPMSG
          CALL      MESSAGE1
          MOVE      ONE,EXIT
          GOTO      LOAD9999
.
CHECK960  BEEP
          CLEAR     DISPMSG
          APPEND    "Missing Profile Code. Record ",DISPMSG
          APPEND    SECTOR,DISPMSG
          APPEND    " - ",DISPMSG
          RESET     DISPMSG
          CALL      MESSAGE1
          MOVE      ONE,EXIT
          GOTO      LOAD9999
.
CHECK970  BEEP
          CLEAR     DISPMSG
          APPEND    "Missing Period from Calendar File. Record ",DISPMSG
          APPEND    SECTOR,DISPMSG
          APPEND    " - ",DISPMSG
          RESET     DISPMSG
          CALL      MESSAGE1
          MOVE      ONE,EXIT
          GOTO      LOAD9999
.
CHECK999  RETURN
.------------------------------------------------------------
. Allocate Amount by Profile
.------------------------------------------------------------
PROFL000  ASSIGN   (F8P2*CCPRP01)/100.0,AM01
          ASSIGN   (F8P2*CCPRP02)/100.0,AM02
          ASSIGN   (F8P2*CCPRP03)/100.0,AM03
          ASSIGN   (F8P2*CCPRP04)/100.0,AM04
          ASSIGN   (F8P2*CCPRP05)/100.0,AM05
          ASSIGN   (F8P2*CCPRP06)/100.0,AM06
          ASSIGN   (F8P2*CCPRP07)/100.0,AM07
          ASSIGN   (F8P2*CCPRP08)/100.0,AM08
          ASSIGN   (F8P2*CCPRP09)/100.0,AM09
          ASSIGN   (F8P2*CCPRP10)/100.0,AM10
          ASSIGN   (F8P2*CCPRP11)/100.0,AM11
          ASSIGN   (F8P2*CCPRP12)/100.0,AM12
          ASSIGN   (F8P2*CCPRP13)/100.0,AM13
          ASSIGN   F8P2-AM01-AM02-AM03-AM03-AM04-AM05-AM06,F12P2
          ASSIGN   F12P2-AM07-AM08-AM09-AM10-AM11-AM12-AM13,F12P2
          COMPARE  ZERO,F12P2
          GOTO     PROFL300 IF EQUAL
          MOVE     "14",F2
PROFL100  SUB      ONE,F2
          LOAD     F12P2A,F2,AM01,AM02,AM03,AM04,AM05,AM06:
                                 AM07,AM08,AM09,AM10,AM11,AM12,AM13
          COMPARE  ONE,F2
          GOTO     PROFL200 IF EQUAL
          COMPARE  ZERO,F12P2A
          GOTO     PROFL100 IF EQUAL
.
PROFL200  ADD      F12P2,F12P2A
          STORE    F12P2A,F2,AM01,AM02,AM03,AM04,AM05,AM06:
                                 AM07,AM08,AM09,AM10,AM11,AM12,AM13
PROFL300  RETURN
.----------------------------------------
. Clear Volumes
.----------------------------------------
CLRPR000  DISPLAY   *P1:24,*EL,"Clear Pat.Serv. Volumes (Y/N) ? "
          MOVE      "33",CCOL
          MOVE      "24",CVERT
          CALL      DEFAULTN
          CALL      YORN0000
          COMPARE   ZERO,FYESNO
          GOTO      CLRPR999 IF EQUAL
.
          DISPLAY   *P1:24,*EL,"Processing : "
          MOVE      ZERO,SECTOR
          PACK      KEY24,SP70
          CALL      RSCCME1
CLRPR100  CALL      RKCCME1
          BRANCH    OVRCD,CLRPR999
          MATCH     CCMEYEAR,CCCAYEAR
          GOTO      CLRPR100 IF NOT EQUAL
          MATCH     SP70,CCCAPER
          GOTO      CLRPR200 IF EQUAL
          MATCH     CCMEPER,CCCAPER
          GOTO      CLRPR100 IF NOT EQUAL
.
CLRPR200  MOVE      ZERO,CCMEQTY
          ADD       ONE,SECTOR
          IF        (SECTOR%100=0)
            DISPLAY   *P30:24,*V2LON,SECTOR
          ENDIF
          CALL      UPCCME1
          GOTO      CLRPR100
.
CLRPR999  RETURN
.------------------------------------------------------------
. Enter Period to Load Blank for Annual Amounts
.------------------------------------------------------------
KPERD000  MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;CCCOYEAR,CCCOPER,CCCODIR
          MOVE      CCCOYEAR,CCCAYEAR
          CALL      KCCCAA00
          BRANCH    EXIT,KPERD100,KPERD999
          GOTO      KPERD999
.
KPERD100  MOVE      SP70,CCCAPER
          MOVE      "All Periods",CCCADES
          MOVE      ZERO,EXIT
.
KPERD999  RETURN
.------------------------------------------------------------
. Copy Departmental Actuals
.------------------------------------------------------------
CDAC0000  MOVE     ZERO,RECCOUNT
          DISPLAY  *P1:24,*EL,"Clearing ccscmbaf ..."
          CALL     CPCMB000
.
          MOVE     ZERO,RECCOUNT
          DISPLAY  *P1:24,*EL,"Clearing ccscmcaf ..."
          CALL     CPCMC000
.
          MOVE     ZERO,RECCOUNT
          DISPLAY  *P1:24,*EL,"Clearing ccscmfaf ..."
          CALL     CPCMF000
.
CDAC9999  RETURN
.------------------------------------------------------------
. Copy DCO to CMB
.------------------------------------------------------------
CPCMB000  PACK     KEY20,SP70       * Clear All Records
          CALL     RSCCMB1
          CALL     RKCCMB1
          BRANCH   OVRCD,CPCMB100
          PACK     KEY20,CCMBHCD,CCMBDPT,CCMBYEAR,CCMBPER,CCMBCTY
          CALL     DECCMB1
          ADD      ONE,RECCOUNT
          IF       RECCOUNT%200=0
            DISPLAY    *P30:24,RECCOUNT
          ENDIF
          GOTO     CPCMB000
.
CPCMB100  PACK     KEY20,SP70       * Copy All Records
          MOVE     ZERO,RECCOUNT
          DISPLAY  *P1:24,*EL,"Copying ccscmbaf ..."
          CALL     RSCCDC1
CPCMB110  CALL     RKCCDC1
          BRANCH   OVRCD,CPCMB999
          MATCH    SP70,COPYYEAR
          IF       !@EQUAL
            MATCH    COPYYEAR,CCDCYEAR
            GOTO     CPCMB110 IF NOT EQUAL
          ENDIF
          PACK     KEY20,CCDCHCD,CCDCDPT,TOYEAR,CCDCPER,CCDCCTY
          UNPACK   KEY20,CCMBHCD,CCMBDPT,CCMBYEAR,CCMBPER,CCMBCTY
          MOVE     CCDCDIR,CCMBDIR
          MOVE     CCDCIND,CCMBIND
          MOVE     ZERO,CCMBFLX
          MOVE     SP70,CCMBSPA
          CALL     RACCMB1
          IF       OVRCD=1
            CALL     WRCCMB1
          ENDIF
          ADD      ONE,RECCOUNT
          IF       RECCOUNT%200=0
            DISPLAY    *P30:24,RECCOUNT
          ENDIF
          GOTO     CPCMB110
.
CPCMB999  RETURN
.------------------------------------------------------------
. Copy SDC to CMC
.------------------------------------------------------------
CPCMC000  PACK     KEY16,SP70       * Clear All Records
          CALL     RSCCMC1
          CALL     RKCCMC1
          BRANCH   OVRCD,CPCMC100
          PACK     KEY16,CCMCHCD,CCMCDPT,CCMCYEAR,CCMCPER
          CALL     DECCMC1
          ADD      ONE,RECCOUNT
          IF       RECCOUNT%200=0
            DISPLAY    *P30:24,RECCOUNT
          ENDIF
          GOTO     CPCMC000
.
CPCMC100  PACK     KEY16,SP70       * Copy All Records
          MOVE     ZERO,RECCOUNT
          DISPLAY  *P1:24,*EL,"Copying ccscmcaf ..."
          CALL     RSCCSD1
CPCMC110  CALL     RKCCSD1
          BRANCH   OVRCD,CPCMC999
          MATCH    SP70,COPYYEAR
          IF       !@EQUAL
            MATCH    COPYYEAR,CCSDYEAR
            GOTO     CPCMC110 IF NOT EQUAL
          ENDIF
          PACK     KEY16,CCSDHCD,CCSDDPT,TOYEAR,CCSDPER
          UNPACK   KEY16,CCMCHCD,CCMCDPT,CCMCYEAR,CCMCPER
          MOVE     CCSDDIR,CCMCDIR
          MOVE     CCSDIND,CCMCIND
          MOVE     ZERO,CCMCFLX
          MOVE     SP70,CCMCSPA
          CALL     RACCMC1
          IF       OVRCD=1
            CALL     WRCCMC1
          ENDIF
          ADD      ONE,RECCOUNT
          IF       RECCOUNT%200=0
            DISPLAY    *P30:24,RECCOUNT
          ENDIF
          GOTO     CPCMC110
.
CPCMC999  RETURN
.------------------------------------------------------------
. Copy CDT to CMF
.------------------------------------------------------------
CPCMF000  PACK     KEY28,SP70       * Clear All Records
          CALL     RSCCMF1
          CALL     RKCCMF1
          BRANCH   OVRCD,CPCMF100
          PACK     KEY28,CCMFHCD,CCMFFDPT,CCMFYEAR,CCMFPER,CCMFTDPT,CCMFCTY
          CALL     DECCMF1
          ADD      ONE,RECCOUNT
          IF       RECCOUNT%200=0
            DISPLAY    *P30:24,RECCOUNT
          ENDIF
          GOTO     CPCMF000
.
CPCMF100  PACK     KEY28,SP70       * Copy All Records
          MOVE     ZERO,RECCOUNT
          DISPLAY  *P1:24,*EL,"Copying ccscmfaf ..."
          CALL     RSCCCD1
CPCMF110  CALL     RKCCCD1
          BRANCH   OVRCD,CPCMF999
          MATCH    SP70,COPYYEAR
          IF       !@EQUAL
            MATCH    COPYYEAR,CCCDYEAR
            GOTO     CPCMF110 IF NOT EQUAL
          ENDIF
          PACK     KEY28,CCCDHCD,CCCDFDPT,TOYEAR,CCCDPER,CCCDTDPT,CCCDCTY
          UNPACK   KEY28,CCMFHCD,CCMFFDPT,CCMFYEAR,CCMFPER,CCMFTDPT,CCMFCTY
          MOVE     CCCDATY,CCMFATY
          MOVE     CCCDTWG,CCMFTWG
          MOVE     CCCDWGT,CCMFWGT
          MOVE     CCCDTOT,CCMFTOT
          MOVE     CCCDAMT,CCMFAMT
          MOVE     SP70,CCMFSPA
          CALL     RACCMF1
          IF       OVRCD=1
            CALL     WRCCMF1
          ENDIF
          ADD      ONE,RECCOUNT
          IF       RECCOUNT%200=0
            DISPLAY    *P30:24,RECCOUNT
          ENDIF
          GOTO     CPCMF110
.
CPCMF999  RETURN
.
.------------------------------------------------------------
. Copy Departmental Actuals
.------------------------------------------------------------
CPAC0000  MOVE     ZERO,RECCOUNT
          DISPLAY  *P1:24,*EL,"Clearing ccscmdaf ..."
          CALL     CPCMD000
.
          MOVE     ZERO,RECCOUNT
          DISPLAY  *P1:24,*EL,"Clearing ccscmeaf ..."
          CALL     CPCME000
.
CPAC9999  RETURN
.------------------------------------------------------------
. Copy PCD to CMD
.------------------------------------------------------------
CPCMD000  PACK     KEY28,SP70       * Clear All Records
          CALL     RSCCMD1
          CALL     RKCCMD1
          BRANCH   OVRCD,CPCMD100
          PACK     KEY28,CCMDHCD,CCMDDPT,CCMDYEAR,CCMDPER,CCMDPCD,CCMDCTY
          CALL     DECCMD1
          ADD      ONE,RECCOUNT
          IF       RECCOUNT%200=0
            DISPLAY    *P30:24,RECCOUNT
          ENDIF
          GOTO     CPCMD000
.
CPCMD100  PACK     KEY28,SP70       * Copy All Records
          MOVE     ZERO,RECCOUNT
          DISPLAY  *P1:24,*EL,"Copying ccscmdaf ..."
          CALL     RSCCPC1
CPCMD110  CALL     RKCCPC1
          BRANCH   OVRCD,CPCMD999
          MATCH    SP70,COPYYEAR
          IF       !@EQUAL
            MATCH    COPYYEAR,CCPCYEAR
            GOTO     CPCMD110 IF NOT EQUAL
          ENDIF
          PACK     KEY28,CCPCHCD,CCPCDPT,TOYEAR,CCPCPER,CCPCPCD,CCPCCTY
          UNPACK   KEY28,CCMDHCD,CCMDDPT,CCMDYEAR,CCMDPER,CCMDPCD,CCMDCTY
          MOVE     CCPCCST,CCMDCST
          MOVE     CCPCRVI,CCMDRVI
          MOVE     ZERO,CCMDFLX
          MOVE     SP70,CCMDSPA
          CALL     RACCMD1
          IF       OVRCD=1
            CALL     WRCCMD1
          ENDIF
          ADD      ONE,RECCOUNT
          IF       RECCOUNT%200=0
            DISPLAY    *P30:24,RECCOUNT
          ENDIF
          GOTO     CPCMD110
.
CPCMD999  RETURN
.------------------------------------------------------------
. Copy PCD to CME
.------------------------------------------------------------
CPCME000  PACK     KEY24,SP70       * Clear All Records
          CALL     RSCCME1
          CALL     RKCCME1
          BRANCH   OVRCD,CPCME100
          PACK     KEY24,CCMEHCD,CCMEDPT,CCMEYEAR,CCMEPER,CCMEPCD
          CALL     DECCME1
          ADD      ONE,RECCOUNT
          IF       RECCOUNT%200=0
            DISPLAY    *P30:24,RECCOUNT
          ENDIF
          GOTO     CPCME000
.
CPCME100  PACK     KEY28,SP70       * Copy All Records
          MOVE     ZERO,RECCOUNT
          DISPLAY  *P1:24,*EL,"Copying ccscmeaf ..."
          CALL     RSCCPS1
CPCME110  CALL     RKCCPS1
          BRANCH   OVRCD,CPCME999
          MATCH    SP70,COPYYEAR
          IF       !@EQUAL
            MATCH    COPYYEAR,CCPSYEAR
            GOTO     CPCME110 IF NOT EQUAL
          ENDIF
          PACK     KEY24,CCPSHCD,CCPSDPT,TOYEAR,CCPSPER,CCPSPCD
          UNPACK   KEY24,CCMEHCD,CCMEDPT,CCMEYEAR,CCMEPER,CCMEPCD
          MOVE     CCPSCST,CCMECST
          MOVE     CCPSQTY,CCMEQTY
          MOVE     ZERO,CCMEFLX
          MOVE     SP70,CCMESPA
          CALL     RACCME1
          IF       OVRCD=1
            CALL     WRCCME1
          ENDIF
          ADD      ONE,RECCOUNT
          IF       RECCOUNT%200=0
            DISPLAY    *P30:24,RECCOUNT
          ENDIF
          GOTO     CPCME110
.
CPCME999  RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CCSCALIO/INC
          INC       CCSCALKY    
          INC       CCSCDTIO/INC
          INC       CCSCMAIO/INC
          INC       CCSCMAKY    
          INC       CCSCMBIO/INC
          INC       CCSCMCIO/INC
          INC       CCSCMDIO/INC
          INC       CCSCMEIO/INC
          INC       CCSCMFIO/INC
          INC       CCSCMNIO/INC
          INC       CCSCONIO/INC
          INC       CCSDCOIO/INC
          INC       CCSDPTIO/INC
          INC       CCSGILIO/INC
          INC       CCSGKMIO/INC
          INC       CCSGPFIO/INC
          INC       CCSMOPCD    
          INC       CCSPCDIO/INC
          INC       CCSPDPIO/INC
          INC       CCSPFKIO/INC
          INC       CCSPKYIO/INC
          INC       CCSPROIO/INC
          INC       CCSPSDIO/INC
          INC       CCSSDCIO/INC
.
          INC       STDGENCD
.
