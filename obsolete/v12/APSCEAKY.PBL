EAPEAA00   UNPACK     APEADAT,CCENT,CYEAR,CMON,CDAY
           CALL       PACDATE
           RETURN
.
EAPEAB00   MOVE       SP70,APISDES
           PACK       KEY1,APEAISC,SP70
           CALL       RDAPIS1
           RETURN
.
.---------------------------------------------------------------------------
.   System    :   Accounts Payable System            
.   Include   :   APSCEAKY
.   Routine   :   KAPEAA00 Keyin Order Number        
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KAPEAA00 TOPIC     "APEAORD "
          MOVE      UNDLN70,APEAORD 
          KEYIN     *PCCOL:CVERT,*DV,APEAORD:                                   
                    *PCCOL:CVERT,*V2LON,*JR,APEAORD:                            
                    *PCCOL:CVERT,*DV,APEAORD 
.
          ENDSET    APEAORD 
          APPEND    SP70,APEAORD 
          RESET     APEAORD 
.
          MATCH     SP70,APEAORD 
          GOTO      KAPEAA90 IF EQUAL
.
          ENDSET    APEAORD 
          CMATCH    EXITCHAR,APEAORD 
          GOTO      KAPEAA95 IF EQUAL
.
          CMATCH    QUEST,APEAORD 
          GOTO      KAPEAA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HAPEAA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    APEAORD 
          APPEND    SP70,APEAORD 
          RESET     APEAORD 
.
          MATCH     SP70,APEAORD 
          GOTO      KAPEAA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,APEAORD                                 
KAPEAA10
          RESET     APEAORD 
          PACK      KEY8,APEAISC,APEAORD                                        
          CALL      RAAPEA1 
          BRANCH    OVRCD,KAPEAA80
          BRANCH    CKEYTYP,KAPEAA75
          CALL      RDAPEA1 
KAPEAA70
          MOVE      ZERO,EXIT
          GOTO      KAPEAA99
KAPEAA75
          MOVE      "Order Number Already Exist - ",DISPMSG                                          
          CALL      MESSAGE1
          GOTO      KAPEAA00
KAPEAA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KAPEAA99,KAPEAA99
          MOVE      "Order Number Does Not Exist - ",DISPMSG                                         
          CALL      MESSAGE1
          GOTO      KAPEAA00
KAPEAA90
          MOVE      ONE,EXIT
          GOTO      KAPEAA99
KAPEAA95
          MOVE      TWO,EXIT
KAPEAA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   Accounts Payable System            
.   Include   :   APSCEAKY
.   Routine   :   KAPEAB00 Keyin Order               
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.                 APMACRD (creditor to search for)
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KAPEAB00 TOPIC     "APEAISC "
          MOVE      APMACRD,APEACRD    * set up creditor
          UNPACK    UNDLN70,KEY8
          KEYIN     *PCCOL:CVERT,*DV,KEY8:
                    *PCCOL:CVERT,*V2LON,KEY8;
          UNPACK    KEY8,APEAISC,KEY7
          STRIP     KEY7
          MOVELPTR  KEY7,F2
          ASSIGN    7-F2,F2
          SETLPTR   SP70,F2
          PACK      APEAORD,SP70,KEY7
          RESET     SP70,70
          RESET     SP70
.
          ENDSET    APEAISC 
          APPEND    SP70,APEAISC 
          RESET     APEAISC 
.
          MATCH     SP70,APEAISC 
          GOTO      KAPEAB90 IF EQUAL
.
          ENDSET    APEAISC 
          CMATCH    EXITCHAR,APEAISC 
          GOTO      KAPEAB95 IF EQUAL
.
          CMATCH    QUEST,APEAISC 
          GOTO      KAPEAB10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HAPEAB00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    APEAISC 
          APPEND    SP70,APEAISC 
          RESET     APEAISC 
.
          MATCH     SP70,APEAISC 
          GOTO      KAPEAB00 IF EQUAL
.
KAPEAB10
          RESET     APEAISC 
          DISPLAY   *PCCOL:CVERT,*V2LON,APEAISC,APEAORD
          PACK      KEY8,APEAISC,APEAORD                       
          CALL      RDAPEA1 
          BRANCH    OVRCD,KAPEAB80
.
          MATCH     APMACRD,APEACRD    * check if order exists for another cred
          IF        !@EQUAL
            CLEAR     DISPMSG
            APPEND    "Order Already Exists For Creditor ",DISPMSG
            APPEND    APEACRD,DISPMSG
            APPEND    " - ",DISPMSG
            CALL      MESSAGE1
            GOTO      KAPEAB00
          ENDIF
          BRANCH    CKEYTYP,KAPEAB75
.
KAPEAB70
          MOVE      ZERO,EXIT
          GOTO      KAPEAB99
KAPEAB72
          MOVE      "Illegal Order Format - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KAPEAB00
KAPEAB75
          MOVE      "Order Already Exists - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KAPEAB00
KAPEAB80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KAPEAB99,KAPEAB99
          MOVE      "Order Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KAPEAB00
KAPEAB90
          MOVE      ONE,EXIT
          GOTO      KAPEAB99
KAPEAB95
          MOVE      TWO,EXIT
KAPEAB99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   Accounts Payable System            
.   Include   :   APSCEAKY
.   Routine   :   HAPEAB00 Keyin Order by Suppl
.   Return    :           
.-------------------------------------------------------------------------------
HAPEAB00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HAPEAB04
          CALL      GSCRN000
          BRANCH    EXIT,HAPEAB99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Date"               
.
          MOVE      STDCOL01,STDCOL02
          ADD       "11",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Order"              
.
          MOVE      STDCOL02,STDCOL03
          ADD       "1",STDCOL03
.
          MOVE      STDCOL03,STDCOL04
          ADD       " 7",STDCOL04
HAPEAB08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,APEAISC 
          PACK      KEY21,APEACRD,Z70               
          PACK      SAVKEY80,APEACRD,SP70               
          SETLPTR   SAVKEY80,5
          CALL      RSAPEA2 
HAPEAB10
          CALL      RPAPEA2 
          BRANCH    OVRCD,HAPEAB15
          PACK      KEY21,APEACRD,APEADAT,APEAISC,APEAORD,SP70                  
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HAPEAB15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,HAPEAB12
          CALL      HAPEAB60
          BRANCH    OVRCD,HAPEAB10
HAPEAB12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY21,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          CALL      EAPEAA00
          DISPLAY   *PSTDCOL01:STDROW,CPCDATE 
          DISPLAY   *PSTDCOL02:STDROW,APEAISC 
          DISPLAY   *PSTDCOL03:STDROW,APEAORD 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HAPEAB10 IF NOT EQUAL
HAPEAB15
          UNPACK    SAVKEY80,APEACRD,APEADAT,APEAISC,APEAORD                    
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HAPEAB20
          CALL      HSCRI000
          BRANCH    EXIT,HAPEAB30,HAPEAB35,HAPEAB40,HAPEAB45,HAPEAB04:
                              HAPEAB91,HAPEAB50
          GOTO      HAPEAB92
HAPEAB30
          CALL      RPAPEA2 
          BRANCH    OVRCD,HAPEAB85
          PACK      KEY21,APEACRD,APEADAT,APEAISC,APEAORD,SP70                  
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HAPEAB85 IF NOT EQUAL                                       
          CALL      RKAPEA2 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAPEAB10
HAPEAB35
          MOVE      ST1,KEY21
          CALL      RDAPEA2 
          CALL      RKAPEA2 
          BRANCH    OVRCD,HAPEAB85
          PACK      KEY21,APEACRD,APEADAT,APEAISC,APEAORD,SP70                  
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HAPEAB85 IF NOT EQUAL                                       
          MATCH     SP70,APEAISC                                                
          GOTO      HAPEAB85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HAPEAB36
          CALL      RKAPEA2 
          BRANCH    OVRCD,HAPEAB37
          PACK      KEY21,APEACRD,APEADAT,APEAISC,APEAORD,SP70                  
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HAPEAB37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HAPEAB36 IF NOT EQUAL
HAPEAB37
          MOVE      ZERO,XITEMNO
          GOTO      HAPEAB10
HAPEAB40
          MOVE      ST1,KEY21
          CALL      RDAPEA2 
          CALL      RKAPEA2 
          BRANCH    OVRCD,HAPEAB85
          PACK      KEY21,APEACRD,APEADAT,APEAISC,APEAORD,SP70                  
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HAPEAB85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAPEAB08
HAPEAB45
          CALL      RPAPEA2 
          BRANCH    OVRCD,HAPEAB85
          PACK      KEY21,APEACRD,APEADAT,APEAISC,APEAORD,SP70                  
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HAPEAB85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY21,SAVKEY80,Z70                                          
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSAPEA2 
HAPEAB46
          CALL      RKAPEA2 
          BRANCH    OVRCD,HAPEAB47
          PACK      KEY21,APEACRD,APEADAT,APEAISC,APEAORD,SP70                  
          MATCH     SAVKEY80,KEY21                                              
          GOTO      HAPEAB47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HAPEAB46 IF NOT EQUAL
HAPEAB47
          MOVE      ZERO,XITEMNO
          GOTO      HAPEAB10
HAPEAB50  COMPARE   ZERO,CSEARCH
          GOTO      HAPEAB55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAPEAB08
HAPEAB55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAPEAB08
HAPEAB60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HAPEAB61 IF EQUAL
          MATCH     SCHFLD01,CPCDATE 
          GOTO      HAPEAB72 IF NOT EQUAL
HAPEAB61
          MATCH     SP70,SCHFLD02
          GOTO      HAPEAB62 IF EQUAL
          MATCH     SCHFLD02,APEAISC 
          GOTO      HAPEAB72 IF NOT EQUAL
HAPEAB62
          MATCH     SP70,SCHFLD03
          GOTO      HAPEAB63 IF EQUAL
          MATCH     SCHFLD03,APEAORD 
          GOTO      HAPEAB72 IF NOT EQUAL
HAPEAB63
HAPEAB64
HAPEAB65
HAPEAB66
HAPEAB67
HAPEAB68
HAPEAB69
HAPEAB70
          GOTO      HAPEAB75
HAPEAB72  MOVE      ONE,OVRCD
HAPEAB75  RETURN
HAPEAB85
          LOAD      KEY21,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY21,APEACRD,APEADAT,APEAISC,APEAORD                       
          CALL      RDAPEA2 
HAPEAB90
          UNPACK    SAVKEY80,APEACRD,APEADAT,APEAISC,APEAORD                    
          BEEP
          GOTO      HAPEAB20
HAPEAB91
          MOVE      SP70,APEASPA 
          MOVE      SP70,KEY21
          MOVE      SP70,APEAISC 
          GOTO      HAPEAB96
HAPEAB92
          MOVE      SP70,KEY21
          MOVE      SP70,APEAISC 
          LOAD      KEY21,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY21,APEACRD,APEADAT,APEAISC,APEAORD                       
HAPEAB96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HAPEAB99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Accounts Payable System            
.   Include   :   APSCEAKY
.   Routine   :   HAPEAA00 Order Number        
.   Return    :           
.-------------------------------------------------------------------------------
HAPEAA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HAPEAA04
          CALL      GSCRN000
          BRANCH    EXIT,HAPEAA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Order"              
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 8",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Supplier"           
.
          MOVE      STDCOL02,STDCOL03
          ADD       "10",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Date"               
.
          MOVE      STDCOL03,STDCOL04
          ADD       "10",STDCOL04
HAPEAA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,APEAORD 
          PACK      KEY8,APEAISC,APEAORD,SP70                                   
          PACK      SAVKEY80,APEAISC,APEAORD,SP70                               
          SETLPTR   SAVKEY80,1                                                  
          CALL      RSAPEA1 
HAPEAA10
          CALL      RKAPEA1 
          BRANCH    OVRCD,HAPEAA15
          PACK      KEY8,APEAISC,APEAORD,SP70                                   
          MATCH     SAVKEY80,KEY8                                               
          GOTO      HAPEAA15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,HAPEAA12
          CALL      HAPEAA60
          BRANCH    OVRCD,HAPEAA10
HAPEAA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY8,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,APEAORD 
          DISPLAY   *PSTDCOL02:STDROW,APEACRD 
          CALL      EAPEAA00
          DISPLAY   *PSTDCOL03:STDROW,CPCDATE 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HAPEAA10 IF NOT EQUAL
HAPEAA15
          UNPACK    SAVKEY80,APEAISC,APEAORD                                    
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HAPEAA20
          CALL      HSCRI000
          BRANCH    EXIT,HAPEAA30,HAPEAA35,HAPEAA40,HAPEAA45,HAPEAA04:
                              HAPEAA91,HAPEAA50
          GOTO      HAPEAA92
HAPEAA30
          CALL      RKAPEA1 
          BRANCH    OVRCD,HAPEAA85
          PACK      KEY8,APEAISC,APEAORD,SP70                                   
          MATCH     SAVKEY80,KEY8                                               
          GOTO      HAPEAA85 IF NOT EQUAL                                       
          CALL      RPAPEA1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAPEAA10
HAPEAA35
          MOVE      ST1,KEY8 
          CALL      RDAPEA1 
          CALL      RPAPEA1 
          BRANCH    OVRCD,HAPEAA85
          PACK      KEY8,APEAISC,APEAORD,SP70                                   
          MATCH     SAVKEY80,KEY8                                               
          GOTO      HAPEAA85 IF NOT EQUAL                                       
          MATCH     SP70,APEAORD                                                
          GOTO      HAPEAA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HAPEAA36
          CALL      RPAPEA1 
          BRANCH    OVRCD,HAPEAA37
          PACK      KEY8,APEAISC,APEAORD,SP70                                   
          MATCH     SAVKEY80,KEY8                                               
          GOTO      HAPEAA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HAPEAA36 IF NOT EQUAL
HAPEAA37
          MOVE      ZERO,XITEMNO
          GOTO      HAPEAA10
HAPEAA40
          MOVE      ST1,KEY8 
          CALL      RDAPEA1 
          CALL      RPAPEA1 
          BRANCH    OVRCD,HAPEAA85
          PACK      KEY8,APEAISC,APEAORD,SP70                                   
          MATCH     SAVKEY80,KEY8                                               
          GOTO      HAPEAA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAPEAA08
HAPEAA45
          CALL      RKAPEA1 
          BRANCH    OVRCD,HAPEAA85
          PACK      KEY8,APEAISC,APEAORD,SP70                                   
          MATCH     SAVKEY80,KEY8                                               
          GOTO      HAPEAA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY8,SAVKEY80,Z70                                           
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSAPEA1 
HAPEAA46
          CALL      RPAPEA1 
          BRANCH    OVRCD,HAPEAA47
          PACK      KEY8,APEAISC,APEAORD,SP70                                   
          MATCH     SAVKEY80,KEY8                                               
          GOTO      HAPEAA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HAPEAA46 IF NOT EQUAL
HAPEAA47
          MOVE      ZERO,XITEMNO
          GOTO      HAPEAA10
HAPEAA50  COMPARE   ZERO,CSEARCH
          GOTO      HAPEAA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAPEAA08
HAPEAA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAPEAA08
HAPEAA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HAPEAA61 IF EQUAL
          MATCH     SCHFLD01,APEAORD 
          GOTO      HAPEAA72 IF NOT EQUAL
HAPEAA61
          MATCH     SP70,SCHFLD02
          GOTO      HAPEAA62 IF EQUAL
          MATCH     SCHFLD02,APEACRD 
          GOTO      HAPEAA72 IF NOT EQUAL
HAPEAA62
          CALL      EAPEAA00
          MATCH     SP70,SCHFLD03
          GOTO      HAPEAA63 IF EQUAL
          MATCH     SCHFLD03,CPCDATE 
          GOTO      HAPEAA72 IF NOT EQUAL
HAPEAA63
HAPEAA64
HAPEAA65
HAPEAA66
HAPEAA67
HAPEAA68
HAPEAA69
HAPEAA70
          GOTO      HAPEAA75
HAPEAA72  MOVE      ONE,OVRCD
HAPEAA75  RETURN
HAPEAA85
          LOAD      KEY8,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY8,APEAISC,APEAORD                                        
          CALL      RDAPEA1 
HAPEAA90
          UNPACK    SAVKEY80,APEAISC,APEAORD                                    
          BEEP
          GOTO      HAPEAA20
HAPEAA91
          MOVE      SP70,APEACRD 
          MOVE      SP70,APEADAT 
          MOVE      SP70,APEASPA 
          MOVE      SP70,KEY8 
          MOVE      SP70,APEAORD 
          GOTO      HAPEAA96
HAPEAA92
          MOVE      SP70,KEY8 
          MOVE      SP70,APEAORD 
          LOAD      KEY8,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY8,APEAISC,APEAORD                                        
HAPEAA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HAPEAA99
          RETURN
