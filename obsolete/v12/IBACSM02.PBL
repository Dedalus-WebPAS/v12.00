.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.04.01  13.04.2005 Peter Vela CAR 59696
.           Recompiled for SINSUAFD
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.00.02  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
. VF.00.01  02.11.1999 Sandra Barcham
.           Change locked message to use X for exit
.-------------------------------------------------------
UPDTYPE   FORM      2
KEYDES60  DIM       60
SAVKEY22  DIM       22
KEYWRDNO  FORM      2
KEYWRD00  DIM       60
KEYWRD01  DIM       15
KEYWRD02  DIM       15
KEYWRD03  DIM       15
KEYWRD04  DIM       15
KEYWRD05  DIM       15
KEYWRD06  DIM       15
KEYWRD07  DIM       15
KEYWRD08  DIM       15
KEYWRD09  DIM       15
KEYWRD10  DIM       15
.
SHTOP     FORM      2             * SINCIAKY
SHBOT     FORM      2             * SINCIAKY
SHLEF     FORM      3             * SINCIAKY
SHRIG     FORM      3             * SINCIAKY
XTOP      FORM      2             * SINCIAKY
XBOT      FORM      2             * SINCIAKY
XLEF      FORM      3             * SINCIAKY
XRIG      FORM      3             * SINCIAKY
.
KEY27SAV  DIM       27
TOTSUPS   FORM      4
TOTUNITS  FORM      4
ISPREFER  FORM      1
SAVSUP    DIM       5
SAVNON    DIM       1
SAVCAT    DIM       7
CALFORM7  FORM      7
SCSICCCT  FORM      12.2     * save var for current cost
ADDFLAG   FORM      1        * if in insert mode for SRF126775
INSCAT    FORM      1        * if in insert mode for SRF126775
INSRTCAT  FORM      1
CANCFLAG  FORM      1 * Scr 00 Fld    11
CKEYSTCK  DIM       1
SAVECATA  DIM       7
SAVECRED  DIM       5
SAVEUNIT  DIM       15
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACSM02
.   Function      :   Corporate Catalog Maintenance           
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CSMCIAFD/INC
          INC       CSMCICFD/INC
          INC       CSMCIFFD/INC
          INC       CSMCKYFD/INC
          INC       CSMCREFD/INC
          INC       CSMUIAFD/INC
          INC       CSMUICFD/INC
          INC       IBADBSFD/INC
          INC       SINCODFD/INC
          INC       SINCONFD/INC
          INC       SINFACFD/INC
          INC       SINSUAFD/INC
.=========================
.Local Variable Definition
.-------------------------
SUSPDESC  DIM      25 * Scr 01 Fld    17
.
.    Multi Item Key Fields Scr 02 Fld    23
.-------------------------------------------------------
CSIC1NAM  INIT      "CSIC1"
CSIC1END  FORM      1   * End Display
CSIC1SNO  FORM      5   * Number of Items on the Screen
CSIC1MKY  DIM       127 * Match Key 
CSIC1EKY  DIM       127 * End Key
CSIC1SKY  DIM       127 * Start Key
CSIC1IDX  INIT      " 132 UC1-5"
CSIC1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CSIC1FNM  DIM       8  * Filename
CSIC1CNT  FORM      3  * Number of Items on Screen
ISSLCOST  FORM     12.6 * Scr 02 Fld    28
ISSCCOST  FORM     12.6 * Scr 02 Fld    33
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACSM02"
PRGNAM    INIT      "Corporate Catalog Maintenance           "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      RDCON000
          CALL      SC00L000
          CLOSE     CSIC1FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   63",AUDTSECT
          MOVE      "158",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening csmaudcr";
            OPEN      CSMAUDCR,"csmaudcr"
          ENDIF
          MOVE      "   63",AUDTSECT
          MOVE      "159",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening csmaudia";
            OPEN      CSMAUDIA,"csmaudia"
          ENDIF
          MOVE      "   63",AUDTSECT
          MOVE      "160",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening csmaudic";
            OPEN      CSMAUDIC,"csmaudic"
          ENDIF
          DISPLAY   *P56:24,"Opening csmciaaf";
          OPEN      CSMCIAA1,"csmciaaf"
          DISPLAY   *P56:24,"Opening csmcicaf";
          OPEN      CSMCICA1,"csmcicaf"
          DISPLAY   *P56:24,"Opening csmcicaf";
          OPEN      CSMCICA2,"csmcicaf"
          DISPLAY   *P56:24,"Opening csmcicaf";
          OPEN      CSMCICA3,"csmcicaf"
          DISPLAY   *P56:24,"Opening csmcifaf";
          OPEN      CSMCIFA1,"csmcifaf"
          DISPLAY   *P56:24,"Opening csmckyaf";
          OPEN      CSMCKYA1,"csmckyaf"
          DISPLAY   *P56:24,"Opening csmckyaf";
          OPEN      CSMCKYA2,"csmckyaf"
          DISPLAY   *P56:24,"Opening csmcreaf";
          OPEN      CSMCREA1,"csmcreaf"
          DISPLAY   *P56:24,"Opening csmuiaaf";
          OPEN      CSMUIAA1,"csmuiaaf"
          DISPLAY   *P56:24,"Opening csmuicaf";
          OPEN      CSMUICA1,"csmuicaf"
          DISPLAY   *P56:24,"Opening ibadbsaf";
          OPEN      IBADBSA1,"ibadbsaf"
          MOVE      "   24",AUDTSECT
          MOVE      "205",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudfa";
            OPEN      SINAUDFA,"sinaudfa"
          ENDIF
          MOVE      "   24",AUDTSECT
          MOVE      "219",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudsa";
            OPEN      SINAUDSA,"sinaudsa"
          ENDIF
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA1,"sincodaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA2,"sincodaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA1,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA2,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA1,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA2,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA3,"sinsuaaf"
.--------------------------------------------------------
. Initialise Batch Screen Supply Unit                        
.--------------------------------------------------------
          MOVE     ZERO,CSIC1SNO
          MOVE     "02   23",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CSIC1SNO
            ENDIF
          ENDIF
          PACK      CSIC1FNM,ANST,CSIC1NAM,PORT
          REP       " 0",CSIC1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CSIC1FL1,CSIC1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CSIC1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CSIC1FNM,CSIC1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",CSIC1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      CSIC1FL1,CSIC1FNM
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Menu                               
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Catalog Master Details             
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Catalog/Supplier Details           
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Catalog/Supplier Details           
          ENDIF
          RETURN
.--------------------------------
. Screen - Menu                               
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Menu                               
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Menu                               
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Menu                               
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Menu                               
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Menu                               
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Menu                               
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Menu                               
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      INSCAT00
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      MODCAT00
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          CALL      UPDT0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Catalog Master Details             
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Catalog Master Details             
.-------------------------------------------------------
CF01L000
          MOVE      SP70,CSIACAT 
          MOVE      SP70,CSIADES 
          MOVE      SP70,CSIASUB 
          MOVE      SP70,CSIAISS 
          MOVE      SP70,CSIASTI 
          MOVE      ZERO,CSIAAVC 
          MOVE      SP70,CSIANAT 
          MOVE      SP70,CSIAABC 
          MOVE      SP70,CSIAPSC 
          MOVE      ZERO,CSIAREX 
          MOVE      ZERO,CSIANON 
          MOVE      ZERO,CSIASAB 
          MOVE      ZERO,CSIASUS 
          MOVE      SP70,CSIAUD1 
          MOVE      SP70,CSIAUD2 
          MOVE      SP70,CSIAUY1 
          MOVE      SP70,CSIAUY2 
          MOVE      SP70,CSIAUR1 
          MOVE      SP70,CSIAUR2 
          MOVE      SP70,CSIFDE01
          MOVE      SP70,CSIFDE02
          MOVE      SP70,CSIFDE03
          MOVE      SP70,CSIFDE04
          MOVE      SP70,CSIFDE05
          MOVE      SP70,CSIFDE06
          MOVE      SP70,CSIFDE07
          MOVE      SP70,CSIFDE08
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Catalog Master Details             
.--------------------------------------------------------
KY01L000
.
KY01L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ECATA000
          BRANCH    EXIT,KY01L900,KY01L900
          MOVE      ZERO,ACCEPT
          MOVE      CSIACAT,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Catalog Master Details             
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Catalog Master Details             
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Catalog Master Details             
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Catalog Master Details             
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L101,PS01L102,PS01L103:
                            PS01L104,PS01L105,PS01L106,PS01L107:
                            PS01L108,PS01L109,PS01L110,PS01L111:
                            PS01L112,PS01L113,PS01L114,PS01L115:
                            PS01L116,PS01L117,PS01L118,PS01L999:
                           PS01L999,PS01L119,PS01L120,PS01L121:
                            PS01L122,PS01L999,PS01L999,PS01L123:
                            PS01L124,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L125,PS01L126,PS01L127,PS01L128:
                            PS01L129,PS01L130,PS01L131,PS01L132
          GOTO     PS01L999
.
PS01L101
          MOVE      CSIADES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      CSIASUB,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      CSIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      CSIASTI,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      CSIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      CSIANAT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      CSIAABC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      CSIAPSC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSIAREX,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      YES,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSIANON,FORM2    
          LOAD      YESNO,FORM2,NO
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSIASAB,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          MOVE      CSIASUS,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          UNPACK    CSIADTC,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          MOVE      CSIAUSC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          MOVE      CSIATMC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L116
          MOVE      SUSPDESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L117
          UNPACK    CSIAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L118
          UNPACK    CSIAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSIAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L120
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSIAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L121
          MOVE      CSIAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L122
          MOVE      CSIAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L123
          MOVE      SISADESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L124
          MOVE      CSCRCN1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L125
          MOVE      CSIFDE01,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L126
          MOVE      CSIFDE02,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L127
          MOVE      CSIFDE03,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L128
          MOVE      CSIFDE04,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L129
          MOVE      CSIFDE05,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L130
          MOVE      CSIFDE06,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L131
          MOVE      CSIFDE07,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L132
          MOVE      CSIFDE08,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Catalog Master Details             
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L104,SF01L105,SF01L106,SF01L107:
                            SF01L108,SF01L109,SF01L110,SF01L111:
                            SF01L112,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L113,SF01L114,SF01L006:
                           SF01L006,SF01L115,SF01L116,SF01L117:
                            SF01L118,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L119,SF01L120,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L121,SF01L122,SF01L123,SF01L124:
                            SF01L125,SF01L126,SF01L127,SF01L128
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L101,SF01L102,SF01L103:
                            SF01L104,SF01L105,SF01L106,SF01L107:
                            SF01L108,SF01L109,SF01L110,SF01L111:
                            SF01L112,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L113,SF01L114,SF01L020:
                           SF01L020,SF01L115,SF01L116,SF01L117:
                            SF01L118,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L121,SF01L122,SF01L123,SF01L124:
                            SF01L125,SF01L126,SF01L127,SF01L128
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          CALL     SELECTED
          STRIP     CSIADES 
          SFORMAT   VAR,SCPSLEN
          MOVE      CSIADES,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CSIADES 
          SFORMAT   VAR,127
          ENDSET    CSIADES 
          APPEND    SP70,CSIADES 
          RESET     CSIADES 
          CMATCH    EXITCHAR,CSIADES 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CSIADES 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L101
            ENDIF
          ENDIF
          MOVE      CSIADES,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L102
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SISADESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSISAA00
          MOVE      SISACODE,CSIASUB
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L102
            ENDIF
            BRANCH    EXIT,SF01L102,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      CSIASUB,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SISADESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EIUNT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L103
            ENDIF
            BRANCH    EXIT,SF01L103,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      CSIAISS,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESTI0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L104
            ENDIF
            BRANCH    EXIT,SF01L104,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      CSIASTI,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L105
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CSIAAVC 
          IF        SCPSMAN=1
            COMPARE   ZERO,CSIAAVC 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L105
            ENDIF
          ENDIF
          MOVE      CSIAAVC,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L106
          CALL     SELECTED
          STRIP     CSIANAT 
          SFORMAT   VAR,SCPSLEN
          MOVE      CSIANAT,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CSIANAT 
          SFORMAT   VAR,127
          ENDSET    CSIANAT 
          APPEND    SP70,CSIANAT 
          RESET     CSIANAT 
          CMATCH    EXITCHAR,CSIANAT 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CSIANAT 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L106
            ENDIF
          ENDIF
          MOVE      CSIANAT,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L107
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EABC0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L107
            ENDIF
            BRANCH    EXIT,SF01L107,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      CSIAABC,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L108
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CSCRCN1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EPSUP000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L108
            ENDIF
            BRANCH    EXIT,SF01L108,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      CSIAPSC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CSCRCN1,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L109
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CSIAREX 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSIAREX,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L110
          CALL      DEFAULTN
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESNON000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L110
            ENDIF
            BRANCH    EXIT,SF01L110,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      YES,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSIANON,FORM2    
          LOAD      YESNO,FORM2,NO
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L111
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CSIASAB 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSIASAB,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L112
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SUSPDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESUS0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L112
            ENDIF
            BRANCH    EXIT,SF01L112,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      CSIASUS,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SUSPDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L113
          CALL     SELECTED
          CALL      KEYDATE
          PACK      CSIAUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    CSIAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L114
          CALL     SELECTED
          CALL      KEYDATE
          PACK      CSIAUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    CSIAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L115
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CSIAUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSIAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L116
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CSIAUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSIAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L117
          CALL     SELECTED
          STRIP     CSIAUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      CSIAUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CSIAUR1 
          SFORMAT   VAR,127
          ENDSET    CSIAUR1 
          APPEND    SP70,CSIAUR1 
          RESET     CSIAUR1 
          CMATCH    EXITCHAR,CSIAUR1 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CSIAUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L117
            ENDIF
          ENDIF
          MOVE      CSIAUR1,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L118
          CALL     SELECTED
          STRIP     CSIAUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      CSIAUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CSIAUR2 
          SFORMAT   VAR,127
          ENDSET    CSIAUR2 
          APPEND    SP70,CSIAUR2 
          RESET     CSIAUR2 
          CMATCH    EXITCHAR,CSIAUR2 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CSIAUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L118
            ENDIF
          ENDIF
          MOVE      CSIAUR2,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L119
          CALL      CAN10000
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L120
          CALL      POS10000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L121
          CALL     SELECTED
          STRIP     CSIFDE01
          SFORMAT   VAR,SCPSLEN
          MOVE      CSIFDE01,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CSIFDE01
          SFORMAT   VAR,127
          ENDSET    CSIFDE01
          APPEND    SP70,CSIFDE01
          RESET     CSIFDE01
          CMATCH    EXITCHAR,CSIFDE01
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CSIFDE01
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L121
            ENDIF
          ENDIF
          MOVE      CSIFDE01,VAR     
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L122
          CALL     SELECTED
          STRIP     CSIFDE02
          SFORMAT   VAR,SCPSLEN
          MOVE      CSIFDE02,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CSIFDE02
          SFORMAT   VAR,127
          ENDSET    CSIFDE02
          APPEND    SP70,CSIFDE02
          RESET     CSIFDE02
          CMATCH    EXITCHAR,CSIFDE02
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CSIFDE02
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L122
            ENDIF
          ENDIF
          MOVE      CSIFDE02,VAR     
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L123
          CALL     SELECTED
          STRIP     CSIFDE03
          SFORMAT   VAR,SCPSLEN
          MOVE      CSIFDE03,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CSIFDE03
          SFORMAT   VAR,127
          ENDSET    CSIFDE03
          APPEND    SP70,CSIFDE03
          RESET     CSIFDE03
          CMATCH    EXITCHAR,CSIFDE03
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CSIFDE03
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L123
            ENDIF
          ENDIF
          MOVE      CSIFDE03,VAR     
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L124
          CALL     SELECTED
          STRIP     CSIFDE04
          SFORMAT   VAR,SCPSLEN
          MOVE      CSIFDE04,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CSIFDE04
          SFORMAT   VAR,127
          ENDSET    CSIFDE04
          APPEND    SP70,CSIFDE04
          RESET     CSIFDE04
          CMATCH    EXITCHAR,CSIFDE04
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CSIFDE04
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L124
            ENDIF
          ENDIF
          MOVE      CSIFDE04,VAR     
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L125
          CALL     SELECTED
          STRIP     CSIFDE05
          SFORMAT   VAR,SCPSLEN
          MOVE      CSIFDE05,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CSIFDE05
          SFORMAT   VAR,127
          ENDSET    CSIFDE05
          APPEND    SP70,CSIFDE05
          RESET     CSIFDE05
          CMATCH    EXITCHAR,CSIFDE05
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CSIFDE05
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L125
            ENDIF
          ENDIF
          MOVE      CSIFDE05,VAR     
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L126
          CALL     SELECTED
          STRIP     CSIFDE06
          SFORMAT   VAR,SCPSLEN
          MOVE      CSIFDE06,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CSIFDE06
          SFORMAT   VAR,127
          ENDSET    CSIFDE06
          APPEND    SP70,CSIFDE06
          RESET     CSIFDE06
          CMATCH    EXITCHAR,CSIFDE06
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CSIFDE06
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L126
            ENDIF
          ENDIF
          MOVE      CSIFDE06,VAR     
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L127
          CALL     SELECTED
          STRIP     CSIFDE07
          SFORMAT   VAR,SCPSLEN
          MOVE      CSIFDE07,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CSIFDE07
          SFORMAT   VAR,127
          ENDSET    CSIFDE07
          APPEND    SP70,CSIFDE07
          RESET     CSIFDE07
          CMATCH    EXITCHAR,CSIFDE07
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CSIFDE07
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L127
            ENDIF
          ENDIF
          MOVE      CSIFDE07,VAR     
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L128
          CALL     SELECTED
          STRIP     CSIFDE08
          SFORMAT   VAR,SCPSLEN
          MOVE      CSIFDE08,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CSIFDE08
          SFORMAT   VAR,127
          ENDSET    CSIFDE08
          APPEND    SP70,CSIFDE08
          RESET     CSIFDE08
          CMATCH    EXITCHAR,CSIFDE08
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CSIFDE08
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L128
            ENDIF
          ENDIF
          MOVE      CSIFDE08,VAR     
          CALL      DISPITEM
          GOTO     SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Catalog/Supplier Details           
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Catalog/Supplier Details           
.-------------------------------------------------------
CF02L000
          MOVE      SP70,CSIACAT 
          MOVE      SP70,CSIADES 
          MOVE      SP70,CSIASUB 
          MOVE      SP70,CSIAISS 
          MOVE      ZERO,CSIAAVC 
          MOVE      SP70,CSIAPSC 
          MOVE      ZERO,CSIANON 
          MOVE      ZERO,CSIASUS 
          MOVE      SP70,CSIAUR1 
          MOVE      SP70,CSIAUR2 
          MOVE      SP70,CSIAUD1 
          MOVE      SP70,CSIAUD2 
          MOVE      SP70,CSIAUY1 
          MOVE      SP70,CSIAUY2 
          MOVE      SP70,SISADESC
          MOVE      SP70,CSCRCN1 
          MOVE      SP70,SUSPDESC
          MOVE      SP70,CSICSUT 
          MOVE      ZERO,SIFACTOR
          MOVE      SP70,CSICSUP 
          MOVE      SP70,CSCRCN1 
          MOVE      ZERO,CSICLCT 
          MOVE      ZERO,ISSLCOST
          MOVE      ZERO,CSICMAN 
          MOVE      SP70,CSICPNO 
          MOVE      ZERO,CSICLTM 
          MOVE      ZERO,CSICCCT 
          MOVE      ZERO,ISSCCOST
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Catalog/Supplier Details           
.--------------------------------------------------------
KY02L000
.
KY02L110
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CSIADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CSIASUB 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CSIAISS 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ECATB000
          BRANCH    EXIT,KY02L900,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      CSIACAT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CSIADES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CSIASUB,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CSIAISS,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Catalog/Supplier Details           
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Catalog/Supplier Details           
.---------------------------------------------------------
LM02L000
.---------------------------------------------------------
. Load for :    23 Supply Unit                        
.---------------------------------------------------------
          UNPACK    SP70,CSICCAT,CSICSUP,CSICSUT
          PACK      KEY27,CSIACAT,SP70
          MOVE      KEY27,CSIC1EKY
          STRIP     CSIC1SKY
          SETLPTR   CSIC1EKY,7
          MOVE      CSIC1EKY,CSIC1SKY
          CALL      RDCSIC1 
          IF        OVRCD=0
            CALL      RPCSIC1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP02L000
          MOVE     ZERO,CSIC1CNT
          MOVE     ZERO,CSIC1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP02L600
          MATCH    PRGID,SCPSPID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L101,DP02L102:
                            DP02L103,DP02L104,DP02L105,DP02L106:
                            DP02L107,DP02L108,DP02L109,DP02L110:
                            DP02L111,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010
          GOTO      DP02L010
.
DP02L101
          PACK      CSIC1MKY,SP70,SP70
          CALL      UPTCSIC1
          IF        CSIC1END=0
            CALL      RKCSIC1 
            IF        OVRCD=0
              PACK      CSIC1MKY,CSICCAT,CSICSUP,CSICSUT                                                        
              MATCH     CSIC1EKY,CSIC1MKY
              IF        @EQUAL
                MOVE      ZERO,CSIC1END
                ADD       ONE,CSIC1CNT
                CALL      UPTCSIC1
          CALL      SUPDET00
                MOVE      CSICSUT,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,CSIC1END
              ENDIF
            ELSE
              MOVE      ONE,CSIC1END
            ENDIF
          ENDIF
          IF        CSIC1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L102
          IF        CSIC1END=0
            MOVE      SIFACTOR,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L103
          IF        CSIC1END=0
            MOVE      CSICSUP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L104
          IF        CSIC1END=0
            MOVE      CSCRCN1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L105
          IF        CSIC1END=0
            MOVE      CSICLCT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L106
          IF        CSIC1END=0
            MOVE      ISSLCOST,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L107
          IF        CSIC1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      CSICMAN,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L108
          IF        CSIC1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      CSICPNO,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L109
          IF        CSIC1END=0
            MOVE      CSICLTM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L110
          IF        CSIC1END=0
            MOVE      CSICCCT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L111
          IF        CSIC1END=0
            MOVE      ISSCCOST,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
DP02L600
          MATCH    "CSIC1",NAMSSFFI
          GOTO     DP02L605 IF NOT EQUAL
          GOTO     DP02L999
DP02L605
DP02L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP02L000
.
          MATCH    "CSIC1",NAMSSFFI
          GOTO     FP02L105 IF NOT EQUAL
          PACK     KEY27,CSIC1SKY,SP70
          CALL     RDCSIC1  * Start
          IF       OVRCD=0
            CALL     RPCSIC1  * Start
          ENDIF
          CALL     DP02L000
          GOTO     FP02L999
FP02L105
FP02L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP02L000
.
          MATCH    "CSIC1",NAMSSFFI
          GOTO     LP02L105 IF NOT EQUAL
          PACK     KEY27,CSIC1SKY,Z70
          CALL     RSCSIC1  * End
          IF       OVRCD=1
            CALL     RPCSIC1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CSIC1SNO
            CALL     RPCSIC1 
            IF       OVRCD=1
              MOVE     CSIC1SNO,SECTOR
            ENDIF
            PACK     CSIC1MKY,CSICCAT,CSICSUP,CSICSUT                                                        
            MATCH    CSIC1EKY,CSIC1MKY
            IF       !@EQUAL
              MOVE     CSIC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     LP02L999
LP02L105
LP02L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP02L000
.
          MATCH    "CSIC1",NAMSSFFI
          GOTO     PP02L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP02L105
          CALL      RFTCSIC1
          BRANCH   OVRCD,PP02L115
          MOVE      CSIC1MKY,KEY27 
          CALL      RSCSIC1 
PP02L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CSIC1SNO
            CALL     RPCSIC1 
            IF       OVRCD=1
              MOVE     CSIC1SNO,SECTOR
            ENDIF
            PACK     CSIC1MKY,CSICCAT,CSICSUP,CSICSUT                                                        
            MATCH    CSIC1EKY,CSIC1MKY
            IF       !@EQUAL
              MOVE     CSIC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     PP02L999
PP02L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CSIC1SNO
            CALL     RKCSIC1 
            IF       OVRCD=1
              MOVE     CSIC1SNO,SECTOR
            ENDIF
            PACK     CSIC1MKY,CSICCAT,CSICSUP,CSICSUT                                                        
            MATCH    CSIC1EKY,CSIC1MKY
            IF       !@EQUAL
              MOVE     CSIC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP02L999
PP02L120
PP02L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP02L000
          MATCH    "CSIC1",NAMSSFFI
          GOTO     NP02L115 IF NOT EQUAL
NP02L105
          CALL     RKCSIC1 
          BRANCH   OVRCD,NP02L110
          PACK     CSIC1MKY,CSICCAT,CSICSUP,CSICSUT                                                        
          MATCH    CSIC1EKY,CSIC1MKY
          GOTO     NP02L110 IF NOT EQUAL
          CALL     RPCSIC1 
          CALL     DP02L000
          GOTO     NP02L999
NP02L110
          CALL     RPCSIC1 
          BEEP
          GOTO     NP02L999
NP02L115
NP02L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT02L000
CT02L105
CT02L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Catalog/Supplier Details           
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    23 Supply Unit                        
.---------------------------------------------------------
UPTCSIC1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CSIC1FL1,KEY5;ANS
          IF        @OVER
            WRITE     CSIC1FL1,KEY5;SCPSROW,SCPSCOL,CSIC1MKY
          ELSE
            UPDATE    CSIC1FL1;SCPSROW,SCPSCOL,CSIC1MKY
          ENDIF
          RETURN
RDTCSIC1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CSIC1FL1,KEY5;SCPSROW,SCPSCOL,CSIC1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTCSIC1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      CSIC1FL1,KEY5;;
          READKS    CSIC1FL1;SCPSROW,SCPSCOL,CSIC1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,CSIC1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Catalog/Supplier Details           
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
          MOVE      "CSIC1",NAMSSFFI
          MOVE      "   23",ITMSSFFI
          CALL      FP02L000
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Catalog/Supplier Details           
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L101,PS02L102,PS02L103:
                            PS02L104,PS02L105,PS02L106,PS02L107:
                            PS02L108,PS02L109,PS02L110,PS02L111:
                            PS02L999,PS02L999,PS02L112,PS02L113:
                            PS02L999,PS02L999,PS02L114,PS02L115:
                            PS02L116,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999
          GOTO     PS02L999
.
PS02L101
          MOVE      CSIADES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      CSIASUB,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      CSIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      CSIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      CSIAPSC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSIANON,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      CSIASUS,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      CSIAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          MOVE      CSIAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          UNPACK    CSIAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          UNPACK    CSIAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L112
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSIAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L113
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSIAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L114
          MOVE      SISADESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L115
          MOVE      CSCRCN1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L116
          MOVE      SUSPDESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Catalog/Supplier Details           
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L101,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L102,SF02L103,SF02L104:
                            SF02L105,SF02L106,SF02L107,SF02L108
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L101,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          MOVE      "CSIC1",NAMSSFFI
          MOVE      "   23",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L101
          CALL      SELECTED
          BRANCH    EXIT,SF02L001
          COMPARE   ONE,ACCEPT
          GOTO      SF02L001 IF EQUAL
          CALL      RDTCSIC1
          IF        OVRCD=1
            BEEP
            GOTO      SF02L001
          ENDIF
          MATCH     SP70,CSIC1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF02L001
          ENDIF
          MOVE      CSIC1MKY,KEY27 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      MODSUP00
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCSIC1
          IF        OVRCD=1
            CALL      FP02L000
          ELSE
            MOVE      CSIC1MKY,KEY27 
            CALL      RSCSIC1 
            CALL      RPCSIC1 
            CALL      DP02L000
          ENDIF
          GOTO     SF02L001
.
SF02L102
          MOVE      "CSIC1",NAMSSFFI
          MOVE      "   23",ITMSSFFI
          CALL      NP02L000
          GOTO     SF02L001
.
SF02L103
          MOVE      "CSIC1",NAMSSFFI
          MOVE      "   23",ITMSSFFI
          CALL      PP02L000
          GOTO     SF02L001
.
SF02L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      ADDSUP00
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF02L000
          GOTO      SF02L001
.
SF02L105
          CALL      CAN20000
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L106
          MOVE      "CSIC1",NAMSSFFI
          MOVE      "   23",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L107
          MOVE      "CSIC1",NAMSSFFI
          MOVE      "   23",ITMSSFFI
          CALL      LP02L000
          GOTO     SF02L001
.
SF02L108
          CALL      UUCSIA1 
          MOVE      ONE,EXIT
          GOTO      SF02L999
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Catalog/Supplier Details           
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Catalog/Supplier Details           
.-------------------------------------------------------
CF03L000
          MOVE      SP70,CSIACAT 
          MOVE      SP70,CSIADES 
          MOVE      SP70,CSIASUB 
          MOVE      SP70,CSIAISS 
          MOVE      ZERO,CSIAAVC 
          MOVE      SP70,SISADESC
          MOVE      ZERO,CSIANON 
          MOVE      ZERO,CSIASUS 
          MOVE      SP70,SUSPDESC
          MOVE      SP70,CSICSUP 
          MOVE      SP70,CSICSUT 
          MOVE      ZERO,CSICCCT 
          MOVE      ZERO,CSICLCT 
          MOVE      ZERO,CSICLTM 
          MOVE      SP70,CSICPNO 
          MOVE      SP70,CSICPD1 
          MOVE      SP70,CSICPD2 
          MOVE      ZERO,CSICMAN 
          MOVE      ZERO,CSICAPO 
          MOVE      SP70,CSICUR1 
          MOVE      SP70,CSICUR2 
          MOVE      SP70,CSICUD1 
          MOVE      SP70,CSICUD2 
          MOVE      SP70,CSICUY1 
          MOVE      SP70,CSICUY2 
          MOVE      SP70,CSCRCN1 
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Catalog/Supplier Details           
.--------------------------------------------------------
KY03L000
.
KY03L110
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CSIAISS 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ECATB000
          BRANCH    EXIT,KY03L900,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      CSIACAT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CSIAISS,VAR      
            CALL      DISPITEM
          ENDIF
.
KY03L120
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CSCRCN1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCSCRA00
          MOVE      CSCRCRD,CSICSUP
          BRANCH    EXIT,KY03L110,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      CSICSUP,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CSCRCN1,VAR      
            CALL      DISPITEM
          ENDIF
.
KY03L130
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KSIFAB00
          MOVE      SIFASUPP,CSICSUT
          BRANCH    EXIT,KY03L120,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      CSICSUT,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Catalog/Supplier Details           
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Catalog/Supplier Details           
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Catalog/Supplier Details           
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Catalog/Supplier Details           
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L101,PS03L102,PS03L103:
                            PS03L104,PS03L105,PS03L106,PS03L107:
                            PS03L108,PS03L999,PS03L999,PS03L109:
                            PS03L110,PS03L111,PS03L112,PS03L113:
                            PS03L114,PS03L115,PS03L116,PS03L117:
                            PS03L118,PS03L119,PS03L120,PS03L999:
                           PS03L999,PS03L121,PS03L122,PS03L123:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999
          GOTO     PS03L999
.
PS03L101
          MOVE      CSIADES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      CSIASUB,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      CSIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      CSIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L105
          MOVE      SISADESC,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSIANON,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L107
          MOVE      CSIASUS,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L108
          MOVE      SUSPDESC,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L109
          MOVE      CSICCCT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L110
          MOVE      CSICLCT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L111
          MOVE      CSICLTM,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L112
          MOVE      CSICPNO,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L113
          MOVE      CSICPD1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L114
          MOVE      CSICPD2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSICMAN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L116
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSICAPO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L117
          MOVE      CSICUR1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L118
          MOVE      CSICUR2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L119
          UNPACK    CSICUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L120
          UNPACK    CSICUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L121
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSICUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L122
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSICUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L123
          MOVE      CSCRCN1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Catalog/Supplier Details           
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L101:
                            SF03L102,SF03L103,SF03L104,SF03L105:
                            SF03L106,SF03L107,SF03L108,SF03L109:
                            SF03L110,SF03L111,SF03L112,SF03L006:
                           SF03L006,SF03L113,SF03L114,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L115,SF03L116,SF03L117
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L101:
                            SF03L102,SF03L103,SF03L104,SF03L105:
                            SF03L106,SF03L107,SF03L108,SF03L109:
                            SF03L110,SF03L111,SF03L112,SF03L020:
                           SF03L020,SF03L113,SF03L114,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CSICCCT 
          IF        SCPSMAN=1
            COMPARE   ZERO,CSICCCT 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L101
            ENDIF
          ENDIF
          MOVE      CSICCCT,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L102
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CSICLCT 
          IF        SCPSMAN=1
            COMPARE   ZERO,CSICLCT 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L102
            ENDIF
          ENDIF
          MOVE      CSICLCT,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L103
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CSICLTM 
          IF        SCPSMAN=1
            COMPARE   ZERO,CSICLTM 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L103
            ENDIF
          ENDIF
          MOVE      CSICLTM,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L104
          CALL     SELECTED
          STRIP     CSICPNO 
          SFORMAT   VAR,SCPSLEN
          MOVE      CSICPNO,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CSICPNO 
          SFORMAT   VAR,127
          ENDSET    CSICPNO 
          APPEND    SP70,CSICPNO 
          RESET     CSICPNO 
          CMATCH    EXITCHAR,CSICPNO 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CSICPNO 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L104
            ENDIF
          ENDIF
          MOVE      CSICPNO,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L105
          CALL      DEFPTD00
          CALL     SELECTED
          STRIP     CSICPD1 
          SFORMAT   VAR,SCPSLEN
          MOVE      CSICPD1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CSICPD1 
          SFORMAT   VAR,127
          ENDSET    CSICPD1 
          APPEND    SP70,CSICPD1 
          RESET     CSICPD1 
          CMATCH    EXITCHAR,CSICPD1 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CSICPD1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L105
            ENDIF
          ENDIF
          MOVE      CSICPD1,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L106
          CALL     SELECTED
          STRIP     CSICPD2 
          SFORMAT   VAR,SCPSLEN
          MOVE      CSICPD2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CSICPD2 
          SFORMAT   VAR,127
          ENDSET    CSICPD2 
          APPEND    SP70,CSICPD2 
          RESET     CSICPD2 
          CMATCH    EXITCHAR,CSICPD2 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CSICPD2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L106
            ENDIF
          ENDIF
          MOVE      CSICPD2,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L107
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CSICMAN 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSICMAN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L108
          CALL      DEFAULTY
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CSICAPO 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSICAPO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L109
          CALL     SELECTED
          STRIP     CSICUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      CSICUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CSICUR1 
          SFORMAT   VAR,127
          ENDSET    CSICUR1 
          APPEND    SP70,CSICUR1 
          RESET     CSICUR1 
          CMATCH    EXITCHAR,CSICUR1 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CSICUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L109
            ENDIF
          ENDIF
          MOVE      CSICUR1,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L110
          CALL     SELECTED
          STRIP     CSICUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      CSICUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CSICUR2 
          SFORMAT   VAR,127
          ENDSET    CSICUR2 
          APPEND    SP70,CSICUR2 
          RESET     CSICUR2 
          CMATCH    EXITCHAR,CSICUR2 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CSICUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L110
            ENDIF
          ENDIF
          MOVE      CSICUR2,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L111
          CALL     SELECTED
          CALL      KEYDATE
          PACK      CSICUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    CSICUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L112
          CALL     SELECTED
          CALL      KEYDATE
          PACK      CSICUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    CSICUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L113
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CSICUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSICUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L114
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CSICUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CSICUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L115
          CALL      CAN30000
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L116
          CALL      DEL30000
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L117
          CALL      POS30000
          MOVE      ONE,EXIT
          GOTO      SF03L999
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.@@@@@ Function Restart Point @@@@@
. ------------------------------------------------------------
. Read Catalog Code Keyin Control Information
.
. INCOCATE  FORM      1         67      Catalog Code Type
. 0 Normal Keyin,   1 *JR *DE,   2 Generated ,  3 Generated with Check Digit
. INCONCAT  FORM      7         68      Next Generated Catalog Number
.------------------------------------------------------------
RDCON000  MOVE      "63",SECTOR
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SECTOR;*67,INCOCATE,INCONCAT
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCOCATE
            MOVE      ZERO,INCONCAT
            WRITAB    CONTROLF,SECTOR;*67,INCOCATE,INCONCAT
          ENDIF
.
          MOVE      "23",SECTOR
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SECTOR;*120,HBACK
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,HBACK
            WRITAB    CONTROLF,SECTOR;*120,HBACK
          ENDIF
.
          RETURN
.
.----------------------------------------------------------------------
. Insert a Catalog
.----------------------------------------------------------------------
INSCAT00  CALL      IMAIN000                * Master Details Insert
          BRANCH    EXIT,INSCAT99,INSCAT99  * Cancel
.
          MOVE      CSIACAT,KEY7            * Lock Catalog
          CALL      RLCSIA1
          BRANCH    OVRCD,INSCAT00,INSCAT00 * Somethings Wrong if not on file
.                                           * or Locked so Restart
          MOVE      ONE,ADDFLAG             * Flag First Supplier. Must Default
          CALL      ISUPP000                * Supplier Details
          BRANCH    EXIT,INSCAT90           * Abort Insert
.
INSCAT10  CALL      UUCSIA1                 * Unlock
          GOTO      INSCAT00                * Next
.
INSCAT90  CALL      DELCAT00                * Abort Delete
          GOTO      INSCAT00                * Next Insert
.
INSCAT99  MOVE      ZERO,ADDFLAG            * Clear Add Flag
          RETURN
.------------------------------------------------------------
. Delete a Catalog Code
.------------------------------------------------------------
DELCAT00  MOVE     CSIACAT,KEY7
          CALL     RDCSIA1
          IF       OVRCD=0
            CALL     DECSIA1
          ENDIF
.
          BRANCH   INCOCATE,DELCAT10,DELCAT05,DELCAT05
          GOTO     DELCAT10
.------------------------------------------------------------
. Allow Reuse of Generated Catalog Codes if Possible
.------------------------------------------------------------
DELCAT05  MOVE      "63",SECTOR    * Generated Catalog Code
          READ      CONTROLF,SECTOR;*67,INCOCATE,INCONCAT
          SUB       ONE,INCONCAT
          IF        INCOCATE=2
            MOVE      CSIACAT,CALFORM7
          ELSE
            MOVE      CSIACAT,KEY6
            MOVE      KEY6,CALFORM7
          ENDIF
          IF        INCONCAT=CALFORM7
            WRITAB    CONTROLF,SECTOR;*67,INCOCATE,INCONCAT
          ENDIF
.
DELCAT10  PACK     KEY22,CSIACAT,SP70
          CALL     RSCSCK2
          CALL     RKCSCK2
          BRANCH   OVRCD,DELCAT20
          MATCH    CSCKCAT,CSIACAT
          GOTO     DELCAT20 IF NOT EQUAL
          PACK     KEY22,CSCKCAT,CSCKKWD
          CALL     DECSCK2
          GOTO     DELCAT10
.
DELCAT20
.
DELCAT30  RETURN
.----------------------------------------------------------------------
. Insert main details
.----------------------------------------------------------------------
IMAIN000  MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
IMAIN200  MOVE      ONE,ACCEPT
          MOVE      ONE,INSRTCAT
          CALL      CF01L000      * Clear Fields
.
          CALL      ICATA000      * Insert or Generate Catalog Code
          BRANCH    EXIT,IMAIN999,IMAIN999
.
          MOVE      "000000",CSIASTI
          MOVE      "C",CSIAABC
          MOVE      "0",CSIASAB
          MOVE      "0",CSIASUS
          MOVE      "0",CSIAREX
          MOVE      "1",CSIANON
.
          CALL      WP01L000      * Load any WP Details
          CALL      LM01L000      * Load any Batch Details
          CALL      DF01L000      * Display Fields
          MOVE      ZERO,CANCFLAG
          CALL      SF01L000      * Select Fields
          BRANCH    CANCFLAG,IMAIN900 * Post
          MOVE      ONE,EXIT
          GOTO      IMAIN999
.
IMAIN900  MOVE      ZERO,EXIT
.
IMAIN999  RETURN
.------------------------------------------------------------
. Determine Catalog Code
.------------------------------------------------------------
ICATA000  MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
.
          BRANCH    INCOCATE,ICATA100,ICATA200,ICATA200
.
ICATA100  MOVE      "1",CKEYTYP
          CALL      ECATA000
          BRANCH    EXIT,ICATA900,ICATA900
.
          MOVE      ONE,ACCEPT
          MOVE      CSIACAT,VAR
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          MOVE      CSIACAT,SAVCAT
          GOTO      ICATA999
.
ICATA200  MOVE      ONE,ACCEPT
          MOVE      "Next    ",CSIACAT
          MOVE      "Next    ",VAR
          PACK      CSIADES,EXITCHAR,SP70
          CALL      DISPITEM
          MOVE      ZERO,EXIT
.
          CLEAR     SAVCAT
          APPEND    "Next",SAVCAT
          APPEND    PORT,SAVCAT
          APPEND    SP70,SAVCAT
          RESET     SAVCAT
          GOTO      ICATA999
.
ICATA900  MOVE      ONE,EXIT
ICATA999  RETURN
.------------------------------------------------------------
. Insert Supplier Details
.------------------------------------------------------------
ISUPP000  MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
ISUPP200  MOVE      ONE,ACCEPT
          MOVE      CSIACAT,KEY7
          CALL      CF03L000 * Clear Fields
          CALL      RDCSIA1
.
          CALL      GSUPP000 * Enter Key Fields
          BRANCH    EXIT,ISUPP900,ISUPP900
.
          CALL      WP03L000          * Load any WP Details
          MOVE      ZERO,CANCFLAG
          CALL      SF03L000          * Select Fields
          BRANCH    CANCFLAG,ISUPP800 * Cancel ? Abort Catalog
          MOVE      ZERO,ADDFLAG      * Flag for first supplier in insert
          GOTO      ISUPP000
.
ISUPP800  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          BEEP
          KEYIN     *P1:24,*EL,"Abort Catalog Insert (":
                    *V2LON,"Y",*HOFF,"/":
                    *V2LON,"N",*HOFF,") ? ",*V2LON,ANS
          CALL      MESSAGE3
          REP       UPPLOW,ANS
          MATCH     ANSN,ANS
          GOTO      ISUPP000 IF EQUAL
          MATCH     ANSY,ANS
          GOTO      ISUPP800 IF NOT EQUAL
          MOVE      ONE,EXIT
          GOTO      ISUPP999
.
ISUPP900  MOVE      ZERO,EXIT
          PACK      KEY27,CSIACAT,SP70
          CALL      RSCSIC1
          CALL      RKCSIC1
          BRANCH    OVRCD,ISUPP800
          MATCH     CSIACAT,CSICCAT
          GOTO      ISUPP800 IF NOT EQUAL
.
ISUPP999  RETURN
.
.----------------------------------------------------------------------
. Insert main details
.----------------------------------------------------------------------
MODCAT00  MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
MODCAT20  MOVE      ZERO,INSRTCAT
          CALL      CF01L000      * Clear Fields
.
          CALL      KY01L000      * Insert or Generate Catalog Code
          BRANCH    EXIT,MODCAT99,MODCAT99
          CALL      WP01L000      * Load any WP Details
          CALL      LM01L000      * Load any Batch Details
          CALL      DF01L000      * Display Fields
          CALL      SF01L000      * Select Fields
          GOTO      MODCAT00
.
MODCAT99  RETURN
.
.------------------------------------------------------------
. Update Databases for a Catalog
.------------------------------------------------------------
UPDT0000  DISPLAY   *P1:20,*EF
          HLINE     *G37,20,1,80
          DISPLAY   *P1:22,*EL,"Catalog Code :"
          MOVE      "16",CCOL
          MOVE      "22",CVERT
          MOVE      "0",CKEYTYP
          CALL      KCSIAA00
          BRANCH    EXIT,UPDT9999,UPDT9999
.
          PROC      UPSIN000
.
UPDT9999  RETURN
.----------------------------------------------------------------------
. Procedure to Update Hospital Databases from Corporate System
.----------------------------------------------------------------------
          DEFPROC  UPSIN000
.
          INC      APSMASFD/INC
          INC      SINCIAFD/INC
          INC      SINCIBFD/INC
          INC      SINCICFD/INC
          INC      SINCIDFD/INC
          INC      SINCIEFD/INC
          INC      SINCIFFD/INC
.
          INC      SINCUAFD/INC
.
          INC      SINKCTFD/INC
          INC      SINKEXFD/INC
.
CATDES60  DIM       60
SAVKEY22  DIM       22
SIXTY     FORM      "60"
KEYWRDNO  FORM      2
KEYWRD00  DIM       60
KEYWRD01  DIM       15
KEYWRD02  DIM       15
KEYWRD03  DIM       15
KEYWRD04  DIM       15
KEYWRD05  DIM       15
KEYWRD06  DIM       15
KEYWRD07  DIM       15
KEYWRD08  DIM       15
KEYWRD09  DIM       15
KEYWRD10  DIM       15
LOCKCNT   FORM     2
OPENSIN   FORM     1     * Files Open Indicator
.
UPSIN000  MOVE     ZERO,OPENSIN
          PACK     KEY3,SP70
          CALL     RSIBDB1
UPSIN100  CALL     RKIBDB1                * Update Each Database
          BRANCH   OVRCD,UPSIN900
.
          PACK     KEY10,IBDBDBS,CSIACAT
          CALL     RDCSUA1                * Check Catalog Requires Update
          BRANCH   OVRCD,UPSIN200
.
          CALL     UPCIA000               * Update Master Record
          BRANCH   EXIT,UPSIN200
.
          PACK     KEY10,CSUADBS,CSUACAT
          CALL     DECSUA1                * Delete Update Record
.
UPSIN200  PACK     KEY30,IBDBDBS,CSIACAT,SP70
          CALL     RSCSUC1
UPSIN210  CALL     RKCSUC1                * Check Catalog/Suppliers
          BRANCH   OVRCD,UPSIN300
          MATCH    IBDBDBS,CSUCDBS
          GOTO     UPSIN300 IF NOT EQUAL
          MATCH    CSIACAT,CSUCCAT
          GOTO     UPSIN300 IF NOT EQUAL
.
          CALL     UPCIC000               * Update Catalog/Supplier Record
          BRANCH   EXIT,UPSIN210
.
          PACK     KEY30,CSUCDBS,CSUCCAT,CSUCSUP,CSUCSUT,SP70
          CALL     DECSUC1                * Delete Update Record
          GOTO     UPSIN210
.
UPSIN300  CALL     PALIA000               * Update Alias and Keyword Index
          CALL     CLOSSI00
          GOTO     UPSIN100
.
UPSIN900
UPSIN999  GOTO     UPSINZZZ
.------------------------------------------------------------
. Update Catalog Master Record
.------------------------------------------------------------
UPCIA000  CALL     OPENSI00               * Open Files
          BRANCH   EXIT,UPCIA990
.
          MOVE     CSIACAT,KEY7
          CALL     RDSIIA1                * Read Master Record
          BRANCH   OVRCD,UPCIA100
.
          CALL     LOCCIA00               * Lock Master Record
          BRANCH   EXIT,UPCIA990
.
          CALL     CIAUP000               * Update Master Record
          GOTO     UPCIA900
.
UPCIA100  CALL     CIAWR000               * Write New Masterfile Record
.
UPCIA900  CALL     UUSIIA1
          MOVE     ZERO,EXIT
          GOTO     UPCIA999
.
UPCIA990  MOVE     ONE,EXIT
UPCIA999  RETURN
.------------------------------------------------------------
. Update Catalog/Supplier Record
.------------------------------------------------------------
UPCIC000  CALL     OPENSI00               * Open Files
          BRANCH   EXIT,UPCIC990
.
          PACK     KEY27,CSUCCAT,CSUCSUP,CSUCSUT
          CALL     RDCSIC1
          BRANCH   OVRCD,UPCIC800
.
          MOVE     CSIACAT,KEY7
          CALL     RDSIIA1                * Read Master Record
          BRANCH   OVRCD,UPCIC920
.
          CALL     LOCCIA00               * Lock Master Record
          BRANCH   EXIT,UPCIC930
.
          PACK     KEY27,CSUCCAT,CSUCSUP,CSUCSUT
          CALL     RDSIIC1
          IF       OVRCD=0
            CALL     CICUP000             * Update Record
          ELSE
            CALL     CICWR000             * Write Record
          ENDIF
.
          GOTO     UPCIC900
.
UPCIC800  COMPARE  TWO,CSUCTYP
          GOTO     UPCIC910 IF NOT EQUAL
.
          MOVE     CSIACAT,KEY7
          CALL     RDSIIA1                * Read Master Record
          BRANCH   OVRCD,UPCIC920
.
          CALL     LOCCIA00               * Lock Master Record
          BRANCH   EXIT,UPCIC930
.
          CALL     CICDE000               * Delete Record
          BRANCH   EXIT,UPCIC940
.
UPCIC900  CALL     UUSIIA1
          MOVE     ZERO,EXIT
          GOTO     UPCIC999
.
UPCIC910  MOVE     "Error Invalid Deletion Record  - ",DISPMSG
          BEEP
          CALL     MESSAGE1
          GOTO     UPCIC990
.
UPCIC920  MOVE     "Error Catalog Not Found in Cat/Sup Update - ",DISPMSG
          BEEP
          CALL     MESSAGE1
          GOTO     UPCIC990
.
UPCIC930  CLEAR    DISPMSG
          APPEND   "Can't Lock Catalog on Database ",DISPMSG
          APPEND   IBDBDBS,DISPMSG
          APPEND   " - ",DISPMSG
          RESET    DISPMSG
          BEEP
          CALL     MESSAGE1
          GOTO     UPCIC990
.
UPCIC940  MOVE     "Deletion Failed - ",DISPMSG
          BEEP
          CALL     MESSAGE1
          GOTO     UPCIC990
.
UPCIC990  MOVE     ONE,EXIT
UPCIC999  RETURN
.------------------------------------------------------------
. Lock Master Record for Update
.------------------------------------------------------------
LOCCIA00  MOVE     ZERO,LOCKCNT
          MOVE     ONE,EXIT
          MOVE     CSIACAT,KEY7
LOCCIA10  CALL     RLSIIA1                * Read Master Record
          BRANCH   OVRCD,LOCCIA99,LOCCIA20
          MOVE     ZERO,EXIT
          GOTO     LOCCIA99
LOCCIA20  ADD      ONE,LOCKCNT            * Try Ten Times
          COMPARE  TEN,LOCKCNT
          GOTO     LOCCIA10 IF NOT EQUAL
          CALL     RECLOC00
          BRANCH   EXIT,LOCCIA00
          MOVE     ONE,EXIT
LOCCIA99  RETURN
.------------------------------------------------------------
. Record Locked in Database
.------------------------------------------------------------
RECLOC00  MOVE      SP70,DISPMSG            * Clear Line 24 Message Display
          CALL      MESSAGE2                * Clear Line 24 and Save
          KEYIN     *P1:24,*EL,"Record Locked in Database ",IBDBDBS," - (":
                    *V2LON,"R",*HOFF,")etry or e(":
                    *V2LON,"X",*HOFF,")it ? ",ANS
          CALL      MESSAGE3                * Restore Line 24
          REP       UPPLOW,ANS              * Convert to Upper Case
          MATCH     ANSR,ANS                * Re-try
          GOTO      RECLOC90 IF EQUAL       * Return to locking
          MATCH     ANSX,ANS                * Exit
          GOTO      RECLOC10 IF EQUAL       * Must be a valid response
          MATCH     ANSE,ANS                * Exit
          GOTO      RECLOC00 IF NOT EQUAL   * Must be a valid response
.
RECLOC10  MOVE      TWO,EXIT
          GOTO      RECLOC99
.
RECLOC90  MOVE      ONE,EXIT
RECLOC99  RETURN
.------------------------------------------------------------
. Open Masterfile for Update
.------------------------------------------------------------
OPENSI00  MOVE     ZERO,EXIT
          BRANCH   OPENSIN,OPENSI99
          MOVE     "sinciaaf",KEY8
          STRIP    IBDBDB01
          PACK     KEY50,IBDBDB01,KEY8,SP70
          STRIP    KEY50
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     SINCIAA1,KEY50
          TRAPCLR  IO
          BRANCH   OVRCD,OPENSI90
.
          MOVE     "sincicaf",KEY8
          STRIP    IBDBDB01
          PACK     KEY50,IBDBDB01,KEY8,SP70
          STRIP    KEY50
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     SINCICA1,KEY50
          TRAPCLR  IO
          BRANCH   OVRCD,OPENSI90
.
          MOVE     "sincifaf",KEY8
          STRIP    IBDBDB01
          PACK     KEY50,IBDBDB01,KEY8,SP70
          STRIP    KEY50
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     SINCIFA2,KEY50
          TRAPCLR  IO
          BRANCH   OVRCD,OPENSI90
.
          MOVE     "sinkexaf",KEY8
          STRIP    IBDBDB01
          PACK     KEY50,IBDBDB01,KEY8,SP70
          STRIP    KEY50
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     SINKEXA1,KEY50
          TRAPCLR  IO
          BRANCH   OVRCD,OPENSI90
.
          MOVE     "sinkctaf",KEY8
          STRIP    IBDBDB01
          PACK     KEY50,IBDBDB01,KEY8,SP70
          STRIP    KEY50
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     SINKCTA2,KEY50
          TRAPCLR  IO
          OPEN     SINKCTA1,KEY50
          BRANCH   OVRCD,OPENSI90
.
          MOVE     "sincuaaf",KEY8
          STRIP    IBDBDB01
          PACK     KEY50,IBDBDB01,KEY8,SP70
          STRIP    KEY50
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     SINCUAA1,KEY50
          TRAPCLR  IO
          BRANCH   OVRCD,OPENSI90
          MOVE     ZERO,EXIT
          MOVE     ONE,OPENSIN       * Flag Files As Open
          GOTO     OPENSI99
.
OPENSI90  MOVE     ONE,EXIT
.
OPENSI99  RETURN
.
CLOSSI00  MOVE     ZERO,OPENSIN       * Flag Files As Closed
          CLOSE    SINCIAA1
          CLOSE    SINCICA1
          CLOSE    SINCIFA2
          CLOSE    SINCUAA1
          CLOSE    SINKEXA1
          CLOSE    SINKCTA1
          CLOSE    SINKCTA2
          RETURN
.------------------------------------------------------------
. Move in Fields ans Write New Record
.------------------------------------------------------------
CIAWR000  MOVE      CSIACAT,SIIACAT
          MOVE      CSIADES,SIIADES
          MOVE      CSIASUB,SIIASUB
          MOVE      CSIAISS,SIIAISS
          MOVE      CSIASTI,SIIASTI
          MOVE      CSIAAVC,SIIAAVC
          MOVE      CSIANAT,SIIANAT
          MOVE      CSIAABC,SIIAABC
          MOVE      CSIAPSC,SIIAPSC
          MOVE      CSIAREX,SIIAREX
          MOVE      ONE,SIIANON
          MOVE      CSIASAB,SIIASAB
          MOVE      CSIASUS,SIIASUS
          MOVE      CSIADTC,SIIADTC
          MOVE      CSIATMC,SIIATMC
          MOVE      CSIAUSC,SIIAUSC
          MOVE      CSIAUR1,SIIAUR1
          MOVE      CSIAUR2,SIIAUR2
          MOVE      CSIAUD1,SIIAUD1
          MOVE      CSIAUD2,SIIAUD2
          MOVE      SP70,SIIAUC1
          MOVE      SP70,SIIAUC2
          MOVE      CSIAUY1,SIIAUY1
          MOVE      CSIAUY2,SIIAUY2
          MOVE      SP70,SIIAQIN
          MOVE      SP70,SIIADUN
          MOVE      SP70,SIIASPA
.
          CALL      WRSIIA1       * Write to Hospital Database
          CALL      AUDT0200      * Write to Hospital Corporate Update Audit
          RETURN
.------------------------------------------------------------
. Update Masterfile
.------------------------------------------------------------
CIAUP000  IF        CSIASUS<>0
            CALL      AUDT0900
          ENDIF
.
          MATCH     CSIADES,SIIADES
          IF        !@EQUAL
            CALL      AUDT0700
          ENDIF
.
          MATCH     CSIAPSC,SIIAPSC
          IF        !@EQUAL
            CALL      AUDT1400
          ENDIF
.
          MATCH     CSIASUB,SIIASUB
          IF        !@EQUAL
            CALL      AUDT1500
          ENDIF
.
          MOVE      CSIADES,SIIADES
          MOVE      CSIASUB,SIIASUB
          MOVE      CSIASTI,SIIASTI
          MOVE      CSIANAT,SIIANAT
          MOVE      CSIAPSC,SIIAPSC
          MOVE      CSIASUS,SIIASUS
          MOVE      CSIADTC,SIIADTC
          MOVE      CSIATMC,SIIATMC
          MOVE      CSIAUSC,SIIAUSC
          MOVE      CSIAUR1,SIIAUR1
          MOVE      CSIAUR2,SIIAUR2
          MOVE      CSIAUD1,SIIAUD1
          MOVE      CSIAUD2,SIIAUD2
          MOVE      SP70,SIIAUC1
          MOVE      SP70,SIIAUC2
          MOVE      CSIAUY1,SIIAUY1
          MOVE      CSIAUY2,SIIAUY2
.
          CALL      UPSIIA1             * Update Masterfile
          RETURN
.------------------------------------------------------------
. Move in Fields ans Write New Record
.------------------------------------------------------------
CICWR000  MOVE      CSICCAT,SIICCAT
          MOVE      CSICSUP,SIICSUP
          MOVE      CSICSUT,SIICSUT
          MOVE      CSICCCT,SIICCCT
          MOVE      CSICLCT,SIICLCT
          MOVE      CSICLTM,SIICLTM
          MOVE      CSICPNO,SIICPNO
          MOVE      CSICPD1,SIICPD1
          MOVE      CSICPD2,SIICPD2
          MOVE      CSICMAN,SIICMAN
          MOVE      CSICAPO,SIICAPO
          MOVE      CSICUR1,SIICUR1
          MOVE      CSICUR2,SIICUR2
          MOVE      CSICUD1,SIICUD1
          MOVE      CSICUD2,SIICUD2
          MOVE      SP70,SIICUC1
          MOVE      SP70,SIICUC2
          MOVE      CSICUY1,SIICUY1
          MOVE      CSICUY2,SIICUY2
          MOVE      SP70,SIICSPA
          CALL      WRSIIC1              * Write Hospital Record
          CALL      AUDT0300             * Write Audit File
.
          RETURN
.------------------------------------------------------------
. Update Masterfile
.------------------------------------------------------------
CICUP000  IF        CSICAPO=0
            CALL      AUDT1000
          ENDIF
.
          IF        CSICCCT<>SIICCCT
            CALL      AUDT0400
          ENDIF
.
          MATCH     CSICPNO,SIICPNO
          IF        !@EQUAL
            CALL      AUDT0500
          ENDIF
.
          MATCH     CSICPD1,SIICPD1
          IF        !@EQUAL
            CALL      AUDT0600
          ENDIF
.
          MOVE      CSICCCT,SIICCCT
          MOVE      CSICPNO,SIICPNO
          MOVE      CSICPD1,SIICPD1
          MOVE      CSICPD2,SIICPD2
          MOVE      CSICMAN,SIICMAN
          MOVE      CSICAPO,SIICAPO
          MOVE      CSICUR1,SIICUR1
          MOVE      CSICUR2,SIICUR2
          MOVE      CSICUD1,SIICUD1
          MOVE      CSICUD2,SIICUD2
          MOVE      SP70,SIICUC1
          MOVE      SP70,SIICUC2
          MOVE      CSICUY1,SIICUY1
          MOVE      CSICUY2,SIICUY2
.
          CALL      UPSIIC1             * Update Masterfile
          RETURN
.------------------------------------------------------------
. Delete Masterfile
.------------------------------------------------------------
CICDE000  PACK     KEY27,CSUCCAT,CSUCSUP,CSUCSUT
          CALL     RDSIIC1
          IF       OVRCD=0
            CALL     AUDT1300
            CALL     DESIIC1
          ENDIF
          RETURN
.------------------------------------------------------------
. Post Alias
.------------------------------------------------------------
PALIA000  CALL      OPENSI00
          BRANCH    EXIT,PALIA999
          PACK      KEY67,CSIACAT,SP70
          CALL      RSSIIF2
.
PALIA100  CALL      RKSIIF2
          BRANCH    OVRCD,PALIA200
          MATCH     SIIFCAT,CSIACAT
          GOTO      PALIA200 IF NOT EQUAL
          COMPARE   ZERO,SIIFATY
          GOTO      PALIA100 IF EQUAL
          PACK      KEY67,SIIFCAT,SIIFALI
          CALL      DESIIF2
          GOTO      PALIA100
.
PALIA200  MOVE      CSIACAT,SIIFCAT
          MOVE      CSIADES,SIIFALI
          MOVE      ONE,SIIFATY
          CALL      POSTALIA
.
          CALL      CSMALI00
.
          PACK      KEY27,CSIACAT,SP70
          CALL      RSSIIC1
PALIA300  CALL      RKSIIC1
          BRANCH    OVRCD,PALIA400
          MATCH     SIICCAT,CSIACAT
          GOTO      PALIA400 IF NOT EQUAL
.
          PACK      SIIFALI,SIICPD1,SP70
          MOVE      CSIACAT,SIIFCAT
          MOVE      TWO,SIIFATY
          CALL      POSTALIA
.
          PACK      SIIFALI,SIICPD2,SP70
          MOVE      CSIACAT,SIIFCAT
          MOVE      TWO,SIIFATY
          CALL      POSTALIA
.
          PACK      SIIFALI,SIICPNO,SP70
          MOVE      CSIACAT,SIIFCAT
          MOVE      THREE,SIIFATY
          CALL      POSTALIA
          GOTO      PALIA300
.
PALIA400  CALL      WRKCT000            * Update Keyword Index
.
PALIA999  RETURN
.
POSTALIA  MATCH     SP70,SIIFALI
          RETURN    IF EQUAL
          PACK      KEY67,SIIFCAT,SIIFALI
          CALL      RASIIF2
          IF        OVRCD=1
            CALL      WRSIIF2
          ENDIF
          RETURN
.------------------------------------------------------------
. Post Corporate Alias Detials
.------------------------------------------------------------
CSMALI00  MOVE      CSIACAT,KEY7
          CALL      RDCSIF1
          BRANCH    OVRCD,CSMALI99
.
          MATCH     SP70,CSIFDE01
          IF        !@EQUAL
            MOVE      CSIFCAT,SIIFCAT
            MOVE      CSIFDE01,SIIFALI
            MOVE      ZERO,SIIFATY
            CALL      POSTALIA
          ENDIF
.
          MATCH     SP70,CSIFDE02
          IF        !@EQUAL
            MOVE      CSIFCAT,SIIFCAT
            MOVE      CSIFDE02,SIIFALI
            MOVE      ZERO,SIIFATY
            CALL      POSTALIA
          ENDIF
.
          MATCH     SP70,CSIFDE03
          IF        !@EQUAL
            MOVE      CSIFCAT,SIIFCAT
            MOVE      CSIFDE03,SIIFALI
            MOVE      ZERO,SIIFATY
            CALL      POSTALIA
          ENDIF
.
          MATCH     SP70,CSIFDE04
          IF        !@EQUAL
            MOVE      CSIFCAT,SIIFCAT
            MOVE      CSIFDE04,SIIFALI
            MOVE      ZERO,SIIFATY
            CALL      POSTALIA
          ENDIF
.
          MATCH     SP70,CSIFDE05
          IF        !@EQUAL
            MOVE      CSIFCAT,SIIFCAT
            MOVE      CSIFDE05,SIIFALI
            MOVE      ZERO,SIIFATY
            CALL      POSTALIA
          ENDIF
.
          MATCH     SP70,CSIFDE06
          IF        !@EQUAL
            MOVE      CSIFCAT,SIIFCAT
            MOVE      CSIFDE06,SIIFALI
            MOVE      ZERO,SIIFATY
            CALL      POSTALIA
          ENDIF
.
          MATCH     SP70,CSIFDE07
          IF        !@EQUAL
            MOVE      CSIFCAT,SIIFCAT
            MOVE      CSIFDE07,SIIFALI
            MOVE      ZERO,SIIFATY
            CALL      POSTALIA
          ENDIF
.
          MATCH     SP70,CSIFDE08
          IF        !@EQUAL
            MOVE      CSIFCAT,SIIFCAT
            MOVE      CSIFDE08,SIIFALI
            MOVE      ZERO,SIIFATY
            CALL      POSTALIA
          ENDIF
.
CSMALI99  RETURN
.------------------------------------------------------------
. Generate Catalog Word Index
.------------------------------------------------------------
WRKCT000  CALL     CLEAR000
          PACK     KEY67,SIIACAT,SP70
          CALL     RSSIIF2
WRKCT100  CALL     RKSIIF2
          BRANCH   OVRCD,WRKCT999
          MATCH    SIIFCAT,SIIACAT
          GOTO     WRKCT999 IF NOT EQUAL
.
          MOVE     SIIFALI,CATDES60
          CALL     BWORD000
          GOTO     WRKCT100
.
WRKCT999  RETURN
.------------------------------------------------------------
. Recreate File
.------------------------------------------------------------
CLEAR000  PACK     KEY22,SIIACAT,SP70
          CALL     RSSIKC2
          CALL     RKSIKC2
          BRANCH   OVRCD,CLEAR999
          MATCH    SIIACAT,SIKCCAT
          GOTO     CLEAR999 IF NOT EQUAL
.
          PACK     KEY22,SIKCCAT,SIKCKWD,SP70
          CALL     DESIKC2
          GOTO     CLEAR000
.
CLEAR999  RETURN
.-------------------------------------------------
. Format Given Names
.-------------------------------------------------
BWORD000  CMATCH    SP1,CATDES60             * Eliminate leading blanks
          IF        @EQUAL
            BUMP      CATDES60
            GOTO      BWORD000 IF NOT EOS
            GOTO      BWORD999               * entire name if blank
          ENDIF
          PACK      KEY60,CATDES60,SP30        * reset form pointer
          MOVE      KEY60,CATDES60
.
          SCAN      SP1,CATDES60               * Locate the first blank
          GOTO      BWORD100 IF NOT EQUAL
          BUMP      CATDES60,-1              * go back 1 to end of name
          MOVEFPTR  CATDES60,CCITEM          * another handly form field
          RESET     CATDES60                 * reset the form pointer
          SETLPTR   CATDES60,CCITEM          * set logical length to end of name
.
.         Save this Word
.
BWORD100  MOVE      CATDES60,KEY15
          PACK      KEY15,KEY15,SP70
          REP       UPPLOW,KEY15
          CALL      RDSIKE1                  * Check Exclusion
          COMPARE   ZERO,OVRCD
          GOTO      BWORD190 IF EQUAL
.
          PACK      KEY22,KEY15,SIIFCAT
          UNPACK    KEY22,SIKCKWD,SIKCCAT
          CALL      RDSIKC1
          IF        OVRCD=1
            CALL      WRSIKC1
          ENDIF
          GOTO      BWORD190
.
.         Check for any more words
.
BWORD190  SETLPTR   CATDES60,SIXTY         * reset logical length
          ADD       ONE,CCITEM             * position of 1st blank
          RESET     CATDES60,CCITEM        * reset to this point
          PACK      KEY60,CATDES60,SP30    * reset form pointer
          MOVE      KEY60,CATDES60
.
          GOTO      BWORD000
.
BWORD999  RETURN
.------------------------------------------------------------
          INC      CSMAUD01
          INC      SINCIAIO/INC
          INC      SINCIBIO/INC
          INC      SINCICIO/INC
          INC      SINCIDIO/INC
          INC      SINCIEIO/INC
          INC      SINCIFIO/INC
          INC      SINCUAIO/INC
          INC      SINKCTIO/INC
          INC      SINKEXIO/INC
          INC      IBAOVRIO/INC
.
UPSINZZZ  ENDPROC
.
DEFAULTN    MOVE     ANSN,DEFYESNO
            RETURN
.------------------------------------------------------------
. Enter Catalog Code
.------------------------------------------------------------
ECATA000  CALL      UUCSIA1
          CALL      KCSIAA00
          BRANCH    EXIT,ECATA999,ECATA999
.
          COMPARE   ONE,OVRCD
          GOTO      ECATA999 IF EQUAL
.
ECATA100  CALL      GETALI00
          MOVE      CSIACAT,KEY7
          MOVE      CSIACAT,SAVCAT
          CALL      RLCSIA1
          BRANCH    OVRCD,ECATA999,ECATA200
          MOVE      TWO,AUDTTYPE
          CALL      WACSIA00          * Write Before Audit
.
          MOVE      CSIANON,SAVNON
.
          MOVE      CSIAPSC,KEY5
          CALL      RDCSCR1
.
          MOVE      CSIASUB,KEY5
          CALL      RDSISA1
.
          ADD       ONE,CSIASUS
          BRANCH    CSIASUS,ECATA110,ECATA120,ECATA130,ECATA140
ECATA110  MOVE      "Not Suspend               ",SUSPDESC
          GOTO      ECATA190
ECATA120  MOVE      "Requisitions              ",SUSPDESC
          GOTO      ECATA190
ECATA130  MOVE      "Suspend P/O              ",SUSPDESC
          GOTO      ECATA190
ECATA140  MOVE      "Suspend P/O & Requisition",SUSPDESC
          GOTO      ECATA190
ECATA190  SUB       ONE,CSIASUS
.
          MOVE      ZERO,EXIT
          MOVE      ZERO,OVRCD
          GOTO      ECATA999
.
ECATA200  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          KEYIN     *P1:24,*EL,"Record Locked - (":
                    *V2LON,"R",*HOFF,")etry or e(":
                    *V2LON,"X",*HOFF,")it ? ",ANS
          CALL      MESSAGE3
          REP       UPPLOW,ANS
          MATCH     ANSR,ANS
          GOTO      ECATA100 IF EQUAL
          MATCH     ANSX,ANS
          GOTO      ECATA000 IF EQUAL
          MATCH     ANSE,ANS
          GOTO      ECATA200 IF NOT EQUAL
          GOTO      ECATA000
ECATA999  RETURN
.------------------------------------------------------------
. Get Alias Details
.------------------------------------------------------------
GETALI00  MOVE      CSIACAT,KEY8
          CALL      RDCSIF1
          IF        OVRCD=1
            MOVE      SP70,CSIFDE01
            MOVE      SP70,CSIFDE02
            MOVE      SP70,CSIFDE03
            MOVE      SP70,CSIFDE04
            MOVE      SP70,CSIFDE05
            MOVE      SP70,CSIFDE06
            MOVE      SP70,CSIFDE07
            MOVE      SP70,CSIFDE08
            MOVE      SP70,CSIFSPA
          ENDIF
          RETURN
.
.--------------------------------------------------
. Enter Issue Unit
.--------------------------------------------------
EIUNT000  IF        ACCEPT<>1
            PROC      CHKISS00   * Not in Insert Mode so Check History
            BRANCH    EXIT,EIUNT900
          ENDIF
          MOVE      SP70,SIFASUPP
          MOVE      ZERO,CKEYTYP
          CALL      KSIFAA00
          BRANCH    EXIT,EIUNT999,EIUNT999
          MOVE      SIFAISSU,CSIAISS
.
EIUNT900  MOVE      ZERO,EXIT
.
EIUNT999  RETURN
.
          DEFPROC   CHKISS00
.
          INC       SINPOAFD/INC
          INC       SINPOCFD/INC
.--------------------------------------------------
. Check for Activity on Catalog Code
.--------------------------------------------------
CHKISS00  MOVE      ZERO,EXIT
          PACK      KEY3,SP70
          CALL      RSIBDB1
CHKISS10  CALL      RKIBDB1                * Update Each Database
          BRANCH    OVRCD,CHKISS99
.
          MOVE      "sinpoaaf",KEY8
          STRIP     IBDBDB01
          PACK      KEY50,IBDBDB01,KEY8,SP70
          STRIP     KEY50
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SINPOCA1,KEY50
          TRAPCLR   IO
.
          MOVE      "sinpocaf",KEY8
          STRIP     IBDBDB01
          PACK      KEY50,IBDBDB01,KEY8,SP70
          STRIP     KEY50
          TRAP      OVERCOND IF IO
          OPEN      SINPOCA6,KEY50
          TRAPCLR   IO
          IF        OVRCD=1
            BEEP
            CLEAR     DISPMSG
            APPEND    "Can't Open Hospital Database ",DISPMSG
            APPEND    IBDBDBS,DISPMSG
            APPEND    " - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
            GOTO      CHKISS10
          ENDIF
.
          PACK      KEY25,CSIACAT,SP70
          CALL      RSSIPC6
CHKISS20  CALL      RKSIPC6
          BRANCH    OVRCD,CHKISS10
          MATCH     SIPCCAT,CSIACAT
          GOTO      CHKISS10 IF NOT EQUAL
          PACK      KEY7,SIPCPON,SP70
          CALL      RDSIPA1
          BRANCH    OVRCD,CHKISS20
          MATCH     SIPADCN,SP70
          GOTO      CHKISS20 IF NOT EQUAL
.
          MOVE      SP70,ANS
          PACK      DISPMSG,SP70,SP70
          RESET     DISPMSG
          APPEND    "Catalog used in Database ",DISPMSG
          APPEND    IBDBDBS,DISPMSG
          APPEND    " Cannot Change Issue Unit. ",DISPMSG
          BEEP
          CALL      MESSAGE1
          MOVE      ONE,EXIT
.
CHKISS99  CLOSE     SINPOCA6
          GOTO      CHKISSZZ
.
          INC       SINPOAIO/INC
          INC       SINPOCIO/INC
          INC       IBAOVRIO/INC
.
CHKISSZZ  ENDPROC
.
.------------------------------------------------------------
. Enter Stock Indicators
.------------------------------------------------------------
ESTI0000  MOVE      SP70,DISPMSG
          CALL      DCODE000
          CLEAR     CSIASTI
          MOVE      CCOL,F2
          MOVE      ZERO,CLNO
ESTI1000  KEYIN     *PF2:CVERT,*V2LON,*DE,*+,ANS
          RESET     ANS
          GOTO      ESTI2000 IF EOS
          MATCH     "0",ANS
          GOTO      ESTI1100 IF EQUAL
          MATCH     "1",ANS
          GOTO      ESTI1100 IF EQUAL
          BEEP
          GOTO      ESTI1000
.
ESTI1100  ADD       ONE,F2
          ADD       ONE,CLNO
          APPEND    ANS,CSIASTI
          COMPARE   SIX,CLNO
          GOTO      ESTI1000 IF LESS
.
ESTI2000  APPEND    "000000",CSIASTI
          RESET     CSIASTI
          DISPLAY   *PCCOL:CVERT,*V2LON,CSIASTI
          CALL      PUTSCR00
          RETURN
.
DCODE000  MOVE      "15",HTOP
          MOVE      "44",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P52:16,*V2LON,*ULON,"Sequence Descriptions"
          MOVE      ONE,F1
DCODE100  PACK      KEY6,ANSC,ANSA,ANST,F1,SP70
          CALL      RDSICD1
          IF        OVRCD=1
            MOVE      "No Description on Code",SICDDESC
          ENDIF
          ASSIGN    F1+16,F2
          DISPLAY   *P46:F2,*V2LON,F1,". ",*HOFF,SICDDESC
          ADD       ONE,F1
          COMPARE   SEVEN,F1
          GOTO      DCODE100 IF NOT EQUAL
          DISPLAY   *P46:23,"Enter ",*V2LON,"1",*HOFF," to Include"
          RETURN
.------------------------------------------------------------
. Enter ABC Indicator
.------------------------------------------------------------
EABC0000  KEYIN     *PCCOL:CVERT,*V2LON,*RV,CSIAABC
          REP       UPPLOW,CSIAABC
          MATCH     ANSA,CSIAABC
          GOTO      EABC9999 IF EQUAL
          MATCH     ANSB,CSIAABC
          GOTO      EABC9999 IF EQUAL
          MATCH     ANSC,CSIAABC
          GOTO      EABC9999 IF EQUAL
          BEEP
          GOTO      EABC0000
EABC9999  RETURN
.------------------------------------------------------------
. Enter Preffered Supplier Code
.------------------------------------------------------------
EPSUP000  CALL      KCSCRA000
          MOVE      CSCRCRD,CSIAPSC
          BRANCH    EXIT,EPSUP999,EPSUP999
          BRANCH    ACCEPT,EPSUP999
          PACK      KEY27,CSIACAT,CSIAPSC,SP70
          CALL      RSCSIC1
          CALL      RKCSIC1
          BRANCH    OVRCD,EPSUP100
.
          MATCH     CSIACAT,CSICCAT
          GOTO      EPSUP100 IF NOT EQUAL
          MATCH     CSIAPSC,CSICSUP
          GOTO      EPSUP999 IF EQUAL
.
EPSUP100  MOVE      "Warning Supplier is not Attached to this Catalog. ",DISPMSG
          CALL      MESSAGE1
.
EPSUP999  RETURN
.
.------------------------------------------------------------
. Enter Stock/Non Stock Flag
.------------------------------------------------------------
ESNON000  MOVE    ANSN,DEFYESNO
          CALL    YORN0000
          IF      FYESNO=0
            MOVE    "1",CSIANON  * No Non Stock
          ELSE
            MOVE    "0",CSIANON  * Yes Stocked
          ENDIF
.
ESNON999  RETURN
.
.------------------------------------------------------------
. Enter Suspension Indicator
.------------------------------------------------------------
ESUS0000  MOVE      ZERO,CSIASUS
          MOVE      SP70,DISPMSG
          CALL      MESSAGE2
.
ESUS1000  DISPLAY   *P1:24,*EL:
                    *V2LON,"0",*HOFF," = Not Suspend  ":
                    *V2LON,"1",*HOFF," = Requisitions  ":
                    *V2LON,"2",*HOFF," = Suspend P/O  ":
                    *V2LON,"3",*HOFF," = Suspend P/O & Requisit."
.
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,CSIASUS
          ADD       ONE,CSIASUS
          BRANCH    CSIASUS,ESUS2100,ESUS2200,ESUS2300,ESUS2400
          BEEP
          GOTO      ESUS1000
.
ESUS2100  MOVE      "Not Suspend               ",SUSPDESC
          GOTO      ESUS3000
ESUS2200  MOVE      "Requisitions              ",SUSPDESC
          GOTO      ESUS3000
ESUS2300  MOVE      "Suspend P/O              ",SUSPDESC
          GOTO      ESUS3000
ESUS2400  MOVE      "Suspend P/O & Requisition",SUSPDESC
          GOTO      ESUS3000
ESUS3000  SUB       ONE,CSIASUS
          CALL      MESSAGE3
          RETURN
.
.------------------------------------------------------------
. Cancel Master Details Maintenance
.------------------------------------------------------------
CAN10000  PACK     KEY7,CSIACAT
          CALL     RACSIA1
          IF       OVRCD=0
            CALL     DACSIA00                 * Delete Before Audit
            CALL     UUCSIA1                  * Unlock
          ELSE
            CALL     DALI0000                 * delete any save aliases
          ENDIF
          RETURN
.
.---- delete any saved Key Words ----
.
DALI0000  PACK     KEY22,CSIACAT,SP70
          CALL     RSCSCK2
          CALL     RKCSCK2
          BRANCH   OVRCD,DALI9999
          MATCH    CSCKCAT,CSIACAT
          GOTO     DALI9999 IF NOT EQUAL
          PACK     KEY22,CSCKCAT,CSCKKWD,SP70
          CALL     DECSCK2
          GOTO     DALI0000
DALI9999  RETURN
.------------------------------------------------------------
. Post Master Screen
.------------------------------------------------------------
POS10000  MOVE     ONE,CANCFLAG
          MATCH    "Next   ",CSIACAT
          CALL     GETCAT00 IF EQUAL
.
          PACK     KEY7,CSIACAT
          CLOCK    TIME,CTIMEIS
          PACK     CSIADTC,CCC,CYY,CMM,CDD
          REP      " 0",CSIADTC
          MOVE     CTIMEIS,CSIATMC
          MOVE     PASSCODE,CSIAUSC
.
          CALL     RACSIA1
          BRANCH   OVRCD,POS10200
          BRANCH   INSRTCAT,POS10100
.
          MOVE     ONE,UPDTYPE      * Update
          CALL     WRDBS000         * Write to DBS files for Update
          CALL     UPCSIA1
          MOVE     THREE,AUDTTYPE
          MOVE     FALSE,INSCAT
          CALL     WACSIA00
          CALL     UUCSIA1
          GOTO     POS10300
.
POS10100  CALL     DUPCAT00
          BRANCH   EXIT,POS19900,POS19900
.
POS10200  MOVE     ZERO,UPDTYPE     * Add
          CALL     WRDBS000         * Write to DBS files for Update
          CALL     WRCSIA1
          MOVE     TRUE,INSCAT
          MOVE     ONE,AUDTTYPE
          CALL     WACSIA00                 * Audit Add
          PACK     CSICPD1,SP70
          PACK     CSICPD2,SP70
          PACK     CSICPNO,SP70
          MOVE     CSIACAT,SAVCAT
.
POS10300  CALL     UPKEY000            * Update Key Word Index
          MOVE     CSIACAT,CSIFCAT
          MOVE     CSIACAT,KEY8
          CALL     RACSIF1
          IF       OVRCD=0
            CALL     UPCSIF1
          ELSE
            CALL     WRCSIF1
          ENDIF
.
POS19000  CALL     CKISS000           * check issue unit
.
POS19500  MOVE     ZERO,EXIT
          GOTO     POS19999
.
POS19900  MOVE     ONE,EXIT
.
POS19999  RETURN
.------------------------------------------------------------
. Duplicate Catalog on Post So enter new Catalog
.------------------------------------------------------------
DUPCAT00  MOVE     "Catalog has been posted by someone else - ",DISPMSG
          BEEP
          CALL     MESSAGE1
.
          DISPLAY  *P1:24,"Enter New Catalog Code : ";
          MOVE     TWENTY6,CCOL
          MOVE     TWENTY4,CVERT
          MOVE     "1",CKEYTYP
          CALL     KCSIAA00
          BRANCH   EXIT,DUPCAT99,DUPCAT99
.
          MOVE     ZERO,EXIT
          MOVE     CSIACAT,VAR
          CALL     DISPITEM
          MOVE     CSIACAT,KEY7
.
DUPCAT99  RETURN
.------------------------------------------------------------
. Check issue unit
.------------------------------------------------------------
CKISS000  PACK      KEY27,CSIACAT,SP70
          CALL      RSCSIC1
CKISS100  CALL      RKCSIC1            * loop through all linked supply units
          BRANCH    OVRCD,CKISS999
          MATCH     CSIACAT,CSICCAT
          GOTO      CKISS999 IF NOT EQUAL
.
          PACK      KEY30,CSIAISS,CSICSUT,SP70
          UNPACK    KEY30,SIFAISSU,SIFASUPP
          CALL      RDSIFA1            * check if factor exists
          IF        OVRCD=1
            PACK      DISPMSG,SP70,SP70
            CALL      MESSAGE2
            REPEAT
              MOVE      ONE,SIFACTOR
              KEYIN     *P1:24,"Factor Missing For ":
                        *V2LON,*DV,CSIAISS,*DV,SLASH,*DV,CSICSUT,*HOFF:
                        ". Enter Factor : ",*V2LON,*RV,SIFACTOR;
            UNTIL     SIFACTOR>0
            CALL      MESSAGE3
.
            CALL     WRSIFA1
            MOVE     ONE,AUDTTYPE
            CALL     WASIFA00
.
            PACK     KEY15,SIFASUPP              * Blank Record for Issue Unit
            PACK     KEY30,SIFAISSU,SP70
            UNPACK   KEY30,SIFAISSU,SIFASUPP
            CALL     RASIFA1
            IF       OVRCD=1
              MOVE     ONE,SIFACTOR
              CALL     WRSIFA1
            ENDIF
.
            PACK     KEY30,SP10,SP5,KEY15        * Blank Record for Supply Unit
            UNPACK   KEY30,SIFAISSU,SIFASUPP
            CALL     RASIFA1
            IF       OVRCD=1
              MOVE     ONE,SIFACTOR
              CALL     WRSIFA1
            ENDIF
          ENDIF
          GOTO      CKISS100
.
CKISS999  RETURN
.------------------------------------------------------------
. Get Next Catalog Code
.------------------------------------------------------------
GETCAT00  MOVE      "63",SECTOR
          READ      CONTROLF,SECTOR;*68,INCONCAT
          ADD       ONE,INCONCAT
          WRITAB    CONTROLF,SECTOR;*68,INCONCAT
          SUB       ONE,INCONCAT
.
          COMPARE   TWO,INCOCATE
          GOTO      GETCAT10 IF EQUAL
.
          ASSIGN    (INCONCAT%13)*13,FORM1
          PACK      KEY8,INCONCAT,FORM1
          UNPACK    KEY8,KEY1,KEY7
          MOVE      KEY7,INCONCAT
.
GETCAT10  MOVE     INCONCAT,KEY7
          MOVE     INCONCAT,CSIACAT
          CALL     RACSIA1
          COMPARE  ZERO,OVRCD
          GOTO     GETCAT00 IF EQUAL
.
GETCAT99  RETURN
.------------------------------------------------------------
. Update Key Word Index File
.------------------------------------------------------------
UPKEY000  CALL     CLEAR000
          PACK     KEYDES60,CSIADES
          CALL     BWORD000
.
          MATCH    SP70,CSIFDE01
          IF       !@EQUAL
            PACK     KEYDES60,CSIFDE01
            CALL     BWORD000
          ENDIF
.
          MATCH    SP70,CSIFDE02
          IF       !@EQUAL
            PACK     KEYDES60,CSIFDE02
            CALL     BWORD000
          ENDIF
.
          MATCH    SP70,CSIFDE03
          IF       !@EQUAL
            PACK     KEYDES60,CSIFDE03
            CALL     BWORD000
          ENDIF
.
          MATCH    SP70,CSIFDE04
          IF       !@EQUAL
            PACK     KEYDES60,CSIFDE04
            CALL     BWORD000
          ENDIF
.
          MATCH    SP70,CSIFDE05
          IF       !@EQUAL
            PACK     KEYDES60,CSIFDE05
            CALL     BWORD000
          ENDIF
.
          MATCH    SP70,CSIFDE06
          IF       !@EQUAL
            PACK     KEYDES60,CSIFDE06
            CALL     BWORD000
          ENDIF
.
          MATCH    SP70,CSIFDE07
          IF       !@EQUAL
            PACK     KEYDES60,CSIFDE07
            CALL     BWORD000
          ENDIF
.
          MATCH    SP70,CSIFDE08
          IF       !@EQUAL
            PACK     KEYDES60,CSIFDE08
            CALL     BWORD000
          ENDIF
.
          PACK     KEY27,CSIACAT,SP70
          CALL     RSCSIC1
UPKEY100  CALL     RKCSIC1            * loop through all linked supply units
          BRANCH   OVRCD,UPKEY999
          MATCH    CSIACAT,CSICCAT
          GOTO     UPKEY999 IF NOT EQUAL
.
          PACK     KEYDES60,CSICPD1
          CALL     BWORD000
.
          PACK     KEYDES60,CSICPD2
          CALL     BWORD000
.
          PACK     KEYDES60,CSICPNO,SP70
          CALL     BWORD000
          GOTO     UPKEY100
.
UPKEY999  RETURN
.------------------------------------------------------------
. Recreate File
.------------------------------------------------------------
CLEAR000  PACK     KEY22,CSIACAT,SP70
          CALL     RSCSCK2
          CALL     RKCSCK2
          BRANCH   OVRCD,CLEAR999
          MATCH    CSIACAT,CSCKCAT
          GOTO     CLEAR999 IF NOT EQUAL
.
          PACK     KEY22,CSCKCAT,CSCKKWD,SP70
          CALL     DECSCK2
          GOTO     CLEAR000
.
CLEAR999  RETURN
.-------------------------------------------------
. Format Words for Index
.-------------------------------------------------
BWORD000  CMATCH    SP1,KEYDES60             * Eliminate leading blanks
          IF        @EQUAL
            BUMP      KEYDES60
            GOTO      BWORD000 IF NOT EOS
            GOTO      BWORD999               * entire name if blank
          ENDIF
          PACK      KEY60,KEYDES60,SP30        * reset form pointer
          MOVE      KEY60,KEYDES60
.
          SCAN      SP1,KEYDES60               * Locate the first blank
          GOTO      BWORD100 IF NOT EQUAL
          BUMP      KEYDES60,-1              * go back 1 to end of name
          MOVEFPTR  KEYDES60,CCITEM          * another handly form field
          RESET     KEYDES60                 * reset the form pointer
          SETLPTR   KEYDES60,CCITEM          * set logical length to end of name
.
.         Save this Word
.
BWORD100  MOVE      KEYDES60,KEY15
          PACK      KEY15,KEY15,SP70
          REP       UPPLOW,KEY15
          PACK      KEY22,KEY15,CSIACAT
          UNPACK    KEY22,CSCKKWD,CSCKCAT
          CALL      RDCSCK1
          IF        OVRCD=1
            CALL      WRCSCK1
          ENDIF
          GOTO      BWORD190
.
.         Check for any more words
.
BWORD190  SETLPTR   KEYDES60,SIXTY         * reset logical length
          ADD       ONE,CCITEM             * position of 1st blank
          RESET     KEYDES60,CCITEM        * reset to this point
          PACK      KEY60,KEYDES60,SP30    * reset form pointer
          MOVE      KEY60,KEYDES60
.
          GOTO      BWORD000
.
BWORD999  RETURN
.------------------------------------------------------------
. Write to Database Update Control File
.------------------------------------------------------------
WRDBS000  PACK      KEY3,SP70
          CALL      RSIBDB1
WRDBS100  CALL      RKIBDB1
          BRANCH    OVRCD,WRDBS999
          PACK      KEY10,IBDBDBS,CSIACAT
          UNPACK    KEY10,CSUADBS,CSUACAT
          CALL      RACSUA1
          IF        OVRCD=1
            MOVE      UPDTYPE,CSUATYP
            MOVE      SP70,CSUASPA
            CALL      WRCSUA1
          ENDIF
          GOTO       WRDBS100
WRDBS999  RETURN
.
.------------------------------------------------------------
. Read Supplier Details for Batch Screen
.------------------------------------------------------------
SUPDET00  PACK      KEY5,CSICSUP
          CALL      RDCSCR1
          PACK      KEY30,CSIAISS,CSICSUT
          CALL      RDSIFA1
          ASSIGN    CSICCCT/SIFACTOR,ISSCCOST
          ASSIGN    CSICLCT/SIFACTOR,ISSLCOST
          RETURN
.
.------------------------------------------------------------
. Enter Catalog Code (no Audit)
.------------------------------------------------------------
ECATB000  CALL      UUCSIA1
          MOVE      ZERO,CKEYTYP
          CALL      KCSIAA00
          BRANCH    EXIT,ECATB999,ECATB999
.
ECATB100  CALL      GETALI00
          MOVE      CSIACAT,KEY5
          CALL      RLCSIA1
          BRANCH    OVRCD,ECATB999,ECATB200
.
          MOVE      CSIAPSC,KEY5
          CALL      RDCSCR1
.
          MOVE      CSIASUB,KEY5
          CALL      RDSISA1
.
          ADD       ONE,CSIASUS
          BRANCH    CSIASUS,ECATB110,ECATB120,ECATB130,ECATB140
ECATB110  MOVE      "Not Suspend               ",SUSPDESC
          GOTO      ECATB190
ECATB120  MOVE      "Requisitions              ",SUSPDESC
          GOTO      ECATB190
ECATB130  MOVE      "Suspend P/O              ",SUSPDESC
          GOTO      ECATB190
ECATB140  MOVE      "Suspend P/O & Requisition",SUSPDESC
          GOTO      ECATB190
ECATB190  SUB       ONE,CSIASUS
.
          MOVE      ZERO,EXIT
          MOVE      ZERO,OVRCD
          GOTO      ECATB999
.
ECATB200  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          KEYIN     *P1:24,*EL,"Record Locked - (":
                    *V2LON,"R",*HOFF,")etry or e(":
                    *V2LON,"X",*HOFF,")it ? ",ANS
          CALL      MESSAGE3
          REP       UPPLOW,ANS
          MATCH     ANSR,ANS
          GOTO      ECATB100 IF EQUAL
          MATCH     ANSX,ANS
          GOTO      ECATB000 IF NOT EQUAL
          MATCH     ANSE,ANS
          GOTO      ECATB200 IF NOT EQUAL
          GOTO      ECATB000
.
ECATB999  RETURN
.------------------------------------------------------------
. Modify Supplier Details
.------------------------------------------------------------
MODSUP00  MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
MODSU200  CALL      DSUPP000 * Display Key Fields
          BRANCH    EXIT,MODSU999
          CALL      WP03L000 * Load any WP Details
          CALL      DF03L000 * Display Fields
          CALL      SF03L000 * Select Fields
.
MODSU999  RETURN
.--------------------------------------------------------------------
. Display Key Fields for Supplier Details and Write Before Audit
.--------------------------------------------------------------------
DSUPP000  MOVE      CSIC1MKY,KEY27
          CALL      RDCSIC1
          IF        OVRCD=1
            MOVE      "Catalog/Supplier/Supply Unit Not File. - ",DISPMSG
            CALL      MESSAGE1
            GOTO      DSUPP900
          ENDIF
.
          MOVE      CSICCCT,SCSICCCT
.
          MOVE      TWO,AUDTTYPE
          CALL      WACSIC00          * Write Before Audit
.
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      CSIACAT,CSICCAT
          MOVE      CSIACAT,VAR
          CALL      DISPITEM
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      CSICSUP,KEY5
          CALL      RDCSCR1
          MOVE      CSICSUP,VAR
          CALL      DISPITEM
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      ZERO,ACCEPT
          MOVE      CSICSUT,VAR
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      DSUPP999
.
DSUPP900  MOVE      ONE,EXIT
DSUPP999  RETURN
.------------------------------------------------------------
. Add Supplier to Catalog
.------------------------------------------------------------
ADDSUP00
.
ADDSU100  MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
ADDSU200  MOVE      ONE,ACCEPT
          MOVE      CSIACAT,KEY7
          CALL      CF03L000 * Clear Fields
          CALL      RDCSIA1
.
          MOVE      ZERO,ADDFLAG  * Flag for Insert of Preferred Supplier
          CALL      GSUPP000 * Enter Key Fields
          BRANCH    EXIT,ADDSU999,ADDSU999
.
          MOVE      ZERO,SCSICCCT
          CALL      WP03L000 * Load any WP Details
          CALL      SF03L000 * Select Fields
.
ADDSU999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Supplier Details
.--------------------------------------------------------
GSUPP000  MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      CSIACAT,CSICCAT
          MOVE      CSIACAT,VAR
          CALL      DISPITEM
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CSIADES,VAR
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CSIAISS,VAR
            CALL      DISPITEM
          ENDIF
.
GSUPP120  MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CSCRCN1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          IF        ADDFLAG=1
            MOVE      CSIAPSC,KEY5
            CALL      RDCSCR1
            IF        OVRCD=0
              MOVE      KEY5,CSICSUP
              GOTO      GSUPP125
            ENDIF
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCSCRA00
          MOVE      CSCRCRD,CSICSUP
          BRANCH    EXIT,GSUPP900,GSUPP900
.
GSUPP125  MOVE      CSICSUP,VAR
          CALL      DISPITEM
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CSCRCN1,VAR
            CALL      DISPITEM
          ENDIF
.
GSUPP130  MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          MOVE      CSIAISS,SIFAISSU
          MOVE      SP20,SIFASUPP
          CALL      KSIFAB00
          MOVE      SIFASUPP,CSICSUT
          BRANCH    EXIT,GSUPP120,GSUPP900
          PACK      KEY27,CSICCAT,CSICSUP,CSICSUT
          CALL      RACSIC1
          IF        OVRCD=0
            MOVE      "Catalog/Supplier/Supply Unit Already on File. - ",DISPMSG
            CALL      MESSAGE1
            GOTO      GSUPP130
          ENDIF
          MOVE      ONE,ACCEPT
          MOVE      CSICSUT,VAR
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      GSUPP999
GSUPP900  MOVE      ONE,EXIT
GSUPP999  RETURN
.------------------------------------------------------------
. Cancel Screen 2 Catalog/Supplier Summary
.------------------------------------------------------------
CAN20000  CALL     UUCSIA1   * Unlock Catalog
.
          RETURN
.
.------------------------------------------------------------
. Set up Default Part Description
.------------------------------------------------------------
DEFPTD00  IF    ACCEPT=1
            MOVE    CSIADES,CSICPD1
          ENDIF
          RETURN
DEFAULTY    MOVE     ANSY,DEFYESNO
            RETURN
.------------------------------------------------------------
. Cancel Changes to Catalog/Supplier Details
.------------------------------------------------------------
CAN30000  PACK     KEY27,CSICCAT,CSICSUP,CSICSUT
          CALL     RACSIC1
          IF       OVRCD=0
            CALL     DACSIC00                 * Delete Before Audit
          ENDIF
          MOVE     ONE,CANCFLAG
          CALL     UUCSIA1
          RETURN
.------------------------------------------------------------
. Delete Catalog/Supplier Details
.------------------------------------------------------------
DEL30000  MOVE     SP70,DISPMSG
          CALL     MESSAGE2
          CALL     DELQST
          CALL     MESSAGE3
          BRANCH   CEXIT,DEL31000,DEL39000,DEL39100
.
DEL31000  PACK     KEY27,CSICCAT,CSICSUP,CSICSUT
          MOVE     KEY27,KEY27SAV
          CALL     CHLAST00
          BRANCH   EXIT,DEL39100
.
          PACK     KEY27,KEY27SAV
          CALL     RDCSIC1
          IF       OVRCD=0
            CALL     DACSIC00                 * Delete Before Audit
            MOVE     FOUR,AUDTTYPE
            CALL     WACSIC00                 * Delete Audit
            CALL     DECSIC1
            MOVE     "2",UPDTYPE              * Flag for Delete in Other
            CALL     WRUIC000                 * Dtaabases
          ENDIF
.
DEL31900  MOVE     TWO,EXIT
          GOTO     DEL39999
.
DEL39000  MOVE     ONE,EXIT
          GOTO     DEL39999
.
DEL39100  CALL     CAN30000
          MOVE     TWO,EXIT
          GOTO     DEL39999
.
DEL39999  RETURN
.-----------------------------------------------------------------------------
. Check if Last Supplier/Supp. Unit  - Else OK
. Returns Exit=1  -  Not able to delete (last sup. or pref. supp. or not exist)
.         Exit=0  -  Able to Delete
.-----------------------------------------------------------------------------
CHLAST00  MOVE     ONE,EXIT
          CALL     RACSIC1
          IF       OVRCD=0
            CALL     GETTOT00
            IF       (TOTSUPS=FALSE) & (TOTUNITS=FALSE)
              MOVE    "Must have at least one Supplier/Supplier Unit - ",DISPMSG
              CALL     MESSAGE1
              GOTO     CHLAST99
            ENDIF
            IF       (TOTSUPS=TRUE) & (TOTUNITS=FALSE) & (ISPREFER=TRUE)
              MOVE     "Cannot Delete your Preferred Supplier - ",DISPMSG
              CALL     MESSAGE1
              GOTO     CHLAST99
            ENDIF
            MOVE      ZERO,EXIT
          ELSE
            MOVE      "Supplier/Supplier Unit does not exist - ",DISPMSG
            CALL      MESSAGE1
            GOTO      CHLAST99
          ENDIF
.
CHLAST99  RETURN
.-----------------------------------------------------------------------------
. Get Total Suppliers and Total Units per Supplier and If Preferred
. TOTSUPS  1-Two or more Suppliers for Catalog      0-only one for Catalog
. TOTUNITS 1-Two or more Units for Catalog/Supplier 0-only one for Cat./Supplier
. ISPREFER 1-Yes                                    0-No
.-----------------------------------------------------------------------------
GETTOT00  MOVE      CSICSUP,SAVSUP
          MATCH     CSIAPSC,CSICSUP
          IF        @EQUAL
            MOVE      TRUE,ISPREFER
          ELSE
            MOVE      FALSE,ISPREFER
          ENDIF
.
          MOVE      FALSE,TOTSUPS
          MOVE      "-1",TOTUNITS
.
. ------- Check if More than one supplier unit for Catalog/Supplier
          PACK      KEY27,CSICCAT,CSICSUP,SP70
          CALL      RSCSIC1
GETTOT10  CALL      RKCSIC1
          BRANCH    OVRCD,GETTOT20
.
          PACK      KEY12,CSICCAT,CSICSUP
          MATCH     KEY12,KEY27
          GOTO      GETTOT20 IF NOT EQUAL
.
          ADD       ONE,TOTUNITS
          BRANCH    TOTUNITS,GETTOT20
          GOTO      GETTOT10
.
. ------- Check if More than one supplier
GETTOT20  PACK      KEY12,KEY27SAV,Z70
          PACK      KEY27,KEY12,Z70
          CALL      RSCSIC1
          CALL      RKCSIC1
          BRANCH    OVRCD,GETTOT99
.
          MATCH     CSICCAT,KEY27SAV
          IF        @EQUAL
            MOVE      ONE,TOTSUPS
            GOTO      GETTOT99
          ENDIF
.
          PACK      KEY27,KEY12,SP70
          CALL      RSCSIC1
          CALL      RPCSIC1
          BRANCH    OVRCD,GETTOT99
.
          MATCH     CSICCAT,KEY27SAV
          IF        @EQUAL
            MOVE      ONE,TOTSUPS
            GOTO      GETTOT99
          ENDIF
.
GETTOT99  IF        TOTUNITS<0
            MOVE      ZERO,TOTUNITS
          ENDIF
          IF        TOTSUPS<0
            MOVE      ZERO,TOTSUPS
          ENDIF
          RETURN
.------------------------------------------------------------
. Save Catalog/Supplier Details
.------------------------------------------------------------
POS30000  PACK     KEY27,CSICCAT,CSICSUP,CSICSUT,SP70
          CALL     RACSIC1
          IF       OVRCD=0
            CALL     UPCSIC1
            MOVE     THREE,AUDTTYPE
            MOVE     ONE,UPDTYPE
          ELSE
            CALL     WRCSIC1
            MOVE     ONE,AUDTTYPE
            MOVE     ZERO,UPDTYPE
          ENDIF
.
          PACK     KEY7,CSICCAT
          CALL     RDCSIA1
          IF       OVRCD=0
            CLOCK    TIME,CTIMEIS
            PACK     CSIADTC,CCC,CYY,CMM,CDD
            REP      " 0",CSIADTC
            MOVE     CTIMEIS,CSIATMC
            MOVE     PASSCODE,CSIAUSC
            CALL     UPCSIA1
          ENDIF
.
          MOVE      CSICCAT,SAVECATA
          MOVE      CSICSUP,SAVECRED
          MOVE      CSICSUT,SAVEUNIT
.
          MATCH     SP70,CSICPNO              * No Check for Blank Part Numbers
          GOTO      POS31000 IF EQUAL
.
          CALL      CHKDUP00                  * Check for Dup Part Number
          BRANCH    EXIT,POS34000
.
POS31000  PACK      KEY27,SAVECATA,SAVECRED,SAVEUNIT
          CALL      RDCSIC1
.
          CALL      WACSIC00                 * Audit Write
          CALL      WRUIC000                 * Update Database Control
          CALL      UPKEY000                 * Update Key Word Index
.
          GOTO      POS39000
.
. Discontinued Posting
.-----------------------
POS34000  MOVE      SAVECATA,KEY7
          CALL      PUTSCR00
          CALL      RDCSIA1
          PACK      KEY27,SAVECATA,SAVECRED,SAVEUNIT
          CALL      RDCSIC1
          IF        OVRCD=0
            CALL      DECSIC1
            IF        AUDTTYPE=3
              CALL      DACSIC00                 * Delete Before Audit
            ENDIF
          ENDIF
.
POS39000
          RETURN
.------------------------------------------------------------
. Check for Duplicate Part Number
.------------------------------------------------------------
CHKDUP00  PACK      KEY35,CSICSUP,CSICPNO,SP70
          PACK      KEY57,CSICSUP,CSICPNO,SP70
          CALL      RSCSIC2
CHKDUP10  CALL      RKCSIC2
          BRANCH    OVRCD,CHKDUP99
          PACK      KEY57,CSICSUP,CSICPNO,SP70
          MATCH     KEY35,KEY57
          GOTO      CHKDUP99 IF NOT EQUAL
          MATCH     SAVECATA,CSICCAT
          GOTO      CHKDUP10 IF EQUAL
.
          MOVE      CSICCAT,KEY7
          CALL      RDCSIA1
          IF        OVRCD=1
            MOVE      SAVECATA,KEY7
            CALL      RDCSIA1
            GOTO      CHKDUP10
          ENDIF
          MOVE      "19",HTOP
          MOVE      "1",HLEF
          MOVE      "80",HRIG
          MOVE      "24",HBOT
          CALL      GETSCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HRIG
          MOVE      ZERO,HBOT
          BEEP
          DISPLAY   *P1:19,*EF
          HLINE     *G37,19,1,80
          HLINE     *G37,23,1,80
          DISPLAY   *P1:20,"Catalog     : ",*V2LON,CSIACAT,*HOFF:
                    *P1:21,"Description : ",*V2LON,CSIADES,*HOFF:
                    *P1:22,"Issue Unit  : ",*V2LON,CSIAISS
.
CHKDUP20  KEYIN     *P1:24,*EL,*V2LON,"WARNING - ",*HOFF:
                    "Part Number Already on File for this Supplier. ":
                    "Continue (",*V2LON,"Y",*HOFF:
                    "/",*V2LON,"N",*HOFF,") ? ",ANS
          REP       UPPLOW,ANS
          MOVE      ONE,EXIT
          MATCH     ANSN,ANS
          GOTO      CHKDUP99 IF EQUAL
          MATCH     ANSY,ANS
          GOTO      CHKDUP20 IF NOT EQUAL
.
          CALL      PUTSCR00
          MOVE      SAVECATA,KEY7
          CALL      RDCSIA1
.
CHKDUP90  MOVE      ZERO,EXIT
CHKDUP99  RETURN
.------------------------------------------------------------
. Write to Database Update Control File
.------------------------------------------------------------
WRUIC000  PACK      KEY3,SP70
          CALL      RSIBDB1
WRUIC100  CALL      RKIBDB1
          BRANCH    OVRCD,WRUIC999
          PACK      KEY30,IBDBDBS,CSICCAT,CSICSUP,CSICSUT
          UNPACK    KEY30,CSUCDBS,CSUCCAT,CSUCSUP,CSUCSUT
          CALL      RACSUC1
          IF        OVRCD=1
            MOVE      UPDTYPE,CSUCTYP
            MOVE      SP70,CSUCSPA
            CALL      WRCSUC1
          ENDIF
          GOTO       WRUIC100
WRUIC999  RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CSMCIAIO/INC
          INC       CSMCIAKY    
          INC       CSMCICIO/INC
          INC       CSMCIFIO/INC
          INC       CSMCKYIO/INC
          INC       CSMCREIO/INC
          INC       CSMCREKY    
          INC       CSMUIAIO/INC
          INC       CSMUICIO/INC
          INC       IBADBSIO/INC
          INC       SINCODIO/INC
          INC       SINFACIO/INC
          INC       SINFACKY    
          INC       SINSUAIO/INC
          INC       SINSUAKY    
.
          INC       STDGENCD
.
