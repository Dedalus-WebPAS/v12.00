.-----------------------------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.08.01  27/03/2007  Mike Laming   CAR 124690
.           Move detail Type to DOCDESC at GETREC90 in STRAN000
. V9.04.01  19/10/2005  Mike Laming   CAR 54458
.           Add selection for Enquiry by Invoice No.
. V9.02.02  26.03.2003  Sandra Barcham    CAR 37464
.           Fix HPS code in DEBSRHCD for warning and terms description
.           Add f09 changes missed in v9.00
. V9.02.01  20.03.2003  Sandra Barcham    CAR 37464
.           Add f09 changes missed in v9.00
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-----------------------------------------------------------------------------
. VF.09.02  12.10.2002  Sunil Kumar  srf 16477
.           Re-compile for changes in DEBSRHCD
. VF.09.01  28.02.2002  Glenn Saunders   srf 15126
.           Re-compile for changes in DEBDKIKY
.-----------------------------------------------------------------------------
. VF.01.01  10.08.2000 Sandra Barcham
.           Display adjustment code in transaction details screen
.-----------------------------------------------------------------------------
. VF.00.04  21.01.2000 Sandra Barcham
.           Remove department security from enquiry
.           srf 637206
. VF.00.03  05.07.1999 Sandra Barcham
.           Fix total screen for debtors search
. VF.00.02  14.05.1999 Sandra Barcham
.           Fix Debtor search
.           srf 631719
. VF.00.01  31.03.1999 Sandra Barcham
.           Fix enter document reference
.-----------------------------------------------------------------------------
CKEYTYPE  FORM      1
DATE9999  INIT      "99999999"
DBFHDTOT  FORM      12.2
DEBNAM    DIM       19
DEBREF    DIM       15
DOCINV    INIT      "Inv.  "
DOCCRD    INIT      "Cr.   "
DOCPAY    INIT      "Cash  "
DOCDRA    INIT      "Adj Dr"
DOCCRA    INIT      "Adj Cr"
F12P2     FORM      12.2
RETFLAG   FORM      2            * Return Flag for Summary Screen
SAVCOL    FORM      2
SAVVERT   FORM      2
SRCHDOC   DIM       12
SRCHDAT   DIM       8
SRCHDEB   DIM       19
SRCHUR1   DIM       19
SRCHAMT   FORM      8.2
Z40       INIT      "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
.-----------------------------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBADEB40
.   Function      :   Debtors Enquiries                       
.   Generated  On :   27/03/2007
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       DEBBICFD/INC
          INC       DEBBILFD/INC
          INC       DEBCODFD/INC
          INC       DEBCONFD/INC
          INC       DEBCREFD/INC
          INC       DEBDBTFD/INC
          INC       DEBDCMFD/INC
          INC       DEBDEPFD/INC
          INC       DEBDKIFD/INC
          INC       DEBFDTFD/INC
          INC       DEBFNOFD/INC
          INC       DEBFTHFD/INC
          INC       DEBITMFD/INC
          INC       DEBLINFD/INC
          INC       DEBOUTDF    
          INC       DEBPTYFD/INC
          INC       DEBSECFD/INC
          INC       DEBTERFD/INC
          INC       IBAPASFD/INC
.=========================
.Local Variable Definition
.-------------------------
TOBEINV   FORM     12.2 * Scr B1 Fld     4
.
.    Multi Item Key Fields Scr B1 Fld     5
.-------------------------------------------------------
DBBI2NAM  INIT      "DBBI2"
DBBI2END  FORM      1   * End Display
DBBI2SNO  FORM      5   * Number of Items on the Screen
DBBI2MKY  DIM       127 * Match Key 
DBBI2EKY  DIM       127 * End Key
DBBI2SKY  DIM       127 * Start Key
DBBI2IDX  INIT      " 132 UC1-5"
DBBI2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
DBBI2FNM  DIM       8  * Filename
DBBI2CNT  FORM      3  * Number of Items on Screen
TOTALCHG  FORM     12.2 * Scr B1 Fld    20
.
.Word Processor File * Scr B2 Fld    27
.
NAMDBBC1  INIT      "Wdbbc1"
FILDBBC1  DIM       8
.
DBBIUC1D  DIM      35 * Scr B2 Fld    31
DBBIUC2D  DIM      35 * Scr B2 Fld    32
DBBIUC3D  DIM      35 * Scr B2 Fld    33
DBBIUC4D  DIM      35 * Scr B2 Fld    34
TOTALAMT  FORM     12.2 * Scr B2 Fld    35
DBDBUC1D  DIM      35 * Scr D1 Fld    34
DBDBUC2D  DIM      35 * Scr D1 Fld    35
DBDBUC3D  DIM      35 * Scr D1 Fld    36
DBDBUC4D  DIM      35 * Scr D1 Fld    37
DBDBWRND  DIM      35 * Scr D1 Fld    38
.
.Word Processor File * Scr D1 Fld    41
.
NAMDBDC1  INIT      "Wdbdc1"
FILDBDC1  DIM       8
.
.
.    Multi Item Key Fields Scr H1 Fld    11
.-------------------------------------------------------
DBFD3NAM  INIT      "DBFD3"
DBFD3END  FORM      1   * End Display
DBFD3SNO  FORM      5   * Number of Items on the Screen
DBFD3MKY  DIM       127 * Match Key 
DBFD3EKY  DIM       127 * End Key
DBFD3SKY  DIM       127 * Start Key
DBFD3IDX  INIT      " 132 UC1-5"
DBFD3FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
DBFD3FNM  DIM       8  * Filename
DBFD3CNT  FORM      3  * Number of Items on Screen
DOCDESC   DIM       6 * Scr H1 Fld    15
DOCTOTAL  FORM     12.2 * Scr H1 Fld    41
OUTTOTAL  FORM     12.2 * Scr H1 Fld    42
.
.    Multi Item Key Fields Scr I1 Fld    10
.-------------------------------------------------------
DBFD8NAM  INIT      "DBFD8"
DBFD8END  FORM      1   * End Display
DBFD8SNO  FORM      5   * Number of Items on the Screen
DBFD8MKY  DIM       127 * Match Key 
DBFD8EKY  DIM       127 * End Key
DBFD8SKY  DIM       127 * Start Key
DBFD8IDX  INIT      " 132 UC1-5"
DBFD8FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
DBFD8FNM  DIM       8  * Filename
DBFD8CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr O1 Fld     4
.-------------------------------------------------------
DBFD2NAM  INIT      "DBFD2"
DBFD2END  FORM      1   * End Display
DBFD2SNO  FORM      5   * Number of Items on the Screen
DBFD2MKY  DIM       127 * Match Key 
DBFD2EKY  DIM       127 * End Key
DBFD2SKY  DIM       127 * Start Key
DBFD2IDX  INIT      " 132 UC1-5"
DBFD2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
DBFD2FNM  DIM       8  * Filename
DBFD2CNT  FORM      3  * Number of Items on Screen
TRANREF   DIM      12 * Scr R1 Fld     3
.
.    Multi Item Key Fields Scr R1 Fld    11
.-------------------------------------------------------
DBFH3NAM  INIT      "DBFH3"
DBFH3END  FORM      1   * End Display
DBFH3SNO  FORM      5   * Number of Items on the Screen
DBFH3MKY  DIM       127 * Match Key 
DBFH3EKY  DIM       127 * End Key
DBFH3SKY  DIM       127 * Start Key
DBFH3IDX  INIT      " 132 UC1-5"
DBFH3FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
DBFH3FNM  DIM       8  * Filename
DBFH3CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr R2 Fld    61
.-------------------------------------------------------
DBFD1NAM  INIT      "DBFD1"
DBFD1END  FORM      1   * End Display
DBFD1SNO  FORM      5   * Number of Items on the Screen
DBFD1MKY  DIM       127 * Match Key 
DBFD1EKY  DIM       127 * End Key
DBFD1SKY  DIM       127 * Start Key
DBFD1IDX  INIT      " 132 UC1-5"
DBFD1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
DBFD1FNM  DIM       8  * Filename
DBFD1CNT  FORM      3  * Number of Items on Screen
HEADTOT   FORM     12.2 * Scr R2 Fld    75
.
.Word Processor File * Scr TD Fld    60
.
NAMDBFN1  INIT      "Wdbfn1"
FILDBFN1  DIM       8
.
PAYDESC   DIM      20 * Scr TD Fld    79
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBADEB40"
PRGNAM    INIT      "Debtors Enquiries                       "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CLOSE     DBBI2FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILDBBC1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILDBDC1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     DBFD3FL1,DELETE
.
          CLOSE     DBFD8FL1,DELETE
.
          CLOSE     DBFD2FL1,DELETE
.
          CLOSE     DBFH3FL1,DELETE
.
          CLOSE     DBFD1FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILDBFN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   81",AUDTSECT
          MOVE      "  9",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudcd";
            OPEN      DEBAUDCD,"debaudcd"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 10",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debauddb";
            OPEN      DEBAUDDB,"debauddb"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 11",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudde";
            OPEN      DEBAUDDE,"debaudde"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 12",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudit";
            OPEN      DEBAUDIT,"debaudit"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 13",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudpt";
            OPEN      DEBAUDPT,"debaudpt"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 14",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudse";
            OPEN      DEBAUDSE,"debaudse"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 15",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudte";
            OPEN      DEBAUDTE,"debaudte"
          ENDIF
          DISPLAY   *P56:24,"Opening debbicaf";
          OPEN      DEBBICA1,"debbicaf"
          DISPLAY   *P56:24,"Opening debbilaf";
          OPEN      DEBBILA1,"debbilaf"
          DISPLAY   *P56:24,"Opening debbilaf";
          OPEN      DEBBILA2,"debbilaf"
          DISPLAY   *P56:24,"Opening debcodaf";
          OPEN      DEBCODA1,"debcodaf"
          DISPLAY   *P56:24,"Opening debcodaf";
          OPEN      DEBCODA2,"debcodaf"
          DISPLAY   *P56:24,"Opening debcreaf";
          OPEN      DEBCREA1,"debcreaf"
          DISPLAY   *P56:24,"Opening debcreaf";
          OPEN      DEBCREA2,"debcreaf"
          DISPLAY   *P56:24,"Opening debcreaf";
          OPEN      DEBCREA3,"debcreaf"
          DISPLAY   *P56:24,"Opening debdbtaf";
          OPEN      DEBDBTA1,"debdbtaf"
          DISPLAY   *P56:24,"Opening debdbtaf";
          OPEN      DEBDBTA2,"debdbtaf"
          DISPLAY   *P56:24,"Opening debdbtaf";
          OPEN      DEBDBTA3,"debdbtaf"
          DISPLAY   *P56:24,"Opening debdcmaf";
          OPEN      DEBDCMA1,"debdcmaf"
          DISPLAY   *P56:24,"Opening debdepaf";
          OPEN      DEBDEPA1,"debdepaf"
          DISPLAY   *P56:24,"Opening debdepaf";
          OPEN      DEBDEPA2,"debdepaf"
          DISPLAY   *P56:24,"Opening debdkiaf";
          OPEN      DEBDKIA1,"debdkiaf"
          DISPLAY   *P56:24,"Opening debdkiaf";
          OPEN      DEBDKIA2,"debdkiaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA1,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA2,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA3,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA4,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA5,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA7,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA8,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfnoaf";
          OPEN      DEBFNOA1,"debfnoaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA1,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA2,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA3,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA4,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA5,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA6,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA7,"debfthaf"
          DISPLAY   *P56:24,"Opening debitmaf";
          OPEN      DEBITMA1,"debitmaf"
          DISPLAY   *P56:24,"Opening debitmaf";
          OPEN      DEBITMA2,"debitmaf"
          DISPLAY   *P56:24,"Opening debitmaf";
          OPEN      DEBITMA3,"debitmaf"
          DISPLAY   *P56:24,"Opening  debdbtaf           ";
          OPEN      DEBLINA1,"debdbtaf"          
          DISPLAY   *P56:24,"Opening  debdbtaf           ";
          OPEN      DEBLINA2,"debdbtaf"          
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA1,"debptyaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA2,"debptyaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA3,"debptyaf"
          DISPLAY   *P56:24,"Opening debsecaf";
          OPEN      DEBSECA1,"debsecaf"
          DISPLAY   *P56:24,"Opening debsecaf";
          OPEN      DEBSECA2,"debsecaf"
          DISPLAY   *P56:24,"Opening debteraf";
          OPEN      DEBTERA1,"debteraf"
          DISPLAY   *P56:24,"Opening  ihapassf           ";
          OPEN      IHAPASS1,"ihapassf"          
.--------------------------------------------------------
. Initialise Batch Screen Unique ID                          
.--------------------------------------------------------
          MOVE     ZERO,DBBI2SNO
          MOVE     "B1    5",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,DBBI2SNO
            ENDIF
          ENDIF
          PACK      DBBI2FNM,ANST,DBBI2NAM,PORT
          REP       " 0",DBBI2FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      DBBI2FL1,DBBI2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     DBBI2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,DBBI2FNM,DBBI2IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",DBBI2FNM;
          EXECUTE   KEY80,TASKID
          OPEN      DBBI2FL1,DBBI2FNM
.--------------------------------------------------------
. Initialise Wp Filename for Billing Invoice Notes              
.--------------------------------------------------------
          PACK      FILDBBC1,NAMDBBC1,PORT
          REP       " 0",FILDBBC1
          DISPLAY   *P56:24,"Create & Open ",FILDBBC1;
          PREP      TEMPWORD,FILDBBC1
.
.--------------------------------------------------------
. Initialise Wp Filename for Notes                              
.--------------------------------------------------------
          PACK      FILDBDC1,NAMDBDC1,PORT
          REP       " 0",FILDBDC1
          DISPLAY   *P56:24,"Create & Open ",FILDBDC1;
          PREP      TEMPWORD,FILDBDC1
.
.--------------------------------------------------------
. Initialise Batch Screen Invoice Date                       
.--------------------------------------------------------
          MOVE     ZERO,DBFD3SNO
          MOVE     "H1   11",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,DBFD3SNO
            ENDIF
          ENDIF
          PACK      DBFD3FNM,ANST,DBFD3NAM,PORT
          REP       " 0",DBFD3FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      DBFD3FL1,DBFD3FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     DBFD3FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,DBFD3FNM,DBFD3IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",DBFD3FNM;
          EXECUTE   KEY80,TASKID
          OPEN      DBFD3FL1,DBFD3FNM
.--------------------------------------------------------
. Initialise Batch Screen Document Reference                 
.--------------------------------------------------------
          MOVE     ZERO,DBFD8SNO
          MOVE     "I1   10",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,DBFD8SNO
            ENDIF
          ENDIF
          PACK      DBFD8FNM,ANST,DBFD8NAM,PORT
          REP       " 0",DBFD8FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      DBFD8FL1,DBFD8FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     DBFD8FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,DBFD8FNM,DBFD8IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",DBFD8FNM;
          EXECUTE   KEY80,TASKID
          OPEN      DBFD8FL1,DBFD8FNM
.--------------------------------------------------------
. Initialise Batch Screen Invoice Date                       
.--------------------------------------------------------
          MOVE     ZERO,DBFD2SNO
          MOVE     "O1    4",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,DBFD2SNO
            ENDIF
          ENDIF
          PACK      DBFD2FNM,ANST,DBFD2NAM,PORT
          REP       " 0",DBFD2FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      DBFD2FL1,DBFD2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     DBFD2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,DBFD2FNM,DBFD2IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",DBFD2FNM;
          EXECUTE   KEY80,TASKID
          OPEN      DBFD2FL1,DBFD2FNM
.--------------------------------------------------------
. Initialise Batch Screen Debtor Code                        
.--------------------------------------------------------
          MOVE     ZERO,DBFH3SNO
          MOVE     "R1   11",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,DBFH3SNO
            ENDIF
          ENDIF
          PACK      DBFH3FNM,ANST,DBFH3NAM,PORT
          REP       " 0",DBFH3FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      DBFH3FL1,DBFH3FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     DBFH3FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,DBFH3FNM,DBFH3IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",DBFH3FNM;
          EXECUTE   KEY80,TASKID
          OPEN      DBFH3FL1,DBFH3FNM
.--------------------------------------------------------
. Initialise Batch Screen Document Line Number               
.--------------------------------------------------------
          MOVE     ZERO,DBFD1SNO
          MOVE     "R2   61",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,DBFD1SNO
            ENDIF
          ENDIF
          PACK      DBFD1FNM,ANST,DBFD1NAM,PORT
          REP       " 0",DBFD1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      DBFD1FL1,DBFD1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     DBFD1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,DBFD1FNM,DBFD1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",DBFD1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      DBFD1FL1,DBFD1FNM
.--------------------------------------------------------
. Initialise Wp Filename for Invoice Notes                      
.--------------------------------------------------------
          PACK      FILDBFN1,NAMDBFN1,PORT
          REP       " 0",FILDBFN1
          DISPLAY   *P56:24,"Create & Open ",FILDBFN1;
          PREP      TEMPWORD,FILDBFN1
.
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Debtors Enquiries                  
          ENDIF
          MATCH     "B1",SCRID
          IF         @EQUAL
            CALL       PSB1L000   * Billing Details                    
          ENDIF
          MATCH     "B2",SCRID
          IF         @EQUAL
            CALL       PSB2L000   * Sales Item Details                 
          ENDIF
          MATCH     "D1",SCRID
          IF         @EQUAL
            CALL       PSD1L000   * Enquire by Debtor                  
          ENDIF
          MATCH     "F1",SCRID
          IF         @EQUAL
            CALL       PSF1L000   * Debtors Financial Summary Screen   
          ENDIF
          MATCH     "H1",SCRID
          IF         @EQUAL
            CALL       PSH1L000   * History Details Summary            
          ENDIF
          MATCH     "I1",SCRID
          IF         @EQUAL
            CALL       PSI1L000   * Enquire by Invoice Ref             
          ENDIF
          MATCH     "O1",SCRID
          IF         @EQUAL
            CALL       PSO1L000   * Outstanding Transaction Details    
          ENDIF
          MATCH     "R1",SCRID
          IF         @EQUAL
            CALL       PSR1L000   * Enquire by Doc Ref                 
          ENDIF
          MATCH     "R2",SCRID
          IF         @EQUAL
            CALL       PSR2L000   * Document Reference Enquiry         
          ENDIF
          MATCH     "TD",SCRID
          IF         @EQUAL
            CALL       PSTDL000   * Transaction Details Screen         
          ENDIF
          RETURN
.--------------------------------
. Screen - Debtors Enquiries                  
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Debtors Enquiries                  
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Debtors Enquiries                  
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Debtors Enquiries                  
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Debtors Enquiries                  
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Debtors Enquiries                  
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Debtors Enquiries                  
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Debtors Enquiries                  
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105,SF00L106
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SCD1L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SCR1L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SQLA0000
          GOTO      SF00L001
.
SF00L105
          CALL      SQLB0000
          GOTO      SF00L001
.
SF00L106
          CALL      SCI1L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Billing Details                    
.--------------------------------
SCB1L000
SCB1L100
          MOVE      "B1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 8",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCB1L200
          CALL      CFB1L000 * Clear Fields
          CALL      BILTOT00
SCB1L300
          CALL      KYB1L000 * Enter Key Fields
          BRANCH    EXIT,SCB1L999,SCB1L999
SCB1L400
          CALL      WPB1L000 * Load any WP Details
SCB1L500
          CALL      LMB1L000 * Load any Batch Details
SCB1L600
          CALL      DFB1L000 * Display Fields
SCB1L700
          CALL      SFB1L000 * Select Fields
          BRANCH    EXIT,SCB1L100,SCB1L100,SCB1L200
SCB1L800
SCB1L900
SCB1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Billing Details                    
.-------------------------------------------------------
CFB1L000
CFB1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Billing Details                    
.--------------------------------------------------------
KYB1L000
          MOVE      ZERO,EXIT
          GOTO      KYB1L999
.
KYB1L900  MOVE      ONE,EXIT
KYB1L999  RETURN
.---------------------------------------------------------
. Load WP files for : Billing Details                    
.---------------------------------------------------------
WPB1L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Billing Details                    
.---------------------------------------------------------
LMB1L000
.---------------------------------------------------------
. Load for :     5 Unique ID                          
.---------------------------------------------------------
          UNPACK    SP70,DBBIDEB,DBBISTA,DBBIUNI
          PACK      KEY15,DBDBDEB,Z70
          MOVE      KEY15,DBBI2EKY
          STRIP     DBBI2SKY
          SETLPTR   DBBI2EKY,8
          MOVE      DBBI2EKY,DBBI2SKY
          CALL      RDDBBI2 
          IF        OVRCD=0
            CALL      RPDBBI2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPB1L000
          MOVE     ZERO,DBBI2CNT
          MOVE     ZERO,DBBI2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPB1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPB1L600
          MATCH    PRGID,SCPSPID
          GOTO     DPB1L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPB1L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPB1L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPB1L010,DPB1L010,DPB1L010,DPB1L010:
                            DPB1L101,DPB1L010,DPB1L102,DPB1L103:
                            DPB1L010,DPB1L104,DPB1L105,DPB1L106:
                            DPB1L107,DPB1L108,DPB1L109,DPB1L110:
                            DPB1L111,DPB1L112,DPB1L113,DPB1L114:
                            DPB1L115,DPB1L010,DPB1L010,DPB1L010:
                           DPB1L010,DPB1L010,DPB1L010,DPB1L010:
                           DPB1L010,DPB1L010,DPB1L010,DPB1L010:
                            DPB1L010,DPB1L010,DPB1L010,DPB1L010
          GOTO      DPB1L010
.
DPB1L101
          PACK      DBBI2MKY,SP70,SP70
          CALL      UPTDBBI2
          IF        DBBI2END=0
            CALL      RPDBBI2 
            IF        OVRCD=0
              PACK      DBBI2MKY,DBBIDEB,DBBISTA,DBBIUNI                                                        
              MATCH     DBBI2EKY,DBBI2MKY
              IF        @EQUAL
                MOVE      ZERO,DBBI2END
                ADD       ONE,DBBI2CNT
                CALL      UPTDBBI2
          CALL      REDITM00
                MOVE      DBBIUNI,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,DBBI2END
              ENDIF
            ELSE
              MOVE      ONE,DBBI2END
            ENDIF
          ENDIF
          IF        DBBI2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPB1L010
.
DPB1L102
          IF        DBBI2END=0
            MOVE      DBBISTA,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPB1L010
.
DPB1L103
          IF        DBBI2END=0
            UNPACK    DBBIDAT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPB1L010
.
DPB1L104
          IF        DBBI2END=0
            MOVE      DBBIUID,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPB1L010
.
DPB1L105
          IF        DBBI2END=0
            MOVE      DBBIITM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPB1L010
.
DPB1L106
          IF        DBBI2END=0
            UNPACK    DBBISDAT,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPB1L010
.
DPB1L107
          IF        DBBI2END=0
            MOVE      DBBIDREF,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPB1L010
.
DPB1L108
          IF        DBBI2END=0
            MOVE      DBBIOREF,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPB1L010
.
DPB1L109
          IF        DBBI2END=0
            MOVE      DBBIQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPB1L010
.
DPB1L110
          IF        DBBI2END=0
            MOVE      DBBIPRI,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPB1L010
.
DPB1L111
          IF        DBBI2END=0
            MOVE      DBBITOT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPB1L010
.
DPB1L112
          IF        DBBI2END=0
            MOVE      DBBITRT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPB1L010
.
DPB1L113
          IF        DBBI2END=0
            MOVE      DBBITAX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPB1L010
.
DPB1L114
          IF        DBBI2END=0
            MOVE      TOTALCHG,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPB1L010
.
DPB1L115
          IF        DBBI2END=0
            MOVE      DBITDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPB1L010
DPB1L600
          MATCH    "DBBI2",NAMSSFFI
          GOTO     DPB1L605 IF NOT EQUAL
          GOTO     DPB1L999
DPB1L605
DPB1L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPB1L000
.
          MATCH    "DBBI2",NAMSSFFI
          GOTO     FPB1L105 IF NOT EQUAL
          PACK     KEY15,DBBI2SKY,Z70
          CALL     RDDBBI2  * Start
          IF       OVRCD=0
            CALL     RPDBBI2  * Start
          ENDIF
          CALL     DPB1L000
          GOTO     FPB1L999
FPB1L105
FPB1L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPB1L000
.
          MATCH    "DBBI2",NAMSSFFI
          GOTO     LPB1L105 IF NOT EQUAL
          PACK     KEY15,DBBI2SKY,SP70
          CALL     RSDBBI2  * End
          IF       OVRCD=1
            CALL     RKDBBI2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<DBBI2SNO
            CALL     RKDBBI2 
            IF       OVRCD=1
              MOVE     DBBI2SNO,SECTOR
            ENDIF
            PACK     DBBI2MKY,DBBIDEB,DBBISTA,DBBIUNI                                                        
            MATCH    DBBI2EKY,DBBI2MKY
            IF       !@EQUAL
              MOVE     DBBI2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPB1L000
          GOTO     LPB1L999
LPB1L105
LPB1L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPB1L000
.
          MATCH    "DBBI2",NAMSSFFI
          GOTO     PPB1L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPB1L105
          CALL      RFTDBBI2
          BRANCH   OVRCD,PPB1L115
          MOVE      DBBI2MKY,KEY15 
          CALL      RSDBBI2 
PPB1L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=DBBI2SNO
            CALL     RKDBBI2 
            IF       OVRCD=1
              MOVE     DBBI2SNO,SECTOR
            ENDIF
            PACK     DBBI2MKY,DBBIDEB,DBBISTA,DBBIUNI                                                        
            MATCH    DBBI2EKY,DBBI2MKY
            IF       !@EQUAL
              MOVE     DBBI2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPB1L000
          GOTO     PPB1L999
PPB1L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<DBBI2SNO
            CALL     RPDBBI2 
            IF       OVRCD=1
              MOVE     DBBI2SNO,SECTOR
            ENDIF
            PACK     DBBI2MKY,DBBIDEB,DBBISTA,DBBIUNI                                                        
            MATCH    DBBI2EKY,DBBI2MKY
            IF       !@EQUAL
              MOVE     DBBI2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPB1L999
PPB1L120
PPB1L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPB1L000
          MATCH    "DBBI2",NAMSSFFI
          GOTO     NPB1L115 IF NOT EQUAL
NPB1L105
          CALL     RPDBBI2 
          BRANCH   OVRCD,NPB1L110
          PACK     DBBI2MKY,DBBIDEB,DBBISTA,DBBIUNI                                                        
          MATCH    DBBI2EKY,DBBI2MKY
          GOTO     NPB1L110 IF NOT EQUAL
          CALL     RKDBBI2 
          CALL     DPB1L000
          GOTO     NPB1L999
NPB1L110
          CALL     RKDBBI2 
          BEEP
          GOTO     NPB1L999
NPB1L115
NPB1L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTB1L000
CTB1L105
CTB1L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Billing Details                    
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     5 Unique ID                          
.---------------------------------------------------------
UPTDBBI2
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      DBBI2FL1,KEY5;ANS
          IF        @OVER
            WRITE     DBBI2FL1,KEY5;SCPSROW,SCPSCOL,DBBI2MKY
          ELSE
            UPDATE    DBBI2FL1;SCPSROW,SCPSCOL,DBBI2MKY
          ENDIF
          RETURN
RDTDBBI2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      DBBI2FL1,KEY5;SCPSROW,SCPSCOL,DBBI2MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTDBBI2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      DBBI2FL1,KEY5;;
          READKS    DBBI2FL1;SCPSROW,SCPSCOL,DBBI2MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,DBBI2MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Billing Details                    
.---------------------------------------------------------
DFB1L000
          BRANCH   ACCEPT,DFB1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFB1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFB1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFB1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFB1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFB1L010 IF NOT EQUAL
.
          CALL     PSB1L000 * Display Field
          GOTO     DFB1L010
DFB1L900
          MOVE      "DBBI2",NAMSSFFI
          MOVE      "    5",ITMSSFFI
          CALL      FPB1L000
DFB1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Billing Details                    
.---------------------------------------------------------
PSB1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSB1L999,PSB1L999,PSB1L999,PSB1L101:
                            PSB1L999,PSB1L999,PSB1L999,PSB1L999:
                            PSB1L102,PSB1L999,PSB1L999,PSB1L999:
                            PSB1L999,PSB1L999,PSB1L999,PSB1L999:
                            PSB1L999,PSB1L999,PSB1L999,PSB1L999:
                            PSB1L999,PSB1L999,PSB1L999,PSB1L999:
                           PSB1L999,PSB1L999,PSB1L999,PSB1L999:
                           PSB1L999,PSB1L999,PSB1L999,PSB1L999:
                            PSB1L999,PSB1L999,PSB1L999,PSB1L999
          GOTO     PSB1L999
.
PSB1L101
          MOVE      TOBEINV,VAR      
          CALL      DISPITEM
          GOTO     PSB1L999
.
PSB1L102
          MOVE      DBBITIM,VAR      
          CALL      DISPITEM
          GOTO     PSB1L999
PSB1L999
          RETURN
.---------------------------------------------------------
. Selections for : Billing Details                    
.---------------------------------------------------------
SFB1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFB1L001  BRANCH   ACCEPT,SFB1L020
.
SFB1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFB1L006,SFB1L101,SFB1L006,SFB1L006:
                            SFB1L102,SFB1L006,SFB1L006,SFB1L006:
                            SFB1L006,SFB1L006,SFB1L006,SFB1L006:
                            SFB1L006,SFB1L006,SFB1L006,SFB1L006:
                            SFB1L006,SFB1L006,SFB1L006,SFB1L006:
                            SFB1L006,SFB1L006,SFB1L006,SFB1L006:
                           SFB1L006,SFB1L006,SFB1L006,SFB1L006:
                           SFB1L006,SFB1L006,SFB1L103,SFB1L104:
                            SFB1L006,SFB1L006,SFB1L105,SFB1L106
SFB1L006  BEEP
          GOTO     SFB1L005
SFB1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFB1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFB1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFB1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFB1L020,SFB1L020,SFB1L020,SFB1L020:
                            SFB1L102,SFB1L020,SFB1L020,SFB1L020:
                            SFB1L020,SFB1L020,SFB1L020,SFB1L020:
                            SFB1L020,SFB1L020,SFB1L020,SFB1L020:
                            SFB1L020,SFB1L020,SFB1L020,SFB1L020:
                            SFB1L020,SFB1L020,SFB1L020,SFB1L020:
                           SFB1L020,SFB1L020,SFB1L020,SFB1L020:
                           SFB1L020,SFB1L020,SFB1L020,SFB1L020:
                            SFB1L020,SFB1L020,SFB1L020,SFB1L020
          GOTO     SFB1L020
SFB1L090  MOVE     ZERO,ACCEPT
          MOVE      "DBBI2",NAMSSFFI
          MOVE      "    5",ITMSSFFI
          CALL      FPB1L000
          GOTO     SFB1L001
.
SFB1L101
          MOVE      ZERO,EXIT
          GOTO      SFB1L999
.
SFB1L102
          CALL      SELECTED
          BRANCH    EXIT,SFB1L001
          COMPARE   ONE,ACCEPT
          GOTO      SFB1L001 IF EQUAL
          CALL      RDTDBBI2
          IF        OVRCD=1
            BEEP
            GOTO      SFB1L001
          ENDIF
          MATCH     SP70,DBBI2MKY
          IF        @EQUAL
            BEEP
            GOTO      SFB1L001
          ENDIF
          MOVE      DBBI2MKY,KEY15 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELT0000
          MOVE      "B1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTDBBI2
          IF        OVRCD=1
            CALL      FPB1L000
          ELSE
            MOVE      DBBI2MKY,KEY15 
            CALL      RSDBBI2 
            CALL      RKDBBI2 
            CALL      DPB1L000
          ENDIF
          GOTO     SFB1L001
.
SFB1L103
          MOVE      "DBBI2",NAMSSFFI
          MOVE      "    5",ITMSSFFI
          CALL      NPB1L000
          GOTO     SFB1L001
.
SFB1L104
          MOVE      "DBBI2",NAMSSFFI
          MOVE      "    5",ITMSSFFI
          CALL      PPB1L000
          GOTO     SFB1L001
.
SFB1L105
          MOVE      "DBBI2",NAMSSFFI
          MOVE      "    5",ITMSSFFI
          CALL      FPB1L000
          GOTO     SFB1L001
.
SFB1L106
          MOVE      "DBBI2",NAMSSFFI
          MOVE      "    5",ITMSSFFI
          CALL      LPB1L000
          GOTO     SFB1L001
SFB1L990  MOVE      ONE,EXIT * Exit Char Restart
SFB1L999  RETURN
.--------------------------------
. Screen - Sales Item Details                 
.--------------------------------
SCB2L000
SCB2L100
          MOVE      "B2",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 8",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCB2L200
          CALL      CFB2L000 * Clear Fields
SCB2L300
          CALL      KYB2L000 * Enter Key Fields
          BRANCH    EXIT,SCB2L999,SCB2L999
SCB2L400
          CALL      WPB2L000 * Load any WP Details
SCB2L500
          CALL      LMB2L000 * Load any Batch Details
SCB2L600
          CALL      DFB2L000 * Display Fields
SCB2L700
          CALL      SFB2L000 * Select Fields
          BRANCH    EXIT,SCB2L100,SCB2L100,SCB2L200
SCB2L800
SCB2L900
SCB2L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Sales Item Details                 
.-------------------------------------------------------
CFB2L000
CFB2L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Sales Item Details                 
.--------------------------------------------------------
KYB2L000
          MOVE      ZERO,EXIT
          GOTO      KYB2L999
.
KYB2L900  MOVE      ONE,EXIT
KYB2L999  RETURN
.---------------------------------------------------------
. Load WP files for : Sales Item Details                 
.---------------------------------------------------------
WPB2L000
          PREP     TEMPWORD,FILDBBC1
          PACK     KEY17,DBBIDEB,DBBIUNI,SP70
          MOVE     KEY17,SAVKEY80
          SETLPTR  SAVKEY80,14
          CALL      RDDBBC1 
          IF        OVRCD=0
            CALL      RPDBBC1 
          ENDIF
WPB2L100
          CALL     RKDBBC1 
          BRANCH   OVRCD,WPB2L105
          PACK     KEY17,DBBCDEB,DBBCUNI,DBBCLIN
          MATCH    SAVKEY80,KEY17   
          GOTO     WPB2L105 IF NOT EQUAL
          PACK     VAR,DBBCCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     DBBCCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WPB2L100
WPB2L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Sales Item Details                 
.---------------------------------------------------------
LMB2L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Sales Item Details                 
.---------------------------------------------------------
DFB2L000
          BRANCH   ACCEPT,DFB2L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFB2L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFB2L900
          MATCH    PRGID,SCPSPID
          GOTO     DFB2L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFB2L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFB2L010 IF NOT EQUAL
.
          CALL     PSB2L000 * Display Field
          GOTO     DFB2L010
DFB2L900
DFB2L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Sales Item Details                 
.---------------------------------------------------------
PSB2L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSB2L999,PSB2L999,PSB2L101,PSB2L102:
                            PSB2L103,PSB2L104,PSB2L105,PSB2L106:
                            PSB2L107,PSB2L108,PSB2L109,PSB2L110:
                            PSB2L111,PSB2L112,PSB2L113,PSB2L114:
                            PSB2L115,PSB2L116,PSB2L117,PSB2L118:
                            PSB2L119,PSB2L120,PSB2L121,PSB2L122:
                            PSB2L123,PSB2L124,PSB2L125,PSB2L126:
                            PSB2L127,PSB2L128,PSB2L129,PSB2L130:
                            PSB2L131,PSB2L132,PSB2L133,PSB2L134:
                            PSB2L135,PSB2L136,PSB2L137,PSB2L138
          GOTO     PSB2L999
.
PSB2L101
          MOVE      DBBIUNI,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L102
          MOVE      DBBISTA,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L103
          UNPACK    DBBIDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L104
          MOVE      DBBITIM,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L105
          MOVE      DBBIUID,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L106
          MOVE      DBBIITM,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L107
          UNPACK    DBBISDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L108
          MOVE      DBBIDREF,VAR     
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L109
          MOVE      DBBIOREF,VAR     
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L110
          MOVE      DBBIQTY,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L111
          MOVE      DBBIPRI,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L112
          MOVE      DBBITOT,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L113
          MOVE      DBBITRT,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L114
          MOVE      DBBITAX,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L115
          MOVE      DBBIUR1,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L116
          MOVE      DBBIUR2,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L117
          UNPACK    DBBIUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L118
          UNPACK    DBBIUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBBIUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L120
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBBIUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L121
          MOVE      DBBIUC1,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L122
          MOVE      DBBIUC2,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L123
          MOVE      DBBIUC3,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L124
          MOVE      DBBIUC4,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L125
          MOVE     FILDBBC1,WORDNAME
          CALL     DISPWORD
          GOTO     PSB2L999
.
PSB2L126
          MOVE      DBITDES,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L127
          MOVE      DBITIDE,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L128
          MOVE      DBITPRI,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L129
          MOVE      DBBIUC1D,VAR     
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L130
          MOVE      DBBIUC2D,VAR     
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L131
          MOVE      DBBIUC3D,VAR     
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L132
          MOVE      DBBIUC4D,VAR     
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L133
          MOVE      TOTALAMT,VAR     
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L134
          MOVE      SECUSER,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L135
          MOVE      DBITPTY,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L136
          MOVE      DBPTDES,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L137
          MOVE      DBPTDEP,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
.
PSB2L138
          MOVE      DBDEDES,VAR      
          CALL      DISPITEM
          GOTO     PSB2L999
PSB2L999
          RETURN
.---------------------------------------------------------
. Selections for : Sales Item Details                 
.---------------------------------------------------------
SFB2L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFB2L001  BRANCH   ACCEPT,SFB2L020
.
SFB2L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFB2L006,SFB2L101,SFB2L006,SFB2L006:
                            SFB2L006,SFB2L006,SFB2L006,SFB2L006:
                            SFB2L006,SFB2L006,SFB2L006,SFB2L006:
                            SFB2L006,SFB2L006,SFB2L006,SFB2L006:
                            SFB2L006,SFB2L006,SFB2L006,SFB2L006:
                            SFB2L006,SFB2L006,SFB2L006,SFB2L006:
                            SFB2L006,SFB2L006,SFB2L102,SFB2L006:
                            SFB2L006,SFB2L006,SFB2L006,SFB2L006:
                            SFB2L006,SFB2L006,SFB2L006,SFB2L006:
                            SFB2L006,SFB2L006,SFB2L006,SFB2L006
SFB2L006  BEEP
          GOTO     SFB2L005
SFB2L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFB2L090
          MATCH    PRGID,SCSLPID
          GOTO     SFB2L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFB2L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFB2L020,SFB2L020,SFB2L020,SFB2L020:
                            SFB2L020,SFB2L020,SFB2L020,SFB2L020:
                            SFB2L020,SFB2L020,SFB2L020,SFB2L020:
                            SFB2L020,SFB2L020,SFB2L020,SFB2L020:
                            SFB2L020,SFB2L020,SFB2L020,SFB2L020:
                            SFB2L020,SFB2L020,SFB2L020,SFB2L020:
                            SFB2L020,SFB2L020,SFB2L102,SFB2L020:
                            SFB2L020,SFB2L020,SFB2L020,SFB2L020:
                            SFB2L020,SFB2L020,SFB2L020,SFB2L020:
                            SFB2L020,SFB2L020,SFB2L020,SFB2L020
          GOTO     SFB2L020
SFB2L090  MOVE     ZERO,ACCEPT
          GOTO     SFB2L001
.
SFB2L101
          MOVE      ZERO,EXIT
          GOTO      SFB2L999
.
SFB2L102
.
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DBBIUC2D
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 0",SCPSROW
              MOVE     "  0",SCPSCOL
              MOVE     "  0",SCPSLEN
              MOVE     " 0",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILDBBC1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILDBBC1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
.
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DBBIUC2D,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFB2L001
SFB2L990  MOVE      ONE,EXIT * Exit Char Restart
SFB2L999  RETURN
.--------------------------------
. Screen - Enquire by Debtor                  
.--------------------------------
SCD1L000
SCD1L100
          MOVE      "D1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCD1L200
          CALL      CFD1L000 * Clear Fields
SCD1L300
          CALL      KYD1L000 * Enter Key Fields
          BRANCH    EXIT,SCD1L999,SCD1L999
SCD1L400
          CALL      WPD1L000 * Load any WP Details
SCD1L500
          CALL      LMD1L000 * Load any Batch Details
SCD1L600
          CALL      DFD1L000 * Display Fields
SCD1L700
          CALL      SFD1L000 * Select Fields
          BRANCH    EXIT,SCD1L100,SCD1L100,SCD1L200
SCD1L800
SCD1L900
SCD1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Enquire by Debtor                  
.-------------------------------------------------------
CFD1L000
          MOVE      SP70,DBDBDEB 
          MOVE      SP70,DBDBNA1 
          MOVE      SP70,DBDBNA2 
          MOVE      SP70,DBDBAD1 
          MOVE      SP70,DBDBAD2 
          MOVE      SP70,DBDBAD3 
          MOVE      SP70,DBDBAD4 
          MOVE      SP70,DBDBPC  
          MOVE      SP70,DBDBPH1 
          MOVE      SP70,DBDBPH2 
          MOVE      SP70,DBDBPH3 
          MOVE      SP70,DBDBCON 
          MOVE      ZERO,DBDBACT 
          MOVE      ZERO,DBDBSTA 
          MOVE      ZERO,DBDBTEX 
          MOVE      SP70,DBDBTER 
          MOVE      SP70,DBDBWRN 
          MOVE      SP70,DBDBLIN 
          MOVE      SP70,DBDBPUR 
          MOVE      ZERO,DBDBBAD 
          MOVE      SP70,DBDBSORT
          MOVE      SP70,DBDBUR2 
          MOVE      SP70,DBDBUD1 
          MOVE      SP70,DBDBUD2 
          MOVE      SP70,DBDBUY1 
          MOVE      SP70,DBDBUY2 
          MOVE      SP70,DBDBUC1 
          MOVE      SP70,DBDBUC2 
          MOVE      SP70,DBDBUC3 
          MOVE      SP70,DBDBUC4 
          MOVE      SP70,DBDBUC1D
          MOVE      SP70,DBDBUC2D
          MOVE      SP70,DBDBUC3D
          MOVE      SP70,DBDBUC4D
          MOVE      SP70,DBDBWRND
          MOVE      SP70,DBTEDES 
          MOVE      SP70,DBLNNA1 
          MOVE      SP70,DBDBDEB 
          MOVE      ZERO,DBDBCLM 
CFD1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Enquire by Debtor                  
.--------------------------------------------------------
KYD1L000
.
KYD1L110
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DBDBNA1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DBDBDEB 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KDBDBS00
          BRANCH    EXIT,KYD1L900,KYD1L900
          MOVE      ZERO,ACCEPT
          MOVE      DBDBDEB,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DBDBNA1,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DBDBDEB,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KYD1L999
.
KYD1L900  MOVE      ONE,EXIT
KYD1L999  RETURN
.---------------------------------------------------------
. Load WP files for : Enquire by Debtor                  
.---------------------------------------------------------
WPD1L000
          PREP     TEMPWORD,FILDBDC1
          PACK     KEY11,DBDBDEB,SP70
          MOVE     KEY11,SAVKEY80
          SETLPTR  SAVKEY80,8 
          CALL      RDDBDC1 
          IF        OVRCD=0
            CALL      RPDBDC1 
          ENDIF
WPD1L100
          CALL     RKDBDC1 
          BRANCH   OVRCD,WPD1L105
          PACK     KEY11,DBDCDEB,DBDCLIN
          MATCH    SAVKEY80,KEY11   
          GOTO     WPD1L105 IF NOT EQUAL
          PACK     VAR,DBDCCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     DBDCCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WPD1L100
WPD1L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Enquire by Debtor                  
.---------------------------------------------------------
LMD1L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Enquire by Debtor                  
.---------------------------------------------------------
DFD1L000
          BRANCH   ACCEPT,DFD1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFD1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFD1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFD1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFD1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFD1L010 IF NOT EQUAL
.
          CALL     PSD1L000 * Display Field
          GOTO     DFD1L010
DFD1L900
DFD1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Enquire by Debtor                  
.---------------------------------------------------------
PSD1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSD1L999,PSD1L999,PSD1L999,PSD1L999:
                            PSD1L101,PSD1L102,PSD1L103,PSD1L104:
                            PSD1L105,PSD1L106,PSD1L107,PSD1L108:
                            PSD1L109,PSD1L110,PSD1L111,PSD1L112:
                            PSD1L113,PSD1L114,PSD1L115,PSD1L116:
                            PSD1L117,PSD1L118,PSD1L119,PSD1L120:
                            PSD1L121,PSD1L122,PSD1L123,PSD1L124:
                            PSD1L125,PSD1L126,PSD1L127,PSD1L128:
                            PSD1L129,PSD1L130,PSD1L131,PSD1L132:
                            PSD1L133,PSD1L134,PSD1L135,PSD1L136:
                            PSD1L137,PSD1L138,PSD1L139,PSD1L999:
                           PSD1L999,PSD1L999,PSD1L999,PSD1L999:
                            PSD1L999,PSD1L999,PSD1L999
          GOTO     PSD1L999
.
PSD1L101
          MOVE      DBDBNA1,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L102
          MOVE      DBDBNA2,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L103
          MOVE      DBDBAD1,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L104
          MOVE      DBDBAD2,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L105
          MOVE      DBDBAD3,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L106
          MOVE      DBDBAD4,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L107
          MOVE      DBDBPC,VAR       
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L108
          MOVE      DBDBPH1,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L109
          MOVE      DBDBPH2,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L110
          MOVE      DBDBPH3,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L111
          MOVE      DBDBCON,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L112
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBDBACT,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L113
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBDBSTA,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBDBTEX,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L115
          MOVE      DBDBTER,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L116
          MOVE      DBDBWRN,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L117
          MOVE      DBDBLIN,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L118
          MOVE      DBDBPUR,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBDBBAD,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L120
          MOVE      DBDBSORT,VAR     
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L121
          MOVE      DBDBUR2,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L122
          UNPACK    DBDBUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L123
          UNPACK    DBDBUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L124
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBDBUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L125
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBDBUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L126
          MOVE      DBDBUC1,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L127
          MOVE      DBDBUC2,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L128
          MOVE      DBDBUC3,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L129
          MOVE      DBDBUC4,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L130
          MOVE      DBDBUC1D,VAR     
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L131
          MOVE      DBDBUC2D,VAR     
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L132
          MOVE      DBDBUC3D,VAR     
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L133
          MOVE      DBDBUC4D,VAR     
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L134
          MOVE      DBDBWRND,VAR     
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L135
          MOVE      DBTEDES,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L136
          MOVE      DBLNNA1,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L137
          MOVE     FILDBDC1,WORDNAME
          CALL     DISPWORD
          GOTO     PSD1L999
.
PSD1L138
          MOVE      DBDBDEB,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
.
PSD1L139
          MOVE      DBDBCLM,VAR      
          CALL      DISPITEM
          GOTO     PSD1L999
PSD1L999
          RETURN
.---------------------------------------------------------
. Selections for : Enquire by Debtor                  
.---------------------------------------------------------
SFD1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFD1L001  BRANCH   ACCEPT,SFD1L020
.
SFD1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFD1L006,SFD1L101,SFD1L102,SFD1L006:
                            SFD1L006,SFD1L006,SFD1L006,SFD1L006:
                            SFD1L006,SFD1L006,SFD1L006,SFD1L006:
                            SFD1L006,SFD1L006,SFD1L006,SFD1L006:
                            SFD1L006,SFD1L006,SFD1L006,SFD1L006:
                            SFD1L006,SFD1L006,SFD1L006,SFD1L006:
                            SFD1L006,SFD1L006,SFD1L006,SFD1L006:
                            SFD1L006,SFD1L006,SFD1L006,SFD1L006:
                            SFD1L006,SFD1L006,SFD1L006,SFD1L006:
                            SFD1L006,SFD1L006,SFD1L006,SFD1L006:
                            SFD1L103,SFD1L006,SFD1L006,SFD1L006:
                           SFD1L006,SFD1L006,SFD1L006,SFD1L104:
                            SFD1L105,SFD1L106,SFD1L107
SFD1L006  BEEP
          GOTO     SFD1L005
SFD1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFD1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFD1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFD1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFD1L020,SFD1L020,SFD1L020,SFD1L020:
                            SFD1L020,SFD1L020,SFD1L020,SFD1L020:
                            SFD1L020,SFD1L020,SFD1L020,SFD1L020:
                            SFD1L020,SFD1L020,SFD1L020,SFD1L020:
                            SFD1L020,SFD1L020,SFD1L020,SFD1L020:
                            SFD1L020,SFD1L020,SFD1L020,SFD1L020:
                            SFD1L020,SFD1L020,SFD1L020,SFD1L020:
                            SFD1L020,SFD1L020,SFD1L020,SFD1L020:
                            SFD1L020,SFD1L020,SFD1L020,SFD1L020:
                            SFD1L020,SFD1L020,SFD1L020,SFD1L020:
                            SFD1L103,SFD1L020,SFD1L020,SFD1L020:
                           SFD1L020,SFD1L020,SFD1L020,SFD1L020:
                            SFD1L020,SFD1L020,SFD1L020
          GOTO     SFD1L020
SFD1L090  MOVE     ZERO,ACCEPT
          GOTO     SFD1L001
.
SFD1L101
          MOVE      ZERO,EXIT
          GOTO      SFD1L999
.
SFD1L102
          MOVE      ONE,EXIT
          GOTO      SFD1L999
.
SFD1L103
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 9",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 70",SCPSLEN
              MOVE     "14",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILDBDC1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILDBDC1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SFD1L001
.
SFD1L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      FINSUM00
          MOVE      "D1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SFD1L001
.
SFD1L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCB1L000
          MOVE      "D1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SFD1L001
.
SFD1L106
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCH1L000
          MOVE      "D1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SFD1L001
.
SFD1L107
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCO1L000
          MOVE      "D1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SFD1L001
SFD1L990  MOVE      ONE,EXIT * Exit Char Restart
SFD1L999  RETURN
.--------------------------------
. Screen - Debtors Financial Summary Screen   
.--------------------------------
SCF1L000
SCF1L100
          MOVE      "F1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 8",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCF1L200
          CALL      CFF1L000 * Clear Fields
SCF1L300
          CALL      KYF1L000 * Enter Key Fields
          BRANCH    EXIT,SCF1L999,SCF1L999
SCF1L400
          CALL      WPF1L000 * Load any WP Details
SCF1L500
          CALL      LMF1L000 * Load any Batch Details
SCF1L600
          CALL      DFF1L000 * Display Fields
SCF1L700
          CALL      SFF1L000 * Select Fields
          BRANCH    EXIT,SCF1L100,SCF1L100,SCF1L200
SCF1L800
SCF1L900
SCF1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Debtors Financial Summary Screen   
.-------------------------------------------------------
CFF1L000
CFF1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Debtors Financial Summary Screen   
.--------------------------------------------------------
KYF1L000
          MOVE      ZERO,EXIT
          GOTO      KYF1L999
.
KYF1L900  MOVE      ONE,EXIT
KYF1L999  RETURN
.---------------------------------------------------------
. Load WP files for : Debtors Financial Summary Screen   
.---------------------------------------------------------
WPF1L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Debtors Financial Summary Screen   
.---------------------------------------------------------
LMF1L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Debtors Financial Summary Screen   
.---------------------------------------------------------
DFF1L000
          BRANCH   ACCEPT,DFF1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFF1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFF1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFF1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFF1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFF1L010 IF NOT EQUAL
.
          CALL     PSF1L000 * Display Field
          GOTO     DFF1L010
DFF1L900
DFF1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Debtors Financial Summary Screen   
.---------------------------------------------------------
PSF1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSF1L999,PSF1L999,PSF1L101,PSF1L102:
                            PSF1L103,PSF1L104,PSF1L105,PSF1L106:
                            PSF1L107,PSF1L108,PSF1L109,PSF1L110:
                            PSF1L111,PSF1L112,PSF1L113,PSF1L114:
                            PSF1L115,PSF1L116,PSF1L117,PSF1L118:
                            PSF1L119,PSF1L120,PSF1L121,PSF1L122:
                            PSF1L123,PSF1L124,PSF1L125,PSF1L126:
                            PSF1L127,PSF1L128,PSF1L129,PSF1L130:
                            PSF1L131,PSF1L132,PSF1L133,PSF1L134:
                            PSF1L135,PSF1L136,PSF1L137,PSF1L138:
                            PSF1L139,PSF1L140,PSF1L141,PSF1L142:
                            PSF1L143,PSF1L144,PSF1L145,PSF1L146
          GOTO     PSF1L999
.
PSF1L101
          MOVE      TOTALOUT,VAR     
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L102
          MOVE      CURRENT,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L103
          MOVE      BALTOT30,VAR     
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L104
          MOVE      BALTOT60,VAR     
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L105
          MOVE      BALTOT90,VAR     
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L106
          UNPACK    ASATDATE,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L107
          UNPACK    ASAT30,CCENT,CYEAR,CMON,CDAY            
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L108
          UNPACK    ASAT60,CCENT,CYEAR,CMON,CDAY            
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L109
          UNPACK    ASAT90,CCENT,CYEAR,CMON,CDAY            
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L110
          MOVE      DBDBCLM,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L111
          MOVE      DBDBNA1,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L112
          MOVE      DBDBNA2,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L113
          MOVE      DBDBAD1,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L114
          MOVE      DBDBAD2,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L115
          MOVE      DBDBAD3,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L116
          MOVE      DBDBAD4,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L117
          MOVE      DBDBPC,VAR       
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L118
          MOVE      DBDBPH1,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L119
          MOVE      DBDBPH2,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L120
          MOVE      DBDBPH3,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L121
          MOVE      DBDBCON,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L122
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBDBACT,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L123
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBDBSTA,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L124
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBDBTEX,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L125
          MOVE      DBDBTER,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L126
          MOVE      DBDBWRN,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L127
          MOVE      DBDBLIN,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L128
          MOVE      DBDBPUR,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L129
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBDBBAD,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L130
          MOVE      DBDBSORT,VAR     
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L131
          MOVE      DBDBUR2,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L132
          UNPACK    DBDBUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L133
          UNPACK    DBDBUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L134
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBDBUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L135
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBDBUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L136
          MOVE      DBDBUC1,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L137
          MOVE      DBDBUC2,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L138
          MOVE      DBDBUC3,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L139
          MOVE      DBDBUC4,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L140
          MOVE      DBDBUC1D,VAR     
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L141
          MOVE      DBDBUC2D,VAR     
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L142
          MOVE      DBDBUC3D,VAR     
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L143
          MOVE      DBDBUC4D,VAR     
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L144
          MOVE      DBDBWRND,VAR     
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L145
          MOVE      DBTEDES,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
.
PSF1L146
          MOVE      DBLNNA1,VAR      
          CALL      DISPITEM
          GOTO     PSF1L999
PSF1L999
          RETURN
.---------------------------------------------------------
. Selections for : Debtors Financial Summary Screen   
.---------------------------------------------------------
SFF1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFF1L001  BRANCH   ACCEPT,SFF1L020
.
SFF1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFF1L006,SFF1L101,SFF1L006,SFF1L006:
                            SFF1L006,SFF1L006,SFF1L006,SFF1L006:
                            SFF1L006,SFF1L006,SFF1L006,SFF1L006:
                            SFF1L006,SFF1L006,SFF1L006,SFF1L006:
                            SFF1L006,SFF1L006,SFF1L006,SFF1L006:
                            SFF1L006,SFF1L006,SFF1L006,SFF1L006:
                            SFF1L006,SFF1L006,SFF1L006,SFF1L006:
                            SFF1L006,SFF1L006,SFF1L006,SFF1L006:
                            SFF1L006,SFF1L006,SFF1L006,SFF1L006:
                            SFF1L006,SFF1L006,SFF1L006,SFF1L006:
                            SFF1L006,SFF1L006,SFF1L006,SFF1L006:
                            SFF1L006,SFF1L006,SFF1L006,SFF1L006
SFF1L006  BEEP
          GOTO     SFF1L005
SFF1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFF1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFF1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFF1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFF1L020,SFF1L020,SFF1L020,SFF1L020:
                            SFF1L020,SFF1L020,SFF1L020,SFF1L020:
                            SFF1L020,SFF1L020,SFF1L020,SFF1L020:
                            SFF1L020,SFF1L020,SFF1L020,SFF1L020:
                            SFF1L020,SFF1L020,SFF1L020,SFF1L020:
                            SFF1L020,SFF1L020,SFF1L020,SFF1L020:
                            SFF1L020,SFF1L020,SFF1L020,SFF1L020:
                            SFF1L020,SFF1L020,SFF1L020,SFF1L020:
                            SFF1L020,SFF1L020,SFF1L020,SFF1L020:
                            SFF1L020,SFF1L020,SFF1L020,SFF1L020:
                            SFF1L020,SFF1L020,SFF1L020,SFF1L020:
                            SFF1L020,SFF1L020,SFF1L020,SFF1L020
          GOTO     SFF1L020
SFF1L090  MOVE     ZERO,ACCEPT
          GOTO     SFF1L001
.
SFF1L101
          MOVE      ZERO,EXIT
          GOTO      SFF1L999
SFF1L990  MOVE      ONE,EXIT * Exit Char Restart
SFF1L999  RETURN
.--------------------------------
. Screen - History Details Summary            
.--------------------------------
SCH1L000
SCH1L100
          MOVE      "H1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 8",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCH1L200
          CALL      CFH1L000 * Clear Fields
SCH1L300
          CALL      KYH1L000 * Enter Key Fields
          BRANCH    EXIT,SCH1L999,SCH1L999
SCH1L400
          CALL      WPH1L000 * Load any WP Details
SCH1L500
          CALL      LMH1L000 * Load any Batch Details
SCH1L600
          CALL      DFH1L000 * Display Fields
SCH1L700
          CALL      SFH1L000 * Select Fields
          BRANCH    EXIT,SCH1L100,SCH1L100,SCH1L200
SCH1L800
SCH1L900
SCH1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : History Details Summary            
.-------------------------------------------------------
CFH1L000
          MOVE      SP70,DBFDIDAT
          MOVE      SP70,DBFDDOC 
          MOVE      SP70,DBFDDLN 
          MOVE      SP70,DBFDINV 
          MOVE      SP70,DOCDESC 
          MOVE      SP70,DBFDPDAT
          MOVE      SP70,DBFDGLS 
          MOVE      SP70,DBFDBCHG
          MOVE      SP70,DBFDBDAT
          MOVE      SP70,DBFDBTIM
          MOVE      SP70,DBFDBUSR
          MOVE      SP70,DBFDITM 
          MOVE      SP70,DBFDSDAT
          MOVE      SP70,DBFDDREF
          MOVE      SP70,DBFDOREF
          MOVE      ZERO,DBFDQTY 
          MOVE      ZERO,DBFDPRI 
          MOVE      ZERO,DBFDTOT 
          MOVE      ZERO,DBFDTRT 
          MOVE      ZERO,DBFDTAX 
          MOVE      SP70,DBFDUR1 
          MOVE      SP70,DBFDUR2 
          MOVE      SP70,DBFDUD1 
          MOVE      SP70,DBFDUD2 
          MOVE      SP70,DBFDUY1 
          MOVE      SP70,DBFDUY2 
          MOVE      SP70,DBFDUC1 
          MOVE      SP70,DBFDUC2 
          MOVE      SP70,DBFDUC3 
          MOVE      SP70,DBFDUC4 
          MOVE      ZERO,DOCTOTAL
          MOVE      ZERO,OUTTOTAL
          MOVE      SP70,DBITDES 
          MOVE      SP70,DBFHDDAT
CFH1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for History Details Summary            
.--------------------------------------------------------
KYH1L000
          MOVE      ZERO,EXIT
          GOTO      KYH1L999
.
KYH1L900  MOVE      ONE,EXIT
KYH1L999  RETURN
.---------------------------------------------------------
. Load WP files for : History Details Summary            
.---------------------------------------------------------
WPH1L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : History Details Summary            
.---------------------------------------------------------
LMH1L000
.---------------------------------------------------------
. Load for :    11 Invoice Date                       
.---------------------------------------------------------
          UNPACK    SP70,DBFDDEB,DBFDIDAT,DBFDINV,DBFDDTY,DBFDDOC,DBFDDLN
          PACK      KEY44,DBDBDEB,Z70
          MOVE      KEY44,DBFD3EKY
          STRIP     DBFD3SKY
          SETLPTR   DBFD3EKY,8
          MOVE      DBFD3EKY,DBFD3SKY
          CALL      RDDBFD3 
          IF        OVRCD=0
            CALL      RPDBFD3 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPH1L000
          MOVE     ZERO,DBFD3CNT
          MOVE     ZERO,DBFD3END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPH1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPH1L600
          MATCH    PRGID,SCPSPID
          GOTO     DPH1L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPH1L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPH1L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPH1L010,DPH1L010,DPH1L010,DPH1L010:
                           DPH1L010,DPH1L010,DPH1L010,DPH1L010:
                           DPH1L010,DPH1L010,DPH1L101,DPH1L102:
                            DPH1L103,DPH1L104,DPH1L105,DPH1L106:
                            DPH1L107,DPH1L108,DPH1L109,DPH1L110:
                            DPH1L111,DPH1L112,DPH1L113,DPH1L114:
                            DPH1L115,DPH1L116,DPH1L117,DPH1L118:
                            DPH1L119,DPH1L120,DPH1L121,DPH1L122:
                            DPH1L123,DPH1L124,DPH1L125,DPH1L126:
                            DPH1L127,DPH1L128,DPH1L129,DPH1L130:
                            DPH1L131,DPH1L132,DPH1L133,DPH1L134:
                            DPH1L010,DPH1L010,DPH1L010,DPH1L010:
                           DPH1L010,DPH1L010,DPH1L010,DPH1L010:
                           DPH1L010,DPH1L010,DPH1L010,DPH1L010:
                           DPH1L010,DPH1L010,DPH1L010,DPH1L010:
                           DPH1L010,DPH1L010,DPH1L010,DPH1L010
          GOTO      DPH1L010
.
DPH1L101
          PACK      DBFD3MKY,SP70,SP70
          CALL      UPTDBFD3
          IF        DBFD3END=0
            CALL      RPDBFD3 
            IF        OVRCD=0
              PACK      DBFD3MKY,DBFDDEB,DBFDIDAT,DBFDINV,DBFDDTY,DBFDDOC,DBFDDLN                               
              MATCH     DBFD3EKY,DBFD3MKY
              IF        @EQUAL
                MOVE      ZERO,DBFD3END
                ADD       ONE,DBFD3CNT
                CALL      UPTDBFD3
          CALL      TRNLIN00
                UNPACK    DBFDIDAT,CCENT,CYEAR,CMON,CDAY          
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
              ELSE
                MOVE      ONE,DBFD3END
              ENDIF
            ELSE
              MOVE      ONE,DBFD3END
            ENDIF
          ENDIF
          IF        DBFD3END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L102
          IF        DBFD3END=0
            MOVE      DBFDDOC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L103
          IF        DBFD3END=0
            MOVE      DBFDDLN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L104
          IF        DBFD3END=0
            MOVE      DBFDINV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L105
          IF        DBFD3END=0
            MOVE      DOCDESC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L106
          IF        DBFD3END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      DBFDPDAT,FORM2   
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L107
          IF        DBFD3END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      DBFDGLS,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L108
          IF        DBFD3END=0
            MOVE      DBFDBCHG,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L109
          IF        DBFD3END=0
            UNPACK    DBFDBDAT,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L110
          IF        DBFD3END=0
            MOVE      DBFDBTIM,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L111
          IF        DBFD3END=0
            MOVE      DBFDBUSR,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L112
          IF        DBFD3END=0
            MOVE      DBFDITM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L113
          IF        DBFD3END=0
            UNPACK    DBFDSDAT,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L114
          IF        DBFD3END=0
            MOVE      DBFDDREF,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L115
          IF        DBFD3END=0
            MOVE      DBFDOREF,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L116
          IF        DBFD3END=0
            MOVE      DBFDQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L117
          IF        DBFD3END=0
            MOVE      DBFDPRI,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L118
          IF        DBFD3END=0
            MOVE      DBFDTOT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L119
          IF        DBFD3END=0
            MOVE      DBFDTRT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L120
          IF        DBFD3END=0
            MOVE      DBFDTAX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L121
          IF        DBFD3END=0
            MOVE      DBFDUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L122
          IF        DBFD3END=0
            MOVE      DBFDUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L123
          IF        DBFD3END=0
            UNPACK    DBFDUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L124
          IF        DBFD3END=0
            UNPACK    DBFDUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L125
          IF        DBFD3END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      DBFDUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L126
          IF        DBFD3END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      DBFDUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L127
          IF        DBFD3END=0
            MOVE      DBFDUC1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L128
          IF        DBFD3END=0
            MOVE      DBFDUC2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L129
          IF        DBFD3END=0
            MOVE      DBFDUC3,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L130
          IF        DBFD3END=0
            MOVE      DBFDUC4,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L131
          IF        DBFD3END=0
            MOVE      DOCTOTAL,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L132
          IF        DBFD3END=0
            MOVE      OUTTOTAL,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L133
          IF        DBFD3END=0
            MOVE      DBITDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
.
DPH1L134
          IF        DBFD3END=0
            UNPACK    DBFHDDAT,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPH1L010
DPH1L600
          MATCH    "DBFD3",NAMSSFFI
          GOTO     DPH1L605 IF NOT EQUAL
          GOTO     DPH1L999
DPH1L605
DPH1L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPH1L000
.
          MATCH    "DBFD3",NAMSSFFI
          GOTO     FPH1L105 IF NOT EQUAL
          PACK     KEY44,DBFD3SKY,Z70
          CALL     RDDBFD3  * Start
          IF       OVRCD=0
            CALL     RPDBFD3  * Start
          ENDIF
          CALL     DPH1L000
          GOTO     FPH1L999
FPH1L105
FPH1L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPH1L000
.
          MATCH    "DBFD3",NAMSSFFI
          GOTO     LPH1L105 IF NOT EQUAL
          PACK     KEY44,DBFD3SKY,SP70
          CALL     RSDBFD3  * End
          IF       OVRCD=1
            CALL     RKDBFD3 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<DBFD3SNO
            CALL     RKDBFD3 
            IF       OVRCD=1
              MOVE     DBFD3SNO,SECTOR
            ENDIF
            PACK     DBFD3MKY,DBFDDEB,DBFDIDAT,DBFDINV,DBFDDTY,DBFDDOC,DBFDDLN                               
            MATCH    DBFD3EKY,DBFD3MKY
            IF       !@EQUAL
              MOVE     DBFD3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPH1L000
          GOTO     LPH1L999
LPH1L105
LPH1L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPH1L000
.
          MATCH    "DBFD3",NAMSSFFI
          GOTO     PPH1L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPH1L105
          CALL      RFTDBFD3
          BRANCH   OVRCD,PPH1L115
          MOVE      DBFD3MKY,KEY44 
          CALL      RSDBFD3 
PPH1L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=DBFD3SNO
            CALL     RKDBFD3 
            IF       OVRCD=1
              MOVE     DBFD3SNO,SECTOR
            ENDIF
            PACK     DBFD3MKY,DBFDDEB,DBFDIDAT,DBFDINV,DBFDDTY,DBFDDOC,DBFDDLN                               
            MATCH    DBFD3EKY,DBFD3MKY
            IF       !@EQUAL
              MOVE     DBFD3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPH1L000
          GOTO     PPH1L999
PPH1L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<DBFD3SNO
            CALL     RPDBFD3 
            IF       OVRCD=1
              MOVE     DBFD3SNO,SECTOR
            ENDIF
            PACK     DBFD3MKY,DBFDDEB,DBFDIDAT,DBFDINV,DBFDDTY,DBFDDOC,DBFDDLN                               
            MATCH    DBFD3EKY,DBFD3MKY
            IF       !@EQUAL
              MOVE     DBFD3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPH1L999
PPH1L120
PPH1L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPH1L000
          MATCH    "DBFD3",NAMSSFFI
          GOTO     NPH1L115 IF NOT EQUAL
NPH1L105
          CALL     RPDBFD3 
          BRANCH   OVRCD,NPH1L110
          PACK     DBFD3MKY,DBFDDEB,DBFDIDAT,DBFDINV,DBFDDTY,DBFDDOC,DBFDDLN                               
          MATCH    DBFD3EKY,DBFD3MKY
          GOTO     NPH1L110 IF NOT EQUAL
          CALL     RKDBFD3 
          CALL     DPH1L000
          GOTO     NPH1L999
NPH1L110
          CALL     RKDBFD3 
          BEEP
          GOTO     NPH1L999
NPH1L115
NPH1L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTH1L000
CTH1L105
CTH1L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : History Details Summary            
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    11 Invoice Date                       
.---------------------------------------------------------
UPTDBFD3
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      DBFD3FL1,KEY5;ANS
          IF        @OVER
            WRITE     DBFD3FL1,KEY5;SCPSROW,SCPSCOL,DBFD3MKY
          ELSE
            UPDATE    DBFD3FL1;SCPSROW,SCPSCOL,DBFD3MKY
          ENDIF
          RETURN
RDTDBFD3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      DBFD3FL1,KEY5;SCPSROW,SCPSCOL,DBFD3MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTDBFD3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      DBFD3FL1,KEY5;;
          READKS    DBFD3FL1;SCPSROW,SCPSCOL,DBFD3MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,DBFD3MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : History Details Summary            
.---------------------------------------------------------
DFH1L000
          BRANCH   ACCEPT,DFH1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFH1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFH1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFH1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFH1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFH1L010 IF NOT EQUAL
.
          CALL     PSH1L000 * Display Field
          GOTO     DFH1L010
DFH1L900
          MOVE      "DBFD3",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      FPH1L000
DFH1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : History Details Summary            
.---------------------------------------------------------
PSH1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSH1L999,PSH1L999,PSH1L999,PSH1L999:
                           PSH1L999,PSH1L999,PSH1L999,PSH1L999:
                           PSH1L999,PSH1L999,PSH1L999,PSH1L999:
                            PSH1L999,PSH1L999,PSH1L999,PSH1L999:
                            PSH1L999,PSH1L999,PSH1L999,PSH1L999:
                            PSH1L999,PSH1L999,PSH1L999,PSH1L999:
                            PSH1L999,PSH1L999,PSH1L999,PSH1L999:
                            PSH1L999,PSH1L999,PSH1L999,PSH1L999:
                            PSH1L999,PSH1L999,PSH1L999,PSH1L999:
                            PSH1L999,PSH1L999,PSH1L999,PSH1L999:
                            PSH1L999,PSH1L999,PSH1L999,PSH1L999:
                            PSH1L999,PSH1L999,PSH1L999,PSH1L999:
                           PSH1L999,PSH1L999,PSH1L999,PSH1L999:
                           PSH1L999,PSH1L999,PSH1L999,PSH1L999:
                           PSH1L999,PSH1L999,PSH1L999,PSH1L999:
                           PSH1L999,PSH1L999,PSH1L999,PSH1L999
          GOTO     PSH1L999
PSH1L999
          RETURN
.---------------------------------------------------------
. Selections for : History Details Summary            
.---------------------------------------------------------
SFH1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFH1L001  BRANCH   ACCEPT,SFH1L020
.
SFH1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFH1L006,SFH1L101,SFH1L102,SFH1L006:
                           SFH1L006,SFH1L006,SFH1L006,SFH1L006:
                           SFH1L006,SFH1L006,SFH1L103,SFH1L006:
                            SFH1L006,SFH1L006,SFH1L006,SFH1L006:
                            SFH1L006,SFH1L006,SFH1L006,SFH1L006:
                            SFH1L006,SFH1L006,SFH1L006,SFH1L006:
                            SFH1L006,SFH1L006,SFH1L006,SFH1L006:
                            SFH1L006,SFH1L006,SFH1L006,SFH1L006:
                            SFH1L006,SFH1L006,SFH1L006,SFH1L006:
                            SFH1L006,SFH1L006,SFH1L006,SFH1L006:
                            SFH1L006,SFH1L006,SFH1L006,SFH1L006:
                            SFH1L006,SFH1L006,SFH1L006,SFH1L006:
                           SFH1L006,SFH1L006,SFH1L006,SFH1L006:
                           SFH1L006,SFH1L006,SFH1L006,SFH1L006:
                           SFH1L006,SFH1L006,SFH1L006,SFH1L006:
                           SFH1L104,SFH1L105,SFH1L106,SFH1L107
SFH1L006  BEEP
          GOTO     SFH1L005
SFH1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFH1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFH1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFH1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFH1L020,SFH1L020,SFH1L020,SFH1L020:
                           SFH1L020,SFH1L020,SFH1L020,SFH1L020:
                           SFH1L020,SFH1L020,SFH1L103,SFH1L020:
                            SFH1L020,SFH1L020,SFH1L020,SFH1L020:
                            SFH1L020,SFH1L020,SFH1L020,SFH1L020:
                            SFH1L020,SFH1L020,SFH1L020,SFH1L020:
                            SFH1L020,SFH1L020,SFH1L020,SFH1L020:
                            SFH1L020,SFH1L020,SFH1L020,SFH1L020:
                            SFH1L020,SFH1L020,SFH1L020,SFH1L020:
                            SFH1L020,SFH1L020,SFH1L020,SFH1L020:
                            SFH1L020,SFH1L020,SFH1L020,SFH1L020:
                            SFH1L020,SFH1L020,SFH1L020,SFH1L020:
                           SFH1L020,SFH1L020,SFH1L020,SFH1L020:
                           SFH1L020,SFH1L020,SFH1L020,SFH1L020:
                           SFH1L020,SFH1L020,SFH1L020,SFH1L020:
                           SFH1L020,SFH1L020,SFH1L020,SFH1L020
          GOTO     SFH1L020
SFH1L090  MOVE     ZERO,ACCEPT
          MOVE      "DBFD3",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      FPH1L000
          GOTO     SFH1L001
.
SFH1L101
          MOVE      ZERO,EXIT
          GOTO      SFH1L999
.
SFH1L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCTDL000
          MOVE      "H1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SFH1L001
.
SFH1L103
          CALL      SELECTED
          BRANCH    EXIT,SFH1L001
          COMPARE   ONE,ACCEPT
          GOTO      SFH1L001 IF EQUAL
          CALL      RDTDBFD3
          IF        OVRCD=1
            BEEP
            GOTO      SFH1L001
          ENDIF
          MATCH     SP70,DBFD3MKY
          IF        @EQUAL
            BEEP
            GOTO      SFH1L001
          ENDIF
          MOVE      DBFD3MKY,KEY44 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SHIST000
          MOVE      "H1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTDBFD3
          IF        OVRCD=1
            CALL      FPH1L000
          ELSE
            MOVE      DBFD3MKY,KEY44 
            CALL      RSDBFD3 
            CALL      RKDBFD3 
            CALL      DPH1L000
          ENDIF
          GOTO     SFH1L001
.
SFH1L104
          MOVE      "DBFD3",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      NPH1L000
          GOTO     SFH1L001
.
SFH1L105
          MOVE      "DBFD3",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      PPH1L000
          GOTO     SFH1L001
.
SFH1L106
          MOVE      "DBFD3",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      FPH1L000
          GOTO     SFH1L001
.
SFH1L107
          MOVE      "DBFD3",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      LPH1L000
          GOTO     SFH1L001
SFH1L990  MOVE      ONE,EXIT * Exit Char Restart
SFH1L999  RETURN
.--------------------------------
. Screen - Enquire by Invoice Ref             
.--------------------------------
SCI1L000
SCI1L100
          MOVE      "I1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCI1L200
          CALL      CFI1L000 * Clear Fields
SCI1L300
          CALL      KYI1L000 * Enter Key Fields
          BRANCH    EXIT,SCI1L999,SCI1L999
SCI1L400
          CALL      WPI1L000 * Load any WP Details
SCI1L500
          CALL      LMI1L000 * Load any Batch Details
SCI1L600
          CALL      DFI1L000 * Display Fields
SCI1L700
          CALL      SFI1L000 * Select Fields
          BRANCH    EXIT,SCI1L100,SCI1L100,SCI1L200
SCI1L800
SCI1L900
SCI1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Enquire by Invoice Ref             
.-------------------------------------------------------
CFI1L000  COMPARE   ZERO,ACCEPT
              GOTO      CFI1L999 IF EQUAL
          MOVE      SP70,TRANREF 
          MOVE      SP70,DBDBDEB 
          MOVE      SP70,DBDBNA1 
          MOVE      SP70,DBDBNA2 
          MOVE      SP70,DBFDINV 
          MOVE      SP70,DBFDDOC 
          MOVE      SP70,DBFHDDAT
          MOVE      SP70,DBFHDTY 
          MOVE      SP70,DOCDESC 
          MOVE      SP70,DBITDES 
          MOVE      ZERO,DOCTOTAL
CFI1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Enquire by Invoice Ref             
.--------------------------------------------------------
KYI1L000
.
KYI1L110
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KEYINV00
          BRANCH    EXIT,KYI1L900,KYI1L900
          MOVE      ZERO,ACCEPT
          MOVE      TRANREF,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KYI1L999
.
KYI1L900  MOVE      ONE,EXIT
KYI1L999  RETURN
.---------------------------------------------------------
. Load WP files for : Enquire by Invoice Ref             
.---------------------------------------------------------
WPI1L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Enquire by Invoice Ref             
.---------------------------------------------------------
LMI1L000
.---------------------------------------------------------
. Load for :    10 Document Reference                 
.---------------------------------------------------------
          UNPACK    SP70,DBFDINV,DBFDDTY,DBFDDOC,DBFDDLN,DBFDDEB
          PACK      KEY36,TRANREF,SP70
          MOVE      KEY36,DBFD8EKY
          STRIP     DBFD8SKY
          SETLPTR   DBFD8EKY,12
          MOVE      DBFD8EKY,DBFD8SKY
          CALL      RDDBFD8 
          IF        OVRCD=0
            CALL      RPDBFD8 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPI1L000
          MOVE     ZERO,DBFD8CNT
          MOVE     ZERO,DBFD8END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPI1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPI1L600
          MATCH    PRGID,SCPSPID
          GOTO     DPI1L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPI1L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPI1L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPI1L010,DPI1L010,DPI1L010,DPI1L010:
                            DPI1L010,DPI1L010,DPI1L010,DPI1L010:
                            DPI1L101,DPI1L102,DPI1L010,DPI1L010:
                            DPI1L010,DPI1L010,DPI1L010,DPI1L010:
                            DPI1L103,DPI1L104,DPI1L105,DPI1L106:
                            DPI1L107
          GOTO      DPI1L010
.
DPI1L101
          IF        DBFD8END=0
            MOVE      DBFDINV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPI1L010
.
DPI1L102
          PACK      DBFD8MKY,SP70,SP70
          CALL      UPTDBFD8
          IF        DBFD8END=0
            CALL      RKDBFD8 
            IF        OVRCD=0
              PACK      DBFD8MKY,DBFDINV,DBFDDTY,DBFDDOC,DBFDDLN,DBFDDEB                                        
              MATCH     DBFD8EKY,DBFD8MKY
              IF        @EQUAL
                MOVE      ZERO,DBFD8END
                ADD       ONE,DBFD8CNT
                CALL      UPTDBFD8
          CALL      TRNLIN00
                MOVE      DBFDDOC,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,DBFD8END
              ENDIF
            ELSE
              MOVE      ONE,DBFD8END
            ENDIF
          ENDIF
          IF        DBFD8END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPI1L010
.
DPI1L103
          IF        DBFD8END=0
            UNPACK    DBFHDDAT,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPI1L010
.
DPI1L104
          IF        DBFD8END=0
            MOVE      DBFHDTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPI1L010
.
DPI1L105
          IF        DBFD8END=0
            MOVE      DOCDESC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPI1L010
.
DPI1L106
          IF        DBFD8END=0
            MOVE      DBITDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPI1L010
.
DPI1L107
          IF        DBFD8END=0
            MOVE      DOCTOTAL,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPI1L010
DPI1L600
          MATCH    "DBFD8",NAMSSFFI
          GOTO     DPI1L605 IF NOT EQUAL
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DBDBDEB,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     DPI1L999
DPI1L605
DPI1L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPI1L000
.
          MATCH    "DBFD8",NAMSSFFI
          GOTO     FPI1L105 IF NOT EQUAL
          PACK     KEY36,DBFD8SKY,SP70
          CALL     RDDBFD8  * Start
          IF       OVRCD=0
            CALL     RPDBFD8  * Start
          ENDIF
          CALL     DPI1L000
          GOTO     FPI1L999
FPI1L105
FPI1L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPI1L000
.
          MATCH    "DBFD8",NAMSSFFI
          GOTO     LPI1L105 IF NOT EQUAL
          PACK     KEY36,DBFD8SKY,Z70
          CALL     RSDBFD8  * End
          IF       OVRCD=1
            CALL     RPDBFD8 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<DBFD8SNO
            CALL     RPDBFD8 
            IF       OVRCD=1
              MOVE     DBFD8SNO,SECTOR
            ENDIF
            PACK     DBFD8MKY,DBFDINV,DBFDDTY,DBFDDOC,DBFDDLN,DBFDDEB                                        
            MATCH    DBFD8EKY,DBFD8MKY
            IF       !@EQUAL
              MOVE     DBFD8SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPI1L000
          GOTO     LPI1L999
LPI1L105
LPI1L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPI1L000
.
          MATCH    "DBFD8",NAMSSFFI
          GOTO     PPI1L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPI1L105
          CALL      RFTDBFD8
          BRANCH   OVRCD,PPI1L115
          MOVE      DBFD8MKY,KEY36 
          CALL      RSDBFD8 
PPI1L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=DBFD8SNO
            CALL     RPDBFD8 
            IF       OVRCD=1
              MOVE     DBFD8SNO,SECTOR
            ENDIF
            PACK     DBFD8MKY,DBFDINV,DBFDDTY,DBFDDOC,DBFDDLN,DBFDDEB                                        
            MATCH    DBFD8EKY,DBFD8MKY
            IF       !@EQUAL
              MOVE     DBFD8SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPI1L000
          GOTO     PPI1L999
PPI1L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<DBFD8SNO
            CALL     RKDBFD8 
            IF       OVRCD=1
              MOVE     DBFD8SNO,SECTOR
            ENDIF
            PACK     DBFD8MKY,DBFDINV,DBFDDTY,DBFDDOC,DBFDDLN,DBFDDEB                                        
            MATCH    DBFD8EKY,DBFD8MKY
            IF       !@EQUAL
              MOVE     DBFD8SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPI1L999
PPI1L120
PPI1L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPI1L000
          MATCH    "DBFD8",NAMSSFFI
          GOTO     NPI1L115 IF NOT EQUAL
NPI1L105
          CALL     RKDBFD8 
          BRANCH   OVRCD,NPI1L110
          PACK     DBFD8MKY,DBFDINV,DBFDDTY,DBFDDOC,DBFDDLN,DBFDDEB                                        
          MATCH    DBFD8EKY,DBFD8MKY
          GOTO     NPI1L110 IF NOT EQUAL
          CALL     RPDBFD8 
          CALL     DPI1L000
          GOTO     NPI1L999
NPI1L110
          CALL     RPDBFD8 
          BEEP
          GOTO     NPI1L999
NPI1L115
NPI1L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTI1L000
CTI1L105
CTI1L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Enquire by Invoice Ref             
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    10 Document Reference                 
.---------------------------------------------------------
UPTDBFD8
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      DBFD8FL1,KEY5;ANS
          IF        @OVER
            WRITE     DBFD8FL1,KEY5;SCPSROW,SCPSCOL,DBFD8MKY
          ELSE
            UPDATE    DBFD8FL1;SCPSROW,SCPSCOL,DBFD8MKY
          ENDIF
          RETURN
RDTDBFD8
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      DBFD8FL1,KEY5;SCPSROW,SCPSCOL,DBFD8MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTDBFD8
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      DBFD8FL1,KEY5;;
          READKS    DBFD8FL1;SCPSROW,SCPSCOL,DBFD8MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,DBFD8MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Enquire by Invoice Ref             
.---------------------------------------------------------
DFI1L000
          BRANCH   ACCEPT,DFI1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFI1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFI1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFI1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFI1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFI1L010 IF NOT EQUAL
.
          CALL     PSI1L000 * Display Field
          GOTO     DFI1L010
DFI1L900
          MOVE      "DBFD8",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FPI1L000
DFI1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Enquire by Invoice Ref             
.---------------------------------------------------------
PSI1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSI1L999,PSI1L999,PSI1L999,PSI1L999:
                            PSI1L101,PSI1L102,PSI1L103,PSI1L999:
                            PSI1L999,PSI1L999,PSI1L999,PSI1L999:
                            PSI1L999,PSI1L999,PSI1L999,PSI1L999:
                            PSI1L999,PSI1L999,PSI1L999,PSI1L999:
                            PSI1L999
          GOTO     PSI1L999
.
PSI1L101
          MOVE      DBDBDEB,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L102
          MOVE      DBDBNA1,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L103
          MOVE      DBDBNA2,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
PSI1L999
          RETURN
.---------------------------------------------------------
. Selections for : Enquire by Invoice Ref             
.---------------------------------------------------------
SFI1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFI1L001  BRANCH   ACCEPT,SFI1L020
.
SFI1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFI1L006,SFI1L101,SFI1L102,SFI1L006:
                            SFI1L006,SFI1L006,SFI1L006,SFI1L103:
                            SFI1L006,SFI1L104,SFI1L105,SFI1L106:
                            SFI1L006,SFI1L006,SFI1L107,SFI1L108:
                            SFI1L006,SFI1L006,SFI1L006,SFI1L006:
                            SFI1L006
SFI1L006  BEEP
          GOTO     SFI1L005
SFI1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFI1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFI1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFI1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFI1L020,SFI1L020,SFI1L020,SFI1L020:
                            SFI1L020,SFI1L020,SFI1L020,SFI1L020:
                            SFI1L020,SFI1L104,SFI1L020,SFI1L020:
                            SFI1L020,SFI1L020,SFI1L020,SFI1L020:
                            SFI1L020,SFI1L020,SFI1L020,SFI1L020:
                            SFI1L020
          GOTO     SFI1L020
SFI1L090  MOVE     ZERO,ACCEPT
          MOVE      "DBFD8",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FPI1L000
          GOTO     SFI1L001
.
SFI1L101
          MOVE      ZERO,EXIT
          GOTO      SFI1L999
.
SFI1L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCTDL000
          MOVE      "I1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SFI1L001
.
SFI1L103
          MOVE      ONE,EXIT
          GOTO      SFI1L999
.
SFI1L104
          CALL      SELECTED
          BRANCH    EXIT,SFI1L001
          COMPARE   ONE,ACCEPT
          GOTO      SFI1L001 IF EQUAL
          CALL      RDTDBFD8
          IF        OVRCD=1
            BEEP
            GOTO      SFI1L001
          ENDIF
          MATCH     SP70,DBFD8MKY
          IF        @EQUAL
            BEEP
            GOTO      SFI1L001
          ENDIF
          MOVE      DBFD8MKY,KEY36 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SDOCI000
          MOVE      "I1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTDBFD8
          IF        OVRCD=1
            CALL      FPI1L000
          ELSE
            MOVE      DBFD8MKY,KEY36 
            CALL      RSDBFD8 
            CALL      RPDBFD8 
            CALL      DPI1L000
          ENDIF
          GOTO     SFI1L001
.
SFI1L105
          MOVE      "DBFD8",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      NPI1L000
          GOTO     SFI1L001
.
SFI1L106
          MOVE      "DBFD8",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      PPI1L000
          GOTO     SFI1L001
.
SFI1L107
          MOVE      "DBFD8",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FPI1L000
          GOTO     SFI1L001
.
SFI1L108
          MOVE      "DBFD8",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      LPI1L000
          GOTO     SFI1L001
SFI1L990  MOVE      ONE,EXIT * Exit Char Restart
SFI1L999  RETURN
.--------------------------------
. Screen - Outstanding Transaction Details    
.--------------------------------
SCO1L000
SCO1L100
          MOVE      "O1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 8",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCO1L200
          CALL      CFO1L000 * Clear Fields
          CALL      DEBOUT00
SCO1L300
          CALL      KYO1L000 * Enter Key Fields
          BRANCH    EXIT,SCO1L999,SCO1L999
SCO1L400
          CALL      WPO1L000 * Load any WP Details
SCO1L500
          CALL      LMO1L000 * Load any Batch Details
SCO1L600
          CALL      DFO1L000 * Display Fields
SCO1L700
          CALL      SFO1L000 * Select Fields
          BRANCH    EXIT,SCO1L100,SCO1L100,SCO1L200
SCO1L800
SCO1L900
SCO1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Outstanding Transaction Details    
.-------------------------------------------------------
CFO1L000
CFO1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Outstanding Transaction Details    
.--------------------------------------------------------
KYO1L000
          MOVE      ZERO,EXIT
          GOTO      KYO1L999
.
KYO1L900  MOVE      ONE,EXIT
KYO1L999  RETURN
.---------------------------------------------------------
. Load WP files for : Outstanding Transaction Details    
.---------------------------------------------------------
WPO1L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Outstanding Transaction Details    
.---------------------------------------------------------
LMO1L000
.---------------------------------------------------------
. Load for :     4 Invoice Date                       
.---------------------------------------------------------
          UNPACK    SP70,DBFDDEB,DBFDPDAT,DBFDIDAT,DBFDINV,DBFDDTY,DBFDDOC,DBFDDLN
          PACK      KEY52,DBDBDEB,DATE9999,Z70
          MOVE      KEY52,DBFD2EKY
          STRIP     DBFD2SKY
          SETLPTR   DBFD2EKY,16
          MOVE      DBFD2EKY,DBFD2SKY
          CALL      RDDBFD2 
          IF        OVRCD=0
            CALL      RPDBFD2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPO1L000
          MOVE     ZERO,DBFD2CNT
          MOVE     ZERO,DBFD2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPO1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPO1L600
          MATCH    PRGID,SCPSPID
          GOTO     DPO1L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPO1L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPO1L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPO1L010,DPO1L010,DPO1L010,DPO1L101:
                            DPO1L102,DPO1L103,DPO1L104,DPO1L105:
                            DPO1L106,DPO1L107,DPO1L108,DPO1L109:
                            DPO1L110,DPO1L111,DPO1L112,DPO1L113:
                            DPO1L114,DPO1L115,DPO1L116,DPO1L117:
                            DPO1L118,DPO1L119,DPO1L120,DPO1L121:
                            DPO1L122,DPO1L123,DPO1L124,DPO1L125:
                            DPO1L126,DPO1L127,DPO1L128,DPO1L129:
                            DPO1L130,DPO1L131,DPO1L132,DPO1L133:
                            DPO1L010,DPO1L010,DPO1L010,DPO1L010:
                           DPO1L010,DPO1L010,DPO1L010,DPO1L010:
                            DPO1L010,DPO1L010,DPO1L010,DPO1L010:
                            DPO1L010
          GOTO      DPO1L010
.
DPO1L101
          PACK      DBFD2MKY,SP70,SP70
          CALL      UPTDBFD2
          IF        DBFD2END=0
            CALL      RPDBFD2 
            IF        OVRCD=0
              PACK      DBFD2MKY,DBFDDEB,DBFDPDAT,DBFDIDAT,DBFDINV,DBFDDTY,DBFDDOC,DBFDDLN                      
              MATCH     DBFD2EKY,DBFD2MKY
              IF        @EQUAL
                MOVE      ZERO,DBFD2END
                ADD       ONE,DBFD2CNT
                CALL      UPTDBFD2
          CALL      OUTLIN00
                UNPACK    DBFDIDAT,CCENT,CYEAR,CMON,CDAY          
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
              ELSE
                MOVE      ONE,DBFD2END
              ENDIF
            ELSE
              MOVE      ONE,DBFD2END
            ENDIF
          ENDIF
          IF        DBFD2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L102
          IF        DBFD2END=0
            MOVE      DBFDDOC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L103
          IF        DBFD2END=0
            MOVE      DBFDDLN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L104
          IF        DBFD2END=0
            MOVE      DBFDINV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L105
          IF        DBFD2END=0
            MOVE      DOCDESC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L106
          IF        DBFD2END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      DBFDPDAT,FORM2   
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L107
          IF        DBFD2END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      DBFDGLS,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L108
          IF        DBFD2END=0
            MOVE      DBFDBCHG,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L109
          IF        DBFD2END=0
            UNPACK    DBFDBDAT,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L110
          IF        DBFD2END=0
            MOVE      DBFDBTIM,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L111
          IF        DBFD2END=0
            MOVE      DBFDBUSR,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L112
          IF        DBFD2END=0
            MOVE      DBFDITM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L113
          IF        DBFD2END=0
            UNPACK    DBFDSDAT,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L114
          IF        DBFD2END=0
            MOVE      DBFDDREF,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L115
          IF        DBFD2END=0
            MOVE      DBFDOREF,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L116
          IF        DBFD2END=0
            MOVE      DBFDQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L117
          IF        DBFD2END=0
            MOVE      DBFDPRI,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L118
          IF        DBFD2END=0
            MOVE      DBFDTOT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L119
          IF        DBFD2END=0
            MOVE      DBFDTRT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L120
          IF        DBFD2END=0
            MOVE      DBFDTAX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L121
          IF        DBFD2END=0
            MOVE      DBFDUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L122
          IF        DBFD2END=0
            MOVE      DBFDUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L123
          IF        DBFD2END=0
            UNPACK    DBFDUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L124
          IF        DBFD2END=0
            UNPACK    DBFDUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L125
          IF        DBFD2END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      DBFDUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L126
          IF        DBFD2END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      DBFDUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L127
          IF        DBFD2END=0
            MOVE      DBFDUC1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L128
          IF        DBFD2END=0
            MOVE      DBFDUC2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L129
          IF        DBFD2END=0
            MOVE      DBFDUC3,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L130
          IF        DBFD2END=0
            MOVE      DBFDUC4,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L131
          IF        DBFD2END=0
            MOVE      DOCTOTAL,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L132
          IF        DBFD2END=0
            MOVE      OUTTOTAL,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
.
DPO1L133
          IF        DBFD2END=0
            MOVE      DBITDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPO1L010
DPO1L600
          MATCH    "DBFD2",NAMSSFFI
          GOTO     DPO1L605 IF NOT EQUAL
          GOTO     DPO1L999
DPO1L605
DPO1L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPO1L000
.
          MATCH    "DBFD2",NAMSSFFI
          GOTO     FPO1L105 IF NOT EQUAL
          PACK     KEY52,DBFD2SKY,Z70
          CALL     RDDBFD2  * Start
          IF       OVRCD=0
            CALL     RPDBFD2  * Start
          ENDIF
          CALL     DPO1L000
          GOTO     FPO1L999
FPO1L105
FPO1L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPO1L000
.
          MATCH    "DBFD2",NAMSSFFI
          GOTO     LPO1L105 IF NOT EQUAL
          PACK     KEY52,DBFD2SKY,SP70
          CALL     RSDBFD2  * End
          IF       OVRCD=1
            CALL     RKDBFD2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<DBFD2SNO
            CALL     RKDBFD2 
            IF       OVRCD=1
              MOVE     DBFD2SNO,SECTOR
            ENDIF
            PACK     DBFD2MKY,DBFDDEB,DBFDPDAT,DBFDIDAT,DBFDINV,DBFDDTY,DBFDDOC,DBFDDLN                      
            MATCH    DBFD2EKY,DBFD2MKY
            IF       !@EQUAL
              MOVE     DBFD2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPO1L000
          GOTO     LPO1L999
LPO1L105
LPO1L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPO1L000
.
          MATCH    "DBFD2",NAMSSFFI
          GOTO     PPO1L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPO1L105
          CALL      RFTDBFD2
          BRANCH   OVRCD,PPO1L115
          MOVE      DBFD2MKY,KEY52 
          CALL      RSDBFD2 
PPO1L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=DBFD2SNO
            CALL     RKDBFD2 
            IF       OVRCD=1
              MOVE     DBFD2SNO,SECTOR
            ENDIF
            PACK     DBFD2MKY,DBFDDEB,DBFDPDAT,DBFDIDAT,DBFDINV,DBFDDTY,DBFDDOC,DBFDDLN                      
            MATCH    DBFD2EKY,DBFD2MKY
            IF       !@EQUAL
              MOVE     DBFD2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPO1L000
          GOTO     PPO1L999
PPO1L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<DBFD2SNO
            CALL     RPDBFD2 
            IF       OVRCD=1
              MOVE     DBFD2SNO,SECTOR
            ENDIF
            PACK     DBFD2MKY,DBFDDEB,DBFDPDAT,DBFDIDAT,DBFDINV,DBFDDTY,DBFDDOC,DBFDDLN                      
            MATCH    DBFD2EKY,DBFD2MKY
            IF       !@EQUAL
              MOVE     DBFD2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPO1L999
PPO1L120
PPO1L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPO1L000
          MATCH    "DBFD2",NAMSSFFI
          GOTO     NPO1L115 IF NOT EQUAL
NPO1L105
          CALL     RPDBFD2 
          BRANCH   OVRCD,NPO1L110
          PACK     DBFD2MKY,DBFDDEB,DBFDPDAT,DBFDIDAT,DBFDINV,DBFDDTY,DBFDDOC,DBFDDLN                      
          MATCH    DBFD2EKY,DBFD2MKY
          GOTO     NPO1L110 IF NOT EQUAL
          CALL     RKDBFD2 
          CALL     DPO1L000
          GOTO     NPO1L999
NPO1L110
          CALL     RKDBFD2 
          BEEP
          GOTO     NPO1L999
NPO1L115
NPO1L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTO1L000
CTO1L105
CTO1L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Outstanding Transaction Details    
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     4 Invoice Date                       
.---------------------------------------------------------
UPTDBFD2
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      DBFD2FL1,KEY5;ANS
          IF        @OVER
            WRITE     DBFD2FL1,KEY5;SCPSROW,SCPSCOL,DBFD2MKY
          ELSE
            UPDATE    DBFD2FL1;SCPSROW,SCPSCOL,DBFD2MKY
          ENDIF
          RETURN
RDTDBFD2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      DBFD2FL1,KEY5;SCPSROW,SCPSCOL,DBFD2MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTDBFD2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      DBFD2FL1,KEY5;;
          READKS    DBFD2FL1;SCPSROW,SCPSCOL,DBFD2MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,DBFD2MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Outstanding Transaction Details    
.---------------------------------------------------------
DFO1L000
          BRANCH   ACCEPT,DFO1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFO1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFO1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFO1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFO1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFO1L010 IF NOT EQUAL
.
          CALL     PSO1L000 * Display Field
          GOTO     DFO1L010
DFO1L900
          MOVE      "DBFD2",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FPO1L000
DFO1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Outstanding Transaction Details    
.---------------------------------------------------------
PSO1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSO1L999,PSO1L999,PSO1L999,PSO1L999:
                            PSO1L999,PSO1L999,PSO1L999,PSO1L999:
                            PSO1L999,PSO1L999,PSO1L999,PSO1L999:
                            PSO1L999,PSO1L999,PSO1L999,PSO1L999:
                            PSO1L999,PSO1L999,PSO1L999,PSO1L999:
                            PSO1L999,PSO1L999,PSO1L999,PSO1L999:
                            PSO1L999,PSO1L999,PSO1L999,PSO1L999:
                            PSO1L999,PSO1L999,PSO1L999,PSO1L999:
                            PSO1L999,PSO1L999,PSO1L999,PSO1L999:
                            PSO1L999,PSO1L999,PSO1L999,PSO1L999:
                           PSO1L999,PSO1L999,PSO1L999,PSO1L999:
                            PSO1L101,PSO1L102,PSO1L103,PSO1L104:
                            PSO1L105
          GOTO     PSO1L999
.
PSO1L101
          MOVE      TOTALOUT,VAR     
          CALL      DISPITEM
          GOTO     PSO1L999
.
PSO1L102
          MOVE      CURRENT,VAR      
          CALL      DISPITEM
          GOTO     PSO1L999
.
PSO1L103
          MOVE      BALTOT30,VAR     
          CALL      DISPITEM
          GOTO     PSO1L999
.
PSO1L104
          MOVE      BALTOT60,VAR     
          CALL      DISPITEM
          GOTO     PSO1L999
.
PSO1L105
          MOVE      BALTOT90,VAR     
          CALL      DISPITEM
          GOTO     PSO1L999
PSO1L999
          RETURN
.---------------------------------------------------------
. Selections for : Outstanding Transaction Details    
.---------------------------------------------------------
SFO1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFO1L001  BRANCH   ACCEPT,SFO1L020
.
SFO1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFO1L006,SFO1L101,SFO1L006,SFO1L102:
                            SFO1L006,SFO1L006,SFO1L006,SFO1L006:
                            SFO1L006,SFO1L006,SFO1L006,SFO1L006:
                            SFO1L006,SFO1L006,SFO1L006,SFO1L006:
                            SFO1L006,SFO1L006,SFO1L006,SFO1L006:
                            SFO1L006,SFO1L006,SFO1L006,SFO1L006:
                            SFO1L006,SFO1L006,SFO1L006,SFO1L006:
                            SFO1L006,SFO1L006,SFO1L006,SFO1L006:
                            SFO1L006,SFO1L006,SFO1L006,SFO1L006:
                            SFO1L006,SFO1L006,SFO1L006,SFO1L006:
                           SFO1L103,SFO1L104,SFO1L105,SFO1L106:
                            SFO1L006,SFO1L006,SFO1L006,SFO1L006:
                            SFO1L006
SFO1L006  BEEP
          GOTO     SFO1L005
SFO1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFO1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFO1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFO1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFO1L020,SFO1L020,SFO1L020,SFO1L102:
                            SFO1L020,SFO1L020,SFO1L020,SFO1L020:
                            SFO1L020,SFO1L020,SFO1L020,SFO1L020:
                            SFO1L020,SFO1L020,SFO1L020,SFO1L020:
                            SFO1L020,SFO1L020,SFO1L020,SFO1L020:
                            SFO1L020,SFO1L020,SFO1L020,SFO1L020:
                            SFO1L020,SFO1L020,SFO1L020,SFO1L020:
                            SFO1L020,SFO1L020,SFO1L020,SFO1L020:
                            SFO1L020,SFO1L020,SFO1L020,SFO1L020:
                            SFO1L020,SFO1L020,SFO1L020,SFO1L020:
                           SFO1L020,SFO1L020,SFO1L020,SFO1L020:
                            SFO1L020,SFO1L020,SFO1L020,SFO1L020:
                            SFO1L020
          GOTO     SFO1L020
SFO1L090  MOVE     ZERO,ACCEPT
          MOVE      "DBFD2",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FPO1L000
          GOTO     SFO1L001
.
SFO1L101
          MOVE      ZERO,EXIT
          GOTO      SFO1L999
.
SFO1L102
          CALL      SELECTED
          BRANCH    EXIT,SFO1L001
          COMPARE   ONE,ACCEPT
          GOTO      SFO1L001 IF EQUAL
          CALL      RDTDBFD2
          IF        OVRCD=1
            BEEP
            GOTO      SFO1L001
          ENDIF
          MATCH     SP70,DBFD2MKY
          IF        @EQUAL
            BEEP
            GOTO      SFO1L001
          ENDIF
          MOVE      DBFD2MKY,KEY52 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      STRAN000
          MOVE      "O1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTDBFD2
          IF        OVRCD=1
            CALL      FPO1L000
          ELSE
            MOVE      DBFD2MKY,KEY52 
            CALL      RSDBFD2 
            CALL      RKDBFD2 
            CALL      DPO1L000
          ENDIF
          GOTO     SFO1L001
.
SFO1L103
          MOVE      "DBFD2",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      NPO1L000
          GOTO     SFO1L001
.
SFO1L104
          MOVE      "DBFD2",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      PPO1L000
          GOTO     SFO1L001
.
SFO1L105
          MOVE      "DBFD2",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FPO1L000
          GOTO     SFO1L001
.
SFO1L106
          MOVE      "DBFD2",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      LPO1L000
          GOTO     SFO1L001
SFO1L990  MOVE      ONE,EXIT * Exit Char Restart
SFO1L999  RETURN
.--------------------------------
. Screen - Enquire by Doc Ref                 
.--------------------------------
SCR1L000
SCR1L100
          MOVE      "R1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCR1L200
          CALL      CFR1L000 * Clear Fields
SCR1L300
          CALL      KYR1L000 * Enter Key Fields
          BRANCH    EXIT,SCR1L999,SCR1L999
SCR1L400
          CALL      WPR1L000 * Load any WP Details
SCR1L500
          CALL      LMR1L000 * Load any Batch Details
SCR1L600
          CALL      DFR1L000 * Display Fields
SCR1L700
          CALL      SFR1L000 * Select Fields
          BRANCH    EXIT,SCR1L100,SCR1L100,SCR1L200
SCR1L800
SCR1L900
SCR1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Enquire by Doc Ref                 
.-------------------------------------------------------
CFR1L000
          MOVE      SP70,TRANREF 
          MOVE      SP70,DBFHDEB 
          MOVE      SP70,DBFHDTY 
          MOVE      SP70,DBFHDOC 
          MOVE      SP70,DBFHDDAT
          MOVE      SP70,DBFHTER 
          MOVE      ZERO,DBFHTOT 
          MOVE      ZERO,DBFHTAX 
          MOVE      SP70,DBFHDPRT
          MOVE      SP70,DBFHDSTA
          MOVE      SP70,DBFHCDAT
          MOVE      SP70,DBFHCTIM
          MOVE      SP70,DBFHCUSR
          MOVE      SP70,DBFHUR1 
          MOVE      SP70,DBFHUR2 
          MOVE      SP70,DBFHUD1 
          MOVE      SP70,DBFHUD2 
          MOVE      SP70,DBFHUY1 
          MOVE      SP70,DBFHUY2 
          MOVE      SP70,DBFHUC1 
          MOVE      SP70,DBFHUC2 
          MOVE      SP70,DBDBNA1 
          MOVE      ZERO,TOTALAMT
          MOVE      SP70,DOCDESC 
CFR1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Enquire by Doc Ref                 
.--------------------------------------------------------
KYR1L000
.
KYR1L110
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,*JR,*ZF,TRANREF: 
                    *PCCOL:CVERT
          MATCH     "0000000000000000000",TRANREF 
          GOTO      KYR1L900 IF EQUAL
          ENDSET    TRANREF 
          CMATCH    EXITCHAR,TRANREF 
          GOTO      KYR1L900 IF EQUAL
          RESET     TRANREF 
          MOVE      ZERO,ACCEPT
          MOVE      TRANREF,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KYR1L999
.
KYR1L900  MOVE      ONE,EXIT
KYR1L999  RETURN
.---------------------------------------------------------
. Load WP files for : Enquire by Doc Ref                 
.---------------------------------------------------------
WPR1L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Enquire by Doc Ref                 
.---------------------------------------------------------
LMR1L000
.---------------------------------------------------------
. Load for :    11 Debtor Code                        
.---------------------------------------------------------
          UNPACK    SP70,DBFHDOC,DBFHDTY,DBFHDEB
          PACK      KEY21,TRANREF,SP70
          MOVE      KEY21,DBFH3EKY
          STRIP     DBFH3SKY
          SETLPTR   DBFH3EKY,12
          MOVE      DBFH3EKY,DBFH3SKY
          CALL      RDDBFH3 
          IF        OVRCD=0
            CALL      RPDBFH3 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPR1L000
          MOVE     ZERO,DBFH3CNT
          MOVE     ZERO,DBFH3END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPR1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPR1L600
          MATCH    PRGID,SCPSPID
          GOTO     DPR1L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPR1L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPR1L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPR1L010,DPR1L010,DPR1L010,DPR1L010:
                            DPR1L010,DPR1L010,DPR1L010,DPR1L010:
                           DPR1L010,DPR1L010,DPR1L101,DPR1L102:
                            DPR1L103,DPR1L104,DPR1L105,DPR1L106:
                            DPR1L107,DPR1L108,DPR1L109,DPR1L110:
                            DPR1L111,DPR1L112,DPR1L113,DPR1L114:
                            DPR1L115,DPR1L116,DPR1L117,DPR1L118:
                            DPR1L119,DPR1L120,DPR1L121,DPR1L122:
                            DPR1L123,DPR1L010,DPR1L010,DPR1L010:
                           DPR1L010,DPR1L010,DPR1L010,DPR1L010:
                           DPR1L010,DPR1L010,DPR1L010,DPR1L010
          GOTO      DPR1L010
.
DPR1L101
          PACK      DBFH3MKY,SP70,SP70
          CALL      UPTDBFH3
          IF        DBFH3END=0
            CALL      RKDBFH3 
            IF        OVRCD=0
              PACK      DBFH3MKY,DBFHDOC,DBFHDTY,DBFHDEB                                                        
              MATCH     DBFH3EKY,DBFH3MKY
              IF        @EQUAL
                MOVE      ZERO,DBFH3END
                ADD       ONE,DBFH3CNT
                CALL      UPTDBFH3
          CALL      DOCLIN00
                MOVE      DBFHDEB,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,DBFH3END
              ENDIF
            ELSE
              MOVE      ONE,DBFH3END
            ENDIF
          ENDIF
          IF        DBFH3END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L102
          IF        DBFH3END=0
            MOVE      DBFHDTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L103
          IF        DBFH3END=0
            MOVE      DBFHDOC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L104
          IF        DBFH3END=0
            UNPACK    DBFHDDAT,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L105
          IF        DBFH3END=0
            MOVE      DBFHTER,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L106
          IF        DBFH3END=0
            MOVE      DBFHTOT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L107
          IF        DBFH3END=0
            MOVE      DBFHTAX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L108
          IF        DBFH3END=0
            UNPACK    DBFHDPRT,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L109
          IF        DBFH3END=0
            UNPACK    DBFHDSTA,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L110
          IF        DBFH3END=0
            UNPACK    DBFHCDAT,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L111
          IF        DBFH3END=0
            MOVE      DBFHCTIM,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L112
          IF        DBFH3END=0
            MOVE      DBFHCUSR,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L113
          IF        DBFH3END=0
            MOVE      DBFHUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L114
          IF        DBFH3END=0
            MOVE      DBFHUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L115
          IF        DBFH3END=0
            UNPACK    DBFHUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L116
          IF        DBFH3END=0
            UNPACK    DBFHUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L117
          IF        DBFH3END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      DBFHUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L118
          IF        DBFH3END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      DBFHUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L119
          IF        DBFH3END=0
            MOVE      DBFHUC1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L120
          IF        DBFH3END=0
            MOVE      DBFHUC2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L121
          IF        DBFH3END=0
            MOVE      DBDBNA1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L122
          IF        DBFH3END=0
            MOVE      TOTALAMT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
.
DPR1L123
          IF        DBFH3END=0
            MOVE      DOCDESC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR1L010
DPR1L600
          MATCH    "DBFH3",NAMSSFFI
          GOTO     DPR1L605 IF NOT EQUAL
          GOTO     DPR1L999
DPR1L605
DPR1L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPR1L000
.
          MATCH    "DBFH3",NAMSSFFI
          GOTO     FPR1L105 IF NOT EQUAL
          PACK     KEY21,DBFH3SKY,SP70
          CALL     RDDBFH3  * Start
          IF       OVRCD=0
            CALL     RPDBFH3  * Start
          ENDIF
          CALL     DPR1L000
          GOTO     FPR1L999
FPR1L105
FPR1L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPR1L000
.
          MATCH    "DBFH3",NAMSSFFI
          GOTO     LPR1L105 IF NOT EQUAL
          PACK     KEY21,DBFH3SKY,Z70
          CALL     RSDBFH3  * End
          IF       OVRCD=1
            CALL     RPDBFH3 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<DBFH3SNO
            CALL     RPDBFH3 
            IF       OVRCD=1
              MOVE     DBFH3SNO,SECTOR
            ENDIF
            PACK     DBFH3MKY,DBFHDOC,DBFHDTY,DBFHDEB                                                        
            MATCH    DBFH3EKY,DBFH3MKY
            IF       !@EQUAL
              MOVE     DBFH3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPR1L000
          GOTO     LPR1L999
LPR1L105
LPR1L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPR1L000
.
          MATCH    "DBFH3",NAMSSFFI
          GOTO     PPR1L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPR1L105
          CALL      RFTDBFH3
          BRANCH   OVRCD,PPR1L115
          MOVE      DBFH3MKY,KEY21 
          CALL      RSDBFH3 
PPR1L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=DBFH3SNO
            CALL     RPDBFH3 
            IF       OVRCD=1
              MOVE     DBFH3SNO,SECTOR
            ENDIF
            PACK     DBFH3MKY,DBFHDOC,DBFHDTY,DBFHDEB                                                        
            MATCH    DBFH3EKY,DBFH3MKY
            IF       !@EQUAL
              MOVE     DBFH3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPR1L000
          GOTO     PPR1L999
PPR1L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<DBFH3SNO
            CALL     RKDBFH3 
            IF       OVRCD=1
              MOVE     DBFH3SNO,SECTOR
            ENDIF
            PACK     DBFH3MKY,DBFHDOC,DBFHDTY,DBFHDEB                                                        
            MATCH    DBFH3EKY,DBFH3MKY
            IF       !@EQUAL
              MOVE     DBFH3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPR1L999
PPR1L120
PPR1L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPR1L000
          MATCH    "DBFH3",NAMSSFFI
          GOTO     NPR1L115 IF NOT EQUAL
NPR1L105
          CALL     RKDBFH3 
          BRANCH   OVRCD,NPR1L110
          PACK     DBFH3MKY,DBFHDOC,DBFHDTY,DBFHDEB                                                        
          MATCH    DBFH3EKY,DBFH3MKY
          GOTO     NPR1L110 IF NOT EQUAL
          CALL     RPDBFH3 
          CALL     DPR1L000
          GOTO     NPR1L999
NPR1L110
          CALL     RPDBFH3 
          BEEP
          GOTO     NPR1L999
NPR1L115
NPR1L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTR1L000
CTR1L105
CTR1L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Enquire by Doc Ref                 
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    11 Debtor Code                        
.---------------------------------------------------------
UPTDBFH3
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      DBFH3FL1,KEY5;ANS
          IF        @OVER
            WRITE     DBFH3FL1,KEY5;SCPSROW,SCPSCOL,DBFH3MKY
          ELSE
            UPDATE    DBFH3FL1;SCPSROW,SCPSCOL,DBFH3MKY
          ENDIF
          RETURN
RDTDBFH3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      DBFH3FL1,KEY5;SCPSROW,SCPSCOL,DBFH3MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTDBFH3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      DBFH3FL1,KEY5;;
          READKS    DBFH3FL1;SCPSROW,SCPSCOL,DBFH3MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,DBFH3MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Enquire by Doc Ref                 
.---------------------------------------------------------
DFR1L000
          BRANCH   ACCEPT,DFR1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFR1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFR1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFR1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFR1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFR1L010 IF NOT EQUAL
.
          CALL     PSR1L000 * Display Field
          GOTO     DFR1L010
DFR1L900
          MOVE      "DBFH3",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      FPR1L000
DFR1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Enquire by Doc Ref                 
.---------------------------------------------------------
PSR1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSR1L999,PSR1L999,PSR1L999,PSR1L999:
                            PSR1L999,PSR1L999,PSR1L999,PSR1L999:
                           PSR1L999,PSR1L999,PSR1L999,PSR1L999:
                            PSR1L999,PSR1L999,PSR1L999,PSR1L999:
                            PSR1L999,PSR1L999,PSR1L999,PSR1L999:
                            PSR1L999,PSR1L999,PSR1L999,PSR1L999:
                            PSR1L999,PSR1L999,PSR1L999,PSR1L999:
                            PSR1L999,PSR1L999,PSR1L999,PSR1L999:
                            PSR1L999,PSR1L999,PSR1L999,PSR1L999:
                           PSR1L999,PSR1L999,PSR1L999,PSR1L999:
                           PSR1L999,PSR1L999,PSR1L999,PSR1L999
          GOTO     PSR1L999
PSR1L999
          RETURN
.---------------------------------------------------------
. Selections for : Enquire by Doc Ref                 
.---------------------------------------------------------
SFR1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFR1L001  BRANCH   ACCEPT,SFR1L020
.
SFR1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFR1L006,SFR1L101,SFR1L006,SFR1L102:
                            SFR1L006,SFR1L006,SFR1L006,SFR1L006:
                           SFR1L006,SFR1L006,SFR1L103,SFR1L006:
                            SFR1L006,SFR1L006,SFR1L006,SFR1L006:
                            SFR1L006,SFR1L006,SFR1L006,SFR1L006:
                            SFR1L006,SFR1L006,SFR1L006,SFR1L006:
                            SFR1L006,SFR1L006,SFR1L006,SFR1L006:
                            SFR1L006,SFR1L006,SFR1L006,SFR1L006:
                            SFR1L006,SFR1L006,SFR1L006,SFR1L006:
                           SFR1L006,SFR1L006,SFR1L006,SFR1L006:
                           SFR1L104,SFR1L105,SFR1L106,SFR1L107
SFR1L006  BEEP
          GOTO     SFR1L005
SFR1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFR1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFR1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFR1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFR1L020,SFR1L020,SFR1L020,SFR1L020:
                            SFR1L020,SFR1L020,SFR1L020,SFR1L020:
                           SFR1L020,SFR1L020,SFR1L103,SFR1L020:
                            SFR1L020,SFR1L020,SFR1L020,SFR1L020:
                            SFR1L020,SFR1L020,SFR1L020,SFR1L020:
                            SFR1L020,SFR1L020,SFR1L020,SFR1L020:
                            SFR1L020,SFR1L020,SFR1L020,SFR1L020:
                            SFR1L020,SFR1L020,SFR1L020,SFR1L020:
                            SFR1L020,SFR1L020,SFR1L020,SFR1L020:
                           SFR1L020,SFR1L020,SFR1L020,SFR1L020:
                           SFR1L020,SFR1L020,SFR1L020,SFR1L020
          GOTO     SFR1L020
SFR1L090  MOVE     ZERO,ACCEPT
          MOVE      "DBFH3",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      FPR1L000
          GOTO     SFR1L001
.
SFR1L101
          MOVE      ZERO,EXIT
          GOTO      SFR1L999
.
SFR1L102
          MOVE      ONE,EXIT
          GOTO      SFR1L999
.
SFR1L103
          CALL      SELECTED
          BRANCH    EXIT,SFR1L001
          COMPARE   ONE,ACCEPT
          GOTO      SFR1L001 IF EQUAL
          CALL      RDTDBFH3
          IF        OVRCD=1
            BEEP
            GOTO      SFR1L001
          ENDIF
          MATCH     SP70,DBFH3MKY
          IF        @EQUAL
            BEEP
            GOTO      SFR1L001
          ENDIF
          MOVE      DBFH3MKY,KEY21 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SDOCH000
          MOVE      "R1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTDBFH3
          IF        OVRCD=1
            CALL      FPR1L000
          ELSE
            MOVE      DBFH3MKY,KEY21 
            CALL      RSDBFH3 
            CALL      RPDBFH3 
            CALL      DPR1L000
          ENDIF
          GOTO     SFR1L001
.
SFR1L104
          MOVE      "DBFH3",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      NPR1L000
          GOTO     SFR1L001
.
SFR1L105
          MOVE      "DBFH3",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      PPR1L000
          GOTO     SFR1L001
.
SFR1L106
          MOVE      "DBFH3",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      FPR1L000
          GOTO     SFR1L001
.
SFR1L107
          MOVE      "DBFH3",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      LPR1L000
          GOTO     SFR1L001
SFR1L990  MOVE      ONE,EXIT * Exit Char Restart
SFR1L999  RETURN
.--------------------------------
. Screen - Document Reference Enquiry         
.--------------------------------
SCR2L000
SCR2L100
          MOVE      "R2",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 3",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCR2L200
          CALL      CFR2L000 * Clear Fields
SCR2L300
          CALL      KYR2L000 * Enter Key Fields
          BRANCH    EXIT,SCR2L999,SCR2L999
SCR2L400
          CALL      WPR2L000 * Load any WP Details
SCR2L500
          CALL      LMR2L000 * Load any Batch Details
SCR2L600
          CALL      DFR2L000 * Display Fields
SCR2L700
          CALL      SFR2L000 * Select Fields
          BRANCH    EXIT,SCR2L100,SCR2L100,SCR2L200
SCR2L800
SCR2L900
SCR2L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Document Reference Enquiry         
.-------------------------------------------------------
CFR2L000
CFR2L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Document Reference Enquiry         
.--------------------------------------------------------
KYR2L000
          MOVE      ZERO,EXIT
          GOTO      KYR2L999
.
KYR2L900  MOVE      ONE,EXIT
KYR2L999  RETURN
.---------------------------------------------------------
. Load WP files for : Document Reference Enquiry         
.---------------------------------------------------------
WPR2L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Document Reference Enquiry         
.---------------------------------------------------------
LMR2L000
.---------------------------------------------------------
. Load for :    61 Document Line Number               
.---------------------------------------------------------
          UNPACK    SP70,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN
          PACK      KEY24,DBFHDEB,DBFHDTY,DBFHDOC,SP70
          MOVE      KEY24,DBFD1EKY
          STRIP     DBFD1SKY
          SETLPTR   DBFD1EKY,21
          MOVE      DBFD1EKY,DBFD1SKY
          CALL      RDDBFD1 
          IF        OVRCD=0
            CALL      RPDBFD1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPR2L000
          MOVE     ZERO,DBFD1CNT
          MOVE     ZERO,DBFD1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPR2L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPR2L600
          MATCH    PRGID,SCPSPID
          GOTO     DPR2L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPR2L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPR2L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPR2L010,DPR2L010,DPR2L010,DPR2L010:
                            DPR2L010,DPR2L010,DPR2L010,DPR2L010:
                            DPR2L010,DPR2L010,DPR2L010,DPR2L010:
                            DPR2L010,DPR2L010,DPR2L010,DPR2L010:
                            DPR2L010,DPR2L010,DPR2L010,DPR2L010:
                            DPR2L010,DPR2L010,DPR2L010,DPR2L010:
                            DPR2L010,DPR2L010,DPR2L010,DPR2L010:
                            DPR2L010,DPR2L010,DPR2L010,DPR2L010:
                            DPR2L010,DPR2L010,DPR2L010,DPR2L010:
                            DPR2L010,DPR2L010,DPR2L010,DPR2L010:
                            DPR2L010,DPR2L010,DPR2L010,DPR2L010:
                            DPR2L010,DPR2L010,DPR2L010,DPR2L010:
                            DPR2L010,DPR2L010,DPR2L010,DPR2L010:
                            DPR2L010,DPR2L010,DPR2L010,DPR2L010:
                            DPR2L010,DPR2L010,DPR2L010,DPR2L010:
                            DPR2L101,DPR2L102,DPR2L103,DPR2L104:
                            DPR2L105,DPR2L106,DPR2L107,DPR2L108:
                            DPR2L109,DPR2L110,DPR2L111,DPR2L112:
                            DPR2L113,DPR2L114,DPR2L010,DPR2L010:
                           DPR2L010,DPR2L010,DPR2L010,DPR2L010:
                           DPR2L010,DPR2L010,DPR2L010,DPR2L010
          GOTO      DPR2L010
.
DPR2L101
          PACK      DBFD1MKY,SP70,SP70
          CALL      UPTDBFD1
          IF        DBFD1END=0
            CALL      RKDBFD1 
            IF        OVRCD=0
              PACK      DBFD1MKY,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN                                                
              MATCH     DBFD1EKY,DBFD1MKY
              IF        @EQUAL
                MOVE      ZERO,DBFD1END
                ADD       ONE,DBFD1CNT
                CALL      UPTDBFD1
          CALL      REDDET00
                MOVE      DBFDDLN,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,DBFD1END
              ENDIF
            ELSE
              MOVE      ONE,DBFD1END
            ENDIF
          ENDIF
          IF        DBFD1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR2L010
.
DPR2L102
          IF        DBFD1END=0
            MOVE      DBFDINV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR2L010
.
DPR2L103
          IF        DBFD1END=0
            UNPACK    DBFDPDAT,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR2L010
.
DPR2L104
          IF        DBFD1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      DBFDGLS,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR2L010
.
DPR2L105
          IF        DBFD1END=0
            MOVE      DBFDITM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR2L010
.
DPR2L106
          IF        DBFD1END=0
            UNPACK    DBFDSDAT,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR2L010
.
DPR2L107
          IF        DBFD1END=0
            MOVE      DBFDDREF,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR2L010
.
DPR2L108
          IF        DBFD1END=0
            MOVE      DBFDOREF,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR2L010
.
DPR2L109
          IF        DBFD1END=0
            MOVE      DBFDQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR2L010
.
DPR2L110
          IF        DBFD1END=0
            MOVE      DBFDPRI,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR2L010
.
DPR2L111
          IF        DBFD1END=0
            MOVE      DBFDTOT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR2L010
.
DPR2L112
          IF        DBFD1END=0
            MOVE      DBFDTAX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR2L010
.
DPR2L113
          IF        DBFD1END=0
            MOVE      TOTALAMT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR2L010
.
DPR2L114
          IF        DBFD1END=0
            MOVE      DBITDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPR2L010
DPR2L600
          MATCH    "DBFD1",NAMSSFFI
          GOTO     DPR2L605 IF NOT EQUAL
          GOTO     DPR2L999
DPR2L605
DPR2L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPR2L000
.
          MATCH    "DBFD1",NAMSSFFI
          GOTO     FPR2L105 IF NOT EQUAL
          PACK     KEY24,DBFD1SKY,SP70
          CALL     RDDBFD1  * Start
          IF       OVRCD=0
            CALL     RPDBFD1  * Start
          ENDIF
          CALL     DPR2L000
          GOTO     FPR2L999
FPR2L105
FPR2L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPR2L000
.
          MATCH    "DBFD1",NAMSSFFI
          GOTO     LPR2L105 IF NOT EQUAL
          PACK     KEY24,DBFD1SKY,Z70
          CALL     RSDBFD1  * End
          IF       OVRCD=1
            CALL     RPDBFD1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<DBFD1SNO
            CALL     RPDBFD1 
            IF       OVRCD=1
              MOVE     DBFD1SNO,SECTOR
            ENDIF
            PACK     DBFD1MKY,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN                                                
            MATCH    DBFD1EKY,DBFD1MKY
            IF       !@EQUAL
              MOVE     DBFD1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPR2L000
          GOTO     LPR2L999
LPR2L105
LPR2L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPR2L000
.
          MATCH    "DBFD1",NAMSSFFI
          GOTO     PPR2L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPR2L105
          CALL      RFTDBFD1
          BRANCH   OVRCD,PPR2L115
          MOVE      DBFD1MKY,KEY24 
          CALL      RSDBFD1 
PPR2L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=DBFD1SNO
            CALL     RPDBFD1 
            IF       OVRCD=1
              MOVE     DBFD1SNO,SECTOR
            ENDIF
            PACK     DBFD1MKY,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN                                                
            MATCH    DBFD1EKY,DBFD1MKY
            IF       !@EQUAL
              MOVE     DBFD1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPR2L000
          GOTO     PPR2L999
PPR2L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<DBFD1SNO
            CALL     RKDBFD1 
            IF       OVRCD=1
              MOVE     DBFD1SNO,SECTOR
            ENDIF
            PACK     DBFD1MKY,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN                                                
            MATCH    DBFD1EKY,DBFD1MKY
            IF       !@EQUAL
              MOVE     DBFD1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPR2L999
PPR2L120
PPR2L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPR2L000
          MATCH    "DBFD1",NAMSSFFI
          GOTO     NPR2L115 IF NOT EQUAL
NPR2L105
          CALL     RKDBFD1 
          BRANCH   OVRCD,NPR2L110
          PACK     DBFD1MKY,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN                                                
          MATCH    DBFD1EKY,DBFD1MKY
          GOTO     NPR2L110 IF NOT EQUAL
          CALL     RPDBFD1 
          CALL     DPR2L000
          GOTO     NPR2L999
NPR2L110
          CALL     RPDBFD1 
          BEEP
          GOTO     NPR2L999
NPR2L115
NPR2L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTR2L000
CTR2L105
CTR2L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Document Reference Enquiry         
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    61 Document Line Number               
.---------------------------------------------------------
UPTDBFD1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      DBFD1FL1,KEY5;ANS
          IF        @OVER
            WRITE     DBFD1FL1,KEY5;SCPSROW,SCPSCOL,DBFD1MKY
          ELSE
            UPDATE    DBFD1FL1;SCPSROW,SCPSCOL,DBFD1MKY
          ENDIF
          RETURN
RDTDBFD1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      DBFD1FL1,KEY5;SCPSROW,SCPSCOL,DBFD1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTDBFD1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      DBFD1FL1,KEY5;;
          READKS    DBFD1FL1;SCPSROW,SCPSCOL,DBFD1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,DBFD1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Document Reference Enquiry         
.---------------------------------------------------------
DFR2L000
          BRANCH   ACCEPT,DFR2L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFR2L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFR2L900
          MATCH    PRGID,SCPSPID
          GOTO     DFR2L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFR2L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFR2L010 IF NOT EQUAL
.
          CALL     PSR2L000 * Display Field
          GOTO     DFR2L010
DFR2L900
          MOVE      "DBFD1",NAMSSFFI
          MOVE      "   61",ITMSSFFI
          CALL      FPR2L000
DFR2L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Document Reference Enquiry         
.---------------------------------------------------------
PSR2L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSR2L999,PSR2L999,PSR2L999,PSR2L101:
                            PSR2L102,PSR2L103,PSR2L104,PSR2L105:
                            PSR2L106,PSR2L107,PSR2L108,PSR2L109:
                            PSR2L110,PSR2L111,PSR2L112,PSR2L113:
                            PSR2L114,PSR2L115,PSR2L116,PSR2L117:
                            PSR2L118,PSR2L119,PSR2L120,PSR2L121:
                            PSR2L122,PSR2L123,PSR2L124,PSR2L125:
                            PSR2L126,PSR2L127,PSR2L128,PSR2L129:
                            PSR2L130,PSR2L131,PSR2L132,PSR2L133:
                            PSR2L134,PSR2L135,PSR2L136,PSR2L137:
                            PSR2L138,PSR2L139,PSR2L140,PSR2L141:
                            PSR2L142,PSR2L143,PSR2L144,PSR2L145:
                            PSR2L146,PSR2L147,PSR2L148,PSR2L149:
                            PSR2L150,PSR2L151,PSR2L152,PSR2L153:
                            PSR2L154,PSR2L155,PSR2L156,PSR2L157:
                            PSR2L999,PSR2L999,PSR2L999,PSR2L999:
                            PSR2L999,PSR2L999,PSR2L999,PSR2L999:
                            PSR2L999,PSR2L999,PSR2L999,PSR2L999:
                            PSR2L999,PSR2L999,PSR2L158,PSR2L999:
                           PSR2L999,PSR2L999,PSR2L999,PSR2L999:
                           PSR2L999,PSR2L999,PSR2L999,PSR2L999
          GOTO     PSR2L999
.
PSR2L101
          MOVE      DBDBDEB,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L102
          MOVE      DBDBNA1,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L103
          MOVE      DBDBNA2,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L104
          MOVE      DBDBAD1,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L105
          MOVE      DBDBAD2,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L106
          MOVE      DBDBAD3,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L107
          MOVE      DBDBAD4,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L108
          MOVE      DBDBPC,VAR       
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L109
          MOVE      DBDBPH1,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L110
          MOVE      DBDBPH2,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L111
          MOVE      DBDBPH3,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L112
          MOVE      DBDBCON,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L113
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBDBACT,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBDBSTA,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBDBTEX,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L116
          MOVE      DBDBTER,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L117
          MOVE      DBDBWRN,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L118
          MOVE      DBDBLIN,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L119
          MOVE      DBDBPUR,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L120
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBDBBAD,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L121
          MOVE      DBDBSORT,VAR     
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L122
          MOVE      DBDBUR2,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L123
          UNPACK    DBDBUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L124
          UNPACK    DBDBUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L125
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBDBUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L126
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBDBUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L127
          MOVE      DBDBUC1,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L128
          MOVE      DBDBUC2,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L129
          MOVE      DBDBUC3,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L130
          MOVE      DBDBUC4,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L131
          MOVE      DBDBUC1D,VAR     
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L132
          MOVE      DBDBUC2D,VAR     
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L133
          MOVE      DBDBUC3D,VAR     
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L134
          MOVE      DBDBUC4D,VAR     
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L135
          MOVE      DBDBWRND,VAR     
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L136
          MOVE      DBTEDES,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L137
          MOVE      DBLNNA1,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L138
          MOVE      DBFHDOC,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L139
          MOVE      DBFHDTY,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L140
          UNPACK    DBFHDDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L141
          MOVE      DBFHTER,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L142
          MOVE      DBFHTOT,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L143
          MOVE      DBFHTAX,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L144
          UNPACK    DBFHDPRT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L145
          UNPACK    DBFHDSTA,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L146
          UNPACK    DBFHCDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L147
          MOVE      DBFHCTIM,VAR     
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L148
          MOVE      DBFHCUSR,VAR     
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L149
          MOVE      DBFHUR1,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L150
          MOVE      DBFHUR2,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L151
          UNPACK    DBFHUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L152
          UNPACK    DBFHUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L153
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBFHUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L154
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBFHUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L155
          MOVE      DBFHUC1,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L156
          MOVE      DBFHUC2,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L157
          MOVE      DBFHDTOT,VAR     
          CALL      DISPITEM
          GOTO     PSR2L999
.
PSR2L158
          MOVE      HEADTOT,VAR      
          CALL      DISPITEM
          GOTO     PSR2L999
PSR2L999
          RETURN
.---------------------------------------------------------
. Selections for : Document Reference Enquiry         
.---------------------------------------------------------
SFR2L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFR2L001  BRANCH   ACCEPT,SFR2L020
.
SFR2L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFR2L006,SFR2L101,SFR2L006,SFR2L006:
                            SFR2L006,SFR2L006,SFR2L006,SFR2L006:
                            SFR2L006,SFR2L006,SFR2L006,SFR2L006:
                            SFR2L006,SFR2L006,SFR2L006,SFR2L006:
                            SFR2L006,SFR2L006,SFR2L006,SFR2L006:
                            SFR2L006,SFR2L006,SFR2L006,SFR2L006:
                            SFR2L006,SFR2L006,SFR2L006,SFR2L006:
                            SFR2L006,SFR2L006,SFR2L006,SFR2L006:
                            SFR2L006,SFR2L006,SFR2L006,SFR2L006:
                            SFR2L006,SFR2L006,SFR2L006,SFR2L006:
                            SFR2L006,SFR2L006,SFR2L006,SFR2L006:
                            SFR2L006,SFR2L006,SFR2L006,SFR2L006:
                            SFR2L006,SFR2L006,SFR2L006,SFR2L006:
                            SFR2L006,SFR2L006,SFR2L006,SFR2L006:
                            SFR2L006,SFR2L006,SFR2L006,SFR2L006:
                            SFR2L102,SFR2L006,SFR2L006,SFR2L006:
                            SFR2L006,SFR2L006,SFR2L006,SFR2L006:
                            SFR2L006,SFR2L006,SFR2L006,SFR2L006:
                            SFR2L006,SFR2L006,SFR2L006,SFR2L006:
                           SFR2L006,SFR2L006,SFR2L006,SFR2L006:
                           SFR2L103,SFR2L104,SFR2L105,SFR2L106
SFR2L006  BEEP
          GOTO     SFR2L005
SFR2L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFR2L090
          MATCH    PRGID,SCSLPID
          GOTO     SFR2L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFR2L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFR2L020,SFR2L020,SFR2L020,SFR2L020:
                            SFR2L020,SFR2L020,SFR2L020,SFR2L020:
                            SFR2L020,SFR2L020,SFR2L020,SFR2L020:
                            SFR2L020,SFR2L020,SFR2L020,SFR2L020:
                            SFR2L020,SFR2L020,SFR2L020,SFR2L020:
                            SFR2L020,SFR2L020,SFR2L020,SFR2L020:
                            SFR2L020,SFR2L020,SFR2L020,SFR2L020:
                            SFR2L020,SFR2L020,SFR2L020,SFR2L020:
                            SFR2L020,SFR2L020,SFR2L020,SFR2L020:
                            SFR2L020,SFR2L020,SFR2L020,SFR2L020:
                            SFR2L020,SFR2L020,SFR2L020,SFR2L020:
                            SFR2L020,SFR2L020,SFR2L020,SFR2L020:
                            SFR2L020,SFR2L020,SFR2L020,SFR2L020:
                            SFR2L020,SFR2L020,SFR2L020,SFR2L020:
                            SFR2L020,SFR2L020,SFR2L020,SFR2L020:
                            SFR2L102,SFR2L020,SFR2L020,SFR2L020:
                            SFR2L020,SFR2L020,SFR2L020,SFR2L020:
                            SFR2L020,SFR2L020,SFR2L020,SFR2L020:
                            SFR2L020,SFR2L020,SFR2L020,SFR2L020:
                           SFR2L020,SFR2L020,SFR2L020,SFR2L020:
                           SFR2L020,SFR2L020,SFR2L020,SFR2L020
          GOTO     SFR2L020
SFR2L090  MOVE     ZERO,ACCEPT
          MOVE      "DBFD1",NAMSSFFI
          MOVE      "   61",ITMSSFFI
          CALL      FPR2L000
          GOTO     SFR2L001
.
SFR2L101
          MOVE      ZERO,EXIT
          GOTO      SFR2L999
.
SFR2L102
          CALL      SELECTED
          BRANCH    EXIT,SFR2L001
          COMPARE   ONE,ACCEPT
          GOTO      SFR2L001 IF EQUAL
          CALL      RDTDBFD1
          IF        OVRCD=1
            BEEP
            GOTO      SFR2L001
          ENDIF
          MATCH     SP70,DBFD1MKY
          IF        @EQUAL
            BEEP
            GOTO      SFR2L001
          ENDIF
          MOVE      DBFD1MKY,KEY24 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SDOCL000
          MOVE      "R2",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTDBFD1
          IF        OVRCD=1
            CALL      FPR2L000
          ELSE
            MOVE      DBFD1MKY,KEY24 
            CALL      RSDBFD1 
            CALL      RPDBFD1 
            CALL      DPR2L000
          ENDIF
          GOTO     SFR2L001
.
SFR2L103
          MOVE      "DBFD1",NAMSSFFI
          MOVE      "   61",ITMSSFFI
          CALL      NPR2L000
          GOTO     SFR2L001
.
SFR2L104
          MOVE      "DBFD1",NAMSSFFI
          MOVE      "   61",ITMSSFFI
          CALL      PPR2L000
          GOTO     SFR2L001
.
SFR2L105
          MOVE      "DBFD1",NAMSSFFI
          MOVE      "   61",ITMSSFFI
          CALL      FPR2L000
          GOTO     SFR2L001
.
SFR2L106
          MOVE      "DBFD1",NAMSSFFI
          MOVE      "   61",ITMSSFFI
          CALL      LPR2L000
          GOTO     SFR2L001
SFR2L990  MOVE      ONE,EXIT * Exit Char Restart
SFR2L999  RETURN
.--------------------------------
. Screen - Transaction Details Screen         
.--------------------------------
SCTDL000
SCTDL100
          MOVE      "TD",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 8",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCTDL200
          CALL      CFTDL000 * Clear Fields
SCTDL300
          CALL      KYTDL000 * Enter Key Fields
          BRANCH    EXIT,SCTDL999,SCTDL999
SCTDL400
          CALL      WPTDL000 * Load any WP Details
SCTDL500
          CALL      LMTDL000 * Load any Batch Details
SCTDL600
          CALL      DFTDL000 * Display Fields
SCTDL700
          CALL      SFTDL000 * Select Fields
          BRANCH    EXIT,SCTDL100,SCTDL100,SCTDL200
SCTDL800
SCTDL900
SCTDL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Transaction Details Screen         
.-------------------------------------------------------
CFTDL000
CFTDL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Transaction Details Screen         
.--------------------------------------------------------
KYTDL000
          MOVE      ZERO,EXIT
          GOTO      KYTDL999
.
KYTDL900  MOVE      ONE,EXIT
KYTDL999  RETURN
.---------------------------------------------------------
. Load WP files for : Transaction Details Screen         
.---------------------------------------------------------
WPTDL000
          PREP     TEMPWORD,FILDBFN1
          PACK     KEY27,DBFDDEB,DBFDDTY,DBFDDOC,DBFDDLN,SP70
          MOVE     KEY27,SAVKEY80
          SETLPTR  SAVKEY80,22
          CALL      RDDBFN1 
          IF        OVRCD=0
            CALL      RPDBFN1 
          ENDIF
WPTDL100
          CALL     RKDBFN1 
          BRANCH   OVRCD,WPTDL105
          PACK     KEY27,DBFNDEB,DBFNDTY,DBFNDOC,DBFNDLN,DBFNLIN
          MATCH    SAVKEY80,KEY27   
          GOTO     WPTDL105 IF NOT EQUAL
          PACK     VAR,DBFNCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     DBFNCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WPTDL100
WPTDL105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Transaction Details Screen         
.---------------------------------------------------------
LMTDL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Transaction Details Screen         
.---------------------------------------------------------
DFTDL000
          BRANCH   ACCEPT,DFTDL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFTDL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFTDL900
          MATCH    PRGID,SCPSPID
          GOTO     DFTDL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFTDL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFTDL010 IF NOT EQUAL
.
          CALL     PSTDL000 * Display Field
          GOTO     DFTDL010
DFTDL900
DFTDL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Transaction Details Screen         
.---------------------------------------------------------
PSTDL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSTDL999,PSTDL999,PSTDL999,PSTDL999:
                           PSTDL101,PSTDL102,PSTDL103,PSTDL104:
                            PSTDL105,PSTDL106,PSTDL107,PSTDL108:
                            PSTDL109,PSTDL110,PSTDL111,PSTDL112:
                            PSTDL113,PSTDL114,PSTDL115,PSTDL116:
                            PSTDL117,PSTDL118,PSTDL119,PSTDL120:
                            PSTDL121,PSTDL122,PSTDL123,PSTDL124:
                            PSTDL125,PSTDL126,PSTDL127,PSTDL128:
                            PSTDL129,PSTDL130,PSTDL131,PSTDL132:
                            PSTDL133,PSTDL134,PSTDL135,PSTDL136:
                            PSTDL137,PSTDL138,PSTDL139,PSTDL140:
                            PSTDL141,PSTDL142,PSTDL143,PSTDL144:
                            PSTDL145,PSTDL146,PSTDL147,PSTDL148:
                            PSTDL149,PSTDL150,PSTDL151,PSTDL152:
                            PSTDL153,PSTDL154,PSTDL155,PSTDL156:
                            PSTDL157,PSTDL158,PSTDL159,PSTDL160:
                            PSTDL161,PSTDL162,PSTDL163,PSTDL164:
                            PSTDL165,PSTDL166,PSTDL167,PSTDL168:
                            PSTDL169,PSTDL170,PSTDL171,PSTDL172:
                            PSTDL173,PSTDL174,PSTDL175,PSTDL176
          GOTO     PSTDL999
.
PSTDL101
          MOVE      DOCDESC,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL102
          MOVE      DBFDDEB,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL103
          MOVE      DBFDDTY,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL104
          MOVE      DBFDDOC,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL105
          MOVE      DBFDDLN,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL106
          MOVE      DBFDINV,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL107
          UNPACK    DBFDIDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL108
          UNPACK    DBFDPDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBFDGLS,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL110
          MOVE      DBFDBCHG,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL111
          UNPACK    DBFDBDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL112
          MOVE      DBFDBTIM,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL113
          MOVE      DBFDBUSR,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL114
          MOVE      DBFDITM,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL115
          UNPACK    DBFDSDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL116
          MOVE      DBFDDREF,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL117
          MOVE      DBFDOREF,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL118
          MOVE      DBFDQTY,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL119
          MOVE      DBFDPRI,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL120
          MOVE      DBFDTOT,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL121
          MOVE      DBFDTRT,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL122
          MOVE      DBFDTAX,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL123
          MOVE      DBFDPAID,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL124
          MOVE      DBFDUR1,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL125
          MOVE      DBFDUR2,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL126
          UNPACK    DBFDUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL127
          UNPACK    DBFDUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL128
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBFDUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL129
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBFDUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL130
          MOVE      DBFDUC1,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL131
          MOVE      DBFDUC2,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL132
          MOVE      DBFDUC3,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL133
          MOVE      DBFDUC4,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL134
          MOVE      DBITDES,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL135
          MOVE      DBITIDE,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL136
          MOVE      DBITPRI,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL137
          MOVE      DBBIUC1D,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL138
          MOVE      DBBIUC2D,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL139
          MOVE      DBBIUC3D,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL140
          MOVE      DBBIUC4D,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL141
          MOVE      TOTALAMT,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL142
          MOVE      SECUSER,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL143
          MOVE      DBITPTY,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL144
          MOVE      DBPTDES,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL145
          MOVE      DBPTDEP,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL146
          MOVE      DBDEDES,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL147
          UNPACK    DBFHDDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL148
          MOVE      DBFHTER,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL149
          MOVE      DBFHTOT,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL150
          MOVE      DBFHTAX,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL151
          UNPACK    DBFHDPRT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL152
          UNPACK    DBFHDSTA,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL153
          UNPACK    DBFHCDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL154
          MOVE      DBFHCTIM,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL155
          MOVE      DBFHCUSR,VAR     
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL156
          MOVE     FILDBFN1,WORDNAME
          CALL     DISPWORD
          GOTO     PSTDL999
.
PSTDL157
          MOVE      DBITUNT,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL158
          MOVE      DBCRREC,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL159
          MOVE      DBCRTYP,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL160
          MOVE      DBCRDRW,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL161
          MOVE      DBCRCHQ,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL162
          MOVE      DBCRBNK,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL163
          MOVE      DBCRBRA,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL164
          MOVE      DBCRAMT,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL165
          MOVE      DBCRDAT,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL166
          MOVE      DBCRUSR,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL167
          UNPACK    DBCRIDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL168
          MOVE      DBCRITM,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL169
          MOVE      DBCRUR1,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL170
          MOVE      DBCRUR2,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL171
          UNPACK    DBCRUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL172
          UNPACK    DBCRUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL173
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBCRUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL174
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      DBCRUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL175
          MOVE      PAYDESC,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
.
PSTDL176
          MOVE      DBFHUC2,VAR      
          CALL      DISPITEM
          GOTO     PSTDL999
PSTDL999
          RETURN
.---------------------------------------------------------
. Selections for : Transaction Details Screen         
.---------------------------------------------------------
SFTDL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFTDL001  BRANCH   ACCEPT,SFTDL020
.
SFTDL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFTDL006,SFTDL101,SFTDL006,SFTDL006:
                           SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL102:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006:
                            SFTDL006,SFTDL006,SFTDL006,SFTDL006
SFTDL006  BEEP
          GOTO     SFTDL005
SFTDL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFTDL090
          MATCH    PRGID,SCSLPID
          GOTO     SFTDL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFTDL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                           SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL102:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020:
                            SFTDL020,SFTDL020,SFTDL020,SFTDL020
          GOTO     SFTDL020
SFTDL090  MOVE     ZERO,ACCEPT
          GOTO     SFTDL001
.
SFTDL101
          MOVE      ZERO,EXIT
          GOTO      SFTDL999
.
SFTDL102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "10",SCPSROW
              MOVE     " 15",SCPSCOL
              MOVE     " 50",SCPSLEN
              MOVE     "10",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILDBFN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILDBFN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SFTDL001
SFTDL990  MOVE      ONE,EXIT * Exit Char Restart
SFTDL999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------
. Execute SQL Enquiry Form from Debtors Enquiries
.------------------------------------------------------------
SQLA0000  READ      CONTROLF,EIGHTY1;*77,CFDBSQLA,CFDBSQLB
          STRIP     CFDBSQLA
          STRIP     CFDBSQLB
          MOVE      SP70,TASKID
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          EXECUTE   CFDBSQLA,TASKID
          CALL      PUTSCR00
SQLA9999  RETURN
.------------------------------------------------------------
. Execute SQL Enquiry Form from Debtors Enquiries
.------------------------------------------------------------
SQLB0000  READ      CONTROLF,EIGHTY1;*77,CFDBSQLA,CFDBSQLB
          STRIP     CFDBSQLA
          STRIP     CFDBSQLB
          MOVE      SP70,TASKID
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          EXECUTE   CFDBSQLB,TASKID
          CALL      PUTSCR00
SQLB9999  RETURN
.--------------------------------------------------
. Calculate Total To Be Invoiced
.--------------------------------------------------
BILTOT00  MOVE      ZERO,TOBEINV
          PACK      KEY14,DBDBDEB,SP70
          CALL      RSDBBI1
BILTOT10  CALL      RKDBBI1
          BRANCH    OVRCD,BILTOT99
          MATCH     DBBIDEB,DBDBDEB
          GOTO      BILTOT99 IF NOT EQUAL
          ASSIGN    TOBEINV+DBBITOT+DBBITAX,TOBEINV
          GOTO      BILTOT10
BILTOT99  RETURN

.---------------------
. Read Item
.---------------------
REDITM00  MOVE     DBBIITM,KEY8
          CALL     RDDBIT1
          IF       OVRCD=1
            MOVE     "***** ITEM RECORD MISSING *****",DBITDES
          ENDIF
          ASSIGN   DBBITOT+DBBITAX,TOTALCHG
.
REDITM99  RETURN
.
.-------------------------------------------------------------
. Item Selected
.-------------------------------------------------------------
SELT0000  CALL     RDDBBI2
          IF       OVRCD=1
            BEEP
            MOVE     "Can't Read Billing Details - ",DISPMSG
            CALL     MESSAGE1
            GOTO     SELT9999
          ENDIF
.
          MOVE      DBBIITM,KEY8
          CALL      RDDBIT1
          BRANCH    OVRCD,SELT9100
.
          MOVE      DBITPTY,KEY8
          CALL      RDDBPT1
          BRANCH    OVRCD,SELT9200
.
.          PACK      KEY12,PASSCODE,DBPTDEP
.          CALL      RDDBSE1
.          BRANCH    OVRCD,SELT9300
.
          MOVE      DBPTDEP,KEY8
          CALL      RDDBDE1
          IF        OVRCD=1
            MOVE      "Invalid Department on Sales Item - ",DISPMSG
            CALL      MESSAGE1
          ENDIF
.
          ASSIGN   DBBITOT+DBBITAX,TOTALCHG
          CALL     GETDES00
.
          CALL     SCB2L000
          GOTO     SELT9999
.
SELT9100  BEEP
          MOVE     "Invalid Sales Item - ",DISPMSG
          CALL     MESSAGE1
          GOTO     SELT9999
.
SELT9200  BEEP
          MOVE     "Invalid Product Type on Sales Item - ",DISPMSG
          CALL     MESSAGE1
          GOTO     SELT9999
.
.SELT9300  BEEP
.          MOVE     "Inadequate Security for Sales Item - ",DISPMSG
.          CALL     MESSAGE1
.          GOTO     SELT9999
.
SELT9999  RETURN
.---------------------------------------------------
. Get User Def Code Descriptions
.---------------------------------------------------
GETDES00   MOVE     SP70,DBBIUC1D
           MOVE     SP70,DBBIUC2D
           MOVE     SP70,DBBIUC3D
           MOVE     SP70,DBBIUC4D
           MOVE     DBBIUID,KEY4
           CALL     RDPASS1
.
           MATCH    SP70,DBBIUC1
           IF       !@EQUAL
             MOVE     "FD01",DBCDCAT
             PACK     KEY7,DBCDCAT,DBBIUC1
             CALL     RDDBCD1
             IF       OVRCD=0
               MOVE     DBCDDES,DBBIUC1D
             ENDIF
           ENDIF
           MATCH    SP70,DBBIUC2
           IF       !@EQUAL
             MOVE     "FD02",DBCDCAT
             PACK     KEY7,DBCDCAT,DBBIUC2
             CALL     RDDBCD1
             IF       OVRCD=0
               MOVE     DBCDDES,DBBIUC2D
             ENDIF
           ENDIF
           MATCH    SP70,DBBIUC3
           IF       !@EQUAL
             MOVE     "FD03",DBCDCAT
             PACK     KEY7,DBCDCAT,DBBIUC3
             CALL     RDDBCD1
             IF       OVRCD=0
               MOVE     DBCDDES,DBBIUC3D
             ENDIF
           ENDIF
           MATCH    SP70,DBBIUC4
           IF       !@EQUAL
             MOVE     "FD04",DBCDCAT
             PACK     KEY7,DBCDCAT,DBBIUC4
             CALL     RDDBCD1
             IF       OVRCD=0
               MOVE     DBCDDES,DBBIUC4D
             ENDIF
           ENDIF
.
GETDES99   RETURN
.
.------------------------------------
. Display Financial Summary Screen
. Calculate Balances
. Call Screen
. Set Exit from Return Flag RETFLAG
.------------------------------------
FINSUM00  CALL     DEBOUT00
.
          CALL     SCF1L000
.
FINSUM99  RETURN
.
.-------------------------------------------------------------
. Get Financial Transaction Line Details
.-------------------------------------------------------------
TRNLIN00  MOVE     DBFDITM,KEY8
          CALL     RDDBIT1
          IF       OVRCD=1
            MOVE     "***** ITEM RECORD MISSING *****",DBITDES
          ENDIF
          MOVE     DBFDDTY,F1
          LOAD     DOCDESC,F1,DOCINV,DOCCRD,DOCPAY,DOCDRA,DOCCRA
          PACK     KEY21,DBFDDEB,DBFDDTY,DBFDDOC,SP70
          CALL     RDDBFH1
.
          MOVE     DBFDDTY,F1
          BRANCH   F1,TRNLIN20,TRNLIN10,TRNLIN10,TRNLIN20,TRNLIN10
.
TRNLIN10  MULT     SEQ,DBFDTOT
          MULT     SEQ,DBFDTAX
          MULT     SEQ,DBFDPAID
.
TRNLIN20  ASSIGN   DBFDTOT+DBFDTAX,DOCTOTAL
          ASSIGN   DBFDTOT+DBFDTAX-DBFDPAID,OUTTOTAL
.
          MATCH    "000000000000",DBFDDOC
          IF       @EQUAL
            MOVE     "Credit Balance Entry Flag",DBITDES
            MOVE     ZERO,DBFDTAX
            MOVE     ZERO,DBFDTOT
            MOVE     ZERO,DBFDPAID
            MOVE     ZERO,DOCTOTAL
            MOVE     ZERO,OUTTOTAL
            MOVE     "Sys.",DOCDESC
          ENDIF
.
TRNLIN99  RETURN
.
SHIST000  CALL     RDDBFD3
          IF       OVRCD=1
            BEEP
            MOVE     "Can't Read Transaction Details - ",DISPMSG
            CALL     MESSAGE1
            GOTO     SHIST999
          ENDIF
.
          MOVE      DBFDDTY,F1
          LOAD      DOCDESC,F1,DOCINV,DOCCRD,DOCPAY,DOCDRA,DOCCRA
.
          MOVE      DBFDITM,KEY8
          CALL      RDDBIT1
          BRANCH    OVRCD,SHIST100
.
          MOVE      DBITPTY,KEY8
          CALL      RDDBPT1
          BRANCH    OVRCD,SHIST200
.
.         PACK      KEY12,PASSCODE,DBPTDEP
.         CALL      RDDBSE1
.         BRANCH    OVRCD,SHIST300
.
          MOVE      DBPTDEP,KEY8
          CALL      RDDBDE1
          IF        OVRCD=1
            MOVE      "Invalid Department on Sales Item - ",DISPMSG
            CALL      MESSAGE1
          ENDIF
          ASSIGN   DBFDTOT+DBFDTAX,TOTALAMT
.
          CALL     GETTRN00
.
          CALL     SCTDL000   * Display Details
          GOTO     SHIST999
.
SHIST100  BEEP
          MOVE     "Invalid Sales Item - ",DISPMSG
          CALL     MESSAGE1
          GOTO     SHIST999
.
SHIST200  BEEP
          MOVE     "Invalid Product Type on Sales Item - ",DISPMSG
          CALL     MESSAGE1
          GOTO     SHIST999
.
.SHIST300  BEEP
.          MOVE     "Inadequate Security for Sales Item - ",DISPMSG
.          CALL     MESSAGE1
.          GOTO     SHIST999
.
SHIST999  RETURN
.
.-------------------------------------------------------------------------
. Key in Invoice No., read Debtor Tran Header for Debtor No.
.-------------------------------------------------------------------------
KEYINV00  MOVE      ZERO,EXIT
          PACK      TRANREF,SP20
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,*JR,*ZF,TRANREF:
                    *PCCOL:CVERT
          MATCH     "0000000000000000000",TRANREF
          GOTO      KEYIN900 IF EQUAL
          ENDSET    TRANREF
          CMATCH    EXITCHAR,TRANREF
          GOTO      KEYIN900 IF EQUAL
          RESET     TRANREF
.
KEYIN100  MOVE     "1",ANS
          PACK      KEY21,TRANREF,ANS,SP8
          CALL      RSDBFH3
.
          CALL      RKDBFH3
          BRANCH    OVRCD,KEYIN810
.
          MATCH     TRANREF,DBFHDOC
          GOTO      KEYIN820 IF NOT EQUAL
.
.                                           * get Debtor Code & Name
          PACK      KEY8,DBFHDEB
          CALL      RDDBDB1
          GOTO      KEYIN999
.
KEYIN810  BEEP
          MOVE     "Can't Read Transaction Header - ",DISPMSG
          CALL     MESSAGE1
          GOTO     KEYIN900
KEYIN820  BEEP
          MOVE     "Invoice No not found - ",DISPMSG
          CALL     MESSAGE1
          GOTO     KEYIN900
.
KEYIN900  MOVE      ONE,EXIT
KEYIN999  RETURN
.-------------------------------------------------------------
. Document Selected
.-------------------------------------------------------------
SDOCI000  CALL     RDDBFD8                  * reposition on selected item
.
          PACK     KEY21,DBFDDOC,DBFDDTY,DBFDDEB
          CALL     RDDBFH3
          IF       OVRCD=1
            BEEP
            MOVE     "Can't Read Transaction Header - ",DISPMSG
            CALL     MESSAGE1
            GOTO     SDOCI999
          ENDIF
.
          PACK     KEY8,DBFHDEB
          CALL     RDDBDB1
.
          MOVE     DBFHDTY,F1
          LOAD     DOCDESC,F1,DOCINV,DOCCRD,DOCPAY,DOCDRA,DOCCRA
.
          ASSIGN   DBFHTOT+DBFHTAX,HEADTOT
          CALL     GETDES00
.
          CALL     SCR2L000
          GOTO     SDOCI999
.
SDOCI999  RETURN

.-------------------------------------------------------------
. Get Financial Transaction Line Details
.-------------------------------------------------------------
OUTLIN00  MOVE     DBFDITM,KEY8
          CALL     RDDBIT1
          IF       OVRCD=1
            MOVE     "***** ITEM RECORD MISSING *****",DBITDES
          ENDIF
          MOVE     DBFDDTY,F1
          LOAD     DOCDESC,F1,DOCINV,DOCCRD,DOCPAY,DOCDRA,DOCCRA
.
          PACK     KEY21,DBFDDEB,DBFDDTY,DBFDDOC,SP70
          CALL     RDDBFH1
.
          MOVE     DBFDDTY,F1
          BRANCH   F1,OUTLIN20,OUTLIN10,OUTLIN10,OUTLIN20,OUTLIN10
.
OUTLIN10  MULT     SEQ,DBFDTOT
          MULT     SEQ,DBFDTAX
          MULT     SEQ,DBFDPAID
.
OUTLIN20  ASSIGN   DBFDTOT+DBFDTAX,DOCTOTAL
          ASSIGN   DBFDTOT+DBFDTAX-DBFDPAID,OUTTOTAL
.
OUTLIN99  RETURN
.
STRAN000  CALL     RDDBFD2
          IF       OVRCD=1
            BEEP
            MOVE     "Can't Read Transaction Details - ",DISPMSG
            CALL     MESSAGE1
            GOTO     STRAN999
          ENDIF
.
          MOVE      DBFDDTY,F1
          LOAD      DOCDESC,F1,DOCINV,DOCCRD,DOCPAY,DOCDRA,DOCCRA
.
          MOVE      DBFDITM,KEY8
          CALL      RDDBIT1
          BRANCH    OVRCD,STRAN100
.
          MOVE      DBITPTY,KEY8
          CALL      RDDBPT1
          BRANCH    OVRCD,STRAN200
.
.          PACK      KEY12,PASSCODE,DBPTDEP
.          CALL      RDDBSE1
.          BRANCH    OVRCD,STRAN300
.
          MOVE      DBPTDEP,KEY8
          CALL      RDDBDE1
          IF        OVRCD=1
            MOVE      "Invalid Department on Sales Item - ",DISPMSG
            CALL      MESSAGE1
          ENDIF
          ASSIGN   DBFDTOT+DBFDTAX,TOTALAMT
.
          CALL     GETTRN00
.
          CALL     SCTDL000   * Display Details
          GOTO     STRAN999
.
STRAN100  BEEP
          MOVE     "Invalid Sales Item - ",DISPMSG
          CALL     MESSAGE1
          GOTO     STRAN999
.
STRAN200  BEEP
          MOVE     "Invalid Product Type on Sales Item - ",DISPMSG
          CALL     MESSAGE1
          GOTO     STRAN999
.
.STRAN300  BEEP
.          MOVE     "Inadequate Security for Sales Item - ",DISPMSG
.          CALL     MESSAGE1
.          GOTO     STRAN999
.
STRAN999  RETURN
.---------------------------------------------------
. Get User Def Code Descriptions
.---------------------------------------------------
GETTRN00   MOVE     SP70,DBBIUC1D
           MOVE     SP70,DBBIUC2D
           MOVE     SP70,DBBIUC3D
           MOVE     SP70,DBBIUC4D
           PACK     KEY21,DBFDDEB,DBFDDTY,DBFDDOC,SP70
           CALL     RDDBFH1
.
           MOVE     DBFHCUSR,KEY4
           CALL     RDPASS1
.
           MATCH    SP70,DBFDUC1
           IF       !@EQUAL
             MOVE     "FD01",DBCDCAT
             PACK     KEY7,DBCDCAT,DBFDUC1
             CALL     RDDBCD1
             IF       OVRCD=0
               MOVE     DBCDDES,DBBIUC1D
             ENDIF
           ENDIF
           MATCH    SP70,DBFDUC2
           IF       !@EQUAL
             MOVE     "FD02",DBCDCAT
             PACK     KEY7,DBCDCAT,DBFDUC2
             CALL     RDDBCD1
             IF       OVRCD=0
               MOVE     DBCDDES,DBBIUC2D
             ENDIF
           ENDIF
           MATCH    SP70,DBFDUC3
           IF       !@EQUAL
             MOVE     "FD03",DBCDCAT
             PACK     KEY7,DBCDCAT,DBFDUC3
             CALL     RDDBCD1
             IF       OVRCD=0
               MOVE     DBCDDES,DBBIUC3D
             ENDIF
           ENDIF
           MATCH    SP70,DBFDUC4
           IF       !@EQUAL
             MOVE     "FD04",DBCDCAT
             PACK     KEY7,DBCDCAT,DBFDUC4
             CALL     RDDBCD1
             IF       OVRCD=0
               MOVE     DBCDDES,DBBIUC4D
             ENDIF
           ENDIF
.
           CALL     GETREC00
.
           RETURN
.------------------------------------------------------------
. Get Receipt Details for Display
.------------------------------------------------------------
GETREC00  MOVE     SP70,DBCRDEB
          MOVE     SP70,DBCRREC
          MOVE     SP70,DBCRTYP
          MOVE     SP70,DBCRDRW
          MOVE     SP70,DBCRCHQ
          MOVE     SP70,DBCRBNK
          MOVE     SP70,DBCRBRA
          MOVE     SP70,DBCRDAT
          MOVE     SP70,DBCRUSR
          MOVE     SP70,DBCRIDT
          MOVE     SP70,DBCRITM
          MOVE     SP70,DBCRUR1
          MOVE     SP70,DBCRUR2
          MOVE     SP70,DBCRUD1
          MOVE     SP70,DBCRUD2
          MOVE     SP70,DBCRUY1
          MOVE     SP70,DBCRUY2
          MOVE     SP70,DBCRUC1
          MOVE     SP70,DBCRUC2
          MOVE     SP70,DBCRSPA
          MOVE     SP70,PAYDESC
          MOVE     ZERO,DBCRAMT
          MATCH    "3",DBFDDTY
          GOTO     GETREC99 IF NOT EQUAL
          MOVE     DBFDDOC,KEY12
          CALL     RDDBCR1
          BRANCH   OVRCD,GETREC99
          MOVE     DBCRTYP,F1
          BRANCH   F1,GETREC10,GETREC20,GETREC30
          GOTO     GETREC99
.
GETREC10  MOVE      "Cash      ",PAYDESC
          GOTO      GETREC90
.
GETREC20  MOVE      "Cheque     ",PAYDESC
          GOTO      GETREC90
.
GETREC30  MOVE      "Credit Card",PAYDESC
          GOTO      GETREC90
.
GETREC90  MOVE      PAYDESC,DOCDESC
.
GETREC99  RETURN
.
DOCLIN00  PACK     KEY8,DBFHDEB
          CALL     RDDBDB1
          MOVE     DBFHDTY,F1
          LOAD     DOCDESC,F1,DOCINV,DOCCRD,DOCPAY,DOCDRA,DOCCRA
          BRANCH   F1,DOCLIN20,DOCLIN10,DOCLIN10,DOCLIN20,DOCLIN10
.
DOCLIN10  MULT     SEQ,DBFDTOT
          MULT     SEQ,DBFDTAX
          MULT     SEQ,DBFDPAID
.
DOCLIN20  ASSIGN   DBFHTOT+DBFHTAX,TOTALAMT
.
          RETURN
.
.-------------------------------------------------------------
. Item Selected
.-------------------------------------------------------------
SDOCH000  CALL     RDDBFH3
          IF       OVRCD=1
            BEEP
            MOVE     "Can't Read Transaction Header - ",DISPMSG
            CALL     MESSAGE1
            GOTO     SDOCH999
          ENDIF
.
          PACK     KEY8,DBFHDEB
          CALL     RDDBDB1
.
          MOVE     DBFHDTY,F1
          LOAD     DOCDESC,F1,DOCINV,DOCCRD,DOCPAY,DOCDRA,DOCCRA
.
          ASSIGN   DBFHTOT+DBFHTAX,HEADTOT
          CALL     GETDES00
.
          CALL     SCR2L000
          GOTO     SDOCH999
.
SDOCH999  RETURN
REDDET00   ASSIGN     DBFDTAX+DBFDTOT,TOTALAMT
           MOVE       DBFDITM,KEY8
           CALL       RDDBIT1
           RETURN
SDOCL000  CALL     RDDBFD1
          IF       OVRCD=1
            BEEP
            MOVE     "Can't Read Transaction Details - ",DISPMSG
            CALL     MESSAGE1
            GOTO     SDOCL999
          ENDIF
.
          MOVE      DBFDITM,KEY8
          CALL      RDDBIT1
          BRANCH    OVRCD,SDOCL100
.
          MOVE      DBITPTY,KEY8
          CALL      RDDBPT1
          BRANCH    OVRCD,SDOCL200
.
.          PACK      KEY12,PASSCODE,DBPTDEP
.          CALL      RDDBSE1
.          BRANCH    OVRCD,SDOCL300
.
          MOVE      DBPTDEP,KEY8
          CALL      RDDBDE1
          IF        OVRCD=1
            MOVE      "Invalid Department on Sales Item - ",DISPMSG
            CALL      MESSAGE1
          ENDIF
          ASSIGN   DBFDTOT+DBFDTAX,TOTALAMT
.
          CALL     GETTRN00
.
          CALL     SCTDL000   * Display Details
          GOTO     SDOCL999
.
SDOCL100  BEEP
          MOVE     "Invalid Sales Item - ",DISPMSG
          CALL     MESSAGE1
          GOTO     SDOCL999
.
SDOCL200  BEEP
          MOVE     "Invalid Product Type on Sales Item - ",DISPMSG
          CALL     MESSAGE1
          GOTO     SDOCL999
.
.SDOCL300  BEEP
.          MOVE     "Inadequate Security for Sales Item - ",DISPMSG
.          CALL     MESSAGE1
.          GOTO     SDOCL999
.
SDOCL999  RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       DEBBICIO/INC
          INC       DEBBILIO/INC
          INC       DEBCODIO/INC
          INC       DEBCREIO/INC
          INC       DEBDBTIO/INC
          INC       DEBDBTKY    
          INC       DEBDCMIO/INC
          INC       DEBDEPIO/INC
          INC       DEBDKIIO/INC
          INC       DEBDKIKY    
          INC       DEBDKIPR    
          INC       DEBFDTIO/INC
          INC       DEBFNOIO/INC
          INC       DEBFTHIO/INC
          INC       DEBITMIO/INC
          INC       DEBLINIO/INC
          INC       DEBOUTCD    
          INC       DEBPTYIO/INC
          INC       DEBSECIO/INC
          INC       DEBSRHCD    
          INC       DEBTERIO/INC
          INC       IBAPASIO/INC
.
          INC       STDGENCD
.
