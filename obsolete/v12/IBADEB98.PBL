.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.05.01  03/03/2006  Mike Lmaing   CAR 75900
.           Add indicator CFDBNFMT for Patient Name Format
. V9.04.01  20/04/2005 Mike Laming  CAR 59741
.           Add Statement layout no. "13" for Mercy H&AC
.-------------------------------------------------------
. V9.02.01  20.03.2003  Sandra Barcham    CAR 37464
.           Add f09 changes missed in v9.00
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.01.06  05.03.2001 Sandra Barcham
.           Add 132 Columns Layout
.           srf 9059
. VF.01.05  23.08.2000 Charles Handaya
.           Add Next Statement No.
.           Quote 9840
. VF.01.04  27.07.2000 Charles Handaya
.           Fix some dates validation in User Controlled Screen 1
.           srf 4119
. VF.01.03  20.06.2000 Sandra Barcham
.           Enable null entry for templates
. VF.01.02  15.06.2000 Charles Handaya
.           Add New Invoice, Statement Layout
.           for Balarat Health Services (BHS)
. VF.01.01  05.04.2000 Charles Handaya
.           Add Debtors GST stationeries template
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBADEB98
.   Function      :   Account Receivable System Parameters    
.   Generated  On :   10/03/2006
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       DEBCONFD/INC
          INC       DEBITMFD/INC
          INC       DEBPTYFD/INC
          INC       IBATMHFD/INC
.=========================
.Local Variable Definition
.-------------------------
ILAYDESC  DIM      30 * Scr I1 Fld    11
SLAYDESC  DIM      30 * Scr I1 Fld    13
LOCSDESC  DIM      35 * Scr U1 Fld    16
STDSDESC  DIM      35 * Scr U1 Fld    18
IDDSDESC  DIM      35 * Scr U1 Fld    20
DESCPNAM  DIM      35 * Scr U1 Fld    23
IVHDDESC  DIM      30 * Scr U2 Fld     5
IVTLDESC  DIM      30 * Scr U2 Fld     7
CRHDDESC  DIM      30 * Scr U2 Fld     9
CRTLDESC  DIM      30 * Scr U2 Fld    11
STHDDESC  DIM      30 * Scr U2 Fld    13
STTLDESC  DIM      30 * Scr U2 Fld    15
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBADEB98"
PRGNAM    INIT      "Account Receivable System Parameters    "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   81",AUDTSECT
          MOVE      " 12",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudit";
            OPEN      DEBAUDIT,"debaudit"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 13",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudpt";
            OPEN      DEBAUDPT,"debaudpt"
          ENDIF
          DISPLAY   *P56:24,"Opening debitmaf";
          OPEN      DEBITMA1,"debitmaf"
          DISPLAY   *P56:24,"Opening debitmaf";
          OPEN      DEBITMA2,"debitmaf"
          DISPLAY   *P56:24,"Opening debitmaf";
          OPEN      DEBITMA3,"debitmaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA1,"debptyaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA2,"debptyaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA3,"debptyaf"
          DISPLAY   *P56:24,"Opening ibatmhaf";
          OPEN      IBATMHA1,"ibatmhaf"
          DISPLAY   *P56:24,"Opening ibatmhaf";
          OPEN      IBATMHA2,"ibatmhaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Parameter Menu                     
          ENDIF
          MATCH     "A1",SCRID
          IF         @EQUAL
            CALL       PSA1L000   * Audit Control Screen 1             
          ENDIF
          MATCH     "I1",SCRID
          IF         @EQUAL
            CALL       PSI1L000   * IBA Controlled Screen 1            
          ENDIF
          MATCH     "U1",SCRID
          IF         @EQUAL
            CALL       PSU1L000   * User Defined Screen 1              
          ENDIF
          MATCH     "U2",SCRID
          IF         @EQUAL
            CALL       PSU2L000   * User Defined Screen 2              
          ENDIF
          RETURN
.--------------------------------
. Screen - Parameter Menu                     
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Parameter Menu                     
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Parameter Menu                     
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Parameter Menu                     
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Parameter Menu                     
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Parameter Menu                     
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Parameter Menu                     
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Parameter Menu                     
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SCA1L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SCU1L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      GETI1000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          CALL      SCU2L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Audit Control Screen 1             
.--------------------------------
SCA1L000
SCA1L100
          MOVE      "A1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCA1L200
          CALL      CFA1L000 * Clear Fields
          CALL      GETA1000
SCA1L300
          CALL      KYA1L000 * Enter Key Fields
          BRANCH    EXIT,SCA1L999,SCA1L999
SCA1L400
          CALL      WPA1L000 * Load any WP Details
SCA1L500
          CALL      LMA1L000 * Load any Batch Details
SCA1L600
          CALL      DFA1L000 * Display Fields
SCA1L700
          CALL      SFA1L000 * Select Fields
          BRANCH    EXIT,SCA1L100,SCA1L100,SCA1L200
SCA1L800
SCA1L900
SCA1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Audit Control Screen 1             
.-------------------------------------------------------
CFA1L000
CFA1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Audit Control Screen 1             
.--------------------------------------------------------
KYA1L000
          MOVE      ZERO,EXIT
          GOTO      KYA1L999
.
KYA1L900  MOVE      ONE,EXIT
KYA1L999  RETURN
.---------------------------------------------------------
. Load WP files for : Audit Control Screen 1             
.---------------------------------------------------------
WPA1L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Audit Control Screen 1             
.---------------------------------------------------------
LMA1L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Audit Control Screen 1             
.---------------------------------------------------------
DFA1L000
          BRANCH   ACCEPT,DFA1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFA1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFA1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFA1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFA1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFA1L010 IF NOT EQUAL
.
          CALL     PSA1L000 * Display Field
          GOTO     DFA1L010
DFA1L900
DFA1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Audit Control Screen 1             
.---------------------------------------------------------
PSA1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSA1L999,PSA1L999,PSA1L999,PSA1L101:
                            PSA1L102,PSA1L103,PSA1L104,PSA1L105:
                            PSA1L106,PSA1L107,PSA1L108,PSA1L109:
                            PSA1L110
          GOTO     PSA1L999
.
PSA1L101
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDA,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSA1L999
.
PSA1L102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDB,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSA1L999
.
PSA1L103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDC,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSA1L999
.
PSA1L104
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDD,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSA1L999
.
PSA1L105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDE,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSA1L999
.
PSA1L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDF,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSA1L999
.
PSA1L107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSA1L999
.
PSA1L108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDH,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSA1L999
.
PSA1L109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDI,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSA1L999
.
PSA1L110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDJ,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSA1L999
PSA1L999
          RETURN
.---------------------------------------------------------
. Selections for : Audit Control Screen 1             
.---------------------------------------------------------
SFA1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFA1L001  BRANCH   ACCEPT,SFA1L020
.
SFA1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFA1L006,SFA1L101,SFA1L102,SFA1L103:
                            SFA1L104,SFA1L105,SFA1L106,SFA1L107:
                            SFA1L108,SFA1L109,SFA1L110,SFA1L111:
                            SFA1L112
SFA1L006  BEEP
          GOTO     SFA1L005
SFA1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFA1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFA1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFA1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFA1L020,SFA1L020,SFA1L020,SFA1L103:
                            SFA1L104,SFA1L105,SFA1L106,SFA1L107:
                            SFA1L108,SFA1L109,SFA1L110,SFA1L111:
                            SFA1L112
          GOTO     SFA1L020
SFA1L090  MOVE     ZERO,ACCEPT
          GOTO     SFA1L001
.
SFA1L101
          MOVE      ZERO,EXIT
          GOTO      SFA1L999
.
SFA1L102
          CALL      POSTA100
          MOVE      ZERO,EXIT
          GOTO      SFA1L999
.
SFA1L103
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CFDBAUDA
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDA,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFA1L001
.
SFA1L104
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CFDBAUDB
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDB,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFA1L001
.
SFA1L105
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CFDBAUDC
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDC,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFA1L001
.
SFA1L106
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CFDBAUDD
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDD,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFA1L001
.
SFA1L107
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CFDBAUDE
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDE,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFA1L001
.
SFA1L108
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CFDBAUDF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDF,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFA1L001
.
SFA1L109
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CFDBAUDG
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFA1L001
.
SFA1L110
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CFDBAUDH
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDH,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFA1L001
.
SFA1L111
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CFDBAUDI
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDI,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFA1L001
.
SFA1L112
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CFDBAUDJ
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBAUDJ,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFA1L001
SFA1L990  MOVE      ONE,EXIT * Exit Char Restart
SFA1L999  RETURN
.--------------------------------
. Screen - IBA Controlled Screen 1            
.--------------------------------
SCI1L000
SCI1L100
          MOVE      "I1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCI1L200
          CALL      CFI1L000 * Clear Fields
SCI1L300
          CALL      KYI1L000 * Enter Key Fields
          BRANCH    EXIT,SCI1L999,SCI1L999
SCI1L400
          CALL      WPI1L000 * Load any WP Details
SCI1L500
          CALL      LMI1L000 * Load any Batch Details
SCI1L600
          CALL      DFI1L000 * Display Fields
SCI1L700
          CALL      SFI1L000 * Select Fields
          BRANCH    EXIT,SCI1L100,SCI1L100,SCI1L200
SCI1L800
SCI1L900
SCI1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : IBA Controlled Screen 1            
.-------------------------------------------------------
CFI1L000
CFI1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for IBA Controlled Screen 1            
.--------------------------------------------------------
KYI1L000
          MOVE      ZERO,EXIT
          GOTO      KYI1L999
.
KYI1L900  MOVE      ONE,EXIT
KYI1L999  RETURN
.---------------------------------------------------------
. Load WP files for : IBA Controlled Screen 1            
.---------------------------------------------------------
WPI1L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : IBA Controlled Screen 1            
.---------------------------------------------------------
LMI1L000
          RETURN
.---------------------------------------------------------
. Display Fields for : IBA Controlled Screen 1            
.---------------------------------------------------------
DFI1L000
          BRANCH   ACCEPT,DFI1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFI1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFI1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFI1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFI1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFI1L010 IF NOT EQUAL
.
          CALL     PSI1L000 * Display Field
          GOTO     DFI1L010
DFI1L900
DFI1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : IBA Controlled Screen 1            
.---------------------------------------------------------
PSI1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSI1L999,PSI1L999,PSI1L999,PSI1L101:
                            PSI1L999,PSI1L999,PSI1L102,PSI1L103:
                            PSI1L104,PSI1L105,PSI1L106,PSI1L107:
                            PSI1L108,PSI1L109,PSI1L110,PSI1L111:
                            PSI1L112,PSI1L113,PSI1L114,PSI1L115
          GOTO     PSI1L999
.
PSI1L101
          MOVE      CFDBPASS,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBIFL,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L103
          MOVE      CFDBINV,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L104
          MOVE      CFDBCRN,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L105
          MOVE      CFDBILAY,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L106
          MOVE      ILAYDESC,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L107
          MOVE      CFDBSLAY,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L108
          MOVE      SLAYDESC,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L109
          MOVE      CFDBBLIN,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L110
          MOVE      CFDBBLST,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L111
          MOVE      CFDBREC,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L112
          MOVE      CFDBNDB,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L113
          MOVE      CFDBSDB,VAR      
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBMAN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSI1L999
.
PSI1L115
          MOVE      CFDBSTAN,VAR     
          CALL      DISPITEM
          GOTO     PSI1L999
PSI1L999
          RETURN
.---------------------------------------------------------
. Selections for : IBA Controlled Screen 1            
.---------------------------------------------------------
SFI1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFI1L001  BRANCH   ACCEPT,SFI1L020
.
SFI1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFI1L006,SFI1L101,SFI1L102,SFI1L103:
                            SFI1L006,SFI1L006,SFI1L104,SFI1L105:
                            SFI1L106,SFI1L107,SFI1L006,SFI1L108:
                            SFI1L006,SFI1L109,SFI1L110,SFI1L111:
                            SFI1L112,SFI1L113,SFI1L114,SFI1L115
SFI1L006  BEEP
          GOTO     SFI1L005
SFI1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFI1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFI1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFI1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFI1L020,SFI1L020,SFI1L020,SFI1L103:
                            SFI1L020,SFI1L020,SFI1L104,SFI1L105:
                            SFI1L106,SFI1L107,SFI1L020,SFI1L108:
                            SFI1L020,SFI1L109,SFI1L110,SFI1L111:
                            SFI1L112,SFI1L113,SFI1L114,SFI1L115
          GOTO     SFI1L020
SFI1L090  MOVE     ZERO,ACCEPT
          GOTO     SFI1L001
.
SFI1L101
          MOVE      ZERO,EXIT
          GOTO      SFI1L999
.
SFI1L102
          CALL      POSTI100
          MOVE      ZERO,EXIT
          GOTO      SFI1L999
.
SFI1L103
          CALL     SELECTED
          STRIP     CFDBPASS
          SFORMAT   VAR,SCPSLEN
          MOVE      CFDBPASS,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CFDBPASS
          SFORMAT   VAR,127
          ENDSET    CFDBPASS
          APPEND    SP70,CFDBPASS
          RESET     CFDBPASS
          CMATCH    EXITCHAR,CFDBPASS
          GOTO      SFI1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CFDBPASS
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L103
            ENDIF
          ENDIF
          MOVE      CFDBPASS,VAR     
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L104
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CFDBIFL 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBIFL,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L105
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CFDBINV 
          IF        SCPSMAN=1
            COMPARE   ZERO,CFDBINV 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L105
            ENDIF
          ENDIF
          MOVE      CFDBINV,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L106
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CFDBCRN 
          IF        SCPSMAN=1
            COMPARE   ZERO,CFDBCRN 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L106
            ENDIF
          ENDIF
          MOVE      CFDBCRN,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L107
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,ILAYDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KILAY000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L107
            ENDIF
            BRANCH    EXIT,SFI1L107,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          MOVE      CFDBILAY,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ILAYDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L108
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SLAYDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSLAY000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L108
            ENDIF
            BRANCH    EXIT,SFI1L108,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          MOVE      CFDBSLAY,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SLAYDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFI1L001
.
SFI1L109
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CFDBBLIN
          IF        SCPSMAN=1
            COMPARE   ZERO,CFDBBLIN
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L109
            ENDIF
          ENDIF
          MOVE      CFDBBLIN,VAR     
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L110
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CFDBBLST
          IF        SCPSMAN=1
            COMPARE   ZERO,CFDBBLST
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L110
            ENDIF
          ENDIF
          MOVE      CFDBBLST,VAR     
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L111
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CFDBREC 
          IF        SCPSMAN=1
            COMPARE   ZERO,CFDBREC 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L111
            ENDIF
          ENDIF
          MOVE      CFDBREC,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L112
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CFDBNDB 
          IF        SCPSMAN=1
            COMPARE   ZERO,CFDBNDB 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L112
            ENDIF
          ENDIF
          MOVE      CFDBNDB,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L113
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CFDBSDB 
          IF        SCPSMAN=1
            COMPARE   ZERO,CFDBSDB 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L113
            ENDIF
          ENDIF
          MOVE      CFDBSDB,VAR      
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L114
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CFDBMAN 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBMAN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFI1L001
.
SFI1L115
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESTA0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFI1L115
            ENDIF
            BRANCH    EXIT,SFI1L115,SFI1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFI1L990 IF EQUAL
          ENDIF
          MOVE      CFDBSTAN,VAR     
          CALL      DISPITEM
          GOTO     SFI1L001
SFI1L990  MOVE      ONE,EXIT * Exit Char Restart
SFI1L999  RETURN
.--------------------------------
. Screen - User Defined Screen 1              
.--------------------------------
SCU1L000
SCU1L100
          MOVE      "U1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCU1L200
          CALL      CFU1L000 * Clear Fields
          CALL      GETU1000
SCU1L300
          CALL      KYU1L000 * Enter Key Fields
          BRANCH    EXIT,SCU1L999,SCU1L999
SCU1L400
          CALL      WPU1L000 * Load any WP Details
SCU1L500
          CALL      LMU1L000 * Load any Batch Details
SCU1L600
          CALL      DFU1L000 * Display Fields
SCU1L700
          CALL      SFU1L000 * Select Fields
          BRANCH    EXIT,SCU1L100,SCU1L100,SCU1L200
SCU1L800
SCU1L900
SCU1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : User Defined Screen 1              
.-------------------------------------------------------
CFU1L000
CFU1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for User Defined Screen 1              
.--------------------------------------------------------
KYU1L000
          MOVE      ZERO,EXIT
          GOTO      KYU1L999
.
KYU1L900  MOVE      ONE,EXIT
KYU1L999  RETURN
.---------------------------------------------------------
. Load WP files for : User Defined Screen 1              
.---------------------------------------------------------
WPU1L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : User Defined Screen 1              
.---------------------------------------------------------
LMU1L000
          RETURN
.---------------------------------------------------------
. Display Fields for : User Defined Screen 1              
.---------------------------------------------------------
DFU1L000
          BRANCH   ACCEPT,DFU1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFU1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFU1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFU1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFU1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFU1L010 IF NOT EQUAL
.
          CALL     PSU1L000 * Display Field
          GOTO     DFU1L010
DFU1L900
DFU1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : User Defined Screen 1              
.---------------------------------------------------------
PSU1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSU1L999,PSU1L999,PSU1L999,PSU1L101:
                            PSU1L102,PSU1L103,PSU1L104,PSU1L105:
                            PSU1L106,PSU1L107,PSU1L108,PSU1L109:
                            PSU1L110,PSU1L111,PSU1L112,PSU1L113:
                            PSU1L114,PSU1L115,PSU1L116,PSU1L117:
                            PSU1L118,PSU1L119,PSU1L120
          GOTO     PSU1L999
.
PSU1L101
          MOVE      CFDBSQLA,VAR     
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L102
          MOVE      CFDBSQLB,VAR     
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L103
          UNPACK    CFDBFDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L104
          UNPACK    CFDBTDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L105
          UNPACK    CFDBSTYR,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L106
          MOVE      CFDBCNAM,VAR     
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L107
          MOVE      CFDBCAD1,VAR     
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L108
          MOVE      CFDBCAD2,VAR     
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L109
          MOVE      CFDBCPOS,VAR     
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L110
          MOVE      CFDBETEL,VAR     
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L111
          MOVE      CFDBECON,VAR     
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L112
          MOVE      CFDBLOCS,VAR     
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L113
          MOVE      LOCSDESC,VAR     
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L114
          MOVE      CFDBSTDS,VAR     
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L115
          MOVE      STDSDESC,VAR     
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L116
          MOVE      CFDBIDDS,VAR     
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L117
          MOVE      IDDSDESC,VAR     
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L118
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBSOPT,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L119
          MOVE      CFDBNFMT,VAR     
          CALL      DISPITEM
          GOTO     PSU1L999
.
PSU1L120
          MOVE      DESCPNAM,VAR     
          CALL      DISPITEM
          GOTO     PSU1L999
PSU1L999
          RETURN
.---------------------------------------------------------
. Selections for : User Defined Screen 1              
.---------------------------------------------------------
SFU1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFU1L001  BRANCH   ACCEPT,SFU1L020
.
SFU1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFU1L006,SFU1L101,SFU1L102,SFU1L103:
                            SFU1L104,SFU1L105,SFU1L006,SFU1L106:
                            SFU1L107,SFU1L108,SFU1L109,SFU1L110:
                            SFU1L111,SFU1L112,SFU1L113,SFU1L006:
                            SFU1L114,SFU1L006,SFU1L115,SFU1L006:
                            SFU1L116,SFU1L117,SFU1L006
SFU1L006  BEEP
          GOTO     SFU1L005
SFU1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFU1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFU1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFU1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFU1L020,SFU1L020,SFU1L020,SFU1L103:
                            SFU1L104,SFU1L105,SFU1L020,SFU1L106:
                            SFU1L107,SFU1L108,SFU1L109,SFU1L110:
                            SFU1L111,SFU1L112,SFU1L113,SFU1L020:
                            SFU1L114,SFU1L020,SFU1L115,SFU1L020:
                            SFU1L116,SFU1L117,SFU1L020
          GOTO     SFU1L020
SFU1L090  MOVE     ZERO,ACCEPT
          GOTO     SFU1L001
.
SFU1L101
          MOVE      ZERO,EXIT
          GOTO      SFU1L999
.
SFU1L102
          CALL      POSTU100
          MOVE      ZERO,EXIT
          GOTO      SFU1L999
.
SFU1L103
          CALL     SELECTED
          STRIP     CFDBSQLA
          SFORMAT   VAR,SCPSLEN
          MOVE      CFDBSQLA,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CFDBSQLA
          SFORMAT   VAR,127
          ENDSET    CFDBSQLA
          APPEND    SP70,CFDBSQLA
          RESET     CFDBSQLA
          CMATCH    EXITCHAR,CFDBSQLA
          GOTO      SFU1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CFDBSQLA
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU1L103
            ENDIF
          ENDIF
          MOVE      CFDBSQLA,VAR     
          CALL      DISPITEM
          GOTO     SFU1L001
.
SFU1L104
          CALL     SELECTED
          STRIP     CFDBSQLB
          SFORMAT   VAR,SCPSLEN
          MOVE      CFDBSQLB,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CFDBSQLB
          SFORMAT   VAR,127
          ENDSET    CFDBSQLB
          APPEND    SP70,CFDBSQLB
          RESET     CFDBSQLB
          CMATCH    EXITCHAR,CFDBSQLB
          GOTO      SFU1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CFDBSQLB
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU1L104
            ENDIF
          ENDIF
          MOVE      CFDBSQLB,VAR     
          CALL      DISPITEM
          GOTO     SFU1L001
.
SFU1L105
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CFDBTDAT
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RDAT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU1L105
            ENDIF
            BRANCH    EXIT,SFU1L105,SFU1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFU1L990 IF EQUAL
          ENDIF
          UNPACK    CFDBFDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            UNPACK    CFDBTDAT,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ENDIF
          GOTO     SFU1L001
.
SFU1L106
          CALL      DEFDAT00
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      STYR0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU1L106
            ENDIF
            BRANCH    EXIT,SFU1L106,SFU1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFU1L990 IF EQUAL
          ENDIF
          UNPACK    CFDBSTYR,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SFU1L001
.
SFU1L107
          CALL     SELECTED
          STRIP     CFDBCNAM
          SFORMAT   VAR,SCPSLEN
          MOVE      CFDBCNAM,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CFDBCNAM
          SFORMAT   VAR,127
          ENDSET    CFDBCNAM
          APPEND    SP70,CFDBCNAM
          RESET     CFDBCNAM
          CMATCH    EXITCHAR,CFDBCNAM
          GOTO      SFU1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CFDBCNAM
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU1L107
            ENDIF
          ENDIF
          MOVE      CFDBCNAM,VAR     
          CALL      DISPITEM
          GOTO     SFU1L001
.
SFU1L108
          CALL     SELECTED
          STRIP     CFDBCAD1
          SFORMAT   VAR,SCPSLEN
          MOVE      CFDBCAD1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CFDBCAD1
          SFORMAT   VAR,127
          ENDSET    CFDBCAD1
          APPEND    SP70,CFDBCAD1
          RESET     CFDBCAD1
          CMATCH    EXITCHAR,CFDBCAD1
          GOTO      SFU1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CFDBCAD1
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU1L108
            ENDIF
          ENDIF
          MOVE      CFDBCAD1,VAR     
          CALL      DISPITEM
          GOTO     SFU1L001
.
SFU1L109
          CALL     SELECTED
          STRIP     CFDBCAD2
          SFORMAT   VAR,SCPSLEN
          MOVE      CFDBCAD2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CFDBCAD2
          SFORMAT   VAR,127
          ENDSET    CFDBCAD2
          APPEND    SP70,CFDBCAD2
          RESET     CFDBCAD2
          CMATCH    EXITCHAR,CFDBCAD2
          GOTO      SFU1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CFDBCAD2
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU1L109
            ENDIF
          ENDIF
          MOVE      CFDBCAD2,VAR     
          CALL      DISPITEM
          GOTO     SFU1L001
.
SFU1L110
          CALL     SELECTED
          STRIP     CFDBCPOS
          SFORMAT   VAR,SCPSLEN
          MOVE      CFDBCPOS,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CFDBCPOS
          SFORMAT   VAR,127
          ENDSET    CFDBCPOS
          APPEND    SP70,CFDBCPOS
          RESET     CFDBCPOS
          CMATCH    EXITCHAR,CFDBCPOS
          GOTO      SFU1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CFDBCPOS
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU1L110
            ENDIF
          ENDIF
          MOVE      CFDBCPOS,VAR     
          CALL      DISPITEM
          GOTO     SFU1L001
.
SFU1L111
          CALL     SELECTED
          STRIP     CFDBETEL
          SFORMAT   VAR,SCPSLEN
          MOVE      CFDBETEL,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CFDBETEL
          SFORMAT   VAR,127
          ENDSET    CFDBETEL
          APPEND    SP70,CFDBETEL
          RESET     CFDBETEL
          CMATCH    EXITCHAR,CFDBETEL
          GOTO      SFU1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CFDBETEL
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU1L111
            ENDIF
          ENDIF
          MOVE      CFDBETEL,VAR     
          CALL      DISPITEM
          GOTO     SFU1L001
.
SFU1L112
          CALL     SELECTED
          STRIP     CFDBECON
          SFORMAT   VAR,SCPSLEN
          MOVE      CFDBECON,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CFDBECON
          SFORMAT   VAR,127
          ENDSET    CFDBECON
          APPEND    SP70,CFDBECON
          RESET     CFDBECON
          CMATCH    EXITCHAR,CFDBECON
          GOTO      SFU1L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CFDBECON
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU1L112
            ENDIF
          ENDIF
          MOVE      CFDBECON,VAR     
          CALL      DISPITEM
          GOTO     SFU1L001
.
SFU1L113
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,LOCSDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KLOCS000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU1L113
            ENDIF
            BRANCH    EXIT,SFU1L113,SFU1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFU1L990 IF EQUAL
          ENDIF
          MOVE      CFDBLOCS,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      LOCSDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFU1L001
.
SFU1L114
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,STDSDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSTDS000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU1L114
            ENDIF
            BRANCH    EXIT,SFU1L114,SFU1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFU1L990 IF EQUAL
          ENDIF
          MOVE      CFDBSTDS,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      STDSDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFU1L001
.
SFU1L115
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,IDDSDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KIDDS000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU1L115
            ENDIF
            BRANCH    EXIT,SFU1L115,SFU1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFU1L990 IF EQUAL
          ENDIF
          MOVE      CFDBIDDS,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      IDDSDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFU1L001
.
SFU1L116
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CFDBSOPT
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CFDBSOPT,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFU1L001
.
SFU1L117
.
.
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESCPNAM
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KPNAM000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU1L117
            ENDIF
            BRANCH    EXIT,SFU1L117,SFU1L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFU1L990 IF EQUAL
          ENDIF
          MOVE      CFDBNFMT,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESCPNAM,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFU1L001
SFU1L990  MOVE      ONE,EXIT * Exit Char Restart
SFU1L999  RETURN
.--------------------------------
. Screen - User Defined Screen 2              
.--------------------------------
SCU2L000
SCU2L100
          MOVE      "U2",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCU2L200
          CALL      CFU2L000 * Clear Fields
          CALL      GETU2000
SCU2L300
          CALL      KYU2L000 * Enter Key Fields
          BRANCH    EXIT,SCU2L999,SCU2L999
SCU2L400
          CALL      WPU2L000 * Load any WP Details
SCU2L500
          CALL      LMU2L000 * Load any Batch Details
SCU2L600
          CALL      DFU2L000 * Display Fields
SCU2L700
          CALL      SFU2L000 * Select Fields
          BRANCH    EXIT,SCU2L100,SCU2L100,SCU2L200
SCU2L800
SCU2L900
SCU2L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : User Defined Screen 2              
.-------------------------------------------------------
CFU2L000
CFU2L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for User Defined Screen 2              
.--------------------------------------------------------
KYU2L000
          MOVE      ZERO,EXIT
          GOTO      KYU2L999
.
KYU2L900  MOVE      ONE,EXIT
KYU2L999  RETURN
.---------------------------------------------------------
. Load WP files for : User Defined Screen 2              
.---------------------------------------------------------
WPU2L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : User Defined Screen 2              
.---------------------------------------------------------
LMU2L000
          RETURN
.---------------------------------------------------------
. Display Fields for : User Defined Screen 2              
.---------------------------------------------------------
DFU2L000
          BRANCH   ACCEPT,DFU2L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFU2L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFU2L900
          MATCH    PRGID,SCPSPID
          GOTO     DFU2L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFU2L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFU2L010 IF NOT EQUAL
.
          CALL     PSU2L000 * Display Field
          GOTO     DFU2L010
DFU2L900
DFU2L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : User Defined Screen 2              
.---------------------------------------------------------
PSU2L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSU2L999,PSU2L999,PSU2L999,PSU2L101:
                            PSU2L102,PSU2L103,PSU2L104,PSU2L105:
                            PSU2L106,PSU2L107,PSU2L108,PSU2L109:
                            PSU2L110,PSU2L111,PSU2L112
          GOTO     PSU2L999
.
PSU2L101
          MOVE      CFDBIVHD,VAR     
          CALL      DISPITEM
          GOTO     PSU2L999
.
PSU2L102
          MOVE      IVHDDESC,VAR     
          CALL      DISPITEM
          GOTO     PSU2L999
.
PSU2L103
          MOVE      CFDBIVTL,VAR     
          CALL      DISPITEM
          GOTO     PSU2L999
.
PSU2L104
          MOVE      IVTLDESC,VAR     
          CALL      DISPITEM
          GOTO     PSU2L999
.
PSU2L105
          MOVE      CFDBCRHD,VAR     
          CALL      DISPITEM
          GOTO     PSU2L999
.
PSU2L106
          MOVE      CRHDDESC,VAR     
          CALL      DISPITEM
          GOTO     PSU2L999
.
PSU2L107
          MOVE      CFDBCRTL,VAR     
          CALL      DISPITEM
          GOTO     PSU2L999
.
PSU2L108
          MOVE      CRTLDESC,VAR     
          CALL      DISPITEM
          GOTO     PSU2L999
.
PSU2L109
          MOVE      CFDBSTHD,VAR     
          CALL      DISPITEM
          GOTO     PSU2L999
.
PSU2L110
          MOVE      STHDDESC,VAR     
          CALL      DISPITEM
          GOTO     PSU2L999
.
PSU2L111
          MOVE      CFDBSTTL,VAR     
          CALL      DISPITEM
          GOTO     PSU2L999
.
PSU2L112
          MOVE      STTLDESC,VAR     
          CALL      DISPITEM
          GOTO     PSU2L999
PSU2L999
          RETURN
.---------------------------------------------------------
. Selections for : User Defined Screen 2              
.---------------------------------------------------------
SFU2L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFU2L001  BRANCH   ACCEPT,SFU2L020
.
SFU2L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFU2L006,SFU2L101,SFU2L102,SFU2L103:
                            SFU2L006,SFU2L104,SFU2L006,SFU2L105:
                            SFU2L006,SFU2L106,SFU2L006,SFU2L107:
                            SFU2L006,SFU2L108,SFU2L006
SFU2L006  BEEP
          GOTO     SFU2L005
SFU2L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFU2L090
          MATCH    PRGID,SCSLPID
          GOTO     SFU2L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFU2L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFU2L020,SFU2L020,SFU2L020,SFU2L103:
                            SFU2L020,SFU2L104,SFU2L020,SFU2L105:
                            SFU2L020,SFU2L106,SFU2L020,SFU2L107:
                            SFU2L020,SFU2L108,SFU2L020
          GOTO     SFU2L020
SFU2L090  MOVE     ZERO,ACCEPT
          GOTO     SFU2L001
.
SFU2L101
          MOVE      ZERO,EXIT
          GOTO      SFU2L999
.
SFU2L102
          CALL      POSTU200
          MOVE      ZERO,EXIT
          GOTO      SFU2L999
.
SFU2L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,IVHDDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KIVHD000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU2L103
            ENDIF
            BRANCH    EXIT,SFU2L103,SFU2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFU2L990 IF EQUAL
          ENDIF
          MOVE      CFDBIVHD,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      IVHDDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFU2L001
.
SFU2L104
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,IVTLDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KIVTL000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU2L104
            ENDIF
            BRANCH    EXIT,SFU2L104,SFU2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFU2L990 IF EQUAL
          ENDIF
          MOVE      CFDBIVTL,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      IVTLDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFU2L001
.
SFU2L105
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CRHDDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCRHD000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU2L105
            ENDIF
            BRANCH    EXIT,SFU2L105,SFU2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFU2L990 IF EQUAL
          ENDIF
          MOVE      CFDBCRHD,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CRHDDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFU2L001
.
SFU2L106
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CRTLDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCRTL000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU2L106
            ENDIF
            BRANCH    EXIT,SFU2L106,SFU2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFU2L990 IF EQUAL
          ENDIF
          MOVE      CFDBCRTL,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CRTLDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFU2L001
.
SFU2L107
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,STHDDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSTHD000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU2L107
            ENDIF
            BRANCH    EXIT,SFU2L107,SFU2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFU2L990 IF EQUAL
          ENDIF
          MOVE      CFDBSTHD,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      STHDDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFU2L001
.
SFU2L108
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,STTLDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSTTL000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFU2L108
            ENDIF
            BRANCH    EXIT,SFU2L108,SFU2L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFU2L990 IF EQUAL
          ENDIF
          MOVE      CFDBSTTL,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      STTLDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SFU2L001
SFU2L990  MOVE      ONE,EXIT * Exit Char Restart
SFU2L999  RETURN
.@@@@@ Function Restart Point @@@@@
.-----------------------------------------
. Read in System IBA Screen 1
.-----------------------------------------
GETI1000  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,EIGHTY1;CFDBPASS,*20,CFDBIFL:
                                     *43,CFDBBLIN,CFDBBLST,*233,CFDBNDB:
                                     CFDBSDB,CFDBMAN,*243,CFDBILAY,CFDBSLAY
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      "GADGET  ",CFDBPASS
            MOVE      ZERO,CFDBNDB
            MOVE      ZERO,CFDBSDB
            MOVE      ZERO,CFDBMAN
            MOVE      ONE,CFDBILAY
            MOVE      ONE,CFDBSLAY
            WRITAB    CONTROLF,EIGHTY1;CFDBPASS,*20,CFDBIFL:
                                       *43,CFDBBLIN,CFDBBLST,*233,CFDBNDB:
                                       CFDBSDB,CFDBMAN,*243,CFDBILAY,CFDBSLAY
          ELSE
            GOTO    GETI1050
          ENDIF
.
          READ      CONTROLF,EIGHTY1;CFDBPASS,*20,CFDBIFL:
                                   *43,CFDBBLIN,CFDBBLST,*233,CFDBNDB:
                                   CFDBSDB,CFDBMAN,*243,CFDBILAY,CFDBSLAY
.
GETI1050  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,EIGHTY7;*26,CFDBINV,CFDBCRN,CFDBREC:
                                     *98,CFDBSTAN
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ONE,CFDBREC
            MOVE      ONE,CFDBINV
            MOVE      ONE,CFDBCRN
            MOVE      ONE,CFDBSTAN
            WRITAB    CONTROLF,EIGHTY7;*26,CFDBINV,CFDBCRN,CFDBREC:
                                       *98,CFDBSTAN
          ELSE
            GOTO    GETI1100
          ENDIF
.
          READ      CONTROLF,EIGHTY7;*26,CFDBINV,CFDBCRN,CFDBREC:
                                     *98,CFDBSTAN
.
GETI1100  CALL      PASS0000
          BRANCH    EXIT,GETI1999
.
          CALL      GDLAY000        * Get Description Layouts
.
          CALL      SCI1L000        * IBA Controlled Screen 1
.
GETI1999  RETURN
.
PASS0000  MOVE      SP70,KEY8
          KEYIN     *P1:24,*EL,*P20:24,"Enter Password : ",*EOFF,KEY8;
          PACK      KEY8,KEY8,SP30
          MATCH     KEY8,CFDBPASS
          GOTO      PASS9500 IF NOT EQUAL
.
          KEYIN     *EOFF,KEY8;
          SQUEEZE   KEY8
          MOVE      KEY8,AUDTSECT
.
          SUB       CDD,AUDTSECT
          SUB       CMM,AUDTSECT
          SUB       CYY,AUDTSECT
.
          COMPARE   ZERO,AUDTSECT
          GOTO      PASS9500 IF NOT EQUAL
.
PASS9000  MOVE      ZERO,EXIT
          GOTO      PASS9999
.
PASS9500  MOVE      ONE,EXIT
.
PASS9999  RETURN
.
.-----------------------------------------
. Read in System Audit Screen 1
.-----------------------------------------
GETA1000  READ      CONTROLF,EIGHTY1;*9,CFDBAUDA,CFDBAUDB,CFDBAUDC,CFDBAUDD:
                                        CFDBAUDE,CFDBAUDF,CFDBAUDG,CFDBAUDH:
                                        CFDBAUDI,CFDBAUDJ
          MOVE      ZERO,ACCEPT
          RETURN
.-----------------------------------------
. Save Audit Screen 1
.-----------------------------------------
POSTA100  WRITAB    CONTROLF,EIGHTY1;*9,CFDBAUDA,CFDBAUDB,CFDBAUDC,CFDBAUDD:
                                         CFDBAUDE,CFDBAUDF,CFDBAUDG,CFDBAUDH:
                                         CFDBAUDI,CFDBAUDJ
          RETURN
.-----------------------------------------
. Post in System IBA Screen 1
.-----------------------------------------
POSTI100  WRITAB    CONTROLF,EIGHTY1;CFDBPASS,*20,CFDBIFL:
                                     *43,CFDBBLIN,CFDBBLST,*233,CFDBNDB:
                                     CFDBSDB,CFDBMAN,*243,CFDBILAY,CFDBSLAY
          WRITAB    CONTROLF,EIGHTY7;*26,CFDBINV,CFDBCRN,CFDBREC:
                                     *98,CFDBSTAN
          RETURN
.
.--------------------------------------------------
. Input Invoice Layout
.--------------------------------------------------
KILAY000   CALL      DILAY000
.
KILAY001   KEYIN     *PCCOL:CVERT,*V2LON,*RV,CFDBILAY
           BRANCH    CFDBILAY,KILAY010,KILAY010,KILAY010,KILAY010,KILAY010:
                              KILAY010,KILAY010,KILAY010,KILAY010,KILAY010:
                              KILAY010,KILAY010
           BEEP
           GOTO      KILAY001
.
KILAY010   CALL      GDLAY000
KILAY999   CALL      PUTSCR00
           RETURN
.
DILAY000  MOVE      "10",HTOP
          MOVE      "55",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P60:11,*V2LON,*ULON,"Invoice Layout",*HOFF:
                    *P57:12,*V2LON," 1. ",*HOFF,"Standard":
                    *P57:13,*V2LON," 2. ",*HOFF,"Epworth":
                    *P57:14,*V2LON," 3. ",*HOFF,"Modbury":
                    *P57:15,*V2LON," 4. ",*HOFF,"Southland":
                    *P57:16,*V2LON," 5. ",*HOFF,"West Gippsland":
                    *P57:17,*V2LON," 6. ",*HOFF,"Coast Healthcare":
                    *P57:18,*V2LON," 7. ",*HOFF,"Hawkes Bay":
                    *P57:19,*V2LON," 8. ",*HOFF,"Holy Spirit":
                    *P57:20,*V2LON," 9. ",*HOFF,"West Wimmera":
                    *P57:21,*V2LON,"10. ",*HOFF,"Hutt Valley":
                    *P57:22,*V2LON,"11. ",*HOFF,"Ballarat Health":
                    *P57:23,*V2LON,"12. ",*HOFF,"Standard 132"
          RETURN
.
GDLAY000   BRANCH    CFDBILAY,GDLAY010,GDLAY020,GDLAY030,GDLAY040,GDLAY050:
                              GDLAY060,GDLAY070,GDLAY080,GDLAY090,GDLAY100:
                              GDLAY110,GDLAY120
GDLAY010   MOVE      "Standard",ILAYDESC
           GOTO      GDLAY500
GDLAY020   MOVE      "Epworth",ILAYDESC
           GOTO      GDLAY500
GDLAY030   MOVE      "Modbury",ILAYDESC
           GOTO      GDLAY500
GDLAY040   MOVE      "Southland",ILAYDESC
           GOTO      GDLAY500
GDLAY050   MOVE      "West Gippsland",ILAYDESC
           GOTO      GDLAY500
GDLAY060   MOVE      "Coast Health",ILAYDESC
           GOTO      GDLAY500
GDLAY070   MOVE      "Hawkes Bay",ILAYDESC
           GOTO      GDLAY500
GDLAY080   MOVE      "Holy Spirit",ILAYDESC
           GOTO      GDLAY500
GDLAY090   MOVE      "West Wimmera",ILAYDESC
           GOTO      GDLAY500
GDLAY100   MOVE      "Hutt Valley",ILAYDESC
           GOTO      GDLAY500
GDLAY110   MOVE      "Ballarat Health Services",ILAYDESC
           GOTO      GDLAY500
GDLAY120   MOVE      "Standard 132 Columns",ILAYDESC
           GOTO      GDLAY500
.
GDLAY500   BRANCH    CFDBSLAY,GDLAY510,GDLAY520,GDLAY530,GDLAY540,GDLAY550:
                              GDLAY560,GDLAY570,GDLAY580,GDLAY590,GDLAY600:
                              GDLAY610,GDLAY620,GDLAY630               *C-59741
GDLAY510   MOVE      "Standard",SLAYDESC
           GOTO      GDLAY999
GDLAY520   MOVE      "Epworth",SLAYDESC
           GOTO      GDLAY999
GDLAY530   MOVE      "Modbury",SLAYDESC
           GOTO      GDLAY999
GDLAY540   MOVE      "Southland",SLAYDESC
           GOTO      GDLAY999
GDLAY550   MOVE      "Coast Health",SLAYDESC
           GOTO      GDLAY999
GDLAY560   MOVE      "Hawkes Bay  ",SLAYDESC
           GOTO      GDLAY999
GDLAY570   MOVE      "Holy Spirit ",SLAYDESC
           GOTO      GDLAY999
GDLAY580   MOVE      "West Gippsland",SLAYDESC
           GOTO      GDLAY999
GDLAY590   MOVE      "West Wimmera",SLAYDESC
           GOTO      GDLAY999
GDLAY600   MOVE      "Hutt Valley",SLAYDESC
           GOTO      GDLAY999
GDLAY610   MOVE      "Ballarat Health Services",SLAYDESC
           GOTO      GDLAY999
GDLAY620   MOVE      "Standard 132 Columns",SLAYDESC
           GOTO      GDLAY999
GDLAY630   MOVE      "Mercy H & AC",SLAYDESC                           *I-59741
           GOTO      GDLAY999
.
GDLAY999   RETURN
.------------------------------------------------------------
. Input Statement Layout
.------------------------------------------------------------
KSLAY000   CALL      DSLAY000
.
KSLAY001   KEYIN     *PCCOL:CVERT,*V2LON,*RV,CFDBSLAY
           BRANCH    CFDBSLAY,KSLAY010,KSLAY010,KSLAY010,KSLAY010,KSLAY010:
                              KSLAY010,KSLAY010,KSLAY010,KSLAY010,KSLAY010:
                              KSLAY010,KSLAY010,KSLAY010               *C-59741
           BEEP
           GOTO      KSLAY001
.
KSLAY010   CALL      GDLAY000
KSLAY999   CALL      PUTSCR00
           RETURN
.
DSLAY000  MOVE      "9",HTOP                                           *C-59741
          MOVE      "55",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P60:10,*V2LON,*ULON,"Statement Layout",*HOFF:
                    *P57:11,*V2LON," 1. ",*HOFF,"Standard":
                    *P57:12,*V2LON," 2. ",*HOFF,"Epworth":
                    *P57:13,*V2LON," 3. ",*HOFF,"Modbury":
                    *P57:14,*V2LON," 4. ",*HOFF,"Southland":
                    *P57:15,*V2LON," 5. ",*HOFF,"Coast Healthcare":
                    *P57:16,*V2LON," 6. ",*HOFF,"Hawkes Bay":
                    *P57:17,*V2LON," 7. ",*HOFF,"Holy Spirit":
                    *P57:18,*V2LON," 8. ",*HOFF,"West Gippsland":
                    *P57:19,*V2LON," 9. ",*HOFF,"West Wimmera":
                    *P57:20,*V2LON,"10. ",*HOFF,"Hutt Valley":
                    *P57:21,*V2LON,"11. ",*HOFF,"Ballarat Health":
                    *P57:22,*V2LON,"12. ",*HOFF,"Standard 132 Columns":
                    *P57:23,*V2LON,"13. ",*HOFF,"Mercy H & AC"         *I-59741
          RETURN
.
.---------------------------------------------------------
. Enter Next Statement
.---------------------------------------------------------
ESTA0000  KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CFDBSTAN
          COMPARE   ONE,CFDBSTAN
          GOTO      ESTA0000 IF LESS
.
ESTA9999  RETURN
.
.-----------------------------------------
. Read in System User Def. Screen 1
.-----------------------------------------
GETU1000  READ      CONTROLF,EIGHTY1;CFDBPASS,*47,CFDBETEL,CFDBECON:
                                      CFDBSQLA,CFDBSQLB,CFDBFDAT,CFDBTDAT:
                                      CFDBSTYR,CFDBCNAM,CFDBCAD1,CFDBCAD2:
                                      CFDBCPOS
          READ      CONTROLF,EIGHTY1;*19,CFDBNFMT                      *I-75900
          READ      CONTROLF,EIGHTY7;CFDBLOCS,CFDBSTDS,CFDBIDDS,CFDBSOPT
.
          MOVE      CFDBLOCS,KEY8
          CALL      RDDBIT1
          MOVE      DBITDES,LOCSDESC
.
          MOVE      CFDBSTDS,KEY8
          CALL      RDDBIT1
          MOVE      DBITDES,STDSDESC
.
          MOVE      CFDBIDDS,KEY8
          CALL      RDDBIT1
          MOVE      DBITDES,IDDSDESC
.
.
GETU1500   BRANCH    CFDBNFMT,GETU1510,GETU1520
           MOVE      SP30,DESCPNAM
           GOTO      GETU1999
GETU1510   MOVE      "Title, GivenName, Surname",DESCPNAM
           GOTO      GETU1999
GETU1520   MOVE      "Surname, Title, GivenName",DESCPNAM
           GOTO      GETU1999
.
GETU1999  MOVE      ZERO,ACCEPT
          RETURN
DEFDAT00  MOVE     CCC,CCENT
          MOVE     CYY,CYEAR
          MOVE     "07",CMON
          MOVE     "01",CDAY
          REP      " 0",CCENT
          REP      " 0",CYEAR
          REP      " 0",CMON
          REP      " 0",CDAY
          RETURN
.-----------------------------------------
. Post in System User Def. Screen 1
.-----------------------------------------
POSTU100  REP       " 0",CFDBFDAT
          REP       " 0",CFDBTDAT
          WRITAB    CONTROLF,EIGHTY1;*47,CFDBETEL,CFDBECON,CFDBSQLA,CFDBSQLB:
                                          CFDBFDAT,CFDBTDAT,CFDBSTYR:
                                          CFDBCNAM,CFDBCAD1,CFDBCAD2,CFDBCPOS
          WRITAB    CONTROLF,EIGHTY1;*19,CFDBNFMT                      *I-75900
          WRITAB    CONTROLF,EIGHTY7;CFDBLOCS,CFDBSTDS,CFDBIDDS,CFDBSOPT
          RETURN
.------------------------------------------------------------
. Enter Processing Date Valid
.------------------------------------------------------------
RDAT0000  MOVE      "    7",FLDID
          CALL      GETPOSIT
          PACK      VAR,SP70,SP70
          CALL      DISPITEM
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
.
          REP       " 0",CFDBSTYR
          MATCH     "00000000",CFDBSTYR
          IF        @EQUAL
            MOVE      "01",CDAY
            MOVE      CMM,CMON
            MOVE      CYY,CYEAR
            MOVE      CCC,CCENT
            REP       " 0",CCENT
            REP       " 0",CYEAR
            REP       " 0",CMON
            REP       " 0",CDAY
          ELSE
            UNPACK    CFDBSTYR,CCENT,CYEAR,CMON,CDAY
          ENDIF
.
RDAT0100  CALL      KEYDATE
          BRANCH    OVRCD,RDAT0000
.
          MATCH     "00000000",CFDBSTYR
          GOTO      RDAT0200 IF EQUAL
.
          PACK      DIM8,CCENT,CYEAR,CMON,CDAY
          REP       " 0",DIM8
          MATCH     CFDBSTYR,DIM8
          GOTO      RDAT0900 IF LESS
.
RDAT0200  PACK      CFDBFDAT,CCENT,CYEAR,CMON,CDAY
          REP       " 0",CFDBFDAT
.
          CALL      PACDATE
          REP       " 0",CPCDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
.
          CALL      SMONT000                * pick last date of the month
.
RDAT0300  CALL      KEYDATE
          BRANCH    OVRCD,RDAT0000
.
          PACK      CFDBTDAT,CCENT,CYEAR,CMON,CDAY
          REP       " 0",CFDBTDAT
.
          MATCH     CFDBFDAT,CFDBTDAT
          GOTO      RDAT0910 IF LESS
.
          CALL      EOYDT000
          BRANCH    OVRCD,RDAT0400
.
          MATCH     CFDBTDAT,DIM8
          GOTO      RDAT0920 IF LESS
.
RDAT0400  UNPACK    CFDBTDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          REP       " 0",CPCDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO      RDAT9999
.
RDAT0900  UNPACK    CFDBSTYR,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
          CLEAR     DISPMSG
          APPEND    "From Date Must Be > Start Year Date ",DISPMSG
          APPEND    CPCDATE,DISPMSG
          APPEND    " - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          GOTO      RDAT0100
.
RDAT0910  MOVE      "To Date Must Be > From Date - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          GOTO      RDAT0000
.
RDAT0920  UNPACK    DIM8,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
          CLEAR     DISPMSG
          APPEND    "To Date Must Not Be > End Year Date ",DISPMSG
          APPEND    CPCDATE,DISPMSG
          APPEND    " - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          GOTO      RDAT0300
.
RDAT9999  MOVE      "    6",FLDID
          CALL      GETPOSIT
          RETURN
.------------------------------------------------------------
. Set default last date of the month
.------------------------------------------------------------
SMONT000  UNPACK    CFDBFDAT,CCENT,CYEAR,CMON
          MOVE      CMON,IMON
          BRANCH    IMON,SMONT310,SMONT280,SMONT310,SMONT300,SMONT310,SMONT300:
                         SMONT310,SMONT310,SMONT300,SMONT310,SMONT300,SMONT310
.
SMONT280  MOVE      "28",CDAY
          MOVE      CYEAR,IYEAR
          MOVE      CYEAR,CLYEAR
          DIVIDE    FOUR,CLYEAR
          MULT      FOUR,CLYEAR
          COMPARE   IYEAR,CLYEAR
          GOTO      SMONT999 IF NOT EQUAL
          MOVE      "29",CDAY
          GOTO      SMONT999
.
SMONT300  MOVE      "30",CDAY
          GOTO      SMONT999
.
SMONT310  MOVE      "31",CDAY
          GOTO      SMONT999
.
SMONT999  RETURN
.------------------------------------------------------------
. Find end of one year date
.------------------------------------------------------------
EOYDT000  MOVE      ONE,OVRCD
          MATCH     "00000000",CFDBSTYR
          GOTO      EOYDT999 IF EQUAL
.
          UNPACK    CFDBSTYR,DIM4,CMON,CDAY
          MOVE      DIM4,FORM4
          ADD       ONE,FORM4
          MOVE      FORM4,DIM4
          UNPACK    DIM4,CCENT,CYEAR
          MOVE      CMON,IMON
          MOVE      CDAY,IDAY
.
          SUB       ONE,IDAY
          IF        IDAY=0
            SUB       ONE,IMON
            IF        IMON=0
              MOVE      "12",IMON
              SUB       ONE,FORM4
              MOVE      FORM4,DIM4
              UNPACK    DIM4,CCENT,CYEAR
            ENDIF
          ELSE
            GOTO      EOYDT900
          ENDIF
.
          BRANCH    IMON,EOYDT310,EOYDT280,EOYDT310,EOYDT300,EOYDT310,EOYDT300:
                         EOYDT310,EOYDT310,EOYDT300,EOYDT310,EOYDT300,EOYDT310
.
EOYDT280  MOVE      "28",IDAY
          MOVE      CYEAR,IYEAR
          MOVE      CYEAR,CLYEAR
          DIVIDE    FOUR,CLYEAR
          MULT      FOUR,CLYEAR
          COMPARE   IYEAR,CLYEAR
          GOTO      EOYDT900 IF NOT EQUAL
          MOVE      "29",IDAY
          GOTO      EOYDT900
.
EOYDT300  MOVE      "30",IDAY
          GOTO      EOYDT900
.
EOYDT310  MOVE      "31",IDAY
          GOTO      EOYDT900
.
EOYDT900  MOVE      IDAY,CDAY
          MOVE      IMON,CMON
          PACK      DIM8,CCENT,CYEAR,CMON,CDAY
          REP       " 0",DIM8
          MOVE      ZERO,OVRCD
.
EOYDT999  RETURN
.
.------------------------------------------------------------
. Enter Date of starting year
.------------------------------------------------------------
STYR0000  MOVE      "01",CDAY
          MOVE      CMM,CMON
          MOVE      CYY,CYEAR
          MOVE      CCC,CCENT
          REP       " 0",CCENT
          REP       " 0",CYEAR
          REP       " 0",CMON
          REP       " 0",CDAY
          MOVE      "0",CKEYTYP
.
STYR0100  CALL      KEYDATE
          BRANCH    OVRCD,STYR0000
.
          PACK      DIM4,CCENT,CYEAR,SP70
          MATCH     "1999",DIM4
          GOTO      STYR9000 IF LESS
.
          PACK      CFDBSTYR,CCENT,CYEAR,CMON,CDAY
          REP       " 0",CFDBFDAT
          MOVE      ZERO,EXIT
          GOTO      STYR9999
.
STYR9000  MOVE      "Date Century is too far behind. - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          GOTO      STYR0100
.
STYR9999  RETURN
.-----------------------------------------
. Enter Sales Item for Local Calls
.-----------------------------------------
KLOCS000  MOVE      ZERO,CKEYTYP
          CALL      KDBITA00
          BRANCH    EXIT,KLOCS999,KLOCS999
          MOVE      DBITITM,CFDBLOCS
          MOVE      DBITDES,LOCSDESC
KLOCS999  RETURN
.-----------------------------------------
. Enter Sales Item for STD Calls
.-----------------------------------------
KSTDS000  MOVE      ZERO,CKEYTYP
          CALL      KDBITA00
          BRANCH    EXIT,KSTDS999,KSTDS999
          MOVE      DBITITM,CFDBSTDS
          MOVE      DBITDES,STDSDESC
KSTDS999  RETURN
.-----------------------------------------
. Enter Sales Item for IDD Calls
.-----------------------------------------
KIDDS000  MOVE      ZERO,CKEYTYP
          CALL      KDBITA00
          BRANCH    EXIT,KIDDS999,KIDDS999
          MOVE      DBITITM,CFDBIDDS
          MOVE      DBITDES,IDDSDESC
KIDDS999  RETURN
.---------------------------------------------------------
. Enter Patient Name Format
.---------------------------------------------------------
KPNAM000   CALL      DPNAM000
           MOVE      ZERO,CFDBNFMT
KPNAM010   KEYIN     *PCCOL:CVERT,*V2LON,*RV,CFDBNFMT
           BRANCH    CFDBNFMT,KPNAM100,KPNAM100
           BEEP
           GOTO      KPNAM010
.
KPNAM100   CALL      GPNAM000
.
KPNAM999   CALL      PUTSCR00
           RETURN
.
DPNAM000  MOVE      "20",HTOP
          MOVE      "45",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P50:21,*V2LON,*ULON,"Patient Name Format",*HOFF:
                    *P47:22,*V2LON,"1. ",*HOFF,"Title, GivenName, Surname":
                    *P47:23,*V2LON,"2. ",*HOFF,"Surname, Title, GivenName"
          RETURN
.
GPNAM000   BRANCH    CFDBNFMT,GPNAM100,GPNAM200
           MOVE      "INVALID",DESCPNAM
           GOTO      GPNAM999
.
GPNAM100   MOVE      "Title, GivenName, Surname",DESCPNAM
           GOTO      GPNAM999
.
GPNAM200   MOVE      "Surname, Title, GivenName",DESCPNAM
           GOTO      GPNAM999
.
GPNAM999   RETURN
.
.-----------------------------------------
. Read in System User Def. Screen 2
.-----------------------------------------
GETU2000  READ      CONTROLF,EIGHTY1;CFDBPASS
          READ      CONTROLF,EIGHTY7;*62,CFDBIVHD,CFDBIVTL,CFDBCRHD,CFDBCRTL:
                                          CFDBSTHD,CFDBSTTL
.
          PACK      IVHDDESC,SP70
          PACK      KEY6,CFDBIVHD,SP70
          CALL      RDIBTH1
          IF        OVRCD=0
            MOVE      IBTHDESC,IVHDDESC
          ENDIF
.
          PACK      IVTLDESC,SP70
          PACK      KEY6,CFDBIVTL,SP70
          CALL      RDIBTH1
          IF        OVRCD=0
            MOVE      IBTHDESC,IVTLDESC
          ENDIF
.
          PACK      CRHDDESC,SP70
          PACK      KEY6,CFDBCRHD,SP70
          CALL      RDIBTH1
          IF        OVRCD=0
            MOVE      IBTHDESC,CRHDDESC
          ENDIF
.
          PACK      CRTLDESC,SP70
          PACK      KEY6,CFDBCRTL,SP70
          CALL      RDIBTH1
          IF        OVRCD=0
            MOVE      IBTHDESC,CRTLDESC
          ENDIF
.
          PACK      STHDDESC,SP70
          PACK      KEY6,CFDBSTHD,SP70
          CALL      RDIBTH1
          IF        OVRCD=0
            MOVE      IBTHDESC,STHDDESC
          ENDIF
.
          PACK      STTLDESC,SP70
          PACK      KEY6,CFDBSTTL,SP70
          CALL      RDIBTH1
          IF        OVRCD=0
            MOVE      IBTHDESC,STTLDESC
          ENDIF
.
          MOVE      ZERO,ACCEPT
          RETURN
.-----------------------------------------
. Post in System User Def. Screen 2
.-----------------------------------------
POSTU200  WRITAB    CONTROLF,EIGHTY7;*62,CFDBIVHD,CFDBIVTL,CFDBCRHD,CFDBCRTL:
                                          CFDBSTHD,CFDBSTTL
          RETURN
.-----------------------------------------
. Enter Tax Invoice Template Header Code
.-----------------------------------------
KIVHD000  MOVE      ZERO,CKEYTYP
          PACK      IBTHSCOD,SP70
          PACK      IBTHDESC,SP70
          CALL      KIBTHA00
          BRANCH    EXIT,KIVHD980,KIVHD999
.
          COMPARE   TEN3,IBTHSTFM
          GOTO      KIVHD900 IF NOT EQUAL
.
          MOVE      IBTHSCOD,CFDBIVHD
          MOVE      IBTHDESC,IVHDDESC
          GOTO      KIVHD999
.
KIVHD900  BEEP
          MOVE      "Stationery Code is an Invalid Type. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KIVHD000
.
KIVHD980  MOVE      SP70,CFDBIVHD
          MOVE      SP70,IVHDDESC
          GOTO      KIVHD999
.
KIVHD999  RETURN
.-----------------------------------------
. Enter Tax Invoice Template Tail Code
.-----------------------------------------
KIVTL000  MOVE      ZERO,CKEYTYP
          PACK      IBTHSCOD,SP70
          PACK      IBTHDESC,SP70
          CALL      KIBTHA00
          BRANCH    EXIT,KIVTL980,KIVTL999
.
          COMPARE   TEN4,IBTHSTFM
          GOTO      KIVTL900 IF NOT EQUAL
.
          MOVE      IBTHSCOD,CFDBIVTL
          MOVE      IBTHDESC,IVTLDESC
          GOTO      KIVTL999
.
KIVTL900  BEEP
          MOVE      "Stationery Code is an Invalid Type. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KIVTL000
.
KIVTL980  MOVE      SP70,CFDBIVTL
          MOVE      SP70,IVTLDESC
          GOTO      KIVTL999
.
KIVTL999  RETURN
.-----------------------------------------
. Enter Tax Credit Note Template Header Code
.-----------------------------------------
KCRHD000  MOVE      ZERO,CKEYTYP
          PACK      IBTHSCOD,SP70
          PACK      IBTHDESC,SP70
          CALL      KIBTHA00
          BRANCH    EXIT,KCRHD980,KCRHD999
.
          COMPARE   TEN3,IBTHSTFM
          GOTO      KCRHD900 IF NOT EQUAL
.
          MOVE      IBTHSCOD,CFDBCRHD
          MOVE      IBTHDESC,CRHDDESC
          GOTO      KCRHD999
.
KCRHD900  BEEP
          MOVE      "Stationery Code is an Invalid Type. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KCRHD000
.
KCRHD980  MOVE      SP70,CFDBCRHD
          MOVE      SP70,CRHDDESC
          GOTO      KCRHD999
.
KCRHD999  RETURN
.-----------------------------------------
. Enter Tax Credit Note Template Tail Code
.-----------------------------------------
KCRTL000  MOVE      ZERO,CKEYTYP
          PACK      IBTHSCOD,SP70
          PACK      IBTHDESC,SP70
          CALL      KIBTHA00
          BRANCH    EXIT,KCRTL980,KCRTL999
.
          COMPARE   TEN4,IBTHSTFM
          GOTO      KCRTL900 IF NOT EQUAL
.
          MOVE      IBTHSCOD,CFDBCRTL
          MOVE      IBTHDESC,CRTLDESC
          GOTO      KCRTL999
.
KCRTL900  BEEP
          MOVE      "Stationery Code is an Invalid Type. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KCRTL000
.
KCRTL980  MOVE      SP70,CFDBCRTL
          MOVE      SP70,CRTLDESC
          GOTO      KCRTL999
.
KCRTL999  RETURN
.-----------------------------------------
. Enter Tax Statement Template Header Code
.-----------------------------------------
KSTHD000  MOVE      ZERO,CKEYTYP
          PACK      IBTHSCOD,SP70
          PACK      IBTHDESC,SP70
          CALL      KIBTHA00
          BRANCH    EXIT,KSTHD980,KSTHD999
.
          COMPARE   TEN3,IBTHSTFM
          GOTO      KSTHD900 IF NOT EQUAL
.
          MOVE      IBTHSCOD,CFDBSTHD
          MOVE      IBTHDESC,STHDDESC
          GOTO      KSTHD999
.
KSTHD900  BEEP
          MOVE      "Stationery Code is an Invalid Type. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KSTHD000
.
KSTHD980  MOVE      SP70,CFDBSTHD
          MOVE      SP70,STHDDESC
          GOTO      KSTHD999
.
KSTHD999  RETURN
.-----------------------------------------
. Enter Tax Statement Template Tail Code
.-----------------------------------------
KSTTL000  MOVE      ZERO,CKEYTYP
          PACK      IBTHSCOD,SP70
          PACK      IBTHDESC,SP70
          CALL      KIBTHA00
          BRANCH    EXIT,KSTTL980,KSTTL999
.
          COMPARE   TEN4,IBTHSTFM
          GOTO      KSTTL900 IF NOT EQUAL
.
          MOVE      IBTHSCOD,CFDBSTTL
          MOVE      IBTHDESC,STTLDESC
          GOTO      KSTTL999
.
KSTTL900  BEEP
          MOVE      "Stationery Code is an Invalid Type. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KSTTL000
.
KSTTL980  MOVE      SP70,CFDBSTTL
          MOVE      SP70,STTLDESC
          GOTO      KSTTL999
.
KSTTL999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       DEBITMIO/INC
          INC       DEBITMKY    
          INC       DEBPTYIO/INC
          INC       IBATMHIO/INC
          INC       IBATMHKY    
.
          INC       STDGENCD
.
