.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.00.02  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
. VF.00.01  20.12.1999 Charles Handaya
.           Fix Y2K of Audit Files Date (CCYYMMDD)
. V6.00.02  19.05.1994 Ross Hodson
.           Correct display of purchase order.
.           srf 124393
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBAAMS24
.   Function      :   Asset Location Enquiries                
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       AMSACMFD/INC
          INC       AMSCODFD/INC
          INC       AMSDEPFD/INC
          INC       AMSGILFD/INC
          INC       AMSINSFD/INC
          INC       AMSLEAFD/INC
          INC       AMSLOCFD/INC
          INC       AMSMASFD/INC
          INC       AMSREGFD/INC
          INC       APSMASFD/INC
.=========================
.Local Variable Definition
.-------------------------
BLDDESC   DIM      35 * Scr 00 Fld    10
.
.    Multi Item Key Fields Scr 00 Fld    11
.-------------------------------------------------------
AMMA2NAM  INIT      "AMMA2"
AMMA2END  FORM      1   * End Display
AMMA2SNO  FORM      5   * Number of Items on the Screen
AMMA2MKY  DIM       127 * Match Key 
AMMA2EKY  DIM       127 * End Key
AMMA2SKY  DIM       127 * Start Key
AMMA2IDX  INIT      " 132 UC1-5"
AMMA2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
AMMA2FNM  DIM       8  * Filename
AMMA2CNT  FORM      3  * Number of Items on Screen
TYPDESC   DIM      35 * Scr 00 Fld    15
DPTDESC   DIM      35 * Scr 00 Fld    22
SOFDESC   DIM      35 * Scr 00 Fld    23
ADTDESC   DIM      35 * Scr AD Fld    18
ACCOPEN   FORM     12.2 * Scr AD Fld    19
TDTDESC   DIM      35 * Scr AD Fld    21
TAXOPEN   FORM     12.2 * Scr AD Fld    22
.
.Word Processor File * Scr AD Fld    57
.
NAMAMAC1  INIT      "Wamac1"
FILAMAC1  DIM       8
.
UC1DESC   DIM      35 * Scr AD Fld    64
UC2DESC   DIM      35 * Scr AD Fld    65
UC3DESC   DIM      35 * Scr AD Fld    66
UC4DESC   DIM      35 * Scr AD Fld    67
PMTDESC   DIM      35 * Scr AD Fld   103
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBAAMS24"
PRGNAM    INIT      "Asset Location Enquiries                "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CLOSE     AMMA2FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAMAC1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening amsacmaf";
          OPEN      AMSACMA1,"amsacmaf"
          MOVE      "    3",AUDTSECT
          MOVE      " 12",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening amsaudin";
            OPEN      AMSAUDIN,"amsaudin"
          ENDIF
          MOVE      "    3",AUDTSECT
          MOVE      " 11",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening amsaudle";
            OPEN      AMSAUDLE,"amsaudle"
          ENDIF
          MOVE      "    3",AUDTSECT
          MOVE      " 10",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening amsaudma";
            OPEN      AMSAUDMA,"amsaudma"
          ENDIF
          DISPLAY   *P56:24,"Opening amscodaf";
          OPEN      AMSCODA1,"amscodaf"
          DISPLAY   *P56:24,"Opening amscodaf";
          OPEN      AMSCODA2,"amscodaf"
          DISPLAY   *P56:24,"Opening amsdepaf";
          OPEN      AMSDEPA1,"amsdepaf"
          DISPLAY   *P56:24,"Opening amsgilaf";
          OPEN      AMSGILA1,"amsgilaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA1,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA2,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA3,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA4,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA1,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA2,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA3,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA4,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA5,"amsleaaf"
          DISPLAY   *P56:24,"Opening amslocaf";
          OPEN      AMSLOCA1,"amslocaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA1,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA2,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA3,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA4,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA5,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA6,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA7,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA8,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsregaf";
          OPEN      AMSREGA1,"amsregaf"
          MOVE      "   51",AUDTSECT
          MOVE      " 48",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening apsaudma";
            OPEN      APSAUDMA,"apsaudma"
          ENDIF
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
.--------------------------------------------------------
. Initialise Batch Screen Register                           
.--------------------------------------------------------
          MOVE     ZERO,AMMA2SNO
          MOVE     "00   11",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,AMMA2SNO
            ENDIF
          ENDIF
          PACK      AMMA2FNM,ANST,AMMA2NAM,PORT
          REP       " 0",AMMA2FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      AMMA2FL1,AMMA2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     AMMA2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,AMMA2FNM,AMMA2IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",AMMA2FNM;
          EXECUTE   KEY80,TASKID
          OPEN      AMMA2FL1,AMMA2FNM
.--------------------------------------------------------
. Initialise Wp Filename for Asset Comments                     
.--------------------------------------------------------
          PACK      FILAMAC1,NAMAMAC1,PORT
          REP       " 0",FILAMAC1
          DISPLAY   *P56:24,"Create & Open ",FILAMAC1;
          PREP      TEMPWORD,FILAMAC1
.
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Asset Location Enquiries           
          ENDIF
          MATCH     "AD",SCRID
          IF         @EQUAL
            CALL       PSADL000   * Asset Details Display              
          ENDIF
          RETURN
.--------------------------------
. Screen - Asset Location Enquiries           
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Asset Location Enquiries           
.-------------------------------------------------------
CF00L000
          MOVE      SP70,AMLOBLD 
          MOVE      SP70,AMLOLOC 
          MOVE      SP70,AMLODES 
          MOVE      SP70,AMLOUR1 
          MOVE      SP70,AMLOUR2 
          MOVE      SP70,AMLOUD1 
          MOVE      SP70,AMLOUD2 
          MOVE      SP70,AMLOUY1 
          MOVE      SP70,AMLOUY2 
          MOVE      SP70,BLDDESC 
          MOVE      SP70,AMMAREG 
          MOVE      SP70,AMMAASS 
          MOVE      SP70,AMMADES 
          MOVE      SP70,AMMATYP 
          MOVE      SP70,TYPDESC 
          MOVE      SP70,AMMADPT 
          MOVE      SP70,AMMALCM 
          MOVE      SP70,AMMASDT 
          MOVE      SP70,AMMAVDT 
          MOVE      SP70,AMMAAQD 
          MOVE      SP70,AMMASOF 
          MOVE      SP70,DPTDESC 
          MOVE      SP70,SOFDESC 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Asset Location Enquiries           
.--------------------------------------------------------
KY00L000
.
KY00L110
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,BLDDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KBLD0000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      AMLOBLD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      BLDDESC,VAR      
            CALL      DISPITEM
          ENDIF
.
KY00L120
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ELOC0000
          BRANCH    EXIT,KY00L110,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      AMLOLOC,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Asset Location Enquiries           
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Asset Location Enquiries           
.---------------------------------------------------------
LM00L000
.---------------------------------------------------------
. Load for :    11 Register                           
.---------------------------------------------------------
          UNPACK    SP70,AMMABLD,AMMALOC,AMMAREG,AMMAASS
          PACK      KEY23,AMLOBLD,AMLOLOC,SP70
          MOVE      KEY23,AMMA2EKY
          STRIP     AMMA2SKY
          SETLPTR   AMMA2EKY,9
          MOVE      AMMA2EKY,AMMA2SKY
          CALL      RDAMMA2 
          IF        OVRCD=0
            CALL      RPAMMA2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP00L000
          MOVE     ZERO,AMMA2CNT
          MOVE     ZERO,AMMA2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP00L600
          MATCH    PRGID,SCPSPID
          GOTO     DP00L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP00L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP00L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L101,DP00L102:
                            DP00L103,DP00L104,DP00L105,DP00L106:
                            DP00L107,DP00L108,DP00L109,DP00L110:
                            DP00L111,DP00L112,DP00L113,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010
          GOTO      DP00L010
.
DP00L101
          PACK      AMMA2MKY,SP70,SP70
          CALL      UPTAMMA2
          IF        AMMA2END=0
            CALL      RKAMMA2 
            IF        OVRCD=0
              PACK      AMMA2MKY,AMMABLD,AMMALOC,AMMAREG,AMMAASS                                                
              MATCH     AMMA2EKY,AMMA2MKY
              IF        @EQUAL
                MOVE      ZERO,AMMA2END
                ADD       ONE,AMMA2CNT
                CALL      UPTAMMA2
                MOVE      AMMAREG,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,AMMA2END
              ENDIF
            ELSE
              MOVE      ONE,AMMA2END
            ENDIF
          ENDIF
          IF        AMMA2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L102
          IF        AMMA2END=0
            MOVE      AMMAASS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L103
          IF        AMMA2END=0
            MOVE      AMMADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L104
          IF        AMMA2END=0
            MOVE      AMMATYP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L105
          IF        AMMA2END=0
            MOVE      TYPDESC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L106
          IF        AMMA2END=0
            MOVE      AMMADPT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L107
          IF        AMMA2END=0
            MOVE      AMMALCM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L108
          IF        AMMA2END=0
            UNPACK    AMMASDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L109
          IF        AMMA2END=0
            UNPACK    AMMAVDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L110
          IF        AMMA2END=0
            UNPACK    AMMAAQD,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L111
          IF        AMMA2END=0
            UNPACK    AMMASOF,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L112
          IF        AMMA2END=0
            MOVE      DPTDESC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L113
          IF        AMMA2END=0
            MOVE      SOFDESC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
DP00L600
          MATCH    "AMMA2",NAMSSFFI
          GOTO     DP00L605 IF NOT EQUAL
          GOTO     DP00L999
DP00L605
DP00L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP00L000
.
          MATCH    "AMMA2",NAMSSFFI
          GOTO     FP00L105 IF NOT EQUAL
          PACK     KEY23,AMMA2SKY,SP70
          CALL     RDAMMA2  * Start
          IF       OVRCD=0
            CALL     RPAMMA2  * Start
          ENDIF
          CALL     DP00L000
          GOTO     FP00L999
FP00L105
FP00L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP00L000
.
          MATCH    "AMMA2",NAMSSFFI
          GOTO     LP00L105 IF NOT EQUAL
          PACK     KEY23,AMMA2SKY,Z70
          CALL     RSAMMA2  * End
          IF       OVRCD=1
            CALL     RPAMMA2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<AMMA2SNO
            CALL     RPAMMA2 
            IF       OVRCD=1
              MOVE     AMMA2SNO,SECTOR
            ENDIF
            PACK     AMMA2MKY,AMMABLD,AMMALOC,AMMAREG,AMMAASS                                                
            MATCH    AMMA2EKY,AMMA2MKY
            IF       !@EQUAL
              MOVE     AMMA2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP00L000
          GOTO     LP00L999
LP00L105
LP00L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP00L000
.
          MATCH    "AMMA2",NAMSSFFI
          GOTO     PP00L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP00L105
          CALL      RFTAMMA2
          BRANCH   OVRCD,PP00L115
          MOVE      AMMA2MKY,KEY23 
          CALL      RSAMMA2 
PP00L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=AMMA2SNO
            CALL     RPAMMA2 
            IF       OVRCD=1
              MOVE     AMMA2SNO,SECTOR
            ENDIF
            PACK     AMMA2MKY,AMMABLD,AMMALOC,AMMAREG,AMMAASS                                                
            MATCH    AMMA2EKY,AMMA2MKY
            IF       !@EQUAL
              MOVE     AMMA2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP00L000
          GOTO     PP00L999
PP00L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<AMMA2SNO
            CALL     RKAMMA2 
            IF       OVRCD=1
              MOVE     AMMA2SNO,SECTOR
            ENDIF
            PACK     AMMA2MKY,AMMABLD,AMMALOC,AMMAREG,AMMAASS                                                
            MATCH    AMMA2EKY,AMMA2MKY
            IF       !@EQUAL
              MOVE     AMMA2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP00L999
PP00L120
PP00L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP00L000
          MATCH    "AMMA2",NAMSSFFI
          GOTO     NP00L115 IF NOT EQUAL
NP00L105
          CALL     RKAMMA2 
          BRANCH   OVRCD,NP00L110
          PACK     AMMA2MKY,AMMABLD,AMMALOC,AMMAREG,AMMAASS                                                
          MATCH    AMMA2EKY,AMMA2MKY
          GOTO     NP00L110 IF NOT EQUAL
          CALL     RPAMMA2 
          CALL     DP00L000
          GOTO     NP00L999
NP00L110
          CALL     RPAMMA2 
          BEEP
          GOTO     NP00L999
NP00L115
NP00L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT00L000
CT00L105
CT00L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Asset Location Enquiries           
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    11 Register                           
.---------------------------------------------------------
UPTAMMA2
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      AMMA2FL1,KEY5;ANS
          IF        @OVER
            WRITE     AMMA2FL1,KEY5;SCPSROW,SCPSCOL,AMMA2MKY
          ELSE
            UPDATE    AMMA2FL1;SCPSROW,SCPSCOL,AMMA2MKY
          ENDIF
          RETURN
RDTAMMA2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      AMMA2FL1,KEY5;SCPSROW,SCPSCOL,AMMA2MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTAMMA2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      AMMA2FL1,KEY5;;
          READKS    AMMA2FL1;SCPSROW,SCPSCOL,AMMA2MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,AMMA2MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Asset Location Enquiries           
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
          MOVE      "AMMA2",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      FP00L000
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Asset Location Enquiries           
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L101,PS00L102:
                            PS00L103,PS00L104,PS00L105,PS00L106:
                            PS00L107,PS00L108,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999
          GOTO     PS00L999
.
PS00L101
          CALL      CHKLOC00
          MOVE      AMLODES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      AMLOUR1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      AMLOUR2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          UNPACK    AMLOUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          UNPACK    AMLOUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMLOUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMLOUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      BLDDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Asset Location Enquiries           
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L101,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L102:
                            SF00L103,SF00L104,SF00L105,SF00L006:
                            SF00L106,SF00L107
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L101,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          MOVE      "AMMA2",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      FP00L000
          GOTO     SF00L001
.
SF00L101
          CALL      SELECTED
          BRANCH    EXIT,SF00L001
          COMPARE   ONE,ACCEPT
          GOTO      SF00L001 IF EQUAL
          CALL      RDTAMMA2
          IF        OVRCD=1
            BEEP
            GOTO      SF00L001
          ENDIF
          MATCH     SP70,AMMA2MKY
          IF        @EQUAL
            BEEP
            GOTO      SF00L001
          ENDIF
          MOVE      AMMA2MKY,KEY23 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELASS00
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTAMMA2
          IF        OVRCD=1
            CALL      FP00L000
          ELSE
            MOVE      AMMA2MKY,KEY23 
            CALL      RSAMMA2 
            CALL      RPAMMA2 
            CALL      DP00L000
          ENDIF
          GOTO     SF00L001
.
SF00L102
          MOVE      "AMMA2",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      NP00L000
          GOTO     SF00L001
.
SF00L103
          MOVE      "AMMA2",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      PP00L000
          GOTO     SF00L001
.
SF00L104
          MOVE      "AMMA2",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      FP00L000
          GOTO     SF00L001
.
SF00L105
          MOVE      "AMMA2",NAMSSFFI
          MOVE      "   11",ITMSSFFI
          CALL      LP00L000
          GOTO     SF00L001
.
SF00L106
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L107
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Asset Details Display              
.--------------------------------
SCADL000
SCADL100
          MOVE      "AD",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   69",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCADL200
          CALL      CFADL000 * Clear Fields
SCADL300
          CALL      KYADL000 * Enter Key Fields
          BRANCH    EXIT,SCADL999,SCADL999
SCADL400
          CALL      WPADL000 * Load any WP Details
SCADL500
          CALL      LMADL000 * Load any Batch Details
SCADL600
          CALL      DFADL000 * Display Fields
SCADL700
          CALL      SFADL000 * Select Fields
          BRANCH    EXIT,SCADL100,SCADL100,SCADL200
SCADL800
SCADL900
SCADL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Asset Details Display              
.-------------------------------------------------------
CFADL000
CFADL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Asset Details Display              
.--------------------------------------------------------
KYADL000
          MOVE      ZERO,EXIT
          GOTO      KYADL999
.
KYADL900  MOVE      ONE,EXIT
KYADL999  RETURN
.---------------------------------------------------------
. Load WP files for : Asset Details Display              
.---------------------------------------------------------
WPADL000
          PREP     TEMPWORD,FILAMAC1
          PACK     KEY17,AMMAREG,AMMAASS,SP70
          MOVE     KEY17,SAVKEY80
          SETLPTR  SAVKEY80,14
          CALL      RDAMAC1 
          IF        OVRCD=0
            CALL      RPAMAC1 
          ENDIF
WPADL100
          CALL     RKAMAC1 
          BRANCH   OVRCD,WPADL105
          PACK     KEY17,AMACREG,AMACASS,AMACLIN
          MATCH    SAVKEY80,KEY17   
          GOTO     WPADL105 IF NOT EQUAL
          PACK     VAR,AMACCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     AMACCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WPADL100
WPADL105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Asset Details Display              
.---------------------------------------------------------
LMADL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Asset Details Display              
.---------------------------------------------------------
DFADL000
          BRANCH   ACCEPT,DFADL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFADL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFADL900
          MATCH    PRGID,SCPSPID
          GOTO     DFADL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFADL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFADL010 IF NOT EQUAL
.
          CALL     PSADL000 * Display Field
          GOTO     DFADL010
DFADL900
DFADL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Asset Details Display              
.---------------------------------------------------------
PSADL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSADL101,PSADL102,PSADL103,PSADL104:
                            PSADL105,PSADL106,PSADL107,PSADL108:
                            PSADL109,PSADL110,PSADL111,PSADL112:
                            PSADL113,PSADL114,PSADL115,PSADL999:
                           PSADL116,PSADL117,PSADL118,PSADL119:
                            PSADL120,PSADL121,PSADL122,PSADL123:
                            PSADL124,PSADL125,PSADL126,PSADL127:
                            PSADL128,PSADL129,PSADL130,PSADL131:
                            PSADL132,PSADL133,PSADL134,PSADL135:
                            PSADL136,PSADL137,PSADL138,PSADL139:
                            PSADL140,PSADL141,PSADL142,PSADL143:
                            PSADL144,PSADL145,PSADL146,PSADL147:
                            PSADL148,PSADL149,PSADL150,PSADL151:
                            PSADL152,PSADL153,PSADL154,PSADL155:
                            PSADL156,PSADL157,PSADL158,PSADL159:
                            PSADL160,PSADL161,PSADL162,PSADL163:
                            PSADL164,PSADL165,PSADL166,PSADL167:
                            PSADL999,PSADL999,PSADL168,PSADL169:
                            PSADL170,PSADL171,PSADL172,PSADL173:
                            PSADL174,PSADL175,PSADL176,PSADL177:
                            PSADL178,PSADL179,PSADL180,PSADL181:
                            PSADL182,PSADL183,PSADL184,PSADL185:
                            PSADL186,PSADL187,PSADL188,PSADL189:
                            PSADL190,PSADL191,PSADL192,PSADL193:
                            PSADL194,PSADL195,PSADL196,PSADL197:
                            PSADL198,PSADL199,PSADL200,PSADL201
          GOTO     PSADL999
.
PSADL101
          MOVE      AMMAREG,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL102
          MOVE      AMMAASS,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL103
          MOVE      AMMADES,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL104
          MOVE      AMREDES,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL105
          MOVE      AMMADPT,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL106
          MOVE      AMMABLD,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL107
          MOVE      AMMALOC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL108
          MOVE      AMMALCM,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMASEC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMALEA,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAREN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL112
          MOVE      AMMAPRI,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL113
          UNPACK    AMMARDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL114
          MOVE      AMMATAD,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL115
          MOVE      AMMAAAD,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL116
          MOVE      AMMAADT,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL117
          MOVE      ADTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL118
          MOVE      ACCOPEN,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL119
          MOVE      AMMATDT,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL120
          MOVE      TDTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL121
          MOVE      TAXOPEN,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL122
          MOVE      AMMAGIC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL123
          UNPACK    AMMAAQD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL124
          MOVE      AMMASOF,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL125
          UNPACK    AMMADDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL126
          MOVE      AMMAAQO,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL127
          MOVE      AMMAAQI,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL128
          MOVE      AMMASER,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL129
          MOVE      AMMACST,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL130
          MOVE      AMMAMANC,VAR     
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL131
          MOVE      AMMAMANN,VAR     
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL132
          MOVE      AMMAMANP,VAR     
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL133
          MOVE      AMMASUPC,VAR     
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL134
          MOVE      AMMASUPN,VAR     
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL135
          MOVE      AMMASUPP,VAR     
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL136
          MOVE      AMMAUA1,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL137
          MOVE      AMMAUA2,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL138
          MOVE      AMMAUA3,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL139
          MOVE      AMMARVR,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL140
          MOVE      AMMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL141
          MOVE      AMMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL142
          MOVE      AMMAUR3,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL143
          MOVE      AMMAUR4,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL144
          UNPACK    AMMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL145
          UNPACK    AMMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL146
          UNPACK    AMMAUD3,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL147
          UNPACK    AMMAUD4,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL148
          MOVE      AMMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL149
          MOVE      AMMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL150
          MOVE      AMMAUC3,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL151
          MOVE      AMMAUC4,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL152
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL153
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL154
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL155
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY4,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL156
          MOVE     FILAMAC1,WORDNAME
          CALL     DISPWORD
          GOTO     PSADL999
.
PSADL157
          MOVE      AMMATYP,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL158
          MOVE      TYPDESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL159
          MOVE      DPTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL160
          MOVE      BLDDESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL161
          MOVE      AMLODES,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL162
          MOVE      SOFDESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL163
          MOVE      UC1DESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL164
          MOVE      UC2DESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL165
          MOVE      UC3DESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL166
          MOVE      UC4DESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL167
          MOVE      AMGIDES,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL168
          MOVE      AMINCOM,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL169
          MOVE      AMINCOD,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL170
          MOVE      AMINREF,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL171
          MOVE      AMINCON,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL172
          UNPACK    AMINDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL173
          MOVE      AMINVAL,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL174
          MOVE      AMINAPR,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL175
          MOVE      AMINUA1,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL176
          MOVE      AMINUA2,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL177
          MOVE      AMINUR1,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL178
          MOVE      AMINUR2,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL179
          UNPACK    AMINUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL180
          UNPACK    AMINUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL181
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMINUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL182
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMINUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL183
          MOVE      AMLECOM,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL184
          MOVE      AMLECNM,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL185
          MOVE      AMLEREF,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL186
          MOVE      AMLECON,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL187
          UNPACK    AMLEDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL188
          MOVE      AMLEPER,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL189
          MOVE      AMLEINS,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL190
          MOVE      AMLEPMT,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL191
          MOVE      AMLERES,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL192
          MOVE      AMLEUA1,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL193
          MOVE      AMLEUA2,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL194
          MOVE      AMLEUR1,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL195
          MOVE      AMLEUR2,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL196
          UNPACK    AMLEUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL197
          UNPACK    AMLEUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL198
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMLEUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL199
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMLEUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL200
          MOVE      PMTDESC,VAR      
          CALL      DISPITEM
          GOTO     PSADL999
.
PSADL201
          UNPACK    AMLEEDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSADL999
PSADL999
          RETURN
.---------------------------------------------------------
. Selections for : Asset Details Display              
.---------------------------------------------------------
SFADL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFADL001  BRANCH   ACCEPT,SFADL020
.
SFADL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                           SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL101,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL102,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006:
                            SFADL006,SFADL006,SFADL006,SFADL006
SFADL006  BEEP
          GOTO     SFADL005
SFADL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFADL090
          MATCH    PRGID,SCSLPID
          GOTO     SFADL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFADL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                           SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL101,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020:
                            SFADL020,SFADL020,SFADL020,SFADL020
          GOTO     SFADL020
SFADL090  MOVE     ZERO,ACCEPT
          GOTO     SFADL001
.
SFADL101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "10",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "10",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAMAC1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAMAC1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SFADL001
.
SFADL102
          MOVE      ZERO,EXIT
          GOTO      SFADL999
SFADL990  MOVE      ONE,EXIT * Exit Char Restart
SFADL999  RETURN
.@@@@@ Function Restart Point @@@@@
CHKLOC00  MATCH    SP70,AMLOLOC
          IF       @EQUAL
            SETLPTR   AMMA2EKY,3
            MOVE      "All Locations",AMLODES
          ENDIF
          RETURN
.---------------------------------
. Setup Category and Enter Code
.---------------------------------
KBLD0000  MOVE    ZERO,CKEYTYP
          MOVE    "BL",AMCDCAT
          CALL    KAMCDA00
          BRANCH  EXIT,KBLD9999,KBLD9999
          MOVE    AMCDCOD,AMLOBLD
          MOVE    AMCDDES,BLDDESC
KBLD9999  RETURN
ELOC0000  MOVE     ZERO,CKEYTYP
          CALL     KAMLOA00
          BRANCH   EXIT,ELOC9000,ELOC9999
          GOTO     ELOC9999
ELOC9000  MOVE     ZERO,EXIT
          MOVE     SP70,AMLOLOC
          MOVE     SP70,AMLODES
ELOC9999  RETURN
.---------------------------------------
. Display Selected Asset Details
.---------------------------------------
SELASS00  UNPACK   AMMA2MKY,AMMABLD,AMMALOC,AMMAREG,AMMAASS
          PACK     KEY2,AMMAREG
          CALL     RDAMRE1
          PACK     KEY14,AMMAREG,AMMAASS
          CALL     RDAMMA1
          CALL     RDAMLE1
          CALL     RDAMIN1
          CALL     GASST000
.
          ASSIGN    AMMACST+AMMARVT-AMMATAD,TAXOPEN
          ASSIGN    AMMACST+AMMARVT-AMMAAAD,ACCOPEN
.
          CALL     SCADL000
.
          RETURN
.
GASST000  MOVE      SP70,DPTDESC
          MATCH     SP70,AMMADPT
          IF        !@EQUAL
            MOVE      "DP",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMADPT
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,DPTDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,BLDDESC
          MATCH     SP70,AMMABLD
          IF        !@EQUAL
            MOVE      "BL",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMABLD
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,BLDDESC
            ENDIF
            PACK      KEY9,AMMABLD,AMMALOC
            CALL      RDAMLO1
          ENDIF
.
          MATCH     SP70,AMMASUPC
          IF        !@EQUAL
            MOVE      AMMASUPC,KEY5
            CALL      RDAPMA1
            IF        OVRCD=0
              MOVE      APMASN1,AMMASUPN
            ENDIF
          ENDIF
.
          MATCH     SP70,AMMAMANC
          IF        !@EQUAL
            MOVE      AMMAMANC,KEY5
            CALL      RDAPMA1
            IF        OVRCD=0
              MOVE      APMASN1,AMMAMANN
            ENDIF
          ENDIF
.
          MATCH     SP70,AMMAGIC
          IF        !@EQUAL
            MOVE      AMMAGIC,KEY5
            CALL      RDAMGI1
          ENDIF
.
          MOVE      SP70,SOFDESC
          MATCH     SP70,AMMASOF
          IF        !@EQUAL
            MOVE      "SF",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMASOF
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,SOFDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC1DESC
          MATCH     SP70,AMMAUC1
          IF        !@EQUAL
            MOVE      "A1",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC1
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC1DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC2DESC
          MATCH     SP70,AMMAUC2
          IF        !@EQUAL
            MOVE      "A2",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC2
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC2DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC3DESC
          MATCH     SP70,AMMAUC3
          IF        !@EQUAL
            MOVE      "A3",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC3
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC3DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC4DESC
          MATCH     SP70,AMMAUC4
          IF        !@EQUAL
            MOVE      "A4",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC4
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC4DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,TYPDESC
          MATCH     SP70,AMMATYP
          IF        !@EQUAL
            MOVE      "AT",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMATYP
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,TYPDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,ADTDESC
          MATCH     SP70,AMMAADT
          IF        !@EQUAL
            PACK      KEY4,AMMAADT
            CALL      RDAMDE1
            IF        OVRCD=0
              MOVE      AMDEDES,ADTDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,TDTDESC
          MATCH     SP70,AMMATDT
          IF        !@EQUAL
            PACK      KEY4,AMMATDT
            CALL      RDAMDE1
            IF        OVRCD=0
              MOVE      AMDEDES,TDTDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,PMTDESC
          MATCH     SP70,AMLEPMT
          IF        !@EQUAL
            MOVE      "PM",AMCDCAT
            PACK      KEY5,AMCDCAT,AMLEPMT
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,PMTDESC
            ENDIF
          ENDIF
.
          RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       AMSACMIO/INC
          INC       AMSCODIO/INC
          INC       AMSCODKY    
          INC       AMSDEPIO/INC
          INC       AMSGILIO/INC
          INC       AMSINSIO/INC
          INC       AMSLEAIO/INC
          INC       AMSLOCIO/INC
          INC       AMSLOCKY    
          INC       AMSMASIO/INC
          INC       AMSREGIO/INC
          INC       APSMASIO/INC
.
          INC       STDGENCD
.
