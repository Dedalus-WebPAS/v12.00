.---------------------------------------------------------------------------
.   System    :   Financial Management System
.   Include   :   FMSNRGKY
.   Routine   :   HFMNGA00 Template Report Code
.   Return    :
.-------------------------------------------------------------------------------
HFMNGA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "30",HLEF
            MOVE      "80",HRIG
          ENDIF
HFMNGA04
          CALL      GSCRN000
          BRANCH    EXIT,HFMNGA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Template Report Code"
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 5",STDCOL02
          MOVE      STDCOL02,STDCOL03
          ADD       "41",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"CC Template"
.
          MOVE      STDCOL03,STDCOL04
          ADD       "14",STDCOL04
          DISPLAY   *PSTDCOL04:STDROW,*V2LON,*ULON,"Sub Template"
.
          MOVE      STDCOL04,STDCOL05
          ADD       "15",STDCOL06
HFMNGA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,FMNGCODE
          PACK      KEY3,FMNGCODE,SP70
.
.
          CALL      RSFMNG1
HFMNGA10
          CALL      RKFMNG1
          BRANCH    OVRCD,HFMNGA15
          PACK      KEY3,FMNGCODE,SP70
.
.
          BRANCH    CSEARCH,HFMNGA12
          CALL      HFMNGA60
          BRANCH    OVRCD,HFMNGA10
HFMNGA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY3,XITEMNO,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,FMNGCODE
          DISPLAY   *PSTDCOL02:STDROW,FMNGDESC
          DISPLAY   *PSTDCOL03:STDROW,FMNGCCCD," Lev ",FMNGCLEV
          DISPLAY   *PSTDCOL04:STDROW,FMNGSACD," Lev ",FMNGSLEV
          COMPARE   MAXITEM,XITEMNO
          GOTO      HFMNGA10 IF NOT EQUAL
HFMNGA15
.
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HFMNGA20
          CALL      HSCRI000
          BRANCH    EXIT,HFMNGA30,HFMNGA35,HFMNGA40,HFMNGA45,HFMNGA04:
                              HFMNGA91,HFMNGA50
          GOTO      HFMNGA92
HFMNGA30
          CALL      RKFMNG1
          BRANCH    OVRCD,HFMNGA85
          PACK      KEY3,FMNGCODE,SP70
.
.
          CALL      RPFMNG1
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMNGA10
HFMNGA35
          MOVE      ST1,KEY3
          CALL      RDFMNG1
          CALL      RPFMNG1
          BRANCH    OVRCD,HFMNGA85
          PACK      KEY3,FMNGCODE,SP70
.
.
.
.
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HFMNGA36
          CALL      RPFMNG1
          BRANCH    OVRCD,HFMNGA37
          PACK      KEY3,FMNGCODE,SP70
.
.
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HFMNGA36 IF NOT EQUAL
HFMNGA37
          MOVE      ZERO,XITEMNO
          GOTO      HFMNGA10
HFMNGA40
          MOVE      ST1,KEY3
          CALL      RDFMNG1
          CALL      RPFMNG1
          BRANCH    OVRCD,HFMNGA85
          PACK      KEY3,FMNGCODE,SP70
.
.
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMNGA08
HFMNGA45
          CALL      RKFMNG1
          BRANCH    OVRCD,HFMNGA85
          PACK      KEY3,FMNGCODE,SP70
.
.
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY3,Z70
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSFMNG1
HFMNGA46
          CALL      RPFMNG1
          BRANCH    OVRCD,HFMNGA47
          PACK      KEY3,FMNGCODE,SP70
.
.
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HFMNGA46 IF NOT EQUAL
HFMNGA47
          MOVE      ZERO,XITEMNO
          GOTO      HFMNGA10
HFMNGA50  COMPARE   ZERO,CSEARCH
          GOTO      HFMNGA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL04:STDROW,*V2LON,SCHFLD04
          RESET     SCHFLD04
          KEYIN     *PSTDCOL05:STDROW,*V2LON,SCHFLD05
          RESET     SCHFLD05
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMNGA08
HFMNGA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMNGA08
HFMNGA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HFMNGA61 IF EQUAL
          MATCH     SCHFLD01,FMNGCCCD
          GOTO      HFMNGA72 IF NOT EQUAL
HFMNGA61
          MATCH     SP70,SCHFLD02
          GOTO      HFMNGA62 IF EQUAL
          MATCH     SCHFLD02,FMNGDESC
          GOTO      HFMNGA72 IF NOT EQUAL
HFMNGA62
HFMNGA63
          MATCH     SP70,SCHFLD04
          GOTO      HFMNGA64 IF EQUAL
          MATCH     SCHFLD04,FMNGSACD
          GOTO      HFMNGA72 IF NOT EQUAL
HFMNGA64
          MATCH     SP70,SCHFLD05
          GOTO      HFMNGA65 IF EQUAL
HFMNGA65
HFMNGA66
HFMNGA67
HFMNGA68
HFMNGA69
HFMNGA70
          GOTO      HFMNGA75
HFMNGA72  MOVE      ONE,OVRCD
HFMNGA75  RETURN
HFMNGA85
          LOAD      KEY3,XITEMNO,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY3,FMNGCODE
          CALL      RDFMNG1
HFMNGA90
.
          BEEP
          GOTO      HFMNGA20
HFMNGA91
          MOVE      SP70,FMNGDESC
          MOVE      SP70,FMNGCCCD
          MOVE      SP70,FMNGCCFR
          MOVE      SP70,FMNGSACD
          MOVE      SP70,FMNGSAFR
          MOVE      SP70,FMNGRS
          MOVE      SP70,FMNGPT
          MOVE      SP70,FMNGCLEV
          MOVE      SP70,FMNGSLEV
          MOVE      ZERO,FMNGCAS
          MOVE      ZERO,FMNGPSEQ
          MOVE      SP70,FMNGCBT
          MOVE      SP70,FMNGPBT
          MOVE      ZERO,FMNGDOP
          MOVE      ZERO,FMNGZER
          MOVE      SP70,FMNGSUPP
          MOVE      SP70,FMNGSPAR
          MOVE      SP70,KEY3
          MOVE      SP70,FMNGCODE
          GOTO      HFMNGA96
HFMNGA92
          MOVE      SP70,KEY3
          MOVE      SP70,FMNGCODE
          LOAD      KEY3,CCITEM,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY3,FMNGCODE
HFMNGA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HFMNGA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Financial Management System
.   Include   :   FMSNRGKY
.   Routine   :   KFMNGA00 Keyin Template Report Code
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KFMNGA00
          MOVE      UNDLN70,FMNGCODE
          KEYIN     *PCCOL:CVERT,*DV,FMNGCODE:
                    *PCCOL:CVERT,*V2LON,FMNGCODE:
                    *PCCOL:CVERT,*DV,FMNGCODE
.
          ENDSET    FMNGCODE
          APPEND    SP70,FMNGCODE
          RESET     FMNGCODE
.
          MATCH     SP70,FMNGCODE
          GOTO      KFMNGA90 IF EQUAL
.
          CMATCH    EXITCHAR,FMNGCODE
          GOTO      KFMNGA95 IF EQUAL
.
          CMATCH    QUEST,FMNGCODE
          GOTO      KFMNGA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HFMNGA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    FMNGCODE
          APPEND    SP70,FMNGCODE
          RESET     FMNGCODE
.
          MATCH     SP70,FMNGCODE
          GOTO      KFMNGA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,FMNGCODE
KFMNGA10
          PACK      KEY3,FMNGCODE
          CALL      RAFMNG1
          BRANCH    OVRCD,KFMNGA80
          BRANCH    CKEYTYP,KFMNGA75
          CALL      RDFMNG1
KFMNGA70
          MOVE      ZERO,EXIT
          GOTO      KFMNGA99
KFMNGA75
          MOVE      "Template Report Code Already Exists - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KFMNGA00
KFMNGA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KFMNGA99,KFMNGA99
          MOVE      "Template Report Code Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KFMNGA00
KFMNGA90
          MOVE      ONE,EXIT
          GOTO      KFMNGA99
KFMNGA95
          MOVE      TWO,EXIT
KFMNGA99
          RETURN
