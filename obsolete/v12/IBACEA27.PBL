.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.01  09.07.2002  Glenn Saunders
.           Recompile for changes in includes shared with Southland, but with
.           previously different formats - now merged.  Includes effected :-
.           CCSCEAFD, CCSCONFD, CCSEPSFD, CCSHCDFD, CCSHLCFD, CCSIADFD
.-------------------------------------------------------
. V9.02.00  11.06.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.           Remove all PSN PAS clone includes
.-------------------------------------------------------
. V6.03.00  02.10.1995 B.G.Ackland
.           Release 6.03
.-------------------------------------------------------
ACCOTHER  INIT      "Acc. Other"
BTYTOTPC  FORM      12.2
BTYTOTPQ  FORM      12.2
COST1     FORM      10.2[9]
COST2     FORM      10.2[9]
COST3     FORM      10.2[9]
COST4     FORM      10.2[9]
COST5     FORM      10.2[9]
ENDATY    DIM       3
ENDBTY    DIM       3
ENDWRD    DIM       3
F12P2     FORM      12.2
FMT01     DIM       11
FMT02     DIM       11
FMT03     DIM       11
FMT04     DIM       11
FMT05     DIM       11
FMT06     DIM       11
LASTATY   DIM       3
LASTBTY   DIM       3
LASTSPC   DIM       3
LASTWRD   DIM       3
MISOTHER  INIT      "Misc Other"
PRICST    DIM       11
PRIQTY    DIM       9
SECCST    DIM       11
SECQTY    DIM       9
STRATY    DIM       3
STRBTY    DIM       3
STRWRD    DIM       3
THEATRE   INIT      "Theatre   "
TOTCOST1  FORM      12.2
TOTCOST2  FORM      12.2
TOTCOST3  FORM      12.2
TOTCOST4  FORM      12.2
TOTCOST5  FORM      12.2
TYPDESC   DIM       10
WRDTOTPC  FORM      12.2
WRDTOTSC  FORM      12.2
WRDTOTPQ  FORM      12.2
WRDTOTSQ  FORM      12.2
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACEA27
.   Function      :   Bed Time Patient Service Report         
.   Generated  On :   09/07/2002
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CCSCONFD/INC
          INC       CEANAMFD/INC
          INC       CEANBMFD/INC
          INC       CEANCMFD/INC
          INC       CEAPSCFD/INC
          INC       CEASPCFD/INC
          INC       PATCODFD/INC
          INC       PATWR1FD/INC
.=========================
.Local Variable Definition
.-------------------------
REPTFMT   FORM      2 * Scr 01 Fld     4
FROMWRD   DIM      40 * Scr 01 Fld     5
TOWRD     DIM      40 * Scr 01 Fld     6
DESCFMT   DIM      20 * Scr 01 Fld     7
REPTSEQ   FORM      2 * Scr 02 Fld     4
DESCSEQ   DIM      20 * Scr 02 Fld     7
FROMATY   DIM      40 * Scr 02 Fld     8
TOATY     DIM      40 * Scr 02 Fld     9
FROMBTY   DIM      40 * Scr 03 Fld     5
TOBTY     DIM      40 * Scr 03 Fld     6
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACEA27"
PRGNAM    INIT      "Bed Time Patient Service Report         "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   64",AUDTSECT
          MOVE      " 39",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ceaaudps";
            OPEN      CEAAUDPS,"ceaaudps"
          ENDIF
          DISPLAY   *P56:24,"Opening ceanamaf";
          OPEN      CEANAMA1,"ceanamaf"
          DISPLAY   *P56:24,"Opening ceanbmaf";
          OPEN      CEANBMA1,"ceanbmaf"
          DISPLAY   *P56:24,"Opening ceanbmaf";
          OPEN      CEANBMA2,"ceanbmaf"
          DISPLAY   *P56:24,"Opening ceancmaf";
          OPEN      CEANCMA1,"ceancmaf"
          DISPLAY   *P56:24,"Opening ceapscaf";
          OPEN      CEAPSCA1,"ceapscaf"
          DISPLAY   *P56:24,"Opening ceaspcaf";
          OPEN      CEASPCA1,"ceaspcaf"
          DISPLAY   *P56:24,"Opening  patcodes           ";
          OPEN      PATCODE1,"patcodes"          
          DISPLAY   *P56:24,"Opening  patcodes           ";
          OPEN      PATCODE2,"patcodes"          
          DISPLAY   *P56:24,"Opening  patcodes           ";
          OPEN      PATCODE3,"patcodes"          
          DISPLAY   *P56:24,"Opening  patcodes           ";
          OPEN      PATCODE4,"patcodes"          
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Options                            
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Ward/Patient Service Mapping       
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Admission Type Variation Report    
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Bed Type Variations Report         
          ENDIF
          RETURN
.--------------------------------
. Screen - Options                            
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Options                            
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Options                            
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Options                            
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Options                            
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Options                            
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Options                            
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Options                            
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.--------------------------------
. Screen - Ward/Patient Service Mapping       
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
          CALL      REPDEF00
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Ward/Patient Service Mapping       
.-------------------------------------------------------
CF01L000
          MOVE      ZERO,REPTFMT 
          MOVE      SP70,FROMWRD 
          MOVE      SP70,TOWRD   
          MOVE      SP70,DESCFMT 
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Ward/Patient Service Mapping       
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Ward/Patient Service Mapping       
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Ward/Patient Service Mapping       
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Ward/Patient Service Mapping       
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Ward/Patient Service Mapping       
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L101:
                            PS01L102,PS01L103,PS01L104
          GOTO     PS01L999
.
PS01L101
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      FROMWRD,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      TOWRD,VAR        
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      DESCFMT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Ward/Patient Service Mapping       
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L104,SF01L006,SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L103:
                            SF01L104,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      REPA0000
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L103
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESCFMT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EFMT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L103
            ENDIF
            BRANCH    EXIT,SF01L103,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESCFMT,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L104
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOWRD   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RWRD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L104
            ENDIF
            BRANCH    EXIT,SF01L104,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      FROMWRD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOWRD,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Admission Type Variation Report    
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
          CALL      REPDEF00
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Admission Type Variation Report    
.-------------------------------------------------------
CF02L000
          MOVE      ZERO,REPTSEQ 
          MOVE      SP70,FROMWRD 
          MOVE      SP70,FROMATY 
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Admission Type Variation Report    
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Admission Type Variation Report    
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Admission Type Variation Report    
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Admission Type Variation Report    
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Admission Type Variation Report    
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L101:
                            PS02L102,PS02L103,PS02L104,PS02L105:
                            PS02L106
          GOTO     PS02L999
.
PS02L101
          MOVE      REPTSEQ,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      FROMWRD,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      TOWRD,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      DESCSEQ,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      FROMATY,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      TOATY,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Admission Type Variation Report    
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102,SF02L103:
                            SF02L104,SF02L006,SF02L006,SF02L105:
                            SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L103:
                            SF02L104,SF02L020,SF02L020,SF02L105:
                            SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L102
          CALL      REPB0000
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L103
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESCSEQ 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESEQ0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L103
            ENDIF
            BRANCH    EXIT,SF02L103,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      REPTSEQ,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESCSEQ,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L104
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOWRD   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RWRD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L104
            ENDIF
            BRANCH    EXIT,SF02L104,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      FROMWRD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOWRD,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L105
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOATY   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RATY0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L105
            ENDIF
            BRANCH    EXIT,SF02L105,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      FROMATY,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOATY,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
SF02L990  MOVE      FOUR,EXIT * Exit Char Exit
SF02L999  RETURN
.--------------------------------
. Screen - Bed Type Variations Report         
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
          CALL      REPDEF00
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Bed Type Variations Report         
.-------------------------------------------------------
CF03L000
          MOVE      ZERO,REPTFMT 
          MOVE      SP70,FROMBTY 
          MOVE      SP70,TOBTY   
          MOVE      SP70,DESCFMT 
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Bed Type Variations Report         
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Bed Type Variations Report         
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Bed Type Variations Report         
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Bed Type Variations Report         
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Bed Type Variations Report         
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L101:
                            PS03L102,PS03L103,PS03L104
          GOTO     PS03L999
.
PS03L101
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      FROMBTY,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      TOBTY,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      DESCFMT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Bed Type Variations Report         
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L103:
                            SF03L104,SF03L006,SF03L006
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L103:
                            SF03L104,SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L102
          CALL      REPC0000
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L103
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESCFMT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EBTF0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L103
            ENDIF
            BRANCH    EXIT,SF03L103,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESCFMT,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L104
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOBTY   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RBTY0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L104
            ENDIF
            BRANCH    EXIT,SF03L104,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      FROMBTY,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOBTY,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------
. Setup Report Defaults
.------------------------------------------------------------
REPDEF00
          MOVE      SP70,STRBTY
          MOVE      Z70,ENDBTY
          MOVE      "Start                  ",FROMBTY
          MOVE      "Finish                 ",TOBTY
          MOVE      SP70,STRATY
          MOVE      Z70,ENDATY
          MOVE      "Start                  ",FROMATY
          MOVE      "Finish                 ",TOATY
          MOVE      SP70,STRWRD
          MOVE      Z70,ENDWRD
          MOVE      "Start                  ",FROMWRD
          MOVE      "Finish                 ",TOWRD
          MOVE      ZERO,REPTFMT
          MOVE      "Standard",DESCFMT
          MOVE      ZERO,REPTSEQ
          MOVE      "by Ward",DESCSEQ
          RETURN

.------------------------------------------------------------
. Print Ward Mapping Report
.------------------------------------------------------------
REPA0000  DISPLAY   *P1:24,*EL,"Printing Report : ";
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
.
          MOVE      ZERO,WRDTOTPC
          MOVE      ZERO,WRDTOTSC
          COMPARE   ONE,REPTFMT
          CALL      CLRTOT00 IF EQUAL
.
          MOVE      SP70,LASTWRD
          MOVE      SP70,LASTSPC
          PACK      KEY13,STRWRD,SP70
          CALL      RDCENA1
          IF        OVRCD=0
            CALL      RPCENA1
          ENDIF
REPA1000  CALL      RKCENA1
          BRANCH    OVRCD,REPA9000
          MATCH     CENAWRD,ENDWRD
          GOTO      REPA9000 IF LESS
.
          MATCH     LASTWRD,CENAWRD
          IF        !@EQUAL
            CALL      PRTWRD00
          ENDIF
.
          BRANCH    REPTFMT,REPA2000
.
          COMPARE   "55",CLNO
          CALL      HEDA0000 IF NOT LESS
.
          MATCH     LASTSPC,CENASPC
          IF        !@EQUAL
            MOVE       CENASPC,KEY3
            CALL       RDCESP1
            PRINT      *7,CENASPC,SP1,CESPDES;
            MOVE       CENASPC,LASTSPC
          ENDIF
.
          MOVE       CENAPSC,KEY7
          CALL       RDCEPS1
          MOVE       "99,999.99",PRIQTY
          MOVE       "99,999.99",SECQTY
          MOVE       "9999,999.99",PRICST
          MOVE       "9999,999.99",SECCST
          FEDIT      CENADQTY,PRIQTY
          FEDIT      CENAHQTY,SECQTY
          ASSIGN     (CEPSST1+CEPSST2+CEPSST3+CEPSST4+CEPSST5)*CENADQTY,F12P2
          FEDIT      F12P2,PRICST
          ADD        F12P2,WRDTOTPC       * Ward Primary Op Total
          ASSIGN     (CEPSST1+CEPSST2+CEPSST3+CEPSST4+CEPSST5)*CENAHQTY,F12P2
          FEDIT      F12P2,SECCST
          ADD        F12P2,WRDTOTSC
.
          PRINT     *47,CENAPSC,SP1,CEPSDES,SP1:
                    PRIQTY,PRICST," |",SECQTY,SECCST
          ADD       ONE,CLNO
          GOTO      REPA1000
.
REPA2000  MOVE       CENAPSC,KEY7
          CALL       RDCEPS1
          MOVE       CEPSTYP,F1
.
          ASSIGN     COST1[F1]+(CEPSST1*CENADQTY),COST1[F1]
          ASSIGN     COST2[F1]+(CEPSST2*CENADQTY),COST2[F1]
          ASSIGN     COST3[F1]+(CEPSST3*CENADQTY),COST3[F1]
          ASSIGN     COST4[F1]+(CEPSST4*CENADQTY),COST4[F1]
          ASSIGN     COST5[F1]+(CEPSST5*CENADQTY),COST5[F1]
.
          ASSIGN     COST1[F1]+(CEPSST1*CENAHQTY*24),COST1[F1]
          ASSIGN     COST2[F1]+(CEPSST2*CENAHQTY*24),COST2[F1]
          ASSIGN     COST3[F1]+(CEPSST3*CENAHQTY*24),COST3[F1]
          ASSIGN     COST4[F1]+(CEPSST4*CENAHQTY*24),COST4[F1]
          ASSIGN     COST5[F1]+(CEPSST5*CENAHQTY*24),COST5[F1]
.
          GOTO       REPA1000
.
REPA9000  CALL      WRDTOT00
          PRINT     *45,"***** End of Report *****"
          RETURN
.------------------------------------------------------------
. Page Header
.------------------------------------------------------------
HEDA0000  CALL      HEAD132
          DISPLAY   *P19:24,*V2LON,CPAGENO
          PRINT     "Ward Mapping From : ",FROMWRD
          PRINT     "             To   : ",TOWRD
          PRINT     "Report Format     : ",REPTFMT,SP1;
          IF        REPTFMT=0
            PRINT     DESCFMT
          ELSE
            PRINT     "Cost Summary for 1 Day (24 Hours)"
          ENDIF
          CALL      UND132
          IF        REPTFMT=0
            PRINT     "Ward                                               ":
                      "                                                   ":
                      " per Day |           per Hour"
            PRINT     "      Service Provider                        Patie":
                      "nt Service                                   Qty   ":
                      "    Cost |      Qty      Cost"
          ELSE
            PRINT     "Ward                                                ":
                      "Income     |                    Cost Components   ":
                      "                  |      Total"
            PRINT     "                                                    ":
                      "Component  |  ",CCCOCD1,SP1,CCCOCD2,SP1,CCCOCD3:
                      SP1,CCCOCD4,SP1,CCCOCD5,"|           "
          ENDIF
          CALL      UND132
          RETURN
.
PRTWRD00  MATCH     SP70,LASTWRD
          CALL      WRDTOT00 IF NOT EQUAL
.
          COMPARE   "50",CLNO
          CALL      HEDA0000 IF NOT LESS
.
          ADD       ONE,CLNO
          PACK      KEY6,CENAWRD,SP70
          CALL      RDWARD1                                            * V90200
          MOVE      CENAWRD,LASTWRD
          MOVE      SP70,LASTSPC
.
          BRANCH    REPTFMT,PRTWRD99
.
          PRINT     CENAWRD,SP1,WBDESC                                 * V90200
...          PRINT      *7,CENASPC,SP1,CESPDES;
.
PRTWRD99  RETURN
.
WRDTOT00  BRANCH     REPTFMT,WRDTOT50
          CALL       UND132
          MOVE       "         ",PRIQTY
          MOVE       "         ",SECQTY
          MOVE       "9999,999.99",PRICST
          MOVE       "9999,999.99",SECCST
          FEDIT      WRDTOTPC,PRICST
          FEDIT      WRDTOTSC,SECCST
          PRINT     "Total",*91,PRIQTY,PRICST," |",SECQTY,SECCST
          ADD       ONE,CLNO
          CALL      UND132
          MOVE      ZERO,WRDTOTPC
          MOVE      ZERO,WRDTOTSC
          GOTO      WRDTOT99
.
WRDTOT50  COMPARE   "40",CLNO
          CALL      HEDA0000 IF NOT LESS
          MOVE      ZERO,F1
          MOVE      ZERO,TOTCOST1
          MOVE      ZERO,TOTCOST2
          MOVE      ZERO,TOTCOST3
          MOVE      ZERO,TOTCOST4
          MOVE      ZERO,TOTCOST5
          PRINT     LASTWRD,SP1,WBDESC;                                * V90200
.
WRDTOT60  ADD       ONE,F1
          MOVE      "9999,999.99",FMT01
          MOVE      "9999,999.99",FMT02
          MOVE      "9999,999.99",FMT03
          MOVE      "9999,999.99",FMT04
          MOVE      "9999,999.99",FMT05
          MOVE      "9999,999.99",FMT06
          FEDIT     COST1[F1],FMT01
          FEDIT     COST2[F1],FMT02
          FEDIT     COST3[F1],FMT03
          FEDIT     COST4[F1],FMT04
          FEDIT     COST5[F1],FMT05
          ADD       COST1[F1],TOTCOST1
          ADD       COST2[F1],TOTCOST2
          ADD       COST3[F1],TOTCOST3
          ADD       COST4[F1],TOTCOST4
          ADD       COST5[F1],TOTCOST5
          ASSIGN    COST1[F1]+COST2[F1]+COST3[F1]+COST4[F1]+COST5[F1],F12P2
          COMPARE   ZERO,F12P2
          GOTO      WRDTOT70 IF EQUAL
          FEDIT     F12P2,FMT06
          LOAD      TYPDESC,F1,THEATRE,CCCOIA1,CCCOIA2,CCCOIA3,ACCOTHER:
                               CCCOIM1,CCCOIM2,CCCOIM3,MISOTHER
.
          ADD       "1",CLNO
          PRINT     *53,TYPDESC," |",FMT01,FMT02,FMT03,FMT04,FMT05:
                    " |",FMT06
WRDTOT70  COMPARE   "9",F1
          GOTO      WRDTOT60 IF NOT EQUAL
.
          CALL      UND132
          MOVE      "9999,999.99",FMT01
          MOVE      "9999,999.99",FMT02
          MOVE      "9999,999.99",FMT03
          MOVE      "9999,999.99",FMT04
          MOVE      "9999,999.99",FMT05
          MOVE      "9999,999.99",FMT06
          FEDIT     TOTCOST1,FMT01
          FEDIT     TOTCOST2,FMT02
          FEDIT     TOTCOST3,FMT03
          FEDIT     TOTCOST4,FMT04
          FEDIT     TOTCOST5,FMT05
          ASSIGN    TOTCOST1+TOTCOST2+TOTCOST3+TOTCOST4+TOTCOST5,F12P2
          FEDIT     F12P2,FMT06
          PRINT     *53,"Total      |",FMT01,FMT02,FMT03,FMT04,FMT05:
                    " |",FMT06
          CALL      UND132
          ADD       "1",CLNO
          CALL      CLRTOT00
.
WRDTOT99  RETURN
.
CLRTOT00  MOVE      ZERO,F1
.
CLRTOT10  ADD       ONE,F1
          MOVE      ZERO,COST1[F1]
          MOVE      ZERO,COST2[F1]
          MOVE      ZERO,COST3[F1]
          MOVE      ZERO,COST4[F1]
          MOVE      ZERO,COST5[F1]
.
          COMPARE   "9",F1
          GOTO      CLRTOT10 IF NOT EQUAL
          RETURN
.------------------------------------------------------------
.------------------------------------------------------------
. Enter Report Format 0=Standard
.------------------------------------------------------------
EFMT0000   CALL      DFMT0000
           MOVE      ZERO,REPTFMT
EFMT0100   KEYIN     *PCCOL:CVERT,*V2LON,*RV,REPTFMT
           COMPARE   ZERO,REPTFMT
           GOTO      EFMT9000 IF EQUAL
           BRANCH    REPTFMT,EFMT1000
           BEEP
           GOTO      EFMT0100
.
EFMT1000   MOVE      "24 Hour Cost Summary",DESCFMT
           GOTO      EFMT9999
.
EFMT9000   MOVE      "Standard",DESCFMT
           GOTO      EFMT9999
.
EFMT9999   CALL      PUTSCR00
           RETURN
.
DFMT0000  MOVE      "19",HTOP
          MOVE      "50",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P55:20,*V2LON,*ULON,"Report Format",*HOFF:
                    *P52:21,*V2LON,"0. ",*HOFF,"Standard":
                    *P52:22,*V2LON,"1. ",*HOFF,"24 Hour Cost Summary"
          RETURN
.
.------------------------------------------------------------
. Enter a Range of Wards
.------------------------------------------------------------
RWRD0000   MOVE     "    5",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           CALL     KPWR1A00                                           * V90200
           BRANCH   EXIT,RWRD0100,RWRD0999
           MOVE     WWARD,STRWRD                                       * V90200
           PACK     FROMWRD,WWARD,SP1,WBDESC                           * V90200
           GOTO     RWRD0140
RWRD0100   MOVE     "Start             ",FROMWRD
           MOVE     SP70,STRWRD
.
RWRD0140   MOVE     FROMWRD,VAR
           CALL     DISPITEM
.
RWRD0150   MOVE     "    6",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           CALL     KPWR1A00                                           * V90200
           BRANCH   EXIT,RWRD0200,RWRD0999
           MOVE     WWARD,ENDWRD                                       * V90200
           PACK     TOWRD,WWARD,SP1,WBDESC                             * V90200
           MATCH    STRWRD,ENDWRD
           GOTO     RWRD0999 IF EQUAL
           GOTO     RWRD0999 IF NOT LESS
           BEEP
           MOVE     "To Ward Must Be > From Ward - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RWRD0000
.
RWRD0200   MOVE     "Finish             ",TOWRD
           MOVE     "ZZ",ENDWRD
.
RWRD0999   MOVE     "    5",FLDID
           CALL     GETPOSIT
           RETURN
.------------------------------------------------------------
. Print Admission Type Variation Report
.------------------------------------------------------------
REPB0000  DISPLAY   *P1:24,*EL,"Printing Report : ";
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
.
          COMPARE   ONE,REPTSEQ
          GOTO      REPB2000 IF EQUAL
.
          MOVE      SP70,LASTWRD
          PACK      KEY6,STRWRD,SP70
          CALL      RDCENB2
          IF        OVRCD=0
            CALL      RPCENB2
          ENDIF
.
REPB1000  CALL      RKCENB2
          BRANCH    OVRCD,REPB9000
          MATCH     CENBWRD,ENDWRD
          GOTO      REPB9000 IF LESS
.
          MATCH     STRATY,CENBATY
          GOTO      REPB1000 IF LESS
          MATCH     CENBATY,ENDATY
          GOTO      REPB1000 IF LESS
.
          COMPARE   "50",CLNO
          GOTO      REPB1100 IF LESS
          CALL      HEDB0000
          GOTO      REPB1200
.
REPB1100  MATCH     LASTWRD,CENBWRD
          IF        !@EQUAL
            MOVE      CENBWRD,LASTWRD
            PACK      KEY6,CENBWRD,SP70
            CALL      RDWARD1                                          * V90200
            IF        OVRCD=1
              MOVE      "Invalid",WBDESC                               * V90200
            ENDIF
            CALL      UND132
            PRINT     "| ",CENBWRD,SP1,WBDESC;                         * V90200
          ELSE
            PRINT     "| ";
          ENDIF
.
REPB1200  MOVE      "A ",TCODE                                         * V90200
          PACK      KEY5,TCODE,CENBATY                                 * V90200
          CALL      RDCODE1                                            * V90200
          IF        OVRCD=1
            MOVE      "Invalid",TDESC                                  * V90200
          ENDIF
.
          MOVE      "99,999.9999",FMT01
          MOVE      "99,999.9999",FMT02
          MOVE      "99,999.9999",FMT03
          MOVE      "99,999.9999",FMT04
          MOVE      "99,999.9999",FMT05
          FEDIT     CENBFC1,FMT01
          FEDIT     CENBFC2,FMT02
          FEDIT     CENBFC3,FMT03
          FEDIT     CENBFC4,FMT04
          FEDIT     CENBFC5,FMT05
.
          PRINT     *31,"| ",CENBATY,SP1,TDESC,*61,"|":
                    SP2,FMT01,SP3,FMT02,SP3,FMT03,SP3,FMT04,SP3,FMT05,*132,"|"
          GOTO      REPB1000
.
. Print by Admission Type
.--------------------------------------------------------
REPB2000  MOVE      SP70,LASTATY
          PACK      KEY6,STRATY,SP70
          CALL      RDCENB1
          IF        OVRCD=0
            CALL      RPCENB1
          ENDIF
.
REPB3000  CALL      RKCENB1
          BRANCH    OVRCD,REPB9000
          MATCH     CENBATY,ENDATY
          GOTO      REPB9000 IF LESS
.
          MATCH     STRWRD,CENBWRD
          GOTO      REPB3000 IF LESS
          MATCH     CENBWRD,ENDWRD
          GOTO      REPB3000 IF LESS
.
          COMPARE   "50",CLNO
          GOTO      REPB3100 IF LESS
          CALL      HEDB0000
          GOTO      REPB3200
.
REPB3100  MATCH     LASTATY,CENBATY
          IF        !@EQUAL
            MOVE      CENBATY,LASTATY
            MOVE      "A ",TCODE                                       * V90200
            PACK      KEY5,TCODE,CENBATY                               * V90200
            CALL      RDCODE1                                          * V90200
            IF        OVRCD=1
              MOVE      "Invalid",TDESC                                * V90200
            ENDIF
            CALL      UND132
            PRINT     "| ",CENBATY,SP1,TDESC;                          * V90200
          ELSE
            PRINT     "| ";
          ENDIF
.
REPB3200  PACK      KEY6,CENBWRD,SP70
          CALL      RDWARD1                                            * V90200
          IF        OVRCD=1
            MOVE      "Invalid",WBDESC                                 * V90200
          ENDIF
.
          MOVE      "99,999.9999",FMT01
          MOVE      "99,999.9999",FMT02
          MOVE      "99,999.9999",FMT03
          MOVE      "99,999.9999",FMT04
          MOVE      "99,999.9999",FMT05
          FEDIT     CENBFC1,FMT01
          FEDIT     CENBFC2,FMT02
          FEDIT     CENBFC3,FMT03
          FEDIT     CENBFC4,FMT04
          FEDIT     CENBFC5,FMT05
.
          PRINT     *31,"| ",CENBWRD,SP1,WBDESC,*61,"|":
                    SP2,FMT01,SP3,FMT02,SP3,FMT03,SP3,FMT04,SP3,FMT05,*132,"|"
          GOTO      REPB3000
.
REPB9000  CALL      UND132
          PRINT     *45,"***** End of Report *****"
          RETURN
.------------------------------------------------------------
. Page Header
.------------------------------------------------------------
HEDB0000  CALL      HEAD132
          DISPLAY   *P19:24,*V2LON,CPAGENO
          PRINT     "Ward From : ",FROMWRD:
                    "  Admission Type From : ",FROMATY
          PRINT     "     To   : ",TOWRD:
                    "                 To   : ",TOATY
          PRINT     "Sequence  : ",REPTSEQ,SP1,DESCSEQ
          CALL      UND132
          IF        REPTSEQ=0
            PRINT     "| Ward                        | Admission Type      ":
                      "        |                  Factors by Cost Component":
                      "s                          |"
            PRINT     "|                             |                     ":
                      "        |",SP3,CCCOCD1,SP4,CCCOCD2,SP4,CCCOCD3:
                      SP4,CCCOCD4,SP4,CCCOCD5," |"
            MOVE      CENBWRD,LASTWRD
            PACK      KEY6,CENBWRD,SP70
            CALL      RDWARD1                                          * V90200
            IF        OVRCD=1
              MOVE      "Invalid",WBDESC                               * V90200
            ENDIF
            CALL      UND132
            PRINT     "| ",CENBWRD,SP1,WBDESC;                         * V90200
          ELSE
            PRINT     "| Admission Type              | Ward                ":
                      "        |                  Factors by Cost Component":
                      "s                          |"
            PRINT     "|                             |                     ":
                      "        |",SP3,CCCOCD1,SP4,CCCOCD2,SP4,CCCOCD3:
                      SP4,CCCOCD4,SP4,CCCOCD5," |"
            MOVE      CENBATY,LASTATY
            MOVE      "A ",TCODE                                       * V90200
            PACK      KEY5,TCODE,CENBATY                               * V90200
            CALL      RDCODE1                                          * V90200
            IF        OVRCD=1
              MOVE      "Invalid",TDESC                                * V90200
            ENDIF
            CALL      UND132
            PRINT     "| ",CENBATY,SP1,TDESC;                          * V90200
          ENDIF
.
          RETURN
.------------------------------------------------------------
. Enter Report Format 0=By Ward
.------------------------------------------------------------
ESEQ0000   CALL      DSEQ0000
           MOVE      ZERO,REPTSEQ
ESEQ0100   KEYIN     *PCCOL:CVERT,*V2LON,*RV,REPTSEQ
           COMPARE   ZERO,REPTSEQ
           GOTO      ESEQ9000 IF EQUAL
           BRANCH    REPTSEQ,ESEQ1000
           BEEP
           GOTO      ESEQ0100
.
ESEQ1000   MOVE      "by Admission Type",DESCSEQ
           GOTO      ESEQ9999
.
ESEQ9000   MOVE      "by Ward",DESCSEQ
           GOTO      ESEQ9999
.
ESEQ9999   CALL      PUTSCR00
           RETURN
.
DSEQ0000  MOVE      "19",HTOP
          MOVE      "50",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P55:20,*V2LON,*ULON,"Report Sequence",*HOFF:
                    *P52:21,*V2LON,"0. ",*HOFF,"by Ward":
                    *P52:22,*V2LON,"1. ",*HOFF,"by Admission Type"
          RETURN
.
.------------------------------------------------------------
. Enter a Range Adm Types
.------------------------------------------------------------
RATY0000   MOVE     "    8",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           MOVE     "A ",TCODE                                         * V90200
           CALL     KPCODA00                                           * V90200
           BRANCH   EXIT,RATY0100,RATY0999
           MOVE     ACODE,STRATY                                       * V90200
           PACK     FROMATY,ACODE,SP1,TDESC                            * V90200
           GOTO     RATY0140
RATY0100   MOVE     "Start             ",FROMATY
           MOVE     SP70,STRATY
.
RATY0140   MOVE     FROMATY,VAR
           CALL     DISPITEM
.
RATY0150   MOVE     "    9",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           MOVE     "A ",TCODE                                         * V90200
           CALL     KPCODA00                                           * V90200
           BRANCH   EXIT,RATY0200,RATY0999
           MOVE     ACODE,ENDATY                                       * V90200
           PACK     TOATY,ACODE,SP1,TDESC                              * V90200
           MATCH    STRATY,ENDATY
           GOTO     RATY0999 IF EQUAL
           GOTO     RATY0999 IF NOT LESS
           BEEP
           MOVE     "To Adm Type Must Be > From Adm Type - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RATY0000
.
RATY0200   MOVE     "Finish             ",TOATY
           MOVE     "ZZ",ENDATY
.
RATY0999   MOVE     "    8",FLDID
           CALL     GETPOSIT
           RETURN
.------------------------------------------------------------
. Print Bed Type Variation Mapping Report
.------------------------------------------------------------
REPC0000  DISPLAY   *P1:24,*EL,"Printing Report : ";
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
.
          MOVE      ZERO,BTYTOTPC
          COMPARE   ONE,REPTFMT
          CALL      CLRTOT00 IF EQUAL
.
          MOVE      SP70,LASTBTY
          MOVE      SP70,LASTSPC
          PACK      KEY13,STRBTY,SP70
          CALL      RDCENC1
          IF        OVRCD=0
            CALL      RPCENC1
          ENDIF
REPC1000  CALL      RKCENC1
          BRANCH    OVRCD,REPC9000
          MATCH     CENCBTY,ENDBTY
          GOTO      REPC9000 IF LESS
.
          MATCH     LASTBTY,CENCBTY
          IF        !@EQUAL
            CALL      PRTBTY00
          ENDIF
.
          BRANCH    REPTFMT,REPC2000
.
          COMPARE   "55",CLNO
          CALL      HEDC0000 IF NOT LESS
.
          MATCH     LASTSPC,CENCSPC
          IF        !@EQUAL
            MOVE       CENCSPC,KEY3
            CALL       RDCESP1
            PRINT      *28,CENCSPC,SP1,CESPDES;
            MOVE       CENCSPC,LASTSPC
          ENDIF
.
          MOVE       CENCPSC,KEY7
          CALL       RDCEPS1
          MOVE       "99,999.99",PRIQTY
          MOVE       "9999,999.99",PRICST
          FEDIT      CENCQTY,PRIQTY
          ASSIGN     (CEPSST1+CEPSST2+CEPSST3+CEPSST4+CEPSST5)*CENCQTY,F12P2
          FEDIT      F12P2,PRICST
          ADD        F12P2,BTYTOTPC       * Bed Type Total
.
          PRINT     *68,CENCPSC,SP1,CEPSDES,SP1:
                    PRIQTY,PRICST
          ADD       ONE,CLNO
          GOTO      REPC1000
.
REPC2000  MOVE       CENCPSC,KEY7
          CALL       RDCEPS1
          MOVE       CEPSTYP,F1
.
          ASSIGN     COST1[F1]+(CEPSST1*CENCQTY),COST1[F1]
          ASSIGN     COST2[F1]+(CEPSST2*CENCQTY),COST2[F1]
          ASSIGN     COST3[F1]+(CEPSST3*CENCQTY),COST3[F1]
          ASSIGN     COST4[F1]+(CEPSST4*CENCQTY),COST4[F1]
          ASSIGN     COST5[F1]+(CEPSST5*CENCQTY),COST5[F1]
.
          GOTO       REPC1000
.
REPC9000  CALL      BTYTOT00
          PRINT     *45,"***** End of Report *****"
          RETURN
.------------------------------------------------------------
. Page Header
.------------------------------------------------------------
HEDC0000  CALL      HEAD132
          DISPLAY   *P19:24,*V2LON,CPAGENO
          PRINT     "Bed Type Variations From : ",FROMBTY
          PRINT     "                    To   : ",TOBTY
          PRINT     "Report Format            : ",REPTFMT,SP1,DESCFMT
          CALL      UND132
          IF        REPTFMT=0
            PRINT     "Bed Type                   Service Provider       ":
                      "                 Patient Service                   ":
                      "                Qty       Cost"
          ELSE
            PRINT     "Bed Type                                            ":
                      "Income     |                    Cost Components   ":
                      "                  |      Total"
            PRINT     "                                                    ":
                      "Component  |  ",CCCOCD1,SP1,CCCOCD2,SP1,CCCOCD3:
                      SP1,CCCOCD4,SP1,CCCOCD5,"|           "
          ENDIF
          CALL      UND132
          RETURN
.
PRTBTY00  MATCH     SP70,LASTBTY
          CALL      BTYTOT00 IF NOT EQUAL
.
          COMPARE   "50",CLNO
          CALL      HEDC0000 IF NOT LESS
.
          ADD       ONE,CLNO
          MOVE      "BT",TCODE                                         * V90200
          PACK      KEY5,TCODE,CENCBTY,SP70                            * V90200
          CALL      RDCODE1
          MOVE      CENCBTY,LASTBTY
          MOVE      SP70,LASTSPC
.
          BRANCH    REPTFMT,PRTBTY99
.
          PRINT     CENCBTY,SP1,TDESC                                  * V90200
          PRINT     *28,CENCSPC,SP1,CESPDES;
.
PRTBTY99  RETURN
.
BTYTOT00  BRANCH    REPTFMT,BTYTOT50
          CALL      UND132
          MOVE      "         ",PRIQTY
          MOVE      "9999,999.99",PRICST
          FEDIT     BTYTOTPC,PRICST
          PRINT     "Total",*112,PRIQTY,PRICST
          ADD       ONE,CLNO
          CALL      UND132
          MOVE      ZERO,BTYTOTPC
          GOTO      BTYTOT99
.
BTYTOT50  COMPARE   "40",CLNO
          CALL      HEDC0000 IF NOT LESS
          MOVE      ZERO,F1
          MOVE      ZERO,TOTCOST1
          MOVE      ZERO,TOTCOST2
          MOVE      ZERO,TOTCOST3
          MOVE      ZERO,TOTCOST4
          MOVE      ZERO,TOTCOST5
          PRINT     LASTBTY,SP1,TDESC;                                 * V90200
.
BTYTOT60  ADD       ONE,F1
          MOVE      "9999,999.99",FMT01
          MOVE      "9999,999.99",FMT02
          MOVE      "9999,999.99",FMT03
          MOVE      "9999,999.99",FMT04
          MOVE      "9999,999.99",FMT05
          MOVE      "9999,999.99",FMT06
          FEDIT     COST1[F1],FMT01
          FEDIT     COST2[F1],FMT02
          FEDIT     COST3[F1],FMT03
          FEDIT     COST4[F1],FMT04
          FEDIT     COST5[F1],FMT05
          ADD       COST1[F1],TOTCOST1
          ADD       COST2[F1],TOTCOST2
          ADD       COST3[F1],TOTCOST3
          ADD       COST4[F1],TOTCOST4
          ADD       COST5[F1],TOTCOST5
          ASSIGN    COST1[F1]+COST2[F1]+COST3[F1]+COST4[F1]+COST5[F1],F12P2
          COMPARE   ZERO,F12P2
          GOTO      BTYTOT70 IF EQUAL
          FEDIT     F12P2,FMT06
          LOAD      TYPDESC,F1,THEATRE,CCCOIA1,CCCOIA2,CCCOIA3,ACCOTHER:
                               CCCOIM1,CCCOIM2,CCCOIM3,MISOTHER
.
          ADD       "1",CLNO
          PRINT     *53,TYPDESC," |",FMT01,FMT02,FMT03,FMT04,FMT05:
                    " |",FMT06
BTYTOT70  COMPARE   "9",F1
          GOTO      BTYTOT60 IF NOT EQUAL
.
          CALL      UND132
          MOVE      "9999,999.99",FMT01
          MOVE      "9999,999.99",FMT02
          MOVE      "9999,999.99",FMT03
          MOVE      "9999,999.99",FMT04
          MOVE      "9999,999.99",FMT05
          MOVE      "9999,999.99",FMT06
          FEDIT     TOTCOST1,FMT01
          FEDIT     TOTCOST2,FMT02
          FEDIT     TOTCOST3,FMT03
          FEDIT     TOTCOST4,FMT04
          FEDIT     TOTCOST5,FMT05
          ASSIGN    TOTCOST1+TOTCOST2+TOTCOST3+TOTCOST4+TOTCOST5,F12P2
          FEDIT     F12P2,FMT06
          PRINT     *53,"Total      |",FMT01,FMT02,FMT03,FMT04,FMT05:
                    " |",FMT06
          CALL      UND132
          ADD       "1",CLNO
          CALL      CLRTOT00
.
BTYTOT99  RETURN
.
.------------------------------------------------------------
. Enter Report Format 0=Standard
.------------------------------------------------------------
EBTF0000   CALL      DBTF0000
           MOVE      ZERO,REPTFMT
EBTF0100   KEYIN     *PCCOL:CVERT,*V2LON,*RV,REPTFMT
           COMPARE   ZERO,REPTFMT
           GOTO      EBTF9000 IF EQUAL
           BRANCH    REPTFMT,EBTF1000
           BEEP
           GOTO      EBTF0100
.
EBTF1000   MOVE      "1 Day Cost Summary",DESCFMT
           GOTO      EBTF9999
.
EBTF9000   MOVE      "Standard",DESCFMT
           GOTO      EBTF9999
.
EBTF9999   CALL      PUTSCR00
           RETURN
.
DBTF0000  MOVE      "19",HTOP
          MOVE      "50",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P55:20,*V2LON,*ULON,"Report Format",*HOFF:
                    *P52:21,*V2LON,"0. ",*HOFF,"Standard":
                    *P52:22,*V2LON,"1. ",*HOFF,"1 Day Cost Summary"
          RETURN
.
.------------------------------------------------------------
. Enter a Range Bed Types
.------------------------------------------------------------
RBTY0000   MOVE     "    5",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           MOVE     "BT",TCODE                                         * V90200
           CALL     KPCODA00                                           * V90200
           BRANCH   EXIT,RBTY0100,RBTY0999
           MOVE     ACODE,STRBTY                                       * V90200
           PACK     FROMBTY,ACODE,SP1,TDESC                            * V90200
           GOTO     RBTY0140
RBTY0100   MOVE     "Start             ",FROMBTY
           MOVE     SP70,STRBTY
.
RBTY0140   MOVE     FROMBTY,VAR
           CALL     DISPITEM
.
RBTY0150   MOVE     "    6",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           MOVE     "BT",TCODE                                         * V90200
           CALL     KPCODA00                                           * V90200
           BRANCH   EXIT,RBTY0200,RBTY0999
           MOVE     ACODE,ENDBTY                                       * V90200
           PACK     TOBTY,ACODE,SP1,TDESC                              * V90200
           MATCH    STRBTY,ENDBTY
           GOTO     RBTY0999 IF EQUAL
           GOTO     RBTY0999 IF NOT LESS
           BEEP
           MOVE     "To Bed Type Must Be > From Bed Type - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RBTY0000
.
RBTY0200   MOVE     "Finish             ",TOBTY
           MOVE     "ZZ",ENDBTY
.
RBTY0999   MOVE     "    5",FLDID
           CALL     GETPOSIT
           RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CEACODKY    
          INC       CEANAMIO/INC
          INC       CEANBMIO/INC
          INC       CEANCMIO/INC
          INC       CEAPSCIO/INC
          INC       CEASPCIO/INC
          INC       CEAWRDKY    
          INC       PATCODIO/INC
          INC       PATWR1IO/INC
.
          INC       STDGENCD
.
