.---------------------------------------------------------------------------
.   System    :   Financial Management System
.   Include   :   FMSLEVKY
.   Routine   :   HFMLVA00 Report Level
.   Return    :
.-------------------------------------------------------------------------------
HFMLVA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HFMLVA04
          CALL      GSCRN000
          BRANCH    EXIT,HFMLVA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Level"       
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 6",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "20",STDCOL03
HFMLVA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,FMLVCODE
          PACK      KEY3,FMLVCODE,SP70
.
.
          CALL      RSFMLV1
HFMLVA10
          CALL      RKFMLV1
          BRANCH    OVRCD,HFMLVA15
          PACK      KEY3,FMLVCODE,SP70
.
.
          BRANCH    CSEARCH,HFMLVA12
          CALL      HFMLVA60
          BRANCH    OVRCD,HFMLVA10
HFMLVA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY3,XITEMNO,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,FMLVCODE
          DISPLAY   *PSTDCOL02:STDROW,FMLVDESC
          COMPARE   MAXITEM,XITEMNO
          GOTO      HFMLVA10 IF NOT EQUAL
HFMLVA15
.
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HFMLVA20
          CALL      HSCRI000
          BRANCH    EXIT,HFMLVA30,HFMLVA35,HFMLVA40,HFMLVA45,HFMLVA04:
                              HFMLVA91,HFMLVA50
          GOTO      HFMLVA92
HFMLVA30
          CALL      RKFMLV1
          BRANCH    OVRCD,HFMLVA85
          PACK      KEY3,FMLVCODE,SP70
.
.
          CALL      RPFMLV1
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMLVA10
HFMLVA35
          MOVE      ST1,KEY3
          CALL      RDFMLV1
          CALL      RPFMLV1
          BRANCH    OVRCD,HFMLVA85
          PACK      KEY3,FMLVCODE,SP70
.
.
.
.
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HFMLVA36
          CALL      RPFMLV1
          BRANCH    OVRCD,HFMLVA37
          PACK      KEY3,FMLVCODE,SP70
.
.
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HFMLVA36 IF NOT EQUAL
HFMLVA37
          MOVE      ZERO,XITEMNO
          GOTO      HFMLVA10
HFMLVA40
          MOVE      ST1,KEY3
          CALL      RDFMLV1
          CALL      RPFMLV1
          BRANCH    OVRCD,HFMLVA85
          PACK      KEY3,FMLVCODE,SP70
.
.
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMLVA08
HFMLVA45
          CALL      RKFMLV1
          BRANCH    OVRCD,HFMLVA85
          PACK      KEY3,FMLVCODE,SP70
.
.
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY3,Z70
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSFMLV1
HFMLVA46
          CALL      RPFMLV1
          BRANCH    OVRCD,HFMLVA47
          PACK      KEY3,FMLVCODE,SP70
.
.
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HFMLVA46 IF NOT EQUAL
HFMLVA47
          MOVE      ZERO,XITEMNO
          GOTO      HFMLVA10
HFMLVA50  COMPARE   ZERO,CSEARCH
          GOTO      HFMLVA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMLVA08
HFMLVA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMLVA08
HFMLVA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HFMLVA61 IF EQUAL
          MATCH     SCHFLD01,FMLVCODE
          GOTO      HFMLVA72 IF NOT EQUAL
HFMLVA61
          MATCH     SP70,SCHFLD02
          GOTO      HFMLVA62 IF EQUAL
          MATCH     SCHFLD02,FMLVDESC
          GOTO      HFMLVA72 IF NOT EQUAL
HFMLVA62
HFMLVA63
HFMLVA64
HFMLVA65
HFMLVA66
HFMLVA67
HFMLVA68
HFMLVA69
HFMLVA70
          GOTO      HFMLVA75
HFMLVA72  MOVE      ONE,OVRCD
HFMLVA75  RETURN
HFMLVA85
          LOAD      KEY3,XITEMNO,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY3,FMLVCODE
          CALL      RDFMLV1
HFMLVA90
.
          BEEP
          GOTO      HFMLVA20
HFMLVA91
          MOVE      SP70,FMLVDESC
          MOVE      SP70,FMLVSPAR
          MOVE      SP70,KEY3
          MOVE      SP70,FMLVCODE
          GOTO      HFMLVA96
HFMLVA92
          MOVE      SP70,KEY3
          MOVE      SP70,FMLVCODE
          LOAD      KEY3,CCITEM,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY3,FMLVCODE
HFMLVA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HFMLVA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Financial Management System
.   Include   :   FMSLEVKY
.   Routine   :   KFMLVA00 Keyin Report Level
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KFMLVA00 TOPIC     "FMLVCODE"
          MOVE      UNDLN70,FMLVCODE
          KEYIN     *PCCOL:CVERT,*DV,FMLVCODE:
                    *PCCOL:CVERT,*V2LON,*JR,*ZF,FMLVCODE:
                    *PCCOL:CVERT,*DV,FMLVCODE
.
          ENDSET    FMLVCODE
          APPEND    SP70,FMLVCODE
          RESET     FMLVCODE
          REP       " 0",FMLVCODE
.
          MATCH     "000",FMLVCODE
          GOTO      KFMLVA90 IF EQUAL
.
          ENDSET    FMLVCODE
          CMATCH    EXITCHAR,FMLVCODE
          GOTO      KFMLVA95 IF EQUAL
.
          CMATCH    QUEST,FMLVCODE
          GOTO      KFMLVA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HFMLVA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    FMLVCODE
          APPEND    SP70,FMLVCODE
          RESET     FMLVCODE
.
          MATCH     SP70,FMLVCODE
          GOTO      KFMLVA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,FMLVCODE
KFMLVA10
          RESET     FMLVCODE
          PACK      KEY3,FMLVCODE,SP70
          CALL      RAFMLV1
          BRANCH    OVRCD,KFMLVA80
          BRANCH    CKEYTYP,KFMLVA75
          CALL      RDFMLV1
KFMLVA70
          MOVE      ZERO,EXIT
          GOTO      KFMLVA99
KFMLVA75
          MOVE      "Report Level Already Exists - ",DISPMSG                                          
          CALL      MESSAGE1
          GOTO      KFMLVA00
KFMLVA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KFMLVA99,KFMLVA99
          MOVE      "Report Level Does Not Exists - ",DISPMSG                                         
          CALL      MESSAGE1
          GOTO      KFMLVA00
KFMLVA90
          MOVE      ONE,EXIT
          GOTO      KFMLVA99
KFMLVA95
          MOVE      TWO,EXIT
KFMLVA99 TOPIC    PRGID
          RETURN
