.******************************************************************************
.*                                                                            *
.* System         : Emergency                                                 *
.*                                                                            *
.* Include Name   : DXEMRDET.PBL                                              *
.*                                                                            *
.* Function       : To display the values from EMRVISFD                       *
.*                  NOTE: the label numbers for this indicate the item number *
.*                        each variable is                                    *
.*                                                                            *
.* Author         : Steve Armstrong         03/12/1997                        *
.*                                                                            *
.* Parameters     : EMRVISFD record for the data to display                   *
.*                  SCRSPTFD/SCRSBGFD records                                 *
.*                                                                            *
.* Includes Req'd : DXPATCOD      display a field from patcodfd               *
.*                                                                            *
.* Modifications  : 
.*        V5.08.01  06/06/2000  Jill Habasque                                 *
.*                  Changed from key10 to key14 for the health fund file      *
.*                  07/07/1999  Nicole Harrington                             *
.*                              Mods to change from AAEGRCFD to EMRGRCFD      *
.******************************************************************************
.
DXEMRDET  PACK      VAR,SP30,SP30,SP20
          MOVE      SCPSITM,FORM5
          BRANCH    FORM5,DAEDT001,DAEDT002,DAEDT003,DAEDT004,DAEDT005:
                          DAEDT006,DAEDT007,DAEDT008,DAEDT009,DAEDT010:   10
                          DAEDT011,DAEDT012,DAEDT013,DAEDT014,DAEDT015:
                          DAEDT016,DAEDT017,DAEDT018,DAEDT019,DAEDT020:   20
                          DAEDT021,DAEDT022,DAEDT023,DAEDT024,DAEDT025:
                          DAEDT026,DAEDT027,DAEDT028,DAEDT029,DAEDT030:   30
                          DAEDT031,DAEDT032,DAEDT033,DAEDT034,DAEDT035:
                          DAEDT036,DAEDT037,DAEDT038,DAEDT039,DAEDT040:   40
                          DAEDT041,DAEDT042,DAEDT043,DAEDT044,DAEDT045:
                          DAEDT046,DAEDT047,DAEDT048,DAEDT049,DAEDT050:   50
                          DAEDT051,DAEDT052,DAEDT053,DAEDT054,DAEDT055:
                          DAEDT056,DAEDT057,DAEDT058,DAEDT059,DAEDT060:   60
                          DAEDT061,DAEDT062,DAEDT063,DAEDT064,DAEDT065:
                          DAEDT066,DAEDT067,DAEDT068,DAEDT069,DAEDT070:   70
                          DAEDT071,DAEDT072,DAEDT073,DAEDT074,DAEDT075:
                          DAEDT076,DAEDT077,DAEDT078,DAEDT079,DAEDT080:   80
                          DAEDT081,DAEDT082,DAEDT083,DAEDT084,DAEDT085:
                          DAEDT086,DAEDT087,DAEDT088,DAEDT089,DAEDT090:   90
                          DAEDT091,DAEDT092,DAEDT093,DAEDT094,DAEDT095:
                          DAEDT096,DAEDT097,DAEDT098,DAEDT099,DAEDT100:  100
                          DAEDT101,DAEDT102,DAEDT103,DAEDT104,DAEDT105:
                          DAEDT106,DAEDT107,DAEDT108,DAEDT109,DAEDT110:  110
                          DAEDT111,DAEDT112,DAEDT113,DAEDT114,DAEDT115:
                          DAEDT116,DAEDT117,DAEDT118,DAEDT119,DAEDT120:  120
                          DAEDT121,DAEDT122,DAEDT123,DAEDT124,DAEDT125:
                          DAEDT126,DAEDT127,DAEDT128,DAEDT129,DAEDT130:  130
                          DAEDT131,DAEDT132,DAEDT133,DAEDT134,DAEDT135:
                          DAEDT136,DAEDT137,DAEDT138,DAEDT139,DAEDT140:  140
                          DAEDT141,DAEDT142,DAEDT143,DAEDT144,DAEDT145:
                          DAEDT146,DAEDT147,DAEDT148,DAEDT149,DAEDT150:  150
                          DAEDT151,DAEDT152,DAEDT153,DAEDT154,DAEDT155:
                          DAEDT156,DAEDT157,DAEDT158,DAEDT159,DAEDT160:  160
                          DAEDT161,DAEDT162,DAEDT163,DAEDT164,DAEDT165:
                          DAEDT166,DAEDT167,DAEDT168,DAEDT169,DAEDT170:  170
                          DAEDT171,DAEDT172,DAEDT173,DAEDT174,DAEDT175
          GOTO      DAEDT999
.
DAEDT001  UNPACK    EMVIDATE,CCENT,CYEAR,CMON,CDAY     * arrival date
          CALL      PACDATE
          IF        SCPSLEN = 10
            PACK      VAR,CPCDATE,SP70,SP10
          ELSE
            PACK      VAR,CPDATE,SP70,SP10
          ENDIF
          GOTO      DAEDT995
.
DAEDT002  PACK      VAR,EMVITIME,SP70,SP10       * arrival time
          GOTO      DAEDT995
.
DAEDT003  PACK      VAR,EMVITRIG,SP70,SP10       * triage code
          GOTO      DAEDT995
.
DAEDT004  MOVE      CODEAA,TCODE                 * triage code description
          MOVE      EMVITRIG,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT005  PACK      VAR,EMVICOM1,SP70,SP10       * complaint line 1
          GOTO      DAEDT995
.
DAEDT006  PACK      VAR,EMVICOM2,SP70,SP10       * complaint line 2
          GOTO      DAEDT995
.
DAEDT007  PACK      VAR,EMVILOCN,SP70,SP10       * location code
          GOTO      DAEDT995
.
DAEDT008  MOVE      CATEW,TCODE                  * location code description
          MOVE      EMVILOCN,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT009  PACK      VAR,EMVIDOCT,SP70,SP10       * attending doctor
          GOTO      DAEDT995
.
DAEDT010  MOVE      EMVIDOCT,KEY6                * attending doctor description
          CALL      DXPATDOC
          GOTO      DAEDT999
.
DAEDT011  PACK      VAR,EMVICOMP,SP70,SP10       * compensation code
          GOTO      DAEDT995
.
DAEDT012  MOVE      CODECL,TCODE                 * compensation code description
          MOVE      EMVICOMP,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT013  PACK      VAR,EMVICLAS,SP70,SP10       * patient classification
          GOTO      DAEDT995
.
DAEDT014  MOVE      CODEA,TCODE                  * patient class'n description
          MOVE      EMVICLAS,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT015  PACK      VAR,EMVIINSR,SP70,SP10       * insurance status
          GOTO      DAEDT995
.
DAEDT016  MOVE      CODEU1,TCODE                 * insurance status description
          MOVE      EMVIINSR,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT017  PACK      VAR,EMVISRCE,SP70,SP10       * source of referral
          GOTO      DAEDT995
.
DAEDT018  PACK      KEY5,CODES,EMVISRCE
          CALL      RDCODE1
          IF        OVRCD = 0
            MATCH     "1",TCINDC3                * indicator 3 set for transfer?
            IF        @EQUAL
              OPEN      PATVADA1,"patvadaf"
              MATCH     SP5,EMVITSRC
              IF        !@EQUAL
                MOVE      "Unknown transfer code",PTVADESC
                MOVE      EMVITSRC,KEY5
                CALL      RDPTVAD1
                PACK      VAR,PTVADESC,SP70,SP10
                CLOSE     PATVADA1
                GOTO      DAEDT995
              ENDIF
              CLOSE     PATVADA1
            ENDIF
          ENDIF
.
          MOVE      CODES,TCODE                  * source of referral desc.
          MOVE      EMVISRCE,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT019  PACK      VAR,EMVISITN,SP70,SP10       * situation
          GOTO      DAEDT995
.
DAEDT020  MOVE      CODEES,TCODE                 * situation description
          MOVE      EMVISITN,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT021  PACK      VAR,EMVIMODE,SP70,SP10       * mode of arrival
          GOTO      DAEDT995
.
DAEDT022  MOVE      CODEEA,TCODE                 * mode of arrival description
          MOVE      EMVIMODE,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT023  MOVE      DNO,ACODE                    * admitted to hospital
          LOAD      ACODE,EMVIADMT,DYES,DNO
          PACK      VAR,ACODE,SP70,SP10
          GOTO      DAEDT995
.
DAEDT024  CALL      UPDURT00                     * update duration
          PACK      VAR,WAITTIME,SP70,SP10       * duration of waiting
          GOTO      DAEDT995
.
DAEDT025  PACK      VAR,EMVIEMPL,SP70,SP10       * employer
          GOTO      DAEDT995
.
DAEDT026  PACK      VAR,EMVIWAIT,SP70,SP10       * completion wait code
          GOTO      DAEDT995
.
DAEDT027  MOVE      CODEEW,TCODE                 * completion wait code desc.
          MOVE      EMVIWAIT,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT028  PACK      VAR,EMVIPREV,SP70,SP10       * previous Emergency attendance
          GOTO      DAEDT995
.
DAEDT029  MOVE      CODEEP,TCODE                 * previous attendance desc.
          MOVE      EMVIPREV,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT030  PACK      VAR,EMVIFUND,SP70,SP10       * health fund
          GOTO      DAEDT995
.
DAEDT031  PACK      KEY14,EMVIFUND,ZERO4,SP10    * health fund description
          MATCH     SP6,EMVIFUND
          IF        !@EQUAL
            MOVE      "Invalid Health Fund",HFNAME
          ENDIF
          CALL      RDFUND1
          PACK      VAR,HFNAME,SP70,SP10
          GOTO      DAEDT995
.
DAEDT032  PACK      VAR,EMVITABL,SP70,SP10       * health fund table
          GOTO      DAEDT995
.
DAEDT033  PACK      KEY14,EMVIFUND,EMVITABL,SP10 * health fund table desc.
          MATCH     SP8,EMVITABL
          IF        !@EQUAL
            MOVE      "Invalid Health Fund Table",HFNAME
          ENDIF
          CALL      RDFUND1
          PACK      VAR,HFNAME,SP70,SP10
          GOTO      DAEDT995
.
DAEDT034  PACK      VAR,EMVIREFG,SP70,SP10       * referring GP
          GOTO      DAEDT995
.
DAEDT035  PACK      KEY10,EMVIREFG,SP70          * referring GP description
          MATCH     SP10,EMVIREFG
          IF        !@EQUAL
            MOVE      "Invalid Code",PMHCSNAM
          ENDIF
          MOVE      SP30,PMHCGNAM
          CALL      RDPMHCP1
          PACK      VAR,PMHCSNAM,SP70,SP10
          STRIP     VAR
          ENDSET    VAR
          APPEND    SP1,VAR
          APPEND    PMHCGNAM,VAR
          APPEND    SP70,VAR
          RESET     VAR
          GOTO      DAEDT995
.
DAEDT036  PACK      VAR,EMVIREFD,SP70,SP10       * referring doctor   
          GOTO      DAEDT995
.
DAEDT037  MOVE      EMVIREFD,KEY6                * referring doctor description
          CALL      DXPATDOC
          GOTO      DAEDT999
.
DAEDT038  PACK      VAR,EMVIPLIN,SP70,SP10       * place of incident
          GOTO      DAEDT995
.
DAEDT039  MOVE      CODEAP,TCODE                 * place of incident description
          MOVE      EMVIPLIN,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT040  PACK      VAR,EMVIINIT,SP70,SP10       * initiator
          GOTO      DAEDT995
.
DAEDT041  MOVE      CODEAI,TCODE                 * initiator description
          MOVE      EMVIINIT,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT042  PACK      VAR,EMVIRTAS,SP70,SP10       * RTA Details Code
          GOTO      DAEDT995
.
DAEDT043  MOVE      CODEAR,TCODE                 * RTA details description
          MOVE      EMVIRTAS,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT044  PACK      VAR,EMVIUC01,SP70,SP10       * UD field 1
          GOTO      DAEDT995
.
DAEDT045  MOVE      CODEA1,TCODE
          MOVE      EMVIUC01,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT046  PACK      VAR,EMVIUC02,SP70,SP10       * UD field 2
          GOTO      DAEDT995
.
DAEDT047  MOVE      CODEA2,TCODE
          MOVE      EMVIUC02,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT048  PACK      VAR,EMVIUC03,SP70,SP10       * UD field 3
          GOTO      DAEDT995
.
DAEDT049  MOVE      CODEA3,TCODE
          MOVE      EMVIUC03,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT050  PACK      VAR,EMVIUC04,SP70,SP10       * UD field 4
          GOTO      DAEDT995
.
DAEDT051  MOVE      CODEA4,TCODE
          MOVE      EMVIUC04,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT052  PACK      VAR,EMVIUC05,SP70,SP10       * UD field 5
          GOTO      DAEDT995
.
DAEDT053  MOVE      CODEA5,TCODE
          MOVE      EMVIUC05,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT054  PACK      VAR,EMVIUC06,SP70,SP10       * UD field 6
          GOTO      DAEDT995
.
DAEDT055  MOVE      CODEA6,TCODE
          MOVE      EMVIUC06,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT056  PACK      VAR,EMVIUC07,SP70,SP10       * UD field 7
          GOTO      DAEDT995
.
DAEDT057  MOVE      CODEA7,TCODE
          MOVE      EMVIUC07,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT058  PACK      VAR,EMVIUC08,SP70,SP10       * UD field 8
          GOTO      DAEDT995
.
DAEDT059  MOVE      CODEA8,TCODE
          MOVE      EMVIUC08,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT060  PACK      VAR,EMVIUC09,SP70,SP10       * UD field 9
          GOTO      DAEDT995
.
DAEDT061  MOVE      CATEA,TCODE
          MOVE      EMVIUC09,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT062  PACK      VAR,EMVIUC10,SP70,SP10       * UD field 10
          GOTO      DAEDT995
.
DAEDT063  MOVE      CATEB,TCODE
          MOVE      EMVIUC10,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT064  PACK      VAR,EMVIUC11,SP70,SP10       * UD field 11
          GOTO      DAEDT995
.
DAEDT065  MOVE      CATEC,TCODE
          MOVE      EMVIUC11,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT066  PACK      VAR,EMVIUC12,SP70,SP10       * UD field 12
          GOTO      DAEDT995
.
DAEDT067  MOVE      CATED,TCODE
          MOVE      EMVIUC12,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT068  PACK      VAR,EMVIUC13,SP70,SP10       * UD field 13
          GOTO      DAEDT995
.
DAEDT069  MOVE      CATEE,TCODE
          MOVE      EMVIUC13,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT070  PACK      VAR,EMVIUC14,SP70,SP10       * UD field 14
          GOTO      DAEDT995
.
DAEDT071  MOVE      CATEF,TCODE
          MOVE      EMVIUC14,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT072  PACK      VAR,EMVIUC15,SP70,SP10       * UD field 15
          GOTO      DAEDT995
.
DAEDT073  MOVE      CATEG,TCODE
          MOVE      EMVIUC15,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT074  PACK      VAR,EMVIUC16,SP70,SP10       * UD field 16
          GOTO      DAEDT995
.
DAEDT075  MOVE      CATEH,TCODE
          MOVE      EMVIUC16,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT076  PACK      VAR,EMVIUC17,SP70,SP10       * UD field 17
          GOTO      DAEDT995
.
DAEDT077  MOVE      CATEI,TCODE
          MOVE      EMVIUC17,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT078  PACK      VAR,EMVIUC18,SP70,SP10       * UD field 18
          GOTO      DAEDT995
.
DAEDT079  MOVE      CATEJ,TCODE
          MOVE      EMVIUC18,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT080  PACK      VAR,EMVIUC19,SP70,SP10       * UD field 19
          GOTO      DAEDT995
.
DAEDT081  MOVE      CATEK,TCODE
          MOVE      EMVIUC19,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT082  PACK      VAR,EMVIUC20,SP70,SP10       * UD field 20
          GOTO      DAEDT995
.
DAEDT083  MOVE      CATEL,TCODE
          MOVE      EMVIUC20,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT084  PACK      VAR,EMVIUC21,SP70,SP10       * UD field 21
          GOTO      DAEDT995
.
DAEDT085  MOVE      CATEM,TCODE
          MOVE      EMVIUC21,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT086  PACK      VAR,EMVIUC22,SP70,SP10       * UD field 22
          GOTO      DAEDT995
.
DAEDT087  MOVE      CATEN,TCODE
          MOVE      EMVIUC22,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT088  PACK      VAR,EMVIUC23,SP70,SP10       * UD field 23
          GOTO      DAEDT995
.
DAEDT089  MOVE      CATEO,TCODE
          MOVE      EMVIUC23,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT090  PACK      VAR,EMVIUC24,SP70,SP10       * UD field 24
          GOTO      DAEDT995
.
DAEDT091  MOVE      CATEP,TCODE
          MOVE      EMVIUC24,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT092  PACK      VAR,EMVIUC25,SP70,SP10       * UD field 25
          GOTO      DAEDT995
.
DAEDT093  MOVE      CATEQ,TCODE
          MOVE      EMVIUC25,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT094  PACK      VAR,EMVIUC26,SP70,SP10       * UD field 26
          GOTO      DAEDT995
.
DAEDT095  MOVE      CATER,TCODE
          MOVE      EMVIUC26,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT096  PACK      VAR,EMVIUC27,SP70,SP10       * UD field 27
          GOTO      DAEDT995
.
DAEDT097  MOVE      CATES,TCODE
          MOVE      EMVIUC27,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT098  PACK      VAR,EMVIUC28,SP70,SP10       * UD field 28
          GOTO      DAEDT995
.
DAEDT099  MOVE      CATET,TCODE
          MOVE      EMVIUC28,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT100  PACK      VAR,EMVIUC29,SP70,SP10       * UD field 29
          GOTO      DAEDT995
.
DAEDT101  MOVE      CATEU,TCODE
          MOVE      EMVIUC29,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT102  PACK      VAR,EMVIUC30,SP70,SP10       * UD field 30
          GOTO      DAEDT995
.
DAEDT103  MOVE      CATEV,TCODE
          MOVE      EMVIUC30,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT104  UNPACK    EMVIUD01,CCENT,CYEAR,CMON,CDAY     * UD date 1
          CALL      PACDATE
          IF        SCPSLEN = 10
            PACK      VAR,CPCDATE,SP70,SP10
          ELSE
            PACK      VAR,CPDATE,SP70,SP10
          ENDIF
          GOTO      DAEDT995
.
DAEDT105  UNPACK    EMVIUD02,CCENT,CYEAR,CMON,CDAY     * UD date 2
          CALL      PACDATE
          IF        SCPSLEN = 10
            PACK      VAR,CPCDATE,SP70,SP10
          ELSE
            PACK      VAR,CPDATE,SP70,SP10
          ENDIF
          GOTO      DAEDT995
.
DAEDT106  UNPACK    EMVIUD03,CCENT,CYEAR,CMON,CDAY     * UD date 3
          CALL      PACDATE
          IF        SCPSLEN = 10
            PACK      VAR,CPCDATE,SP70,SP10
          ELSE
            PACK      VAR,CPDATE,SP70,SP10
          ENDIF
          GOTO      DAEDT995
.
DAEDT107  UNPACK    EMVIUD04,CCENT,CYEAR,CMON,CDAY     * UD date 4
          CALL      PACDATE
          IF        SCPSLEN = 10
            PACK      VAR,CPCDATE,SP70,SP10
          ELSE
            PACK      VAR,CPDATE,SP70,SP10
          ENDIF
          GOTO      DAEDT995
.
DAEDT108  UNPACK    EMVIUD05,CCENT,CYEAR,CMON,CDAY     * UD date 5
          CALL      PACDATE
          IF        SCPSLEN = 10
            PACK      VAR,CPCDATE,SP70,SP10
          ELSE
            PACK      VAR,CPDATE,SP70,SP10
          ENDIF
          GOTO      DAEDT995
.
DAEDT109  UNPACK    EMVIUD06,CCENT,CYEAR,CMON,CDAY     * UD date 6
          CALL      PACDATE
          IF        SCPSLEN = 10
            PACK      VAR,CPCDATE,SP70,SP10
          ELSE
            PACK      VAR,CPDATE,SP70,SP10
          ENDIF
          GOTO      DAEDT995
.
DAEDT110  UNPACK    EMVIUD07,CCENT,CYEAR,CMON,CDAY     * UD date 7
          CALL      PACDATE
          IF        SCPSLEN = 10
            PACK      VAR,CPCDATE,SP70,SP10
          ELSE
            PACK      VAR,CPDATE,SP70,SP10
          ENDIF
          GOTO      DAEDT995
.
DAEDT111  UNPACK    EMVIUD08,CCENT,CYEAR,CMON,CDAY     * UD date 8
          CALL      PACDATE
          IF        SCPSLEN = 10
            PACK      VAR,CPCDATE,SP70,SP10
          ELSE
            PACK      VAR,CPDATE,SP70,SP10
          ENDIF
          GOTO      DAEDT995
.
DAEDT112  UNPACK    EMVIUD09,CCENT,CYEAR,CMON,CDAY     * UD date 9
          CALL      PACDATE
          IF        SCPSLEN = 10
            PACK      VAR,CPCDATE,SP70,SP10
          ELSE
            PACK      VAR,CPDATE,SP70,SP10
          ENDIF
          GOTO      DAEDT995
.
DAEDT113  UNPACK    EMVIUD10,CCENT,CYEAR,CMON,CDAY     * UD date 10
          CALL      PACDATE
          IF        SCPSLEN = 10
            PACK      VAR,CPCDATE,SP70,SP10
          ELSE
            PACK      VAR,CPDATE,SP70,SP10
          ENDIF
          GOTO      DAEDT995
.
DAEDT114  PACK      VAR,EMVIUT01,SP70,SP10       * UD time 1
          GOTO      DAEDT995
.
DAEDT115  PACK      VAR,EMVIUT02,SP70,SP10       * UD time 2
          GOTO      DAEDT995
.
DAEDT116  PACK      VAR,EMVIUT03,SP70,SP10       * UD time 3
          GOTO      DAEDT995
.
DAEDT117  PACK      VAR,EMVIUT04,SP70,SP10       * UD time 4
          GOTO      DAEDT995
.
DAEDT118  PACK      VAR,EMVIUT05,SP70,SP10       * UD time 5
          GOTO      DAEDT995
.
DAEDT119  PACK      VAR,EMVIUT06,SP70,SP10       * UD time 6
          GOTO      DAEDT995
.
DAEDT120  PACK      VAR,EMVIUT07,SP70,SP10       * UD time 7
          GOTO      DAEDT995
.
DAEDT121  PACK      VAR,EMVIUT08,SP70,SP10       * UD time 8
          GOTO      DAEDT995
.
DAEDT122  PACK      VAR,EMVIUT09,SP70,SP10       * UD time 9
          GOTO      DAEDT995
.
DAEDT123  PACK      VAR,EMVIUT10,SP70,SP10       * UD time 10
          GOTO      DAEDT995
.
DAEDT124  MOVE      DNO,ACODE                    * UD Y/N field 1
          LOAD      ACODE,EMVIYN01,DYES,DNO
          PACK      VAR,ACODE,SP70,SP10
          GOTO      DAEDT995
.
DAEDT125  MOVE      DNO,ACODE                    * UD Y/N field 2
          LOAD      ACODE,EMVIYN02,DYES,DNO
          PACK      VAR,ACODE,SP70,SP10
          GOTO      DAEDT995
.
DAEDT126  MOVE      DNO,ACODE                    * UD Y/N field 3
          LOAD      ACODE,EMVIYN03,DYES,DNO
          PACK      VAR,ACODE,SP70,SP10
          GOTO      DAEDT995
.
DAEDT127  MOVE      DNO,ACODE                    * UD Y/N field 4
          LOAD      ACODE,EMVIYN04,DYES,DNO
          PACK      VAR,ACODE,SP70,SP10
          GOTO      DAEDT995
.
DAEDT128  MOVE      DNO,ACODE                    * UD Y/N field 5
          LOAD      ACODE,EMVIYN05,DYES,DNO
          PACK      VAR,ACODE,SP70,SP10
          GOTO      DAEDT995
.
DAEDT129  MOVE      DNO,ACODE                    * UD Y/N field 6
          LOAD      ACODE,EMVIYN06,DYES,DNO
          PACK      VAR,ACODE,SP70,SP10
          GOTO      DAEDT995
.
DAEDT130  MOVE      DNO,ACODE                    * UD Y/N field 7
          LOAD      ACODE,EMVIYN07,DYES,DNO
          PACK      VAR,ACODE,SP70,SP10
          GOTO      DAEDT995
.
DAEDT131  MOVE      DNO,ACODE                    * UD Y/N field 8
          LOAD      ACODE,EMVIYN08,DYES,DNO
          PACK      VAR,ACODE,SP70,SP10
          GOTO      DAEDT995
.
DAEDT132  MOVE      DNO,ACODE                    * UD Y/N field 9
          LOAD      ACODE,EMVIYN09,DYES,DNO
          PACK      VAR,ACODE,SP70,SP10
          GOTO      DAEDT995
.
DAEDT133  MOVE      DNO,ACODE                    * UD Y/N field 10
          LOAD      ACODE,EMVIYN10,DYES,DNO
          PACK      VAR,ACODE,SP70,SP10
          GOTO      DAEDT995
.
DAEDT134  PACK      VAR,EMVITXT1,SP70,SP10       * UD Text field 1
          GOTO      DAEDT995
.
DAEDT135  PACK      VAR,EMVITXT2,SP70,SP10       * UD Text field 2
          GOTO      DAEDT995
.
DAEDT136  PACK      VAR,EMVITXT3,SP70,SP10       * UD Text field 3
          GOTO      DAEDT995
.
DAEDT137  PACK      VAR,EMVITXT4,SP70,SP10       * UD Text field 4
          GOTO      DAEDT995
.
DAEDT138  PACK      VAR,EMVITXT5,SP70,SP10       * UD Text field 5
          GOTO      DAEDT995
.
DAEDT139  PACK      VAR,EMVIUN01,SP70,SP10       * UD Numeric field 1
          GOTO      DAEDT995
.
DAEDT140  PACK      VAR,EMVIUN02,SP70,SP10       * UD Numeric field 2
          GOTO      DAEDT995
.
DAEDT141  PACK      VAR,EMVIUN03,SP70,SP10       * UD Numeric field 3
          GOTO      DAEDT995
.
DAEDT142  PACK      VAR,EMVIUN04,SP70,SP10       * UD Numeric field 4
          GOTO      DAEDT995
.
DAEDT143  PACK      VAR,EMVIUN05,SP70,SP10       * UD Numeric field 5
          GOTO      DAEDT995
.
DAEDT144  UNPACK    EMVIDDAT,CCENT,CYEAR,CMON,CDAY   * discharge date
          CALL      PACDATE
          IF        SCPSLEN = 8
            PACK      VAR,CPDATE,SP30,SP30,SP20
          ELSE
            PACK      VAR,CPCDATE,SP30,SP30,SP20
          ENDIF
          GOTO      DAEDT995
.
DAEDT145  PACK      VAR,EMVIDTIM,SP70,SP10       * discharge time
          GOTO      DAEDT995
.
DAEDT146  PACK      VAR,EMVIDSTA,SP70,SP10       * discharge status code
          GOTO      DAEDT995
.
DAEDT147  PACK      KEY5,CODEED,EMVIDSTA
          CALL      RDCODE1
          IF        OVRCD = 0
            MATCH     "4",TCINDC2                * indicator 2 set for transfer?
            IF        @EQUAL
              OPEN      PATVADA1,"patvadaf"
              MATCH     SP5,EMVIDEST
              IF        !@EQUAL
                MOVE      "Unknown transfer code",PTVADESC
                MOVE      EMVIDEST,KEY5
                CALL      RDPTVAD1
                PACK      VAR,PTVADESC,SP70,SP10
                CLOSE     PATVADA1
                GOTO      DAEDT995
              ENDIF
              CLOSE     PATVADA1
            ENDIF
          ENDIF
.
          MOVE      CODEED,TCODE                 * discharge status description
          MOVE      EMVIDSTA,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT148  PACK      VAR,EMVIOPR1,SP70,SP10       * operator creating event
          GOTO      DAEDT995
.
DAEDT149  MOVE      SP70,SECUSER
          MATCH     SP4,EMVIOPR1
          IF        !@EQUAL
            CALL      OPPASS1
            PACK      KEY4,EMVIOPR1,SP6
            CALL      RDPASS1  
          ENDIF
          PACK      VAR,SECUSER,SP70,SP10
          GOTO      DAEDT995
.
DAEDT150  PACK      VAR,EMVIOPR2,SP70,SP10       * operator discharging patient
          GOTO      DAEDT995
.
DAEDT151  MOVE      SP70,SECUSER
          MATCH     SP4,EMVIOPR2
          IF        !@EQUAL
            CALL      OPPASS1
            PACK      KEY4,EMVIOPR2,SP6
            CALL      RDPASS1  
          ENDIF
          PACK      VAR,SECUSER,SP70,SP10
          GOTO      DAEDT995
.
DAEDT152  PACK      VAR,EMVIELAP,SP70,SP10       * Elapsed time since accident
          GOTO      DAEDT995
.
DAEDT153  MOVE      CODEAE,TCODE
          MOVE      EMVIELAP,ACODE
          CALL      DXPATCOD
          GOTO      DAEDT999
.
DAEDT154  UNPACK    EMVINSDT,CCENT,CYEAR,CMON,CDAY   * date seen by nurse
          CALL      PACDATE
          IF        SCPSLEN = 8
            PACK      VAR,CPDATE,SP30,SP30,SP20
          ELSE
            PACK      VAR,CPCDATE,SP30,SP30,SP20
          ENDIF
          GOTO      DAEDT995
.
DAEDT155  PACK      VAR,EMVINSTM,SP70,SP10       * time seen by nurse
          GOTO      DAEDT995
.
DAEDT156  UNPACK    EMVIDRDT,CCENT,CYEAR,CMON,CDAY   * date seen by doctor
          CALL      PACDATE
          IF        SCPSLEN = 8
            PACK      VAR,CPDATE,SP30,SP30,SP20
          ELSE
            PACK      VAR,CPCDATE,SP30,SP30,SP20
          ENDIF
          GOTO      DAEDT995
.
DAEDT157  PACK      VAR,EMVIDRTM,SP70,SP10       * time seen by doctor
          GOTO      DAEDT995
.
DAEDT158  PACK      VAR,EMVIPATT,SP70,SP10       * no. of previous attendances
          GOTO      DAEDT995
.
DAEDT159  PACK      VAR,EMVIAMBL,SP70,SP10       * ambulance case number
          GOTO      DAEDT995
.
DAEDT160  PACK      VAR,EMVIREGN,SP70,SP10       * body region code
          GOTO      DAEDT995
.
DAEDT161  MATCH     SP3,EMVIREGN
          IF        !@EQUAL
            MOVE      "Unknown code",EMRCDESC
            MOVE      EMVIREGN,KEY2
            CALL      RDEMGRC1
            PACK      VAR,EMRCDESC,SP70,SP10     * body region code description
            GOTO      DAEDT995
          ELSE
            GOTO      DAEDT999
          ENDIF
.
DAEDT162  CALL      HPRC00000                    * any procedures on file ?
          IF        EXIT = 0
            PACK      VAR,DNO,SP70,SP10          * no
          ELSE
            PACK      VAR,DYES,SP70,SP10         * yes
          ENDIF
          GOTO      DAEDT995
.
DAEDT163  CALL      HCNT00000                    * any clinical notes on file ?
          IF        EXIT = 0
            PACK      VAR,DNO,SP70,SP10          * no
          ELSE
            PACK      VAR,DYES,SP70,SP10         * yes
          ENDIF
          GOTO      DAEDT995
.
DAEDT164  CALL      HDGNS000                    * any diagnoses on file ?
          IF        EXIT = 0
            PACK      VAR,DNO,SP70,SP10          * no
          ELSE
            PACK      VAR,DYES,SP70,SP10         * yes
          ENDIF
          GOTO      DAEDT995
.
DAEDT165  PACK      VAR,EMVIADMN,SP70,SP10       * visit number
          GOTO      DAEDT995
.
DAEDT166  PACK      VAR,EMVIUR01,SP70,SP70
          GOTO      DAEDT995
.
DAEDT167  MOVE      EMVIUR01,KEY6
          CALL      DXPATDOC
          PACK      VAR,PACFNAME,SP70,SP70
          GOTO      DAEDT995
.
DAEDT168  PACK      VAR,EMVIUR02,SP70,SP70
          GOTO      DAEDT995
.
DAEDT169  MOVE      EMVIUR02,KEY6
          CALL      DXPATDOC
          PACK      VAR,PACFNAME,SP70,SP70
          GOTO      DAEDT995
.
DAEDT170  PACK      VAR,EMVIUR03,SP70,SP70
          GOTO      DAEDT995
.
DAEDT171  MOVE      EMVIUR03,KEY6
          CALL      DXPATDOC
          PACK      VAR,PACFNAME,SP70,SP70
          GOTO      DAEDT995
.
DAEDT172  PACK      VAR,EMVIUR04,SP70,SP70
          GOTO      DAEDT995
.
DAEDT173  MOVE      EMVIUR04,KEY6
          CALL      DXPATDOC
          PACK      VAR,PACFNAME,SP70,SP70
          GOTO      DAEDT995
.
DAEDT174  PACK      VAR,EMVIUR05,SP70,SP70
          GOTO      DAEDT995
.
DAEDT175  MOVE      EMVIUR05,KEY6
          CALL      DXPATDOC
          PACK      VAR,PACFNAME,SP70,SP70
          GOTO      DAEDT995
.
. ******* actually display the variable *******
.
DAEDT995  CALL      DISPITEM 
.
DAEDT999  RETURN
+
