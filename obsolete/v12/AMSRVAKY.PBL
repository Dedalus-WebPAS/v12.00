EAMRVA00  UNPACK    AMRVRDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          RETURN
.
.
.
.---------------------------------------------------------------------------
.   System    :   Asset Management System            
.   Include   :   AMSRVAKY
.   Routine   :   HAMRVA00 Revaluation         
.   Return    :           
.-------------------------------------------------------------------------------
HAMRVA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HAMRVA04
          CALL      GSCRN000
          BRANCH    EXIT,HAMRVA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Reval. Date"        
.
          MOVE      STDCOL01,STDCOL02
          ADD       "12",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Reference"          
.
          MOVE      STDCOL02,STDCOL03
          ADD       "16",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Type"               
.
          MOVE      STDCOL03,STDCOL04
          ADD       " 5",STDCOL04
HAMRVA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,AMRVRDT 
          PACK      KEY22,AMRVREG,AMRVASS,AMRVRDT,SP70                          
          PACK      SAVKEY80,AMRVREG,AMRVASS,AMRVRDT,SP70                       
          SETLPTR   SAVKEY80,14                                                 
          CALL      RSAMRV1 
HAMRVA10
          CALL      RKAMRV1 
          BRANCH    OVRCD,HAMRVA15
          PACK      KEY22,AMRVREG,AMRVASS,AMRVRDT,SP70                          
          MATCH     SAVKEY80,KEY22                                              
          GOTO      HAMRVA15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,HAMRVA12
          CALL      HAMRVA60
          BRANCH    OVRCD,HAMRVA10
HAMRVA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY22,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          CALL      EAMRVA00
          DISPLAY   *PSTDCOL01:STDROW,CPCDATE 
          DISPLAY   *PSTDCOL02:STDROW,AMRVREF 
          DISPLAY   *PSTDCOL03:STDROW,AMRVRTY 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HAMRVA10 IF NOT EQUAL
HAMRVA15
          UNPACK    SAVKEY80,AMRVREG,AMRVASS,AMRVRDT                            
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HAMRVA20
          CALL      HSCRI000
          BRANCH    EXIT,HAMRVA30,HAMRVA35,HAMRVA40,HAMRVA45,HAMRVA04:
                              HAMRVA91,HAMRVA50
          GOTO      HAMRVA92
HAMRVA30
          CALL      RKAMRV1 
          BRANCH    OVRCD,HAMRVA85
          PACK      KEY22,AMRVREG,AMRVASS,AMRVRDT,SP70                          
          MATCH     SAVKEY80,KEY22                                              
          GOTO      HAMRVA85 IF NOT EQUAL                                       
          CALL      RPAMRV1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAMRVA10
HAMRVA35
          MOVE      ST1,KEY22
          CALL      RDAMRV1 
          CALL      RPAMRV1 
          BRANCH    OVRCD,HAMRVA85
          PACK      KEY22,AMRVREG,AMRVASS,AMRVRDT,SP70                          
          MATCH     SAVKEY80,KEY22                                              
          GOTO      HAMRVA85 IF NOT EQUAL                                       
          MATCH     SP70,AMRVRDT                                                
          GOTO      HAMRVA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HAMRVA36
          CALL      RPAMRV1 
          BRANCH    OVRCD,HAMRVA37
          PACK      KEY22,AMRVREG,AMRVASS,AMRVRDT,SP70                          
          MATCH     SAVKEY80,KEY22                                              
          GOTO      HAMRVA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HAMRVA36 IF NOT EQUAL
HAMRVA37
          MOVE      ZERO,XITEMNO
          GOTO      HAMRVA10
HAMRVA40
          MOVE      ST1,KEY22
          CALL      RDAMRV1 
          CALL      RPAMRV1 
          BRANCH    OVRCD,HAMRVA85
          PACK      KEY22,AMRVREG,AMRVASS,AMRVRDT,SP70                          
          MATCH     SAVKEY80,KEY22                                              
          GOTO      HAMRVA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAMRVA08
HAMRVA45
          CALL      RKAMRV1 
          BRANCH    OVRCD,HAMRVA85
          PACK      KEY22,AMRVREG,AMRVASS,AMRVRDT,SP70                          
          MATCH     SAVKEY80,KEY22                                              
          GOTO      HAMRVA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY22,SAVKEY80,Z70                                          
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSAMRV1 
HAMRVA46
          CALL      RPAMRV1 
          BRANCH    OVRCD,HAMRVA47
          PACK      KEY22,AMRVREG,AMRVASS,AMRVRDT,SP70                          
          MATCH     SAVKEY80,KEY22                                              
          GOTO      HAMRVA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HAMRVA46 IF NOT EQUAL
HAMRVA47
          MOVE      ZERO,XITEMNO
          GOTO      HAMRVA10
HAMRVA50  COMPARE   ZERO,CSEARCH
          GOTO      HAMRVA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAMRVA08
HAMRVA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAMRVA08
HAMRVA60  MOVE      ZERO,OVRCD
          CALL      EAMRVA00
          MATCH     SP70,SCHFLD01
          GOTO      HAMRVA61 IF EQUAL
          MATCH     SCHFLD01,CPCDATE 
          GOTO      HAMRVA72 IF NOT EQUAL
HAMRVA61
          MATCH     SP70,SCHFLD02
          GOTO      HAMRVA62 IF EQUAL
          MATCH     SCHFLD02,AMRVREF 
          GOTO      HAMRVA72 IF NOT EQUAL
HAMRVA62
          MATCH     SP70,SCHFLD03
          GOTO      HAMRVA63 IF EQUAL
          MATCH     SCHFLD03,AMRVRTY 
          GOTO      HAMRVA72 IF NOT EQUAL
HAMRVA63
HAMRVA64
HAMRVA65
HAMRVA66
HAMRVA67
HAMRVA68
HAMRVA69
HAMRVA70
          GOTO      HAMRVA75
HAMRVA72  MOVE      ONE,OVRCD
HAMRVA75  RETURN
HAMRVA85
          LOAD      KEY22,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY22,AMRVREG,AMRVASS,AMRVRDT                               
          CALL      RDAMRV1 
HAMRVA90
          UNPACK    SAVKEY80,AMRVREG,AMRVASS,AMRVRDT                            
          BEEP
          GOTO      HAMRVA20
HAMRVA91
          MOVE      SP70,AMRVYEAR
          MOVE      SP70,AMRVPER 
          MOVE      SP70,AMRVRTY 
          MOVE      SP70,AMRVREF 
          MOVE      SP70,AMRVDES 
          MOVE      ZERO,AMRVAMT 
          MOVE      ZERO,AMRVAAD 
          MOVE      ZERO,AMRVRVR 
          MOVE      ZERO,AMRVPVR 
          MOVE      SP70,AMRVUR1 
          MOVE      SP70,AMRVUR2 
          MOVE      SP70,AMRVUD1 
          MOVE      SP70,AMRVUD2 
          MOVE      SP70,AMRVUY1 
          MOVE      SP70,AMRVUY2 
          MOVE      SP70,AMRVSPA 
          MOVE      SP70,KEY22
          MOVE      SP70,AMRVRDT 
          GOTO      HAMRVA96
HAMRVA92
          MOVE      SP70,KEY22
          MOVE      SP70,AMRVRDT 
          LOAD      KEY22,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY22,AMRVREG,AMRVASS,AMRVRDT                               
HAMRVA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HAMRVA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Asset Management System            
.   Include   :   AMSRVAKY
.   Routine   :   KAMRVA00 Keyin Revaluation Date    
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KAMRVA00 TOPIC     "AMRVRDT "
          PACK      AMRVRDT,CCC,CYY,CMM,CDD
          UNPACK    AMRVRDT,CCENT,CYEAR,CMON,CDAY
          MOVE      SP70,CDAY
          MOVE      SP70,AMRVRDT
          CALL      KEYDATE
          BRANCH    CQUEST,KAMRVA05
          BRANCH    OVRCD,KAMRVA90
          MATCH     SP70,CDAY
          GOTO      KAMRVA90 IF EQUAL
          PACK      AMRVRDT,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,AMRVRDT
          GOTO      KAMRVA90 IF EQUAL
          GOTO      KAMRVA10
.
KAMRVA05
          MOVE      CCITEM,SCCITEM
          CALL      HAMRVA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    AMRVRDT 
          APPEND    SP70,AMRVRDT 
          RESET     AMRVRDT 
.
          MATCH     SP70,AMRVRDT 
          GOTO      KAMRVA00 IF EQUAL
.
          UNPACK    AMRVRDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          DISPLAY   *PCCOL:CVERT,*V2LON,CPCDATE                                 
KAMRVA10
          PACK      KEY22,AMRVREG,AMRVASS,AMRVRDT                               
          CALL      RAAMRV1 
          BRANCH    OVRCD,KAMRVA80
          BRANCH    CKEYTYP,KAMRVA75
          CALL      RDAMRV1 
KAMRVA70
          MOVE      ZERO,EXIT
          GOTO      KAMRVA99
KAMRVA75
          MOVE      "Revaluation Date Already Exist - ",DISPMSG                                      
          CALL      MESSAGE1
          GOTO      KAMRVA00
KAMRVA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KAMRVA99,KAMRVA99
          MOVE      "Revaluation Date Does Not Exist - ",DISPMSG                                     
          CALL      MESSAGE1
          GOTO      KAMRVA00
KAMRVA90  MOVE      SP70,AMRVRDT
          MOVE      ONE,EXIT
          GOTO      KAMRVA99
KAMRVA95
          MOVE      TWO,EXIT
KAMRVA99 TOPIC    PRGID
          RETURN
