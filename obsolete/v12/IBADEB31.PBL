.-----------------------------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
.V10.04.01  15/04/2014 Ebon Clements CAR 299449
.           Recompiled for IBAPRINT 6 character printers
.        V10.02.01  07/04/2011 Mike Laming for Jill CAR 239574
.                   Remove CALL to ' IBAPRNT1,"ibaprntf" '
.         V9.05.01  24/03/2006  Peter Vela   CAR 61299
.                   Increased field no size from DIM3 to DIM5
.         V9.04.01  21/04/2005  Mike Laming  CAR 59741
.                   Add CFDBSLAY=13 at PEND0000 - re-compile for DEBSTACD
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-----------------------------------------------------------------------------
. VF.09.01  28.02.2002  Glenn Saunders   srf 15126
.           Re-compile for changes in DEBDKIKY
. VF.09.B01 05.03.2001 Sandra Barcham
.           Add 132 Layout
.           srf 9059
.-----------------------------------------------------------------------------
. VF.01.10  30.10.2000 Sandra Barcham
.           Recompiled for IBACODIO & IBAPRNIO
. VF.01.09  12.10.2000 Sandra Barcham
.           Removed IBABATFD & IBABATIO as not required
. VF.01.08  13.09.2000 Charles Handaya
.           Fix only one line detail of Cash Receipt print on statement
.           SRF 5136
.           14.08.2000 Charles Handaya
.           For Invoice details, Print Service Date, Not Invoice Date for HSH
.           Fix CARRIED FWD being Templeted
.           Fix Wontaggi (West Wimmera) Layout
. VF.01.07  11.09.2000 Charles Handaya
.           Fix NewZealand Statement Total
. VF.01.06  31.07.2000 Charles Handaya
.           Fix No Decimal Amount in Body - Ballarat Health Services (BHS)
.           SRF 4570
. VF.01.05  27.07.2000 Sandra Barcham
.           Fix dont print statement summary for WWH layout
. VF.01.04  10.07.2000 Charles Handaya
.           Shrink down 2 lines of body Statement Layout - West Gippsland
. VF.01.03  26.06.2000 Charles Handaya
.           Fix Statement Layout - BHS
. VF.01.02  20.06.2000 Charles Handaya
.           Fix Statement Layout
. VF.01.01  16.06.2000 Charles Handaya
.           Add new Stationery Layout for Ballarat Health Services (BHS)
.           13.04.2000 Charles Handaya
.           Add in Print GST Stationery Template feature
. VF.01.00  07.03.2000 Charles Handaya
.           Add in Sortkey
.-----------------------------------------------------------------------------
. VF.00.07  18.07.1999 Charles Handaya
.           Fix Don't print statement summary for WWH Layout
. VF.00.06  14.07.1999 Sandra Barcham
.           Fix CHC Layout
.           srf 645835
. VF.00.05  22.06.1999 Sandra Barcham
.           Fix MOD Layout
.           srf 632134
. VF.00.04  14.06.1999 Sandra Barcham
.           Fix WWH Layout for centuries
. VF.00.03  02.06.1999 Sandra Barcham
.           Fix HUT Layout
.           srf 645595
. VF.00.02  20.04.1999 Sandra Barcham
.           Fix Statement Total if paid after statement date in WWH layout
.           Change grammar in reset option
. VF.00.01  15.04.1999 Sandra Barcham
.           Fix invoice in WWH layout
.-----------------------------------------------------------------------------
CARRIED   FORM      1
CRFWDCOL  FORM      3
CRFWDROW  FORM      3
CURRROW   FORM      3
D22       DIM       22
D24       DIM       24
D50       DIM       50
D50A      DIM       50
DIM12A    DIM       12
DIM10A    DIM       10
DIM14A    DIM       14
DIM14B    DIM       14
DIM28     DIM       28
DIM30     DIM       30
ENDDEB    DIM       8
ENDNAM    DIM       35
ENDSKY    DIM       25
F12       FORM      12
FORM3     FORM      3
FORM5     FORM      5
G30       FORM      12.2
G60       FORM      12.2
G90       FORM      12.2
GCUR      FORM      12.2
GOUT      FORM      12.2
HEADLENG  FORM      3
HEADTAIL  FORM      1
.
MAXCOLNO  FORM      3
MAXLENGT  FORM      3
.
PRNTSTRT  FORM      3
SAVKEY21  DIM       21
SAVKEY24  DIM       24
SERVDATE  DIM       10
STATENO   FORM      5
STRDEB    DIM       8
STRNAM    DIM       35
STRSKY    DIM       25
SVASATDA  DIM       8
SVDATE    DIM       10
SVSTAMS1  DIM       30
SVSTAMS2  DIM       30
.
TAILLENG  FORM      3
T30       DIM       13
T60       DIM       13
T90       DIM       13
TCUR      DIM       13
TOTDIM12  DIM       12
TMPLTFLG  FORM      1
TOUT      DIM       13
.
VARIABLE  DIM       127
X70       INIT      "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
Z40       INIT      "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
.-----------------------------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBADEB31
.   Function      :   Statement Printing                      
.   Generated  On :   07/04/2011
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       DEBCODFD/INC
          INC       DEBCONFD/INC
          INC       DEBDBTFD/INC
          INC       DEBDEPFD/INC
          INC       DEBDKIFD/INC
          INC       DEBFDTFD/INC
          INC       DEBFNOFD/INC
          INC       DEBFTHFD/INC
          INC       DEBINVDF    
          INC       DEBITMFD/INC
          INC       DEBOUTDF    
          INC       DEBPTYFD/INC
          INC       DEBTERFD/INC
          INC       DEBTSPFD/INC
          INC       IBAPRNFD/INC
          INC       IBATMDFD/INC
          INC       IBATMHFD/INC
.=========================
.Local Variable Definition
.-------------------------
FROMDEB   DIM      40 * Scr 00 Fld     4
TODEB     DIM      40 * Scr 00 Fld     5
FROMNAM   DIM      40 * Scr 00 Fld     6
TONAM     DIM      40 * Scr 00 Fld     7
REPTACT   FORM      1 * Scr 00 Fld     8
REPTSEQ   FORM      1 * Scr 00 Fld    10
SEQDESC   DIM      30 * Scr 00 Fld    11
STAMESS1  DIM      30 * Scr 00 Fld    12
STAMESS2  DIM      30 * Scr 00 Fld    13
ZEROOUT   FORM      1 * Scr 00 Fld    15
MINOUT    FORM     12.2 * Scr 00 Fld    16
FROMSKY   DIM      25 * Scr 00 Fld    17
TOSKY     DIM      25 * Scr 00 Fld    18
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBADEB31"
PRGNAM    INIT      "Statement Printing                      "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SELPRT00
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   81",AUDTSECT
          MOVE      "  9",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudcd";
            OPEN      DEBAUDCD,"debaudcd"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 10",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debauddb";
            OPEN      DEBAUDDB,"debauddb"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 11",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudde";
            OPEN      DEBAUDDE,"debaudde"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 12",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudit";
            OPEN      DEBAUDIT,"debaudit"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 13",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudpt";
            OPEN      DEBAUDPT,"debaudpt"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 15",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudte";
            OPEN      DEBAUDTE,"debaudte"
          ENDIF
          DISPLAY   *P56:24,"Opening debcodaf";
          OPEN      DEBCODA1,"debcodaf"
          DISPLAY   *P56:24,"Opening debcodaf";
          OPEN      DEBCODA2,"debcodaf"
          DISPLAY   *P56:24,"Opening debdbtaf";
          OPEN      DEBDBTA1,"debdbtaf"
          DISPLAY   *P56:24,"Opening debdbtaf";
          OPEN      DEBDBTA2,"debdbtaf"
          DISPLAY   *P56:24,"Opening debdbtaf";
          OPEN      DEBDBTA3,"debdbtaf"
          DISPLAY   *P56:24,"Opening debdbtaf";
          OPEN      DEBDBTA4,"debdbtaf"
          DISPLAY   *P56:24,"Opening debdepaf";
          OPEN      DEBDEPA1,"debdepaf"
          DISPLAY   *P56:24,"Opening debdepaf";
          OPEN      DEBDEPA2,"debdepaf"
          DISPLAY   *P56:24,"Opening debdkiaf";
          OPEN      DEBDKIA1,"debdkiaf"
          DISPLAY   *P56:24,"Opening debdkiaf";
          OPEN      DEBDKIA2,"debdkiaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA1,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA2,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA3,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA4,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA5,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA6,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA7,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA8,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfnoaf";
          OPEN      DEBFNOA1,"debfnoaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA1,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA2,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA3,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA4,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA5,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA6,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA7,"debfthaf"
          DISPLAY   *P56:24,"Opening debitmaf";
          OPEN      DEBITMA1,"debitmaf"
          DISPLAY   *P56:24,"Opening debitmaf";
          OPEN      DEBITMA2,"debitmaf"
          DISPLAY   *P56:24,"Opening debitmaf";
          OPEN      DEBITMA3,"debitmaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA1,"debptyaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA2,"debptyaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA3,"debptyaf"
          DISPLAY   *P56:24,"Opening debteraf";
          OPEN      DEBTERA1,"debteraf"
          DISPLAY   *P56:24,"Opening  ibatmdaf           ";
          OPEN      IBATDET1,"ibatmdaf"          
          DISPLAY   *P56:24,"Opening ibatmhaf";
          OPEN      IBATMHA1,"ibatmhaf"
          DISPLAY   *P56:24,"Opening ibatmhaf";
          OPEN      IBATMHA2,"ibatmhaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Options                            
          ENDIF
          RETURN
.--------------------------------
. Screen - Options                            
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      DEFPAR00
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Options                            
.-------------------------------------------------------
CF00L000
          MOVE      SP70,FROMDEB 
          MOVE      SP70,TODEB   
          MOVE      SP70,FROMNAM 
          MOVE      SP70,TONAM   
          MOVE      ZERO,REPTACT 
          MOVE      ZERO,REPTSEQ 
          MOVE      SP70,SEQDESC 
          MOVE      SP70,STAMESS1
          MOVE      SP70,STAMESS2
          MOVE      SP70,ASATDATE
          MOVE      ZERO,ZEROOUT 
          MOVE      ZERO,MINOUT  
          MOVE      SP70,FROMSKY 
          MOVE      SP70,TOSKY   
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Options                            
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Options                            
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Options                            
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Options                            
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Options                            
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L101:
                            PS00L102,PS00L103,PS00L104,PS00L105:
                            PS00L999,PS00L106,PS00L107,PS00L108:
                            PS00L109,PS00L110,PS00L111,PS00L112:
                            PS00L113,PS00L114
          GOTO     PS00L999
.
PS00L101
          MOVE      FROMDEB,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      TODEB,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      FROMNAM,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      TONAM,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      REPTACT,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      REPTSEQ,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      SEQDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      STAMESS1,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      STAMESS2,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          UNPACK    ASATDATE,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      ZEROOUT,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      MINOUT,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      FROMSKY,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      TOSKY,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Options                            
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L006,SF00L104,SF00L006,SF00L105:
                            SF00L106,SF00L107,SF00L006,SF00L108:
                            SF00L109,SF00L110,SF00L111,SF00L112:
                            SF00L113,SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L103:
                            SF00L020,SF00L104,SF00L020,SF00L105:
                            SF00L020,SF00L107,SF00L020,SF00L108:
                            SF00L109,SF00L110,SF00L111,SF00L112:
                            SF00L113,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      REPT0000
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TODEB   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RDEB0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L103
            ENDIF
            BRANCH    EXIT,SF00L103,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMDEB,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TODEB,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L104
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TONAM   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RNAM0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L104
            ENDIF
            BRANCH    EXIT,SF00L104,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMNAM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TONAM,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L105
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,REPTACT 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      REPTACT,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L106
          CALL      LINE0000
          GOTO      SF00L001
.
SF00L107
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SEQDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KRSEQ000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L107
            ENDIF
            BRANCH    EXIT,SF00L107,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      REPTSEQ,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SEQDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L108
          CALL     SELECTED
          STRIP     STAMESS1
          SFORMAT   VAR,SCPSLEN
          MOVE      STAMESS1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,STAMESS1
          SFORMAT   VAR,127
          ENDSET    STAMESS1
          APPEND    SP70,STAMESS1
          RESET     STAMESS1
          CMATCH    EXITCHAR,STAMESS1
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,STAMESS1
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L108
            ENDIF
          ENDIF
          MOVE      STAMESS1,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L109
          CALL     SELECTED
          STRIP     STAMESS2
          SFORMAT   VAR,SCPSLEN
          MOVE      STAMESS2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,STAMESS2
          SFORMAT   VAR,127
          ENDSET    STAMESS2
          APPEND    SP70,STAMESS2
          RESET     STAMESS2
          CMATCH    EXITCHAR,STAMESS2
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,STAMESS2
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L109
            ENDIF
          ENDIF
          MOVE      STAMESS2,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L110
          CALL      DEFDATE1
          CALL     SELECTED
          CALL      KEYDATE
          PACK      ASATDATE,CCENT,CYEAR,CMON,CDAY          
          UNPACK    ASATDATE,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L111
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,ZEROOUT 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      ZEROOUT,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L112
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,MINOUT  
          IF        SCPSMAN=1
            COMPARE   ZERO,MINOUT  
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L112
            ENDIF
          ENDIF
          MOVE      MINOUT,VAR       
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L113
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOSKY   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RSKY0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L113
            ENDIF
            BRANCH    EXIT,SF00L113,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMSKY,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOSKY,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.@@@@@ Function Restart Point @@@@@
.**********************************************************************
. SELPRT00 - select printer routine
. Requires IBACODFD/INC IBAPRNFD/INC
.          IBAIOCOD/INC IBAIOPRN/INC IBAPRINT
.  Note : already includes IBAPASFD & IBAPASIO
.**********************************************************************
SELPRT00  OPEN      IBACODE1,"ibacodef"     * open files
...       OPEN      IBAPRNT1,"ibaprntf"                               *D-239574
          MOVE      SP70,SPLFILE
          CALL      SELPRINT
.
          READ      CONTROLF,EIGHTY7;*86,CFDBSTHD,CFDBSTTL
.
SELPRT99  RETURN
.
.---------------------------------------
. Setup Defaults for Invoice Generation
.---------------------------------------
DEFPAR00  MOVE      "Start    ",FROMDEB
          MOVE      "Start    ",FROMNAM
          MOVE      "Start    ",FROMSKY
          MOVE      "Finish   ",TODEB
          MOVE      "Finish   ",TONAM
          MOVE      "Finish   ",TOSKY
          MOVE      SP70,STRDEB
          MOVE      SP70,STRNAM
          MOVE      SP70,STRSKY
          MOVE      Z70,ENDDEB
          MOVE      Z70,ENDNAM
          MOVE      Z70,ENDSKY
          MOVE      SP70,STAMESS1
          MOVE      SP70,STAMESS2
          MOVE      ONE,REPTSEQ
          MOVE      ONE,REPTACT
          MOVE      ZERO,ZEROOUT
          MOVE      ZERO,MINOUT
          PACK      ASATDATE,CCC,CYY,CMM,CDD
          REP       " 0",ASATDATE
          CALL      GRSEQ000
          RETURN
.
DEFDATE1  MOVE     CCC,CCENT
          MOVE     CYY,CYEAR
          MOVE     CMM,CMON
          MOVE     CDD,CDAY
          REP      " 0",CCENT
          REP      " 0",CYEAR
          REP      " 0",CMON
          REP      " 0",CDAY
          RETURN
.-----------------------------
. Print Trial Balance Report
.-----------------------------
REPT0000  CALL      OPNPRINT
          CALL      MAKTMP00        * Make Temp file for Statement Details Ex.
          BRANCH    EXIT,REPT9999
.
          UNPACK    ASATDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          READ      CONTROLF,EIGHTY1;*243,CFDBILAY,CFDBSLAY
          IF        CFDBSLAY=9
            PACK      DATOFSTA,CPDATE,SP10
          ELSE
            MOVE      CPCDATE,DATOFSTA
          ENDIF
.
          MOVE      ZERO,CPAGENO
          CALL      SETOUT00        * Set up Dates for Ageing
          CLOCK     TIME,CTIMEIS
          MOVE      "99",CLNO
          MOVE      ZERO,STATENO
          DISPLAY  *P1:24,*EL,"Processing Statements ..."
          BRANCH    REPTSEQ,REPT1000,REPT3000
.
. Report By Debtors Code
.
REPT1000  MOVE      ZERO,SECTOR
          PACK      KEY8,STRDEB,SP70
          CALL      RDDBDB1
          IF        OVRCD=0
            GOTO      REPT1200
          ENDIF
REPT1100  CALL      RKDBDB1
          BRANCH    OVRCD,REPT9000
REPT1200  COMPARE   ONE,DBDBSTA
          GOTO      REPT1100 IF NOT EQUAL
          MATCH     DBDBDEB,ENDDEB
          GOTO      REPT9000 IF LESS
          MATCH     STRSKY,DBDBSORT   * Debtors Sortkey Range
          GOTO      REPT1100 IF LESS
          MATCH     DBDBSORT,ENDSKY
          GOTO      REPT1100 IF LESS
          CALL      RANGE000          * Check Outstanding
          BRANCH    EXIT,REPT1100
.
          ADD       ONE,SECTOR
          IF        SECTOR%100=0
            DISPLAY   *P40:24,*V2LON,SECTOR
          ENDIF
.
          CALL      PRSTA000
          ADD       TOTALOUT,GOUT
          ADD       CURRENT,GCUR
          ADD       BALTOT30,G30
          ADD       BALTOT60,G60
          ADD       BALTOT90,G90
          GOTO      REPT1100
.
. Report By Debtors Name
.
REPT2000  MOVE      ZERO,SECTOR
          PACK      KEY43,STRNAM,SP70
          CALL      RDDBDB2
          IF        OVRCD=0
            CALL      RPDBDB2
          ENDIF
REPT2100  CALL      RKDBDB2
          BRANCH    OVRCD,REPT9000
          COMPARE   ONE,DBDBSTA
          GOTO      REPT2100 IF NOT EQUAL
          MATCH     DBDBNA1,ENDNAM
          GOTO      REPT9000 IF LESS
          MATCH     STRDEB,DBDBDEB    * Debtors Code Range
          GOTO      REPT2100 IF LESS
          MATCH     DBDBDEB,ENDDEB
          GOTO      REPT2100 IF LESS
          CALL      RANGE000          * Check Outstanding
          BRANCH    EXIT,REPT2100
.
          ADD       ONE,SECTOR
          IF        SECTOR%100=0
            DISPLAY   *P40:24,*V2LON,SECTOR
          ENDIF
.
          CALL      PRSTA000
          ADD       TOTALOUT,GOUT
          ADD       CURRENT,GCUR
          ADD       BALTOT30,G30
          ADD       BALTOT60,G60
          ADD       BALTOT90,G90
          GOTO      REPT2100
.
. Report By Sortkey
.
REPT3000  MOVE      ZERO,SECTOR
          PACK      KEY33,STRSKY,SP70
          CALL      RDDBDB3
          IF        OVRCD=0
            CALL      RPDBDB3
          ENDIF
REPT3100  CALL      RKDBDB3
          BRANCH    OVRCD,REPT9000
          COMPARE   ONE,DBDBSTA
          GOTO      REPT3100 IF NOT EQUAL
          MATCH     DBDBSORT,ENDSKY
          GOTO      REPT9000 IF LESS
          MATCH     STRDEB,DBDBDEB    * Debtors Code Range
          GOTO      REPT3100 IF LESS
          MATCH     DBDBDEB,ENDDEB
          GOTO      REPT3100 IF LESS
          CALL      RANGE000          * Check Outstanding
          BRANCH    EXIT,REPT3100
.
          ADD       ONE,SECTOR
          IF        SECTOR%100=0
            DISPLAY   *P40:24,*V2LON,SECTOR
          ENDIF
.
          CALL      PRSTA000
          ADD       TOTALOUT,GOUT
          ADD       CURRENT,GCUR
          ADD       BALTOT30,G30
          ADD       BALTOT60,G60
          ADD       BALTOT90,G90
          GOTO      REPT3100
.
REPT9000  CALL      PEND0000
          CALL      CLSPRINT
REPT9100  BEEP
          DISPLAY   *P1:22,*EF,"N.B. Please Ensure Statements have ":
                               "been Printed":
                               " Before Statement Date is Reset."
          KEYIN     *P1:24,"Reset Statement Date (",*V2LON,"Y",*HOFF:
                           "/",*V2LON,"N",*HOFF,") ? ",*V2LON,ANS
          REP       UPPLOW,ANS
          MATCH     "Y",ANS
          GOTO      REPT9200 IF EQUAL
          MATCH     "N",ANS
          GOTO      REPT9100 IF NOT EQUAL
          CALL      KILTMP00
          GOTO      REPT9999
.
REPT9200  CALL      UPSTA000     * Update Statement Printed Date in Header File
          CALL      KILTMP00
.
REPT9999  RETURN
.------------------------------------------------------------
. Check Outstanding Not Zero & Greater than Min. Specified
.------------------------------------------------------------
RANGE000  CALL      DEBOUT00
          BRANCH    ZEROOUT,RANGE100
          COMPARE   ZERO,TOTALOUT
          GOTO      RANGE900 IF EQUAL
.
RANGE100  COMPARE   ZERO,MINOUT
          GOTO      RANGE200 IF EQUAL
          IF        MINOUT>TOTALOUT
            GOTO      RANGE900
          ENDIF
.
RANGE200  MOVE      ZERO,EXIT
          GOTO      RANGE999
.
RANGE900  MOVE      ONE,EXIT
.
RANGE999  RETURN
.
.------------------------------------------------------------
. Make Temporary File
.------------------------------------------------------------
MAKTMP00  DISPLAY  *P1:24,*EL,"Creating Extract File ..."
          MOVE     "debtsp",KEY6
          PACK     FILENAME,KEY6,PORT
          REP      " 0",FILENAME
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     DEBTSPA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=0
            CLOSE    DEBTSPA1,DELETE
          ENDIF
          CLEAR    KEY80
          APPEND   "isbuild ",KEY80
          APPEND   FILENAME,KEY80
          APPEND   " 48 UC1-8,9-9,10-21 UC1-8,22-29,9-9,10-21",KEY80
          RESET    KEY80
          EXECUTE  KEY80,TASKID
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     DEBTSPA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=1
            BEEP
            MOVE     "Unable to Create Statement Extract File - ",DISPMSG
            CALL     MESSAGE1
            GOTO     MAKTMP90
          ENDIF
          OPEN     DEBTSPA2,FILENAME
          MOVE     ZERO,EXIT
          GOTO     MAKTMP99
.
MAKTMP90  MOVE     ONE,EXIT
.
MAKTMP99  RETURN
.------------------------------------------------------------
. Delete Temporary File
.------------------------------------------------------------
KILTMP00  CLOSE     DEBTSPA2
          CLOSE     DEBTSPA1,DELETE
          RETURN
.------------------------------------------------------------
. Update Statement Printed Date in Header File
.------------------------------------------------------------
UPSTA000  PACK       KEY21,SP70
          CALL       RSDBTS1
UPSTA100  CALL       RKDBTS1             * Loop Through the Documents for this
          BRANCH     OVRCD,UPSTA900      * Debtor
          PACK       KEY21,DBTSDEB,DBTSDTY,DBTSDOC,SP70
          CALL       RDDBFH1
          BRANCH     OVRCD,UPSTA100
          MOVE       ASATDATE,DBFHDSTA
          CALL       UPDBFH1
          GOTO       UPSTA100
UPSTA900
UPSTA999  RETURN
.------------------------------------------------------------
. Print Statement Summary
.------------------------------------------------------------
.                                                                      *C-59741
PEND0000  IF        CFDBSLAY=7|CFDBSLAY=8|CFDBSLAY=9|CFDBSLAY=13
           COMPARE    ONE,STATENO
           GOTO       PEND9999 IF EQUAL
          ENDIF
.
          IF        CFDBSLAY=4
            PRINT     *N
          ELSE
            PRINT     *F
          ENDIF
.
          MOVE      "99,999,999.99",TOUT
          MOVE      "99,999,999.99",TCUR
          MOVE      "99,999,999.99",T30
          MOVE      "99,999,999.99",T60
          MOVE      "99,999,999.99",T90
          FEDIT     GOUT,TOUT
          FEDIT     GCUR,TCUR
          FEDIT     G30,T30
          FEDIT     G60,T60
          FEDIT     G90,T90
          PRINT     *N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N:
                    *20,"********* Total of Statements Printed **************"

          CALL      UND80
          PRINT     "      90 Days      60 Days      30 Days      Current":
                    "        Total":
                    *N,T90,T60,T30,TCUR,TOUT
          CALL      UND80
          PRINT     *30,"*** End of Report ***"
.
PEND9999  RETURN
.
.--------------------------------------------------
. Enter Debtors Range
.--------------------------------------------------
RDEB0000   MOVE     "    4",FLDID
           CALL     GETPOSIT
           CALL     KDBDBA00
           BRANCH   EXIT,RDEB0100,RDEB0999
           MOVE     DBDBDEB,STRDEB
           PACK     FROMDEB,DBDBDEB,SP1,DBDBNA1
           GOTO     RDEB0140
RDEB0100   MOVE     "Start             ",FROMDEB
           MOVE     SP70,STRDEB
.
RDEB0140   MOVE     FROMDEB,VAR
           CALL     DISPITEM
.
RDEB0150   MOVE     "    5",FLDID
           CALL     GETPOSIT
           CALL     KDBDBA00
           BRANCH   EXIT,RDEB0200,RDEB0999
           MOVE     DBDBDEB,ENDDEB
           PACK     TODEB,DBDBDEB,SP1,DBDBNA1
           MATCH    STRDEB,ENDDEB
           GOTO     RDEB0999 IF EQUAL
           GOTO     RDEB0999 IF NOT LESS
           BEEP
           MOVE     "To Debtor Must Be > From Debtor - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RDEB0000
.
RDEB0200   MOVE     "Finish             ",TODEB
           MOVE     Z70,ENDDEB
.
RDEB0999   MOVE     "    4",FLDID
           CALL     GETPOSIT
           RETURN
.--------------------------------------------------
. Enter NAMartment Range
.--------------------------------------------------
RNAM0000   MOVE     "    6",FLDID
           CALL     GETPOSIT
           MOVE     SP70,STRNAM
           STRIP    STRNAM
           SFORMAT  VAR,SCPSLEN
           MOVE     STRNAM,VAR
           KEYIN    *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
           MOVE     VAR,STRNAM
           SFORMAT  VAR,127
           ENDSET   STRNAM
           APPEND   SP70,STRNAM
           RESET    STRNAM
           CMATCH   EXITCHAR,STRNAM
           GOTO     RNAM0999 IF EQUAL
           MATCH    SP70,STRNAM
           GOTO     RNAM0100 IF EQUAL
           PACK     FROMNAM,STRNAM,SP70
           GOTO     RNAM0140
RNAM0100   MOVE     "Start             ",FROMNAM
           MOVE     SP70,STRNAM
.
RNAM0140   MOVE     FROMNAM,VAR
           CALL     DISPITEM
.
RNAM0150   MOVE     "    7",FLDID
           CALL     GETPOSIT
           MOVE     SP70,ENDNAM
           STRIP    ENDNAM
           SFORMAT  VAR,SCPSLEN
           MOVE     ENDNAM,VAR
           KEYIN    *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
           MOVE     VAR,ENDNAM
           SFORMAT  VAR,127
           ENDSET   ENDNAM
           APPEND   SP70,ENDNAM
           RESET    ENDNAM
           CMATCH   EXITCHAR,ENDNAM
           GOTO     RNAM0999 IF EQUAL
           MATCH    SP70,ENDNAM
           GOTO     RNAM0200 IF EQUAL
           PACK     TONAM,ENDNAM,SP70
           MATCH    STRNAM,ENDNAM
           GOTO     RNAM0999 IF EQUAL
           GOTO     RNAM0999 IF NOT LESS
           BEEP
           MOVE     "To Name Must Be > From Name - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RNAM0000
.
RNAM0200   MOVE     "Finish             ",TONAM
           MOVE     Z70,ENDNAM
.
RNAM0999   MOVE     "    6",FLDID
           CALL     GETPOSIT
           RETURN
LINE0000  MOVE    ASATDATE,SVASATDA
          MOVE    SP70,DISPMSG
          CALL    MESSAGE2
          CALL    STAPL000
          CALL    MESSAGE3
          MOVE    SVASATDA,ASATDATE
          RETURN
.------------------------------------------------------------
. Input Report Layout
.------------------------------------------------------------
KRSEQ000   CALL      DRSEQ000
           MOVE      ONE,REPTSEQ
.
KRSEQ001   KEYIN     *PCCOL:CVERT,*V2LON,*RV,REPTSEQ
           BRANCH    REPTSEQ,KRSEQ010,KRSEQ010
           BEEP
           GOTO      KRSEQ001
.
KRSEQ010   CALL      GRSEQ000
KRSEQ999   CALL      PUTSCR00
           RETURN
.
DRSEQ000  MOVE      "17",HTOP
          MOVE      "55",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P60:18,*V2LON,*ULON,"Report Sequence",*HOFF:
                    *P57:19,*V2LON,"1. ",*HOFF,"Debtor Code":
..                    *P57:20,*V2LON,"2. ",*HOFF,"Debtor Name":
                    *P57:20,*V2LON,"2. ",*HOFF,"Sortkey    "
          RETURN
.
GRSEQ000   BRANCH    REPTSEQ,GRSEQ010,GRSEQ030
.
GRSEQ010   MOVE      "Debtor Code",SEQDESC
           GOTO      GRSEQ999
.
GRSEQ020   MOVE      "Debtor Name",SEQDESC
           GOTO      GRSEQ999
.
GRSEQ030   MOVE      "Sortkey    ",SEQDESC
           GOTO      GRSEQ999
.
GRSEQ999   RETURN
.--------------------------------------------------
. Enter Sortkey Range
.--------------------------------------------------
RSKY0000  MOVE      "   17",FLDID
          CALL      GETPOSIT
          MOVE      SP70,STRSKY
          STRIP     STRSKY
          SFORMAT   VAR,SCPSLEN
          MOVE      STRSKY,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,STRSKY
          SFORMAT   VAR,127
          ENDSET    STRSKY
          APPEND    SP70,STRSKY
          RESET     STRSKY
          CMATCH    EXITCHAR,STRSKY
          GOTO      RSKY0999 IF EQUAL
          MATCH     SP70,STRSKY
          GOTO      RSKY0100 IF EQUAL
          PACK      FROMSKY,STRSKY,SP70
          GOTO      RSKY0140
RSKY0100  MOVE      "Start                    ",FROMSKY
          MOVE      SP70,STRSKY
.
RSKY0140  MOVE      FROMSKY,VAR
          CALL      DISPITEM
.
RSKY0150  MOVE      "   18",FLDID
          CALL      GETPOSIT
          MOVE      SP70,ENDSKY
          STRIP     ENDSKY
          SFORMAT   VAR,SCPSLEN
          MOVE      ENDSKY,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,ENDSKY
          SFORMAT   VAR,127
          ENDSET    ENDSKY
          APPEND    SP70,ENDSKY
          RESET     ENDSKY
          CMATCH    EXITCHAR,ENDSKY
          GOTO      RSKY0999 IF EQUAL
          MATCH     SP70,ENDSKY
          GOTO      RSKY0200 IF EQUAL
          PACK      TOSKY,ENDSKY,SP70
          MATCH     STRSKY,ENDSKY
          GOTO      RSKY0999 IF EQUAL
          GOTO      RSKY0999 IF NOT LESS
          BEEP
          MOVE      "To Sortkey Must Be > From Sortkey - ",DISPMSG
          CALL      MESSAGE1
          GOTO      RSKY0000
.
RSKY0200  MOVE      "Finish                   ",TOSKY
          MOVE      Z70,ENDSKY
.
RSKY0999  MOVE      "   17",FLDID
          CALL      GETPOSIT
          RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       DEBCODIO/INC
          INC       DEBDBTIO/INC
          INC       DEBDBTKY    
          INC       DEBDEPIO/INC
          INC       DEBDKIIO/INC
          INC       DEBDKIKY    
          INC       DEBDKIPR    
          INC       DEBFADCD    
          INC       DEBFDTIO/INC
          INC       DEBFNOIO/INC
          INC       DEBFTHIO/INC
          INC       DEBITMIO/INC
          INC       DEBOUTCD    
          INC       DEBPTYIO/INC
          INC       DEBSTACD    
          INC       DEBTSPIO/INC
          INC       IBAPRINT    
          INC       IBAPRNIO/INC
          INC       IBATMDIO/INC
          INC       IBATMHIO/INC
.
          INC       STDGENCD
.
