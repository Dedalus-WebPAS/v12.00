.--------------------------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.01  09.07.2002  Glenn Saunders
.           Recompile for changes in includes shared with Southland, but with
.           previously different formats - now merged.  Includes effected :-
.           CCSCEAFD, CCSCONFD, CCSEPSFD, CCSHCDFD, CCSHLCFD, CCSIADFD
.-------------------------------------------------------
. V9.02.00  03.06.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.---------------------------------------------------------------------------
. V6.03.00  02.10.1995 B.G.Ackland
.           Release 6.03
.---------------------------------------------------------------------------
. V6.01.04  12.04.1995 B.G.Ackland
.           Report Total
. V6.01.03  14.03.1995 B.G.Ackland
.           Page Break Optional Level 1 & 2
.--------------------------------------------------------------------------
CCSTMPA1  IFILE    SQL, FIXED=21, KEY="U1-10,11-20"
.
CCTMSEQ   DIM       10     10       1     * Sequence
CCTMLV1   DIM       10     10       11    * Casemix Code
.
.End of Record                      21
.
BEDTOT   DIM       9
CSTTOT   DIM       14
ENDLV1   DIM       10
ENDLV2   DIM       10
ENDLV3   DIM       10
EPSTOT   DIM       9
FORM6    FORM      6
INCTOT   DIM       14
STRLV1   DIM       10
STRLV2   DIM       10
STRLV3   DIM       10
VARTOT   DIM       14
VARPER   DIM       8
.
TOTNEP   FORM      6      4        11    Total Number of Episodes
TOTFTC   FORM      12.4   9        15    Comp. From Total Cost
TOTTTC   FORM      12.4   9        49    Comp. To Total Cost
TOTLTO   FORM      12.2   8        83    Total Length of Stay
TOTFMN   FORM      12.2   8        24    Comp. From Minimum Cost
TOTFMX   FORM      12.2   8        32    Comp. From Maximum Cost
TOTTMN   FORM      12.2   8        58    Comp. To Minimum Cost
TOTTMX   FORM      12.2   8        66    Comp. To Maximum Cost
TOTLMN   FORM      12.2   8        91    Minimum L.O.S.
TOTLMX   FORM      12.2   8        99    Maximum L.O.S.
.--------------------------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACEA63
.   Function      :   Variance Analysis Level 3               
.   Generated  On :   09/07/2002
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CCSCEAFD/INC
          INC       CCSCEBFD/INC
          INC       CCSCECFD/INC
          INC       CCSCEDFD/INC
          INC       CCSCEEFD/INC
          INC       CCSCEFFD/INC
          INC       CCSCEGFD/INC
          INC       CCSREPDF    
          INC       CCSSTADF    
          INC       CCSSTYFD/INC
          INC       CCSXHDFD/INC
.=========================
.Local Variable Definition
.-------------------------
CLV1DES   DIM      35 * Scr 00 Fld     9
CLV2DES   DIM      35 * Scr 00 Fld    10
CLV3DES   DIM      35 * Scr 00 Fld    11
REPTFORM  FORM      2 * Scr 00 Fld    12
REPTDESC  DIM      30 * Scr 00 Fld    13
REPTSEQ   FORM      2 * Scr 00 Fld    14
SEQDESC   DIM      30 * Scr 00 Fld    15
FROMLV1   DIM      45 * Scr 00 Fld    16
TOLV1     DIM      45 * Scr 00 Fld    17
FROMLV2   DIM      45 * Scr 00 Fld    18
TOLV2     DIM      45 * Scr 00 Fld    19
FROMLV3   DIM      45 * Scr 00 Fld    20
TOLV3     DIM      45 * Scr 00 Fld    21
DAYCDESC  DIM      25 * Scr 00 Fld    24
FROMDD    DIM      10 * Scr 00 Fld    25
TODD      DIM      10 * Scr 00 Fld    26
FROMAD    DIM      10 * Scr 00 Fld    27
TOAD      DIM      10 * Scr 00 Fld    28
VISITDES  DIM      15 * Scr 00 Fld    29
LV1BRK    FORM      1 * Scr 00 Fld    30
LV2BRK    FORM      1 * Scr 00 Fld    31
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACEA63"
PRGNAM    INIT      "Variance Analysis Level 3               "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening ccsceaaf";
          OPEN      CCSCEAA1,"ccsceaaf"
          DISPLAY   *P56:24,"Opening ccsstyaf";
          OPEN      CCSSTYA1,"ccsstyaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA1,"ccsxhdaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA2,"ccsxhdaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Options                            
          ENDIF
          RETURN
.--------------------------------
. Screen - Options                            
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      MVACCEPT
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Options                            
.-------------------------------------------------------
CF00L000
          MOVE      SP70,CCEAEID 
          MOVE      SP70,CCEADES 
          MOVE      SP70,CCEALV1 
          MOVE      SP70,CCEALV2 
          MOVE      SP70,CCEALV3 
          MOVE      SP70,CLV1DES 
          MOVE      SP70,CLV2DES 
          MOVE      SP70,CLV3DES 
          MOVE      ZERO,REPTFORM
          MOVE      SP70,REPTDESC
          MOVE      ZERO,REPTSEQ 
          MOVE      SP70,SEQDESC 
          MOVE      SP70,FROMLV1 
          MOVE      SP70,TOLV1   
          MOVE      SP70,FROMLV2 
          MOVE      SP70,TOLV2   
          MOVE      SP70,FROMLV3 
          MOVE      SP70,TOLV3   
          MOVE      SP70,CCEAVIS 
          MOVE      SP70,CCEADAY 
          MOVE      SP70,DAYCDESC
          MOVE      SP70,FROMDD  
          MOVE      SP70,TODD    
          MOVE      SP70,FROMAD  
          MOVE      SP70,TOAD    
          MOVE      SP70,VISITDES
          MOVE      ZERO,LV1BRK  
          MOVE      ZERO,LV2BRK  
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Options                            
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Options                            
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Options                            
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Options                            
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Options                            
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L101:
                            PS00L102,PS00L103,PS00L104,PS00L105:
                            PS00L106,PS00L107,PS00L108,PS00L109:
                            PS00L110,PS00L111,PS00L112,PS00L113:
                            PS00L114,PS00L115,PS00L116,PS00L117:
                            PS00L118,PS00L119,PS00L120,PS00L121:
                            PS00L122,PS00L123,PS00L124,PS00L125:
                            PS00L126,PS00L127,PS00L128
          GOTO     PS00L999
.
PS00L101
          MOVE      CCEAEID,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      CCEADES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      CCEALV1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      CCEALV2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      CCEALV3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      CLV1DES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      CLV2DES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      CLV3DES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      REPTFORM,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      REPTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      REPTSEQ,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      SEQDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      FROMLV1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      TOLV1,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      FROMLV2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      TOLV2,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          MOVE      FROMLV3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      TOLV3,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      CCEAVIS,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE      CCEADAY,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          MOVE      DAYCDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      FROMDD,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          MOVE      TODD,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          MOVE      FROMAD,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          MOVE      TOAD,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L126
          MOVE      VISITDES,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L127
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LV1BRK,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L128
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LV2BRK,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Options                            
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L104:
                            SF00L006,SF00L105,SF00L006,SF00L106:
                            SF00L006,SF00L107,SF00L006,SF00L108:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L109,SF00L110
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L103:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L104:
                            SF00L020,SF00L105,SF00L020,SF00L106:
                            SF00L020,SF00L107,SF00L020,SF00L108:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L109,SF00L110
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      REPT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF00L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF00L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF00L999
          ENDIF
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF00L000
          ENDIF
          GOTO      SF00L001
.
SF00L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEALV1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEALV2 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEALV3 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CLV1DES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CLV2DES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CLV3DES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEAVIS 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TODD    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROMAD  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOAD    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,VISITDES
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EEID0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L103
            ENDIF
            BRANCH    EXIT,SF00L103,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CCEAEID,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEADES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEALV1,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEALV2,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEALV3,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CLV1DES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CLV2DES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CLV3DES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEAVIS,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TODD,VAR         
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROMAD,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOAD,VAR         
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VISITDES,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L104
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,REPTDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EFORM000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L104
            ENDIF
            BRANCH    EXIT,SF00L104,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      REPTFORM,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      REPTDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L105
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SEQDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KRSEQ000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L105
            ENDIF
            BRANCH    EXIT,SF00L105,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      REPTSEQ,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SEQDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L106
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOLV1   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      R01LV000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L106
            ENDIF
            BRANCH    EXIT,SF00L106,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMLV1,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOLV1,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L107
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOLV2   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      R02LV000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L107
            ENDIF
            BRANCH    EXIT,SF00L107,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMLV2,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOLV2,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L108
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      R03LV000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L108
            ENDIF
            BRANCH    EXIT,SF00L108,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMLV3,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L109
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,LV1BRK  
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LV1BRK,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L110
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,LV2BRK  
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LV2BRK,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.@@@@@ Function Restart Point @@@@@
.----------------------------------------
. Move one to accept to for insert mode
.----------------------------------------
MVACCEPT  MOVE      ONE,ACCEPT
          RETURN
.------------------------------------------------------------
. Print Report
.------------------------------------------------------------
REPT0000  MOVE      ZERO,CPAGENO          * Reset Page No.
          CLOCK     TIME,CTIMEIS          * Get Current Time
          MOVE      "99",CLNO             * Initialize Last Line Number
.
          CALL      CLRRT000              * Print Banner Page
          CALL      BANN0000              * Print Banner Page
.
          DISPLAY   *P1:24,*EL,"Printing Report     : ";
          PACK      KEY10,STRLV1,SP70
          CALL      RDCCEB1
          IF        OVRCD=0
            CALL      RPCCEB1
          ENDIF
.
REPT0010  CALL      RKCCEB1
          BRANCH    OVRCD,REPT9000
          MATCH     CCEBLV1,ENDLV1
          GOTO      REPT9000 IF LESS
.
          IF       LV1BRK=0
            IF       CLNO>55
              CALL     HEAD0000
            ELSE
              PACK     KEY13,CCEALV1,CCEBLV1
              CALL     RDCCXH1
              IF       OVRCD=1
                MOVE     SP70,CCXHDES
              ENDIF
              CALL     UND132
              PRINT    CLV1DES," : ",CCEBLV1,SP1,CCXHDES
              CALL     UND132
              ADD      ONE,CLNO
            ENDIF
          ENDIF
.
          PACK      KEY20,CCEBLV1,STRLV2,SP70
          CALL      RDCCED1
          IF        OVRCD=0
            CALL      RPCCED1
          ENDIF
.
REPT0100  CALL      RKCCED1
          BRANCH    OVRCD,REPT0190
          MATCH     CCEDLV1,CCEBLV1
          GOTO      REPT0190 IF NOT EQUAL
          MATCH     CCEDLV2,ENDLV2
          GOTO      REPT0190 IF LESS
          GOTO      REPT0200
.
REPT0190  CALL      UND132       * Print Level 1 Total
          MOVE      ZERO,CLNO
          CALL      PGRN0000
          GOTO      REPT0010
.
REPT0200  IF       LV2BRK=0
            IF       CLNO>55
              CALL     HEAD0000
            ELSE
              PACK     KEY13,CCEALV2,CCEDLV2
              CALL     RDCCXH1
              IF       OVRCD=1
                MOVE     SP70,CCXHDES
              ENDIF
              CALL     UND132
              PRINT    CLV2DES," : ",CCEDLV2,SP1,CCXHDES
              CALL     UND132
              ADD      ONE,CLNO
            ENDIF
          ENDIF
.
          BRANCH    REPTSEQ,REPT2000,REPT2000,REPT2000,REPT2000,REPT2000
.
          PACK      KEY30,CCEBLV1,CCEDLV2,STRLV3,SP70
          CALL      RDCCEE1
          IF        OVRCD=0
            CALL      RPCCEE1
          ENDIF
REPT1000  CALL      RKCCEE1
          BRANCH    OVRCD,REPT8000
          MATCH     CCEELV1,CCEBLV1
          GOTO      REPT8000 IF NOT EQUAL
          MATCH     CCEELV2,CCEDLV2
          GOTO      REPT8000 IF NOT EQUAL
          MATCH     CCEELV3,ENDLV3
          GOTO      REPT8000 IF LESS
.
          CALL      PLIN0000
.
          GOTO      REPT1000
.
. Alternative Sequence
.----------------------
REPT2000  CALL      OPNTMP00
          PACK      KEY30,CCEBLV1,CCEDLV2,STRLV3,SP70
          CALL      RDCCEE1
          IF        OVRCD=0
            CALL      RPCCEE1
          ENDIF
REPT3000  CALL      RKCCEE1
          BRANCH    OVRCD,REPT4000
          MATCH     CCEELV1,CCEBLV1
          GOTO      REPT4000 IF NOT EQUAL
          MATCH     CCEELV2,CCEDLV2
          GOTO      REPT4000 IF NOT EQUAL
          MATCH     CCEELV3,ENDLV3
          GOTO      REPT4000 IF LESS
          BRANCH    REPTSEQ,REPT3100,REPT3200,REPT3300,REPT3400,REPT3500
.
REPT3100  MOVE      CCEENEP,F10
          PACK      KEY10,F10
          GOTO      REPT3900
.
REPT3200  ASSIGN    CCEEFTC/CCEENEP,F10
          PACK      KEY10,F10
          GOTO      REPT3900
.
REPT3300  ASSIGN    CCEETTC/CCEENEP,F10
          PACK      KEY10,F10
          GOTO      REPT3900
.
REPT3400  MOVE      CCEEFTC,F10
          PACK      KEY10,F10
          GOTO      REPT3900
.
REPT3500  MOVE      CCEETTC,F10
          PACK      KEY10,F10
          GOTO      REPT3900
.
REPT3900  PACK      KEY20,KEY10,CCEELV3
          UNPACK    KEY20,CCTMSEQ,CCTMLV1
          CALL      RDCCTM1
          IF        OVRCD=1
            CALL      WRCCTM1
          ENDIF
          GOTO      REPT3000
.
REPT4000  PACK      KEY20,Z70
          CALL      RSCCTM1
REPT5000  CALL      RPCCTM1
          BRANCH    OVRCD,REPT6000
          PACK      KEY30,CCEBLV1,CCEDLV2,CCTMLV1
          CALL      RDCCEE1
          BRANCH    OVRCD,REPT5000
.
          CALL      PLIN0000
.
          GOTO      REPT5000
.
REPT6000  CALL      CLSTMP00
.
REPT8000  CALL      UND132
          CALL      PTOT0000
          GOTO      REPT0100
.
REPT9000  COMPARE   ZERO,CPAGENO
          CALL      HEAD0000 IF EQUAL
          CALL      UND132
          CALL      RTOT0000
          CALL      UND132
          PRINT     *45,"****** End of Report ******"
          MOVE      ZERO,EXIT
          GOTO      REPT9999
.
REPT9900  MOVE      THREE,EXIT            * Restore Screen
          GOTO      REPT9999
.
REPT9999  RETURN
.------------------------------------------------------------
. Print Totals
.------------------------------------------------------------
PTOT0000  MOVE      CCEDNEP,CCEENEP
          MOVE      CCEDFTC,CCEEFTC
          MOVE      CCEDFMN,CCEEFMN
          MOVE      CCEDFMX,CCEEFMX
          MOVE      CCEDFSV,CCEEFSV
          MOVE      CCEDTTC,CCEETTC
          MOVE      CCEDTMN,CCEETMN
          MOVE      CCEDTMX,CCEETMX
          MOVE      CCEDTSV,CCEETSV
          MOVE      CCEDLTO,CCEELTO
          MOVE      CCEDLMN,CCEELMN
          MOVE      CCEDLMX,CCEELMX
          MOVE      CCEDLSV,CCEELSV
.
          MOVE      CCEDLV2,CCEELV3
.
          MOVE      CCEALV2,CCEALV3
          MOVE      CCEALV3,KEY3
          CALL      RDCCST1
.
          CALL      PLIN0000
.
          MOVE      CCEAEID,KEY4
          CALL      RDCCEA1
          MOVE      CCEALV3,KEY3
          CALL      RDCCST1
          IF        LV2BRK=1
            MOVE      "99",CLNO
          ENDIF
          RETURN
.------------------------------------------------------------
. Print Grand Totals
.------------------------------------------------------------
PGRN0000  MOVE      CCEBNEP,CCEENEP
          MOVE      CCEBFTC,CCEEFTC
          MOVE      CCEBFMN,CCEEFMN
          MOVE      CCEBFMX,CCEEFMX
          MOVE      CCEBFSV,CCEEFSV
          MOVE      CCEBTTC,CCEETTC
          MOVE      CCEBTMN,CCEETMN
          MOVE      CCEBTMX,CCEETMX
          MOVE      CCEBTSV,CCEETSV
          MOVE      CCEBLTO,CCEELTO
          MOVE      CCEBLMN,CCEELMN
          MOVE      CCEBLMX,CCEELMX
          MOVE      CCEBLSV,CCEELSV
.
          MOVE      CCEBLV1,CCEELV3
.
          MOVE      CCEALV1,CCEALV3
          MOVE      CCEALV3,KEY3
          CALL      RDCCST1
.
          CALL      PLIN0000
          CALL      TOTAL000
.
          MOVE      CCEAEID,KEY4
          CALL      RDCCEA1
          MOVE      CCEALV3,KEY3
          CALL      RDCCST1
          IF        LV1BRK=1
            MOVE      "99",CLNO
          ENDIF
.
          RETURN
.
.------------------------------------------------------------
. Print Line
.------------------------------------------------------------
PLIN0000  MOVE      "9,999,999",EPSTOT
          MOVE      "9,999,999",BEDTOT
          MOVE      "999,999,999.99",INCTOT
          MOVE      "999,999,999.99",CSTTOT
          MOVE      "999,999,999.99",VARTOT
          MOVE      "99,999.9",VARPER
          MOVE      CCEENEP,F12
          FEDIT     F12,EPSTOT
          MOVE      CCEELTO,F12
          FEDIT     F12,BEDTOT
          BRANCH    REPTFORM,PLIN1100,PLIN1200
.
PLIN1100  MOVE      CCEEFTC,F12P2
          FEDIT     F12P2,INCTOT
          MOVE      CCEETTC,F12P2
          FEDIT     F12P2,CSTTOT
          ASSIGN    CCEEFTC-CCEETTC,F12P2
          FEDIT     F12P2,VARTOT
          ASSIGN    ((CCEEFTC-CCEETTC)/CCEEFTC)*100,F12P1
          FEDIT     F12P1,VARPER
          GOTO      PLIN8000
.
PLIN1200  ASSIGN    CCEEFTC/CCEENEP,F12P2
          FEDIT     F12P2,INCTOT
          ASSIGN    CCEETTC/CCEENEP,F12P2
          FEDIT     F12P2,CSTTOT
          ASSIGN    (CCEEFTC-CCEETTC)/CCEENEP,F12P2
          FEDIT     F12P2,VARTOT
          ASSIGN    ((CCEEFTC-CCEETTC)/CCEEFTC)*100,F12P1
          FEDIT     F12P1,VARPER
          GOTO      PLIN8000
.
PLIN8000  COMPARE   "55",CLNO
          CALL      HEAD0000 IF NOT LESS
.
          PACK      KEY13,CCEALV3,CCEELV3
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      SP70,CCXHDES
          ENDIF
.
          PRINT     "| ",CCEELV3,SP1,CCXHDES:
                    *50,"| ",EPSTOT," | ",BEDTOT," |",INCTOT,CSTTOT,VARTOT:
                        SP4,VARPER," % |"
          ADD       ONE,CLNO
.
PLIN9999  RETURN
.------------------------------------------------------------
. Print Page Heading
.------------------------------------------------------------
HEAD0000  CALL     HEAD132
          ADD      "4",CLNO
          DISPLAY  *P23:24,*V2LON,CPAGENO
          PACK     KEY13,CCEALV1,CCEBLV1
          CALL     RDCCXH1
          PRINT    CLV1DES," : ",CCXHKEY,SP1,CCXHDES
.
          PRINT    *45,REPTDESC
          CALL     UND132
          PRINT    "| ",CLV1DES:
                   *50,"|  Episodes |  Bed Days |        Income     ":
                       "     Cost      Variance       % Var   |"
          CALL     UND132
HEAD9999  RETURN
.----------------------------------------
. Temp File Open/Create
.----------------------------------------
CLSTMP00  DISPLAY  *P1:10;
          CLOSE    CCSTMPA1,DELETE
          RETURN
.
OPNTMP00  DISPLAY  *P1:10;
          CLEAR    FILENAME
          APPEND   "cea63a",FILENAME
          APPEND   PORT,FILENAME
          RESET    FILENAME
          REP      " 0",FILENAME
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     CCSTMPA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=0
            CLOSE    CCSTMPA1,DELETE
          ENDIF
.
          CLEAR    COMMAND
          APPEND   ISBUILD,COMMAND
          APPEND   FILENAME,COMMAND
          APPEND   " 21 UC1-10,11-20",COMMAND
          RESET    COMMAND
          EXECUTE  COMMAND,TASKID
          OPEN     CCSTMPA1,FILENAME
.
          RETURN
.------------------------------------------------------------
. Print Banner Page
.------------------------------------------------------------
BANN0000  CALL     HEAD132
          DISPLAY  *P23:24,*V2LON,CPAGENO
          MOVE     "No ",KEY3
          MATCH    "1",CCEAINC
          IF       @EQUAL
            MOVE     "Yes",KEY3
          ENDIF
          CALL     UND132
          PRINT    "|",*50,"Extract Report Parameters",*132,"|"
          PRINT    "|",*132,"|"
          PRINT    "| Casemix Extract      : ",CCEAEID,SP1,CCEADES,*132,"|"
          PRINT    "|",*132,"|"
          PRINT    "| Admissions      From : ",FROMAD," to ",TOAD,*132,"|"
          PRINT    "|",*132,"|"
          PRINT    "| Discharges      From : ",FROMDD," to ",TODD,*132,"|"
          PRINT    "|",*132,"|"
          PRINT    "| Visit Types          : ",VISITDES,*132,"|"
          PRINT    "|",*132,"|"
          PRINT    "| Report Sequence      : ",SEQDESC,*132,"|"
          PRINT    "|",*132,"|"
          PRINT    "| Incompleted Episodes : ",KEY3,*132,"|"
          PRINT    "|",*132,"|"
          PRINT    "| Day Cases            : ",DAYCDESC,*132,"|"
          PRINT    "|",*132,"|"
          PRINT    "| Report Level 1       : ",CCEALV1,SP1,CLV1DES,*132,"|"
          PRINT    "|                 From : ",FROMLV1," to ",TOLV1,*132,"|"
          PRINT    "|",*132,"|"
          PRINT    "| Report Level 2       : ",CCEALV2,SP1,CLV2DES,*132,"|"
          PRINT    "|                 From : ",FROMLV2," to ",TOLV2,*132,"|"
          PRINT    "|",*132,"|"
          PRINT    "| Report Level 3       : ",CCEALV3,SP1,CLV3DES,*132,"|"
          PRINT    "|                 From : ",FROMLV3," to ",TOLV3,*132,"|"
          PRINT    "|",*132,"|"
          MOVE      "99",CLNO
          RETURN
.
.----------------------------------
. Clear Overall Report Totals.
.----------------------------------
CLRRT000  MOVE      ZERO,TOTNEP
          MOVE      ZERO,TOTTTC
          MOVE      ZERO,TOTFTC
          MOVE      ZERO,TOTLTO
.
          MOVE      "99999999",TOTFMN
          MOVE      ZERO,TOTFMX
          MOVE      "99999999",TOTTMN
          MOVE      ZERO,TOTTMX
          MOVE      "99999999",TOTLMN
          MOVE      ZERO,TOTLMX
          RETURN
.------------------------------------------------------------
. Print Report Totals
.------------------------------------------------------------
RTOT0000  MOVE      TOTNEP,CCEENEP
          MOVE      TOTFTC,CCEEFTC
          MOVE      TOTTTC,CCEETTC
          MOVE      TOTLTO,CCEELTO
          MOVE      TOTFMN,CCEEFMN
          MOVE      TOTFMX,CCEEFMX
          MOVE      TOTTMN,CCEETMN
          MOVE      TOTTMX,CCEETMX
          MOVE      TOTLMN,CCEELMN
          MOVE      TOTLMX,CCEELMX
.
          MOVE      ZERO,CCEETSV
          MOVE      ZERO,CCEEFSV
          MOVE      ZERO,CCEELSV
.
          MOVE      "10",CCSTLEN
          MOVE      "Totals",CCEELV3
          CALL      PLIN0000
.
          RETURN
.----------------------------------------
. Add Totals
.----------------------------------------
TOTAL000  IF        CCEBFMN<TOTFMN
            MOVE      CCEBFMN,TOTFMN
          ENDIF
          IF        CCEBFMX>TOTFMX
            MOVE      CCEBFMX,TOTFMX
          ENDIF
.
          IF        CCEBTMN<TOTTMN
            MOVE      CCEBTMN,TOTTMN
          ENDIF
          IF        CCEBTMX>TOTTMX
            MOVE      CCEBTMX,TOTTMX
          ENDIF
.
          IF        CCEBLMN<TOTLMN
            MOVE      CCEBLMN,TOTLMN
          ENDIF
          IF        CCEBLMX>TOTLMX
            MOVE      CCEBLMX,TOTLMX
          ENDIF
.
          ADD       CCEBNEP,TOTNEP
          ADD       CCEBFTC,TOTFTC
          ADD       CCEBTTC,TOTTTC
          ADD       CCEBLTO,TOTLTO
.
          RETURN
.
.----------------------------------------------------------------------
. Enter Casemix Extract ID
.----------------------------------------------------------------------
EEID0000  MOVE      ZERO,CKEYTYP
          CALL      CCSCOPCL         * Close Files
          CALL      KCCEAA00
          BRANCH    EXIT,EEID9999,EEID9999
          CALL      GETCME00
          CALL      CCSCOPOP         * Open Files
EEID9999  RETURN
.======================================================================
. Determine Display Values for a Valid Casemix Extract Code
.======================================================================
GETCME00  MATCH     SP70,CCEAFDD
          IF        @EQUAL
            MOVE      "Start     ",FROMDD
          ELSE
            UNPACK    CCEAFDD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,FROMDD
          ENDIF
.
          MATCH     "99999999",CCEATDD
          IF        @EQUAL
            MOVE      "Finish    ",TODD
          ELSE
            UNPACK    CCEATDD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,TODD
          ENDIF
.
          MATCH     SP70,CCEAFAD
          IF        @EQUAL
            MOVE      "Start     ",FROMAD
          ELSE
            UNPACK    CCEAFAD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,FROMAD
          ENDIF
.
          MATCH     "99999999",CCEATAD
          IF        @EQUAL
            MOVE      "Finish    ",TOAD
          ELSE
            UNPACK    CCEATAD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,TOAD
          ENDIF
.
          MOVE     CCEAVIS,F1
          BRANCH   F1,GETCME10,GETCME20,GETCME30
          MOVE     "All        ",VISITDES
          GOTO     GETCME40
GETCME10  MOVE     "A & E      ",VISITDES
          GOTO     GETCME40
GETCME20  MOVE     "Outpatients ",VISITDES
          GOTO     GETCME40
GETCME30  MOVE     "Inpatients",VISITDES
          GOTO     GETCME40
.
GETCME40  MOVE     SP70,CLV1DES
          MOVE     SP70,CLV2DES
          MOVE     SP70,CLV3DES
.
          MOVE     CCEALV1,KEY3
          CALL     RDCCST1
          MOVE     CCSTDES,CLV1DES
.
          MATCH    SP70,CCEALV2
          IF       !@EQUAL
            MOVE     CCEALV2,KEY3
            CALL     RDCCST1
            MOVE     CCSTDES,CLV2DES
          ENDIF
.
          MATCH    SP70,CCEALV3
          IF       !@EQUAL
            MOVE     CCEALV3,KEY3
            CALL     RDCCST1
            MOVE     CCSTDES,CLV3DES
          ENDIF
.
          MOVE       CCEADAY,F1
          IF         F1=0
            MOVE       "Exclude Day Cases",DAYCDESC
          ELSE
            IF         F1=2
              MOVE       "Day Cases Only",DAYCDESC
            ELSE
              MOVE       "Include Day Cases",DAYCDESC
            ENDIF
          ENDIF
.
          RETURN
.------------------------------------------------------------
. Enter Format
.------------------------------------------------------------
EFORM000  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          DISPLAY   *P1:24,*EL,"Report Format : ":
                    *V2LON,"1",*HOFF,". Total Income/Cost , ":
                    *V2LON,"2",*HOFF,". Average Income/Cost"
EFORM100  KEYIN     *PCCOL:CVERT,*V2LON,REPTFORM
          BRANCH    REPTFORM,EFORM110,EFORM120
          BEEP
          GOTO      EFORM100
.
EFORM110  MOVE      "Total Income/Cost Analysis     ",REPTDESC
          GOTO      EFORM999
.
EFORM120  MOVE      "Average Income/Cost Analysis  ",REPTDESC
          GOTO      EFORM999
.
EFORM999  CALL      MESSAGE3
          RETURN
.
.------------------------------------------------------------
. Enter Sequence
.------------------------------------------------------------
KRSEQ000  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          DISPLAY   *P1:24,*EL,"Sequence : ":
                    *V2LON,"0",*HOFF,".Code, ":
                    *V2LON,"1",*HOFF,".Episodes, ":
                    *V2LON,"2",*HOFF,".Avg. Income, ":
                    *V2LON,"3",*HOFF,".Avg. Cost, ":
                    *V2LON,"4",*HOFF,".Total Income, ":
                    *V2LON,"5",*HOFF,".Total Cost"
KRSEQ100  KEYIN     *PCCOL:CVERT,*V2LON,REPTSEQ
          MOVE      "By Casemix Code ",SEQDESC
          COMPARE   ZERO,REPTSEQ
          GOTO      KRSEQ999 IF EQUAL
          BRANCH    REPTSEQ,KRSEQ110,KRSEQ120,KRSEQ130,KRSEQ140,KRSEQ150
          BEEP
          GOTO      KRSEQ100
.
KRSEQ110  MOVE      "By Number of Episodes",SEQDESC
          GOTO      KRSEQ999
.
KRSEQ120  MOVE      "By Average Income",SEQDESC
          GOTO      KRSEQ999
.
KRSEQ130  MOVE      "By Average Cost",SEQDESC
          GOTO      KRSEQ999
.
KRSEQ140  MOVE      "By Total Income",SEQDESC
          GOTO      KRSEQ999
.
KRSEQ150  MOVE      "By Total Cost",SEQDESC
          GOTO      KRSEQ999
.
KRSEQ999  CALL      MESSAGE3
          RETURN
.
.----------------------------------------------------------------------
. Enter Code Range
.----------------------------------------------------------------------
R01LV000
           IF       ACCEPT=1
             MOVE     SP70,STRLV1
             MOVE     Z70,ENDLV1
             MOVE     "Start",FROMLV1
             MOVE     "Finish",TOLV1
             GOTO     R01LV999
           ENDIF
.
           MOVE     "   16",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
.
           MOVE     CCEALV1,CCXHSTY
           CALL     EXHD0000
           BRANCH   EXIT,R01LV100,R01LV999
           MOVE     CCXHKEY,STRLV1
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     FROMLV1,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
           GOTO     R01LV140
.
R01LV100   MOVE     "Start             ",FROMLV1
           MOVE     SP70,STRLV1
.
R01LV140   MOVE     FROMLV1,VAR
           CALL     DISPITEM
.
R01LV150   MOVE     "   17",FLDID
           CALL     GETPOSIT
.
           MOVE     CCEALV1,CCXHSTY
           CALL     EXHD0000
           BRANCH   EXIT,R01LV200,R01LV999
           MOVE     CCXHKEY,ENDLV1
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     TOLV1,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
           MATCH    STRLV1,ENDLV1
           GOTO     R01LV999 IF EQUAL
           GOTO     R01LV999 IF NOT LESS
           BEEP
           MOVE     "To Casemix Code Must Be > From Casemix Code - ",DISPMSG
           CALL     MESSAGE1
           GOTO     R01LV000
.
R01LV200   MOVE     "Finish             ",TOLV1
           MOVE     Z70,ENDLV1
.
R01LV999   MOVE     "   16",FLDID
           CALL     GETPOSIT
           RETURN
.---------------------------------------------------------------------------
. Enter Casemix Code
.-------------------------------------------------------------------------------
EXHD0000  TOPIC     "CCXHKEY "
          MOVE      CCXHSTY,KEY3
          CALL      RDCCST1
          SFORMAT   VAR,CCSTLEN
          MATCH     "1",CCSTJR
          IF        @EQUAL
            KEYIN     *PCCOL:CVERT,*V2LON,*JR,VAR
          ELSE
            KEYIN     *PCCOL:CVERT,*V2LON,VAR
          ENDIF
.
          MATCH     "1",CCSTZF
          IF        @EQUAL
            REP       " 0",VAR
          ENDIF
.
          DISPLAY     *PCCOL:CVERT,*V2LON,VAR
.
          ENDSET    VAR
          APPEND    SP70,VAR
          RESET     VAR
.
          MATCH     SP70,VAR
          GOTO      EXHD0090 IF EQUAL
.
          MATCH     "1",CCSTJR
          IF        @EQUAL
            ENDSET    VAR
          ENDIF
          CMATCH    EXITCHAR,VAR
          GOTO      EXHD0095 IF EQUAL
.
          CMATCH    QUEST,VAR
          GOTO      EXHD0010 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCXHA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCXHKEY
          APPEND    SP70,CCXHKEY
          RESET     CCXHKEY
.
          MATCH     SP70,CCXHKEY
          GOTO      EXHD0000 IF EQUAL
          MOVE      CCXHKEY,VAR
.
          DISPLAY   *PCCOL:CVERT,*V2LON,VAR
EXHD0010
          RESET     VAR
          MATCH     "1",CCSTDE
          IF        @EQUAL
            TYPE      VAR
            GOTO      EXHD0015 IF EQUAL
            BEEP
            GOTO      EXHD0000
          ENDIF
EXHD0015
          MOVE      VAR,CCXHKEY
          PACK      KEY13,CCXHSTY,VAR
          CALL      RACCXH1
          BRANCH    OVRCD,EXHD0080
          CALL      RDCCXH1
          MOVE      ZERO,EXIT
          GOTO      EXHD0099
.
EXHD0080  MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,EXHD0099,EXHD0099
          MOVE      "Code Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      EXHD0000
.
EXHD0085  MOVE      SP70,CCXHKEY
          MOVE      ZERO,EXIT
          GOTO      EXHD0099
.
EXHD0090  MOVE      SP70,CCXHKEY
          MOVE      ONE,EXIT
          GOTO      EXHD0099
.
EXHD0095  MOVE      TWO,EXIT
.
EXHD0099  SFORMAT   VAR,127
          TOPIC     PRGID
          RETURN
.----------------------------------------------------------------------
. Enter Code Range
.----------------------------------------------------------------------
R02LV000   MOVE     "   18",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           IF       ACCEPT=1
             MOVE     SP70,STRLV2
             MOVE     Z70,ENDLV2
             MOVE     "Start",FROMLV2
             MOVE     "Finish",TOLV2
             GOTO     R02LV999
           ENDIF
.
           MATCH    SP70,CCEALV2
           IF       @EQUAL
             MOVE     "Start             ",FROMLV2
             MOVE     SP70,STRLV2
             MOVE     "Finish             ",TOLV2
             MOVE     Z70,ENDLV2
             BEEP
             GOTO     R02LV999
           ENDIF
.
           MOVE     CCEALV2,CCXHSTY
           CALL     EXHD0000
           BRANCH   EXIT,R02LV100,R02LV999
           MOVE     CCXHKEY,STRLV2
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     FROMLV2,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
           GOTO     R02LV140
.
R02LV100   MOVE     "Start             ",FROMLV2
           MOVE     SP70,STRLV2
.
R02LV140   MOVE     FROMLV2,VAR
           CALL     DISPITEM
.
R02LV150   MOVE     "   19",FLDID
           CALL     GETPOSIT
.
           MOVE     CCEALV2,CCXHSTY
           CALL     EXHD0000
           BRANCH   EXIT,R02LV200,R02LV999
           MOVE     CCXHKEY,ENDLV2
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     TOLV2,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
           MATCH    STRLV2,ENDLV2
           GOTO     R02LV999 IF EQUAL
           GOTO     R02LV999 IF NOT LESS
           BEEP
           MOVE     "To Casemix Code Must Be > From Casemix Code - ",DISPMSG
           CALL     MESSAGE1
           GOTO     R02LV000
.
R02LV200   MOVE     "Finish             ",TOLV2
           MOVE     Z70,ENDLV2
.
R02LV999   MOVE     "   18",FLDID
           CALL     GETPOSIT
           RETURN
.----------------------------------------------------------------------
. Enter Code Range
.----------------------------------------------------------------------
R03LV000   MOVE     "   20",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           IF       ACCEPT=1
             MOVE     SP70,STRLV3
             MOVE     Z70,ENDLV3
             MOVE     "Start",FROMLV3
             MOVE     "Finish",TOLV3
             GOTO     R03LV999
           ENDIF
.
           MATCH    SP70,CCEALV3
           IF       @EQUAL
             MOVE     "Start             ",FROMLV3
             MOVE     SP70,STRLV3
             MOVE     "Finish             ",TOLV3
             MOVE     Z70,ENDLV3
             BEEP
             GOTO     R03LV999
           ENDIF
.
           MOVE     CCEALV3,CCXHSTY
           CALL     EXHD0000
           BRANCH   EXIT,R03LV100,R03LV999
           MOVE     CCXHKEY,STRLV3
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     FROMLV3,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
           GOTO     R03LV140
.
R03LV100   MOVE     "Start             ",FROMLV3
           MOVE     SP70,STRLV3
.
R03LV140   MOVE     FROMLV3,VAR
           CALL     DISPITEM
.
R03LV150   MOVE     "   21",FLDID
           CALL     GETPOSIT
.
           MOVE     CCEALV3,CCXHSTY
           CALL     EXHD0000
           BRANCH   EXIT,R03LV200,R03LV999
           MOVE     CCXHKEY,ENDLV3
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     TOLV3,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
           MATCH    STRLV3,ENDLV3
           GOTO     R03LV999 IF EQUAL
           GOTO     R03LV999 IF NOT LESS
           BEEP
           MOVE     "To Casemix Code Must Be > From Casemix Code - ",DISPMSG
           CALL     MESSAGE1
           GOTO     R03LV000
.
R03LV200   MOVE     "Finish             ",TOLV3
           MOVE     Z70,ENDLV3
.
R03LV999   MOVE     "   20",FLDID
           CALL     GETPOSIT
           RETURN

.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CCR58TIO    
          INC       CCSCEAIO/INC
          INC       CCSCEAKY    
          INC       CCSCEBIO/INC
          INC       CCSCECIO/INC
          INC       CCSCEDIO/INC
          INC       CCSCEEIO/INC
          INC       CCSCOPCD    
          INC       CCSSTACD    
          INC       CCSSTYIO/INC
          INC       CCSXHDIO/INC
          INC       CCSXHDKY    
.
          INC       STDGENCD
.
