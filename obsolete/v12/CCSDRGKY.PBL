.---------------------------------------------------------------------------
.   System    :   Clinical Costing System            
.   Include   :   CCSDRGKY
.   Routine   :   HCCDGA00 Drg Code            
.   Return    :           
.-------------------------------------------------------------------------------
HCCDGA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HCCDGA04
          CALL      GSCRN000
          BRANCH    EXIT,HCCDGA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Drg"                
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 5",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "61",STDCOL03
HCCDGA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,CCDGDRGC
          PACK      KEY4,CCDGDRGC,SP70                                          
.                                                                               
.                                                                               
          CALL      RSCCDG1 
HCCDGA10
          CALL      RKCCDG1 
          BRANCH    OVRCD,HCCDGA15
          PACK      KEY4,CCDGDRGC,SP70                                          
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HCCDGA12
          CALL      HCCDGA60
          BRANCH    OVRCD,HCCDGA10
HCCDGA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,CCDGDRGC
          DISPLAY   *PSTDCOL02:STDROW,CCDGDES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HCCDGA10 IF NOT EQUAL
HCCDGA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HCCDGA20
          CALL      HSCRI000
          BRANCH    EXIT,HCCDGA30,HCCDGA35,HCCDGA40,HCCDGA45,HCCDGA04:
                              HCCDGA91,HCCDGA50
          GOTO      HCCDGA92
HCCDGA30
          CALL      RKCCDG1 
          BRANCH    OVRCD,HCCDGA85
          PACK      KEY4,CCDGDRGC,SP70                                          
.                                                                               
.                                                                               
          CALL      RPCCDG1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCDGA10
HCCDGA35
          MOVE      ST1,KEY4 
          CALL      RDCCDG1 
          CALL      RPCCDG1 
          BRANCH    OVRCD,HCCDGA85
          PACK      KEY4,CCDGDRGC,SP70                                          
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HCCDGA36
          CALL      RPCCDG1 
          BRANCH    OVRCD,HCCDGA37
          PACK      KEY4,CCDGDRGC,SP70                                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCCDGA36 IF NOT EQUAL
HCCDGA37
          MOVE      ZERO,XITEMNO
          GOTO      HCCDGA10
HCCDGA40
          MOVE      ST1,KEY4 
          CALL      RDCCDG1 
          CALL      RPCCDG1 
          BRANCH    OVRCD,HCCDGA85
          PACK      KEY4,CCDGDRGC,SP70                                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCDGA08
HCCDGA45
          CALL      RKCCDG1 
          BRANCH    OVRCD,HCCDGA85
          PACK      KEY4,CCDGDRGC,SP70                                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY4,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSCCDG1 
HCCDGA46
          CALL      RPCCDG1 
          BRANCH    OVRCD,HCCDGA47
          PACK      KEY4,CCDGDRGC,SP70                                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCCDGA46 IF NOT EQUAL
HCCDGA47
          MOVE      ZERO,XITEMNO
          GOTO      HCCDGA10
HCCDGA50  COMPARE   ZERO,CSEARCH
          GOTO      HCCDGA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCDGA08
HCCDGA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCDGA08
HCCDGA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HCCDGA61 IF EQUAL
          MATCH     SCHFLD01,CCDGDRGC
          GOTO      HCCDGA72 IF NOT EQUAL
HCCDGA61
          MATCH     SP70,SCHFLD02
          GOTO      HCCDGA62 IF EQUAL
          MATCH     SCHFLD02,CCDGDES 
          GOTO      HCCDGA72 IF NOT EQUAL
HCCDGA62
HCCDGA63
HCCDGA64
HCCDGA65
HCCDGA66
HCCDGA67
HCCDGA68
HCCDGA69
HCCDGA70
          GOTO      HCCDGA75
HCCDGA72  MOVE      ONE,OVRCD
HCCDGA75  RETURN
HCCDGA85
          LOAD      KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,CCDGDRGC                                               
          CALL      RDCCDG1 
HCCDGA90
.                                                                               
          BEEP
          GOTO      HCCDGA20
HCCDGA91
          MOVE      SP70,CCDGDES 
          MOVE      SP70,CCDGMDC 
          MOVE      ZERO,CCDGWAR 
          MOVE      SP70,CCDGTYP 
          MOVE      SP70,CCDGSDR 
          MOVE      SP70,CCDGSDT 
          MOVE      ZERO,CCDGLOW 
          MOVE      ZERO,CCDGHIG 
          MOVE      ZERO,CCDGSLOS
          MOVE      ZERO,CCDGSWGT
          MOVE      ZERO,CCDGNAT 
          MOVE      ZERO,CCDGNLOS
          MOVE      SP70,CCDGSPA 
          MOVE      SP70,KEY4 
          MOVE      SP70,CCDGDRGC
          GOTO      HCCDGA96
HCCDGA92
          MOVE      SP70,KEY4 
          MOVE      SP70,CCDGDRGC
          LOAD      KEY4,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,CCDGDRGC                                               
HCCDGA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HCCDGA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Clinical Costing System            
.   Include   :   CCSDRGKY
.   Routine   :   KCCDGA00 Keyin Drg Code            
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KCCDGA00 TOPIC     "CCDGDRGC"
          MOVE      UNDLN70,CCDGDRGC
          KEYIN     *PCCOL:CVERT,*DV,CCDGDRGC:                                  
                    *PCCOL:CVERT,*V2LON,CCDGDRGC:                               
                    *PCCOL:CVERT,*DV,CCDGDRGC
.
          ENDSET    CCDGDRGC
          APPEND    SP70,CCDGDRGC
          RESET     CCDGDRGC
.
          MATCH     SP70,CCDGDRGC
          GOTO      KCCDGA90 IF EQUAL
.
          CMATCH    EXITCHAR,CCDGDRGC
          GOTO      KCCDGA95 IF EQUAL
.
          CMATCH    QUEST,CCDGDRGC
          GOTO      KCCDGA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCDGA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCDGDRGC
          APPEND    SP70,CCDGDRGC
          RESET     CCDGDRGC
.
          MATCH     SP70,CCDGDRGC
          GOTO      KCCDGA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,CCDGDRGC                                
KCCDGA10
          PACK      KEY4,CCDGDRGC                                               
          CALL      RACCDG1 
          BRANCH    OVRCD,KCCDGA80
          BRANCH    CKEYTYP,KCCDGA75
          CALL      RDCCDG1 
KCCDGA70
          MOVE      ZERO,EXIT
          GOTO      KCCDGA99
KCCDGA75
          MOVE      "Drg Code Already Exist - ",DISPMSG                                              
          CALL      MESSAGE1
          GOTO      KCCDGA00
KCCDGA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KCCDGA99,KCCDGA99
          MOVE      "Drg Code Does Not Exist - ",DISPMSG                                             
          CALL      MESSAGE1
          GOTO      KCCDGA00
KCCDGA90
          MOVE      ONE,EXIT
          GOTO      KCCDGA99
KCCDGA95
          MOVE      TWO,EXIT
KCCDGA99 TOPIC    PRGID
          RETURN
