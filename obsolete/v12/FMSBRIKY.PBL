.---------------------------------------------------------------------------
.   System    :   Financial Management System        
.   Include   :   FMSBRIKY
.   Routine   :   HFMBRA00 Import Rule         
.   Return    :           
.-------------------------------------------------------------------------------
HFMBRA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HFMBRA04
          CALL      GSCRN000
          BRANCH    EXIT,HFMBRA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Rule ID"            
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 8",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "36",STDCOL03
HFMBRA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,FMBRRID 
          PACK      KEY3,FMBRRID,SP70                                           
.                                                                               
.                                                                               
          CALL      RSFMBR1 
HFMBRA10
          CALL      RKFMBR1 
          BRANCH    OVRCD,HFMBRA15
          PACK      KEY3,FMBRRID,SP70                                           
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HFMBRA12
          CALL      HFMBRA60
          BRANCH    OVRCD,HFMBRA10
HFMBRA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY3,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,FMBRRID 
          DISPLAY   *PSTDCOL02:STDROW,FMBRDES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HFMBRA10 IF NOT EQUAL
HFMBRA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HFMBRA20
          CALL      HSCRI000
          BRANCH    EXIT,HFMBRA30,HFMBRA35,HFMBRA40,HFMBRA45,HFMBRA04:
                              HFMBRA91,HFMBRA50
          GOTO      HFMBRA92
HFMBRA30
          CALL      RKFMBR1 
          BRANCH    OVRCD,HFMBRA85
          PACK      KEY3,FMBRRID,SP70                                           
.                                                                               
.                                                                               
          CALL      RPFMBR1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMBRA10
HFMBRA35
          MOVE      ST1,KEY3 
          CALL      RDFMBR1 
          CALL      RPFMBR1 
          BRANCH    OVRCD,HFMBRA85
          PACK      KEY3,FMBRRID,SP70                                           
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HFMBRA36
          CALL      RPFMBR1 
          BRANCH    OVRCD,HFMBRA37
          PACK      KEY3,FMBRRID,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HFMBRA36 IF NOT EQUAL
HFMBRA37
          MOVE      ZERO,XITEMNO
          GOTO      HFMBRA10
HFMBRA40
          MOVE      ST1,KEY3 
          CALL      RDFMBR1 
          CALL      RPFMBR1 
          BRANCH    OVRCD,HFMBRA85
          PACK      KEY3,FMBRRID,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMBRA08
HFMBRA45
          CALL      RKFMBR1 
          BRANCH    OVRCD,HFMBRA85
          PACK      KEY3,FMBRRID,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY3,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSFMBR1 
HFMBRA46
          CALL      RPFMBR1 
          BRANCH    OVRCD,HFMBRA47
          PACK      KEY3,FMBRRID,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HFMBRA46 IF NOT EQUAL
HFMBRA47
          MOVE      ZERO,XITEMNO
          GOTO      HFMBRA10
HFMBRA50  COMPARE   ZERO,CSEARCH
          GOTO      HFMBRA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMBRA08
HFMBRA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMBRA08
HFMBRA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HFMBRA61 IF EQUAL
          MATCH     SCHFLD01,FMBRRID 
          GOTO      HFMBRA72 IF NOT EQUAL
HFMBRA61
          MATCH     SP70,SCHFLD02
          GOTO      HFMBRA62 IF EQUAL
          MATCH     SCHFLD02,FMBRDES 
          GOTO      HFMBRA72 IF NOT EQUAL
HFMBRA62
HFMBRA63
HFMBRA64
HFMBRA65
HFMBRA66
HFMBRA67
HFMBRA68
HFMBRA69
HFMBRA70
          GOTO      HFMBRA75
HFMBRA72  MOVE      ONE,OVRCD
HFMBRA75  RETURN
HFMBRA85
          LOAD      KEY3,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY3,FMBRRID                                                
          CALL      RDFMBR1 
HFMBRA90
.                                                                               
          BEEP
          GOTO      HFMBRA20
HFMBRA91
          MOVE      SP70,FMBRDES 
          MOVE      SP70,FMBRBSC 
          MOVE      SP70,FMBRCHQ 
          MOVE      SP70,FMBRNOR 
          MOVE      SP70,FMBRLOG 
          MOVE      SP70,FMBRLED 
          MOVE      SP70,FMBRDAC 
          MOVE      SP70,FMBRCAC 
          MOVE      SP70,FMBRDIS 
          MOVE      SP70,FMBRRES 
          MOVE      SP70,FMBRTDS 
          MOVE      SP70,FMBRTRF 
          MOVE      SP70,FMBRAUT 
          MOVE      SP70,FMBRUR1 
          MOVE      SP70,FMBRUR2 
          MOVE      SP70,FMBRUD1 
          MOVE      SP70,FMBRUD2 
          MOVE      SP70,FMBRUY1 
          MOVE      SP70,FMBRUY2 
          MOVE      SP70,FMBRSPA 
          MOVE      SP70,KEY3 
          MOVE      SP70,FMBRRID 
          GOTO      HFMBRA96
HFMBRA92
          MOVE      SP70,KEY3 
          MOVE      SP70,FMBRRID 
          LOAD      KEY3,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY3,FMBRRID                                                
HFMBRA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HFMBRA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Financial Management System        
.   Include   :   FMSBRIKY
.   Routine   :   KFMBRA00 Keyin Import Rule ID      
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KFMBRA00 TOPIC     "FMBRRID "
          MOVE      UNDLN70,FMBRRID 
          KEYIN     *PCCOL:CVERT,*DV,FMBRRID:                                   
                    *PCCOL:CVERT,*V2LON,FMBRRID:                                
                    *PCCOL:CVERT,*DV,FMBRRID 
.
          ENDSET    FMBRRID 
          APPEND    SP70,FMBRRID 
          RESET     FMBRRID 
.
          MATCH     SP70,FMBRRID 
          GOTO      KFMBRA90 IF EQUAL
.
          CMATCH    EXITCHAR,FMBRRID 
          GOTO      KFMBRA95 IF EQUAL
.
          CMATCH    QUEST,FMBRRID 
          GOTO      KFMBRA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HFMBRA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    FMBRRID 
          APPEND    SP70,FMBRRID 
          RESET     FMBRRID 
.
          MATCH     SP70,FMBRRID 
          GOTO      KFMBRA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,FMBRRID                                 
KFMBRA10
          PACK      KEY3,FMBRRID                                                
          CALL      RAFMBR1 
          BRANCH    OVRCD,KFMBRA80
          BRANCH    CKEYTYP,KFMBRA75
          CALL      RDFMBR1 
KFMBRA70
          MOVE      ZERO,EXIT
          GOTO      KFMBRA99
KFMBRA75
          MOVE      "Import Rule ID Already Exist - ",DISPMSG                                        
          CALL      MESSAGE1
          GOTO      KFMBRA00
KFMBRA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KFMBRA99,KFMBRA99
          MOVE      "Import Rule ID Does Not Exist - ",DISPMSG                                       
          CALL      MESSAGE1
          GOTO      KFMBRA00
KFMBRA90
          MOVE      ONE,EXIT
          GOTO      KFMBRA99
KFMBRA95
          MOVE      TWO,EXIT
KFMBRA99 TOPIC    PRGID
          RETURN
