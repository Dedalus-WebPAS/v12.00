.---------------------------------------------------------------------------
.   System    :   Clinical Costing System            
.   Include   :   CCSPDPKY
.   Routine   :   HCCPDA00 Patient Service           
.   Return    :   CCHCHCD 
.-------------------------------------------------------------------------------
HCCPDA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "30",HLEF
            MOVE      "80",HRIG
          ENDIF
HCCPDA04
          CALL      GSCRN000
          BRANCH    EXIT,HCCPDA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Pat.Serv."          
.
          MOVE      STDCOL01,STDCOL02
          ADD       "10",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Group"              
.
          MOVE      STDCOL02,STDCOL03
          ADD       " 6",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL03,STDCOL04
          ADD       "36",STDCOL04
HCCPDA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,CCPDPCD 
          PACK      KEY18,CCPDHCD,CCPDDPT,CCPDPCD,SP70                          
          PACK      SAVKEY80,CCPDHCD,CCPDDPT,CCPDPCD,SP70                       
          SETLPTR   SAVKEY80,10                                                 
          CALL      RSCCPD1 
HCCPDA10
          CALL      RKCCPD1 
          BRANCH    OVRCD,HCCPDA15
          PACK      KEY18,CCPDHCD,CCPDDPT,CCPDPCD,SP70                          
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HCCPDA15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,HCCPDA12
          CALL      HCCPDA60
          BRANCH    OVRCD,HCCPDA10
HCCPDA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY18,XITEMNO,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,CCPDPCD 
          DISPLAY   *PSTDCOL02:STDROW,CCPDGCD 
          DISPLAY   *PSTDCOL03:STDROW,CCPDDES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HCCPDA10 IF NOT EQUAL
HCCPDA15
          UNPACK    SAVKEY80,CCPDHCD,CCPDDPT,CCPDPCD                            
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HCCPDA20
          CALL      HSCRI000
          BRANCH    EXIT,HCCPDA30,HCCPDA35,HCCPDA40,HCCPDA45,HCCPDA04:
                              HCCPDA91,HCCPDA50
          GOTO      HCCPDA92
HCCPDA30
          CALL      RKCCPD1 
          BRANCH    OVRCD,HCCPDA85
          PACK      KEY18,CCPDHCD,CCPDDPT,CCPDPCD,SP70                          
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HCCPDA85 IF NOT EQUAL                                       
          CALL      RPCCPD1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCPDA10
HCCPDA35
          MOVE      ST1,KEY18
          CALL      RDCCPD1 
          CALL      RPCCPD1 
          BRANCH    OVRCD,HCCPDA85
          PACK      KEY18,CCPDHCD,CCPDDPT,CCPDPCD,SP70                          
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HCCPDA85 IF NOT EQUAL                                       
          MATCH     SP70,CCPDPCD                                                
          GOTO      HCCPDA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HCCPDA36
          CALL      RPCCPD1 
          BRANCH    OVRCD,HCCPDA37
          PACK      KEY18,CCPDHCD,CCPDDPT,CCPDPCD,SP70                          
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HCCPDA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCCPDA36 IF NOT EQUAL
HCCPDA37
          MOVE      ZERO,XITEMNO
          GOTO      HCCPDA10
HCCPDA40
          MOVE      ST1,KEY18
          CALL      RDCCPD1 
          CALL      RPCCPD1 
          BRANCH    OVRCD,HCCPDA85
          PACK      KEY18,CCPDHCD,CCPDDPT,CCPDPCD,SP70                          
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HCCPDA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCPDA08
HCCPDA45
          CALL      RKCCPD1 
          BRANCH    OVRCD,HCCPDA85
          PACK      KEY18,CCPDHCD,CCPDDPT,CCPDPCD,SP70                          
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HCCPDA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY18,SAVKEY80,Z70                                          
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSCCPD1 
HCCPDA46
          CALL      RPCCPD1 
          BRANCH    OVRCD,HCCPDA47
          PACK      KEY18,CCPDHCD,CCPDDPT,CCPDPCD,SP70                          
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HCCPDA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCCPDA46 IF NOT EQUAL
HCCPDA47
          MOVE      ZERO,XITEMNO
          GOTO      HCCPDA10
HCCPDA50  COMPARE   ZERO,CSEARCH
          GOTO      HCCPDA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCPDA08
HCCPDA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCPDA08
HCCPDA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HCCPDA61 IF EQUAL
          MATCH     SCHFLD01,CCPDPCD 
          GOTO      HCCPDA72 IF NOT EQUAL
HCCPDA61
          MATCH     SP70,SCHFLD02
          GOTO      HCCPDA62 IF EQUAL
          MATCH     SCHFLD02,CCPDGCD 
          GOTO      HCCPDA72 IF NOT EQUAL
HCCPDA62
          MATCH     SP70,SCHFLD03
          GOTO      HCCPDA63 IF EQUAL
          MATCH     SCHFLD03,CCPDDES 
          GOTO      HCCPDA72 IF NOT EQUAL
HCCPDA63
HCCPDA64
HCCPDA65
HCCPDA66
HCCPDA67
HCCPDA68
HCCPDA69
HCCPDA70
          GOTO      HCCPDA75
HCCPDA72  MOVE      ONE,OVRCD
HCCPDA75  RETURN
HCCPDA85
          LOAD      KEY18,XITEMNO,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY18,CCPDHCD,CCPDDPT,CCPDPCD                               
          CALL      RDCCPD1 
HCCPDA90
          UNPACK    SAVKEY80,CCPDHCD,CCPDDPT,CCPDPCD                            
          BEEP
          GOTO      HCCPDA20
HCCPDA91
          MOVE      SP70,CCPDGCD 
          MOVE      SP70,CCPDDES 
          MOVE      ZERO,CCPDSTC 
          MOVE      ZERO,CCPDRVI 
          MOVE      SP70,CCPDSEQ
          MOVE      SP70,CCPDSUS
          MOVE      SP70,CCPDSPA 
          MOVE      SP70,KEY18
          MOVE      SP70,CCPDPCD 
          GOTO      HCCPDA96
HCCPDA92
          MOVE      SP70,KEY18
          MOVE      SP70,CCPDPCD 
          LOAD      KEY18,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY18,CCPDHCD,CCPDDPT,CCPDPCD                               
HCCPDA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HCCPDA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Clinical Costing System            
.   Include   :   CCSPDPKY
.   Routine   :   KCCPDA00 Keyin Pat.Serv.           
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KCCPDA00 TOPIC     "CCPDPCD "
          MOVE      UNDLN70,CCPDPCD 
          KEYIN     *PCCOL:CVERT,*DV,CCPDPCD:                                   
                    *PCCOL:CVERT,*V2LON,CCPDPCD:                                
                    *PCCOL:CVERT,*DV,CCPDPCD 
.
          ENDSET    CCPDPCD 
          APPEND    SP70,CCPDPCD 
          RESET     CCPDPCD 
.
          MATCH     SP70,CCPDPCD 
          GOTO      KCCPDA90 IF EQUAL
.
          CMATCH    EXITCHAR,CCPDPCD 
          GOTO      KCCPDA95 IF EQUAL
.
          CMATCH    QUEST,CCPDPCD 
          GOTO      KCCPDA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCPDA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCPDPCD 
          APPEND    SP70,CCPDPCD 
          RESET     CCPDPCD 
.
          MATCH     SP70,CCPDPCD 
          GOTO      KCCPDA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,CCPDPCD                                 
KCCPDA10
          PACK      KEY18,CCPDHCD,CCPDDPT,CCPDPCD                               
          CALL      RACCPD1 
          BRANCH    OVRCD,KCCPDA80
          BRANCH    CKEYTYP,KCCPDA75
          CALL      RDCCPD1 
KCCPDA70
          MOVE      ZERO,EXIT
          GOTO      KCCPDA99
KCCPDA75
          MOVE      "Patient Service Already Exist - ",DISPMSG                                             
          CALL      MESSAGE1
          GOTO      KCCPDA00
KCCPDA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KCCPDA99,KCCPDA99
          MOVE      "Patient Service Does Not Exist - ",DISPMSG                                            
          CALL      MESSAGE1
          GOTO      KCCPDA00
KCCPDA90
          MOVE      ONE,EXIT
          GOTO      KCCPDA99
KCCPDA95
          MOVE      TWO,EXIT
KCCPDA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   Clinical Costing System            
.   Include   :   CCSPDPKY
.   Routine   :   HCCPDB00 Patient Service           
.   Return    :           
.-------------------------------------------------------------------------------
HCCPDB00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "30",HLEF
            MOVE      "80",HRIG
          ENDIF
HCCPDB04
          CALL      GSCRN000
          BRANCH    EXIT,HCCPDB99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Pat.Serv."          
.
          MOVE      STDCOL01,STDCOL02
          ADD       "10",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Ho"                 
.
          MOVE      STDCOL02,STDCOL03
          ADD       " 2",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"s"                  
.
          MOVE      STDCOL03,STDCOL04
          ADD       " 1",STDCOL04
          DISPLAY   *PSTDCOL04:STDROW,*V2LON,*ULON,"p./Dept."           
.
          MOVE      STDCOL04,STDCOL05
          ADD       " 9",STDCOL05
          DISPLAY   *PSTDCOL05:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL05,STDCOL06
          ADD       "35",STDCOL06
HCCPDB08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          PACK      KEY18,SP70                                                  
.                                                                               
.                                                                               
          CALL      RSCCPD3 
HCCPDB10
          CALL      RKCCPD3 
          BRANCH    OVRCD,HCCPDB15
          PACK      KEY18,CCPDPCD,CCPDHCD,CCPDDPT,SP70                          
          BRANCH    CSEARCH,HCCPDB12
          CALL      HCCPDB60
          BRANCH    OVRCD,HCCPDB10
HCCPDB12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY18,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,CCPDPCD 
          DISPLAY   *PSTDCOL02:STDROW,CCPDHCD 
          DISPLAY   *PSTDCOL03:STDROW,SLASH   
          DISPLAY   *PSTDCOL04:STDROW,CCPDDPT 
          DISPLAY   *PSTDCOL05:STDROW,CCPDDES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HCCPDB10 IF NOT EQUAL
HCCPDB15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HCCPDB20
          CALL      HSCRI000
          BRANCH    EXIT,HCCPDB30,HCCPDB35,HCCPDB40,HCCPDB45,HCCPDB04:
                              HCCPDB91,HCCPDB50
          GOTO      HCCPDB92
HCCPDB30
          CALL      RKCCPD3 
          BRANCH    OVRCD,HCCPDB85
          PACK      KEY18,CCPDPCD,CCPDHCD,CCPDDPT,SP70                          
.                                                                               
.                                                                               
          CALL      RPCCPD3 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCPDB10
HCCPDB35
          MOVE      ST1,KEY18
          CALL      RDCCPD3 
          CALL      RPCCPD3 
          BRANCH    OVRCD,HCCPDB85
          PACK      KEY18,CCPDPCD,CCPDHCD,CCPDDPT,SP70                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HCCPDB36
          CALL      RPCCPD3 
          BRANCH    OVRCD,HCCPDB37
          PACK      KEY18,CCPDPCD,CCPDHCD,CCPDDPT,SP70                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCCPDB36 IF NOT EQUAL
HCCPDB37
          MOVE      ZERO,XITEMNO
          GOTO      HCCPDB10
HCCPDB40
          MOVE      ST1,KEY18
          CALL      RDCCPD3 
          CALL      RPCCPD3 
          BRANCH    OVRCD,HCCPDB85
          PACK      KEY18,CCPDPCD,CCPDHCD,CCPDDPT,SP70                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCPDB08
HCCPDB45
          CALL      RKCCPD3 
          BRANCH    OVRCD,HCCPDB85
          PACK      KEY18,CCPDPCD,CCPDHCD,CCPDDPT,SP70                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY18,Z70                                                   
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSCCPD3 
HCCPDB46
          CALL      RPCCPD3 
          BRANCH    OVRCD,HCCPDB47
          PACK      KEY18,CCPDPCD,CCPDHCD,CCPDDPT,SP70                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCCPDB46 IF NOT EQUAL
HCCPDB47
          MOVE      ZERO,XITEMNO
          GOTO      HCCPDB10
HCCPDB50  COMPARE   ZERO,CSEARCH
          GOTO      HCCPDB55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          KEYIN     *PSTDCOL04:STDROW,*V2LON,SCHFLD04
          RESET     SCHFLD04
          KEYIN     *PSTDCOL05:STDROW,*V2LON,SCHFLD05
          RESET     SCHFLD05
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCPDB08
HCCPDB55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCPDB08
HCCPDB60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HCCPDB61 IF EQUAL
          MATCH     SCHFLD01,CCPDPCD 
          GOTO      HCCPDB72 IF NOT EQUAL
HCCPDB61
          MATCH     SP70,SCHFLD02
          GOTO      HCCPDB62 IF EQUAL
          MATCH     SCHFLD02,CCPDHCD 
          GOTO      HCCPDB72 IF NOT EQUAL
HCCPDB62
          MATCH     SP70,SCHFLD03
          GOTO      HCCPDB63 IF EQUAL
          MATCH     SCHFLD03,SLASH   
          GOTO      HCCPDB72 IF NOT EQUAL
HCCPDB63
          MATCH     SP70,SCHFLD04
          GOTO      HCCPDB64 IF EQUAL
          MATCH     SCHFLD04,CCPDDPT 
          GOTO      HCCPDB72 IF NOT EQUAL
HCCPDB64
          MATCH     SP70,SCHFLD05
          GOTO      HCCPDB65 IF EQUAL
          MATCH     SCHFLD05,CCPDDES 
          GOTO      HCCPDB72 IF NOT EQUAL
HCCPDB65
HCCPDB66
HCCPDB67
HCCPDB68
HCCPDB69
HCCPDB70
          GOTO      HCCPDB75
HCCPDB72  MOVE      ONE,OVRCD
HCCPDB75  RETURN
HCCPDB85
          LOAD      KEY18,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY18,CCPDPCD,CCPDHCD,CCPDDPT                               
          CALL      RDCCPD3 
HCCPDB90
.                                                                               
          BEEP
          GOTO      HCCPDB20
HCCPDB91
          MOVE      SP70,CCPDGCD 
          MOVE      SP70,CCPDDES 
          MOVE      ZERO,CCPDSTC 
          MOVE      ZERO,CCPDRVI 
          MOVE      SP70,CCPDSPA 
          MOVE      SP70,KEY18
          GOTO      HCCPDB96
HCCPDB92
          MOVE      SP70,KEY18
          LOAD      KEY18,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY18,CCPDPCD,CCPDHCD,CCPDDPT                               
HCCPDB96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HCCPDB99
          RETURN
.--------------------------------------------------------------------------
. Modification Required to KCCPDB00 - NOTE
.
.    For Validation replace following code 
.          PACK      KEY18,CCPDPCD,CCPDHCD,CCPDDPT   
.          CALL      RACCPD3 
.          BRANCH    OVRCD,KCCPDB80
.    With
.          PACK      KEY18,CCPDPCD,SP70
.          CALL      RSCCPD3 
.          CALL      RKCCPD3 
.          BRANCH    OVRCD,KCCPDB80
.          MATCH     KEY18,CCPDPCD
.          GOTO      KCCPDB80 IF NOT EQUAL
.          PACK      KEY18,CCPDPCD,CCPDHCD,CCPDDPT
.
.--------------------------------------------------------------------------
.---------------------------------------------------------------------------
.   System    :   Clinical Costing System            
.   Include   :   CCSPDPKY
.   Routine   :   KCCPDB00 Keyin Patient Service           
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KCCPDB00 TOPIC     "CCPDPCD "
          MOVE      UNDLN70,CCPDPCD 
          KEYIN     *PCCOL:CVERT,*DV,CCPDPCD:                                   
                    *PCCOL:CVERT,*V2LON,CCPDPCD:                                
                    *PCCOL:CVERT,*DV,CCPDPCD 
.
          ENDSET    CCPDPCD 
          APPEND    SP70,CCPDPCD 
          RESET     CCPDPCD 
.
          MATCH     SP70,CCPDPCD 
          GOTO      KCCPDB90 IF EQUAL
.
          CMATCH    EXITCHAR,CCPDPCD 
          GOTO      KCCPDB95 IF EQUAL
.
          CMATCH    QUEST,CCPDPCD 
          GOTO      KCCPDB10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCPDB00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCPDPCD 
          APPEND    SP70,CCPDPCD 
          RESET     CCPDPCD 
.
          MATCH     SP70,CCPDPCD 
          GOTO      KCCPDB00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,CCPDPCD                                 
KCCPDB10
          PACK      KEY18,CCPDPCD,SP70
          CALL      RSCCPD3 
          CALL      RKCCPD3 
          BRANCH    OVRCD,KCCPDB80
          MATCH     KEY18,CCPDPCD
          GOTO      KCCPDB80 IF NOT EQUAL
          PACK      KEY18,CCPDPCD,CCPDHCD,CCPDDPT
.
          BRANCH    CKEYTYP,KCCPDB75
          CALL      RDCCPD3 
KCCPDB70
          MOVE      ZERO,EXIT
          GOTO      KCCPDB99
KCCPDB75
          MOVE      "Patient Service Already Exist - ",DISPMSG                                             
          CALL      MESSAGE1
          GOTO      KCCPDB00
KCCPDB80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KCCPDB99,KCCPDB99
          MOVE      "Patient Service Does Not Exist - ",DISPMSG                                            
          CALL      MESSAGE1
          GOTO      KCCPDB00
KCCPDB90
          MOVE      ONE,EXIT
          GOTO      KCCPDB99
KCCPDB95
          MOVE      TWO,EXIT
KCCPDB99 TOPIC    PRGID
          RETURN
