.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.01  09.07.2002  Glenn Saunders
.           Recompile for changes in includes shared with Southland, but with
.           previously different formats - now merged.  Includes effected :-
.           CCSCEAFD, CCSCONFD, CCSEPSFD, CCSHCDFD, CCSHLCFD, CCSIADFD
.-------------------------------------------------------
. V9.02.00  03.06.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.B01 22.11.2000 Sandra Barcham
.           Allow for changed ccsepsaf
.-------------------------------------------------------
. V6.06.01  15.12.1999 Charles Handaya
.           Fixed DRG Codes
.-------------------------------------------------------
. V6.03.02  30.10.1995 B.G.Ackland
.           Phase 1 WGH Changes
. V6.03.00  02.10.1995 B.G.Ackland
.           Release 6.03
.-------------------------------------------------------
CASTDDEV  FORM     1
DESC01    DIM      35
DESC02    DIM      35
DESC03    DIM      35
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACEA57
.   Function      :   Casemix Extract Enquiries               
.   Generated  On :   09/07/2002
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CCR57TMP    
          INC       CCSCEAFD/INC
          INC       CCSCEBFD/INC
          INC       CCSCECFD/INC
          INC       CCSCEDFD/INC
          INC       CCSCEEFD/INC
          INC       CCSCEFFD/INC
          INC       CCSCEGFD/INC
          INC       CCSCONFD/INC
          INC       CCSEPSFD/INC
          INC       CCSHCDFD/INC
          INC       CCSIADFD/INC
          INC       CCSSTYFD/INC
          INC       CCSXHDFD/INC
          INC       GPHHISDF    
          INC       GPHSTDDF    
.=========================
.Local Variable Definition
.-------------------------
FROMDD    DIM      10 * Scr 00 Fld    15
TODD      DIM      10 * Scr 00 Fld    16
FROMAD    DIM      10 * Scr 00 Fld    17
TOAD      DIM      10 * Scr 00 Fld    18
VISITDES  DIM      15 * Scr 00 Fld    19
FROMCMOD  DIM      35 * Scr 00 Fld    21
TOCMOD    DIM      35 * Scr 00 Fld    22
CLV1DES   DIM      35 * Scr 00 Fld    23
CLV2DES   DIM      35 * Scr 00 Fld    24
CLV3DES   DIM      35 * Scr 00 Fld    25
DAYCDESC  DIM      25 * Scr 00 Fld    29
.
.    Multi Item Key Fields Scr 00 Fld    31
.-------------------------------------------------------
CCEB1NAM  INIT      "CCEB1"
CCEB1END  FORM      1   * End Display
CCEB1SNO  FORM      5   * Number of Items on the Screen
CCEB1MKY  DIM       127 * Match Key 
CCEB1IDX  INIT      " 132 UC1-5"
CCEB1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCEB1FNM  DIM       8  * Filename
CCEB1CNT  FORM      3  * Number of Items on Screen
LEV1DESC  DIM      40 * Scr 00 Fld    31
FRCXBAR   FORM     12.2 * Scr 00 Fld    45
FRCSDEV   FORM     12.2 * Scr 00 Fld    46
FRCRANG   FORM     12.2 * Scr 00 Fld    47
TOCXBAR   FORM     12.2 * Scr 00 Fld    48
TOCSDEV   FORM     12.2 * Scr 00 Fld    49
TOCRANG   FORM     12.2 * Scr 00 Fld    50
LOSXBAR   FORM     12.2 * Scr 00 Fld    51
LOSSDEV   FORM     12.2 * Scr 00 Fld    52
LOSRANG   FORM     12.2 * Scr 00 Fld    53
INCODESC  DIM      10 * Scr 00 Fld    61
COSTDESC  DIM      10 * Scr 00 Fld    62
HISTTYPE  FORM      1 * Scr 01 Fld    33
.
.    Multi Item Key Fields Scr 02 Fld     4
.-------------------------------------------------------
CCED1NAM  INIT      "CCED1"
CCED1END  FORM      1   * End Display
CCED1SNO  FORM      5   * Number of Items on the Screen
CCED1MKY  DIM       127 * Match Key 
CCED1EKY  DIM       127 * End Key
CCED1SKY  DIM       127 * Start Key
CCED1IDX  INIT      " 132 UC1-5"
CCED1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCED1FNM  DIM       8  * Filename
CCED1CNT  FORM      3  * Number of Items on Screen
LEV2DESC  DIM      40 * Scr 02 Fld     4
.
.    Multi Item Key Fields Scr 04 Fld     4
.-------------------------------------------------------
CCEE1NAM  INIT      "CCEE1"
CCEE1END  FORM      1   * End Display
CCEE1SNO  FORM      5   * Number of Items on the Screen
CCEE1MKY  DIM       127 * Match Key 
CCEE1EKY  DIM       127 * End Key
CCEE1SKY  DIM       127 * Start Key
CCEE1IDX  INIT      " 132 UC1-5"
CCEE1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCEE1FNM  DIM       8  * Filename
CCEE1CNT  FORM      3  * Number of Items on Screen
LEV3DESC  DIM      40 * Scr 04 Fld     4
.
.    Multi Item Key Fields Scr E1 Fld     3
.-------------------------------------------------------
CCEC2NAM  INIT      "CCEC2"
CCEC2END  FORM      1   * End Display
CCEC2SNO  FORM      5   * Number of Items on the Screen
CCEC2MKY  DIM       127 * Match Key 
CCEC2EKY  DIM       127 * End Key
CCEC2SKY  DIM       127 * Start Key
CCEC2IDX  INIT      " 132 UC1-5"
CCEC2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCEC2FNM  DIM       8  * Filename
CCEC2CNT  FORM      3  * Number of Items on Screen
BDTOTF    FORM     12.2 * Scr ED Fld    76
BDTOTT    FORM     12.2 * Scr ED Fld    78
GRAPHLEV  FORM      1 * Scr GO Fld     3
GPHLTO    FORM      1 * Scr GO Fld     5
GPHLAV    FORM      1 * Scr GO Fld     6
GPHLMN    FORM      1 * Scr GO Fld     7
GPHLMX    FORM      1 * Scr GO Fld     8
GPHFTO    FORM      1 * Scr GO Fld     9
GPHFAV    FORM      1 * Scr GO Fld    10
GPHFMN    FORM      1 * Scr GO Fld    11
GPHFMX    FORM      1 * Scr GO Fld    12
GPHEPS    FORM      1 * Scr GO Fld    17
COSTETH   FORM      8.2 * Scr IA Fld    73
COSTEA1   FORM      8.2 * Scr IA Fld    74
COSTEA2   FORM      8.2 * Scr IA Fld    75
COSTEA3   FORM      8.2 * Scr IA Fld    76
COSTEAO   FORM      8.2 * Scr IA Fld    77
COSTEM1   FORM      8.2 * Scr IA Fld    78
COSTEM2   FORM      8.2 * Scr IA Fld    79
COSTEM3   FORM      8.2 * Scr IA Fld    80
COSTEMO   FORM      8.2 * Scr IA Fld    81
TOTINC    FORM     12.2 * Scr IA Fld    82
TOTCST    FORM     12.2 * Scr IA Fld    83
TOTCST1   FORM     12.2 * Scr IA Fld    84
TOTCST2   FORM     12.2 * Scr IA Fld    85
TOTCST3   FORM     12.2 * Scr IA Fld    86
TOTCST4   FORM     12.2 * Scr IA Fld    87
TOTCST5   FORM     12.2 * Scr IA Fld    88
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACEA57"
PRGNAM    INIT      "Casemix Extract Enquiries               "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CLOSE     CCEB1FL1,DELETE
.
          CLOSE     CCED1FL1,DELETE
.
          CLOSE     CCEE1FL1,DELETE
.
          CLOSE     CCEC2FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   64",AUDTSECT
          MOVE      " 37",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ccsaudep";
            OPEN      CCSAUDEP,"ccsaudep"
          ENDIF
          MOVE      "   64",AUDTSECT
          MOVE      " 38",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ccsaudia";
            OPEN      CCSAUDIA,"ccsaudia"
          ENDIF
          DISPLAY   *P56:24,"Opening ccsceaaf";
          OPEN      CCSCEAA1,"ccsceaaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA1,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA2,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA3,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA4,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA5,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccshcdaf";
          OPEN      CCSHCDA1,"ccshcdaf"
          DISPLAY   *P56:24,"Opening ccshcdaf";
          OPEN      CCSHCDA2,"ccshcdaf"
          DISPLAY   *P56:24,"Opening ccsiadaf";
          OPEN      CCSIADA1,"ccsiadaf"
          DISPLAY   *P56:24,"Opening ccsstyaf";
          OPEN      CCSSTYA1,"ccsstyaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA1,"ccsxhdaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA2,"ccsxhdaf"
.--------------------------------------------------------
. Initialise Batch Screen Level 1 Code & Desc                
.--------------------------------------------------------
          MOVE     ZERO,CCEB1SNO
          MOVE     "00   31",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCEB1SNO
            ENDIF
          ENDIF
          PACK      CCEB1FNM,ANST,CCEB1NAM,PORT
          REP       " 0",CCEB1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCEB1FL1,CCEB1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CCEB1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CCEB1FNM,CCEB1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",CCEB1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      CCEB1FL1,CCEB1FNM
.--------------------------------------------------------
. Initialise Batch Screen Level 2 Code & Description         
.--------------------------------------------------------
          MOVE     ZERO,CCED1SNO
          MOVE     "02    4",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCED1SNO
            ENDIF
          ENDIF
          PACK      CCED1FNM,ANST,CCED1NAM,PORT
          REP       " 0",CCED1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCED1FL1,CCED1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CCED1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CCED1FNM,CCED1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",CCED1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      CCED1FL1,CCED1FNM
.--------------------------------------------------------
. Initialise Batch Screen Level 3 Code & Description         
.--------------------------------------------------------
          MOVE     ZERO,CCEE1SNO
          MOVE     "04    4",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCEE1SNO
            ENDIF
          ENDIF
          PACK      CCEE1FNM,ANST,CCEE1NAM,PORT
          REP       " 0",CCEE1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCEE1FL1,CCEE1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CCEE1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CCEE1FNM,CCEE1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",CCEE1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      CCEE1FL1,CCEE1FNM
.--------------------------------------------------------
. Initialise Batch Screen Episode                            
.--------------------------------------------------------
          MOVE     ZERO,CCEC2SNO
          MOVE     "E1    3",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCEC2SNO
            ENDIF
          ENDIF
          PACK      CCEC2FNM,ANST,CCEC2NAM,PORT
          REP       " 0",CCEC2FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCEC2FL1,CCEC2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CCEC2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CCEC2FNM,CCEC2IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",CCEC2FNM;
          EXECUTE   KEY80,TASKID
          OPEN      CCEC2FL1,CCEC2FNM
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Casemix Level 1 Summary            
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Casemix Level 1 Detail             
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Casemix Level 2 Summary            
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Casemix Level 2 Details            
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Casemix Level 3 Summary            
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * Casemix Level 3 Details            
          ENDIF
          MATCH     "E1",SCRID
          IF         @EQUAL
            CALL       PSE1L000   * Episodes at Level 1                
          ENDIF
          MATCH     "E2",SCRID
          IF         @EQUAL
            CALL       PSE2L000   * Episodes at Level 2                
          ENDIF
          MATCH     "E3",SCRID
          IF         @EQUAL
            CALL       PSE3L000   * Episodes at Level 3                
          ENDIF
          MATCH     "ED",SCRID
          IF         @EQUAL
            CALL       PSEDL000   * Epiosde Details                    
          ENDIF
          MATCH     "EF",SCRID
          IF         @EQUAL
            CALL       PSEFL000   * More Extra Details                 
          ENDIF
          MATCH     "GO",SCRID
          IF         @EQUAL
            CALL       PSGOL000   * Graph Options                      
          ENDIF
          MATCH     "IA",SCRID
          IF         @EQUAL
            CALL       PSIAL000   * Income/Cost Analysis Details       
          ENDIF
          RETURN
.--------------------------------
. Screen - Casemix Level 1 Summary            
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Casemix Level 1 Summary            
.-------------------------------------------------------
CF00L000
          MOVE      SP70,CCEAEID 
          MOVE      SP70,CCEADES 
          MOVE      SP70,CCEAINC 
          MOVE      SP70,CCEAVIS 
          MOVE      SP70,CCEADAY 
          MOVE      SP70,CCEALV1 
          MOVE      SP70,CCEALV2 
          MOVE      SP70,CCEALV3 
          MOVE      SP70,CCEAFCM 
          MOVE      SP70,CCEAFYR 
          MOVE      SP70,CCEATCM 
          MOVE      SP70,CCEATYR 
          MOVE      SP70,FROMDD  
          MOVE      SP70,TODD    
          MOVE      SP70,FROMAD  
          MOVE      SP70,TOAD    
          MOVE      SP70,VISITDES
          MOVE      SP70,CCHCDES 
          MOVE      SP70,FROMCMOD
          MOVE      SP70,TOCMOD  
          MOVE      SP70,CLV1DES 
          MOVE      SP70,CLV2DES 
          MOVE      SP70,CLV3DES 
          MOVE      SP70,CCEAHCD 
          MOVE      SP70,DAYCDESC
          MOVE      SP70,LEV1DESC
          MOVE      ZERO,CCEBNEP 
          MOVE      ZERO,CCEBFTC 
          MOVE      ZERO,CCEBFMN 
          MOVE      ZERO,CCEBFMX 
          MOVE      ZERO,CCEBFSV 
          MOVE      ZERO,CCEBTTC 
          MOVE      ZERO,CCEBTMN 
          MOVE      ZERO,CCEBTMX 
          MOVE      ZERO,CCEBTSV 
          MOVE      ZERO,CCEBLTO 
          MOVE      ZERO,CCEBLMN 
          MOVE      ZERO,CCEBLMX 
          MOVE      ZERO,CCEBLSV 
          MOVE      ZERO,FRCXBAR 
          MOVE      ZERO,FRCSDEV 
          MOVE      ZERO,FRCRANG 
          MOVE      ZERO,TOCXBAR 
          MOVE      ZERO,TOCSDEV 
          MOVE      ZERO,TOCRANG 
          MOVE      ZERO,LOSXBAR 
          MOVE      ZERO,LOSSDEV 
          MOVE      ZERO,LOSRANG 
          MOVE      SP70,INCODESC
          MOVE      SP70,COSTDESC
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Casemix Level 1 Summary            
.--------------------------------------------------------
KY00L000
.
KY00L110
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEAINC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEAVIS 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEADAY 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEALV1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEALV2 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEALV3 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEAFCM 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEAFYR 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEATCM 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEATYR 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROMDD  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TODD    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROMAD  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOAD    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,VISITDES
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCHCDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROMCMOD
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCMOD  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CLV1DES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CLV2DES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CLV3DES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEAHCD 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EEID0000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      CCEAEID,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEADES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      CCEAINC,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEAVIS,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEADAY,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEALV1,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEALV2,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEALV3,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEAFCM,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEAFYR,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEATCM,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEATYR,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROMDD,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TODD,VAR         
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROMAD,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOAD,VAR         
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VISITDES,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCHCDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROMCMOD,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCMOD,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CLV1DES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CLV2DES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CLV3DES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEAHCD,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Casemix Level 1 Summary            
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Casemix Level 1 Summary            
.---------------------------------------------------------
LM00L000
.---------------------------------------------------------
. Load for :    31 Level 1 Code & Desc                
.---------------------------------------------------------
          PACK      KEY10,SP70
          CALL      RDCCEB1 
          IF        OVRCD=0
            CALL      RPCCEB1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP00L000
          MOVE     ZERO,CCEB1CNT
          MOVE     ZERO,CCEB1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP00L600
          MATCH    PRGID,SCPSPID
          GOTO     DP00L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP00L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP00L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L101,DP00L102:
                            DP00L103,DP00L104,DP00L105,DP00L106:
                            DP00L107,DP00L108,DP00L109,DP00L110:
                            DP00L111,DP00L112,DP00L113,DP00L114:
                            DP00L115,DP00L116,DP00L117,DP00L118:
                            DP00L119,DP00L120,DP00L121,DP00L122:
                            DP00L123,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010
          GOTO      DP00L010
.
DP00L101
          PACK      CCEB1MKY,SP70,SP70
          CALL      UPTCCEB1
          IF        CCEB1END=0
            CALL      RKCCEB1 
            IF        OVRCD=0
              PACK      CCEB1MKY,CCEBLV1                                                                        
                MOVE      ZERO,CCEB1END
                ADD       ONE,CCEB1CNT
                CALL      UPTCCEB1
          CALL      LV1DET00
                MOVE      LEV1DESC,VAR     
                CALL      DISPITEM
            ELSE
              MOVE      ONE,CCEB1END
            ENDIF
          ENDIF
          IF        CCEB1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L102
          IF        CCEB1END=0
            MOVE      CCEBNEP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L103
          IF        CCEB1END=0
            MOVE      CCEBFTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L104
          IF        CCEB1END=0
            MOVE      CCEBFMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L105
          IF        CCEB1END=0
            MOVE      CCEBFMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L106
          IF        CCEB1END=0
            MOVE      CCEBFSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L107
          IF        CCEB1END=0
            MOVE      CCEBTTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L108
          IF        CCEB1END=0
            MOVE      CCEBTMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L109
          IF        CCEB1END=0
            MOVE      CCEBTMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L110
          IF        CCEB1END=0
            MOVE      CCEBTSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L111
          IF        CCEB1END=0
            MOVE      CCEBLTO,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L112
          IF        CCEB1END=0
            MOVE      CCEBLMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L113
          IF        CCEB1END=0
            MOVE      CCEBLMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L114
          IF        CCEB1END=0
            MOVE      CCEBLSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L115
          IF        CCEB1END=0
            MOVE      FRCXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L116
          IF        CCEB1END=0
            MOVE      FRCSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L117
          IF        CCEB1END=0
            MOVE      FRCRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L118
          IF        CCEB1END=0
            MOVE      TOCXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L119
          IF        CCEB1END=0
            MOVE      TOCSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L120
          IF        CCEB1END=0
            MOVE      TOCRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L121
          IF        CCEB1END=0
            MOVE      LOSXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L122
          IF        CCEB1END=0
            MOVE      LOSSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L123
          IF        CCEB1END=0
            MOVE      LOSRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
DP00L600
          MATCH    "CCEB1",NAMSSFFI
          GOTO     DP00L605 IF NOT EQUAL
          GOTO     DP00L999
DP00L605
DP00L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP00L000
.
          MATCH    "CCEB1",NAMSSFFI
          GOTO     FP00L105 IF NOT EQUAL
          PACK     KEY10,SP70
          CALL     RDCCEB1  * Start
          IF       OVRCD=0
            CALL     RPCCEB1  * Start
          ENDIF
          CALL     DP00L000
          GOTO     FP00L999
FP00L105
FP00L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP00L000
.
          MATCH    "CCEB1",NAMSSFFI
          GOTO     LP00L105 IF NOT EQUAL
          PACK     KEY10,Z70
          CALL     RSCCEB1  * End
          IF       OVRCD=1
            CALL     RPCCEB1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEB1SNO
            CALL     RPCCEB1 
            IF       OVRCD=1
              MOVE     CCEB1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP00L000
          GOTO     LP00L999
LP00L105
LP00L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP00L000
.
          MATCH    "CCEB1",NAMSSFFI
          GOTO     PP00L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP00L105
          CALL      RFTCCEB1
          BRANCH   OVRCD,PP00L115
          MOVE      CCEB1MKY,KEY10 
          CALL      RSCCEB1 
PP00L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCEB1SNO
            CALL     RPCCEB1 
            IF       OVRCD=1
              MOVE     CCEB1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP00L000
          GOTO     PP00L999
PP00L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEB1SNO
            CALL     RKCCEB1 
            IF       OVRCD=1
              MOVE     CCEB1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP00L999
PP00L120
PP00L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP00L000
          MATCH    "CCEB1",NAMSSFFI
          GOTO     NP00L115 IF NOT EQUAL
NP00L105
          CALL     RKCCEB1 
          BRANCH   OVRCD,NP00L110
          CALL     RPCCEB1 
          CALL     DP00L000
          GOTO     NP00L999
NP00L110
          CALL     RPCCEB1 
          BEEP
          GOTO     NP00L999
NP00L115
NP00L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT00L000
CT00L105
CT00L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Casemix Level 1 Summary            
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    31 Level 1 Code & Desc                
.---------------------------------------------------------
UPTCCEB1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCEB1FL1,KEY5;ANS
          IF        @OVER
            WRITE     CCEB1FL1,KEY5;SCPSROW,SCPSCOL,CCEB1MKY
          ELSE
            UPDATE    CCEB1FL1;SCPSROW,SCPSCOL,CCEB1MKY
          ENDIF
          RETURN
RDTCCEB1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCEB1FL1,KEY5;SCPSROW,SCPSCOL,CCEB1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTCCEB1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      CCEB1FL1,KEY5;;
          READKS    CCEB1FL1;SCPSROW,SCPSCOL,CCEB1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,CCEB1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Casemix Level 1 Summary            
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
          MOVE      "CCEB1",NAMSSFFI
          MOVE      "   31",ITMSSFFI
          CALL      FP00L000
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Casemix Level 1 Summary            
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L101:
                            PS00L102,PS00L103,PS00L104,PS00L105:
                            PS00L106,PS00L107,PS00L108,PS00L109:
                            PS00L110,PS00L111,PS00L112,PS00L113:
                            PS00L114,PS00L115,PS00L116,PS00L117:
                            PS00L118,PS00L119,PS00L120,PS00L121:
                            PS00L122,PS00L123,PS00L999,PS00L999:
                            PS00L124,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L125,PS00L126
          GOTO     PS00L999
.
PS00L101
          MOVE      CCEADES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEAINC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      CCEAVIS,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      CCEADAY,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      CCEALV1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      CCEALV2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      CCEALV3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      CCEAFCM,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      CCEAFYR,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      CCEATCM,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      CCEATYR,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      FROMDD,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      TODD,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      FROMAD,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      TOAD,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      VISITDES,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          MOVE      CCHCDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      FROMCMOD,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      TOCMOD,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE      CLV1DES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          MOVE      CLV2DES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      CLV3DES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          MOVE      CCEAHCD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          MOVE      DAYCDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          MOVE      INCODESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L126
          MOVE      COSTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Casemix Level 1 Summary            
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L102,SF00L103:
                            SF00L006,SF00L006,SF00L104,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L105,SF00L106,SF00L107:
                            SF00L108,SF00L006,SF00L006,SF00L109:
                            SF00L006,SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L104,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          MOVE      "CCEB1",NAMSSFFI
          MOVE      "   31",ITMSSFFI
          CALL      FP00L000
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPH1LV00
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L104
          CALL      SELECTED
          BRANCH    EXIT,SF00L001
          COMPARE   ONE,ACCEPT
          GOTO      SF00L001 IF EQUAL
          CALL      RDTCCEB1
          IF        OVRCD=1
            BEEP
            GOTO      SF00L001
          ENDIF
          MATCH     SP70,CCEB1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF00L001
          ENDIF
          MOVE      CCEB1MKY,KEY10 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SEL1LV00
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCEB1
          IF        OVRCD=1
            CALL      FP00L000
          ELSE
            MOVE      CCEB1MKY,KEY10 
            CALL      RSCCEB1 
            CALL      RPCCEB1 
            CALL      DP00L000
          ENDIF
          GOTO     SF00L001
.
SF00L105
          MOVE      "CCEB1",NAMSSFFI
          MOVE      "   31",ITMSSFFI
          CALL      NP00L000
          GOTO     SF00L001
.
SF00L106
          MOVE      "CCEB1",NAMSSFFI
          MOVE      "   31",ITMSSFFI
          CALL      PP00L000
          GOTO     SF00L001
.
SF00L107
          MOVE      "CCEB1",NAMSSFFI
          MOVE      "   31",ITMSSFFI
          CALL      FP00L000
          GOTO     SF00L001
.
SF00L108
          MOVE      "CCEB1",NAMSSFFI
          MOVE      "   31",ITMSSFFI
          CALL      LP00L000
          GOTO     SF00L001
.
SF00L109
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SELCM000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF00L000
          GOTO      SF00L001
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.--------------------------------
. Screen - Casemix Level 1 Detail             
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 8",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Casemix Level 1 Detail             
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Casemix Level 1 Detail             
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Casemix Level 1 Detail             
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Casemix Level 1 Detail             
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Casemix Level 1 Detail             
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Casemix Level 1 Detail             
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L101,PS01L102:
                            PS01L103,PS01L104,PS01L105,PS01L106:
                            PS01L107,PS01L108,PS01L109,PS01L110:
                            PS01L111,PS01L112,PS01L113,PS01L114:
                            PS01L115,PS01L116,PS01L117,PS01L118:
                            PS01L119,PS01L120,PS01L121,PS01L122:
                            PS01L123,PS01L124,PS01L125,PS01L126:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L127,PS01L999,PS01L128,PS01L129
          GOTO     PS01L999
.
PS01L101
          MOVE      CLV1DES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      CCEBLV1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      CCXHDES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      CCEBNEP,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      CCEBFTC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      CCEBFMN,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      CCEBFMX,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      CCEBFSV,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      CCEBTTC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      CCEBTMN,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      CCEBTMX,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          MOVE      CCEBTSV,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          MOVE      CCEBLTO,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          MOVE      CCEBLMN,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          MOVE      CCEBLMX,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L116
          MOVE      CCEBLSV,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L117
          MOVE      FRCXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L118
          MOVE      FRCSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L119
          MOVE      FRCRANG,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L120
          MOVE      TOCXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L121
          MOVE      TOCSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L122
          MOVE      TOCRANG,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L123
          MOVE      LOSXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L124
          MOVE      LOSSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L125
          MOVE      LOSRANG,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L126
          MOVE      CCEAHCD,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L127
          MOVE      HISTTYPE,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L128
          MOVE      INCODESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L129
          MOVE      COSTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Casemix Level 1 Detail             
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L102,SF01L103,SF01L104,SF01L105:
                            SF01L006,SF01L106,SF01L006,SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      LEVEL200
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF01L001
.
SF01L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCXHDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      KY01LV00
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCXHDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF01L000
          GOTO      SF01L001
.
SF01L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCE1L000
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF01L001
.
SF01L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      H1DP0000
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF01L001
.
SF01L106
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SF01L999
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Casemix Level 2 Summary            
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "10",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Casemix Level 2 Summary            
.-------------------------------------------------------
CF02L000
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Casemix Level 2 Summary            
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Casemix Level 2 Summary            
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Casemix Level 2 Summary            
.---------------------------------------------------------
LM02L000
.---------------------------------------------------------
. Load for :     4 Level 2 Code & Description         
.---------------------------------------------------------
          PACK      KEY20,CCEBLV1,SP70
          MOVE      KEY20,CCED1EKY
          MOVE      CCED1EKY,CCED1SKY
          STRIP     CCED1SKY
          SETLPTR   CCED1EKY,10
          CALL      RDCCED1 
          IF        OVRCD=0
            CALL      RPCCED1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP02L000
          MOVE     ZERO,CCED1CNT
          MOVE     ZERO,CCED1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP02L600
          MATCH    PRGID,SCPSPID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP02L010,DP02L010,DP02L010,DP02L101:
                            DP02L102,DP02L103,DP02L104,DP02L105:
                            DP02L106,DP02L107,DP02L108,DP02L109:
                            DP02L110,DP02L111,DP02L112,DP02L113:
                            DP02L114,DP02L115,DP02L116,DP02L117:
                            DP02L118,DP02L119,DP02L120,DP02L121:
                            DP02L122,DP02L123,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010
          GOTO      DP02L010
.
DP02L101
          PACK      CCED1MKY,SP70,SP70
          CALL      UPTCCED1
          IF        CCED1END=0
            CALL      RKCCED1 
            IF        OVRCD=0
              PACK      CCED1MKY,CCEDLV1,CCEDLV2                                                                
              MATCH     CCED1EKY,CCED1MKY
              IF        @EQUAL
                MOVE      ZERO,CCED1END
                ADD       ONE,CCED1CNT
                CALL      UPTCCED1
          CALL      LV2DET00
                MOVE      LEV2DESC,VAR     
                CALL      DISPITEM
              ELSE
                MOVE      ONE,CCED1END
              ENDIF
            ELSE
              MOVE      ONE,CCED1END
            ENDIF
          ENDIF
          IF        CCED1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L102
          IF        CCED1END=0
            MOVE      CCEDNEP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L103
          IF        CCED1END=0
            MOVE      CCEDFTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L104
          IF        CCED1END=0
            MOVE      CCEDFMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L105
          IF        CCED1END=0
            MOVE      CCEDFMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L106
          IF        CCED1END=0
            MOVE      CCEDFSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L107
          IF        CCED1END=0
            MOVE      CCEDTTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L108
          IF        CCED1END=0
            MOVE      CCEDTMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L109
          IF        CCED1END=0
            MOVE      CCEDTMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L110
          IF        CCED1END=0
            MOVE      CCEDTSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L111
          IF        CCED1END=0
            MOVE      CCEDLTO,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L112
          IF        CCED1END=0
            MOVE      CCEDLMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L113
          IF        CCED1END=0
            MOVE      CCEDLMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L114
          IF        CCED1END=0
            MOVE      CCEDLSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L115
          IF        CCED1END=0
            MOVE      FRCXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L116
          IF        CCED1END=0
            MOVE      FRCSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L117
          IF        CCED1END=0
            MOVE      FRCRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L118
          IF        CCED1END=0
            MOVE      TOCXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L119
          IF        CCED1END=0
            MOVE      TOCSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L120
          IF        CCED1END=0
            MOVE      TOCRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L121
          IF        CCED1END=0
            MOVE      LOSXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L122
          IF        CCED1END=0
            MOVE      LOSSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L123
          IF        CCED1END=0
            MOVE      LOSRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
DP02L600
          MATCH    "CCED1",NAMSSFFI
          GOTO     DP02L605 IF NOT EQUAL
          GOTO     DP02L999
DP02L605
DP02L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP02L000
.
          MATCH    "CCED1",NAMSSFFI
          GOTO     FP02L105 IF NOT EQUAL
          PACK     KEY20,CCED1SKY,SP70
          CALL     RDCCED1  * Start
          IF       OVRCD=0
            CALL     RPCCED1  * Start
          ENDIF
          CALL     DP02L000
          GOTO     FP02L999
FP02L105
FP02L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP02L000
.
          MATCH    "CCED1",NAMSSFFI
          GOTO     LP02L105 IF NOT EQUAL
          PACK     KEY20,CCED1SKY,Z70
          CALL     RSCCED1  * End
          IF       OVRCD=1
            CALL     RPCCED1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCED1SNO
            CALL     RPCCED1 
            IF       OVRCD=1
              MOVE     CCED1SNO,SECTOR
            ENDIF
            PACK     CCED1MKY,CCEDLV1,CCEDLV2                                                                
            MATCH    CCED1EKY,CCED1MKY
            IF       !@EQUAL
              MOVE     CCED1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     LP02L999
LP02L105
LP02L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP02L000
.
          MATCH    "CCED1",NAMSSFFI
          GOTO     PP02L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP02L105
          CALL      RFTCCED1
          BRANCH   OVRCD,PP02L115
          MOVE      CCED1MKY,KEY20 
          CALL      RSCCED1 
PP02L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCED1SNO
            CALL     RPCCED1 
            IF       OVRCD=1
              MOVE     CCED1SNO,SECTOR
            ENDIF
            PACK     CCED1MKY,CCEDLV1,CCEDLV2                                                                
            MATCH    CCED1EKY,CCED1MKY
            IF       !@EQUAL
              MOVE     CCED1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     PP02L999
PP02L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCED1SNO
            CALL     RKCCED1 
            IF       OVRCD=1
              MOVE     CCED1SNO,SECTOR
            ENDIF
            PACK     CCED1MKY,CCEDLV1,CCEDLV2                                                                
            MATCH    CCED1EKY,CCED1MKY
            IF       !@EQUAL
              MOVE     CCED1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP02L999
PP02L120
PP02L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP02L000
          MATCH    "CCED1",NAMSSFFI
          GOTO     NP02L115 IF NOT EQUAL
NP02L105
          CALL     RKCCED1 
          BRANCH   OVRCD,NP02L110
          PACK     CCED1MKY,CCEDLV1,CCEDLV2                                                                
          MATCH    CCED1EKY,CCED1MKY
          GOTO     NP02L110 IF NOT EQUAL
          CALL     RPCCED1 
          CALL     DP02L000
          GOTO     NP02L999
NP02L110
          CALL     RPCCED1 
          BEEP
          GOTO     NP02L999
NP02L115
NP02L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT02L000
CT02L105
CT02L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Casemix Level 2 Summary            
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     4 Level 2 Code & Description         
.---------------------------------------------------------
UPTCCED1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCED1FL1,KEY5;ANS
          IF        @OVER
            WRITE     CCED1FL1,KEY5;SCPSROW,SCPSCOL,CCED1MKY
          ELSE
            UPDATE    CCED1FL1;SCPSROW,SCPSCOL,CCED1MKY
          ENDIF
          RETURN
RDTCCED1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCED1FL1,KEY5;SCPSROW,SCPSCOL,CCED1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTCCED1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      CCED1FL1,KEY5;;
          READKS    CCED1FL1;SCPSROW,SCPSCOL,CCED1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,CCED1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Casemix Level 2 Summary            
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
          MOVE      "CCED1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FP02L000
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Casemix Level 2 Summary            
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L101,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L102,PS02L103
          GOTO     PS02L999
.
PS02L101
          MOVE      CLV2DES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      INCODESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      COSTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Casemix Level 2 Summary            
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L006,SF02L102:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L103,SF02L104:
                            SF02L105,SF02L106,SF02L107,SF02L108:
                            SF02L006,SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L102:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          MOVE      "CCED1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L102
          CALL      SELECTED
          BRANCH    EXIT,SF02L001
          COMPARE   ONE,ACCEPT
          GOTO      SF02L001 IF EQUAL
          CALL      RDTCCED1
          IF        OVRCD=1
            BEEP
            GOTO      SF02L001
          ENDIF
          MATCH     SP70,CCED1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF02L001
          ENDIF
          MOVE      CCED1MKY,KEY20 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SEL2LV00
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCED1
          IF        OVRCD=1
            CALL      FP02L000
          ELSE
            MOVE      CCED1MKY,KEY20 
            CALL      RSCCED1 
            CALL      RPCCED1 
            CALL      DP02L000
          ENDIF
          GOTO     SF02L001
.
SF02L103
          MOVE      "CCED1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      NP02L000
          GOTO     SF02L001
.
SF02L104
          MOVE      "CCED1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      PP02L000
          GOTO     SF02L001
.
SF02L105
          MOVE      "CCED1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L106
          MOVE      "CCED1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      LP02L000
          GOTO     SF02L001
.
SF02L107
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPH2LV00
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF02L001
.
SF02L108
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SF02L999
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Casemix Level 2 Details            
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "10",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Casemix Level 2 Details            
.-------------------------------------------------------
CF03L000
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Casemix Level 2 Details            
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Casemix Level 2 Details            
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Casemix Level 2 Details            
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Casemix Level 2 Details            
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Casemix Level 2 Details            
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L101,PS03L102:
                            PS03L103,PS03L104,PS03L105,PS03L106:
                            PS03L107,PS03L108,PS03L109,PS03L110:
                            PS03L111,PS03L112,PS03L113,PS03L114:
                            PS03L115,PS03L116,PS03L117,PS03L118:
                            PS03L119,PS03L120,PS03L121,PS03L122:
                            PS03L123,PS03L124,PS03L125,PS03L126:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L127,PS03L128
          GOTO     PS03L999
.
PS03L101
          MOVE      CLV2DES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      CCEDLV2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      CCXHDES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      CCEDNEP,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L105
          MOVE      CCEDFTC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L106
          MOVE      CCEDFMN,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L107
          MOVE      CCEDFMX,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L108
          MOVE      CCEDFSV,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L109
          MOVE      CCEDTTC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L110
          MOVE      CCEDTMN,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L111
          MOVE      CCEDTMX,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L112
          MOVE      CCEDTSV,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L113
          MOVE      CCEDLTO,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L114
          MOVE      CCEDLMN,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L115
          MOVE      CCEDLMX,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L116
          MOVE      CCEDLSV,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L117
          MOVE      FRCXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L118
          MOVE      FRCSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L119
          MOVE      FRCRANG,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L120
          MOVE      TOCXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L121
          MOVE      TOCSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L122
          MOVE      TOCRANG,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L123
          MOVE      LOSXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L124
          MOVE      LOSSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L125
          MOVE      LOSRANG,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L126
          MOVE      CCEAHCD,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L127
          MOVE      INCODESC,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L128
          MOVE      COSTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Casemix Level 2 Details            
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L102,SF03L103,SF03L104,SF03L105:
                            SF03L106,SF03L006,SF03L006
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      LEVEL300
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF03L000
          GOTO      SF03L001
.
SF03L103
          CALL      KY02LV00
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCE2L000
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF03L001
.
SF03L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      H2DP0000
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF03L001
.
SF03L106
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SF03L999
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Casemix Level 3 Summary            
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "11",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Casemix Level 3 Summary            
.-------------------------------------------------------
CF04L000
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Casemix Level 3 Summary            
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Casemix Level 3 Summary            
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Casemix Level 3 Summary            
.---------------------------------------------------------
LM04L000
.---------------------------------------------------------
. Load for :     4 Level 3 Code & Description         
.---------------------------------------------------------
          PACK      KEY30,CCEBLV1,CCEDLV2,SP70
          MOVE      KEY30,CCEE1EKY
          MOVE      CCEE1EKY,CCEE1SKY
          STRIP     CCEE1SKY
          SETLPTR   CCEE1EKY,20
          CALL      RDCCEE1 
          IF        OVRCD=0
            CALL      RPCCEE1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP04L000
          MOVE     ZERO,CCEE1CNT
          MOVE     ZERO,CCEE1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP04L600
          MATCH    PRGID,SCPSPID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP04L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP04L010,DP04L010,DP04L010,DP04L101:
                            DP04L102,DP04L103,DP04L104,DP04L105:
                            DP04L106,DP04L107,DP04L108,DP04L109:
                            DP04L110,DP04L111,DP04L112,DP04L113:
                            DP04L114,DP04L115,DP04L116,DP04L117:
                            DP04L118,DP04L119,DP04L120,DP04L121:
                            DP04L122,DP04L123,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010
          GOTO      DP04L010
.
DP04L101
          PACK      CCEE1MKY,SP70,SP70
          CALL      UPTCCEE1
          IF        CCEE1END=0
            CALL      RKCCEE1 
            IF        OVRCD=0
              PACK      CCEE1MKY,CCEELV1,CCEELV2,CCEELV3                                                        
              MATCH     CCEE1EKY,CCEE1MKY
              IF        @EQUAL
                MOVE      ZERO,CCEE1END
                ADD       ONE,CCEE1CNT
                CALL      UPTCCEE1
          CALL      LV3DET00
                MOVE      LEV3DESC,VAR     
                CALL      DISPITEM
              ELSE
                MOVE      ONE,CCEE1END
              ENDIF
            ELSE
              MOVE      ONE,CCEE1END
            ENDIF
          ENDIF
          IF        CCEE1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L102
          IF        CCEE1END=0
            MOVE      CCEENEP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L103
          IF        CCEE1END=0
            MOVE      CCEEFTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L104
          IF        CCEE1END=0
            MOVE      CCEEFMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L105
          IF        CCEE1END=0
            MOVE      CCEEFMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L106
          IF        CCEE1END=0
            MOVE      CCEEFSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L107
          IF        CCEE1END=0
            MOVE      CCEETTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L108
          IF        CCEE1END=0
            MOVE      CCEETMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L109
          IF        CCEE1END=0
            MOVE      CCEETMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L110
          IF        CCEE1END=0
            MOVE      CCEETSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L111
          IF        CCEE1END=0
            MOVE      CCEELTO,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L112
          IF        CCEE1END=0
            MOVE      CCEELMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L113
          IF        CCEE1END=0
            MOVE      CCEELMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L114
          IF        CCEE1END=0
            MOVE      CCEELSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L115
          IF        CCEE1END=0
            MOVE      FRCXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L116
          IF        CCEE1END=0
            MOVE      FRCSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L117
          IF        CCEE1END=0
            MOVE      FRCRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L118
          IF        CCEE1END=0
            MOVE      TOCXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L119
          IF        CCEE1END=0
            MOVE      TOCSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L120
          IF        CCEE1END=0
            MOVE      TOCRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L121
          IF        CCEE1END=0
            MOVE      LOSXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L122
          IF        CCEE1END=0
            MOVE      LOSSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L123
          IF        CCEE1END=0
            MOVE      LOSRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
DP04L600
          MATCH    "CCEE1",NAMSSFFI
          GOTO     DP04L605 IF NOT EQUAL
          GOTO     DP04L999
DP04L605
DP04L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP04L000
.
          MATCH    "CCEE1",NAMSSFFI
          GOTO     FP04L105 IF NOT EQUAL
          PACK     KEY30,CCEE1SKY,SP70
          CALL     RDCCEE1  * Start
          IF       OVRCD=0
            CALL     RPCCEE1  * Start
          ENDIF
          CALL     DP04L000
          GOTO     FP04L999
FP04L105
FP04L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP04L000
.
          MATCH    "CCEE1",NAMSSFFI
          GOTO     LP04L105 IF NOT EQUAL
          PACK     KEY30,CCEE1SKY,Z70
          CALL     RSCCEE1  * End
          IF       OVRCD=1
            CALL     RPCCEE1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEE1SNO
            CALL     RPCCEE1 
            IF       OVRCD=1
              MOVE     CCEE1SNO,SECTOR
            ENDIF
            PACK     CCEE1MKY,CCEELV1,CCEELV2,CCEELV3                                                        
            MATCH    CCEE1EKY,CCEE1MKY
            IF       !@EQUAL
              MOVE     CCEE1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     LP04L999
LP04L105
LP04L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP04L000
.
          MATCH    "CCEE1",NAMSSFFI
          GOTO     PP04L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP04L105
          CALL      RFTCCEE1
          BRANCH   OVRCD,PP04L115
          MOVE      CCEE1MKY,KEY30 
          CALL      RSCCEE1 
PP04L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCEE1SNO
            CALL     RPCCEE1 
            IF       OVRCD=1
              MOVE     CCEE1SNO,SECTOR
            ENDIF
            PACK     CCEE1MKY,CCEELV1,CCEELV2,CCEELV3                                                        
            MATCH    CCEE1EKY,CCEE1MKY
            IF       !@EQUAL
              MOVE     CCEE1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     PP04L999
PP04L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEE1SNO
            CALL     RKCCEE1 
            IF       OVRCD=1
              MOVE     CCEE1SNO,SECTOR
            ENDIF
            PACK     CCEE1MKY,CCEELV1,CCEELV2,CCEELV3                                                        
            MATCH    CCEE1EKY,CCEE1MKY
            IF       !@EQUAL
              MOVE     CCEE1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP04L999
PP04L120
PP04L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP04L000
          MATCH    "CCEE1",NAMSSFFI
          GOTO     NP04L115 IF NOT EQUAL
NP04L105
          CALL     RKCCEE1 
          BRANCH   OVRCD,NP04L110
          PACK     CCEE1MKY,CCEELV1,CCEELV2,CCEELV3                                                        
          MATCH    CCEE1EKY,CCEE1MKY
          GOTO     NP04L110 IF NOT EQUAL
          CALL     RPCCEE1 
          CALL     DP04L000
          GOTO     NP04L999
NP04L110
          CALL     RPCCEE1 
          BEEP
          GOTO     NP04L999
NP04L115
NP04L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT04L000
CT04L105
CT04L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Casemix Level 3 Summary            
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     4 Level 3 Code & Description         
.---------------------------------------------------------
UPTCCEE1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCEE1FL1,KEY5;ANS
          IF        @OVER
            WRITE     CCEE1FL1,KEY5;SCPSROW,SCPSCOL,CCEE1MKY
          ELSE
            UPDATE    CCEE1FL1;SCPSROW,SCPSCOL,CCEE1MKY
          ENDIF
          RETURN
RDTCCEE1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCEE1FL1,KEY5;SCPSROW,SCPSCOL,CCEE1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTCCEE1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      CCEE1FL1,KEY5;;
          READKS    CCEE1FL1;SCPSROW,SCPSCOL,CCEE1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,CCEE1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Casemix Level 3 Summary            
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
          MOVE      "CCEE1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FP04L000
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Casemix Level 3 Summary            
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L101,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L102,PS04L103
          GOTO     PS04L999
.
PS04L101
          MOVE      CLV3DES,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      INCODESC,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      COSTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Casemix Level 3 Summary            
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L006,SF04L102:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L103,SF04L104:
                            SF04L105,SF04L106,SF04L107,SF04L108:
                            SF04L006,SF04L006
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L102:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          MOVE      "CCEE1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L101
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L102
          CALL      SELECTED
          BRANCH    EXIT,SF04L001
          COMPARE   ONE,ACCEPT
          GOTO      SF04L001 IF EQUAL
          CALL      RDTCCEE1
          IF        OVRCD=1
            BEEP
            GOTO      SF04L001
          ENDIF
          MATCH     SP70,CCEE1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF04L001
          ENDIF
          MOVE      CCEE1MKY,KEY30 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SEL3LV00
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCEE1
          IF        OVRCD=1
            CALL      FP04L000
          ELSE
            MOVE      CCEE1MKY,KEY30 
            CALL      RSCCEE1 
            CALL      RPCCEE1 
            CALL      DP04L000
          ENDIF
          GOTO     SF04L001
.
SF04L103
          MOVE      "CCEE1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      NP04L000
          GOTO     SF04L001
.
SF04L104
          MOVE      "CCEE1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      PP04L000
          GOTO     SF04L001
.
SF04L105
          MOVE      "CCEE1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L106
          MOVE      "CCEE1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      LP04L000
          GOTO     SF04L001
.
SF04L107
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPH3LV00
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF04L001
.
SF04L108
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SF04L999
SF04L990  MOVE      ONE,EXIT * Exit Char Restart
SF04L999  RETURN
.--------------------------------
. Screen - Casemix Level 3 Details            
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "11",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC05L200
          CALL      CF05L000 * Clear Fields
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Casemix Level 3 Details            
.-------------------------------------------------------
CF05L000
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Casemix Level 3 Details            
.--------------------------------------------------------
KY05L000
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : Casemix Level 3 Details            
.---------------------------------------------------------
WP05L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Casemix Level 3 Details            
.---------------------------------------------------------
LM05L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Casemix Level 3 Details            
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Casemix Level 3 Details            
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L999,PS05L999,PS05L101,PS05L102:
                            PS05L103,PS05L104,PS05L105,PS05L106:
                            PS05L107,PS05L108,PS05L109,PS05L110:
                            PS05L111,PS05L112,PS05L113,PS05L114:
                            PS05L115,PS05L116,PS05L117,PS05L118:
                            PS05L119,PS05L120,PS05L121,PS05L122:
                            PS05L123,PS05L124,PS05L125,PS05L126:
                            PS05L999,PS05L999,PS05L999,PS05L999:
                            PS05L999,PS05L127,PS05L128
          GOTO     PS05L999
.
PS05L101
          MOVE      CLV3DES,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L102
          MOVE      CCEELV3,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L103
          MOVE      CCXHDES,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L104
          MOVE      CCEENEP,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L105
          MOVE      CCEEFTC,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L106
          MOVE      CCEEFMN,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L107
          MOVE      CCEEFMX,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L108
          MOVE      CCEEFSV,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L109
          MOVE      CCEETTC,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L110
          MOVE      CCEETMN,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L111
          MOVE      CCEETMX,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L112
          MOVE      CCEETSV,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L113
          MOVE      CCEELTO,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L114
          MOVE      CCEELMN,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L115
          MOVE      CCEELMX,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L116
          MOVE      CCEELSV,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L117
          MOVE      FRCXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L118
          MOVE      FRCSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L119
          MOVE      FRCRANG,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L120
          MOVE      TOCXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L121
          MOVE      TOCSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L122
          MOVE      TOCRANG,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L123
          MOVE      LOSXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L124
          MOVE      LOSSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L125
          MOVE      LOSRANG,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L126
          MOVE      CCEAHCD,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L127
          MOVE      INCODESC,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L128
          MOVE      COSTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : Casemix Level 3 Details            
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L006,SF05L101,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L102,SF05L103,SF05L104:
                            SF05L105,SF05L006,SF05L006
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          GOTO     SF05L001
.
SF05L101
          MOVE      ZERO,EXIT
          GOTO      SF05L999
.
SF05L102
          CALL      KY03LV00
          MOVE      ONE,EXIT
          GOTO      SF05L999
.
SF05L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCE3L000
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF05L001
.
SF05L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      H3DP0000
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF05L001
.
SF05L105
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SF05L999
SF05L990  MOVE      ONE,EXIT * Exit Char Restart
SF05L999  RETURN
.--------------------------------
. Screen - Episodes at Level 1                
.--------------------------------
SCE1L000
SCE1L100
          MOVE      "E1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "13",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCE1L200
          CALL      CFE1L000 * Clear Fields
SCE1L300
          CALL      KYE1L000 * Enter Key Fields
          BRANCH    EXIT,SCE1L999,SCE1L999
SCE1L400
          CALL      WPE1L000 * Load any WP Details
SCE1L500
          CALL      LME1L000 * Load any Batch Details
SCE1L600
          CALL      DFE1L000 * Display Fields
SCE1L700
          CALL      SFE1L000 * Select Fields
          BRANCH    EXIT,SCE1L100,SCE1L100,SCE1L200
SCE1L800
SCE1L900
SCE1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Episodes at Level 1                
.-------------------------------------------------------
CFE1L000
CFE1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Episodes at Level 1                
.--------------------------------------------------------
KYE1L000
          MOVE      ZERO,EXIT
          GOTO      KYE1L999
.
KYE1L900  MOVE      ONE,EXIT
KYE1L999  RETURN
.---------------------------------------------------------
. Load WP files for : Episodes at Level 1                
.---------------------------------------------------------
WPE1L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Episodes at Level 1                
.---------------------------------------------------------
LME1L000
.---------------------------------------------------------
. Load for :     3 Episode                            
.---------------------------------------------------------
          PACK      KEY48,CCEBLV1,SP70
          MOVE      KEY48,CCEC2EKY
          MOVE      CCEC2EKY,CCEC2SKY
          STRIP     CCEC2SKY
          SETLPTR   CCEC2EKY,10
          CALL      RDCCEC2 
          IF        OVRCD=0
            CALL      RPCCEC2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPE1L000
          MOVE     ZERO,CCEC2CNT
          MOVE     ZERO,CCEC2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPE1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPE1L600
          MATCH    PRGID,SCPSPID
          GOTO     DPE1L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPE1L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPE1L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPE1L010,DPE1L010,DPE1L101,DPE1L102:
                            DPE1L103,DPE1L104,DPE1L105,DPE1L106:
                            DPE1L107,DPE1L108,DPE1L010,DPE1L010:
                            DPE1L010,DPE1L010,DPE1L109,DPE1L110:
                            DPE1L111,DPE1L112,DPE1L113,DPE1L010:
                            DPE1L010,DPE1L010
          GOTO      DPE1L010
.
DPE1L101
          PACK      CCEC2MKY,SP70,SP70
          CALL      UPTCCEC2
          IF        CCEC2END=0
            CALL      RKCCEC2 
            IF        OVRCD=0
              PACK      CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
              MATCH     CCEC2EKY,CCEC2MKY
              IF        @EQUAL
                MOVE      ZERO,CCEC2END
                ADD       ONE,CCEC2CNT
                CALL      UPTCCEC2
          CALL      GETEPS00
                MOVE      CCECEPS,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,CCEC2END
              ENDIF
            ELSE
              MOVE      ONE,CCEC2END
            ENDIF
          ENDIF
          IF        CCEC2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L102
          IF        CCEC2END=0
            MOVE      CCECHCD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L103
          IF        CCEC2END=0
            MOVE      CCECLV1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L104
          IF        CCEC2END=0
            MOVE      CCECLV2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L105
          IF        CCEC2END=0
            MOVE      CCECLV3,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L106
          IF        CCEC2END=0
            MOVE      CCECFTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L107
          IF        CCEC2END=0
            MOVE      CCECTTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L108
          IF        CCEC2END=0
            MOVE      CCECLOS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L109
          IF        CCEC2END=0
            MOVE      CCEPSUR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L110
          IF        CCEC2END=0
            MOVE      CCEPGIV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L111
          IF        CCEC2END=0
            MOVE      CCEPSEX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L112
          IF        CCEC2END=0
            MOVE      CCEPURN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L113
          IF        CCEC2END=0
            MOVE      CCEPAGEY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
DPE1L600
          MATCH    "CCEC2",NAMSSFFI
          GOTO     DPE1L605 IF NOT EQUAL
          GOTO     DPE1L999
DPE1L605
DPE1L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPE1L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     FPE1L105 IF NOT EQUAL
          PACK     KEY48,CCEC2SKY,SP70
          CALL     RDCCEC2  * Start
          IF       OVRCD=0
            CALL     RPCCEC2  * Start
          ENDIF
          CALL     DPE1L000
          GOTO     FPE1L999
FPE1L105
FPE1L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPE1L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     LPE1L105 IF NOT EQUAL
          PACK     KEY48,CCEC2SKY,Z70
          CALL     RSCCEC2  * End
          IF       OVRCD=1
            CALL     RPCCEC2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEC2SNO
            CALL     RPCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPE1L000
          GOTO     LPE1L999
LPE1L105
LPE1L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPE1L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     PPE1L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPE1L105
          CALL      RFTCCEC2
          BRANCH   OVRCD,PPE1L115
          MOVE      CCEC2MKY,KEY48 
          CALL      RSCCEC2 
PPE1L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCEC2SNO
            CALL     RPCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPE1L000
          GOTO     PPE1L999
PPE1L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEC2SNO
            CALL     RKCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPE1L999
PPE1L120
PPE1L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPE1L000
          MATCH    "CCEC2",NAMSSFFI
          GOTO     NPE1L115 IF NOT EQUAL
NPE1L105
          CALL     RKCCEC2 
          BRANCH   OVRCD,NPE1L110
          PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
          MATCH    CCEC2EKY,CCEC2MKY
          GOTO     NPE1L110 IF NOT EQUAL
          CALL     RPCCEC2 
          CALL     DPE1L000
          GOTO     NPE1L999
NPE1L110
          CALL     RPCCEC2 
          BEEP
          GOTO     NPE1L999
NPE1L115
NPE1L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTE1L000
CTE1L105
CTE1L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Episodes at Level 1                
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     3 Episode                            
.---------------------------------------------------------
UPTCCEC2
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCEC2FL1,KEY5;ANS
          IF        @OVER
            WRITE     CCEC2FL1,KEY5;SCPSROW,SCPSCOL,CCEC2MKY
          ELSE
            UPDATE    CCEC2FL1;SCPSROW,SCPSCOL,CCEC2MKY
          ENDIF
          RETURN
RDTCCEC2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCEC2FL1,KEY5;SCPSROW,SCPSCOL,CCEC2MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTCCEC2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      CCEC2FL1,KEY5;;
          READKS    CCEC2FL1;SCPSROW,SCPSCOL,CCEC2MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,CCEC2MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Episodes at Level 1                
.---------------------------------------------------------
DFE1L000
          BRANCH   ACCEPT,DFE1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFE1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFE1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFE1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFE1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFE1L010 IF NOT EQUAL
.
          CALL     PSE1L000 * Display Field
          GOTO     DFE1L010
DFE1L900
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE1L000
DFE1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Episodes at Level 1                
.---------------------------------------------------------
PSE1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSE1L999,PSE1L999,PSE1L999,PSE1L999:
                            PSE1L999,PSE1L999,PSE1L999,PSE1L999:
                            PSE1L999,PSE1L999,PSE1L999,PSE1L999:
                            PSE1L999,PSE1L999,PSE1L999,PSE1L999:
                            PSE1L999,PSE1L999,PSE1L999,PSE1L999:
                            PSE1L101,PSE1L102
          GOTO     PSE1L999
.
PSE1L101
          MOVE      INCODESC,VAR     
          CALL      DISPITEM
          GOTO     PSE1L999
.
PSE1L102
          MOVE      COSTDESC,VAR     
          CALL      DISPITEM
          GOTO     PSE1L999
PSE1L999
          RETURN
.---------------------------------------------------------
. Selections for : Episodes at Level 1                
.---------------------------------------------------------
SFE1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFE1L001  BRANCH   ACCEPT,SFE1L020
.
SFE1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFE1L006,SFE1L101,SFE1L102,SFE1L006:
                            SFE1L006,SFE1L006,SFE1L006,SFE1L006:
                            SFE1L006,SFE1L006,SFE1L103,SFE1L104:
                            SFE1L105,SFE1L106,SFE1L006,SFE1L006:
                            SFE1L006,SFE1L006,SFE1L006,SFE1L107:
                            SFE1L006,SFE1L006
SFE1L006  BEEP
          GOTO     SFE1L005
SFE1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFE1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFE1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFE1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFE1L020,SFE1L020,SFE1L102,SFE1L020:
                            SFE1L020,SFE1L020,SFE1L020,SFE1L020:
                            SFE1L020,SFE1L020,SFE1L020,SFE1L020:
                            SFE1L020,SFE1L020,SFE1L020,SFE1L020:
                            SFE1L020,SFE1L020,SFE1L020,SFE1L020:
                            SFE1L020,SFE1L020
          GOTO     SFE1L020
SFE1L090  MOVE     ZERO,ACCEPT
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE1L000
          GOTO     SFE1L001
.
SFE1L101
          MOVE      ZERO,EXIT
          GOTO      SFE1L999
.
SFE1L102
          CALL      SELECTED
          BRANCH    EXIT,SFE1L001
          COMPARE   ONE,ACCEPT
          GOTO      SFE1L001 IF EQUAL
          CALL      RDTCCEC2
          IF        OVRCD=1
            BEEP
            GOTO      SFE1L001
          ENDIF
          MATCH     SP70,CCEC2MKY
          IF        @EQUAL
            BEEP
            GOTO      SFE1L001
          ENDIF
          MOVE      CCEC2MKY,KEY48 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELEPS00
          MOVE      "E1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCEC2
          IF        OVRCD=1
            CALL      FPE1L000
          ELSE
            MOVE      CCEC2MKY,KEY48 
            CALL      RSCCEC2 
            CALL      RPCCEC2 
            CALL      DPE1L000
          ENDIF
          GOTO     SFE1L001
.
SFE1L103
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NPE1L000
          GOTO     SFE1L001
.
SFE1L104
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PPE1L000
          GOTO     SFE1L001
.
SFE1L105
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE1L000
          GOTO     SFE1L001
.
SFE1L106
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LPE1L000
          GOTO     SFE1L001
.
SFE1L107
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFE1L999
SFE1L990  MOVE      ONE,EXIT * Exit Char Restart
SFE1L999  RETURN
.--------------------------------
. Screen - Episodes at Level 2                
.--------------------------------
SCE2L000
SCE2L100
          MOVE      "E2",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "13",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCE2L200
          CALL      CFE2L000 * Clear Fields
SCE2L300
          CALL      KYE2L000 * Enter Key Fields
          BRANCH    EXIT,SCE2L999,SCE2L999
SCE2L400
          CALL      WPE2L000 * Load any WP Details
SCE2L500
          CALL      LME2L000 * Load any Batch Details
SCE2L600
          CALL      DFE2L000 * Display Fields
SCE2L700
          CALL      SFE2L000 * Select Fields
          BRANCH    EXIT,SCE2L100,SCE2L100,SCE2L200
SCE2L800
SCE2L900
SCE2L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Episodes at Level 2                
.-------------------------------------------------------
CFE2L000
CFE2L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Episodes at Level 2                
.--------------------------------------------------------
KYE2L000
          MOVE      ZERO,EXIT
          GOTO      KYE2L999
.
KYE2L900  MOVE      ONE,EXIT
KYE2L999  RETURN
.---------------------------------------------------------
. Load WP files for : Episodes at Level 2                
.---------------------------------------------------------
WPE2L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Episodes at Level 2                
.---------------------------------------------------------
LME2L000
.---------------------------------------------------------
. Load for :     3 Episode                            
.---------------------------------------------------------
          PACK      KEY48,CCEBLV1,CCEDLV2,SP70
          MOVE      KEY48,CCEC2EKY
          MOVE      CCEC2EKY,CCEC2SKY
          STRIP     CCEC2SKY
          SETLPTR   CCEC2EKY,20
          CALL      RDCCEC2 
          IF        OVRCD=0
            CALL      RPCCEC2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPE2L000
          MOVE     ZERO,CCEC2CNT
          MOVE     ZERO,CCEC2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPE2L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPE2L600
          MATCH    PRGID,SCPSPID
          GOTO     DPE2L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPE2L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPE2L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPE2L010,DPE2L010,DPE2L101,DPE2L102:
                            DPE2L103,DPE2L104,DPE2L105,DPE2L106:
                            DPE2L107,DPE2L108,DPE2L010,DPE2L010:
                            DPE2L010,DPE2L010,DPE2L109,DPE2L110:
                            DPE2L111,DPE2L112,DPE2L113,DPE2L010:
                            DPE2L010,DPE2L010
          GOTO      DPE2L010
.
DPE2L101
          PACK      CCEC2MKY,SP70,SP70
          CALL      UPTCCEC2
          IF        CCEC2END=0
            CALL      RKCCEC2 
            IF        OVRCD=0
              PACK      CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
              MATCH     CCEC2EKY,CCEC2MKY
              IF        @EQUAL
                MOVE      ZERO,CCEC2END
                ADD       ONE,CCEC2CNT
                CALL      UPTCCEC2
          CALL      GETEPS00
                MOVE      CCECEPS,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,CCEC2END
              ENDIF
            ELSE
              MOVE      ONE,CCEC2END
            ENDIF
          ENDIF
          IF        CCEC2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L102
          IF        CCEC2END=0
            MOVE      CCECHCD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L103
          IF        CCEC2END=0
            MOVE      CCECLV1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L104
          IF        CCEC2END=0
            MOVE      CCECLV2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L105
          IF        CCEC2END=0
            MOVE      CCECLV3,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L106
          IF        CCEC2END=0
            MOVE      CCECFTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L107
          IF        CCEC2END=0
            MOVE      CCECTTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L108
          IF        CCEC2END=0
            MOVE      CCECLOS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L109
          IF        CCEC2END=0
            MOVE      CCEPSUR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L110
          IF        CCEC2END=0
            MOVE      CCEPGIV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L111
          IF        CCEC2END=0
            MOVE      CCEPSEX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L112
          IF        CCEC2END=0
            MOVE      CCEPURN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L113
          IF        CCEC2END=0
            MOVE      CCEPAGEY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
DPE2L600
          MATCH    "CCEC2",NAMSSFFI
          GOTO     DPE2L605 IF NOT EQUAL
          GOTO     DPE2L999
DPE2L605
DPE2L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPE2L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     FPE2L105 IF NOT EQUAL
          PACK     KEY48,CCEC2SKY,SP70
          CALL     RDCCEC2  * Start
          IF       OVRCD=0
            CALL     RPCCEC2  * Start
          ENDIF
          CALL     DPE2L000
          GOTO     FPE2L999
FPE2L105
FPE2L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPE2L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     LPE2L105 IF NOT EQUAL
          PACK     KEY48,CCEC2SKY,Z70
          CALL     RSCCEC2  * End
          IF       OVRCD=1
            CALL     RPCCEC2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEC2SNO
            CALL     RPCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPE2L000
          GOTO     LPE2L999
LPE2L105
LPE2L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPE2L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     PPE2L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPE2L105
          CALL      RFTCCEC2
          BRANCH   OVRCD,PPE2L115
          MOVE      CCEC2MKY,KEY48 
          CALL      RSCCEC2 
PPE2L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCEC2SNO
            CALL     RPCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPE2L000
          GOTO     PPE2L999
PPE2L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEC2SNO
            CALL     RKCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPE2L999
PPE2L120
PPE2L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPE2L000
          MATCH    "CCEC2",NAMSSFFI
          GOTO     NPE2L115 IF NOT EQUAL
NPE2L105
          CALL     RKCCEC2 
          BRANCH   OVRCD,NPE2L110
          PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
          MATCH    CCEC2EKY,CCEC2MKY
          GOTO     NPE2L110 IF NOT EQUAL
          CALL     RPCCEC2 
          CALL     DPE2L000
          GOTO     NPE2L999
NPE2L110
          CALL     RPCCEC2 
          BEEP
          GOTO     NPE2L999
NPE2L115
NPE2L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTE2L000
CTE2L105
CTE2L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Episodes at Level 2                
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Episodes at Level 2                
.---------------------------------------------------------
DFE2L000
          BRANCH   ACCEPT,DFE2L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFE2L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFE2L900
          MATCH    PRGID,SCPSPID
          GOTO     DFE2L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFE2L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFE2L010 IF NOT EQUAL
.
          CALL     PSE2L000 * Display Field
          GOTO     DFE2L010
DFE2L900
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE2L000
DFE2L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Episodes at Level 2                
.---------------------------------------------------------
PSE2L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSE2L999,PSE2L999,PSE2L999,PSE2L999:
                            PSE2L999,PSE2L999,PSE2L999,PSE2L999:
                            PSE2L999,PSE2L999,PSE2L999,PSE2L999:
                            PSE2L999,PSE2L999,PSE2L999,PSE2L999:
                            PSE2L999,PSE2L999,PSE2L999,PSE2L999:
                            PSE2L101,PSE2L102
          GOTO     PSE2L999
.
PSE2L101
          MOVE      INCODESC,VAR     
          CALL      DISPITEM
          GOTO     PSE2L999
.
PSE2L102
          MOVE      COSTDESC,VAR     
          CALL      DISPITEM
          GOTO     PSE2L999
PSE2L999
          RETURN
.---------------------------------------------------------
. Selections for : Episodes at Level 2                
.---------------------------------------------------------
SFE2L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFE2L001  BRANCH   ACCEPT,SFE2L020
.
SFE2L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFE2L006,SFE2L101,SFE2L102,SFE2L006:
                            SFE2L006,SFE2L006,SFE2L006,SFE2L006:
                            SFE2L006,SFE2L006,SFE2L103,SFE2L104:
                            SFE2L105,SFE2L106,SFE2L006,SFE2L006:
                            SFE2L006,SFE2L006,SFE2L006,SFE2L107:
                            SFE2L006,SFE2L006
SFE2L006  BEEP
          GOTO     SFE2L005
SFE2L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFE2L090
          MATCH    PRGID,SCSLPID
          GOTO     SFE2L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFE2L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFE2L020,SFE2L020,SFE2L102,SFE2L020:
                            SFE2L020,SFE2L020,SFE2L020,SFE2L020:
                            SFE2L020,SFE2L020,SFE2L020,SFE2L020:
                            SFE2L020,SFE2L020,SFE2L020,SFE2L020:
                            SFE2L020,SFE2L020,SFE2L020,SFE2L020:
                            SFE2L020,SFE2L020
          GOTO     SFE2L020
SFE2L090  MOVE     ZERO,ACCEPT
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE2L000
          GOTO     SFE2L001
.
SFE2L101
          MOVE      ZERO,EXIT
          GOTO      SFE2L999
.
SFE2L102
          CALL      SELECTED
          BRANCH    EXIT,SFE2L001
          COMPARE   ONE,ACCEPT
          GOTO      SFE2L001 IF EQUAL
          CALL      RDTCCEC2
          IF        OVRCD=1
            BEEP
            GOTO      SFE2L001
          ENDIF
          MATCH     SP70,CCEC2MKY
          IF        @EQUAL
            BEEP
            GOTO      SFE2L001
          ENDIF
          MOVE      CCEC2MKY,KEY48 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELEPS00
          MOVE      "E2",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCEC2
          IF        OVRCD=1
            CALL      FPE2L000
          ELSE
            MOVE      CCEC2MKY,KEY48 
            CALL      RSCCEC2 
            CALL      RPCCEC2 
            CALL      DPE2L000
          ENDIF
          GOTO     SFE2L001
.
SFE2L103
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NPE1L000
          GOTO     SFE2L001
.
SFE2L104
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PPE1L000
          GOTO     SFE2L001
.
SFE2L105
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE1L000
          GOTO     SFE2L001
.
SFE2L106
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LPE1L000
          GOTO     SFE2L001
.
SFE2L107
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFE2L999
SFE2L990  MOVE      ONE,EXIT * Exit Char Restart
SFE2L999  RETURN
.--------------------------------
. Screen - Episodes at Level 3                
.--------------------------------
SCE3L000
SCE3L100
          MOVE      "E3",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "13",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCE3L200
          CALL      CFE3L000 * Clear Fields
SCE3L300
          CALL      KYE3L000 * Enter Key Fields
          BRANCH    EXIT,SCE3L999,SCE3L999
SCE3L400
          CALL      WPE3L000 * Load any WP Details
SCE3L500
          CALL      LME3L000 * Load any Batch Details
SCE3L600
          CALL      DFE3L000 * Display Fields
SCE3L700
          CALL      SFE3L000 * Select Fields
          BRANCH    EXIT,SCE3L100,SCE3L100,SCE3L200
SCE3L800
SCE3L900
SCE3L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Episodes at Level 3                
.-------------------------------------------------------
CFE3L000
CFE3L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Episodes at Level 3                
.--------------------------------------------------------
KYE3L000
          MOVE      ZERO,EXIT
          GOTO      KYE3L999
.
KYE3L900  MOVE      ONE,EXIT
KYE3L999  RETURN
.---------------------------------------------------------
. Load WP files for : Episodes at Level 3                
.---------------------------------------------------------
WPE3L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Episodes at Level 3                
.---------------------------------------------------------
LME3L000
.---------------------------------------------------------
. Load for :     3 Episode                            
.---------------------------------------------------------
          PACK      KEY48,CCEBLV1,CCEDLV2,CCEELV3,SP70
          MOVE      KEY48,CCEC2EKY
          MOVE      CCEC2EKY,CCEC2SKY
          STRIP     CCEC2SKY
          SETLPTR   CCEC2EKY,30
          CALL      RDCCEC2 
          IF        OVRCD=0
            CALL      RPCCEC2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPE3L000
          MOVE     ZERO,CCEC2CNT
          MOVE     ZERO,CCEC2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPE3L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPE3L600
          MATCH    PRGID,SCPSPID
          GOTO     DPE3L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPE3L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPE3L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPE3L010,DPE3L010,DPE3L101,DPE3L102:
                            DPE3L103,DPE3L104,DPE3L105,DPE3L106:
                            DPE3L107,DPE3L108,DPE3L010,DPE3L010:
                            DPE3L010,DPE3L010,DPE3L109,DPE3L110:
                            DPE3L111,DPE3L112,DPE3L113,DPE3L010:
                            DPE3L010,DPE3L010
          GOTO      DPE3L010
.
DPE3L101
          PACK      CCEC2MKY,SP70,SP70
          CALL      UPTCCEC2
          IF        CCEC2END=0
            CALL      RKCCEC2 
            IF        OVRCD=0
              PACK      CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
              MATCH     CCEC2EKY,CCEC2MKY
              IF        @EQUAL
                MOVE      ZERO,CCEC2END
                ADD       ONE,CCEC2CNT
                CALL      UPTCCEC2
          CALL      GETEPS00
                MOVE      CCECEPS,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,CCEC2END
              ENDIF
            ELSE
              MOVE      ONE,CCEC2END
            ENDIF
          ENDIF
          IF        CCEC2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L102
          IF        CCEC2END=0
            MOVE      CCECHCD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L103
          IF        CCEC2END=0
            MOVE      CCECLV1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L104
          IF        CCEC2END=0
            MOVE      CCECLV2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L105
          IF        CCEC2END=0
            MOVE      CCECLV3,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L106
          IF        CCEC2END=0
            MOVE      CCECFTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L107
          IF        CCEC2END=0
            MOVE      CCECTTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L108
          IF        CCEC2END=0
            MOVE      CCECLOS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L109
          IF        CCEC2END=0
            MOVE      CCEPSUR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L110
          IF        CCEC2END=0
            MOVE      CCEPGIV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L111
          IF        CCEC2END=0
            MOVE      CCEPSEX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L112
          IF        CCEC2END=0
            MOVE      CCEPURN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L113
          IF        CCEC2END=0
            MOVE      CCEPAGEY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
DPE3L600
          MATCH    "CCEC2",NAMSSFFI
          GOTO     DPE3L605 IF NOT EQUAL
          GOTO     DPE3L999
DPE3L605
DPE3L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPE3L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     FPE3L105 IF NOT EQUAL
          PACK     KEY48,CCEC2SKY,SP70
          CALL     RDCCEC2  * Start
          IF       OVRCD=0
            CALL     RPCCEC2  * Start
          ENDIF
          CALL     DPE3L000
          GOTO     FPE3L999
FPE3L105
FPE3L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPE3L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     LPE3L105 IF NOT EQUAL
          PACK     KEY48,CCEC2SKY,Z70
          CALL     RSCCEC2  * End
          IF       OVRCD=1
            CALL     RPCCEC2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEC2SNO
            CALL     RPCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPE3L000
          GOTO     LPE3L999
LPE3L105
LPE3L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPE3L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     PPE3L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPE3L105
          CALL      RFTCCEC2
          BRANCH   OVRCD,PPE3L115
          MOVE      CCEC2MKY,KEY48 
          CALL      RSCCEC2 
PPE3L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCEC2SNO
            CALL     RPCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPE3L000
          GOTO     PPE3L999
PPE3L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEC2SNO
            CALL     RKCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPE3L999
PPE3L120
PPE3L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPE3L000
          MATCH    "CCEC2",NAMSSFFI
          GOTO     NPE3L115 IF NOT EQUAL
NPE3L105
          CALL     RKCCEC2 
          BRANCH   OVRCD,NPE3L110
          PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
          MATCH    CCEC2EKY,CCEC2MKY
          GOTO     NPE3L110 IF NOT EQUAL
          CALL     RPCCEC2 
          CALL     DPE3L000
          GOTO     NPE3L999
NPE3L110
          CALL     RPCCEC2 
          BEEP
          GOTO     NPE3L999
NPE3L115
NPE3L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTE3L000
CTE3L105
CTE3L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Episodes at Level 3                
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Episodes at Level 3                
.---------------------------------------------------------
DFE3L000
          BRANCH   ACCEPT,DFE3L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFE3L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFE3L900
          MATCH    PRGID,SCPSPID
          GOTO     DFE3L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFE3L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFE3L010 IF NOT EQUAL
.
          CALL     PSE3L000 * Display Field
          GOTO     DFE3L010
DFE3L900
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE3L000
DFE3L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Episodes at Level 3                
.---------------------------------------------------------
PSE3L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSE3L999,PSE3L999,PSE3L999,PSE3L999:
                            PSE3L999,PSE3L999,PSE3L999,PSE3L999:
                            PSE3L999,PSE3L999,PSE3L999,PSE3L999:
                            PSE3L999,PSE3L999,PSE3L999,PSE3L999:
                            PSE3L999,PSE3L999,PSE3L999,PSE3L999:
                            PSE3L101,PSE3L102
          GOTO     PSE3L999
.
PSE3L101
          MOVE      INCODESC,VAR     
          CALL      DISPITEM
          GOTO     PSE3L999
.
PSE3L102
          MOVE      COSTDESC,VAR     
          CALL      DISPITEM
          GOTO     PSE3L999
PSE3L999
          RETURN
.---------------------------------------------------------
. Selections for : Episodes at Level 3                
.---------------------------------------------------------
SFE3L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFE3L001  BRANCH   ACCEPT,SFE3L020
.
SFE3L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFE3L006,SFE3L101,SFE3L102,SFE3L006:
                            SFE3L006,SFE3L006,SFE3L006,SFE3L006:
                            SFE3L006,SFE3L006,SFE3L103,SFE3L104:
                            SFE3L105,SFE3L106,SFE3L006,SFE3L006:
                            SFE3L006,SFE3L006,SFE3L006,SFE3L107:
                            SFE3L006,SFE3L006
SFE3L006  BEEP
          GOTO     SFE3L005
SFE3L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFE3L090
          MATCH    PRGID,SCSLPID
          GOTO     SFE3L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFE3L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFE3L020,SFE3L020,SFE3L102,SFE3L020:
                            SFE3L020,SFE3L020,SFE3L020,SFE3L020:
                            SFE3L020,SFE3L020,SFE3L020,SFE3L020:
                            SFE3L020,SFE3L020,SFE3L020,SFE3L020:
                            SFE3L020,SFE3L020,SFE3L020,SFE3L020:
                            SFE3L020,SFE3L020
          GOTO     SFE3L020
SFE3L090  MOVE     ZERO,ACCEPT
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE3L000
          GOTO     SFE3L001
.
SFE3L101
          MOVE      ZERO,EXIT
          GOTO      SFE3L999
.
SFE3L102
          CALL      SELECTED
          BRANCH    EXIT,SFE3L001
          COMPARE   ONE,ACCEPT
          GOTO      SFE3L001 IF EQUAL
          CALL      RDTCCEC2
          IF        OVRCD=1
            BEEP
            GOTO      SFE3L001
          ENDIF
          MATCH     SP70,CCEC2MKY
          IF        @EQUAL
            BEEP
            GOTO      SFE3L001
          ENDIF
          MOVE      CCEC2MKY,KEY48 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELEPS00
          MOVE      "E3",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCEC2
          IF        OVRCD=1
            CALL      FPE3L000
          ELSE
            MOVE      CCEC2MKY,KEY48 
            CALL      RSCCEC2 
            CALL      RPCCEC2 
            CALL      DPE3L000
          ENDIF
          GOTO     SFE3L001
.
SFE3L103
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NPE1L000
          GOTO     SFE3L001
.
SFE3L104
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PPE1L000
          GOTO     SFE3L001
.
SFE3L105
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE1L000
          GOTO     SFE3L001
.
SFE3L106
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LPE1L000
          GOTO     SFE3L001
.
SFE3L107
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFE3L999
SFE3L990  MOVE      ONE,EXIT * Exit Char Restart
SFE3L999  RETURN
.--------------------------------
. Screen - Epiosde Details                    
.--------------------------------
SCEDL000
SCEDL100
          MOVE      "ED",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 3",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCEDL200
          CALL      CFEDL000 * Clear Fields
SCEDL300
          CALL      KYEDL000 * Enter Key Fields
          BRANCH    EXIT,SCEDL999,SCEDL999
SCEDL400
          CALL      WPEDL000 * Load any WP Details
SCEDL500
          CALL      LMEDL000 * Load any Batch Details
SCEDL600
          CALL      DFEDL000 * Display Fields
SCEDL700
          CALL      SFEDL000 * Select Fields
          BRANCH    EXIT,SCEDL100,SCEDL100,SCEDL200
SCEDL800
SCEDL900
SCEDL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Epiosde Details                    
.-------------------------------------------------------
CFEDL000
CFEDL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Epiosde Details                    
.--------------------------------------------------------
KYEDL000
          MOVE      ZERO,EXIT
          GOTO      KYEDL999
.
KYEDL900  MOVE      ONE,EXIT
KYEDL999  RETURN
.---------------------------------------------------------
. Load WP files for : Epiosde Details                    
.---------------------------------------------------------
WPEDL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Epiosde Details                    
.---------------------------------------------------------
LMEDL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Epiosde Details                    
.---------------------------------------------------------
DFEDL000
          BRANCH   ACCEPT,DFEDL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFEDL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFEDL900
          MATCH    PRGID,SCPSPID
          GOTO     DFEDL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFEDL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFEDL010 IF NOT EQUAL
.
          CALL     PSEDL000 * Display Field
          GOTO     DFEDL010
DFEDL900
DFEDL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Epiosde Details                    
.---------------------------------------------------------
PSEDL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSEDL999,PSEDL999,PSEDL999,PSEDL999:
                            PSEDL999,PSEDL101,PSEDL102,PSEDL103:
                            PSEDL104,PSEDL105,PSEDL106,PSEDL107:
                            PSEDL108,PSEDL109,PSEDL110,PSEDL111:
                            PSEDL112,PSEDL113,PSEDL114,PSEDL115:
                            PSEDL116,PSEDL117,PSEDL118,PSEDL119:
                            PSEDL120,PSEDL121,PSEDL122,PSEDL123:
                            PSEDL124,PSEDL125,PSEDL126,PSEDL127:
                            PSEDL128,PSEDL129,PSEDL130,PSEDL131:
                            PSEDL132,PSEDL133,PSEDL134,PSEDL135:
                            PSEDL136,PSEDL137,PSEDL138,PSEDL139:
                            PSEDL140,PSEDL141,PSEDL142,PSEDL143:
                            PSEDL144,PSEDL145,PSEDL146,PSEDL147:
                            PSEDL148,PSEDL149,PSEDL150,PSEDL151:
                            PSEDL152,PSEDL153,PSEDL154,PSEDL155:
                            PSEDL156,PSEDL157,PSEDL158,PSEDL999:
                           PSEDL999,PSEDL999,PSEDL159,PSEDL160:
                            PSEDL161,PSEDL162,PSEDL163,PSEDL164:
                            PSEDL165,PSEDL166,PSEDL167,PSEDL168:
                            PSEDL169,PSEDL170,PSEDL171,PSEDL172:
                            PSEDL173,PSEDL174,PSEDL175,PSEDL176:
                            PSEDL177,PSEDL178,PSEDL179,PSEDL180:
                            PSEDL181,PSEDL182,PSEDL183,PSEDL184
          GOTO     PSEDL999
.
PSEDL101
          MOVE      CCEPHCD,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL102
          MOVE      CCEPEPS,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPCOM,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL104
          MOVE      CCEPURN,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL105
          UNPACK    CCEPSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL106
          UNPACK    CCEPLTD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL107
          MOVE      CCEPLOS,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPINPT,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPDAY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL110
          MOVE      CCEPVIST,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL111
          MOVE      CCEPSEX,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL112
          UNPACK    CCEPDOB,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL113
          MOVE      CCEPAGEY,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL114
          MOVE      CCEPAGEM,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL115
          MOVE      CCEPAGED,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL116
          MOVE      CCEPCOB,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL117
          MOVE      CCEPREL,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL118
          UNPACK    CCEPDDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL119
          MOVE      CCEPDSTA,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL120
          MOVE      CCEPDDES,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL121
          MOVE      CCEPDMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL122
          MOVE      CCEPDDPT,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL123
          MOVE      CCEPDSER,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL124
          MOVE      CCEPMDCC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL125
          MOVE      CCEPDRGC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL126
          UNPACK    CCEPADAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL127
          MOVE      CCEPAWAR,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL128
          MOVE      CCEPASRC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL129
          MOVE      CCEPACLS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL130
          MOVE      CCEPACAR,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL131
          MOVE      CCEPADPT,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL132
          MOVE      CCEPASER,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL133
          MOVE      CCEPARDC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL134
          MOVE      CCEPATDC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL135
          MOVE      CCEPAADC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL136
          MOVE      CCEPDADC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL137
          MOVE      CCEPAHFD,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL138
          MOVE      CCEPAHTB,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL139
          MOVE      CCEPAMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL140
          MOVE      CCEPOPCL,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL141
          MOVE      CCEPPDIA,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL142
          MOVE      CCEPSDIA,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL143
          MOVE      CCEPPOPP,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL144
          MOVE      CCEPSOPP,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL145
          MOVE      CCEPDWAR,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL146
          MOVE      CCEPSUR,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL147
          MOVE      CCEPGIV,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL148
          MOVE      CCEPPMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL149
          MOVE      CCEPSMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL150
          MOVE      CCEPMU1,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL151
          MOVE      CCEPMU2,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL152
          MOVE      CCEPMU3,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL153
          MOVE      CCEPMU4,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL154
          MOVE      CCEPMU5,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL155
          MOVE      CCEPMU6,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL156
          MOVE      CCEPMU7,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL157
          MOVE      CCEPPCD,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL158
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPEXC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL159
          MOVE      CLV1DES,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL160
          MOVE      CLV2DES,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL161
          MOVE      CLV3DES,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL162
          MOVE      CCECHCD,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL163
          MOVE      CCECEPS,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL164
          MOVE      CCECLV1,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL165
          MOVE      CCECLV2,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL166
          MOVE      CCECLV3,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL167
          MOVE      CCECFTC,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL168
          MOVE      BDTOTF,VAR       
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL169
          MOVE      CCECTTC,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL170
          MOVE      BDTOTT,VAR       
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL171
          MOVE      CCEPCLI,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL172
          MOVE      CCEPCTY,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL173
          MOVE      CCEPANA,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL174
          MOVE      CCEPOTY,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL175
          MOVE      CCEPTTR,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL176
          MOVE      CCEPOY6,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL177
          MOVE      CCEPOY7,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL178
          MOVE      CCEPOY8,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL179
          MOVE      CCEPOY9,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL180
          MOVE      CCEPORM,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL181
          MOVE      CCEPOKI,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL182
          MOVE      CCEPOTP,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL183
          MOVE      CCEPTST,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL184
          MOVE      CCEPCLM,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
PSEDL999
          RETURN
.---------------------------------------------------------
. Selections for : Epiosde Details                    
.---------------------------------------------------------
SFEDL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFEDL001  BRANCH   ACCEPT,SFEDL020
.
SFEDL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFEDL006,SFEDL101,SFEDL102,SFEDL103:
                            SFEDL104,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                           SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006
SFEDL006  BEEP
          GOTO     SFEDL005
SFEDL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFEDL090
          MATCH    PRGID,SCSLPID
          GOTO     SFEDL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFEDL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                           SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020
          GOTO     SFEDL020
SFEDL090  MOVE     ZERO,ACCEPT
          GOTO     SFEDL001
.
SFEDL101
          MOVE      ZERO,EXIT
          GOTO      SFEDL999
.
SFEDL102
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFEDL999
.
SFEDL103
          CALL      SCIAL000
          MOVE      ZERO,EXIT
          GOTO      SFEDL999
.
SFEDL104
          CALL      SCEFL000
          MOVE      ONE,EXIT
          GOTO      SFEDL999
SFEDL990  MOVE      ONE,EXIT * Exit Char Restart
SFEDL999  RETURN
.--------------------------------
. Screen - More Extra Details                 
.--------------------------------
SCEFL000
SCEFL100
          MOVE      "EF",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCEFL200
          CALL      CFEFL000 * Clear Fields
SCEFL300
          CALL      KYEFL000 * Enter Key Fields
          BRANCH    EXIT,SCEFL999,SCEFL999
SCEFL400
          CALL      WPEFL000 * Load any WP Details
SCEFL500
          CALL      LMEFL000 * Load any Batch Details
SCEFL600
          CALL      DFEFL000 * Display Fields
SCEFL700
          CALL      SFEFL000 * Select Fields
          BRANCH    EXIT,SCEFL100,SCEFL100,SCEFL200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SCEFL800
SCEFL900
SCEFL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : More Extra Details                 
.-------------------------------------------------------
CFEFL000
CFEFL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for More Extra Details                 
.--------------------------------------------------------
KYEFL000
          MOVE      ZERO,EXIT
          GOTO      KYEFL999
.
KYEFL900  MOVE      ONE,EXIT
KYEFL999  RETURN
.---------------------------------------------------------
. Load WP files for : More Extra Details                 
.---------------------------------------------------------
WPEFL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : More Extra Details                 
.---------------------------------------------------------
LMEFL000
          RETURN
.---------------------------------------------------------
. Display Fields for : More Extra Details                 
.---------------------------------------------------------
DFEFL000
          BRANCH   ACCEPT,DFEFL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFEFL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFEFL900
          MATCH    PRGID,SCPSPID
          GOTO     DFEFL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFEFL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFEFL010 IF NOT EQUAL
.
          CALL     PSEFL000 * Display Field
          GOTO     DFEFL010
DFEFL900
DFEFL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : More Extra Details                 
.---------------------------------------------------------
PSEFL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSEFL999,PSEFL999,PSEFL999,PSEFL999:
                            PSEFL999,PSEFL101,PSEFL102,PSEFL103:
                            PSEFL104,PSEFL105,PSEFL106,PSEFL107:
                            PSEFL108,PSEFL109,PSEFL110,PSEFL111:
                            PSEFL112,PSEFL113,PSEFL114,PSEFL115:
                            PSEFL116,PSEFL117,PSEFL118,PSEFL119:
                            PSEFL120,PSEFL121,PSEFL122,PSEFL123:
                            PSEFL124,PSEFL125,PSEFL126,PSEFL127:
                            PSEFL128,PSEFL129,PSEFL130,PSEFL131:
                            PSEFL132,PSEFL133,PSEFL134,PSEFL135:
                            PSEFL136,PSEFL137,PSEFL138,PSEFL139:
                            PSEFL140,PSEFL141,PSEFL142,PSEFL143:
                            PSEFL144,PSEFL145,PSEFL146,PSEFL147:
                            PSEFL148,PSEFL149,PSEFL150,PSEFL151:
                            PSEFL152,PSEFL153,PSEFL154,PSEFL155:
                            PSEFL156,PSEFL157,PSEFL158,PSEFL999:
                           PSEFL999,PSEFL999,PSEFL159,PSEFL160:
                            PSEFL161,PSEFL162,PSEFL163,PSEFL164:
                            PSEFL165,PSEFL166,PSEFL167,PSEFL168:
                            PSEFL169,PSEFL170,PSEFL171,PSEFL172:
                            PSEFL173,PSEFL174,PSEFL175,PSEFL176:
                            PSEFL177,PSEFL178,PSEFL179,PSEFL180:
                            PSEFL181,PSEFL182,PSEFL183,PSEFL184:
                            PSEFL185,PSEFL186,PSEFL187,PSEFL188
          GOTO     PSEFL999
.
PSEFL101
          MOVE      CCEPHCD,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL102
          MOVE      CCEPEPS,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPCOM,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL104
          MOVE      CCEPURN,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL105
          UNPACK    CCEPSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL106
          UNPACK    CCEPLTD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL107
          MOVE      CCEPLOS,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPINPT,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPDAY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL110
          MOVE      CCEPVIST,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL111
          MOVE      CCEPSEX,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL112
          UNPACK    CCEPDOB,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL113
          MOVE      CCEPAGEY,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL114
          MOVE      CCEPAGEM,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL115
          MOVE      CCEPAGED,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL116
          MOVE      CCEPCOB,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL117
          MOVE      CCEPREL,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL118
          UNPACK    CCEPDDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL119
          MOVE      CCEPDSTA,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL120
          MOVE      CCEPDDES,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL121
          MOVE      CCEPDMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL122
          MOVE      CCEPDDPT,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL123
          MOVE      CCEPDSER,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL124
          MOVE      CCEPMDCC,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL125
          MOVE      CCEPDRGC,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL126
          UNPACK    CCEPADAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL127
          MOVE      CCEPAWAR,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL128
          MOVE      CCEPASRC,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL129
          MOVE      CCEPACLS,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL130
          MOVE      CCEPACAR,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL131
          MOVE      CCEPADPT,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL132
          MOVE      CCEPASER,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL133
          MOVE      CCEPARDC,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL134
          MOVE      CCEPATDC,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL135
          MOVE      CCEPAADC,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL136
          MOVE      CCEPDADC,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL137
          MOVE      CCEPAHFD,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL138
          MOVE      CCEPAHTB,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL139
          MOVE      CCEPAMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL140
          MOVE      CCEPOPCL,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL141
          MOVE      CCEPPDIA,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL142
          MOVE      CCEPSDIA,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL143
          MOVE      CCEPPOPP,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL144
          MOVE      CCEPSOPP,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL145
          MOVE      CCEPDWAR,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL146
          MOVE      CCEPSUR,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL147
          MOVE      CCEPGIV,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL148
          MOVE      CCEPPMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL149
          MOVE      CCEPSMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL150
          MOVE      CCEPMU1,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL151
          MOVE      CCEPMU2,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL152
          MOVE      CCEPMU3,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL153
          MOVE      CCEPMU4,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL154
          MOVE      CCEPMU5,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL155
          MOVE      CCEPMU6,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL156
          MOVE      CCEPMU7,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL157
          MOVE      CCEPPCD,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL158
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPEXC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL159
          MOVE      CLV1DES,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL160
          MOVE      CLV2DES,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL161
          MOVE      CLV3DES,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL162
          MOVE      CCECHCD,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL163
          MOVE      CCECEPS,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL164
          MOVE      CCECLV1,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL165
          MOVE      CCECLV2,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL166
          MOVE      CCECLV3,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL167
          MOVE      CCECFTC,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL168
          MOVE      BDTOTF,VAR       
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL169
          MOVE      CCECTTC,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL170
          MOVE      BDTOTT,VAR       
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL171
          MOVE      CCEPCLI,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL172
          MOVE      CCEPCTY,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL173
          MOVE      CCEPANA,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL174
          MOVE      CCEPOTY,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL175
          MOVE      CCEPTTR,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL176
          MOVE      CCEPOY6,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL177
          MOVE      CCEPOY7,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL178
          MOVE      CCEPOY8,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL179
          MOVE      CCEPOY9,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL180
          MOVE      CCEPORM,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL181
          MOVE      CCEPOKI,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL182
          MOVE      CCEPOTP,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL183
          MOVE      CCEPTST,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL184
          MOVE      CCEPCLM,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL185
          MOVE      CCIATT1,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL186
          MOVE      CCIATT2,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL187
          MOVE      CCIATT3,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
.
PSEFL188
          MOVE      CCIATT4,VAR      
          CALL      DISPITEM
          GOTO     PSEFL999
PSEFL999
          RETURN
.---------------------------------------------------------
. Selections for : More Extra Details                 
.---------------------------------------------------------
SFEFL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFEFL001  BRANCH   ACCEPT,SFEFL020
.
SFEFL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFEFL006,SFEFL101,SFEFL102,SFEFL103:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                           SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006:
                            SFEFL006,SFEFL006,SFEFL006,SFEFL006
SFEFL006  BEEP
          GOTO     SFEFL005
SFEFL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFEFL090
          MATCH    PRGID,SCSLPID
          GOTO     SFEFL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFEFL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                           SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020:
                            SFEFL020,SFEFL020,SFEFL020,SFEFL020
          GOTO     SFEFL020
SFEFL090  MOVE     ZERO,ACCEPT
          GOTO     SFEFL001
.
SFEFL101
          MOVE      ZERO,EXIT
          GOTO      SFEFL999
.
SFEFL102
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFEFL999
.
SFEFL103
          CALL      SCIAL000
          MOVE      ZERO,EXIT
          GOTO      SFEFL999
SFEFL990  MOVE      FOUR,EXIT * Exit Char Exit
SFEFL999  RETURN
.--------------------------------
. Screen - Graph Options                      
.--------------------------------
SCGOL000
SCGOL100
          MOVE      "GO",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 40",CRIG
          MOVE      "10",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCGOL200
          CALL      CFGOL000 * Clear Fields
SCGOL300
          CALL      KYGOL000 * Enter Key Fields
          BRANCH    EXIT,SCGOL999,SCGOL999
SCGOL400
          CALL      WPGOL000 * Load any WP Details
SCGOL500
          CALL      LMGOL000 * Load any Batch Details
SCGOL600
          CALL      DFGOL000 * Display Fields
SCGOL700
          CALL      SFGOL000 * Select Fields
          BRANCH    EXIT,SCGOL100,SCGOL100,SCGOL200
SCGOL800
SCGOL900
SCGOL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Graph Options                      
.-------------------------------------------------------
CFGOL000
CFGOL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Graph Options                      
.--------------------------------------------------------
KYGOL000
          MOVE      ZERO,EXIT
          GOTO      KYGOL999
.
KYGOL900  MOVE      ONE,EXIT
KYGOL999  RETURN
.---------------------------------------------------------
. Load WP files for : Graph Options                      
.---------------------------------------------------------
WPGOL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Graph Options                      
.---------------------------------------------------------
LMGOL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Graph Options                      
.---------------------------------------------------------
DFGOL000
          BRANCH   ACCEPT,DFGOL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFGOL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFGOL900
          MATCH    PRGID,SCPSPID
          GOTO     DFGOL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFGOL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFGOL010 IF NOT EQUAL
.
          CALL     PSGOL000 * Display Field
          GOTO     DFGOL010
DFGOL900
DFGOL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Graph Options                      
.---------------------------------------------------------
PSGOL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSGOL999,PSGOL999,PSGOL101,PSGOL999:
                            PSGOL102,PSGOL103,PSGOL104,PSGOL105:
                            PSGOL106,PSGOL107,PSGOL108,PSGOL109:
                            PSGOL999,PSGOL999,PSGOL999,PSGOL999:
                           PSGOL110,PSGOL999
          GOTO     PSGOL999
.
PSGOL101
          MOVE      GRAPHLEV,VAR     
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLTO,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLAV,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL104
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLMN,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLMX,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFTO,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFAV,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFMN,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFMX,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHEPS,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
PSGOL999
          RETURN
.---------------------------------------------------------
. Selections for : Graph Options                      
.---------------------------------------------------------
SFGOL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFGOL001  BRANCH   ACCEPT,SFGOL020
.
SFGOL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFGOL006,SFGOL101,SFGOL006,SFGOL102:
                            SFGOL103,SFGOL104,SFGOL105,SFGOL106:
                            SFGOL107,SFGOL108,SFGOL109,SFGOL110:
                            SFGOL006,SFGOL006,SFGOL006,SFGOL006:
                           SFGOL111,SFGOL112
SFGOL006  BEEP
          GOTO     SFGOL005
SFGOL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFGOL090
          MATCH    PRGID,SCSLPID
          GOTO     SFGOL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFGOL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFGOL020,SFGOL020,SFGOL020,SFGOL020:
                            SFGOL103,SFGOL104,SFGOL105,SFGOL106:
                            SFGOL107,SFGOL108,SFGOL109,SFGOL110:
                            SFGOL020,SFGOL020,SFGOL020,SFGOL020:
                           SFGOL111,SFGOL020
          GOTO     SFGOL020
SFGOL090  MOVE     ZERO,ACCEPT
          GOTO     SFGOL001
.
SFGOL101
          MOVE      ZERO,EXIT
          GOTO      SFGOL999
.
SFGOL102
          CALL      GRAPH000
          GOTO      SFGOL001
.
SFGOL103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHLTO00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL103
            ENDIF
            BRANCH    EXIT,SFGOL103,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLTO,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHLAV00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL104
            ENDIF
            BRANCH    EXIT,SFGOL104,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLAV,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHLMN00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL105
            ENDIF
            BRANCH    EXIT,SFGOL105,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLMN,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL106
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHLMX00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL106
            ENDIF
            BRANCH    EXIT,SFGOL106,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLMX,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL107
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHFTO00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL107
            ENDIF
            BRANCH    EXIT,SFGOL107,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFTO,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL108
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHFAV00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL108
            ENDIF
            BRANCH    EXIT,SFGOL108,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFAV,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL109
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHFMN00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL109
            ENDIF
            BRANCH    EXIT,SFGOL109,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFMN,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL110
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHFMX00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL110
            ENDIF
            BRANCH    EXIT,SFGOL110,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFMX,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL111
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHEPS00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL111
            ENDIF
            BRANCH    EXIT,SFGOL111,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHEPS,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL112
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFGOL999
SFGOL990  MOVE      ONE,EXIT * Exit Char Restart
SFGOL999  RETURN
.--------------------------------
. Screen - Income/Cost Analysis Details       
.--------------------------------
SCIAL000
SCIAL100
          MOVE      "IA",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   89",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCIAL200
          CALL      CFIAL000 * Clear Fields
          CALL      GETIAD00
SCIAL300
          CALL      KYIAL000 * Enter Key Fields
          BRANCH    EXIT,SCIAL999,SCIAL999
SCIAL400
          CALL      WPIAL000 * Load any WP Details
SCIAL500
          CALL      LMIAL000 * Load any Batch Details
SCIAL600
          CALL      DFIAL000 * Display Fields
SCIAL700
          CALL      SFIAL000 * Select Fields
          BRANCH    EXIT,SCIAL100,SCIAL100,SCIAL200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SCIAL800
SCIAL900
SCIAL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Income/Cost Analysis Details       
.-------------------------------------------------------
CFIAL000
CFIAL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Income/Cost Analysis Details       
.--------------------------------------------------------
KYIAL000
          MOVE      ZERO,EXIT
          GOTO      KYIAL999
.
KYIAL900  MOVE      ONE,EXIT
KYIAL999  RETURN
.---------------------------------------------------------
. Load WP files for : Income/Cost Analysis Details       
.---------------------------------------------------------
WPIAL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Income/Cost Analysis Details       
.---------------------------------------------------------
LMIAL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Income/Cost Analysis Details       
.---------------------------------------------------------
DFIAL000
          BRANCH   ACCEPT,DFIAL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFIAL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFIAL900
          MATCH    PRGID,SCPSPID
          GOTO     DFIAL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFIAL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFIAL010 IF NOT EQUAL
.
          CALL     PSIAL000 * Display Field
          GOTO     DFIAL010
DFIAL900
DFIAL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Income/Cost Analysis Details       
.---------------------------------------------------------
PSIAL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSIAL101,PSIAL102,PSIAL103,PSIAL104:
                            PSIAL105,PSIAL106,PSIAL107,PSIAL108:
                            PSIAL109,PSIAL110,PSIAL111,PSIAL112:
                            PSIAL113,PSIAL114,PSIAL115,PSIAL116:
                            PSIAL117,PSIAL118,PSIAL119,PSIAL120:
                            PSIAL121,PSIAL122,PSIAL123,PSIAL124:
                            PSIAL125,PSIAL126,PSIAL127,PSIAL128:
                            PSIAL129,PSIAL130,PSIAL131,PSIAL132:
                            PSIAL133,PSIAL134,PSIAL135,PSIAL136:
                            PSIAL137,PSIAL138,PSIAL139,PSIAL140:
                            PSIAL141,PSIAL142,PSIAL143,PSIAL144:
                            PSIAL145,PSIAL146,PSIAL147,PSIAL148:
                            PSIAL149,PSIAL150,PSIAL151,PSIAL152:
                            PSIAL153,PSIAL154,PSIAL155,PSIAL156:
                            PSIAL157,PSIAL158,PSIAL159,PSIAL160:
                            PSIAL161,PSIAL162,PSIAL163,PSIAL164:
                            PSIAL165,PSIAL166,PSIAL167,PSIAL168:
                            PSIAL169,PSIAL170,PSIAL171,PSIAL172:
                            PSIAL173,PSIAL174,PSIAL175,PSIAL176:
                            PSIAL177,PSIAL178,PSIAL179,PSIAL180:
                            PSIAL181,PSIAL182,PSIAL183,PSIAL184:
                            PSIAL185,PSIAL186,PSIAL187,PSIAL188:
                            PSIAL999,PSIAL999
          GOTO     PSIAL999
.
PSIAL101
          MOVE      CCCOCD1,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL102
          MOVE      CCCOCD2,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL103
          MOVE      CCCOCD3,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL104
          MOVE      CCCOCD4,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL105
          MOVE      CCCOCD5,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL106
          MOVE      CCCOIA1,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL107
          MOVE      CCCOIA2,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL108
          MOVE      CCCOIA3,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL109
          MOVE      CCCOIM1,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL110
          MOVE      CCCOIM2,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL111
          MOVE      CCCOIM3,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL112
          MOVE      CCCOIA1,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL113
          MOVE      CCCOIA2,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL114
          MOVE      CCCOIA3,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL115
          MOVE      CCIABA1,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL116
          MOVE      CCIABA2,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL117
          MOVE      CCIABA3,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL118
          MOVE      CCIALOS,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL119
          MOVE      CCIAITH,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL120
          MOVE      CCIAIA1,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL121
          MOVE      CCIAIA2,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL122
          MOVE      CCIAIA3,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL123
          MOVE      CCIAIAO,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL124
          MOVE      CCIAIM1,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL125
          MOVE      CCIAIM2,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL126
          MOVE      CCIAIM3,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL127
          MOVE      CCIAIMO,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL128
          MOVE      CCIAETH1,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL129
          MOVE      CCIAETH2,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL130
          MOVE      CCIAETH3,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL131
          MOVE      CCIAETH4,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL132
          MOVE      CCIAETH5,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL133
          MOVE      CCIAEA11,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL134
          MOVE      CCIAEA12,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL135
          MOVE      CCIAEA13,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL136
          MOVE      CCIAEA14,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL137
          MOVE      CCIAEA15,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL138
          MOVE      CCIAEA21,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL139
          MOVE      CCIAEA22,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL140
          MOVE      CCIAEA23,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL141
          MOVE      CCIAEA24,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL142
          MOVE      CCIAEA25,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL143
          MOVE      CCIAEA31,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL144
          MOVE      CCIAEA32,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL145
          MOVE      CCIAEA33,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL146
          MOVE      CCIAEA34,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL147
          MOVE      CCIAEA35,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL148
          MOVE      CCIAEAO1,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL149
          MOVE      CCIAEAO2,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL150
          MOVE      CCIAEAO3,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL151
          MOVE      CCIAEAO4,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL152
          MOVE      CCIAEAO5,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL153
          MOVE      CCIAEM11,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL154
          MOVE      CCIAEM12,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL155
          MOVE      CCIAEM13,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL156
          MOVE      CCIAEM14,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL157
          MOVE      CCIAEM15,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL158
          MOVE      CCIAEM21,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL159
          MOVE      CCIAEM22,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL160
          MOVE      CCIAEM23,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL161
          MOVE      CCIAEM24,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL162
          MOVE      CCIAEM25,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL163
          MOVE      CCIAEM31,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL164
          MOVE      CCIAEM32,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL165
          MOVE      CCIAEM33,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL166
          MOVE      CCIAEM34,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL167
          MOVE      CCIAEM35,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL168
          MOVE      CCIAEMO1,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL169
          MOVE      CCIAEMO2,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL170
          MOVE      CCIAEMO3,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL171
          MOVE      CCIAEMO4,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL172
          MOVE      CCIAEMO5,VAR     
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL173
          MOVE      COSTETH,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL174
          MOVE      COSTEA1,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL175
          MOVE      COSTEA2,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL176
          MOVE      COSTEA3,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL177
          MOVE      COSTEAO,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL178
          MOVE      COSTEM1,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL179
          MOVE      COSTEM2,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL180
          MOVE      COSTEM3,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL181
          MOVE      COSTEMO,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL182
          MOVE      TOTINC,VAR       
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL183
          MOVE      TOTCST,VAR       
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL184
          MOVE      TOTCST1,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL185
          MOVE      TOTCST2,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL186
          MOVE      TOTCST3,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL187
          MOVE      TOTCST4,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
.
PSIAL188
          MOVE      TOTCST5,VAR      
          CALL      DISPITEM
          GOTO     PSIAL999
PSIAL999
          RETURN
.---------------------------------------------------------
. Selections for : Income/Cost Analysis Details       
.---------------------------------------------------------
SFIAL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFIAL001  BRANCH   ACCEPT,SFIAL020
.
SFIAL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL006,SFIAL006,SFIAL006:
                            SFIAL006,SFIAL101
SFIAL006  BEEP
          GOTO     SFIAL005
SFIAL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFIAL090
          MATCH    PRGID,SCSLPID
          GOTO     SFIAL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFIAL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020,SFIAL020,SFIAL020:
                            SFIAL020,SFIAL020
          GOTO     SFIAL020
SFIAL090  MOVE     ZERO,ACCEPT
          GOTO     SFIAL001
.
SFIAL101
          MOVE      ZERO,EXIT
          GOTO      SFIAL999
SFIAL990  MOVE      FOUR,EXIT * Exit Char Exit
SFIAL999  RETURN
.@@@@@ Function Restart Point @@@@@
.--------------------------------------------------
. Get Details for Level 1
.--------------------------------------------------
LV1DET00  PACK      KEY13,CCEALV1,CCEBLV1
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      SP70,CCXHDES
            MATCH     Z70,CCEBLV1
            IF        @EQUAL
              MOVE      "Other",CCXHDES
            ENDIF
          ENDIF
.
          SFORMAT   VAR,CCSTLEN
          MOVE      CCEBLV1,VAR
          PACK      LEV1DESC,VAR,SP1,CCXHDES
          SFORMAT   VAR,127
.
          MOVE      CCEBFSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,FRCSDEV
          ASSIGN    CCEBFTC/CCEBNEP,FRCXBAR
          ASSIGN    CCEBFMX-CCEBFMN,FRCRANG
.
          MOVE      CCEBTSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,TOCSDEV
          ASSIGN    CCEBTTC/CCEBNEP,TOCXBAR
          ASSIGN    CCEBTMX-CCEBTMN,TOCRANG
.
          MOVE      CCEBLSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,LOSSDEV
          ASSIGN    CCEBLTO/CCEBNEP,LOSXBAR
          ASSIGN    CCEBLMX-CCEBLMN,LOSRANG
          GOTO      LV1DET99
.
LV1DET90  MOVE      ZERO,CCEBNEP
          MOVE      ZERO,CCEBFTC
          MOVE      ZERO,CCEBFMX
          MOVE      ZERO,CCEBFMN
          MOVE      ZERO,CCEBFSV
          MOVE      ZERO,FRCSDEV
          MOVE      ZERO,FRCXBAR
          MOVE      ZERO,FRCRANG
.
          MOVE      ZERO,CCEBTTC
          MOVE      ZERO,CCEBTMX
          MOVE      ZERO,CCEBTMN
          MOVE      ZERO,CCEBTSV
          MOVE      ZERO,TOCSDEV
          MOVE      ZERO,TOCXBAR
          MOVE      ZERO,TOCRANG
.
          MOVE      ZERO,CCEBLTO
          MOVE      ZERO,CCEBLMX
          MOVE      ZERO,CCEBLMN
          MOVE      ZERO,CCEBLSV
          MOVE      ZERO,LOSSDEV
          MOVE      ZERO,LOSXBAR
          MOVE      ZERO,LOSRANG
.
LV1DET99  RETURN
.------------------------------------------------------------
. Routine to Calculate Standard Deviation (CCSTDDEV)
.          given the Statistical Variance (CCVARIAN)
.------------------------------------------------------------
CALSD000  COMPARE   ONE,CASTDDEV
          GOTO      CALSD999 IF NOT EQUAL
          MOVE      ZERO,CCSTDDEV
          COMPARE   ZERO,CCVARIAN
          GOTO      CALSD999 IF EQUAL
          GOTO      CALSD999 IF LESS
          COMPARE   "999999999999.9999",CCVARIAN  * Out of Bounds
          GOTO      CALSD999 IF EQUAL
.
          MOVE      "10000",CCFACTOR
.
CALSD100  ADD       CCFACTOR,CCSTDDEV
          ASSIGN    (CCSTDDEV*CCSTDDEV),CCTSTVAR
          COMPARE   CCVARIAN,CCTSTVAR
          GOTO      CALSD999 IF EQUAL           * have the root
          GOTO      CALSD100 IF LESS
.
          SUB       CCFACTOR,CCSTDDEV
.
          DIV       "10",CCFACTOR
          COMPARE   ".01",CCFACTOR
          GOTO      CALSD100 IF NOT EQUAL
CALSD999  RETURN
.----------------------------------------------------------------------
. Enter Casemix Extract ID
.----------------------------------------------------------------------
EEID0000  MOVE      ZERO,CKEYTYP
          CALL      CCSCOPCL         * Close Files
          CALL      KCCEAA00
          BRANCH    EXIT,EEID9999,EEID9999
          CALL      GETCME00
          CALL      CCSCOPOP         * Open Files
EEID9999  RETURN
.======================================================================
. Determine Display Values for a Valid Casemix Extract Code
.======================================================================
GETCME00  MATCH     SP70,CCEAFDD
          IF        @EQUAL
            MOVE      "Start     ",FROMDD
          ELSE
            UNPACK    CCEAFDD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,FROMDD
          ENDIF
.
          MATCH     "99999999",CCEATDD
          IF        @EQUAL
            MOVE      "Finish    ",TODD
          ELSE
            UNPACK    CCEATDD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,TODD
          ENDIF
.
          MATCH     SP70,CCEAFAD
          IF        @EQUAL
            MOVE      "Start     ",FROMAD
          ELSE
            UNPACK    CCEAFAD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,FROMAD
          ENDIF
.
          MATCH     "99999999",CCEATAD
          IF        @EQUAL
            MOVE      "Finish    ",TOAD
          ELSE
            UNPACK    CCEATAD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,TOAD
          ENDIF
.
          MOVE     CCEAVIS,F1
          BRANCH   F1,GETCME10,GETCME20,GETCME30
          MOVE     "All        ",VISITDES
          GOTO     GETCME40
GETCME10  MOVE     "A & E      ",VISITDES
          GOTO     GETCME40
GETCME20  MOVE     "Outpatients ",VISITDES
          GOTO     GETCME40
GETCME30  MOVE     "Inpatients",VISITDES
          GOTO     GETCME40
.
GETCME40  MOVE     SP70,CLV1DES
          MOVE     SP70,CLV2DES
          MOVE     SP70,CLV3DES
.
          MATCH    SP70,CCEALV2
          IF       !@EQUAL
            MOVE     CCEALV2,KEY3
            CALL     RDCCST1
            MOVE     CCSTDES,CLV2DES
          ENDIF
.
          MATCH    SP70,CCEALV3
          IF       !@EQUAL
            MOVE     CCEALV3,KEY3
            CALL     RDCCST1
            MOVE     CCSTDES,CLV3DES
          ENDIF
.
          MOVE     CCEALV1,KEY3
          CALL     RDCCST1
          MOVE     CCSTDES,CLV1DES
.
          MOVE     CCEAHCD,KEY2
          CALL     RDCCHC1
.
          MOVE       CCEADAY,F1
          IF         F1=0
            MOVE       "Exclude Day Cases",DAYCDESC
          ELSE
            IF         F1=2
              MOVE       "Day Cases Only",DAYCDESC
            ELSE
              MOVE       "Include Day Cases",DAYCDESC
            ENDIF
          ENDIF
.
          MOVE       "    Income",INCODESC
          MOVE       "      Cost",COSTDESC
          MATCH      SP70,CCEAIMOD
          IF         !@EQUAL
            MOVE       "   Model ",KEY9
            PACK       INCODESC,KEY9,CCEAIMOD
          ENDIF
          MATCH      SP70,CCEACMOD
          IF         !@EQUAL
            MOVE       "   Model ",KEY9
            PACK       COSTDESC,KEY9,CCEACMOD
          ENDIF
.
          MOVE      "   64",AUDTSECT
          READ      CONTROLF,AUDTSECT;*177,CCCOSOPR:
                                      *183,CCCOTH1,CCCOTH2,CCCOTH3,CCCOTH4:
                                           CCCOTF1,CCCOTF2,CCCOTF3,CCCOTF4:
                                           CCCOTT1,CCCOTT2,CCCOTT3,CCCOTT4
          MATCH      SP70,CCEAITHE
          IF         !@EQUAL
            MOVE       CCEAITHE,F1
            LOAD       INCODESC,F1,CCCOTH1,CCCOTH2,CCCOTH3,CCCOTH4
          ENDIF
          MATCH      SP70,CCEACTHE
          IF         !@EQUAL
            MOVE       CCEACTHE,F1
            LOAD       COSTDESC,F1,CCCOTH1,CCCOTH2,CCCOTH3,CCCOTH4
          ENDIF
.
          RETURN
.--------------------------------------------------------------------
. Graph Level 1 Casemix Analysis
.--------------------------------------------------------------------
GPH1LV00  MOVE     ONE,GRAPHLEV
.
          MOVE     ZERO,ACCEPT
          CALL     SCGOL000
.
          RETURN
SEL1LV00  CALL     RDCCEB1
          BRANCH   OVRCD,SEL1LV99
          MOVE     ONE,CASTDDEV
          CALL     LV1DET00
          MOVE     ZERO,CASTDDEV
.
          CALL     SC01L000
.
SEL1LV99  RETURN
.---------------------------------------------------------------------------
. Enter Casemix Code Level 1
.-------------------------------------------------------------------------------
SELCM000  TOPIC     "CCXHKEY "
          DISPLAY   *P1:24,*EL,"Enter Code : "
          MOVE      "14",CCOL
          MOVE      "24",CVERT
.
          MOVE      CCEALV1,CCXHSTY
          MOVE      CCEALV1,KEY3
          CALL      RDCCST1
          SFORMAT   VAR,CCSTLEN
          MATCH     "1",CCSTJR
          IF        @EQUAL
            KEYIN     *PCCOL:CVERT,*V2LON,*JR,VAR
          ELSE
            KEYIN     *PCCOL:CVERT,*V2LON,VAR
          ENDIF
.
          MATCH     "1",CCSTZF
          IF        @EQUAL
            REP       " 0",VAR
          ENDIF
.
          DISPLAY     *PCCOL:CVERT,*V2LON,VAR
.
          ENDSET    VAR
          APPEND    SP70,VAR
          RESET     VAR
.
          MATCH     SP70,VAR
          GOTO      SELCM090 IF EQUAL
.
          MATCH     "1",CCSTJR
          IF        @EQUAL
            ENDSET    VAR
          ENDIF
          CMATCH    EXITCHAR,VAR
          GOTO      SELCM095 IF EQUAL
.
          CMATCH    QUEST,VAR
          GOTO      SELCM010 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCXHA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCXHKEY
          APPEND    SP70,CCXHKEY
          RESET     CCXHKEY
.
          MATCH     SP70,CCXHKEY
          GOTO      SELCM000 IF EQUAL
          MOVE      CCXHKEY,VAR
.
          DISPLAY   *PCCOL:CVERT,*V2LON,VAR
SELCM010
          RESET     VAR
          MATCH     "1",CCSTDE
          IF        @EQUAL
            TYPE      VAR
            GOTO      SELCM015 IF EQUAL
            BEEP
            GOTO      SELCM000
          ENDIF
SELCM015
          MOVE      VAR,CCXHKEY
          MOVE      VAR,CCEBLV1
          PACK      KEY13,CCXHSTY,VAR
          CALL      RACCXH1
          BRANCH    OVRCD,SELCM080
          CALL      RDCCXH1
          MOVE      ZERO,EXIT
          CALL      LV1DET00   * Calculate Details
          CALL      SEL1LV00   * Calculate Details
.
          GOTO      SELCM099
.
SELCM080  MOVE      ZERO,EXIT
          MOVE      "Code Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      SELCM000
.
SELCM085  MOVE      SP70,CCXHKEY
          MOVE      ZERO,EXIT
          GOTO      SELCM099
.
SELCM090  MOVE      SP70,CCXHKEY
          MOVE      ONE,EXIT
          GOTO      SELCM099
.
SELCM095  MOVE      TWO,EXIT
.
SELCM099  SFORMAT   VAR,127
          TOPIC     PRGID
          RETURN
.---------------------------------------------------------------------------
. Display Level 2
.-------------------------------------------------------------------------------
LEVEL200  MATCH     SP70,CCEALV2
          IF        @EQUAL
            BEEP
            MOVE      "No More Levels in this Extract - ",DISPMSG
            CALL      MESSAGE1
            GOTO      LEVEL299
          ENDIF
.
          MOVE      CCEALV2,KEY3
          CALL      RDCCST1
.
          CALL      SC02L000
.
          MOVE      CCEALV1,KEY3
          CALL      RDCCST1
.
          CALL      LV1DET00
.
LEVEL299  RETURN
.---------------------------------------------------------------------------
. Enter Casemix Code Level 1
.-------------------------------------------------------------------------------
KY01LV00  TOPIC     "CCXHKEY "
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          MOVE      CCEALV1,CCXHSTY
          MOVE      CCEALV1,KEY3
          CALL      RDCCST1
          SFORMAT   VAR,CCSTLEN
          MATCH     "1",CCSTJR
          IF        @EQUAL
            KEYIN     *PCCOL:CVERT,*V2LON,*JR,VAR
          ELSE
            KEYIN     *PCCOL:CVERT,*V2LON,VAR
          ENDIF
.
          MATCH     "1",CCSTZF
          IF        @EQUAL
            REP       " 0",VAR
          ENDIF
.
          DISPLAY     *PCCOL:CVERT,*V2LON,VAR
.
          ENDSET    VAR
          APPEND    SP70,VAR
          RESET     VAR
.
          MATCH     SP70,VAR
          GOTO      KY01LV90 IF EQUAL
.
          MATCH     "1",CCSTJR
          IF        @EQUAL
            ENDSET    VAR
          ENDIF
          CMATCH    EXITCHAR,VAR
          GOTO      KY01LV95 IF EQUAL
.
          CMATCH    QUEST,VAR
          GOTO      KY01LV10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCXHA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCXHKEY
          APPEND    SP70,CCXHKEY
          RESET     CCXHKEY
.
          MATCH     SP70,CCXHKEY
          GOTO      KY01LV00 IF EQUAL
          MOVE      CCXHKEY,VAR
.
          DISPLAY   *PCCOL:CVERT,*V2LON,VAR
KY01LV10
          RESET     VAR
          MATCH     "1",CCSTDE
          IF        @EQUAL
            TYPE      VAR
            GOTO      KY01LV15 IF EQUAL
            BEEP
            GOTO      KY01LV00
          ENDIF
KY01LV15
          MOVE      VAR,CCXHKEY
          MOVE      VAR,CCEBLV1
          PACK      KEY13,CCXHSTY,VAR
          CALL      RACCXH1
          BRANCH    OVRCD,KY01LV80
          CALL      RDCCXH1
          MOVE      ZERO,EXIT
          CALL      LV1DET00   * Calculate Details
          GOTO      KY01LV99
.
KY01LV80  MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KY01LV99,KY01LV99
          MOVE      "Code Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KY01LV00
.
KY01LV85  MOVE      SP70,CCXHKEY
          MOVE      ZERO,EXIT
          GOTO      KY01LV99
.
KY01LV90  MOVE      SP70,CCXHKEY
          MOVE      ONE,EXIT
          GOTO      KY01LV99
.
KY01LV95  MOVE      TWO,EXIT
.
KY01LV99  SFORMAT   VAR,127
          TOPIC     PRGID
          RETURN
.----------------------------------------------------------------------
. Calculate Values for Histogram
.----------------------------------
. GPHISVAL FORM  5[15]   Histogram Values 1 to 15
. GPHISOVR FORM  5       Histogram Value > 15
. GPHISUND FORM  5       Histogram Value < 1
. GPHISRHD DIM   12      Range Heading
. GPHISCHD DIM   12      Count Heading
. GPHISHED DIM   50      General Heading
. GPHISTOT FORM  5       Total
. GPHISMIN FORM  10      Minimum   Eg Start at 1000
. GPHISRAN FORM  10      Range     Increment by 1000
. GPHISMAX FORM  5       Maximum
. GPHISSCL FORM  5       Scale
. GPHISCNT FORM  2       Scale
.----------------------------------------------------------------------
H1DP0000  ASSIGN    CCEBLMN,GPHISMIN
          IF        GPHISMIN=0
            MOVE      "1",GPHISMIN
          ENDIF
          MOVE      "1",HISTTYPE
          MOVE      "1",GPHISRAN
H1DP0100  IF        HISTTYPE=1
            MOVE      "L.O.S.",GPHISRHD
          ELSE
            MOVE      "Income",GPHISRHD
          ENDIF
          MOVE      "Episodes",GPHISCHD
          SFORMAT   VAR,CCSTLEN
          MOVE      CCXHKEY,VAR
          PACK      GPHISHED,VAR,SP1,CCXHDES
          SFORMAT   VAR,127
.
          MOVE      ZERO,GPHISCNT
          REPEAT
            ADD       ONE,GPHISCNT
            MOVE      ZERO,GPHISVAL[GPHISCNT]
          UNTIL     (GPHISCNT=15)
          MOVE      ZERO,GPHISOVR
          MOVE      ZERO,GPHISUND
.
          PACK      KEY48,CCEBLV1,SP70
          CALL      RSCCEC2
H1DP1000  CALL      RKCCEC2
          BRANCH    OVRCD,H1DP9000
          MATCH     CCEBLV1,CCECLV1
          GOTO      H1DP9000 IF NOT EQUAL
.
          LOAD      F12P2,HISTTYPE,CCECLOS,CCECFTC,CCECTTC
          ASSIGN    (F12P2-GPHISMIN)/GPHISRAN,F12P2
          MOVE      F12P2,GPHISCNT
          ADD       ONE,GPHISCNT
          IF        GPHISCNT<1
            ADD       ONE,GPHISUND
            GOTO      H1DP1000
          ENDIF
          IF        GPHISCNT>15
            ADD       ONE,GPHISOVR
            GOTO      H1DP1000
          ENDIF
.
          ADD       ONE,GPHISVAL[GPHISCNT]
          GOTO      H1DP1000
.
H1DP9000  CALL      GPHISDIS
          KEYIN     *P1:24,*EL,*V2LON,"S",*HOFF,"cale, ":
                               *V2LON,"T",*HOFF,"ype, e":
                               *V2LON,"X",*HOFF,"it : ",ANS
          ENDSET    ANS
          APPEND    SP70,ANS
          RESET     ANS
          REP       UPPLOW,ANS
          MATCH     ANST,ANS
          GOTO      H1DP9100 IF EQUAL
          MATCH     ANSS,ANS
          GOTO      H1DP9200 IF EQUAL
          MATCH     ANSX,ANS
          GOTO      H1DP9999 IF EQUAL
          BEEP
          GOTO      H1DP9000
.
H1DP9100  KEYIN     *P1:24,*EL,"Type :  ":
                    *V2LON,"1.",*HOFF," Length of Stay, ":
                    *V2LON,"2.",*HOFF," Income.  Enter Type : ",*V2LON,HISTTYPE
          BRANCH    HISTTYPE,H1DP9200,H1DP9200
          BEEP
          GOTO      H1DP9100
.
H1DP9200  KEYIN     *P1:24,*EL,"Minimum Value : ",*V2LON,GPHISMIN,*HOFF:
                               "    Step : ",*V2LON,GPHISRAN,*HOFF:
                               "  Ok (",*V2LON,"Y",*HOFF,"/":
                                        *V2LON,"N",*HOFF,") ? ",*V2LON,ANS
          REP       UPPLOW,ANS
          MATCH     ANSY,ANS
          GOTO      H1DP0100 IF EQUAL
          GOTO      H1DP9200
.
H1DP9999  RETURN
.
.------------------------------------------------------------
. This will restart a program from any point with out the
. need to clear variables and stacks.
.------------------------------------------------------------
RESTARTP  CHAIN    PRGID
.
.--------------------------------------------------
. Get Details for Level 1
.--------------------------------------------------
LV2DET00
          PACK      KEY13,CCEALV2,CCEDLV2
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      SP70,CCXHDES
            MATCH     Z70,CCEDLV2
            IF        @EQUAL
              MOVE      "Other",CCXHDES
            ENDIF
          ENDIF
          SFORMAT   VAR,CCSTLEN
          MOVE      CCEDLV2,VAR
          PACK      LEV2DESC,VAR,SP1,CCXHDES
          SFORMAT   VAR,127
.
          MOVE      CCEDFSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,FRCSDEV
          ASSIGN    CCEDFTC/CCEDNEP,FRCXBAR
          ASSIGN    CCEDFMX-CCEDFMN,FRCRANG
.
          MOVE      CCEDTSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,TOCSDEV
          ASSIGN    CCEDTTC/CCEDNEP,TOCXBAR
          ASSIGN    CCEDTMX-CCEDTMN,TOCRANG
.
          MOVE      CCEDLSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,LOSSDEV
          ASSIGN    CCEDLTO/CCEDNEP,LOSXBAR
          ASSIGN    CCEDLMX-CCEDLMN,LOSRANG
          GOTO      LV2DET99
.
LV2DET99  RETURN
SEL2LV00  CALL     RDCCED1
          BRANCH   OVRCD,SEL2LV99
          MOVE     ONE,CASTDDEV * Calc Standard Deviation on Selection
          CALL     LV2DET00
          MOVE     ZERO,CASTDDEV
.
          CALL     SC03L000
.
SEL2LV99  RETURN
.--------------------------------------------------------------------
. Graph Level 2 Casemix Analysis
.--------------------------------------------------------------------
GPH2LV00  MOVE     TWO,GRAPHLEV
.
          MOVE     ZERO,ACCEPT
          CALL     SCGOL000
.
          RETURN
.---------------------------------------------------------------------------
. Display Level 3
.-------------------------------------------------------------------------------
LEVEL300  MATCH     SP70,CCEALV3
          IF        @EQUAL
            BEEP
            MOVE      "No More Levels in this Extract - ",DISPMSG
            CALL      MESSAGE1
            GOTO      LEVEL399
          ENDIF
.
          MOVE      CCEALV3,KEY3
          CALL      RDCCST1
.
          CALL      SC04L000
.
          MOVE      CCEALV2,KEY3
          CALL      RDCCST1
.
          CALL      LV2DET00
.
LEVEL399  RETURN
.
.---------------------------------------------------------------------------
. Enter Casemix Code Level 1
.-------------------------------------------------------------------------------
KY02LV00  TOPIC     "CCXHKEY "
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          MOVE      CCEALV2,CCXHSTY
          MOVE      CCEALV2,KEY3
          CALL      RDCCST1
          SFORMAT   VAR,CCSTLEN
          MATCH     "1",CCSTJR
          IF        @EQUAL
            KEYIN     *PCCOL:CVERT,*V2LON,*JR,VAR
          ELSE
            KEYIN     *PCCOL:CVERT,*V2LON,VAR
          ENDIF
.
          MATCH     "1",CCSTZF
          IF        @EQUAL
            REP       " 0",VAR
          ENDIF
.
          DISPLAY     *PCCOL:CVERT,*V2LON,VAR
.
          ENDSET    VAR
          APPEND    SP70,VAR
          RESET     VAR
.
          MATCH     SP70,VAR
          GOTO      KY02LV90 IF EQUAL
.
          MATCH     "1",CCSTJR
          IF        @EQUAL
            ENDSET    VAR
          ENDIF
          CMATCH    EXITCHAR,VAR
          GOTO      KY02LV95 IF EQUAL
.
          CMATCH    QUEST,VAR
          GOTO      KY02LV10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCXHA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCXHKEY
          APPEND    SP70,CCXHKEY
          RESET     CCXHKEY
.
          MATCH     SP70,CCXHKEY
          GOTO      KY02LV00 IF EQUAL
          MOVE      CCXHKEY,VAR
.
          DISPLAY   *PCCOL:CVERT,*V2LON,VAR
KY02LV10
          RESET     VAR
          MATCH     "1",CCSTDE
          IF        @EQUAL
            TYPE      VAR
            GOTO      KY02LV15 IF EQUAL
            BEEP
            GOTO      KY02LV00
          ENDIF
KY02LV15
          MOVE      VAR,CCXHKEY
          PACK      KEY13,CCXHSTY,VAR
          CALL      RACCXH1
          BRANCH    OVRCD,KY02LV80
          CALL      RDCCXH1
          MOVE      ZERO,EXIT
          PACK      KEY20,CCEBLV1,CCXHKEY
          CALL      RDCCED1
          IF        OVRCD=1
            MOVE      ZERO,CCEDFTC
            MOVE      ZERO,CCEDFMN
            MOVE      ZERO,CCEDFMX
            MOVE      ZERO,CCEDFSV
            MOVE      ZERO,CCEDTTC
            MOVE      ZERO,CCEDTMN
            MOVE      ZERO,CCEDTMX
            MOVE      ZERO,CCEDTSV
            MOVE      ZERO,CCEDLTO
            MOVE      ZERO,CCEDLMN
            MOVE      ZERO,CCEDLMX
            MOVE      ZERO,CCEDLSV
          ENDIF
          CALL      LV2DET00   * Calculate Details
          GOTO      KY02LV99
.
KY02LV80  MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KY02LV99,KY02LV99
          MOVE      "Code Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KY02LV00
.
KY02LV85  MOVE      SP70,CCXHKEY
          MOVE      ZERO,EXIT
          GOTO      KY02LV99
.
KY02LV90  MOVE      SP70,CCXHKEY
          MOVE      SP70,SAVEID
          MOVE      ONE,EXIT
          GOTO      KY02LV99
.
KY02LV95  MOVE      TWO,EXIT
.
KY02LV99  SFORMAT   VAR,127
          TOPIC     PRGID
          RETURN
.----------------------------------------------------------------------
. Calculate Values for Histogram
.----------------------------------
. GPHISVAL FORM  5[15]   Histogram Values 1 to 15
. GPHISOVR FORM  5       Histogram Value > 15
. GPHISUND FORM  5       Histogram Value < 1
. GPHISRHD DIM   12      Range Heading
. GPHISCHD DIM   12      Count Heading
. GPHISHED DIM   50      General Heading
. GPHISTOT FORM  5       Total
. GPHISMIN FORM  10      Minimum   Eg Start at 1000
. GPHISRAN FORM  10      Range     Increment by 1000
. GPHISMAX FORM  5       Maximum
. GPHISSCL FORM  5       Scale
. GPHISCNT FORM  2       Scale
.----------------------------------------------------------------------
H2DP0000  ASSIGN    CCEBLMN,GPHISMIN
          IF        GPHISMIN=0
            MOVE      "1",GPHISMIN
          ENDIF
          MOVE      "1",HISTTYPE
          MOVE      "1",GPHISRAN
H2DP0100  IF        HISTTYPE=1
            MOVE      "L.O.S.",GPHISRHD
          ELSE
            MOVE      "Income",GPHISRHD
          ENDIF
          MOVE      "Episodes",GPHISCHD
          SFORMAT   VAR,CCSTLEN
          MOVE      CCXHKEY,VAR
          PACK      GPHISHED,VAR,SP1,CCXHDES
          SFORMAT   VAR,127
.
          MOVE      ZERO,GPHISCNT
          REPEAT
            ADD       ONE,GPHISCNT
            MOVE      ZERO,GPHISVAL[GPHISCNT]
          UNTIL     (GPHISCNT=15)
          MOVE      ZERO,GPHISOVR
          MOVE      ZERO,GPHISUND
.
          PACK      KEY48,CCEDLV1,CCEDLV2,SP70
          CALL      RSCCEC2
H2DP1000  CALL      RKCCEC2
          BRANCH    OVRCD,H2DP9000
          MATCH     CCEDLV1,CCECLV1
          GOTO      H2DP9000 IF NOT EQUAL
          MATCH     CCEDLV2,CCECLV2
          GOTO      H2DP9000 IF NOT EQUAL
.
          LOAD      F12P2,HISTTYPE,CCECLOS,CCECFTC,CCECTTC
          ASSIGN    (F12P2-GPHISMIN)/GPHISRAN,F12P2
          MOVE      F12P2,GPHISCNT
          ADD       ONE,GPHISCNT
          IF        GPHISCNT<1
            ADD       ONE,GPHISUND
            GOTO      H2DP1000
          ENDIF
          IF        GPHISCNT>15
            ADD       ONE,GPHISOVR
            GOTO      H2DP1000
          ENDIF
.
          ADD       ONE,GPHISVAL[GPHISCNT]
          GOTO      H2DP1000
.
H2DP9000  CALL      GPHISDIS
          KEYIN     *P1:24,*EL,*V2LON,"S",*HOFF,"cale, ":
                               *V2LON,"T",*HOFF,"ype, e":
                               *V2LON,"X",*HOFF,"it : ",ANS
          ENDSET    ANS
          APPEND    SP70,ANS
          RESET     ANS
          REP       UPPLOW,ANS
          MATCH     ANST,ANS
          GOTO      H2DP9100 IF EQUAL
          MATCH     ANSS,ANS
          GOTO      H2DP9200 IF EQUAL
          MATCH     ANSX,ANS
          GOTO      H2DP9999 IF EQUAL
          BEEP
          GOTO      H2DP9000
.
H2DP9100  KEYIN     *P1:24,*EL,"Type :  ":
                    *V2LON,"1.",*HOFF," Length of Stay, ":
                    *V2LON,"3.",*HOFF," Income.  Enter Type : ",*V2LON,HISTTYPE
          BRANCH    HISTTYPE,H2DP9200,H2DP9200
          BEEP
          GOTO      H2DP9100
.
H2DP9200  KEYIN     *P1:24,*EL,"Minimum Value : ",*V2LON,GPHISMIN,*HOFF:
                               "    Step : ",*V2LON,GPHISRAN,*HOFF:
                               "  Ok (",*V2LON,"Y",*HOFF,"/":
                                        *V2LON,"N",*HOFF,") ? ",*V2LON,ANS
          REP       UPPLOW,ANS
          MATCH     ANSY,ANS
          GOTO      H2DP0100 IF EQUAL
          GOTO      H2DP9200
.
H2DP9999  RETURN
.
.--------------------------------------------------
. Get Details for Level 3
.--------------------------------------------------
LV3DET00  PACK      KEY13,CCEALV3,CCEELV3
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      SP70,CCXHDES
            MATCH     Z70,CCEELV3
            IF        @EQUAL
              MOVE      "Other",CCXHDES
            ENDIF
          ENDIF
          SFORMAT   VAR,CCSTLEN
          MOVE      CCEELV3,VAR
          PACK      LEV3DESC,VAR,SP1,CCXHDES
          SFORMAT   VAR,127
.
          MOVE      CCEEFSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,FRCSDEV
          ASSIGN    CCEEFTC/CCEENEP,FRCXBAR
          ASSIGN    CCEEFMX-CCEEFMN,FRCRANG
.
          MOVE      CCEETSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,TOCSDEV
          ASSIGN    CCEETTC/CCEENEP,TOCXBAR
          ASSIGN    CCEETMX-CCEETMN,TOCRANG
.
          MOVE      CCEELSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,LOSSDEV
          ASSIGN    CCEELTO/CCEENEP,LOSXBAR
          ASSIGN    CCEELMX-CCEELMN,LOSRANG
          GOTO      LV3DET99
.
LV3DET99  RETURN
SEL3LV00  CALL     RDCCEE1
          BRANCH   OVRCD,SEL2LV99
          MOVE     ONE,CASTDDEV
          CALL     LV3DET00
          MOVE     ZERO,CASTDDEV
.
          CALL     SC05L000
.
SEL3LV99  RETURN
.--------------------------------------------------------------------
. Graph Level 3 Casemix Analysis
.--------------------------------------------------------------------
GPH3LV00  MOVE     THREE,GRAPHLEV
.
          MOVE     ZERO,ACCEPT
          CALL     SCGOL000
.
          RETURN
.---------------------------------------------------------------------------
. Enter Casemix Code Level 3
.-------------------------------------------------------------------------------
KY03LV00  TOPIC     "CCXHKEY "
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          MOVE      CCEALV3,CCXHSTY
          MOVE      CCEALV3,KEY3
          CALL      RDCCST1
          SFORMAT   VAR,CCSTLEN
          MATCH     "1",CCSTJR
          IF        @EQUAL
            KEYIN     *PCCOL:CVERT,*V2LON,*JR,VAR
          ELSE
            KEYIN     *PCCOL:CVERT,*V2LON,VAR
          ENDIF
.
          MATCH     "1",CCSTZF
          IF        @EQUAL
            REP       " 0",VAR
          ENDIF
.
          DISPLAY     *PCCOL:CVERT,*V2LON,VAR
.
          ENDSET    VAR
          APPEND    SP70,VAR
          RESET     VAR
.
          MATCH     SP70,VAR
          GOTO      KY03LV90 IF EQUAL
.
          MATCH     "1",CCSTJR
          IF        @EQUAL
            ENDSET    VAR
          ENDIF
          CMATCH    EXITCHAR,VAR
          GOTO      KY03LV95 IF EQUAL
.
          CMATCH    QUEST,VAR
          GOTO      KY03LV10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCXHA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCXHKEY
          APPEND    SP70,CCXHKEY
          RESET     CCXHKEY
.
          MATCH     SP70,CCXHKEY
          GOTO      KY03LV00 IF EQUAL
          MOVE      CCXHKEY,VAR
.
          DISPLAY   *PCCOL:CVERT,*V2LON,VAR
KY03LV10
          RESET     VAR
          MATCH     "1",CCSTDE
          IF        @EQUAL
            TYPE      VAR
            GOTO      KY03LV15 IF EQUAL
            BEEP
            GOTO      KY03LV00
          ENDIF
KY03LV15
          MOVE      VAR,CCXHKEY
          PACK      KEY13,CCXHSTY,VAR
          CALL      RACCXH1
          BRANCH    OVRCD,KY03LV80
          CALL      RDCCXH1
          MOVE      ZERO,EXIT
          PACK      KEY30,CCEBLV1,CCEDLV2,CCXHKEY
          CALL      RDCCEE1
          IF        OVRCD=1
            MOVE      ZERO,CCEEFTC
            MOVE      ZERO,CCEEFMN
            MOVE      ZERO,CCEEFMX
            MOVE      ZERO,CCEEFSV
            MOVE      ZERO,CCEETTC
            MOVE      ZERO,CCEETMN
            MOVE      ZERO,CCEETMX
            MOVE      ZERO,CCEETSV
            MOVE      ZERO,CCEELTO
            MOVE      ZERO,CCEELMN
            MOVE      ZERO,CCEELMX
            MOVE      ZERO,CCEELSV
          ENDIF
          CALL      LV3DET00   * Calculate Details
          GOTO      KY03LV99
.
KY03LV80  MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KY03LV99,KY03LV99
          MOVE      "Code Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KY03LV00
.
KY03LV85  MOVE      SP70,CCXHKEY
          MOVE      ZERO,EXIT
          GOTO      KY03LV99
.
KY03LV90  MOVE      SP70,CCXHKEY
          MOVE      SP70,SAVEID
          MOVE      ONE,EXIT
          GOTO      KY03LV99
.
KY03LV95  MOVE      TWO,EXIT
.
KY03LV99  SFORMAT   VAR,127
          TOPIC     PRGID
          RETURN
.----------------------------------------------------------------------
. Calculate Values for Histogram
.----------------------------------
. GPHISVAL FORM  5[15]   Histogram Values 1 to 15
. GPHISOVR FORM  5       Histogram Value > 15
. GPHISUND FORM  5       Histogram Value < 1
. GPHISRHD DIM   12      Range Heading
. GPHISCHD DIM   12      Count Heading
. GPHISHED DIM   50      General Heading
. GPHISTOT FORM  5       Total
. GPHISMIN FORM  10      Minimum   Eg Start at 1000
. GPHISRAN FORM  10      Range     Increment by 1000
. GPHISMAX FORM  5       Maximum
. GPHISSCL FORM  5       Scale
. GPHISCNT FORM  2       Scale
.----------------------------------------------------------------------
H3DP0000  ASSIGN    CCEBLMN,GPHISMIN
          IF        GPHISMIN=0
            MOVE      "1",GPHISMIN
          ENDIF
          MOVE      "1",HISTTYPE
          MOVE      "1",GPHISRAN
H3DP0100  IF        HISTTYPE=1
            MOVE      "L.O.S.",GPHISRHD
          ELSE
            MOVE      "Income",GPHISRHD
          ENDIF
          MOVE      "Episodes",GPHISCHD
          SFORMAT   VAR,CCSTLEN
          MOVE      CCXHKEY,VAR
          PACK      GPHISHED,VAR,SP1,CCXHDES
          SFORMAT   VAR,127
.
          MOVE      ZERO,GPHISCNT
          REPEAT
            ADD       ONE,GPHISCNT
            MOVE      ZERO,GPHISVAL[GPHISCNT]
          UNTIL     (GPHISCNT=15)
          MOVE      ZERO,GPHISOVR
          MOVE      ZERO,GPHISUND
.
          PACK      KEY48,CCEELV1,CCEELV2,CCEELV3,SP70
          CALL      RSCCEC2
H3DP1000  CALL      RKCCEC2
          BRANCH    OVRCD,H3DP9000
          MATCH     CCEELV1,CCECLV1
          GOTO      H3DP9000 IF NOT EQUAL
          MATCH     CCEELV2,CCECLV2
          GOTO      H3DP9000 IF NOT EQUAL
          MATCH     CCEELV3,CCECLV3
          GOTO      H3DP9000 IF NOT EQUAL
.
          LOAD      F12P2,HISTTYPE,CCECLOS,CCECFTC,CCECTTC
          ASSIGN    (F12P2-GPHISMIN)/GPHISRAN,F12P2
          MOVE      F12P2,GPHISCNT
          ADD       ONE,GPHISCNT
          IF        GPHISCNT<1
            ADD       ONE,GPHISUND
            GOTO      H3DP1000
          ENDIF
          IF        GPHISCNT>15
            ADD       ONE,GPHISOVR
            GOTO      H3DP1000
          ENDIF
.
          ADD       ONE,GPHISVAL[GPHISCNT]
          GOTO      H3DP1000
.
H3DP9000  CALL      GPHISDIS
          KEYIN     *P1:24,*EL,*V2LON,"S",*HOFF,"cale, ":
                               *V2LON,"T",*HOFF,"ype, e":
                               *V2LON,"X",*HOFF,"it : ",ANS
          ENDSET    ANS
          APPEND    SP70,ANS
          RESET     ANS
          REP       UPPLOW,ANS
          MATCH     ANST,ANS
          GOTO      H3DP9100 IF EQUAL
          MATCH     ANSS,ANS
          GOTO      H3DP9200 IF EQUAL
          MATCH     ANSX,ANS
          GOTO      H3DP9999 IF EQUAL
          BEEP
          GOTO      H3DP9000
.
H3DP9100  KEYIN     *P1:24,*EL,"Type :  ":
                    *V2LON,"1.",*HOFF," Length of Stay, ":
                    *V2LON,"2.",*HOFF," Income.  Enter Type : ",*V2LON,HISTTYPE
          BRANCH    HISTTYPE,H3DP9200,H3DP9200
          BEEP
          GOTO      H3DP9100
.
H3DP9200  KEYIN     *P1:24,*EL,"Minimum Value : ",*V2LON,GPHISMIN,*HOFF:
                               "    Step : ",*V2LON,GPHISRAN,*HOFF:
                               "  Ok (",*V2LON,"Y",*HOFF,"/":
                                        *V2LON,"N",*HOFF,") ? ",*V2LON,ANS
          REP       UPPLOW,ANS
          MATCH     ANSY,ANS
          GOTO      H3DP0100 IF EQUAL
          GOTO      H3DP9200
.
H3DP9999  RETURN
.
GETEPS00  PACK     KEY18,CCECHCD,CCECEPS
          CALL     RDCCEP1
          PACK     KEY18,CCECHCD,CCECEPS
          CALL     RDCCIA1
          IF       OVRCD=1
            CALL     CLRIAD00
          ENDIF
          MOVE     ZERO,BDTOTF
          IF       CCECFTC>0
            ASSIGN   CCECFTC/CCECLOS,BDTOTF
          ENDIF
          MOVE     ZERO,BDTOTT
          IF       CCECTTC>0
            ASSIGN   CCECTTC/CCECLOS,BDTOTT
          ENDIF
          RETURN
.
CLRIAD00  MOVE      ZERO,CCIABA1
          MOVE      ZERO,CCIABA2
          MOVE      ZERO,CCIABA3
          MOVE      ZERO,CCIALOS
          MOVE      ZERO,CCIAITH
          MOVE      ZERO,CCIAIA1
          MOVE      ZERO,CCIAIA2
          MOVE      ZERO,CCIAIA3
          MOVE      ZERO,CCIAIAO
          MOVE      ZERO,CCIAIM1
          MOVE      ZERO,CCIAIM2
          MOVE      ZERO,CCIAIM3
          MOVE      ZERO,CCIAIMO
          MOVE      ZERO,CCIAETH1
          MOVE      ZERO,CCIAETH2
          MOVE      ZERO,CCIAETH3
          MOVE      ZERO,CCIAETH4
          MOVE      ZERO,CCIAETH5
          MOVE      ZERO,CCIAEA11
          MOVE      ZERO,CCIAEA12
          MOVE      ZERO,CCIAEA13
          MOVE      ZERO,CCIAEA14
          MOVE      ZERO,CCIAEA15
          MOVE      ZERO,CCIAEA21
          MOVE      ZERO,CCIAEA22
          MOVE      ZERO,CCIAEA23
          MOVE      ZERO,CCIAEA24
          MOVE      ZERO,CCIAEA25
          MOVE      ZERO,CCIAEA31
          MOVE      ZERO,CCIAEA32
          MOVE      ZERO,CCIAEA33
          MOVE      ZERO,CCIAEA34
          MOVE      ZERO,CCIAEA35
          MOVE      ZERO,CCIAEAO1
          MOVE      ZERO,CCIAEAO2
          MOVE      ZERO,CCIAEAO3
          MOVE      ZERO,CCIAEAO4
          MOVE      ZERO,CCIAEAO5
          MOVE      ZERO,CCIAEM11
          MOVE      ZERO,CCIAEM12
          MOVE      ZERO,CCIAEM13
          MOVE      ZERO,CCIAEM14
          MOVE      ZERO,CCIAEM15
          MOVE      ZERO,CCIAEM21
          MOVE      ZERO,CCIAEM22
          MOVE      ZERO,CCIAEM23
          MOVE      ZERO,CCIAEM24
          MOVE      ZERO,CCIAEM25
          MOVE      ZERO,CCIAEM31
          MOVE      ZERO,CCIAEM32
          MOVE      ZERO,CCIAEM33
          MOVE      ZERO,CCIAEM34
          MOVE      ZERO,CCIAEM35
          MOVE      ZERO,CCIAEMO1
          MOVE      ZERO,CCIAEMO2
          MOVE      ZERO,CCIAEMO3
          MOVE      ZERO,CCIAEMO4
          MOVE      ZERO,CCIAEMO5
          RETURN
SELEPS00  CALL     RDCCEC2
          BRANCH   OVRCD,SELEPS99
          PACK     KEY18,CCEAHCD,CCECEPS
          CALL     RDCCEP1
.          BRANCH   OVRCD,SELEPS99
          PACK     KEY18,CCEAHCD,CCECEPS
          CALL     RDCCIA1
          IF       OVRCD=1
            CALL     CLRIAD00
          ENDIF
.
          MOVE     CCXHDES,KEY35
          MOVE     SP70,DESC01
          MOVE     SP70,DESC02
          MOVE     SP70,DESC03
.
          PACK     KEY13,CCEALV1,CCECLV1
          CALL     RDCCXH1
          IF       OVRCD=0
            MOVE     CCXHDES,DESC01
          ENDIF
.
          PACK     KEY13,CCEALV2,CCECLV2
          CALL     RDCCXH1
          IF       OVRCD=0
            MOVE     CCXHDES,DESC02
          ENDIF
.
          PACK     KEY13,CCEALV3,CCECLV3
          CALL     RDCCXH1
          IF       OVRCD=0
            MOVE     CCXHDES,DESC03
          ENDIF
.
          MOVE     KEY35,CCXHDES
.
          MOVE     ZERO,BDTOTF
          IF       CCECFTC>0
            ASSIGN   CCECFTC/CCECLOS,BDTOTF
          ENDIF
.
          MOVE     ZERO,BDTOTT
          IF       CCECTTC>0
            ASSIGN   CCECTTC/CCECLOS,BDTOTT
          ENDIF
.
. Display Episode Details Screen
.
          CALL     SCEDL000
.
SELEPS99  RETURN
.--------------------------------------------------------------------
. Graph Level 1 Casemix Analysis
.--------------------------------------------------------------------
GRAPH000  CALL    OPNGRAPH
.
          MOVE    "10",GPHNOCOX
          MOVE    "30",GPHNOCOY
          MOVE    ZERO,GPHNTYP
          MOVE    ONE,SECTOR
.
          IF      GPHEPS=1
            MOVE    "No. of Episodes",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
.
          IF      GPHLTO=1
            MOVE    "Total LOS",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHLAV=1
            MOVE    "Avg. LOS",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHLMN=1
            MOVE    "Min. LOS",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHLMX=1
            MOVE    "Max. LOS",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
.
          IF      GPHFTO=1
            MOVE    "Total Income",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHFAV=1
            MOVE    "Avg. Income",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHFMN=1
            MOVE    "Min. Income",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHFMX=1
            MOVE    "Max. Income",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
.
          IF      GPHNTYP=GPHNOCOY
            ADD     ONE,GPHNOCOX
            ADD     ONE,GPHNOCOY
          ENDIF
          IF      GPHNTYP>GPHNOCOY
            MOVE    GPHNTYP,GPHNOCOX
            MOVE    GPHNTYP,GPHNOCOY
            ADD     ONE,GPHNOCOX
            ADD     ONE,GPHNOCOY
          ENDIF
.
          MOVE      ZERO,CCPERCNT
          DISPLAY   *P70:2,*BLINKON," Loading "
          BRANCH    GRAPHLEV,GRAPH100,GRAPH200,GRAPH300
.
GRAPH100  CALL     L1GPH000
          CLEAR    GPHNAME
          APPEND   "Casemix Extract Level 1 - ",GPHNAME
          STRIP    CLV1DES
          APPEND   CLV1DES,GPHNAME
          RESET    GPHNAME
          GOTO     GRAPH800
.
GRAPH200  CALL     L2GPH000
          CLEAR    GPHNAME
          APPEND   "Casemix Extract Level 2 - ",GPHNAME
          STRIP    CLV2DES
          APPEND   CLV2DES,GPHNAME
          RESET    GPHNAME
          GOTO     GRAPH800
.
GRAPH300  CALL     L3GPH000
          CLEAR    GPHNAME
          APPEND   "Casemix Extract Level 3 - ",GPHNAME
          STRIP    CLV3DES
          APPEND   CLV3DES,GPHNAME
          RESET    GPHNAME
          GOTO     GRAPH800
.
GRAPH800  MOVE    ZERO,HLEF
          HLINE   *G37,2,70,80
          CALL    GETSCR00
.
          MOVE    ONE,GPHTYPE
          CALL    DISGRAPH
          CALL    CLSGRAPH
.
          CALL    PUTSCR00
.
          RETURN
.
GRAPHWRT  ADD     ONE,F3
          MOVE    F3,SCGPITM
          MOVE     F12P2,SCGPVAL
          PACK    KEY6,SCGPPER,SCGPITM
          CALL    RASCGP1
          IF      OVRCD=0
            CALL    UPSCGP1
          ELSE
            CALL    WRSCGP1
          ENDIF
          RETURN
.--------------------------------------------------------
. Graph Casemix Level 1
.--------------------------------------------------------
L1GPH000  MOVE      ZERO,SECTOR
          PACK      KEY10,SP70
          CALL      RSCCEB1
L1GPH100  CALL      RKCCEB1
          BRANCH    OVRCD,L1GPH200
          ADD       ONE,SECTOR
          COMPARE   "100",SECTOR
          GOTO      L1GPH200 IF EQUAL
.
          PACK      KEY13,CCEALV1,CCEBLV1
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      SP70,CCXHDES
          ENDIF
.
          ADD       ONE,CCPERCNT
          MOVE      CCPERCNT,SCGPPER
          SFORMAT   VAR,CCSTLEN
          MOVE      CCEBLV1,VAR
          PACK      SCGPDES,VAR,SP1,CCXHDES     * mmm yy
          SFORMAT   VAR,127
          MOVE      ONE,F3
.
          IF      GPHEPS=1
            MOVE     CCEBNEP,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHLTO=1
            MOVE     CCEBLTO,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLAV=1
            ASSIGN   CCEBLTO/CCEBNEP,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLMN=1
            MOVE     CCEBLMN,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLMX=1
            MOVE     CCEBLMX,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHFTO=1
            MOVE     CCEBFTC,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFAV=1
            ASSIGN   CCEBFTC/CCEBNEP,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFMN=1
            MOVE     CCEBFMN,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFMX=1
            MOVE     CCEBFMX,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          GOTO    L1GPH100
.
L1GPH200
          RETURN
.--------------------------------------------------------
. Graph Casemix Level 2
.--------------------------------------------------------
L2GPH000  MOVE      ZERO,SECTOR
          PACK      KEY20,CCEBLV1,SP70
          CALL      RSCCED1
L2GPH100  CALL      RKCCED1
          BRANCH    OVRCD,L2GPH200
          MATCH     CCEDLV1,CCEBLV1
          GOTO      L2GPH200 IF NOT EQUAL
          ADD       ONE,SECTOR
          COMPARE   "100",SECTOR
          GOTO      L2GPH200 IF EQUAL
.
          PACK      KEY13,CCEALV2,CCEDLV2
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      SP70,CCXHDES
          ENDIF
.
          ADD       ONE,CCPERCNT
          MOVE      CCPERCNT,SCGPPER
          SFORMAT   VAR,CCSTLEN
          MOVE      CCEDLV2,VAR
          PACK      SCGPDES,VAR,SP1,CCXHDES     * mmm yy
          SFORMAT   VAR,127
          MOVE      ONE,F3
.
          IF      GPHEPS=1
            MOVE     CCEDNEP,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHLTO=1
            MOVE     CCEDLTO,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLAV=1
            ASSIGN   CCEDLTO/CCEDNEP,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLMN=1
            MOVE     CCEDLMN,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLMX=1
            MOVE     CCEDLMX,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHFTO=1
            MOVE     CCEDFTC,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFAV=1
            ASSIGN   CCEDFTC/CCEDNEP,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFMN=1
            MOVE     CCEDFMN,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFMX=1
            MOVE     CCEDFMX,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          GOTO    L2GPH100
.
L2GPH200
          RETURN
.--------------------------------------------------------
. Graph Casemix Level 3
.--------------------------------------------------------
L3GPH000  MOVE      ZERO,SECTOR
          PACK      KEY20,CCEBLV1,SP70
          CALL      RSCCEE1
L3GPH100  CALL      RKCCEE1
          BRANCH    OVRCD,L3GPH200
          MATCH     CCEELV1,CCEBLV1
          GOTO      L3GPH200 IF NOT EQUAL
          MATCH     CCEELV2,CCEDLV2
          GOTO      L3GPH200 IF NOT EQUAL
          ADD       ONE,SECTOR
          COMPARE   "100",SECTOR
          GOTO      L3GPH200 IF EQUAL
.
          PACK      KEY13,CCEALV3,CCEELV3
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      SP70,CCXHDES
          ENDIF
.
          ADD       ONE,CCPERCNT
          MOVE      CCPERCNT,SCGPPER
          SFORMAT   VAR,CCSTLEN
          MOVE      CCEELV3,VAR
          PACK      SCGPDES,VAR,SP1,CCXHDES     * mmm yy
          SFORMAT   VAR,127
          MOVE      ONE,F3
.
          IF      GPHEPS=1
            MOVE     CCEENEP,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHLTO=1
            MOVE     CCEELTO,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLAV=1
            ASSIGN   CCEELTO/CCEENEP,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLMN=1
            MOVE     CCEELMN,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLMX=1
            MOVE     CCEELMX,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHFTO=1
            MOVE     CCEEFTC,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFAV=1
            ASSIGN   CCEEFTC/CCEENEP,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFMN=1
            MOVE     CCEEFMN,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFMX=1
            MOVE     CCEEFMX,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          GOTO    L3GPH100
.
L3GPH200
          RETURN
.
GPHEPS00  IF      GPHEPS=0
            MOVE    ONE,GPHEPS
          ELSE
            MOVE    ZERO,GPHEPS
          ENDIF
          RETURN
.
GPHLTO00  IF      GPHLTO=0
            MOVE    ONE,GPHLTO
          ELSE
            MOVE    ZERO,GPHLTO
          ENDIF
          RETURN
.
GPHLAV00  IF      GPHLAV=0
            MOVE    ONE,GPHLAV
          ELSE
            MOVE    ZERO,GPHLAV
          ENDIF
          RETURN
.
GPHLMX00  IF      GPHLMX=0
            MOVE    ONE,GPHLMX
          ELSE
            MOVE    ZERO,GPHLMX
          ENDIF
          RETURN
.
GPHLMN00  IF      GPHLMN=0
            MOVE    ONE,GPHLMN
          ELSE
            MOVE    ZERO,GPHLMN
          ENDIF
          RETURN
.
GPHFTO00  IF      GPHFTO=0
            MOVE    ONE,GPHFTO
          ELSE
            MOVE    ZERO,GPHFTO
          ENDIF
          RETURN
.
GPHFAV00  IF      GPHFAV=0
            MOVE    ONE,GPHFAV
          ELSE
            MOVE    ZERO,GPHFAV
          ENDIF
          RETURN
.
GPHFMX00  IF      GPHFMX=0
            MOVE    ONE,GPHFMX
          ELSE
            MOVE    ZERO,GPHFMX
          ENDIF
          RETURN
.
GPHFMN00  IF      GPHFMN=0
            MOVE    ONE,GPHFMN
          ELSE
            MOVE    ZERO,GPHFMN
          ENDIF
          RETURN
.
GETIAD00  PACK     KEY18,CCECHCD,CCECEPS
          CALL     RDCCIA1
          IF       OVRCD=1
            CALL     CLRIAD00
          ENDIF
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
.
          ASSIGN   CCIAITH+CCIAIA1+CCIAIA2+CCIAIA3+CCIAIAO,TOTINC
          ASSIGN   TOTINC+CCIAIM1+CCIAIM2+CCIAIM3+CCIAIMO,TOTINC
.
          ASSIGN   CCIAETH1+CCIAEA11+CCIAEA21+CCIAEA31+CCIAEAO1,TOTCST1
          ASSIGN    TOTCST1+CCIAEM11+CCIAEM21+CCIAEM31+CCIAEMO1,TOTCST1
.
          ASSIGN   CCIAETH2+CCIAEA12+CCIAEA22+CCIAEA32+CCIAEAO2,TOTCST2
          ASSIGN    TOTCST2+CCIAEM12+CCIAEM22+CCIAEM32+CCIAEMO2,TOTCST2
.
          ASSIGN   CCIAETH3+CCIAEA13+CCIAEA23+CCIAEA33+CCIAEAO3,TOTCST3
          ASSIGN    TOTCST3+CCIAEM13+CCIAEM23+CCIAEM33+CCIAEMO3,TOTCST3
.
          ASSIGN   CCIAETH4+CCIAEA14+CCIAEA24+CCIAEA34+CCIAEAO4,TOTCST4
          ASSIGN    TOTCST4+CCIAEM14+CCIAEM24+CCIAEM34+CCIAEMO4,TOTCST4
.
          ASSIGN   CCIAETH5+CCIAEA15+CCIAEA25+CCIAEA35+CCIAEAO5,TOTCST5
          ASSIGN    TOTCST5+CCIAEM15+CCIAEM25+CCIAEM35+CCIAEMO5,TOTCST5
.
          ASSIGN    TOTCST1+TOTCST2+TOTCST3+TOTCST4+TOTCST5,TOTCST
.
          ASSIGN   CCIAETH1+CCIAETH2+CCIAETH3+CCIAETH4+CCIAETH5,COSTETH
          ASSIGN   CCIAEA11+CCIAEA12+CCIAEA13+CCIAEA14+CCIAEA15,COSTEA1
          ASSIGN   CCIAEA21+CCIAEA22+CCIAEA23+CCIAEA24+CCIAEA25,COSTEA2
          ASSIGN   CCIAEA31+CCIAEA32+CCIAEA33+CCIAEA34+CCIAEA35,COSTEA3
          ASSIGN   CCIAEAO1+CCIAEAO2+CCIAEAO3+CCIAEAO4+CCIAEAO5,COSTEAO
          ASSIGN   CCIAEM11+CCIAEM12+CCIAEM13+CCIAEM14+CCIAEM15,COSTEM1
          ASSIGN   CCIAEM21+CCIAEM22+CCIAEM23+CCIAEM24+CCIAEM25,COSTEM2
          ASSIGN   CCIAEM31+CCIAEM32+CCIAEM33+CCIAEM34+CCIAEM35,COSTEM3
          ASSIGN   CCIAEMO1+CCIAEMO2+CCIAEMO3+CCIAEMO4+CCIAEMO5,COSTEMO
.
          RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CCSCEAIO/INC
          INC       CCSCEAKY    
          INC       CCSCEBIO/INC
          INC       CCSCECIO/INC
          INC       CCSCEDIO/INC
          INC       CCSCEEIO/INC
          INC       CCSCEFIO/INC
          INC       CCSCEGIO/INC
          INC       CCSCONIO/INC
          INC       CCSCOPCD    
          INC       CCSEPSIO/INC
          INC       CCSHCDIO/INC
          INC       CCSIADIO/INC
          INC       CCSSTYIO/INC
          INC       CCSXHDIO/INC
          INC       CCSXHDKY    
          INC       GPHHISCD    
          INC       GPHSTDCD    
.
          INC       STDGENCD
.
