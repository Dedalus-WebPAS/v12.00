.******************************************************************************
.* System        :  PATIENT CARE PLANS                                        *
.* Program       :  MENUPCP1                                                  *
.* Desc          :  Main System Menu    (Stand Alone)                         *
.******************************************************************************
.* Date          :  15/12/1989                                                *
.* Author        :  i chung                                                   *
.* Modifications :                                                            *
.*      V9.02.00   30/12/2002  Tracey Nguyen  srf 23497                       *
.*                 r5.10 Care Plans Port to V9                                *
.******************************************************************************
.* Version       :  V5.01.01                                                  *
.* Modifications :  Added Nurses Maintenance, Nurses Master Listing           *
.*                  Neeriem Dye 04/03/90                                      *
.*        V5.01.03  01/10/1992  Graeme Williams                               *
.*                  Added Frequency maintenance and master listing            *
.*        V10.02.01 04/04/2011  Jill Parkinson CAR 239574                     *
.*                  Removed open of ibaprntf                                  *
.******************************************************************************
.
          INC       STD001FD
          INC       IBACONFD/INC
          INC       IBAIMNFD/INC
          INC       IBAPORFD/INC            * port scanning
          INC       IBAPRNFD/INC
          INC       IBASECFD/INC
          INC       IBASUSFD/INC
          INC       IBASYSFD/INC            * tracks users on system
+
.*******************************************************************************
.*                               CONSTANTS                                     *
.*******************************************************************************
PRGID     INIT      "MENUPCP1"
PRGNAM    INIT      "PATIENT CARE PLANS SYSTEM"
VERSION   INIT      "V12.00.00"
.
PROGRAM   INIT      "        "
+
.*******************************************************************************
.*                         MISCELLANEOUS VARIABLES                             *
.*******************************************************************************
.
ACTION    FORM      2                 * user requested action in special system
ACTION2   FORM      2                 * user requested action in main menu
ANSWER    DIM       2                 * response work variable
.
CASHIDC   DIM       6
CHOSTYP   FORM      1      245        * 0 = Private Hospital
.                                       1 = Public Hospital
CNT       FORM      1
DIM3      DIM       3
EXECSTR   DIM       80
.
ITEM1     FORM      2
ITEM2     FORM      2
ITEM3     FORM      2
ITEM4     FORM      2
.
.
PASSCHK   DIM       8
PASSTAB   FORM      3
PASSWD    DIM       8
PORTNAME  DIM       11
PROGNAME  DIM       8
SPNAME    DIM       8
SPOOLFLG  FORM      1
+
.*******************************************************************************
.*                               MAINLINE                                      *
.*                           controlling logic                                 *
.*******************************************************************************
ML0000    CALL      INIT0000               * initialisation routine
.
.  ------ Main Menu ------
.
ML1000    CALL      MAIN0000               * display Main Menu
.
ML2000    CALL      OSEL0000               * Option selection
          BRANCH    EXIT,ML9999,ML3000     * 1=Exit, 2=Special System Menu
          CALL      OCHN0000               * chain to program of selected Option
          BRANCH    EXIT,ML2000            * invalid selection
          GOTO      ML1000                 * return to Main Menu
.
.  ------ Special System Menu ------
.
ML3000    CALL      SSYS0000               * Special System routine
          GOTO      ML1000                 * return to Main Menu
.
ML9999    CHAIN     SPNAME
+
.*******************************************************************************
.*                               INIT0000                                      *
.*        initialization/headings                        called by : MAINLINE  *
.*******************************************************************************
INIT0000  CLOCK     PORT,PORTNAME
          CALL      DISPHEAD
          DISPLAY   *P72:2,"PORT: ",PORT;
.
          OPEN      CONTROLF,"controlf"
          OPEN      IBACODE1,"ibacodef"
          OPEN      IBAPORT1,"ibaportf"
          OPEN      IBASECU1,"ibasecuf"
.
          READ      CONTROLF,ZERO;*13,CSECCNT,CIMENAUD,*47,IBCNSUSE
          READ      CONTROLF,TWO;*149,USERFLAG,*154,SPNAME
          READ      CONTROLF,TEN3;*245,CHOSTYP
.
.         USERFLAG = 0 FULL SYSTEM TRACKING
.         USERFLAG = 1 NO TRACKING
.
          BRANCH    USERFLAG OF INIT7000
.
          OPEN      IBASYSA1,"ibasysaf"      * SYSTEM TRACKING FILE
          OPEN      IBASYSA2,"ibasysaf"      * SYSTEM TRACKING FILE
          OPEN      IBASYSA3,"ibasysaf"      * SYSTEM TRACKING FILE
          OPEN      IBASYSA4,"ibasysaf"      * SYSTEM TRACKING FILE
.
          CALL      UPSYSA1                  * end of last program
.
INIT7000  MOVE      "MENUPCP1",IBAPPROG
          CALL      WRPORT1                  * IAM IN OUT MENU
.
          CALL      IBACLOCK
.
          MOVE      SP6,IDDD                 * common site ID
.
INIT9999  RETURN
+
.*******************************************************************************
.*                               MAIN0000                                      *
.*        display Main Menu screen                       called by : MAINLINE  *
.*******************************************************************************
MAIN0000  DISPLAY   *P1:4,*EF,*RPTCHAR ASK:80:
                    *P80:5,ASK:
                    *P80:6,ASK:
                    *P80:7,ASK:
                    *P80:8,ASK:
                    *P80:9,ASK:
                    *P80:10,ASK:
                    *P80:11,ASK:
                    *P80:12,ASK:
                    *P80:13,ASK:
                    *P80:14,ASK:
                    *P80:15,ASK:
                    *P80:16,ASK:
                    *P80:17,ASK:
                    *P80:18,ASK:
                    *P80:19,ASK:
                    *P80:20,ASK:
                    *P80:21,ASK:
                    *P1:22,*RPTCHAR ASK:80:
                    *P1:21,ASK:
                    *P1:20,ASK:
                    *P1:19,ASK:
                    *P1:18,ASK:
                    *P1:17,ASK:
                    *P1:16,ASK:
                    *P1:15,ASK:
                    *P1:14,ASK:
                    *P1:13,ASK:
                    *P1:12,ASK:
                    *P1:11,ASK:
                    *P1:10,ASK:
                    *P1:9,ASK:
                    *P1:8,ASK:
                    *P1:7,ASK:
                    *P1:6,ASK:
                    *P1:5,ASK:
                    *P32:5,*ULON,*V2LON," MAIN MENU ",*HOFF:
                    *P10:7,*V2LON,*ULON," MAINTENANCE ",*HOFF:
                    *P6:9,*V2LON,ZERO,*HOFF," = Exit":
                    *P6:10,*V2LON,ONE,*HOFF," = Diagnosis Maintenance":
                    *P6:11,*V2LON,TWO,*HOFF," = Database Maintenance":
                    *P6:12,*V2LON,THREE,*HOFF," = Nurses Maintenance":
                    *P6:13,*V2LON,FOUR,*HOFF," = Frequency Code Maintenance":
                    *P6:14,*V2LON,FIVE,*HOFF," = System Parameters":
                    *P10:16,*ULON,*V2LON," PROCESSING ",*HOFF:
                    *P6:18,*V2LON,SIX,*HOFF," = Input Patient Care Plans":
                    *P6:19,*V2LON,SEVEN,*HOFF," = Input Evaluations":
                    *P50:7,*ULON,*V2LON," ENQUIRY ",*HOFF:
                    *P46:9,*V2LON,EIGHT,*HOFF," = Patient Care Plan Enquiry":
                    *P46:10,*V2LON,NINE,*HOFF," = Discharged Patient Enquiry":
                    *P50:14,*ULON,*V2LON," REPORTING ",*HOFF:
                    *P45:16,*V2LON,TEN,*HOFF," = Print Database":
                    *P45:17,*V2LON,TEN1,*HOFF," = Diagnosis Master Listing":
                    *P45:18,*V2LON,TEN2,*HOFF," = Nurses Master Listing":
                    *P45:19,*V2LON,TEN3,*HOFF," = Frequency Master Listing":
                    *P27:21,"Select Option : "
.
MAIN9999  RETURN
+
.******************************************************************************
.*                               OSEL0000                                     *
.*        main menu Option selection                    called by : MAINLINE  *
.******************************************************************************
OSEL0000  MOVE      "43",CCOL
          MOVE      "21",CVERT
.
          CALL      MENUKEY
.
          COMPARE   ZERO,EXIT
          GOTO      OSEL1000 IF EQUAL
.
          MOVE      MENUOPT,ANSWER
.
          MATCH     "s",ANSWER                  * special system menu ?
          GOTO      OSEL9000 IF EQUAL
          BEEP                                  * re-enter if invalid entry
          GOTO      OSEL0000
.
OSEL1000  MOVE      CMENUOPT,ACTION2
.
          COMPARE   ZERO,ACTION2                * zero to Exit ?
          GOTO      OSEL8000 IF EQUAL
.
. ------  valid Option selected  ------
.
          MOVE      ZERO,EXIT                   * set EXIT = 0
          GOTO      OSEL9999
.
. ------  Exit Option selected or <RETURN> was hit  ------
.
OSEL8000  MOVE      ONE,EXIT                    * set EXIT = 1
          GOTO      OSEL9999
.
. ------  Special System screen function  ------
.
OSEL9000  MOVE      TWO,EXIT                    * set EXIT = 2
.
OSEL9999  RETURN
+
.*****************************************************************************
.*                               OCHN0000                                    *
.*        valid option chain                           called by : MAINLINE  *
.*****************************************************************************
OCHN0000  MOVE      FALSE,EXIT
.
          BRANCH    ACTION2,OCHN0100,OCHN0200,OCHN0300,OCHN0400:
                            OCHN0500,OCHN0600,OCHN0700,OCHN0800:
                            OCHN0900,OCHN1000,OCHN1100,OCHN1200:
                            OCHN1300
          BEEP
          MOVE      TRUE,EXIT
          GOTO      OCHN9999
.
OCHN0100  MOVE      "IBAPCP02",PROGNAME
          GOTO      CHECKPW
.
OCHN0200  MOVE      "IBAPCP01",PROGNAME
          GOTO      CHECKPW
.
OCHN0300  MOVE      "IBAPCP03",PROGNAME
          GOTO      CHECKPW
.
OCHN0400  MOVE      "IBAPCP04",PROGNAME
          GOTO      CHECKPW
.
OCHN0500  MOVE      "IBAPCP98",PROGNAME
          GOTO      CHECKPW
.
OCHN0600  MOVE      "IBAPCP11",PROGNAME
          GOTO      CHECKPW
.
OCHN0700  MOVE      "IBAPCP12",PROGNAME
          GOTO      CHECKPW
.
OCHN0800  MOVE      "IBAPCP13",PROGNAME
          GOTO      CHECKPW
.
OCHN0900  MOVE      "IBAPCP14",PROGNAME
          GOTO      CHECKPW
.
OCHN1000  MOVE      "IBAPCP31",PROGNAME
          GOTO      CHECKPW
.
OCHN1100  MOVE      "IBAPCP32",PROGNAME
          GOTO      CHECKPW
.
OCHN1200  MOVE      "IBAPCP33",PROGNAME
          GOTO      CHECKPW
.
OCHN1300  MOVE      "IBAPCP34",PROGNAME
          GOTO      CHECKPW
.
OCHN9999  RETURN
+
.*****************************************************************************
.*                               SSYS0000                                    *
.*         display Special System screen and select valid option             *
.*                                                                           *
.*                         called by : MAINLINE                              *
.*****************************************************************************
SSYS0000  CALL      SYSS0000                 * display Special System screen
          BRANCH    EXIT,SSYS9999
          CALL      SYSO0000                 * Special System option selection
.
SSYS9999  RETURN
+
.*****************************************************************************
.*                               SYSS0000                                    *
.*        display Special System screen                called by : SSYS0000  *
.*****************************************************************************
SYSS0000  COMPARE   NINE,SECLEV
          GOTO      SYSS1000 IF NOT EQUAL
.
          DISPLAY   *P1:3,*EF,*P19:3,*RPTCHAR ASK:43:
                    *P19:4,ASK,*P26:4,*ULON,*V2LON:
                    " I.B.A SPECIAL SYSTEM FEATURES ",*HOFF,*P61:4,ASK:
                    *P19:5,"*  ",*V2LON,ZERO,*HOFF:
                    " = Exit                               *":
                    *P19:6,"*  ",*V2LON,ONE,*HOFF:
                    " = ISAMFIX                            *":
                    *P19:7,"*  ",*V2LON,TWO,*HOFF:
                    " = TEXTFIX                            *":
                    *P19:8,"*  ",*V2LON,THREE,*HOFF:
                    " = DISPLAY                            *":
                    *P19:9,"*  ",*V2LON,FOUR,*HOFF:
                    " = INDXFIX                            *":
                    *P19:10,"*  ",*V2LON,FIVE,*HOFF:
                    " = Chain to Program with Spooling     *":
                    *P19:11,"*  ",*V2LON,SIX,*HOFF:
                    " = Printer System                     *":
                    *P19:12,"*  ",*V2LON,SEVEN,*HOFF:
                    " =                                    *":
                    *P19:13,"*  ",*V2LON,EIGHT,*HOFF:
                    " =                                    *":
                    *P19:14,"*  ",*V2LON,NINE,*HOFF:
                    " =                                    *":
                    *P19:15,"* ",*V2LON,TEN,*HOFF:
                    " =                                    *":
                    *P19:16,"* ",*V2LON,TEN1,*HOFF:
                    " =                                    *":
                    *P19:17,"* ",*V2LON,TEN2,*HOFF:
                    "                                      *":
                    *P19:18,"* ",*V2LON,TEN3,*HOFF:
                    "                                      *":
                    *P19:19,"* ",*V2LON,TEN4,*HOFF:
                    "                                      *":
                    *P19:20,"* ",*V2LON,TEN5,*HOFF:
                    "                                      *":
                    *P19:21,"*                                         *":
                    *P19:22,"*     Please Select                       *":
                    *P19:23,*RPTCHAR ASK:43;
          MOVE      FALSE,EXIT
          GOTO      SYSS9999
.
SYSS1000  MOVE      TRUE,EXIT
.
SYSS9999  RETURN
+
.*****************************************************************************
.*                               SYSO0000                                    *
.*       Special System option selection                 called by SSYS0000  *
.*****************************************************************************
SYSO0000  MOVE      "42",CCOL
          MOVE      "22",CVERT
.
          CALL      MENUKEY
.
          BRANCH    EXIT,SYSO0500
          MOVE      CMENUOPT,ACTION
.
          COMPARE   ZERO,ACTION
          GOTO      SYSO9999 IF EQUAL
.
          BRANCH    ACTION OF SYSO1000,SYSO2000,SYSO3000,SYSO4000:
                              SYSO5000,SYSO6000
.
SYSO0500  BEEP
          GOTO      SYSO0000
.
SYSO1000  MOVE      "ISAMFIX",PROGNAME
          GOTO       CHECKPW
.
SYSO2000  MOVE      "TEXTFIX",PROGNAME
          GOTO       CHECKPW
.
SYSO3000  MOVE      "DISPLAY",PROGNAME
          GOTO       CHECKPW
.
SYSO4000  MOVE      "INDXFIX",PROGNAME
          GOTO       CHECKPW
.
SYSO5000  KEYIN     *P1:3,*EF,*P1:12,"* Enter Program Name...":
                    *P23:12,*DV,UNDLN8,*V2LON,*P23:12,PROGNAME
          MOVE      ONE,PPAPER
          GOTO      PW3
.
SYSO6000  MOVE      "MENUSYS1",PROGNAME
          GOTO      CHECKPW
.
SYSO9999  RETURN
+
.***************************************************************************
.*                               NOCLEAR                                   *
.*                    inadequate security clearance                        *
.***************************************************************************
NOCLEAR DISPLAY    *P1:3,*EF,*P15:6,*B,*V2LON:
                   "*** Clearance Level Inadequate ***"
.
        KEYIN      *P1:24,*EL,"Hit ",*V2LON,"<RETURN>",*HOFF:
                              " to continue ",*EOFF,ANS;
        RETURN
.
        INC        IBAPRINT
        INC        IBAWDINC
        INC        IBAMNCOM
.
        INC        IBAIMNIO/INC
        INC       IBAPRNIO/INC
        INC       IBAPORIO/INC                  * port scanning
        INC        IBASECIO/INC       
        INC        IBASUSIO/INC
        INC        IBASYSIO/INC                  * IO for system audit
.
        INC        STD001IO
