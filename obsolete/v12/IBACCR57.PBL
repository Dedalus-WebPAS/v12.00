.---------------------------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  04.07.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from r5.09
.---------------------------------------------------------------------------
. V5.09.01  08/08/2001  Davin
.           Recompiled for change to CCSEPSFD
.---------------------------------------------------------------------------
. V5.04.11  28.07.1996 B.G.Ackland
.           New Fields for Southern Health
. V5.04.09  11.02.1996 B.G.Ackland
.           Extend Episode file.
. V6.00.08  17.01.1994 B.G.Ackland
.           Ignore Zero Items at level 1
. V6.00.07  16.12.1993 B.G.Ackland
.           Day Case Option
. V6.00.06  29.09.1993 B.G.Ackland
.           Std Dev Calculation
. V6.00.05  13.07.1993 B.G.Ackland
.           Extend Episode file.
.---------------------------------------------------------------------------
CASTDDEV  FORM     1
.---------------------------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACCR57
.   Function      :   Casemix Extract Enquiries               
.   Generated  On :   04/07/2002
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CCR57TMP    
          INC       CCSCEAFD/INC
          INC       CCSCEBFD/INC
          INC       CCSCECFD/INC
          INC       CCSCEDFD/INC
          INC       CCSCEEFD/INC
          INC       CCSCEFFD/INC
          INC       CCSCEGFD/INC
          INC       CCSCMAFD/INC
          INC       CCSDPTFD/INC
          INC       CCSEPSFD/INC
          INC       CCSHCDFD/INC
          INC       CCSMSCFD/INC
          INC       CCSMTSFD/INC
          INC       CCSPDPFD/INC
          INC       CCSRASFD/INC
          INC       CCSRBDFD/INC
          INC       CCSSPCFD/INC
          INC       CCSSTYFD/INC
          INC       CCSUPDFD/INC
          INC       CCSXHDFD/INC
          INC       GPHHISDF    
          INC       GPHSTDDF    
.=========================
.Local Variable Definition
.-------------------------
FROMCOST  DIM      45 * Scr 00 Fld    11
TOCOST    DIM      45 * Scr 00 Fld    13
FROMDD    DIM      10 * Scr 00 Fld    15
TODD      DIM      10 * Scr 00 Fld    16
FROMAD    DIM      10 * Scr 00 Fld    17
TOAD      DIM      10 * Scr 00 Fld    18
VISITDES  DIM      15 * Scr 00 Fld    19
FROMCMOD  DIM      35 * Scr 00 Fld    21
TOCMOD    DIM      35 * Scr 00 Fld    22
CLV1DES   DIM      35 * Scr 00 Fld    23
CLV2DES   DIM      35 * Scr 00 Fld    24
CLV3DES   DIM      35 * Scr 00 Fld    25
DAYCDESC  DIM      25 * Scr 00 Fld    29
.
.    Multi Item Key Fields Scr 00 Fld    31
.-------------------------------------------------------
CCEB1NAM  INIT      "CCEB1"
CCEB1END  FORM      1   * End Display
CCEB1SNO  FORM      5   * Number of Items on the Screen
CCEB1MKY  DIM       127 * Match Key 
CCEB1IDX  INIT      " 132 UC1-5"
CCEB1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCEB1FNM  DIM       8  * Filename
CCEB1CNT  FORM      3  * Number of Items on Screen
LEV1DESC  DIM      35 * Scr 00 Fld    31
CSTTOT    FORM     12.4 * Scr 00 Fld    33
INCTOT    FORM     12.4 * Scr 00 Fld    37
FRCXBAR   FORM     12.2 * Scr 00 Fld    45
FRCSDEV   FORM     12.2 * Scr 00 Fld    46
FRCRANG   FORM     12.2 * Scr 00 Fld    47
TOCXBAR   FORM     12.2 * Scr 00 Fld    48
TOCSDEV   FORM     12.2 * Scr 00 Fld    49
TOCRANG   FORM     12.2 * Scr 00 Fld    50
LOSXBAR   FORM     12.2 * Scr 00 Fld    51
LOSSDEV   FORM     12.2 * Scr 00 Fld    52
LOSRANG   FORM     12.2 * Scr 00 Fld    53
COLHED1   DIM      10 * Scr 00 Fld    61
COLHED2   DIM      10 * Scr 00 Fld    62
HISTTYPE  FORM      1 * Scr 01 Fld    33
STATDES1  DIM      20 * Scr 01 Fld    35
STATDES2  DIM      20 * Scr 01 Fld    36
STATDES3  DIM      20 * Scr 01 Fld    37
STATDES4  DIM      20 * Scr 01 Fld    38
.
.    Multi Item Key Fields Scr 02 Fld     4
.-------------------------------------------------------
CCED1NAM  INIT      "CCED1"
CCED1END  FORM      1   * End Display
CCED1SNO  FORM      5   * Number of Items on the Screen
CCED1MKY  DIM       127 * Match Key 
CCED1EKY  DIM       127 * End Key
CCED1SKY  DIM       127 * Start Key
CCED1IDX  INIT      " 132 UC1-5"
CCED1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCED1FNM  DIM       8  * Filename
CCED1CNT  FORM      3  * Number of Items on Screen
LEV2DESC  DIM      40 * Scr 02 Fld     4
.
.    Multi Item Key Fields Scr 04 Fld     4
.-------------------------------------------------------
CCEE1NAM  INIT      "CCEE1"
CCEE1END  FORM      1   * End Display
CCEE1SNO  FORM      5   * Number of Items on the Screen
CCEE1MKY  DIM       127 * Match Key 
CCEE1EKY  DIM       127 * End Key
CCEE1SKY  DIM       127 * Start Key
CCEE1IDX  INIT      " 132 UC1-5"
CCEE1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCEE1FNM  DIM       8  * Filename
CCEE1CNT  FORM      3  * Number of Items on Screen
LEV3DESC  DIM      40 * Scr 04 Fld     4
.
.    Multi Item Key Fields Scr E1 Fld     3
.-------------------------------------------------------
CCEC2NAM  INIT      "CCEC2"
CCEC2END  FORM      1   * End Display
CCEC2SNO  FORM      5   * Number of Items on the Screen
CCEC2MKY  DIM       127 * Match Key 
CCEC2EKY  DIM       127 * End Key
CCEC2SKY  DIM       127 * Start Key
CCEC2IDX  INIT      " 132 UC1-5"
CCEC2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCEC2FNM  DIM       8  * Filename
CCEC2CNT  FORM      3  * Number of Items on Screen
CSTFDR    FORM     12.2 * Scr EC Fld    71
CSTFID    FORM     12.2 * Scr EC Fld    72
CSTVDR    FORM     12.2 * Scr EC Fld    73
CSTVID    FORM     12.2 * Scr EC Fld    74
INCFDR    FORM     12.2 * Scr EC Fld    81
INCFID    FORM     12.2 * Scr EC Fld    82
INCVDR    FORM     12.2 * Scr EC Fld    83
INCVID    FORM     12.2 * Scr EC Fld    84
VARFDR    FORM     12.2 * Scr EC Fld    90
VARFID    FORM     12.2 * Scr EC Fld    91
VARVDR    FORM     12.2 * Scr EC Fld    92
VARVID    FORM     12.2 * Scr EC Fld    93
VARTOT    FORM     12.2 * Scr EC Fld    94
DESC01    DIM      35 * Scr ES Fld    61
DESC02    DIM      35 * Scr ES Fld    62
DESC03    DIM      35 * Scr ES Fld    63
.
.    Multi Item Key Fields Scr ES Fld    70
.-------------------------------------------------------
CCUP2NAM  INIT      "CCUP2"
CCUP2END  FORM      1   * End Display
CCUP2SNO  FORM      5   * Number of Items on the Screen
CCUP2MKY  DIM       127 * Match Key 
CCUP2EKY  DIM       127 * End Key
CCUP2SKY  DIM       127 * Start Key
CCUP2IDX  INIT      " 132 UC1-5"
CCUP2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCUP2FNM  DIM       8  * Filename
CCUP2CNT  FORM      3  * Number of Items on Screen
COST1AMT  FORM     12.2 * Scr ES Fld    85
COST2AMT  FORM     12.2 * Scr ES Fld    86
GRAPHLEV  FORM      1 * Scr GO Fld     3
GPHLTO    FORM      1 * Scr GO Fld     5
GPHLAV    FORM      1 * Scr GO Fld     6
GPHLMN    FORM      1 * Scr GO Fld     7
GPHLMX    FORM      1 * Scr GO Fld     8
GPHFTO    FORM      1 * Scr GO Fld     9
GPHFAV    FORM      1 * Scr GO Fld    10
GPHFMN    FORM      1 * Scr GO Fld    11
GPHFMX    FORM      1 * Scr GO Fld    12
GPHTTO    FORM      1 * Scr GO Fld    13
GPHTAV    FORM      1 * Scr GO Fld    14
GPHTMN    FORM      1 * Scr GO Fld    15
GPHTMX    FORM      1 * Scr GO Fld    16
GPHEPS    FORM      1 * Scr GO Fld    17
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACCR57"
PRGNAM    INIT      "Casemix Extract Enquiries               "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CLOSE     CCEB1FL1,DELETE
.
          CLOSE     CCED1FL1,DELETE
.
          CLOSE     CCEE1FL1,DELETE
.
          CLOSE     CCEC2FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   64",AUDTSECT
          MOVE      " 37",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ccsaudep";
            OPEN      CCSAUDEP,"ccsaudep"
          ENDIF
          DISPLAY   *P56:24,"Opening ccsceaaf";
          OPEN      CCSCEAA1,"ccsceaaf"
          DISPLAY   *P56:24,"Opening ccscmaaf";
          OPEN      CCSCMAA1,"ccscmaaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA1,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA2,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA3,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA4,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA1,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA2,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA3,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA4,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA5,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccshcdaf";
          OPEN      CCSHCDA1,"ccshcdaf"
          DISPLAY   *P56:24,"Opening ccshcdaf";
          OPEN      CCSHCDA2,"ccshcdaf"
          DISPLAY   *P56:24,"Opening ccsmscaf";
          OPEN      CCSMSCA1,"ccsmscaf"
          DISPLAY   *P56:24,"Opening ccsmtsaf";
          OPEN      CCSMTSA1,"ccsmtsaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA1,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA2,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA3,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA4,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccsstyaf";
          OPEN      CCSSTYA1,"ccsstyaf"
          DISPLAY   *P56:24,"Opening ccsupdaf";
          OPEN      CCSUPDA1,"ccsupdaf"
          DISPLAY   *P56:24,"Opening ccsupdaf";
          OPEN      CCSUPDA2,"ccsupdaf"
          DISPLAY   *P56:24,"Opening ccsupdaf";
          OPEN      CCSUPDA3,"ccsupdaf"
          DISPLAY   *P56:24,"Opening ccsupdaf";
          OPEN      CCSUPDA4,"ccsupdaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA1,"ccsxhdaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA2,"ccsxhdaf"
.--------------------------------------------------------
. Initialise Batch Screen Level 1 Code & Key                 
.--------------------------------------------------------
          MOVE     ZERO,CCEB1SNO
          MOVE     "00   31",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCEB1SNO
            ENDIF
          ENDIF
          PACK      CCEB1FNM,ANST,CCEB1NAM,PORT
          REP       " 0",CCEB1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCEB1FL1,CCEB1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CCEB1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CCEB1FNM,CCEB1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",CCEB1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      CCEB1FL1,CCEB1FNM
.--------------------------------------------------------
. Initialise Batch Screen Level 2 Code & Description         
.--------------------------------------------------------
          MOVE     ZERO,CCED1SNO
          MOVE     "02    4",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCED1SNO
            ENDIF
          ENDIF
          PACK      CCED1FNM,ANST,CCED1NAM,PORT
          REP       " 0",CCED1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCED1FL1,CCED1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CCED1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CCED1FNM,CCED1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",CCED1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      CCED1FL1,CCED1FNM
.--------------------------------------------------------
. Initialise Batch Screen Level 3 Code & Description         
.--------------------------------------------------------
          MOVE     ZERO,CCEE1SNO
          MOVE     "04    4",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCEE1SNO
            ENDIF
          ENDIF
          PACK      CCEE1FNM,ANST,CCEE1NAM,PORT
          REP       " 0",CCEE1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCEE1FL1,CCEE1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CCEE1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CCEE1FNM,CCEE1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",CCEE1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      CCEE1FL1,CCEE1FNM
.--------------------------------------------------------
. Initialise Batch Screen Episode                            
.--------------------------------------------------------
          MOVE     ZERO,CCEC2SNO
          MOVE     "E1    3",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCEC2SNO
            ENDIF
          ENDIF
          PACK      CCEC2FNM,ANST,CCEC2NAM,PORT
          REP       " 0",CCEC2FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCEC2FL1,CCEC2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CCEC2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CCEC2FNM,CCEC2IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",CCEC2FNM;
          EXECUTE   KEY80,TASKID
          OPEN      CCEC2FL1,CCEC2FNM
.--------------------------------------------------------
. Initialise Batch Screen Date of Service                    
.--------------------------------------------------------
          MOVE     ZERO,CCUP2SNO
          MOVE     "ES   70",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCUP2SNO
            ENDIF
          ENDIF
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Casemix Level 1 Summary            
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Casemix Level 1 Detail             
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Casemix Level 2 Summary            
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Casemix Level 2 Details            
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Casemix Level 3 Summary            
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * Casemix Level 3 Details            
          ENDIF
          MATCH     "E1",SCRID
          IF         @EQUAL
            CALL       PSE1L000   * Episodes at Level 1                
          ENDIF
          MATCH     "E2",SCRID
          IF         @EQUAL
            CALL       PSE2L000   * Episodes at Level 2                
          ENDIF
          MATCH     "E3",SCRID
          IF         @EQUAL
            CALL       PSE3L000   * Episodes at Level 3                
          ENDIF
          MATCH     "EC",SCRID
          IF         @EQUAL
            CALL       PSECL000   * Split Cost Details                 
          ENDIF
          MATCH     "ED",SCRID
          IF         @EQUAL
            CALL       PSEDL000   * Episode Details                    
          ENDIF
          MATCH     "ES",SCRID
          IF         @EQUAL
            CALL       PSESL000   * Episode Summary                    
          ENDIF
          MATCH     "GO",SCRID
          IF         @EQUAL
            CALL       PSGOL000   * Graph Options                      
          ENDIF
          RETURN
.--------------------------------
. Screen - Casemix Level 1 Summary            
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Casemix Level 1 Summary            
.-------------------------------------------------------
CF00L000
          MOVE      SP70,CCEAEID 
          MOVE      SP70,CCEADES 
          MOVE      SP70,CCEAINC 
          MOVE      SP70,CCEAVIS 
          MOVE      SP70,CCEADAY 
          MOVE      SP70,CCEALV1 
          MOVE      SP70,CCEALV2 
          MOVE      SP70,CCEALV3 
          MOVE      SP70,FROMCOST
          MOVE      SP70,CCEAFYR 
          MOVE      SP70,TOCOST  
          MOVE      SP70,CCEATYR 
          MOVE      SP70,FROMDD  
          MOVE      SP70,TODD    
          MOVE      SP70,FROMAD  
          MOVE      SP70,TOAD    
          MOVE      SP70,VISITDES
          MOVE      SP70,CCHCDES 
          MOVE      SP70,FROMCMOD
          MOVE      SP70,TOCMOD  
          MOVE      SP70,CLV1DES 
          MOVE      SP70,CLV2DES 
          MOVE      SP70,CLV3DES 
          MOVE      SP70,CCEAHCD 
          MOVE      SP70,DAYCDESC
          MOVE      SP70,LEV1DESC
          MOVE      ZERO,CCEBNEP 
          MOVE      ZERO,CSTTOT  
          MOVE      ZERO,CCEBFMN 
          MOVE      ZERO,CCEBFMX 
          MOVE      ZERO,CCEBFSV 
          MOVE      ZERO,INCTOT  
          MOVE      ZERO,CCEBTMN 
          MOVE      ZERO,CCEBTMX 
          MOVE      ZERO,CCEBTSV 
          MOVE      ZERO,CCEBLTO 
          MOVE      ZERO,CCEBLMN 
          MOVE      ZERO,CCEBLMX 
          MOVE      ZERO,CCEBLSV 
          MOVE      ZERO,FRCXBAR 
          MOVE      ZERO,FRCSDEV 
          MOVE      ZERO,FRCRANG 
          MOVE      ZERO,TOCXBAR 
          MOVE      ZERO,TOCSDEV 
          MOVE      ZERO,TOCRANG 
          MOVE      ZERO,LOSXBAR 
          MOVE      ZERO,LOSSDEV 
          MOVE      ZERO,LOSRANG 
          MOVE      SP70,COLHED1 
          MOVE      SP70,COLHED2 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Casemix Level 1 Summary            
.--------------------------------------------------------
KY00L000
.
KY00L110
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEAINC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEAVIS 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEADAY 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEALV1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEALV2 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEALV3 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROMCOST
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEAFYR 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCOST  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEATYR 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROMDD  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TODD    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROMAD  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOAD    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,VISITDES
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCHCDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROMCMOD
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCMOD  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CLV1DES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CLV2DES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CLV3DES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEAHCD 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EEID0000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      CCEAEID,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEADES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      CCEAINC,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEAVIS,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEADAY,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEALV1,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEALV2,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEALV3,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROMCOST,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEAFYR,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCOST,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEATYR,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROMDD,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TODD,VAR         
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROMAD,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOAD,VAR         
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VISITDES,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCHCDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROMCMOD,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCMOD,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CLV1DES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CLV2DES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CLV3DES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEAHCD,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Casemix Level 1 Summary            
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Casemix Level 1 Summary            
.---------------------------------------------------------
LM00L000
.---------------------------------------------------------
. Load for :    31 Level 1 Code & Key                 
.---------------------------------------------------------
          PACK      KEY10,SP70
          CALL      RDCCEB1 
          IF        OVRCD=0
            CALL      RPCCEB1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP00L000
          MOVE     ZERO,CCEB1CNT
          MOVE     ZERO,CCEB1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP00L600
          MATCH    PRGID,SCPSPID
          GOTO     DP00L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP00L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP00L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L101,DP00L102:
                            DP00L103,DP00L104,DP00L105,DP00L106:
                            DP00L107,DP00L108,DP00L109,DP00L110:
                            DP00L111,DP00L112,DP00L113,DP00L114:
                            DP00L115,DP00L116,DP00L117,DP00L118:
                            DP00L119,DP00L120,DP00L121,DP00L122:
                            DP00L123,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010
          GOTO      DP00L010
.
DP00L101
          PACK      CCEB1MKY,SP70,SP70
          CALL      UPTCCEB1
          IF        CCEB1END=0
            CALL      RKCCEB1 
            IF        OVRCD=0
              PACK      CCEB1MKY,CCEBLV1                                                                        
                MOVE      ZERO,CCEB1END
                ADD       ONE,CCEB1CNT
                CALL      UPTCCEB1
          CALL      LV1DET00
                MOVE      LEV1DESC,VAR     
                CALL      DISPITEM
            ELSE
              MOVE      ONE,CCEB1END
            ENDIF
          ENDIF
          IF        CCEB1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L102
          IF        CCEB1END=0
            MOVE      CCEBNEP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L103
          IF        CCEB1END=0
            MOVE      CSTTOT,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L104
          IF        CCEB1END=0
            MOVE      CCEBFMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L105
          IF        CCEB1END=0
            MOVE      CCEBFMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L106
          IF        CCEB1END=0
            MOVE      CCEBFSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L107
          IF        CCEB1END=0
            MOVE      INCTOT,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L108
          IF        CCEB1END=0
            MOVE      CCEBTMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L109
          IF        CCEB1END=0
            MOVE      CCEBTMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L110
          IF        CCEB1END=0
            MOVE      CCEBTSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L111
          IF        CCEB1END=0
            MOVE      CCEBLTO,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L112
          IF        CCEB1END=0
            MOVE      CCEBLMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L113
          IF        CCEB1END=0
            MOVE      CCEBLMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L114
          IF        CCEB1END=0
            MOVE      CCEBLSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L115
          IF        CCEB1END=0
            MOVE      FRCXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L116
          IF        CCEB1END=0
            MOVE      FRCSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L117
          IF        CCEB1END=0
            MOVE      FRCRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L118
          IF        CCEB1END=0
            MOVE      TOCXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L119
          IF        CCEB1END=0
            MOVE      TOCSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L120
          IF        CCEB1END=0
            MOVE      TOCRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L121
          IF        CCEB1END=0
            MOVE      LOSXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L122
          IF        CCEB1END=0
            MOVE      LOSSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L123
          IF        CCEB1END=0
            MOVE      LOSRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
DP00L600
          MATCH    "CCEB1",NAMSSFFI
          GOTO     DP00L605 IF NOT EQUAL
          GOTO     DP00L999
DP00L605
DP00L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP00L000
.
          MATCH    "CCEB1",NAMSSFFI
          GOTO     FP00L105 IF NOT EQUAL
          PACK     KEY10,SP70
          CALL     RDCCEB1  * Start
          IF       OVRCD=0
            CALL     RPCCEB1  * Start
          ENDIF
          CALL     DP00L000
          GOTO     FP00L999
FP00L105
FP00L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP00L000
.
          MATCH    "CCEB1",NAMSSFFI
          GOTO     LP00L105 IF NOT EQUAL
          PACK     KEY10,Z70
          CALL     RSCCEB1  * End
          IF       OVRCD=1
            CALL     RPCCEB1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEB1SNO
            CALL     RPCCEB1 
            IF       OVRCD=1
              MOVE     CCEB1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP00L000
          GOTO     LP00L999
LP00L105
LP00L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP00L000
.
          MATCH    "CCEB1",NAMSSFFI
          GOTO     PP00L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP00L105
          CALL      RFTCCEB1
          BRANCH   OVRCD,PP00L115
          MOVE      CCEB1MKY,KEY10 
          CALL      RSCCEB1 
PP00L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCEB1SNO
            CALL     RPCCEB1 
            IF       OVRCD=1
              MOVE     CCEB1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP00L000
          GOTO     PP00L999
PP00L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEB1SNO
            CALL     RKCCEB1 
            IF       OVRCD=1
              MOVE     CCEB1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP00L999
PP00L120
PP00L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP00L000
          MATCH    "CCEB1",NAMSSFFI
          GOTO     NP00L115 IF NOT EQUAL
NP00L105
          CALL     RKCCEB1 
          BRANCH   OVRCD,NP00L110
          CALL     RPCCEB1 
          CALL     DP00L000
          GOTO     NP00L999
NP00L110
          CALL     RPCCEB1 
          BEEP
          GOTO     NP00L999
NP00L115
NP00L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT00L000
CT00L105
CT00L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Casemix Level 1 Summary            
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    31 Level 1 Code & Key                 
.---------------------------------------------------------
UPTCCEB1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCEB1FL1,KEY5;ANS
          IF        @OVER
            WRITE     CCEB1FL1,KEY5;SCPSROW,SCPSCOL,CCEB1MKY
          ELSE
            UPDATE    CCEB1FL1;SCPSROW,SCPSCOL,CCEB1MKY
          ENDIF
          RETURN
RDTCCEB1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCEB1FL1,KEY5;SCPSROW,SCPSCOL,CCEB1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTCCEB1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      CCEB1FL1,KEY5;;
          READKS    CCEB1FL1;SCPSROW,SCPSCOL,CCEB1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,CCEB1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Casemix Level 1 Summary            
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
          MOVE      "CCEB1",NAMSSFFI
          MOVE      "   31",ITMSSFFI
          CALL      FP00L000
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Casemix Level 1 Summary            
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L101:
                            PS00L102,PS00L103,PS00L104,PS00L105:
                            PS00L106,PS00L107,PS00L108,PS00L109:
                            PS00L110,PS00L111,PS00L112,PS00L113:
                            PS00L114,PS00L115,PS00L116,PS00L117:
                            PS00L118,PS00L119,PS00L120,PS00L121:
                            PS00L122,PS00L123,PS00L999,PS00L999:
                            PS00L124,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L125,PS00L126
          GOTO     PS00L999
.
PS00L101
          MOVE      CCEADES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEAINC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      CCEAVIS,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      CCEADAY,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      CCEALV1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      CCEALV2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      CCEALV3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      FROMCOST,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      CCEAFYR,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      TOCOST,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      CCEATYR,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      FROMDD,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      TODD,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      FROMAD,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      TOAD,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      VISITDES,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          MOVE      CCHCDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      FROMCMOD,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      TOCMOD,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE      CLV1DES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          MOVE      CLV2DES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      CLV3DES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          MOVE      CCEAHCD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          MOVE      DAYCDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          MOVE      COLHED1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L126
          MOVE      COLHED2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Casemix Level 1 Summary            
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L102,SF00L103:
                            SF00L006,SF00L006,SF00L104,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L105,SF00L106,SF00L107:
                            SF00L108,SF00L006,SF00L006,SF00L109:
                            SF00L006,SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L104,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          MOVE      "CCEB1",NAMSSFFI
          MOVE      "   31",ITMSSFFI
          CALL      FP00L000
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPH1LV00
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF00L000
          GOTO      SF00L001
.
SF00L104
          CALL      SELECTED
          BRANCH    EXIT,SF00L001
          COMPARE   ONE,ACCEPT
          GOTO      SF00L001 IF EQUAL
          CALL      RDTCCEB1
          IF        OVRCD=1
            BEEP
            GOTO      SF00L001
          ENDIF
          MATCH     SP70,CCEB1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF00L001
          ENDIF
          MOVE      CCEB1MKY,KEY10 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SEL1LV00
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCEB1
          IF        OVRCD=1
            CALL      FP00L000
          ELSE
            MOVE      CCEB1MKY,KEY10 
            CALL      RSCCEB1 
            CALL      RPCCEB1 
            CALL      DP00L000
          ENDIF
          GOTO     SF00L001
.
SF00L105
          MOVE      "CCEB1",NAMSSFFI
          MOVE      "   31",ITMSSFFI
          CALL      NP00L000
          GOTO     SF00L001
.
SF00L106
          MOVE      "CCEB1",NAMSSFFI
          MOVE      "   31",ITMSSFFI
          CALL      PP00L000
          GOTO     SF00L001
.
SF00L107
          MOVE      "CCEB1",NAMSSFFI
          MOVE      "   31",ITMSSFFI
          CALL      FP00L000
          GOTO     SF00L001
.
SF00L108
          MOVE      "CCEB1",NAMSSFFI
          MOVE      "   31",ITMSSFFI
          CALL      LP00L000
          GOTO     SF00L001
.
SF00L109
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SELCM000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF00L000
          GOTO      SF00L001
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.--------------------------------
. Screen - Casemix Level 1 Detail             
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 8",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Casemix Level 1 Detail             
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Casemix Level 1 Detail             
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Casemix Level 1 Detail             
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Casemix Level 1 Detail             
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Casemix Level 1 Detail             
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Casemix Level 1 Detail             
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L101,PS01L102:
                            PS01L103,PS01L104,PS01L105,PS01L106:
                            PS01L107,PS01L108,PS01L109,PS01L110:
                            PS01L111,PS01L112,PS01L113,PS01L114:
                            PS01L115,PS01L116,PS01L117,PS01L118:
                            PS01L119,PS01L120,PS01L121,PS01L122:
                            PS01L123,PS01L124,PS01L125,PS01L126:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L127,PS01L999,PS01L128,PS01L129:
                            PS01L130,PS01L131,PS01L132,PS01L133
          GOTO     PS01L999
.
PS01L101
          MOVE      CLV1DES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      CCXHKEY,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      CCXHDES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      CCEBNEP,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      CSTTOT,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      CCEBFMN,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      CCEBFMX,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      CCEBFSV,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      INCTOT,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      CCEBTMN,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      CCEBTMX,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          MOVE      CCEBTSV,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          MOVE      CCEBLTO,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          MOVE      CCEBLMN,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          MOVE      CCEBLMX,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L116
          MOVE      CCEBLSV,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L117
          MOVE      FRCXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L118
          MOVE      FRCSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L119
          MOVE      FRCRANG,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L120
          MOVE      TOCXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L121
          MOVE      TOCSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L122
          MOVE      TOCRANG,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L123
          MOVE      LOSXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L124
          MOVE      LOSSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L125
          MOVE      LOSRANG,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L126
          MOVE      CCEAHCD,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L127
          MOVE      HISTTYPE,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L128
          MOVE      STATDES1,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L129
          MOVE      STATDES2,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L130
          MOVE      STATDES3,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L131
          MOVE      STATDES4,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L132
          MOVE      COLHED1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L133
          MOVE      COLHED2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Casemix Level 1 Detail             
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L102,SF01L103,SF01L104,SF01L105:
                            SF01L006,SF01L106,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      LEVEL200
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF01L001
.
SF01L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCXHDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      KY01LV00
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCXHDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF01L000
          GOTO      SF01L001
.
SF01L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCE1L000
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF01L001
.
SF01L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      H1DP0000
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF01L001
.
SF01L106
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SF01L999
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Casemix Level 2 Summary            
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "10",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Casemix Level 2 Summary            
.-------------------------------------------------------
CF02L000
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Casemix Level 2 Summary            
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Casemix Level 2 Summary            
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Casemix Level 2 Summary            
.---------------------------------------------------------
LM02L000
.---------------------------------------------------------
. Load for :     4 Level 2 Code & Description         
.---------------------------------------------------------
          PACK      KEY20,CCEBLV1,SP70
          MOVE      KEY20,CCED1EKY
          MOVE      CCED1EKY,CCED1SKY
          STRIP     CCED1SKY
          SETLPTR   CCED1EKY,10
          CALL      RDCCED1 
          IF        OVRCD=0
            CALL      RPCCED1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP02L000
          MOVE     ZERO,CCED1CNT
          MOVE     ZERO,CCED1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP02L600
          MATCH    PRGID,SCPSPID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP02L010,DP02L010,DP02L010,DP02L101:
                            DP02L102,DP02L103,DP02L104,DP02L105:
                            DP02L106,DP02L107,DP02L108,DP02L109:
                            DP02L110,DP02L111,DP02L112,DP02L113:
                            DP02L114,DP02L115,DP02L116,DP02L117:
                            DP02L118,DP02L119,DP02L120,DP02L121:
                            DP02L122,DP02L123,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010
          GOTO      DP02L010
.
DP02L101
          PACK      CCED1MKY,SP70,SP70
          CALL      UPTCCED1
          IF        CCED1END=0
            CALL      RKCCED1 
            IF        OVRCD=0
              PACK      CCED1MKY,CCEDLV1,CCEDLV2                                                                
              MATCH     CCED1EKY,CCED1MKY
              IF        @EQUAL
                MOVE      ZERO,CCED1END
                ADD       ONE,CCED1CNT
                CALL      UPTCCED1
          CALL      LV2DET00
                MOVE      LEV2DESC,VAR     
                CALL      DISPITEM
              ELSE
                MOVE      ONE,CCED1END
              ENDIF
            ELSE
              MOVE      ONE,CCED1END
            ENDIF
          ENDIF
          IF        CCED1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L102
          IF        CCED1END=0
            MOVE      CCEDNEP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L103
          IF        CCED1END=0
            MOVE      CSTTOT,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L104
          IF        CCED1END=0
            MOVE      CCEDFMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L105
          IF        CCED1END=0
            MOVE      CCEDFMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L106
          IF        CCED1END=0
            MOVE      CCEDFSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L107
          IF        CCED1END=0
            MOVE      INCTOT,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L108
          IF        CCED1END=0
            MOVE      CCEDTMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L109
          IF        CCED1END=0
            MOVE      CCEDTMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L110
          IF        CCED1END=0
            MOVE      CCEDTSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L111
          IF        CCED1END=0
            MOVE      CCEDLTO,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L112
          IF        CCED1END=0
            MOVE      CCEDLMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L113
          IF        CCED1END=0
            MOVE      CCEDLMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L114
          IF        CCED1END=0
            MOVE      CCEDLSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L115
          IF        CCED1END=0
            MOVE      FRCXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L116
          IF        CCED1END=0
            MOVE      FRCSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L117
          IF        CCED1END=0
            MOVE      FRCRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L118
          IF        CCED1END=0
            MOVE      TOCXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L119
          IF        CCED1END=0
            MOVE      TOCSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L120
          IF        CCED1END=0
            MOVE      TOCRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L121
          IF        CCED1END=0
            MOVE      LOSXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L122
          IF        CCED1END=0
            MOVE      LOSSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L123
          IF        CCED1END=0
            MOVE      LOSRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
DP02L600
          MATCH    "CCED1",NAMSSFFI
          GOTO     DP02L605 IF NOT EQUAL
          GOTO     DP02L999
DP02L605
DP02L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP02L000
.
          MATCH    "CCED1",NAMSSFFI
          GOTO     FP02L105 IF NOT EQUAL
          PACK     KEY20,CCED1SKY,SP70
          CALL     RDCCED1  * Start
          IF       OVRCD=0
            CALL     RPCCED1  * Start
          ENDIF
          CALL     DP02L000
          GOTO     FP02L999
FP02L105
FP02L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP02L000
.
          MATCH    "CCED1",NAMSSFFI
          GOTO     LP02L105 IF NOT EQUAL
          PACK     KEY20,CCED1SKY,Z70
          CALL     RSCCED1  * End
          IF       OVRCD=1
            CALL     RPCCED1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCED1SNO
            CALL     RPCCED1 
            IF       OVRCD=1
              MOVE     CCED1SNO,SECTOR
            ENDIF
            PACK     CCED1MKY,CCEDLV1,CCEDLV2                                                                
            MATCH    CCED1EKY,CCED1MKY
            IF       !@EQUAL
              MOVE     CCED1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     LP02L999
LP02L105
LP02L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP02L000
.
          MATCH    "CCED1",NAMSSFFI
          GOTO     PP02L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP02L105
          CALL      RFTCCED1
          BRANCH   OVRCD,PP02L115
          MOVE      CCED1MKY,KEY20 
          CALL      RSCCED1 
PP02L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCED1SNO
            CALL     RPCCED1 
            IF       OVRCD=1
              MOVE     CCED1SNO,SECTOR
            ENDIF
            PACK     CCED1MKY,CCEDLV1,CCEDLV2                                                                
            MATCH    CCED1EKY,CCED1MKY
            IF       !@EQUAL
              MOVE     CCED1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     PP02L999
PP02L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCED1SNO
            CALL     RKCCED1 
            IF       OVRCD=1
              MOVE     CCED1SNO,SECTOR
            ENDIF
            PACK     CCED1MKY,CCEDLV1,CCEDLV2                                                                
            MATCH    CCED1EKY,CCED1MKY
            IF       !@EQUAL
              MOVE     CCED1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP02L999
PP02L120
PP02L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP02L000
          MATCH    "CCED1",NAMSSFFI
          GOTO     NP02L115 IF NOT EQUAL
NP02L105
          CALL     RKCCED1 
          BRANCH   OVRCD,NP02L110
          PACK     CCED1MKY,CCEDLV1,CCEDLV2                                                                
          MATCH    CCED1EKY,CCED1MKY
          GOTO     NP02L110 IF NOT EQUAL
          CALL     RPCCED1 
          CALL     DP02L000
          GOTO     NP02L999
NP02L110
          CALL     RPCCED1 
          BEEP
          GOTO     NP02L999
NP02L115
NP02L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT02L000
CT02L105
CT02L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Casemix Level 2 Summary            
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     4 Level 2 Code & Description         
.---------------------------------------------------------
UPTCCED1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCED1FL1,KEY5;ANS
          IF        @OVER
            WRITE     CCED1FL1,KEY5;SCPSROW,SCPSCOL,CCED1MKY
          ELSE
            UPDATE    CCED1FL1;SCPSROW,SCPSCOL,CCED1MKY
          ENDIF
          RETURN
RDTCCED1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCED1FL1,KEY5;SCPSROW,SCPSCOL,CCED1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTCCED1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      CCED1FL1,KEY5;;
          READKS    CCED1FL1;SCPSROW,SCPSCOL,CCED1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,CCED1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Casemix Level 2 Summary            
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
          MOVE      "CCED1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FP02L000
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Casemix Level 2 Summary            
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L101,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L102,PS02L103
          GOTO     PS02L999
.
PS02L101
          MOVE      CLV2DES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      COLHED1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      COLHED2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Casemix Level 2 Summary            
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L006,SF02L102:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L103,SF02L104:
                            SF02L105,SF02L106,SF02L107,SF02L108:
                            SF02L006,SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L102:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          MOVE      "CCED1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L102
          CALL      SELECTED
          BRANCH    EXIT,SF02L001
          COMPARE   ONE,ACCEPT
          GOTO      SF02L001 IF EQUAL
          CALL      RDTCCED1
          IF        OVRCD=1
            BEEP
            GOTO      SF02L001
          ENDIF
          MATCH     SP70,CCED1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF02L001
          ENDIF
          MOVE      CCED1MKY,KEY20 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SEL2LV00
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCED1
          IF        OVRCD=1
            CALL      FP02L000
          ELSE
            MOVE      CCED1MKY,KEY20 
            CALL      RSCCED1 
            CALL      RPCCED1 
            CALL      DP02L000
          ENDIF
          GOTO     SF02L001
.
SF02L103
          MOVE      "CCED1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      NP02L000
          GOTO     SF02L001
.
SF02L104
          MOVE      "CCED1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      PP02L000
          GOTO     SF02L001
.
SF02L105
          MOVE      "CCED1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L106
          MOVE      "CCED1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      LP02L000
          GOTO     SF02L001
.
SF02L107
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPH2LV00
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF02L000
          GOTO      SF02L001
.
SF02L108
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SF02L999
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Casemix Level 2 Details            
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "10",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Casemix Level 2 Details            
.-------------------------------------------------------
CF03L000
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Casemix Level 2 Details            
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Casemix Level 2 Details            
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Casemix Level 2 Details            
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Casemix Level 2 Details            
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Casemix Level 2 Details            
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L101,PS03L102:
                            PS03L103,PS03L104,PS03L105,PS03L106:
                            PS03L107,PS03L108,PS03L109,PS03L110:
                            PS03L111,PS03L112,PS03L113,PS03L114:
                            PS03L115,PS03L116,PS03L117,PS03L118:
                            PS03L119,PS03L120,PS03L121,PS03L122:
                            PS03L123,PS03L124,PS03L125,PS03L126:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L127,PS03L128,PS03L129:
                            PS03L130,PS03L131,PS03L132
          GOTO     PS03L999
.
PS03L101
          MOVE      CLV2DES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      CCEDLV2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      CCXHDES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      CCEDNEP,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L105
          MOVE      CSTTOT,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L106
          MOVE      CCEDFMN,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L107
          MOVE      CCEDFMX,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L108
          MOVE      CCEDFSV,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L109
          MOVE      INCTOT,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L110
          MOVE      CCEDTMN,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L111
          MOVE      CCEDTMX,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L112
          MOVE      CCEDTSV,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L113
          MOVE      CCEDLTO,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L114
          MOVE      CCEDLMN,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L115
          MOVE      CCEDLMX,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L116
          MOVE      CCEDLSV,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L117
          MOVE      FRCXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L118
          MOVE      FRCSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L119
          MOVE      FRCRANG,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L120
          MOVE      TOCXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L121
          MOVE      TOCSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L122
          MOVE      TOCRANG,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L123
          MOVE      LOSXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L124
          MOVE      LOSSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L125
          MOVE      LOSRANG,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L126
          MOVE      CCEAHCD,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L127
          MOVE      STATDES1,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L128
          MOVE      STATDES2,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L129
          MOVE      STATDES3,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L130
          MOVE      STATDES4,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L131
          MOVE      COLHED1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L132
          MOVE      COLHED2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Casemix Level 2 Details            
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L102,SF03L103,SF03L104,SF03L105:
                            SF03L106,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      LEVEL300
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF03L000
          GOTO      SF03L001
.
SF03L103
          CALL      KY02LV00
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCE2L000
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF03L001
.
SF03L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      H2DP0000
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF03L001
.
SF03L106
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SF03L999
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Casemix Level 3 Summary            
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "11",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Casemix Level 3 Summary            
.-------------------------------------------------------
CF04L000
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Casemix Level 3 Summary            
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Casemix Level 3 Summary            
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Casemix Level 3 Summary            
.---------------------------------------------------------
LM04L000
.---------------------------------------------------------
. Load for :     4 Level 3 Code & Description         
.---------------------------------------------------------
          PACK      KEY30,CCEBLV1,CCEDLV2,SP70
          MOVE      KEY30,CCEE1EKY
          MOVE      CCEE1EKY,CCEE1SKY
          STRIP     CCEE1SKY
          SETLPTR   CCEE1EKY,20
          CALL      RDCCEE1 
          IF        OVRCD=0
            CALL      RPCCEE1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP04L000
          MOVE     ZERO,CCEE1CNT
          MOVE     ZERO,CCEE1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP04L600
          MATCH    PRGID,SCPSPID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP04L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP04L010,DP04L010,DP04L010,DP04L101:
                            DP04L102,DP04L103,DP04L104,DP04L105:
                            DP04L106,DP04L107,DP04L108,DP04L109:
                            DP04L110,DP04L111,DP04L112,DP04L113:
                            DP04L114,DP04L115,DP04L116,DP04L117:
                            DP04L118,DP04L119,DP04L120,DP04L121:
                            DP04L122,DP04L123,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010
          GOTO      DP04L010
.
DP04L101
          PACK      CCEE1MKY,SP70,SP70
          CALL      UPTCCEE1
          IF        CCEE1END=0
            CALL      RKCCEE1 
            IF        OVRCD=0
              PACK      CCEE1MKY,CCEELV1,CCEELV2,CCEELV3                                                        
              MATCH     CCEE1EKY,CCEE1MKY
              IF        @EQUAL
                MOVE      ZERO,CCEE1END
                ADD       ONE,CCEE1CNT
                CALL      UPTCCEE1
          CALL      LV3DET00
                MOVE      LEV3DESC,VAR     
                CALL      DISPITEM
              ELSE
                MOVE      ONE,CCEE1END
              ENDIF
            ELSE
              MOVE      ONE,CCEE1END
            ENDIF
          ENDIF
          IF        CCEE1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L102
          IF        CCEE1END=0
            MOVE      CCEENEP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L103
          IF        CCEE1END=0
            MOVE      CSTTOT,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L104
          IF        CCEE1END=0
            MOVE      CCEEFMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L105
          IF        CCEE1END=0
            MOVE      CCEEFMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L106
          IF        CCEE1END=0
            MOVE      CCEEFSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L107
          IF        CCEE1END=0
            MOVE      INCTOT,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L108
          IF        CCEE1END=0
            MOVE      CCEETMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L109
          IF        CCEE1END=0
            MOVE      CCEETMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L110
          IF        CCEE1END=0
            MOVE      CCEETSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L111
          IF        CCEE1END=0
            MOVE      CCEELTO,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L112
          IF        CCEE1END=0
            MOVE      CCEELMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L113
          IF        CCEE1END=0
            MOVE      CCEELMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L114
          IF        CCEE1END=0
            MOVE      CCEELSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L115
          IF        CCEE1END=0
            MOVE      FRCXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L116
          IF        CCEE1END=0
            MOVE      FRCSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L117
          IF        CCEE1END=0
            MOVE      FRCRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L118
          IF        CCEE1END=0
            MOVE      TOCXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L119
          IF        CCEE1END=0
            MOVE      TOCSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L120
          IF        CCEE1END=0
            MOVE      TOCRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L121
          IF        CCEE1END=0
            MOVE      LOSXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L122
          IF        CCEE1END=0
            MOVE      LOSSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L123
          IF        CCEE1END=0
            MOVE      LOSRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
DP04L600
          MATCH    "CCEE1",NAMSSFFI
          GOTO     DP04L605 IF NOT EQUAL
          GOTO     DP04L999
DP04L605
DP04L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP04L000
.
          MATCH    "CCEE1",NAMSSFFI
          GOTO     FP04L105 IF NOT EQUAL
          PACK     KEY30,CCEE1SKY,SP70
          CALL     RDCCEE1  * Start
          IF       OVRCD=0
            CALL     RPCCEE1  * Start
          ENDIF
          CALL     DP04L000
          GOTO     FP04L999
FP04L105
FP04L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP04L000
.
          MATCH    "CCEE1",NAMSSFFI
          GOTO     LP04L105 IF NOT EQUAL
          PACK     KEY30,CCEE1SKY,Z70
          CALL     RSCCEE1  * End
          IF       OVRCD=1
            CALL     RPCCEE1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEE1SNO
            CALL     RPCCEE1 
            IF       OVRCD=1
              MOVE     CCEE1SNO,SECTOR
            ENDIF
            PACK     CCEE1MKY,CCEELV1,CCEELV2,CCEELV3                                                        
            MATCH    CCEE1EKY,CCEE1MKY
            IF       !@EQUAL
              MOVE     CCEE1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     LP04L999
LP04L105
LP04L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP04L000
.
          MATCH    "CCEE1",NAMSSFFI
          GOTO     PP04L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP04L105
          CALL      RFTCCEE1
          BRANCH   OVRCD,PP04L115
          MOVE      CCEE1MKY,KEY30 
          CALL      RSCCEE1 
PP04L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCEE1SNO
            CALL     RPCCEE1 
            IF       OVRCD=1
              MOVE     CCEE1SNO,SECTOR
            ENDIF
            PACK     CCEE1MKY,CCEELV1,CCEELV2,CCEELV3                                                        
            MATCH    CCEE1EKY,CCEE1MKY
            IF       !@EQUAL
              MOVE     CCEE1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     PP04L999
PP04L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEE1SNO
            CALL     RKCCEE1 
            IF       OVRCD=1
              MOVE     CCEE1SNO,SECTOR
            ENDIF
            PACK     CCEE1MKY,CCEELV1,CCEELV2,CCEELV3                                                        
            MATCH    CCEE1EKY,CCEE1MKY
            IF       !@EQUAL
              MOVE     CCEE1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP04L999
PP04L120
PP04L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP04L000
          MATCH    "CCEE1",NAMSSFFI
          GOTO     NP04L115 IF NOT EQUAL
NP04L105
          CALL     RKCCEE1 
          BRANCH   OVRCD,NP04L110
          PACK     CCEE1MKY,CCEELV1,CCEELV2,CCEELV3                                                        
          MATCH    CCEE1EKY,CCEE1MKY
          GOTO     NP04L110 IF NOT EQUAL
          CALL     RPCCEE1 
          CALL     DP04L000
          GOTO     NP04L999
NP04L110
          CALL     RPCCEE1 
          BEEP
          GOTO     NP04L999
NP04L115
NP04L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT04L000
CT04L105
CT04L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Casemix Level 3 Summary            
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     4 Level 3 Code & Description         
.---------------------------------------------------------
UPTCCEE1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCEE1FL1,KEY5;ANS
          IF        @OVER
            WRITE     CCEE1FL1,KEY5;SCPSROW,SCPSCOL,CCEE1MKY
          ELSE
            UPDATE    CCEE1FL1;SCPSROW,SCPSCOL,CCEE1MKY
          ENDIF
          RETURN
RDTCCEE1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCEE1FL1,KEY5;SCPSROW,SCPSCOL,CCEE1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTCCEE1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      CCEE1FL1,KEY5;;
          READKS    CCEE1FL1;SCPSROW,SCPSCOL,CCEE1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,CCEE1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Casemix Level 3 Summary            
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
          MOVE      "CCEE1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FP04L000
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Casemix Level 3 Summary            
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L101,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L102,PS04L103
          GOTO     PS04L999
.
PS04L101
          MOVE      CLV3DES,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      COLHED1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      COLHED2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Casemix Level 3 Summary            
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L006,SF04L102:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L103,SF04L104:
                            SF04L105,SF04L106,SF04L107,SF04L108:
                            SF04L006,SF04L006
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L102:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          MOVE      "CCEE1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L101
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L102
          CALL      SELECTED
          BRANCH    EXIT,SF04L001
          COMPARE   ONE,ACCEPT
          GOTO      SF04L001 IF EQUAL
          CALL      RDTCCEE1
          IF        OVRCD=1
            BEEP
            GOTO      SF04L001
          ENDIF
          MATCH     SP70,CCEE1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF04L001
          ENDIF
          MOVE      CCEE1MKY,KEY30 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SEL3LV00
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCEE1
          IF        OVRCD=1
            CALL      FP04L000
          ELSE
            MOVE      CCEE1MKY,KEY30 
            CALL      RSCCEE1 
            CALL      RPCCEE1 
            CALL      DP04L000
          ENDIF
          GOTO     SF04L001
.
SF04L103
          MOVE      "CCEE1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      NP04L000
          GOTO     SF04L001
.
SF04L104
          MOVE      "CCEE1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      PP04L000
          GOTO     SF04L001
.
SF04L105
          MOVE      "CCEE1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L106
          MOVE      "CCEE1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      LP04L000
          GOTO     SF04L001
.
SF04L107
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPH3LV00
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF04L000
          GOTO      SF04L001
.
SF04L108
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SF04L999
SF04L990  MOVE      ONE,EXIT * Exit Char Restart
SF04L999  RETURN
.--------------------------------
. Screen - Casemix Level 3 Details            
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "11",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC05L200
          CALL      CF05L000 * Clear Fields
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Casemix Level 3 Details            
.-------------------------------------------------------
CF05L000
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Casemix Level 3 Details            
.--------------------------------------------------------
KY05L000
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : Casemix Level 3 Details            
.---------------------------------------------------------
WP05L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Casemix Level 3 Details            
.---------------------------------------------------------
LM05L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Casemix Level 3 Details            
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Casemix Level 3 Details            
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L999,PS05L999,PS05L101,PS05L102:
                            PS05L103,PS05L104,PS05L105,PS05L106:
                            PS05L107,PS05L108,PS05L109,PS05L110:
                            PS05L111,PS05L112,PS05L113,PS05L114:
                            PS05L115,PS05L116,PS05L117,PS05L118:
                            PS05L119,PS05L120,PS05L121,PS05L122:
                            PS05L123,PS05L124,PS05L125,PS05L126:
                            PS05L999,PS05L999,PS05L999,PS05L999:
                            PS05L999,PS05L127,PS05L128,PS05L129:
                            PS05L130,PS05L131,PS05L132
          GOTO     PS05L999
.
PS05L101
          MOVE      CLV3DES,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L102
          MOVE      CCEELV3,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L103
          MOVE      CCXHDES,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L104
          MOVE      CCEENEP,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L105
          MOVE      CSTTOT,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L106
          MOVE      CCEEFMN,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L107
          MOVE      CCEEFMX,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L108
          MOVE      CCEEFSV,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L109
          MOVE      INCTOT,VAR       
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L110
          MOVE      CCEETMN,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L111
          MOVE      CCEETMX,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L112
          MOVE      CCEETSV,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L113
          MOVE      CCEELTO,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L114
          MOVE      CCEELMN,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L115
          MOVE      CCEELMX,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L116
          MOVE      CCEELSV,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L117
          MOVE      FRCXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L118
          MOVE      FRCSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L119
          MOVE      FRCRANG,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L120
          MOVE      TOCXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L121
          MOVE      TOCSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L122
          MOVE      TOCRANG,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L123
          MOVE      LOSXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L124
          MOVE      LOSSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L125
          MOVE      LOSRANG,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L126
          MOVE      CCEAHCD,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L127
          MOVE      STATDES1,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L128
          MOVE      STATDES2,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L129
          MOVE      STATDES3,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L130
          MOVE      STATDES4,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L131
          MOVE      COLHED1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L132
          MOVE      COLHED2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : Casemix Level 3 Details            
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L006,SF05L101,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L102,SF05L103,SF05L104:
                            SF05L105,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          GOTO     SF05L001
.
SF05L101
          MOVE      ZERO,EXIT
          GOTO      SF05L999
.
SF05L102
          CALL      KY03LV00
          MOVE      ONE,EXIT
          GOTO      SF05L999
.
SF05L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCE3L000
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF05L001
.
SF05L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      H3DP0000
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF05L001
.
SF05L105
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SF05L999
SF05L990  MOVE      ONE,EXIT * Exit Char Restart
SF05L999  RETURN
.--------------------------------
. Screen - Episodes at Level 1                
.--------------------------------
SCE1L000
SCE1L100
          MOVE      "E1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "13",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCE1L200
          CALL      CFE1L000 * Clear Fields
SCE1L300
          CALL      KYE1L000 * Enter Key Fields
          BRANCH    EXIT,SCE1L999,SCE1L999
SCE1L400
          CALL      WPE1L000 * Load any WP Details
SCE1L500
          CALL      LME1L000 * Load any Batch Details
SCE1L600
          CALL      DFE1L000 * Display Fields
SCE1L700
          CALL      SFE1L000 * Select Fields
          BRANCH    EXIT,SCE1L100,SCE1L100,SCE1L200
SCE1L800
SCE1L900
SCE1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Episodes at Level 1                
.-------------------------------------------------------
CFE1L000
CFE1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Episodes at Level 1                
.--------------------------------------------------------
KYE1L000
          MOVE      ZERO,EXIT
          GOTO      KYE1L999
.
KYE1L900  MOVE      ONE,EXIT
KYE1L999  RETURN
.---------------------------------------------------------
. Load WP files for : Episodes at Level 1                
.---------------------------------------------------------
WPE1L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Episodes at Level 1                
.---------------------------------------------------------
LME1L000
.---------------------------------------------------------
. Load for :     3 Episode                            
.---------------------------------------------------------
          PACK      KEY48,CCEBLV1,SP70
          MOVE      KEY48,CCEC2EKY
          MOVE      CCEC2EKY,CCEC2SKY
          STRIP     CCEC2SKY
          SETLPTR   CCEC2EKY,10
          CALL      RDCCEC2 
          IF        OVRCD=0
            CALL      RPCCEC2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPE1L000
          MOVE     ZERO,CCEC2CNT
          MOVE     ZERO,CCEC2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPE1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPE1L600
          MATCH    PRGID,SCPSPID
          GOTO     DPE1L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPE1L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPE1L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPE1L010,DPE1L010,DPE1L101,DPE1L102:
                            DPE1L103,DPE1L104,DPE1L105,DPE1L106:
                            DPE1L107,DPE1L108,DPE1L010,DPE1L010:
                            DPE1L010,DPE1L010,DPE1L109,DPE1L110:
                            DPE1L111,DPE1L112,DPE1L113,DPE1L010:
                            DPE1L010,DPE1L010
          GOTO      DPE1L010
.
DPE1L101
          PACK      CCEC2MKY,SP70,SP70
          CALL      UPTCCEC2
          IF        CCEC2END=0
            CALL      RKCCEC2 
            IF        OVRCD=0
              PACK      CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
              MATCH     CCEC2EKY,CCEC2MKY
              IF        @EQUAL
                MOVE      ZERO,CCEC2END
                ADD       ONE,CCEC2CNT
                CALL      UPTCCEC2
          CALL      GETEPS00
                MOVE      CCECEPS,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,CCEC2END
              ENDIF
            ELSE
              MOVE      ONE,CCEC2END
            ENDIF
          ENDIF
          IF        CCEC2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L102
          IF        CCEC2END=0
            MOVE      CCECHCD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L103
          IF        CCEC2END=0
            MOVE      CCECLV1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L104
          IF        CCEC2END=0
            MOVE      CCECLV2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L105
          IF        CCEC2END=0
            MOVE      CCECLV3,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L106
          IF        CCEC2END=0
            MOVE      CCECFTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L107
          IF        CCEC2END=0
            MOVE      CCECTTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L108
          IF        CCEC2END=0
            MOVE      CCECLOS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L109
          IF        CCEC2END=0
            MOVE      CCEPSUR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L110
          IF        CCEC2END=0
            MOVE      CCEPGIV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L111
          IF        CCEC2END=0
            MOVE      CCEPSEX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L112
          IF        CCEC2END=0
            MOVE      CCEPURN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L113
          IF        CCEC2END=0
            MOVE      CCEPAGEY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
DPE1L600
          MATCH    "CCEC2",NAMSSFFI
          GOTO     DPE1L605 IF NOT EQUAL
          GOTO     DPE1L999
DPE1L605
DPE1L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPE1L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     FPE1L105 IF NOT EQUAL
          PACK     KEY48,CCEC2SKY,SP70
          CALL     RDCCEC2  * Start
          IF       OVRCD=0
            CALL     RPCCEC2  * Start
          ENDIF
          CALL     DPE1L000
          GOTO     FPE1L999
FPE1L105
FPE1L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPE1L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     LPE1L105 IF NOT EQUAL
          PACK     KEY48,CCEC2SKY,Z70
          CALL     RSCCEC2  * End
          IF       OVRCD=1
            CALL     RPCCEC2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEC2SNO
            CALL     RPCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPE1L000
          GOTO     LPE1L999
LPE1L105
LPE1L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPE1L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     PPE1L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPE1L105
          CALL      RFTCCEC2
          BRANCH   OVRCD,PPE1L115
          MOVE      CCEC2MKY,KEY48 
          CALL      RSCCEC2 
PPE1L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCEC2SNO
            CALL     RPCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPE1L000
          GOTO     PPE1L999
PPE1L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEC2SNO
            CALL     RKCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPE1L999
PPE1L120
PPE1L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPE1L000
          MATCH    "CCEC2",NAMSSFFI
          GOTO     NPE1L115 IF NOT EQUAL
NPE1L105
          CALL     RKCCEC2 
          BRANCH   OVRCD,NPE1L110
          PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
          MATCH    CCEC2EKY,CCEC2MKY
          GOTO     NPE1L110 IF NOT EQUAL
          CALL     RPCCEC2 
          CALL     DPE1L000
          GOTO     NPE1L999
NPE1L110
          CALL     RPCCEC2 
          BEEP
          GOTO     NPE1L999
NPE1L115
NPE1L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTE1L000
CTE1L105
CTE1L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Episodes at Level 1                
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     3 Episode                            
.---------------------------------------------------------
UPTCCEC2
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCEC2FL1,KEY5;ANS
          IF        @OVER
            WRITE     CCEC2FL1,KEY5;SCPSROW,SCPSCOL,CCEC2MKY
          ELSE
            UPDATE    CCEC2FL1;SCPSROW,SCPSCOL,CCEC2MKY
          ENDIF
          RETURN
RDTCCEC2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCEC2FL1,KEY5;SCPSROW,SCPSCOL,CCEC2MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTCCEC2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      CCEC2FL1,KEY5;;
          READKS    CCEC2FL1;SCPSROW,SCPSCOL,CCEC2MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,CCEC2MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Episodes at Level 1                
.---------------------------------------------------------
DFE1L000
          BRANCH   ACCEPT,DFE1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFE1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFE1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFE1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFE1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFE1L010 IF NOT EQUAL
.
          CALL     PSE1L000 * Display Field
          GOTO     DFE1L010
DFE1L900
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE1L000
DFE1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Episodes at Level 1                
.---------------------------------------------------------
PSE1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSE1L999,PSE1L999,PSE1L999,PSE1L999:
                            PSE1L999,PSE1L999,PSE1L999,PSE1L999:
                            PSE1L999,PSE1L999,PSE1L999,PSE1L999:
                            PSE1L999,PSE1L999,PSE1L999,PSE1L999:
                            PSE1L999,PSE1L999,PSE1L999,PSE1L999:
                            PSE1L101,PSE1L102
          GOTO     PSE1L999
.
PSE1L101
          MOVE      COLHED1,VAR      
          CALL      DISPITEM
          GOTO     PSE1L999
.
PSE1L102
          MOVE      COLHED2,VAR      
          CALL      DISPITEM
          GOTO     PSE1L999
PSE1L999
          RETURN
.---------------------------------------------------------
. Selections for : Episodes at Level 1                
.---------------------------------------------------------
SFE1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFE1L001  BRANCH   ACCEPT,SFE1L020
.
SFE1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFE1L006,SFE1L101,SFE1L102,SFE1L006:
                            SFE1L006,SFE1L006,SFE1L006,SFE1L006:
                            SFE1L006,SFE1L006,SFE1L103,SFE1L104:
                            SFE1L105,SFE1L106,SFE1L006,SFE1L006:
                            SFE1L006,SFE1L006,SFE1L006,SFE1L107:
                            SFE1L006,SFE1L006
SFE1L006  BEEP
          GOTO     SFE1L005
SFE1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFE1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFE1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFE1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFE1L020,SFE1L020,SFE1L102,SFE1L020:
                            SFE1L020,SFE1L020,SFE1L020,SFE1L020:
                            SFE1L020,SFE1L020,SFE1L020,SFE1L020:
                            SFE1L020,SFE1L020,SFE1L020,SFE1L020:
                            SFE1L020,SFE1L020,SFE1L020,SFE1L020:
                            SFE1L020,SFE1L020
          GOTO     SFE1L020
SFE1L090  MOVE     ZERO,ACCEPT
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE1L000
          GOTO     SFE1L001
.
SFE1L101
          MOVE      ZERO,EXIT
          GOTO      SFE1L999
.
SFE1L102
          CALL      SELECTED
          BRANCH    EXIT,SFE1L001
          COMPARE   ONE,ACCEPT
          GOTO      SFE1L001 IF EQUAL
          CALL      RDTCCEC2
          IF        OVRCD=1
            BEEP
            GOTO      SFE1L001
          ENDIF
          MATCH     SP70,CCEC2MKY
          IF        @EQUAL
            BEEP
            GOTO      SFE1L001
          ENDIF
          MOVE      CCEC2MKY,KEY48 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELEPS00
          MOVE      "E1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCEC2
          IF        OVRCD=1
            CALL      FPE1L000
          ELSE
            MOVE      CCEC2MKY,KEY48 
            CALL      RSCCEC2 
            CALL      RPCCEC2 
            CALL      DPE1L000
          ENDIF
          GOTO     SFE1L001
.
SFE1L103
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NPE1L000
          GOTO     SFE1L001
.
SFE1L104
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PPE1L000
          GOTO     SFE1L001
.
SFE1L105
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE1L000
          GOTO     SFE1L001
.
SFE1L106
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LPE1L000
          GOTO     SFE1L001
.
SFE1L107
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFE1L999
SFE1L990  MOVE      ONE,EXIT * Exit Char Restart
SFE1L999  RETURN
.--------------------------------
. Screen - Episodes at Level 2                
.--------------------------------
SCE2L000
SCE2L100
          MOVE      "E2",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "13",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCE2L200
          CALL      CFE2L000 * Clear Fields
SCE2L300
          CALL      KYE2L000 * Enter Key Fields
          BRANCH    EXIT,SCE2L999,SCE2L999
SCE2L400
          CALL      WPE2L000 * Load any WP Details
SCE2L500
          CALL      LME2L000 * Load any Batch Details
SCE2L600
          CALL      DFE2L000 * Display Fields
SCE2L700
          CALL      SFE2L000 * Select Fields
          BRANCH    EXIT,SCE2L100,SCE2L100,SCE2L200
SCE2L800
SCE2L900
SCE2L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Episodes at Level 2                
.-------------------------------------------------------
CFE2L000
CFE2L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Episodes at Level 2                
.--------------------------------------------------------
KYE2L000
          MOVE      ZERO,EXIT
          GOTO      KYE2L999
.
KYE2L900  MOVE      ONE,EXIT
KYE2L999  RETURN
.---------------------------------------------------------
. Load WP files for : Episodes at Level 2                
.---------------------------------------------------------
WPE2L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Episodes at Level 2                
.---------------------------------------------------------
LME2L000
.---------------------------------------------------------
. Load for :     3 Episode                            
.---------------------------------------------------------
          PACK      KEY48,CCEBLV1,CCEDLV2,SP70
          MOVE      KEY48,CCEC2EKY
          MOVE      CCEC2EKY,CCEC2SKY
          STRIP     CCEC2SKY
          SETLPTR   CCEC2EKY,20
          CALL      RDCCEC2 
          IF        OVRCD=0
            CALL      RPCCEC2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPE2L000
          MOVE     ZERO,CCEC2CNT
          MOVE     ZERO,CCEC2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPE2L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPE2L600
          MATCH    PRGID,SCPSPID
          GOTO     DPE2L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPE2L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPE2L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPE2L010,DPE2L010,DPE2L101,DPE2L102:
                            DPE2L103,DPE2L104,DPE2L105,DPE2L106:
                            DPE2L107,DPE2L108,DPE2L010,DPE2L010:
                            DPE2L010,DPE2L010,DPE2L109,DPE2L110:
                            DPE2L111,DPE2L112,DPE2L113,DPE2L010:
                            DPE2L010,DPE2L010
          GOTO      DPE2L010
.
DPE2L101
          PACK      CCEC2MKY,SP70,SP70
          CALL      UPTCCEC2
          IF        CCEC2END=0
            CALL      RKCCEC2 
            IF        OVRCD=0
              PACK      CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
              MATCH     CCEC2EKY,CCEC2MKY
              IF        @EQUAL
                MOVE      ZERO,CCEC2END
                ADD       ONE,CCEC2CNT
                CALL      UPTCCEC2
          CALL      GETEPS00
                MOVE      CCECEPS,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,CCEC2END
              ENDIF
            ELSE
              MOVE      ONE,CCEC2END
            ENDIF
          ENDIF
          IF        CCEC2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L102
          IF        CCEC2END=0
            MOVE      CCECHCD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L103
          IF        CCEC2END=0
            MOVE      CCECLV1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L104
          IF        CCEC2END=0
            MOVE      CCECLV2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L105
          IF        CCEC2END=0
            MOVE      CCECLV3,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L106
          IF        CCEC2END=0
            MOVE      CCECFTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L107
          IF        CCEC2END=0
            MOVE      CCECTTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L108
          IF        CCEC2END=0
            MOVE      CCECLOS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L109
          IF        CCEC2END=0
            MOVE      CCEPSUR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L110
          IF        CCEC2END=0
            MOVE      CCEPGIV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L111
          IF        CCEC2END=0
            MOVE      CCEPSEX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L112
          IF        CCEC2END=0
            MOVE      CCEPURN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
.
DPE2L113
          IF        CCEC2END=0
            MOVE      CCEPAGEY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE2L010
DPE2L600
          MATCH    "CCEC2",NAMSSFFI
          GOTO     DPE2L605 IF NOT EQUAL
          GOTO     DPE2L999
DPE2L605
DPE2L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPE2L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     FPE2L105 IF NOT EQUAL
          PACK     KEY48,CCEC2SKY,SP70
          CALL     RDCCEC2  * Start
          IF       OVRCD=0
            CALL     RPCCEC2  * Start
          ENDIF
          CALL     DPE2L000
          GOTO     FPE2L999
FPE2L105
FPE2L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPE2L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     LPE2L105 IF NOT EQUAL
          PACK     KEY48,CCEC2SKY,Z70
          CALL     RSCCEC2  * End
          IF       OVRCD=1
            CALL     RPCCEC2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEC2SNO
            CALL     RPCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPE2L000
          GOTO     LPE2L999
LPE2L105
LPE2L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPE2L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     PPE2L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPE2L105
          CALL      RFTCCEC2
          BRANCH   OVRCD,PPE2L115
          MOVE      CCEC2MKY,KEY48 
          CALL      RSCCEC2 
PPE2L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCEC2SNO
            CALL     RPCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPE2L000
          GOTO     PPE2L999
PPE2L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEC2SNO
            CALL     RKCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPE2L999
PPE2L120
PPE2L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPE2L000
          MATCH    "CCEC2",NAMSSFFI
          GOTO     NPE2L115 IF NOT EQUAL
NPE2L105
          CALL     RKCCEC2 
          BRANCH   OVRCD,NPE2L110
          PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
          MATCH    CCEC2EKY,CCEC2MKY
          GOTO     NPE2L110 IF NOT EQUAL
          CALL     RPCCEC2 
          CALL     DPE2L000
          GOTO     NPE2L999
NPE2L110
          CALL     RPCCEC2 
          BEEP
          GOTO     NPE2L999
NPE2L115
NPE2L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTE2L000
CTE2L105
CTE2L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Episodes at Level 2                
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Episodes at Level 2                
.---------------------------------------------------------
DFE2L000
          BRANCH   ACCEPT,DFE2L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFE2L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFE2L900
          MATCH    PRGID,SCPSPID
          GOTO     DFE2L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFE2L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFE2L010 IF NOT EQUAL
.
          CALL     PSE2L000 * Display Field
          GOTO     DFE2L010
DFE2L900
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE2L000
DFE2L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Episodes at Level 2                
.---------------------------------------------------------
PSE2L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSE2L999,PSE2L999,PSE2L999,PSE2L999:
                            PSE2L999,PSE2L999,PSE2L999,PSE2L999:
                            PSE2L999,PSE2L999,PSE2L999,PSE2L999:
                            PSE2L999,PSE2L999,PSE2L999,PSE2L999:
                            PSE2L999,PSE2L999,PSE2L999,PSE2L999:
                            PSE2L101,PSE2L102
          GOTO     PSE2L999
.
PSE2L101
          MOVE      COLHED1,VAR      
          CALL      DISPITEM
          GOTO     PSE2L999
.
PSE2L102
          MOVE      COLHED2,VAR      
          CALL      DISPITEM
          GOTO     PSE2L999
PSE2L999
          RETURN
.---------------------------------------------------------
. Selections for : Episodes at Level 2                
.---------------------------------------------------------
SFE2L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFE2L001  BRANCH   ACCEPT,SFE2L020
.
SFE2L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFE2L006,SFE2L101,SFE2L102,SFE2L006:
                            SFE2L006,SFE2L006,SFE2L006,SFE2L006:
                            SFE2L006,SFE2L006,SFE2L103,SFE2L104:
                            SFE2L105,SFE2L106,SFE2L006,SFE2L006:
                            SFE2L006,SFE2L006,SFE2L006,SFE2L107:
                            SFE2L006,SFE2L006
SFE2L006  BEEP
          GOTO     SFE2L005
SFE2L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFE2L090
          MATCH    PRGID,SCSLPID
          GOTO     SFE2L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFE2L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFE2L020,SFE2L020,SFE2L102,SFE2L020:
                            SFE2L020,SFE2L020,SFE2L020,SFE2L020:
                            SFE2L020,SFE2L020,SFE2L020,SFE2L020:
                            SFE2L020,SFE2L020,SFE2L020,SFE2L020:
                            SFE2L020,SFE2L020,SFE2L020,SFE2L020:
                            SFE2L020,SFE2L020
          GOTO     SFE2L020
SFE2L090  MOVE     ZERO,ACCEPT
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE2L000
          GOTO     SFE2L001
.
SFE2L101
          MOVE      ZERO,EXIT
          GOTO      SFE2L999
.
SFE2L102
          CALL      SELECTED
          BRANCH    EXIT,SFE2L001
          COMPARE   ONE,ACCEPT
          GOTO      SFE2L001 IF EQUAL
          CALL      RDTCCEC2
          IF        OVRCD=1
            BEEP
            GOTO      SFE2L001
          ENDIF
          MATCH     SP70,CCEC2MKY
          IF        @EQUAL
            BEEP
            GOTO      SFE2L001
          ENDIF
          MOVE      CCEC2MKY,KEY48 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELEPS00
          MOVE      "E2",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCEC2
          IF        OVRCD=1
            CALL      FPE2L000
          ELSE
            MOVE      CCEC2MKY,KEY48 
            CALL      RSCCEC2 
            CALL      RPCCEC2 
            CALL      DPE2L000
          ENDIF
          GOTO     SFE2L001
.
SFE2L103
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NPE1L000
          GOTO     SFE2L001
.
SFE2L104
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PPE1L000
          GOTO     SFE2L001
.
SFE2L105
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE1L000
          GOTO     SFE2L001
.
SFE2L106
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LPE1L000
          GOTO     SFE2L001
.
SFE2L107
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFE2L999
SFE2L990  MOVE      ONE,EXIT * Exit Char Restart
SFE2L999  RETURN
.--------------------------------
. Screen - Episodes at Level 3                
.--------------------------------
SCE3L000
SCE3L100
          MOVE      "E3",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "13",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCE3L200
          CALL      CFE3L000 * Clear Fields
SCE3L300
          CALL      KYE3L000 * Enter Key Fields
          BRANCH    EXIT,SCE3L999,SCE3L999
SCE3L400
          CALL      WPE3L000 * Load any WP Details
SCE3L500
          CALL      LME3L000 * Load any Batch Details
SCE3L600
          CALL      DFE3L000 * Display Fields
SCE3L700
          CALL      SFE3L000 * Select Fields
          BRANCH    EXIT,SCE3L100,SCE3L100,SCE3L200
SCE3L800
SCE3L900
SCE3L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Episodes at Level 3                
.-------------------------------------------------------
CFE3L000
CFE3L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Episodes at Level 3                
.--------------------------------------------------------
KYE3L000
          MOVE      ZERO,EXIT
          GOTO      KYE3L999
.
KYE3L900  MOVE      ONE,EXIT
KYE3L999  RETURN
.---------------------------------------------------------
. Load WP files for : Episodes at Level 3                
.---------------------------------------------------------
WPE3L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Episodes at Level 3                
.---------------------------------------------------------
LME3L000
.---------------------------------------------------------
. Load for :     3 Episode                            
.---------------------------------------------------------
          PACK      KEY48,CCEBLV1,CCEDLV2,CCEELV3,SP70
          MOVE      KEY48,CCEC2EKY
          MOVE      CCEC2EKY,CCEC2SKY
          STRIP     CCEC2SKY
          SETLPTR   CCEC2EKY,30
          CALL      RDCCEC2 
          IF        OVRCD=0
            CALL      RPCCEC2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPE3L000
          MOVE     ZERO,CCEC2CNT
          MOVE     ZERO,CCEC2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPE3L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPE3L600
          MATCH    PRGID,SCPSPID
          GOTO     DPE3L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPE3L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPE3L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPE3L010,DPE3L010,DPE3L101,DPE3L102:
                            DPE3L103,DPE3L104,DPE3L105,DPE3L106:
                            DPE3L107,DPE3L108,DPE3L010,DPE3L010:
                            DPE3L010,DPE3L010,DPE3L109,DPE3L110:
                            DPE3L111,DPE3L112,DPE3L113,DPE3L010:
                            DPE3L010,DPE3L010
          GOTO      DPE3L010
.
DPE3L101
          PACK      CCEC2MKY,SP70,SP70
          CALL      UPTCCEC2
          IF        CCEC2END=0
            CALL      RKCCEC2 
            IF        OVRCD=0
              PACK      CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
              MATCH     CCEC2EKY,CCEC2MKY
              IF        @EQUAL
                MOVE      ZERO,CCEC2END
                ADD       ONE,CCEC2CNT
                CALL      UPTCCEC2
          CALL      GETEPS00
                MOVE      CCECEPS,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,CCEC2END
              ENDIF
            ELSE
              MOVE      ONE,CCEC2END
            ENDIF
          ENDIF
          IF        CCEC2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L102
          IF        CCEC2END=0
            MOVE      CCECHCD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L103
          IF        CCEC2END=0
            MOVE      CCECLV1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L104
          IF        CCEC2END=0
            MOVE      CCECLV2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L105
          IF        CCEC2END=0
            MOVE      CCECLV3,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L106
          IF        CCEC2END=0
            MOVE      CCECFTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L107
          IF        CCEC2END=0
            MOVE      CCECTTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L108
          IF        CCEC2END=0
            MOVE      CCECLOS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L109
          IF        CCEC2END=0
            MOVE      CCEPSUR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L110
          IF        CCEC2END=0
            MOVE      CCEPGIV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L111
          IF        CCEC2END=0
            MOVE      CCEPSEX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L112
          IF        CCEC2END=0
            MOVE      CCEPURN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
.
DPE3L113
          IF        CCEC2END=0
            MOVE      CCEPAGEY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE3L010
DPE3L600
          MATCH    "CCEC2",NAMSSFFI
          GOTO     DPE3L605 IF NOT EQUAL
          GOTO     DPE3L999
DPE3L605
DPE3L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPE3L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     FPE3L105 IF NOT EQUAL
          PACK     KEY48,CCEC2SKY,SP70
          CALL     RDCCEC2  * Start
          IF       OVRCD=0
            CALL     RPCCEC2  * Start
          ENDIF
          CALL     DPE3L000
          GOTO     FPE3L999
FPE3L105
FPE3L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPE3L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     LPE3L105 IF NOT EQUAL
          PACK     KEY48,CCEC2SKY,Z70
          CALL     RSCCEC2  * End
          IF       OVRCD=1
            CALL     RPCCEC2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEC2SNO
            CALL     RPCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPE3L000
          GOTO     LPE3L999
LPE3L105
LPE3L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPE3L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     PPE3L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPE3L105
          CALL      RFTCCEC2
          BRANCH   OVRCD,PPE3L115
          MOVE      CCEC2MKY,KEY48 
          CALL      RSCCEC2 
PPE3L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCEC2SNO
            CALL     RPCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPE3L000
          GOTO     PPE3L999
PPE3L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEC2SNO
            CALL     RKCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPE3L999
PPE3L120
PPE3L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPE3L000
          MATCH    "CCEC2",NAMSSFFI
          GOTO     NPE3L115 IF NOT EQUAL
NPE3L105
          CALL     RKCCEC2 
          BRANCH   OVRCD,NPE3L110
          PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
          MATCH    CCEC2EKY,CCEC2MKY
          GOTO     NPE3L110 IF NOT EQUAL
          CALL     RPCCEC2 
          CALL     DPE3L000
          GOTO     NPE3L999
NPE3L110
          CALL     RPCCEC2 
          BEEP
          GOTO     NPE3L999
NPE3L115
NPE3L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTE3L000
CTE3L105
CTE3L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Episodes at Level 3                
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Episodes at Level 3                
.---------------------------------------------------------
DFE3L000
          BRANCH   ACCEPT,DFE3L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFE3L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFE3L900
          MATCH    PRGID,SCPSPID
          GOTO     DFE3L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFE3L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFE3L010 IF NOT EQUAL
.
          CALL     PSE3L000 * Display Field
          GOTO     DFE3L010
DFE3L900
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE3L000
DFE3L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Episodes at Level 3                
.---------------------------------------------------------
PSE3L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSE3L999,PSE3L999,PSE3L999,PSE3L999:
                            PSE3L999,PSE3L999,PSE3L999,PSE3L999:
                            PSE3L999,PSE3L999,PSE3L999,PSE3L999:
                            PSE3L999,PSE3L999,PSE3L999,PSE3L999:
                            PSE3L999,PSE3L999,PSE3L999,PSE3L999:
                            PSE3L101,PSE3L102
          GOTO     PSE3L999
.
PSE3L101
          MOVE      COLHED1,VAR      
          CALL      DISPITEM
          GOTO     PSE3L999
.
PSE3L102
          MOVE      COLHED2,VAR      
          CALL      DISPITEM
          GOTO     PSE3L999
PSE3L999
          RETURN
.---------------------------------------------------------
. Selections for : Episodes at Level 3                
.---------------------------------------------------------
SFE3L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFE3L001  BRANCH   ACCEPT,SFE3L020
.
SFE3L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFE3L006,SFE3L101,SFE3L102,SFE3L006:
                            SFE3L006,SFE3L006,SFE3L006,SFE3L006:
                            SFE3L006,SFE3L006,SFE3L103,SFE3L104:
                            SFE3L105,SFE3L106,SFE3L006,SFE3L006:
                            SFE3L006,SFE3L006,SFE3L006,SFE3L107:
                            SFE3L006,SFE3L006
SFE3L006  BEEP
          GOTO     SFE3L005
SFE3L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFE3L090
          MATCH    PRGID,SCSLPID
          GOTO     SFE3L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFE3L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFE3L020,SFE3L020,SFE3L102,SFE3L020:
                            SFE3L020,SFE3L020,SFE3L020,SFE3L020:
                            SFE3L020,SFE3L020,SFE3L020,SFE3L020:
                            SFE3L020,SFE3L020,SFE3L020,SFE3L020:
                            SFE3L020,SFE3L020,SFE3L020,SFE3L020:
                            SFE3L020,SFE3L020
          GOTO     SFE3L020
SFE3L090  MOVE     ZERO,ACCEPT
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE3L000
          GOTO     SFE3L001
.
SFE3L101
          MOVE      ZERO,EXIT
          GOTO      SFE3L999
.
SFE3L102
          CALL      SELECTED
          BRANCH    EXIT,SFE3L001
          COMPARE   ONE,ACCEPT
          GOTO      SFE3L001 IF EQUAL
          CALL      RDTCCEC2
          IF        OVRCD=1
            BEEP
            GOTO      SFE3L001
          ENDIF
          MATCH     SP70,CCEC2MKY
          IF        @EQUAL
            BEEP
            GOTO      SFE3L001
          ENDIF
          MOVE      CCEC2MKY,KEY48 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELEPS00
          MOVE      "E3",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCEC2
          IF        OVRCD=1
            CALL      FPE3L000
          ELSE
            MOVE      CCEC2MKY,KEY48 
            CALL      RSCCEC2 
            CALL      RPCCEC2 
            CALL      DPE3L000
          ENDIF
          GOTO     SFE3L001
.
SFE3L103
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NPE1L000
          GOTO     SFE3L001
.
SFE3L104
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PPE1L000
          GOTO     SFE3L001
.
SFE3L105
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE1L000
          GOTO     SFE3L001
.
SFE3L106
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LPE1L000
          GOTO     SFE3L001
.
SFE3L107
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFE3L999
SFE3L990  MOVE      ONE,EXIT * Exit Char Restart
SFE3L999  RETURN
.--------------------------------
. Screen - Split Cost Details                 
.--------------------------------
SCECL000
SCECL100
          MOVE      "EC",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 3",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCECL200
          CALL      CFECL000 * Clear Fields
SCECL300
          CALL      KYECL000 * Enter Key Fields
          BRANCH    EXIT,SCECL999,SCECL999
SCECL400
          CALL      WPECL000 * Load any WP Details
SCECL500
          CALL      LMECL000 * Load any Batch Details
SCECL600
          CALL      DFECL000 * Display Fields
SCECL700
          CALL      SFECL000 * Select Fields
          BRANCH    EXIT,SCECL100,SCECL100,SCECL200
SCECL800
SCECL900
SCECL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Split Cost Details                 
.-------------------------------------------------------
CFECL000
CFECL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Split Cost Details                 
.--------------------------------------------------------
KYECL000
          MOVE      ZERO,EXIT
          GOTO      KYECL999
.
KYECL900  MOVE      ONE,EXIT
KYECL999  RETURN
.---------------------------------------------------------
. Load WP files for : Split Cost Details                 
.---------------------------------------------------------
WPECL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Split Cost Details                 
.---------------------------------------------------------
LMECL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Split Cost Details                 
.---------------------------------------------------------
DFECL000
          BRANCH   ACCEPT,DFECL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFECL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFECL900
          MATCH    PRGID,SCPSPID
          GOTO     DFECL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFECL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFECL010 IF NOT EQUAL
.
          CALL     PSECL000 * Display Field
          GOTO     DFECL010
DFECL900
DFECL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Split Cost Details                 
.---------------------------------------------------------
PSECL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSECL999,PSECL999,PSECL999,PSECL999:
                           PSECL999,PSECL101,PSECL102,PSECL103:
                            PSECL104,PSECL105,PSECL106,PSECL107:
                            PSECL108,PSECL109,PSECL110,PSECL111:
                            PSECL112,PSECL113,PSECL114,PSECL115:
                            PSECL116,PSECL117,PSECL118,PSECL119:
                            PSECL120,PSECL121,PSECL122,PSECL123:
                            PSECL124,PSECL125,PSECL126,PSECL127:
                            PSECL128,PSECL129,PSECL130,PSECL131:
                            PSECL132,PSECL133,PSECL134,PSECL135:
                            PSECL136,PSECL137,PSECL138,PSECL139:
                            PSECL140,PSECL141,PSECL142,PSECL143:
                            PSECL144,PSECL145,PSECL146,PSECL147:
                            PSECL148,PSECL149,PSECL150,PSECL151:
                            PSECL152,PSECL153,PSECL154,PSECL155:
                            PSECL156,PSECL157,PSECL158,PSECL999:
                           PSECL999,PSECL999,PSECL999,PSECL999:
                           PSECL999,PSECL159,PSECL160,PSECL161:
                            PSECL162,PSECL163,PSECL164,PSECL999:
                           PSECL999,PSECL999,PSECL999,PSECL165:
                            PSECL166,PSECL167,PSECL168,PSECL169:
                            PSECL170,PSECL171,PSECL172,PSECL999:
                           PSECL999,PSECL173,PSECL174,PSECL175:
                            PSECL176,PSECL177
          GOTO     PSECL999
.
PSECL101
          MOVE      CCEPHCD,VAR      
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL102
          MOVE      CCEPEPS,VAR      
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPCOM,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL104
          MOVE      CCEPURN,VAR      
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL105
          UNPACK    CCEPSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL106
          UNPACK    CCEPLTD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL107
          MOVE      CCEPLOS,VAR      
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPINPT,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPDAY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL110
          MOVE      CCEPVIST,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL111
          MOVE      CCEPSEX,VAR      
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL112
          UNPACK    CCEPDOB,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL113
          MOVE      CCEPAGEY,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL114
          MOVE      CCEPAGEM,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL115
          MOVE      CCEPAGED,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL116
          MOVE      CCEPCOB,VAR      
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL117
          MOVE      CCEPREL,VAR      
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL118
          UNPACK    CCEPDDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL119
          MOVE      CCEPDSTA,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL120
          MOVE      CCEPDDES,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL121
          MOVE      CCEPDMBS,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL122
          MOVE      CCEPDDPT,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL123
          MOVE      CCEPDSER,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL124
          MOVE      CCEPMDCC,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL125
          MOVE      CCEPDRGC,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL126
          UNPACK    CCEPADAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL127
          MOVE      CCEPAWAR,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL128
          MOVE      CCEPASRC,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL129
          MOVE      CCEPACLS,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL130
          MOVE      CCEPACAR,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL131
          MOVE      CCEPADPT,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL132
          MOVE      CCEPASER,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL133
          MOVE      CCEPARDC,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL134
          MOVE      CCEPATDC,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL135
          MOVE      CCEPAADC,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL136
          MOVE      CCEPDADC,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL137
          MOVE      CCEPAHFD,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL138
          MOVE      CCEPAHTB,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL139
          MOVE      CCEPAMBS,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL140
          MOVE      CCEPOPCL,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL141
          MOVE      CCEPPDIA,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL142
          MOVE      CCEPSDIA,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL143
          MOVE      CCEPPOPP,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL144
          MOVE      CCEPSOPP,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL145
          MOVE      CCEPDWAR,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL146
          MOVE      CCEPSUR,VAR      
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL147
          MOVE      CCEPGIV,VAR      
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL148
          MOVE      CCEPPMBS,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL149
          MOVE      CCEPSMBS,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL150
          MOVE      CCEPMU1,VAR      
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL151
          MOVE      CCEPMU2,VAR      
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL152
          MOVE      CCEPMU3,VAR      
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL153
          MOVE      CCEPMU4,VAR      
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL154
          MOVE      CCEPMU5,VAR      
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL155
          MOVE      CCEPMU6,VAR      
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL156
          MOVE      CCEPMU7,VAR      
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL157
          MOVE      CCEPPCD,VAR      
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL158
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPEXC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL159
          MOVE      FROMCOST,VAR     
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL160
          MOVE      CSTFDR,VAR       
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL161
          MOVE      CSTFID,VAR       
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL162
          MOVE      CSTVDR,VAR       
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL163
          MOVE      CSTVID,VAR       
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL164
          MOVE      CSTTOT,VAR       
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL165
          MOVE      TOCOST,VAR       
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL166
          MOVE      INCFDR,VAR       
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL167
          MOVE      INCFID,VAR       
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL168
          MOVE      INCVDR,VAR       
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL169
          MOVE      INCVID,VAR       
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL170
          MOVE      INCTOT,VAR       
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL171
          MOVE      COLHED1,VAR      
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL172
          MOVE      COLHED2,VAR      
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL173
          MOVE      VARFDR,VAR       
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL174
          MOVE      VARFID,VAR       
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL175
          MOVE      VARVDR,VAR       
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL176
          MOVE      VARVID,VAR       
          CALL      DISPITEM
          GOTO     PSECL999
.
PSECL177
          MOVE      VARTOT,VAR       
          CALL      DISPITEM
          GOTO     PSECL999
PSECL999
          RETURN
.---------------------------------------------------------
. Selections for : Split Cost Details                 
.---------------------------------------------------------
SFECL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFECL001  BRANCH   ACCEPT,SFECL020
.
SFECL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFECL006,SFECL101,SFECL102,SFECL006:
                           SFECL006,SFECL006,SFECL006,SFECL006:
                            SFECL006,SFECL006,SFECL006,SFECL006:
                            SFECL006,SFECL006,SFECL006,SFECL006:
                            SFECL006,SFECL006,SFECL006,SFECL006:
                            SFECL006,SFECL006,SFECL006,SFECL006:
                            SFECL006,SFECL006,SFECL006,SFECL006:
                            SFECL006,SFECL006,SFECL006,SFECL006:
                            SFECL006,SFECL006,SFECL006,SFECL006:
                            SFECL006,SFECL006,SFECL006,SFECL006:
                            SFECL006,SFECL006,SFECL006,SFECL006:
                            SFECL006,SFECL006,SFECL006,SFECL006:
                            SFECL006,SFECL006,SFECL006,SFECL006:
                            SFECL006,SFECL006,SFECL006,SFECL006:
                            SFECL006,SFECL006,SFECL006,SFECL006:
                            SFECL006,SFECL006,SFECL006,SFECL006:
                           SFECL006,SFECL006,SFECL006,SFECL006:
                           SFECL006,SFECL006,SFECL006,SFECL006:
                            SFECL006,SFECL006,SFECL006,SFECL006:
                           SFECL006,SFECL006,SFECL006,SFECL006:
                            SFECL006,SFECL006,SFECL006,SFECL006:
                            SFECL006,SFECL006,SFECL006,SFECL006:
                           SFECL006,SFECL006,SFECL006,SFECL006:
                            SFECL006,SFECL006
SFECL006  BEEP
          GOTO     SFECL005
SFECL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFECL090
          MATCH    PRGID,SCSLPID
          GOTO     SFECL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFECL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFECL020,SFECL020,SFECL020,SFECL020:
                           SFECL020,SFECL020,SFECL020,SFECL020:
                            SFECL020,SFECL020,SFECL020,SFECL020:
                            SFECL020,SFECL020,SFECL020,SFECL020:
                            SFECL020,SFECL020,SFECL020,SFECL020:
                            SFECL020,SFECL020,SFECL020,SFECL020:
                            SFECL020,SFECL020,SFECL020,SFECL020:
                            SFECL020,SFECL020,SFECL020,SFECL020:
                            SFECL020,SFECL020,SFECL020,SFECL020:
                            SFECL020,SFECL020,SFECL020,SFECL020:
                            SFECL020,SFECL020,SFECL020,SFECL020:
                            SFECL020,SFECL020,SFECL020,SFECL020:
                            SFECL020,SFECL020,SFECL020,SFECL020:
                            SFECL020,SFECL020,SFECL020,SFECL020:
                            SFECL020,SFECL020,SFECL020,SFECL020:
                            SFECL020,SFECL020,SFECL020,SFECL020:
                           SFECL020,SFECL020,SFECL020,SFECL020:
                           SFECL020,SFECL020,SFECL020,SFECL020:
                            SFECL020,SFECL020,SFECL020,SFECL020:
                           SFECL020,SFECL020,SFECL020,SFECL020:
                            SFECL020,SFECL020,SFECL020,SFECL020:
                            SFECL020,SFECL020,SFECL020,SFECL020:
                           SFECL020,SFECL020,SFECL020,SFECL020:
                            SFECL020,SFECL020
          GOTO     SFECL020
SFECL090  MOVE     ZERO,ACCEPT
          GOTO     SFECL001
.
SFECL101
          MOVE      ZERO,EXIT
          GOTO      SFECL999
.
SFECL102
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFECL999
SFECL990  MOVE      ONE,EXIT * Exit Char Restart
SFECL999  RETURN
.--------------------------------
. Screen - Episode Details                    
.--------------------------------
SCEDL000
SCEDL100
          MOVE      "ED",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 3",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCEDL200
          CALL      CFEDL000 * Clear Fields
SCEDL300
          CALL      KYEDL000 * Enter Key Fields
          BRANCH    EXIT,SCEDL999,SCEDL999
SCEDL400
          CALL      WPEDL000 * Load any WP Details
SCEDL500
          CALL      LMEDL000 * Load any Batch Details
SCEDL600
          CALL      DFEDL000 * Display Fields
SCEDL700
          CALL      SFEDL000 * Select Fields
          BRANCH    EXIT,SCEDL100,SCEDL100,SCEDL200
SCEDL800
SCEDL900
SCEDL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Episode Details                    
.-------------------------------------------------------
CFEDL000
CFEDL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Episode Details                    
.--------------------------------------------------------
KYEDL000
          MOVE      ZERO,EXIT
          GOTO      KYEDL999
.
KYEDL900  MOVE      ONE,EXIT
KYEDL999  RETURN
.---------------------------------------------------------
. Load WP files for : Episode Details                    
.---------------------------------------------------------
WPEDL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Episode Details                    
.---------------------------------------------------------
LMEDL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Episode Details                    
.---------------------------------------------------------
DFEDL000
          BRANCH   ACCEPT,DFEDL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFEDL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFEDL900
          MATCH    PRGID,SCPSPID
          GOTO     DFEDL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFEDL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFEDL010 IF NOT EQUAL
.
          CALL     PSEDL000 * Display Field
          GOTO     DFEDL010
DFEDL900
DFEDL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Episode Details                    
.---------------------------------------------------------
PSEDL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSEDL999,PSEDL999,PSEDL999,PSEDL999:
                           PSEDL999,PSEDL101,PSEDL102,PSEDL103:
                            PSEDL104,PSEDL105,PSEDL106,PSEDL107:
                            PSEDL108,PSEDL109,PSEDL110,PSEDL111:
                            PSEDL112,PSEDL113,PSEDL114,PSEDL115:
                            PSEDL116,PSEDL117,PSEDL118,PSEDL119:
                            PSEDL120,PSEDL121,PSEDL122,PSEDL123:
                            PSEDL124,PSEDL125,PSEDL126,PSEDL127:
                            PSEDL128,PSEDL129,PSEDL130,PSEDL131:
                            PSEDL132,PSEDL133,PSEDL134,PSEDL135:
                            PSEDL136,PSEDL137,PSEDL138,PSEDL139:
                            PSEDL140,PSEDL141,PSEDL142,PSEDL143:
                            PSEDL144,PSEDL145,PSEDL146,PSEDL147:
                            PSEDL148,PSEDL149,PSEDL150,PSEDL151:
                            PSEDL152,PSEDL153,PSEDL154,PSEDL155:
                            PSEDL156,PSEDL157,PSEDL158
          GOTO     PSEDL999
.
PSEDL101
          MOVE      CCEPHCD,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL102
          MOVE      CCEPEPS,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPCOM,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL104
          MOVE      CCEPURN,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL105
          UNPACK    CCEPSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL106
          UNPACK    CCEPLTD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL107
          MOVE      CCEPLOS,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPINPT,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPDAY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL110
          MOVE      CCEPVIST,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL111
          MOVE      CCEPSEX,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL112
          UNPACK    CCEPDOB,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL113
          MOVE      CCEPAGEY,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL114
          MOVE      CCEPAGEM,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL115
          MOVE      CCEPAGED,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL116
          MOVE      CCEPCOB,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL117
          MOVE      CCEPREL,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL118
          UNPACK    CCEPDDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL119
          MOVE      CCEPDSTA,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL120
          MOVE      CCEPDDES,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL121
          MOVE      CCEPDMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL122
          MOVE      CCEPDDPT,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL123
          MOVE      CCEPDSER,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL124
          MOVE      CCEPMDCC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL125
          MOVE      CCEPDRGC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL126
          UNPACK    CCEPADAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL127
          MOVE      CCEPAWAR,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL128
          MOVE      CCEPASRC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL129
          MOVE      CCEPACLS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL130
          MOVE      CCEPACAR,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL131
          MOVE      CCEPADPT,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL132
          MOVE      CCEPASER,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL133
          MOVE      CCEPARDC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL134
          MOVE      CCEPATDC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL135
          MOVE      CCEPAADC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL136
          MOVE      CCEPDADC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL137
          MOVE      CCEPAHFD,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL138
          MOVE      CCEPAHTB,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL139
          MOVE      CCEPAMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL140
          MOVE      CCEPOPCL,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL141
          MOVE      CCEPPDIA,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL142
          MOVE      CCEPSDIA,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL143
          MOVE      CCEPPOPP,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL144
          MOVE      CCEPSOPP,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL145
          MOVE      CCEPDWAR,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL146
          MOVE      CCEPSUR,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL147
          MOVE      CCEPGIV,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL148
          MOVE      CCEPPMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL149
          MOVE      CCEPSMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL150
          MOVE      CCEPMU1,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL151
          MOVE      CCEPMU2,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL152
          MOVE      CCEPMU3,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL153
          MOVE      CCEPMU4,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL154
          MOVE      CCEPMU5,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL155
          MOVE      CCEPMU6,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL156
          MOVE      CCEPMU7,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL157
          MOVE      CCEPPCD,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL158
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPEXC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
PSEDL999
          RETURN
.---------------------------------------------------------
. Selections for : Episode Details                    
.---------------------------------------------------------
SFEDL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFEDL001  BRANCH   ACCEPT,SFEDL020
.
SFEDL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFEDL006,SFEDL101,SFEDL102,SFEDL006:
                           SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006
SFEDL006  BEEP
          GOTO     SFEDL005
SFEDL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFEDL090
          MATCH    PRGID,SCSLPID
          GOTO     SFEDL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFEDL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                           SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020
          GOTO     SFEDL020
SFEDL090  MOVE     ZERO,ACCEPT
          GOTO     SFEDL001
.
SFEDL101
          MOVE      ZERO,EXIT
          GOTO      SFEDL999
.
SFEDL102
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFEDL999
SFEDL990  MOVE      ONE,EXIT * Exit Char Restart
SFEDL999  RETURN
.--------------------------------
. Screen - Episode Summary                    
.--------------------------------
SCESL000
SCESL100
          MOVE      "ES",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCESL200
          CALL      CFESL000 * Clear Fields
SCESL300
          CALL      KYESL000 * Enter Key Fields
          BRANCH    EXIT,SCESL999,SCESL999
SCESL400
          CALL      WPESL000 * Load any WP Details
SCESL500
          CALL      LMESL000 * Load any Batch Details
SCESL600
          CALL      DFESL000 * Display Fields
SCESL700
          CALL      SFESL000 * Select Fields
          BRANCH    EXIT,SCESL100,SCESL100,SCESL200
SCESL800
SCESL900
SCESL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Episode Summary                    
.-------------------------------------------------------
CFESL000
CFESL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Episode Summary                    
.--------------------------------------------------------
KYESL000
          MOVE      ZERO,EXIT
          GOTO      KYESL999
.
KYESL900  MOVE      ONE,EXIT
KYESL999  RETURN
.---------------------------------------------------------
. Load WP files for : Episode Summary                    
.---------------------------------------------------------
WPESL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Episode Summary                    
.---------------------------------------------------------
LMESL000
.---------------------------------------------------------
. Load for :    70 Date of Service                    
.---------------------------------------------------------
          PACK      KEY31,CCECHCD,CCECEPS,SP70
          MOVE      KEY31,CCUP2EKY
          MOVE      CCUP2EKY,CCUP2SKY
          STRIP     CCUP2SKY
          SETLPTR   CCUP2EKY,18
          CALL      RDCCUP2 
          IF        OVRCD=0
            CALL      RPCCUP2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPESL000
          MOVE     ZERO,CCUP2CNT
          MOVE     ZERO,CCUP2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPESL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPESL600
          MATCH    PRGID,SCPSPID
          GOTO     DPESL600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPESL600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPESL010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                           DPESL010,DPESL101,DPESL102,DPESL103:
                            DPESL104,DPESL105,DPESL106,DPESL107:
                            DPESL108,DPESL109,DPESL110,DPESL111:
                            DPESL112,DPESL113,DPESL114,DPESL115:
                            DPESL116,DPESL117,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010
          GOTO      DPESL010
.
DPESL101
          IF        CCUP2END=0
            CALL      RPCCUP2 
            IF        OVRCD=0
              PACK      CCUP2MKY,CCUPHCD,CCUPENC,CCUPDAT,CCUPTIM                                                
              MATCH     CCUP2EKY,CCUP2MKY
              IF        @EQUAL
                MOVE      ZERO,CCUP2END
                ADD       ONE,CCUP2CNT
          CALL      PCDDET00
                UNPACK    CCUPDAT,CCENT,CYEAR,CMON,CDAY           
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
              ELSE
                MOVE      ONE,CCUP2END
              ENDIF
            ELSE
              MOVE      ONE,CCUP2END
            ENDIF
          ENDIF
          IF        CCUP2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL102
          IF        CCUP2END=0
            MOVE      CCUPRUN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL103
          IF        CCUP2END=0
            MOVE      CCUPREC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL104
          IF        CCUP2END=0
            MOVE      CCUPDPT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL105
          IF        CCUP2END=0
            MOVE      CCUPPCD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL106
          IF        CCUP2END=0
            MOVE      CCUPURN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL107
          IF        CCUP2END=0
            MOVE      CCPDDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL108
          IF        CCUP2END=0
            MOVE      CCUPTIM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL109
          IF        CCUP2END=0
            MOVE      CCUPQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL110
          IF        CCUP2END=0
            MOVE      CCUPCHG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL111
          IF        CCUP2END=0
            MOVE      CCUPCL1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL112
          IF        CCUP2END=0
            MOVE      CCUPCL2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL113
          IF        CCUP2END=0
            MOVE      CCUPCL3,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL114
          IF        CCUP2END=0
            MOVE      CCUPCL4,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL115
          IF        CCUP2END=0
            MOVE      CCUPCL5,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL116
          IF        CCUP2END=0
            MOVE      COST1AMT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL117
          IF        CCUP2END=0
            MOVE      COST2AMT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
DPESL600
          MATCH    "CCUP2",NAMSSFFI
          GOTO     DPESL605 IF NOT EQUAL
          GOTO     DPESL999
DPESL605
DPESL999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPESL000
.
          MATCH    "CCUP2",NAMSSFFI
          GOTO     FPESL105 IF NOT EQUAL
          PACK     KEY31,CCUP2SKY,Z70
          CALL     RDCCUP2  * Start
          IF       OVRCD=0
            CALL     RPCCUP2  * Start
          ENDIF
          CALL     DPESL000
          GOTO     FPESL999
FPESL105
FPESL999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPESL000
.
          MATCH    "CCUP2",NAMSSFFI
          GOTO     LPESL105 IF NOT EQUAL
          PACK     KEY31,CCUP2SKY,SP70
          CALL     RSCCUP2  * End
          IF       OVRCD=1
            CALL     RKCCUP2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCUP2SNO
            CALL     RKCCUP2 
            IF       OVRCD=1
              MOVE     CCUP2SNO,SECTOR
            ENDIF
            PACK     CCUP2MKY,CCUPHCD,CCUPENC,CCUPDAT,CCUPTIM                                                
            MATCH    CCUP2EKY,CCUP2MKY
            IF       !@EQUAL
              MOVE     CCUP2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPESL000
          GOTO     LPESL999
LPESL105
LPESL999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPESL000
.
          MATCH    "CCUP2",NAMSSFFI
          GOTO     PPESL120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPESL105
          COMPARE  SECTOR,CCUP2SNO
          GOTO     PPESL110 IF EQUAL
          CALL     RKCCUP2 
          BRANCH   OVRCD,PPESL115
          PACK     CCUP2MKY,CCUPHCD,CCUPENC,CCUPDAT,CCUPTIM                                                
          MATCH    CCUP2EKY,CCUP2MKY
          GOTO     PPESL115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PPESL105
PPESL110
          MOVE     ZERO,SECTOR
          IF       CCUP2CNT=CCUP2SNO
            SUB      ONE,CCUP2CNT
          ENDIF
          WHILE    SECTOR<=CCUP2CNT
            CALL     RKCCUP2 
            IF       OVRCD=1
              MOVE     CCUP2SNO,SECTOR
            ENDIF
            PACK     CCUP2MKY,CCUPHCD,CCUPENC,CCUPDAT,CCUPTIM                                                
            MATCH    CCUP2EKY,CCUP2MKY
            IF       !@EQUAL
              MOVE     CCUP2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPESL000
          GOTO     PPESL999
PPESL115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCUP2SNO
            CALL     RPCCUP2 
            IF       OVRCD=1
              MOVE     CCUP2SNO,SECTOR
            ENDIF
            PACK     CCUP2MKY,CCUPHCD,CCUPENC,CCUPDAT,CCUPTIM                                                
            MATCH    CCUP2EKY,CCUP2MKY
            IF       !@EQUAL
              MOVE     CCUP2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPESL999
PPESL120
PPESL999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPESL000
          MATCH    "CCUP2",NAMSSFFI
          GOTO     NPESL115 IF NOT EQUAL
NPESL105
          CALL     RPCCUP2 
          BRANCH   OVRCD,NPESL110
          PACK     CCUP2MKY,CCUPHCD,CCUPENC,CCUPDAT,CCUPTIM                                                
          MATCH    CCUP2EKY,CCUP2MKY
          GOTO     NPESL110 IF NOT EQUAL
          CALL     RKCCUP2 
          CALL     DPESL000
          GOTO     NPESL999
NPESL110
          CALL     RKCCUP2 
          BEEP
          GOTO     NPESL999
NPESL115
NPESL999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTESL000
CTESL105
CTESL999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Episode Summary                    
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Episode Summary                    
.---------------------------------------------------------
DFESL000
          BRANCH   ACCEPT,DFESL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFESL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFESL900
          MATCH    PRGID,SCPSPID
          GOTO     DFESL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFESL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFESL010 IF NOT EQUAL
.
          CALL     PSESL000 * Display Field
          GOTO     DFESL010
DFESL900
          MOVE      "CCUP2",NAMSSFFI
          MOVE      "   70",ITMSSFFI
          CALL      FPESL000
DFESL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Episode Summary                    
.---------------------------------------------------------
PSESL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSESL999,PSESL999,PSESL999,PSESL999:
                            PSESL101,PSESL102,PSESL103,PSESL104:
                            PSESL105,PSESL106,PSESL107,PSESL108:
                            PSESL109,PSESL110,PSESL111,PSESL112:
                            PSESL113,PSESL114,PSESL115,PSESL116:
                            PSESL117,PSESL118,PSESL119,PSESL120:
                            PSESL121,PSESL122,PSESL123,PSESL124:
                            PSESL125,PSESL126,PSESL127,PSESL128:
                            PSESL129,PSESL130,PSESL131,PSESL132:
                            PSESL133,PSESL134,PSESL135,PSESL136:
                            PSESL137,PSESL138,PSESL139,PSESL140:
                            PSESL141,PSESL142,PSESL143,PSESL144:
                            PSESL145,PSESL146,PSESL147,PSESL148:
                            PSESL149,PSESL150,PSESL151,PSESL152:
                            PSESL153,PSESL154,PSESL155,PSESL156:
                            PSESL157,PSESL158,PSESL159,PSESL999:
                            PSESL999,PSESL999,PSESL999,PSESL999:
                           PSESL999,PSESL999,PSESL999,PSESL999:
                            PSESL999,PSESL999,PSESL999,PSESL999:
                            PSESL999,PSESL999,PSESL999,PSESL999:
                            PSESL999,PSESL999,PSESL999,PSESL999:
                            PSESL999,PSESL999,PSESL999,PSESL999:
                            PSESL999,PSESL999,PSESL160,PSESL161
          GOTO     PSESL999
.
PSESL101
          MOVE      CLV1DES,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL102
          MOVE      CLV2DES,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL103
          MOVE      CLV3DES,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL104
          MOVE      CCECHCD,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL105
          MOVE      CCECEPS,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL106
          MOVE      CCECLV1,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL107
          MOVE      CCECLV2,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL108
          MOVE      CCECLV3,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL109
          MOVE      CCECFTC,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL110
          MOVE      CCECTTC,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL111
          MOVE      CCECLOS,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL112
          MOVE      CCEPSUR,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL113
          MOVE      CCEPGIV,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPCOM,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL115
          MOVE      CCEPURN,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL116
          UNPACK    CCEPSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL117
          UNPACK    CCEPLTD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL118
          MOVE      CCEPLOS,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPINPT,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL120
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPDAY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL121
          MOVE      CCEPVIST,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL122
          MOVE      CCEPSEX,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL123
          UNPACK    CCEPDOB,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL124
          MOVE      CCEPAGEY,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL125
          MOVE      CCEPAGEM,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL126
          MOVE      CCEPAGED,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL127
          MOVE      CCEPCOB,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL128
          MOVE      CCEPREL,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL129
          UNPACK    CCEPDDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL130
          MOVE      CCEPDWAR,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL131
          MOVE      CCEPDSTA,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL132
          MOVE      CCEPDDES,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL133
          MOVE      CCEPDMBS,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL134
          MOVE      CCEPDDPT,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL135
          MOVE      CCEPDSER,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL136
          MOVE      CCEPMDCC,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL137
          MOVE      CCEPDRGC,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL138
          UNPACK    CCEPADAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL139
          MOVE      CCEPAWAR,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL140
          MOVE      CCEPASRC,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL141
          MOVE      CCEPACLS,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL142
          MOVE      CCEPACAR,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL143
          MOVE      CCEPADPT,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL144
          MOVE      CCEPASER,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL145
          MOVE      CCEPARDC,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL146
          MOVE      CCEPATDC,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL147
          MOVE      CCEPAADC,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL148
          MOVE      CCEPDADC,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL149
          MOVE      CCEPAHFD,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL150
          MOVE      CCEPAHTB,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL151
          MOVE      CCEPAMBS,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL152
          MOVE      CCEPOPCL,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL153
          MOVE      CCEPPDIA,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL154
          MOVE      CCEPSDIA,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL155
          MOVE      CCEPPOPP,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL156
          MOVE      CCEPSOPP,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL157
          MOVE      DESC01,VAR       
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL158
          MOVE      DESC02,VAR       
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL159
          MOVE      DESC03,VAR       
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL160
          MOVE      COLHED1,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL161
          MOVE      COLHED2,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
PSESL999
          RETURN
.---------------------------------------------------------
. Selections for : Episode Summary                    
.---------------------------------------------------------
SFESL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFESL001  BRANCH   ACCEPT,SFESL020
.
SFESL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFESL006,SFESL101,SFESL102,SFESL103:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL104:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                           SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL105,SFESL106:
                            SFESL107,SFESL108,SFESL006,SFESL006
SFESL006  BEEP
          GOTO     SFESL005
SFESL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFESL090
          MATCH    PRGID,SCSLPID
          GOTO     SFESL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFESL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                           SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020
          GOTO     SFESL020
SFESL090  MOVE     ZERO,ACCEPT
          MOVE      "CCUP2",NAMSSFFI
          MOVE      "   70",ITMSSFFI
          CALL      FPESL000
          GOTO     SFESL001
.
SFESL101
          MOVE      ZERO,EXIT
          GOTO      SFESL999
.
SFESL102
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFESL999
.
SFESL103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCEDL000
          MOVE      "ES",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SFESL001
.
SFESL104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCECL000
          MOVE      "ES",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SFESL001
.
SFESL105
          MOVE      "CCUP2",NAMSSFFI
          MOVE      "   70",ITMSSFFI
          CALL      NPESL000
          GOTO     SFESL001
.
SFESL106
          MOVE      "CCUP2",NAMSSFFI
          MOVE      "   70",ITMSSFFI
          CALL      PPESL000
          GOTO     SFESL001
.
SFESL107
          MOVE      "CCUP2",NAMSSFFI
          MOVE      "   70",ITMSSFFI
          CALL      FPESL000
          GOTO     SFESL001
.
SFESL108
          MOVE      "CCUP2",NAMSSFFI
          MOVE      "   70",ITMSSFFI
          CALL      LPESL000
          GOTO     SFESL001
SFESL990  MOVE      ONE,EXIT * Exit Char Restart
SFESL999  RETURN
.--------------------------------
. Screen - Graph Options                      
.--------------------------------
SCGOL000
SCGOL100
          MOVE      "GO",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 40",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCGOL200
          CALL      CFGOL000 * Clear Fields
SCGOL300
          CALL      KYGOL000 * Enter Key Fields
          BRANCH    EXIT,SCGOL999,SCGOL999
SCGOL400
          CALL      WPGOL000 * Load any WP Details
SCGOL500
          CALL      LMGOL000 * Load any Batch Details
SCGOL600
          CALL      DFGOL000 * Display Fields
SCGOL700
          CALL      SFGOL000 * Select Fields
          BRANCH    EXIT,SCGOL100,SCGOL100,SCGOL200
SCGOL800
SCGOL900
SCGOL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Graph Options                      
.-------------------------------------------------------
CFGOL000
CFGOL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Graph Options                      
.--------------------------------------------------------
KYGOL000
          MOVE      ZERO,EXIT
          GOTO      KYGOL999
.
KYGOL900  MOVE      ONE,EXIT
KYGOL999  RETURN
.---------------------------------------------------------
. Load WP files for : Graph Options                      
.---------------------------------------------------------
WPGOL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Graph Options                      
.---------------------------------------------------------
LMGOL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Graph Options                      
.---------------------------------------------------------
DFGOL000
          BRANCH   ACCEPT,DFGOL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFGOL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFGOL900
          MATCH    PRGID,SCPSPID
          GOTO     DFGOL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFGOL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFGOL010 IF NOT EQUAL
.
          CALL     PSGOL000 * Display Field
          GOTO     DFGOL010
DFGOL900
DFGOL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Graph Options                      
.---------------------------------------------------------
PSGOL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSGOL999,PSGOL999,PSGOL101,PSGOL999:
                            PSGOL102,PSGOL103,PSGOL104,PSGOL105:
                            PSGOL106,PSGOL107,PSGOL108,PSGOL109:
                            PSGOL110,PSGOL111,PSGOL112,PSGOL113:
                            PSGOL114,PSGOL999
          GOTO     PSGOL999
.
PSGOL101
          MOVE      GRAPHLEV,VAR     
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLTO,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLAV,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL104
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLMN,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLMX,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFTO,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFAV,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFMN,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFMX,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHTTO,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHTAV,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL112
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHTMN,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL113
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHTMX,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHEPS,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
PSGOL999
          RETURN
.---------------------------------------------------------
. Selections for : Graph Options                      
.---------------------------------------------------------
SFGOL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFGOL001  BRANCH   ACCEPT,SFGOL020
.
SFGOL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFGOL006,SFGOL101,SFGOL006,SFGOL102:
                            SFGOL103,SFGOL104,SFGOL105,SFGOL106:
                            SFGOL107,SFGOL108,SFGOL109,SFGOL110:
                            SFGOL111,SFGOL112,SFGOL113,SFGOL114:
                            SFGOL115,SFGOL116
SFGOL006  BEEP
          GOTO     SFGOL005
SFGOL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFGOL090
          MATCH    PRGID,SCSLPID
          GOTO     SFGOL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFGOL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFGOL020,SFGOL020,SFGOL020,SFGOL020:
                            SFGOL103,SFGOL104,SFGOL105,SFGOL106:
                            SFGOL107,SFGOL108,SFGOL109,SFGOL110:
                            SFGOL111,SFGOL112,SFGOL113,SFGOL114:
                            SFGOL115,SFGOL020
          GOTO     SFGOL020
SFGOL090  MOVE     ZERO,ACCEPT
          GOTO     SFGOL001
.
SFGOL101
          MOVE      ZERO,EXIT
          GOTO      SFGOL999
.
SFGOL102
          CALL      GRAPH000
          GOTO      SFGOL001
.
SFGOL103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHLTO00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL103
            ENDIF
            BRANCH    EXIT,SFGOL103,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLTO,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHLAV00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL104
            ENDIF
            BRANCH    EXIT,SFGOL104,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLAV,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHLMN00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL105
            ENDIF
            BRANCH    EXIT,SFGOL105,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLMN,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL106
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHLMX00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL106
            ENDIF
            BRANCH    EXIT,SFGOL106,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLMX,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL107
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHFTO00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL107
            ENDIF
            BRANCH    EXIT,SFGOL107,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFTO,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL108
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHFAV00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL108
            ENDIF
            BRANCH    EXIT,SFGOL108,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFAV,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL109
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHFMN00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL109
            ENDIF
            BRANCH    EXIT,SFGOL109,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFMN,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL110
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHFMX00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL110
            ENDIF
            BRANCH    EXIT,SFGOL110,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFMX,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL111
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHTTO00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL111
            ENDIF
            BRANCH    EXIT,SFGOL111,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHTTO,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL112
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHTAV00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL112
            ENDIF
            BRANCH    EXIT,SFGOL112,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHTAV,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL113
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHTMN00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL113
            ENDIF
            BRANCH    EXIT,SFGOL113,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHTMN,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL114
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHTMX00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL114
            ENDIF
            BRANCH    EXIT,SFGOL114,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHTMX,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL115
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHEPS00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL115
            ENDIF
            BRANCH    EXIT,SFGOL115,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHEPS,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL116
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFGOL999
SFGOL990  MOVE      ONE,EXIT * Exit Char Restart
SFGOL999  RETURN
.@@@@@ Function Restart Point @@@@@
.--------------------------------------------------
. Get Details for Level 1
.--------------------------------------------------
LV1DET00  PACK      KEY13,CCEALV1,CCEBLV1
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      SP70,CCXHDES
            MATCH     Z70,CCEBLV1
            IF        @EQUAL
              MOVE      "Other",CCXHDES
            ENDIF
          ENDIF
.
          SFORMAT   VAR,CCSTLEN
          MOVE      CCEBLV1,VAR
          PACK      LEV1DESC,VAR,SP1,CCXHDES
          SFORMAT   VAR,127
.
          MOVE      CCEBFTC,CSTTOT
          MOVE      CCEBTTC,INCTOT
.
          MATCH     "1",CCEAUST
          GOTO      LV1DET10 IF NOT EQUAL
.
          MOVE      CCEBFSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,FRCSDEV
          ASSIGN    CCEBFTC/CCEBNEP,FRCXBAR
          ASSIGN    CCEBFMX-CCEBFMN,FRCRANG
.
          MOVE      CCEBTSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,TOCSDEV
          ASSIGN    CCEBTTC/CCEBNEP,TOCXBAR
          ASSIGN    CCEBTMX-CCEBTMN,TOCRANG
.
          MOVE      CCEBLSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,LOSSDEV
          ASSIGN    CCEBLTO/CCEBNEP,LOSXBAR
          ASSIGN    CCEBLMX-CCEBLMN,LOSRANG
          GOTO      LV1DET99
.
LV1DET10  MOVE      ZERO,FRCSDEV
          ASSIGN    CCEBFTC/CCEBNEP,FRCXBAR
          MOVE      ZERO,FRCRANG
.
          MOVE      ZERO,TOCSDEV
          ASSIGN    CCEBTTC/CCEBNEP,TOCXBAR
          MOVE      ZERO,TOCRANG
.
          MOVE      ZERO,LOSSDEV
          MOVE      ZERO,CCEBLMN
          MOVE      ZERO,CCEBLMX
          ASSIGN    CCEBLTO/CCEBNEP,LOSXBAR
          MOVE      ZERO,LOSRANG
.
          MATCH     SP70,CCEASCM1
          IF        !@EQUAL
            ASSIGN    CCEBFTC+CCEBFMN+CCEBFMX+CCEBFSV,CSTTOT
            ASSIGN    CSTTOT/CCEBNEP,FRCXBAR
            MOVE      CCEBFMX,FRCSDEV
            MOVE      CCEBFMN,FRCRANG
            MOVE      CCEBFTC,CCEBFMN
            MOVE      CCEBFSV,CCEBFMX
          ELSE
            MOVE      ZERO,CCEBFMN
            MOVE      ZERO,CCEBFMX
          ENDIF
.
          MATCH     SP70,CCEASCM2
          IF        !@EQUAL
            ASSIGN    CCEBTTC+CCEBTMN+CCEBTMX+CCEBTSV,INCTOT
            ASSIGN    INCTOT/CCEBNEP,TOCXBAR
            MOVE      CCEBTMX,TOCSDEV
            MOVE      CCEBTMN,TOCRANG
            MOVE      CCEBTTC,CCEBTMN
            MOVE      CCEBTSV,CCEBTMX
          ELSE
            MOVE      ZERO,CCEBTMN
            MOVE      ZERO,CCEBTMX
          ENDIF
.
          GOTO      LV1DET99
.
LV1DET99  RETURN
.------------------------------------------------------------
. Routine to Calculate Standard Deviation (CCSTDDEV)
.          given the Statistical Variance (CCVARIAN)
.------------------------------------------------------------
CALSD000  COMPARE   ONE,CASTDDEV
          GOTO      CALSD999 IF NOT EQUAL
          MOVE      ZERO,CCSTDDEV
          COMPARE   ZERO,CCVARIAN
          GOTO      CALSD999 IF EQUAL
          GOTO      CALSD999 IF LESS
          COMPARE   "999999999999.9999",CCVARIAN  * Out of Bounds
          GOTO      CALSD999 IF EQUAL
.
          MOVE      "10000",CCFACTOR
.
CALSD100  ADD       CCFACTOR,CCSTDDEV
          ASSIGN    (CCSTDDEV*CCSTDDEV),CCTSTVAR
          COMPARE   CCVARIAN,CCTSTVAR
          GOTO      CALSD999 IF EQUAL           * have the root
          GOTO      CALSD100 IF LESS
.
          SUB       CCFACTOR,CCSTDDEV
.
          DIV       "10",CCFACTOR
          COMPARE   ".01",CCFACTOR
          GOTO      CALSD100 IF NOT EQUAL
.
CALSD999  RETURN
.----------------------------------------------------------------------
. Enter Casemix Extract ID
.----------------------------------------------------------------------
EEID0000  MOVE      ZERO,CKEYTYP
          CALL      CCSCOPCL         * Close Files
          CALL      KCCEAA00
          BRANCH    EXIT,EEID9999,EEID9999
          CALL      GETCME00
          CALL      CCSCOPOP         * Open Files
EEID9999  RETURN
.======================================================================
. Determine Display Values for a Valid Casemix Extract Code
.======================================================================
GETCME00  MOVE      SP70,STATDES1
          MOVE      SP70,STATDES2
          MOVE      SP70,STATDES3
          MOVE      SP70,STATDES4
          MOVE      "  Cost (1)",COLHED1
          MOVE      "  Cost (2)",COLHED2
          MATCH     "1",CCEAUST
          IF        @EQUAL
            MOVE      "Standard Deviation",STATDES1
            MOVE      "Minimum           ",STATDES2
            MOVE      "Maximum           ",STATDES3
            MOVE      "Range             ",STATDES4
          ELSE
            MATCH     SP70,CCEASCM1
            IF        !@EQUAL
              MOVE      "Direct   Variable ",STATDES1
              MOVE      "         Fixed    ",STATDES2
              MOVE      "Indirect Variable ",STATDES3
              MOVE      "         Fixed    ",STATDES4
            ELSE
              MOVE      "    Income",COLHED1
            ENDIF
            MATCH     SP70,CCEASCM2
            IF        !@EQUAL
              MOVE      "Fixed Direct      ",STATDES1
              MOVE      "Fixed Indrect     ",STATDES2
              MOVE      "Variable Direct   ",STATDES3
              MOVE      "Variable Indirect ",STATDES4
            ELSE
              MOVE      "    Income",COLHED2
            ENDIF
          ENDIF
.
          MATCH     SP70,CCEAFDD
          IF        @EQUAL
            MOVE      "Start     ",FROMDD
          ELSE
            UNPACK    CCEAFDD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,FROMDD
          ENDIF
.
          MATCH     "99999999",CCEATDD
          IF        @EQUAL
            MOVE      "Finish    ",TODD
          ELSE
            UNPACK    CCEATDD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,TODD
          ENDIF
.
          MATCH     SP70,CCEAFAD
          IF        @EQUAL
            MOVE      "Start     ",FROMAD
          ELSE
            UNPACK    CCEAFAD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,FROMAD
          ENDIF
.
          MATCH     "99999999",CCEATAD
          IF        @EQUAL
            MOVE      "Finish    ",TOAD
          ELSE
            UNPACK    CCEATAD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,TOAD
          ENDIF
.
          MOVE     CCEAVIS,F1
          BRANCH   F1,GETCME10,GETCME20,GETCME30
          MOVE     "All        ",VISITDES
          GOTO     GETCME40
GETCME10  MOVE     "A & E      ",VISITDES
          GOTO     GETCME40
GETCME20  MOVE     "Outpatients ",VISITDES
          GOTO     GETCME40
GETCME30  MOVE     "Inpatients",VISITDES
          GOTO     GETCME40
.
GETCME40  MOVE     SP70,CLV1DES
          MOVE     SP70,CLV2DES
          MOVE     SP70,CLV3DES
.
          MATCH    SP70,CCEALV2
          IF       !@EQUAL
            MOVE     CCEALV2,KEY3
            CALL     RDCCST1
            MOVE     CCSTDES,CLV2DES
          ENDIF
.
          MATCH    SP70,CCEALV3
          IF       !@EQUAL
            MOVE     CCEALV3,KEY3
            CALL     RDCCST1
            MOVE     CCSTDES,CLV3DES
          ENDIF
.
          MOVE     CCEALV1,KEY3
          CALL     RDCCST1
          MOVE     CCSTDES,CLV1DES
.
          MATCH    SP70,CCEASCM1
          IF       @EQUAL
            CALL     GETMOD00
          ELSE
            CALL     GETSCM00
          ENDIF
.
          MOVE     CCEAHCD,KEY2
          CALL     RDCCHC1
.
          MOVE       CCEADAY,F1
          IF         F1=0
            MOVE       "Exclude Day Cases",DAYCDESC
          ELSE
            IF         F1=2
              MOVE       "Day Cases Only",DAYCDESC
            ELSE
              MOVE       "Include Day Cases",DAYCDESC
            ENDIF
          ENDIF
.
          RETURN
.
GETMOD00  MATCH    SP70,CCEAFCM
          IF       @EQUAL
            CLEAR    FROMCOST
            APPEND   "Actual Costs - ",FROMCOST
            APPEND   CCEAFYR,FROMCOST
            RESET    FROMCOST
          ELSE
            MOVE     CCEAFCM,KEY4
            CALL     RDCCMA1
            CLEAR    FROMCOST
            STRIP    CCMADES
            APPEND   CCMADES,FROMCOST
            APPEND   " - ",FROMCOST
            APPEND   CCEAFYR,FROMCOST
            RESET    FROMCOST
          ENDIF
.
          MATCH    SP70,CCEATCM
          IF       @EQUAL
            CLEAR    TOCOST
            APPEND   "Actual Costs - ",TOCOST
            APPEND   CCEATYR,TOCOST
            RESET    TOCOST
          ELSE
            MOVE     CCEATCM,KEY4
            CALL     RDCCMA1
            CLEAR    TOCOST
            STRIP    CCMADES
            APPEND   CCMADES,TOCOST
            APPEND   " - ",TOCOST
            APPEND   CCEAFYR,TOCOST
            RESET    TOCOST
          ENDIF
          RETURN
.
GETSCM00  MOVE      CCEASCM1,KEY3
          CALL      RDCCSP1
          PACK      FROMCOST,CCSPDES
          MATCH     SP70,CCEASCM2
          IF        @EQUAL
            MOVE      "Income",TOCOST
          ELSE
            MOVE      CCEASCM2,KEY3
            CALL      RDCCSP1
            PACK      TOCOST,CCSPDES
          ENDIF
          RETURN
.--------------------------------------------------------------------
. Graph Level 1 Casemix Analysis
.--------------------------------------------------------------------
GPH1LV00  MOVE     ONE,GRAPHLEV
.
          MOVE     ZERO,ACCEPT
          CALL     SCGOL000
.
          RETURN
SEL1LV00  CALL     RDCCEB1
          BRANCH   OVRCD,SEL1LV99
          MOVE     ONE,CASTDDEV
          CALL     LV1DET00
          MOVE     ZERO,CASTDDEV
.
          CALL     SC01L000
.
SEL1LV99  RETURN
.---------------------------------------------------------------------------
. Enter Casemix Code Level 1
.-------------------------------------------------------------------------------
SELCM000  TOPIC     "CCXHKEY "
          DISPLAY   *P1:24,*EL,"Enter Code : "
          MOVE      "14",CCOL
          MOVE      "24",CVERT
.
          MOVE      CCEALV1,CCXHSTY
          MOVE      CCEALV1,KEY3
          CALL      RDCCST1
          SFORMAT   VAR,CCSTLEN
          MATCH     "1",CCSTJR
          IF        @EQUAL
            KEYIN     *PCCOL:CVERT,*V2LON,*JR,VAR
          ELSE
            KEYIN     *PCCOL:CVERT,*V2LON,VAR
          ENDIF
.
          MATCH     "1",CCSTZF
          IF        @EQUAL
            REP       " 0",VAR
          ENDIF
.
          DISPLAY     *PCCOL:CVERT,*V2LON,VAR
.
          ENDSET    VAR
          APPEND    SP70,VAR
          RESET     VAR
.
          MATCH     SP70,VAR
          GOTO      SELCM090 IF EQUAL
.
          MATCH     "1",CCSTJR
          IF        @EQUAL
            ENDSET    VAR
          ENDIF
          CMATCH    EXITCHAR,VAR
          GOTO      SELCM095 IF EQUAL
.
          CMATCH    QUEST,VAR
          GOTO      SELCM010 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCXHA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCXHKEY
          APPEND    SP70,CCXHKEY
          RESET     CCXHKEY
.
          MATCH     SP70,CCXHKEY
          GOTO      SELCM000 IF EQUAL
          MOVE      CCXHKEY,VAR
.
          DISPLAY   *PCCOL:CVERT,*V2LON,VAR
SELCM010
          RESET     VAR
          MATCH     "1",CCSTDE
          IF        @EQUAL
            TYPE      VAR
            GOTO      SELCM015 IF EQUAL
            BEEP
            GOTO      SELCM000
          ENDIF
SELCM015
          MOVE      VAR,CCXHKEY
          MOVE      VAR,CCEBLV1
          PACK      KEY13,CCXHSTY,VAR
          CALL      RACCXH1
          BRANCH    OVRCD,SELCM080
          CALL      RDCCXH1
          MOVE      ZERO,EXIT
          CALL      LV1DET00   * Calculate Details
          CALL      SEL1LV00   * Calculate Details
.
          GOTO      SELCM099
.
SELCM080  MOVE      ZERO,EXIT
          MOVE      "Code Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      SELCM000
.
SELCM085  MOVE      SP70,CCXHKEY
          MOVE      ZERO,EXIT
          GOTO      SELCM099
.
SELCM090  MOVE      SP70,CCXHKEY
          MOVE      ONE,EXIT
          GOTO      SELCM099
.
SELCM095  MOVE      TWO,EXIT
.
SELCM099  SFORMAT   VAR,127
          TOPIC     PRGID
          RETURN
.---------------------------------------------------------------------------
. Display Level 2
.-------------------------------------------------------------------------------
LEVEL200  MATCH     SP70,CCEALV2
          IF        @EQUAL
            BEEP
            MOVE      "No More Levels in this Extract - ",DISPMSG
            CALL      MESSAGE1
            GOTO      LEVEL299
          ENDIF
.
          MOVE      CCEALV2,KEY3
          CALL      RDCCST1
.
          CALL      SC02L000
.
          MOVE      CCEALV1,KEY3
          CALL      RDCCST1
.
          CALL      LV1DET00
.
LEVEL299  RETURN
.---------------------------------------------------------------------------
. Enter Casemix Code Level 1
.-------------------------------------------------------------------------------
KY01LV00  TOPIC     "CCXHKEY "
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          MOVE      CCEALV1,CCXHSTY
          MOVE      CCEALV1,KEY3
          CALL      RDCCST1
          SFORMAT   VAR,CCSTLEN
          MATCH     "1",CCSTJR
          IF        @EQUAL
            KEYIN     *PCCOL:CVERT,*V2LON,*JR,VAR
          ELSE
            KEYIN     *PCCOL:CVERT,*V2LON,VAR
          ENDIF
.
          MATCH     "1",CCSTZF
          IF        @EQUAL
            REP       " 0",VAR
          ENDIF
.
          DISPLAY     *PCCOL:CVERT,*V2LON,VAR
.
          ENDSET    VAR
          APPEND    SP70,VAR
          RESET     VAR
.
          MATCH     SP70,VAR
          GOTO      KY01LV90 IF EQUAL
.
          MATCH     "1",CCSTJR
          IF        @EQUAL
            ENDSET    VAR
          ENDIF
          CMATCH    EXITCHAR,VAR
          GOTO      KY01LV95 IF EQUAL
.
          CMATCH    QUEST,VAR
          GOTO      KY01LV10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCXHA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCXHKEY
          APPEND    SP70,CCXHKEY
          RESET     CCXHKEY
.
          MATCH     SP70,CCXHKEY
          GOTO      KY01LV00 IF EQUAL
          MOVE      CCXHKEY,VAR
.
          DISPLAY   *PCCOL:CVERT,*V2LON,VAR
KY01LV10
          RESET     VAR
          MATCH     "1",CCSTDE
          IF        @EQUAL
            TYPE      VAR
            GOTO      KY01LV15 IF EQUAL
            BEEP
            GOTO      KY01LV00
          ENDIF
KY01LV15
          MOVE      VAR,CCXHKEY
          MOVE      VAR,CCEBLV1
          PACK      KEY13,CCXHSTY,VAR
          CALL      RACCXH1
          BRANCH    OVRCD,KY01LV80
          CALL      RDCCXH1
          MOVE      ZERO,EXIT
          CALL      LV1DET00   * Calculate Details
          GOTO      KY01LV99
.
KY01LV80  MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KY01LV99,KY01LV99
          MOVE      "Code Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KY01LV00
.
KY01LV85  MOVE      SP70,CCXHKEY
          MOVE      ZERO,EXIT
          GOTO      KY01LV99
.
KY01LV90  MOVE      SP70,CCXHKEY
          MOVE      ONE,EXIT
          GOTO      KY01LV99
.
KY01LV95  MOVE      TWO,EXIT
.
KY01LV99  SFORMAT   VAR,127
          TOPIC     PRGID
          RETURN
.----------------------------------------------------------------------
. Calculate Values for Histogram
.----------------------------------
. GPHISVAL FORM  5[15]   Histogram Values 1 to 15
. GPHISOVR FORM  5       Histogram Value > 15
. GPHISUND FORM  5       Histogram Value < 1
. GPHISRHD DIM   12      Range Heading
. GPHISCHD DIM   12      Count Heading
. GPHISHED DIM   50      General Heading
. GPHISTOT FORM  5       Total
. GPHISMIN FORM  10      Minimum   Eg Start at 1000
. GPHISRAN FORM  10      Range     Increment by 1000
. GPHISMAX FORM  5       Maximum
. GPHISSCL FORM  5       Scale
. GPHISCNT FORM  2       Scale
.----------------------------------------------------------------------
H1DP0000  ASSIGN    CCEBLMN,GPHISMIN
          IF        GPHISMIN=0
            MOVE      "1",GPHISMIN
          ENDIF
          MOVE      "1",HISTTYPE
          MOVE      "1",GPHISRAN
H1DP0100  IF        HISTTYPE=1
            MOVE      "L.O.S.",GPHISRHD
          ELSE
            MOVE      "Cost",GPHISRHD
          ENDIF
          MOVE      "Episodes",GPHISCHD
          SFORMAT   VAR,CCSTLEN
          MOVE      CCXHKEY,VAR
          PACK      GPHISHED,VAR,SP1,CCXHDES
          SFORMAT   VAR,127
.
          MOVE      ZERO,GPHISCNT
          REPEAT
            ADD       ONE,GPHISCNT
            MOVE      ZERO,GPHISVAL[GPHISCNT]
          UNTIL     (GPHISCNT=15)
          MOVE      ZERO,GPHISOVR
          MOVE      ZERO,GPHISUND
.
          PACK      KEY48,CCEBLV1,SP70
          CALL      RSCCEC2
H1DP1000  CALL      RKCCEC2
          BRANCH    OVRCD,H1DP9000
          MATCH     CCEBLV1,CCECLV1
          GOTO      H1DP9000 IF NOT EQUAL
.
          LOAD      F12P2,HISTTYPE,CCECLOS,CCECFTC,CCECTTC
          ASSIGN    (F12P2-GPHISMIN)/GPHISRAN,F12P2
          MOVE      F12P2,GPHISCNT
          ADD       ONE,GPHISCNT
          IF        GPHISCNT<1
            ADD       ONE,GPHISUND
            GOTO      H1DP1000
          ENDIF
          IF        GPHISCNT>15
            ADD       ONE,GPHISOVR
            GOTO      H1DP1000
          ENDIF
.
          ADD       ONE,GPHISVAL[GPHISCNT]
          GOTO      H1DP1000
.
H1DP9000  CALL      GPHISDIS
          KEYIN     *P1:24,*EL,*V2LON,"S",*HOFF,"cale, ":
                               *V2LON,"T",*HOFF,"ype, Hit <":
                               *V2LON,"Enter",*HOFF,"> to Exit : ",ANS
          ENDSET    ANS
          APPEND    SP70,ANS
          RESET     ANS
          REP       UPPLOW,ANS
          MATCH     ANST,ANS
          GOTO      H1DP9100 IF EQUAL
          MATCH     ANSS,ANS
          GOTO      H1DP9200 IF EQUAL
          MATCH     SP70,ANS
          GOTO      H1DP9999 IF EQUAL
          BEEP
          GOTO      H1DP9000
.
H1DP9100  KEYIN     *P1:24,*EL,"Type :  ":
                    *V2LON,"1.",*HOFF," Length of Stay, ":
                    *V2LON,"2.",*HOFF," Cost 1, ":
                    *V2LON,"3.",*HOFF," Cost 2.  Enter Type : ",*V2LON,HISTTYPE
          BRANCH    HISTTYPE,H1DP9200,H1DP9200,H1DP9200
          BEEP
          GOTO      H1DP9100
.
H1DP9200  KEYIN     *P1:24,*EL,"Minimum Value : ",*V2LON,GPHISMIN,*HOFF:
                               "    Step : ",*V2LON,GPHISRAN,*HOFF:
                               "  Ok (",*V2LON,"Y",*HOFF,"/":
                                        *V2LON,"N",*HOFF,") ? ",*V2LON,ANS
          REP       UPPLOW,ANS
          MATCH     ANSY,ANS
          GOTO      H1DP0100 IF EQUAL
          GOTO      H1DP9200
.
H1DP9999  RETURN
.
.------------------------------------------------------------
. This will restart a program from any point with out the
. need to clear variables and stacks.
.------------------------------------------------------------
RESTARTP  CHAIN    PRGID
.
.--------------------------------------------------
. Get Details for Level 2
.--------------------------------------------------
LV2DET00  PACK      KEY13,CCEALV2,CCEDLV2
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      SP70,CCXHDES
          ENDIF
          SFORMAT   VAR,CCSTLEN
          MOVE      CCEDLV2,VAR
          PACK      LEV2DESC,VAR,SP1,CCXHDES
          SFORMAT   VAR,127
          MOVE      CCEDFTC,CSTTOT
          MOVE      CCEDTTC,INCTOT
.
          MATCH     "1",CCEAUST
          GOTO      LV2DET10 IF NOT EQUAL
.
          MOVE      CCEDFSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,FRCSDEV
          ASSIGN    CCEDFTC/CCEDNEP,FRCXBAR
          ASSIGN    CCEDFMX-CCEDFMN,FRCRANG
.
          MOVE      CCEDTSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,TOCSDEV
          ASSIGN    CCEDTTC/CCEDNEP,TOCXBAR
          ASSIGN    CCEDTMX-CCEDTMN,TOCRANG
.
          MOVE      CCEDLSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,LOSSDEV
          ASSIGN    CCEDLTO/CCEDNEP,LOSXBAR
          ASSIGN    CCEDLMX-CCEDLMN,LOSRANG
          GOTO      LV2DET99
.
LV2DET10  MOVE      ZERO,FRCSDEV
          ASSIGN    CCEDFTC/CCEDNEP,FRCXBAR
          MOVE      ZERO,FRCRANG
.
          MOVE      ZERO,TOCSDEV
          ASSIGN    CCEDTTC/CCEDNEP,TOCXBAR
          MOVE      ZERO,TOCRANG
.
          MOVE      ZERO,LOSSDEV
          MOVE      ZERO,CCEDLMN
          MOVE      ZERO,CCEDLMX
          ASSIGN    CCEDLTO/CCEDNEP,LOSXBAR
          MOVE      ZERO,LOSRANG
.
          MATCH     SP70,CCEASCM1
          IF        !@EQUAL
            ASSIGN    CCEDFTC+CCEDFMN+CCEDFMX+CCEDFSV,CSTTOT
            ASSIGN    CSTTOT/CCEDNEP,FRCXBAR
            MOVE      CCEDFMX,FRCSDEV
            MOVE      CCEDFMN,FRCRANG
            MOVE      CCEDFTC,CCEDFMN
            MOVE      CCEDFSV,CCEDFMX
          ELSE
            MOVE      ZERO,CCEDFMN
            MOVE      ZERO,CCEDFMX
          ENDIF
.
          MATCH     SP70,CCEASCM2
          IF        !@EQUAL
            ASSIGN    CCEDTTC+CCEDTMN+CCEDTMX+CCEDTSV,INCTOT
            ASSIGN    INCTOT/CCEDNEP,TOCXBAR
            MOVE      CCEDTMX,TOCSDEV
            MOVE      CCEDTMN,TOCRANG
            MOVE      CCEDTTC,CCEDTMN
            MOVE      CCEDTSV,CCEDTMX
          ELSE
            MOVE      ZERO,CCEDTMN
            MOVE      ZERO,CCEDTMX
          ENDIF
.
          GOTO      LV2DET99
.
LV2DET99  RETURN
SEL2LV00  CALL     RDCCED1
          BRANCH   OVRCD,SEL2LV99
          MOVE     ONE,CASTDDEV
          CALL     LV2DET00
          MOVE     ZERO,CASTDDEV
.
          CALL     SC03L000
.
SEL2LV99  RETURN
.--------------------------------------------------------------------
. Graph Level 2 Casemix Analysis
.--------------------------------------------------------------------
GPH2LV00  MOVE     TWO,GRAPHLEV
.
          MOVE     ZERO,ACCEPT
          CALL     SCGOL000
.
          RETURN
.---------------------------------------------------------------------------
. Display Level 3
.-------------------------------------------------------------------------------
LEVEL300  MATCH     SP70,CCEALV3
          IF        @EQUAL
            BEEP
            MOVE      "No More Levels in this Extract - ",DISPMSG
            CALL      MESSAGE1
            GOTO      LEVEL399
          ENDIF
.
          MOVE      CCEALV3,KEY3
          CALL      RDCCST1
.
          CALL      SC04L000
.
          MOVE      CCEALV2,KEY3
          CALL      RDCCST1
.
          CALL      LV2DET00
.
LEVEL399  RETURN
.
.---------------------------------------------------------------------------
. Enter Casemix Code Level 1
.-------------------------------------------------------------------------------
KY02LV00  TOPIC     "CCXHKEY "
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          MOVE      CCEALV2,CCXHSTY
          MOVE      CCEALV2,KEY3
          CALL      RDCCST1
          SFORMAT   VAR,CCSTLEN
          MATCH     "1",CCSTJR
          IF        @EQUAL
            KEYIN     *PCCOL:CVERT,*V2LON,*JR,VAR
          ELSE
            KEYIN     *PCCOL:CVERT,*V2LON,VAR
          ENDIF
.
          MATCH     "1",CCSTZF
          IF        @EQUAL
            REP       " 0",VAR
          ENDIF
.
          DISPLAY     *PCCOL:CVERT,*V2LON,VAR
.
          ENDSET    VAR
          APPEND    SP70,VAR
          RESET     VAR
.
          MATCH     SP70,VAR
          GOTO      KY02LV90 IF EQUAL
.
          MATCH     "1",CCSTJR
          IF        @EQUAL
            ENDSET    VAR
          ENDIF
          CMATCH    EXITCHAR,VAR
          GOTO      KY02LV95 IF EQUAL
.
          CMATCH    QUEST,VAR
          GOTO      KY02LV10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCXHA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCXHKEY
          APPEND    SP70,CCXHKEY
          RESET     CCXHKEY
.
          MATCH     SP70,CCXHKEY
          GOTO      KY02LV00 IF EQUAL
          MOVE      CCXHKEY,VAR
.
          DISPLAY   *PCCOL:CVERT,*V2LON,VAR
KY02LV10
          RESET     VAR
          MATCH     "1",CCSTDE
          IF        @EQUAL
            TYPE      VAR
            GOTO      KY02LV15 IF EQUAL
            BEEP
            GOTO      KY02LV00
          ENDIF
KY02LV15
          MOVE      VAR,CCXHKEY
          PACK      KEY13,CCXHSTY,VAR
          CALL      RACCXH1
          BRANCH    OVRCD,KY02LV80
          CALL      RDCCXH1
          MOVE      ZERO,EXIT
          PACK      KEY20,CCEBLV1,CCXHKEY
          CALL      RDCCED1
          IF        OVRCD=1
            MOVE      ZERO,CCEDFTC
            MOVE      ZERO,CCEDFMN
            MOVE      ZERO,CCEDFMX
            MOVE      ZERO,CCEDFSV
            MOVE      ZERO,CCEDTTC
            MOVE      ZERO,CCEDTMN
            MOVE      ZERO,CCEDTMX
            MOVE      ZERO,CCEDTSV
            MOVE      ZERO,CCEDLTO
            MOVE      ZERO,CCEDLMN
            MOVE      ZERO,CCEDLMX
            MOVE      ZERO,CCEDLSV
          ENDIF
          CALL      LV2DET00   * Calculate Details
          GOTO      KY02LV99
.
KY02LV80  MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KY02LV99,KY02LV99
          MOVE      "Code Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KY02LV00
.
KY02LV85  MOVE      SP70,CCXHKEY
          MOVE      ZERO,EXIT
          GOTO      KY02LV99
.
KY02LV90  MOVE      SP70,CCXHKEY
          MOVE      SP70,SAVEID
          MOVE      ONE,EXIT
          GOTO      KY02LV99
.
KY02LV95  MOVE      TWO,EXIT
.
KY02LV99  SFORMAT   VAR,127
          TOPIC     PRGID
          RETURN
.----------------------------------------------------------------------
. Calculate Values for Histogram
.----------------------------------
. GPHISVAL FORM  5[15]   Histogram Values 1 to 15
. GPHISOVR FORM  5       Histogram Value > 15
. GPHISUND FORM  5       Histogram Value < 1
. GPHISRHD DIM   12      Range Heading
. GPHISCHD DIM   12      Count Heading
. GPHISHED DIM   50      General Heading
. GPHISTOT FORM  5       Total
. GPHISMIN FORM  10      Minimum   Eg Start at 1000
. GPHISRAN FORM  10      Range     Increment by 1000
. GPHISMAX FORM  5       Maximum
. GPHISSCL FORM  5       Scale
. GPHISCNT FORM  2       Scale
.----------------------------------------------------------------------
H2DP0000  ASSIGN    CCEBLMN,GPHISMIN
          IF        GPHISMIN=0
            MOVE      "1",GPHISMIN
          ENDIF
          MOVE      "1",HISTTYPE
          MOVE      "1",GPHISRAN
H2DP0100  IF        HISTTYPE=1
            MOVE      "L.O.S.",GPHISRHD
          ELSE
            MOVE      "Cost",GPHISRHD
          ENDIF
          MOVE      "Episodes",GPHISCHD
          SFORMAT   VAR,CCSTLEN
          MOVE      CCXHKEY,VAR
          PACK      GPHISHED,VAR,SP1,CCXHDES
          SFORMAT   VAR,127
.
          MOVE      ZERO,GPHISCNT
          REPEAT
            ADD       ONE,GPHISCNT
            MOVE      ZERO,GPHISVAL[GPHISCNT]
          UNTIL     (GPHISCNT=15)
          MOVE      ZERO,GPHISOVR
          MOVE      ZERO,GPHISUND
.
          PACK      KEY48,CCEDLV1,CCEDLV2,SP70
          CALL      RSCCEC2
H2DP1000  CALL      RKCCEC2
          BRANCH    OVRCD,H2DP9000
          MATCH     CCEDLV1,CCECLV1
          GOTO      H2DP9000 IF NOT EQUAL
          MATCH     CCEDLV2,CCECLV2
          GOTO      H2DP9000 IF NOT EQUAL
.
          LOAD      F12P2,HISTTYPE,CCECLOS,CCECFTC,CCECTTC
          ASSIGN    (F12P2-GPHISMIN)/GPHISRAN,F12P2
          MOVE      F12P2,GPHISCNT
          ADD       ONE,GPHISCNT
          IF        GPHISCNT<1
            ADD       ONE,GPHISUND
            GOTO      H2DP1000
          ENDIF
          IF        GPHISCNT>15
            ADD       ONE,GPHISOVR
            GOTO      H2DP1000
          ENDIF
.
          ADD       ONE,GPHISVAL[GPHISCNT]
          GOTO      H2DP1000
.
H2DP9000  CALL      GPHISDIS
          KEYIN     *P1:24,*EL,*V2LON,"S",*HOFF,"cale, ":
                               *V2LON,"T",*HOFF,"ype, Hit <":
                               *V2LON,"Enter",*HOFF,"> to Exit : ",ANS
          ENDSET    ANS
          APPEND    SP70,ANS
          RESET     ANS
          REP       UPPLOW,ANS
          MATCH     ANST,ANS
          GOTO      H2DP9100 IF EQUAL
          MATCH     ANSS,ANS
          GOTO      H2DP9200 IF EQUAL
          MATCH     SP70,ANS
          GOTO      H2DP9999 IF EQUAL
          BEEP
          GOTO      H2DP9000
.
H2DP9100  KEYIN     *P1:24,*EL,"Type :  ":
                    *V2LON,"1.",*HOFF," Length of Stay, ":
                    *V2LON,"2.",*HOFF," Cost 1, ":
                    *V2LON,"3.",*HOFF," Cost 2.  Enter Type : ",*V2LON,HISTTYPE
          BRANCH    HISTTYPE,H2DP9200,H2DP9200,H2DP9200
          BEEP
          GOTO      H2DP9100
.
H2DP9200  KEYIN     *P1:24,*EL,"Minimum Value : ",*V2LON,GPHISMIN,*HOFF:
                               "    Step : ",*V2LON,GPHISRAN,*HOFF:
                               "  Ok (",*V2LON,"Y",*HOFF,"/":
                                        *V2LON,"N",*HOFF,") ? ",*V2LON,ANS
          REP       UPPLOW,ANS
          MATCH     ANSY,ANS
          GOTO      H2DP0100 IF EQUAL
          GOTO      H2DP9200
.
H2DP9999  RETURN
.
.--------------------------------------------------
. Get Details for Level 3
.--------------------------------------------------
LV3DET00  PACK      KEY13,CCEALV3,CCEELV3
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      SP70,CCXHDES
          ENDIF
          SFORMAT   VAR,CCSTLEN
          MOVE      CCEELV3,VAR
          PACK      LEV3DESC,VAR,SP1,CCXHDES
          SFORMAT   VAR,127
          MOVE      CCEEFTC,CSTTOT
          MOVE      CCEETTC,INCTOT
.
          MATCH     "1",CCEAUST
          GOTO      LV3DET10 IF NOT EQUAL
.
          MOVE      CCEEFSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,FRCSDEV
          ASSIGN    CCEEFTC/CCEENEP,FRCXBAR
          ASSIGN    CCEEFMX-CCEEFMN,FRCRANG
.
          MOVE      CCEETSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,TOCSDEV
          ASSIGN    CCEETTC/CCEENEP,TOCXBAR
          ASSIGN    CCEETMX-CCEETMN,TOCRANG
.
          MOVE      CCEELSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,LOSSDEV
          ASSIGN    CCEELTO/CCEENEP,LOSXBAR
          ASSIGN    CCEELMX-CCEELMN,LOSRANG
          GOTO      LV3DET99
.
LV3DET10  MOVE      ZERO,FRCSDEV
          ASSIGN    CCEEFTC/CCEENEP,FRCXBAR
          MOVE      ZERO,FRCRANG
.
          MOVE      ZERO,TOCSDEV
          ASSIGN    CCEETTC/CCEENEP,TOCXBAR
          MOVE      ZERO,TOCRANG
.
          MOVE      ZERO,LOSSDEV
          MOVE      ZERO,CCEELMN
          MOVE      ZERO,CCEELMX
          ASSIGN    CCEELTO/CCEENEP,LOSXBAR
          MOVE      ZERO,LOSRANG
.
          MATCH     SP70,CCEASCM1
          IF        !@EQUAL
            ASSIGN    CCEEFTC+CCEEFMN+CCEEFMX+CCEEFSV,CSTTOT
            ASSIGN    CSTTOT/CCEENEP,FRCXBAR
            MOVE      CCEEFMX,FRCSDEV
            MOVE      CCEEFMN,FRCRANG
            MOVE      CCEEFTC,CCEEFMN
            MOVE      CCEEFSV,CCEEFMX
          ELSE
            MOVE      ZERO,CCEEFMN
            MOVE      ZERO,CCEEFMX
          ENDIF
.
          MATCH     SP70,CCEASCM2
          IF        !@EQUAL
            ASSIGN    CCEETTC+CCEETMN+CCEETMX+CCEETSV,INCTOT
            ASSIGN    INCTOT/CCEENEP,TOCXBAR
            MOVE      CCEETMX,TOCSDEV
            MOVE      CCEETMN,TOCRANG
            MOVE      CCEETTC,CCEETMN
            MOVE      CCEETSV,CCEETMX
          ELSE
            MOVE      ZERO,CCEETMN
            MOVE      ZERO,CCEETMX
          ENDIF
.
          GOTO      LV3DET99
.
LV3DET99  RETURN
SEL3LV00  CALL     RDCCEE1
          BRANCH   OVRCD,SEL2LV99
          MOVE     ONE,CASTDDEV
          CALL     LV3DET00
          MOVE     ZERO,CASTDDEV
.
          CALL     SC05L000
.
SEL3LV99  RETURN
.--------------------------------------------------------------------
. Graph Level 3 Casemix Analysis
.--------------------------------------------------------------------
GPH3LV00  MOVE     THREE,GRAPHLEV
.
          MOVE     ZERO,ACCEPT
          CALL     SCGOL000
.
          RETURN
.---------------------------------------------------------------------------
. Enter Casemix Code Level 3
.-------------------------------------------------------------------------------
KY03LV00  TOPIC     "CCXHKEY "
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          MOVE      CCEALV3,CCXHSTY
          MOVE      CCEALV3,KEY3
          CALL      RDCCST1
          SFORMAT   VAR,CCSTLEN
          MATCH     "1",CCSTJR
          IF        @EQUAL
            KEYIN     *PCCOL:CVERT,*V2LON,*JR,VAR
          ELSE
            KEYIN     *PCCOL:CVERT,*V2LON,VAR
          ENDIF
.
          MATCH     "1",CCSTZF
          IF        @EQUAL
            REP       " 0",VAR
          ENDIF
.
          DISPLAY     *PCCOL:CVERT,*V2LON,VAR
.
          ENDSET    VAR
          APPEND    SP70,VAR
          RESET     VAR
.
          MATCH     SP70,VAR
          GOTO      KY03LV90 IF EQUAL
.
          MATCH     "1",CCSTJR
          IF        @EQUAL
            ENDSET    VAR
          ENDIF
          CMATCH    EXITCHAR,VAR
          GOTO      KY03LV95 IF EQUAL
.
          CMATCH    QUEST,VAR
          GOTO      KY03LV10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCXHA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCXHKEY
          APPEND    SP70,CCXHKEY
          RESET     CCXHKEY
.
          MATCH     SP70,CCXHKEY
          GOTO      KY03LV00 IF EQUAL
          MOVE      CCXHKEY,VAR
.
          DISPLAY   *PCCOL:CVERT,*V2LON,VAR
KY03LV10
          RESET     VAR
          MATCH     "1",CCSTDE
          IF        @EQUAL
            TYPE      VAR
            GOTO      KY03LV15 IF EQUAL
            BEEP
            GOTO      KY03LV00
          ENDIF
KY03LV15
          MOVE      VAR,CCXHKEY
          PACK      KEY13,CCXHSTY,VAR
          CALL      RACCXH1
          BRANCH    OVRCD,KY03LV80
          CALL      RDCCXH1
          MOVE      ZERO,EXIT
          PACK      KEY30,CCEBLV1,CCEDLV2,CCXHKEY
          CALL      RDCCEE1
          IF        OVRCD=1
            MOVE      ZERO,CCEEFTC
            MOVE      ZERO,CCEEFMN
            MOVE      ZERO,CCEEFMX
            MOVE      ZERO,CCEEFSV
            MOVE      ZERO,CCEETTC
            MOVE      ZERO,CCEETMN
            MOVE      ZERO,CCEETMX
            MOVE      ZERO,CCEETSV
            MOVE      ZERO,CCEELTO
            MOVE      ZERO,CCEELMN
            MOVE      ZERO,CCEELMX
            MOVE      ZERO,CCEELSV
          ENDIF
          CALL      LV3DET00   * Calculate Details
          GOTO      KY03LV99
.
KY03LV80  MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KY03LV99,KY03LV99
          MOVE      "Code Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KY03LV00
.
KY03LV85  MOVE      SP70,CCXHKEY
          MOVE      ZERO,EXIT
          GOTO      KY03LV99
.
KY03LV90  MOVE      SP70,CCXHKEY
          MOVE      SP70,SAVEID
          MOVE      ONE,EXIT
          GOTO      KY03LV99
.
KY03LV95  MOVE      TWO,EXIT
.
KY03LV99  SFORMAT   VAR,127
          TOPIC     PRGID
          RETURN
.----------------------------------------------------------------------
. Calculate Values for Histogram
.----------------------------------
. GPHISVAL FORM  5[15]   Histogram Values 1 to 15
. GPHISOVR FORM  5       Histogram Value > 15
. GPHISUND FORM  5       Histogram Value < 1
. GPHISRHD DIM   12      Range Heading
. GPHISCHD DIM   12      Count Heading
. GPHISHED DIM   50      General Heading
. GPHISTOT FORM  5       Total
. GPHISMIN FORM  10      Minimum   Eg Start at 1000
. GPHISRAN FORM  10      Range     Increment by 1000
. GPHISMAX FORM  5       Maximum
. GPHISSCL FORM  5       Scale
. GPHISCNT FORM  2       Scale
.----------------------------------------------------------------------
H3DP0000  ASSIGN    CCEBLMN,GPHISMIN
          IF        GPHISMIN=0
            MOVE      "1",GPHISMIN
          ENDIF
          MOVE      "1",HISTTYPE
          MOVE      "1",GPHISRAN
H3DP0100  IF        HISTTYPE=1
            MOVE      "L.O.S.",GPHISRHD
          ELSE
            MOVE      "Cost",GPHISRHD
          ENDIF
          MOVE      "Episodes",GPHISCHD
          SFORMAT   VAR,CCSTLEN
          MOVE      CCXHKEY,VAR
          PACK      GPHISHED,VAR,SP1,CCXHDES
          SFORMAT   VAR,127
.
          MOVE      ZERO,GPHISCNT
          REPEAT
            ADD       ONE,GPHISCNT
            MOVE      ZERO,GPHISVAL[GPHISCNT]
          UNTIL     (GPHISCNT=15)
          MOVE      ZERO,GPHISOVR
          MOVE      ZERO,GPHISUND
.
          PACK      KEY48,CCEELV1,CCEELV2,CCEELV3,SP70
          CALL      RSCCEC2
H3DP1000  CALL      RKCCEC2
          BRANCH    OVRCD,H3DP9000
          MATCH     CCEELV1,CCECLV1
          GOTO      H3DP9000 IF NOT EQUAL
          MATCH     CCEELV2,CCECLV2
          GOTO      H3DP9000 IF NOT EQUAL
          MATCH     CCEELV3,CCECLV3
          GOTO      H3DP9000 IF NOT EQUAL
.
          LOAD      F12P2,HISTTYPE,CCECLOS,CCECFTC,CCECTTC
          ASSIGN    (F12P2-GPHISMIN)/GPHISRAN,F12P2
          MOVE      F12P2,GPHISCNT
          ADD       ONE,GPHISCNT
          IF        GPHISCNT<1
            ADD       ONE,GPHISUND
            GOTO      H3DP1000
          ENDIF
          IF        GPHISCNT>15
            ADD       ONE,GPHISOVR
            GOTO      H3DP1000
          ENDIF
.
          ADD       ONE,GPHISVAL[GPHISCNT]
          GOTO      H3DP1000
.
H3DP9000  CALL      GPHISDIS
          KEYIN     *P1:24,*EL,*V2LON,"S",*HOFF,"cale, ":
                               *V2LON,"T",*HOFF,"ype, Hit <":
                               *V2LON,"Enter",*HOFF,"> to Exit : ",ANS
          ENDSET    ANS
          APPEND    SP70,ANS
          RESET     ANS
          REP       UPPLOW,ANS
          MATCH     ANST,ANS
          GOTO      H3DP9100 IF EQUAL
          MATCH     ANSS,ANS
          GOTO      H3DP9200 IF EQUAL
          MATCH     SP70,ANS
          GOTO      H3DP9999 IF EQUAL
          BEEP
          GOTO      H3DP9000
.
H3DP9100  KEYIN     *P1:24,*EL,"Type :  ":
                    *V2LON,"1.",*HOFF," Length of Stay, ":
                    *V2LON,"2.",*HOFF," Cost 1, ":
                    *V2LON,"3.",*HOFF," Cost 2.  Enter Type : ",*V2LON,HISTTYPE
          BRANCH    HISTTYPE,H3DP9200,H3DP9200,H3DP9200
          BEEP
          GOTO      H3DP9100
.
H3DP9200  KEYIN     *P1:24,*EL,"Minimum Value : ",*V2LON,GPHISMIN,*HOFF:
                               "    Step : ",*V2LON,GPHISRAN,*HOFF:
                               "  Ok (",*V2LON,"Y",*HOFF,"/":
                                        *V2LON,"N",*HOFF,") ? ",*V2LON,ANS
          REP       UPPLOW,ANS
          MATCH     ANSY,ANS
          GOTO      H3DP0100 IF EQUAL
          GOTO      H3DP9200
.
H3DP9999  RETURN
.
.------------------------------------------------------------
. Get Episode & Cost Details
.------------------------------------------------------------
GETEPS00  PACK     KEY18,CCECHCD,CCECEPS
          CALL     RDCCEP1
.
          MOVE     ZERO,CSTFDR
          MOVE     ZERO,CSTFID
          MOVE     ZERO,CSTVDR
          MOVE     ZERO,CSTVID
          MOVE     CCECFTC,CSTTOT
          MOVE     ZERO,INCFDR
          MOVE     ZERO,INCFID
          MOVE     ZERO,INCVDR
          MOVE     ZERO,INCVID
          MOVE     CCECTTC,INCTOT
          MOVE     ZERO,VARFDR
          MOVE     ZERO,VARFID
          MOVE     ZERO,VARVDR
          MOVE     ZERO,VARVID
          ASSIGN   CCECTTC-CCECFTC,VARTOT
          MATCH    SP70,CCEASCM1
          GOTO     GETEPS99 IF EQUAL
.
          PACK     KEY21,CCECHCD,CCECEPS,CCEASCM1
          CALL     RDCCRB1
          BRANCH   OVRCD,GETEPS99
          MOVE     CCRBFDR,CSTFDR
          MOVE     CCRBFID,CSTFID
          MOVE     CCRBVDR,CSTVDR
          MOVE     CCRBVID,CSTVID
.
          MATCH    SP70,CCEASCM2
          GOTO     GETEPS99 IF EQUAL
.
          PACK     KEY21,CCECHCD,CCECEPS,CCEASCM2
          CALL     RDCCRB1
          BRANCH   OVRCD,GETEPS99
.
          MOVE     CCRBFDR,INCFDR
          MOVE     CCRBFID,INCFID
          MOVE     CCRBVDR,INCVDR
          MOVE     CCRBVID,INCVID
.
          ASSIGN   CCRBFDR-CSTFDR,VARFDR
          ASSIGN   CCRBFID-CSTFID,VARFID
          ASSIGN   CCRBVDR-CSTVDR,VARVDR
          ASSIGN   CCRBVID-CSTVID,VARVID
.
GETEPS99  RETURN
.
SELEPS00  CALL     RDCCEC2
          BRANCH   OVRCD,SELEPS99
          PACK     KEY18,CCEAHCD,CCECEPS
.
          CALL     GETEPS00
.
          MOVE     CCXHDES,KEY35
          MOVE     SP70,DESC01
          MOVE     SP70,DESC02
          MOVE     SP70,DESC03
.
          PACK     KEY13,CCEALV1,CCECLV1
          CALL     RDCCXH1
          IF       OVRCD=0
            MOVE     CCXHDES,DESC01
          ENDIF
.
          PACK     KEY13,CCEALV2,CCECLV2
          CALL     RDCCXH1
          IF       OVRCD=0
            MOVE     CCXHDES,DESC02
          ENDIF
.
          PACK     KEY13,CCEALV3,CCECLV3
          CALL     RDCCXH1
          IF       OVRCD=0
            MOVE     CCXHDES,DESC03
          ENDIF
.
          MOVE     KEY35,CCXHDES
.
. Display Episode Details Screen
.
          CALL     SCESL000
.
SELEPS99  RETURN
.------------------------------------------------------------
. Get Item Details
.------------------------------------------------------------
PCDDET00  PACK      KEY10,CCUPHCD,CCUPDPT
          CALL      RDCCDP1
.
          PACK      KEY18,CCUPHCD,CCUPDPT,CCUPPCD
          CALL      RDCCPD1
.
          MATCH     SP70,CCEASCM1
          GOTO      PCDDET80 IF EQUAL
.
          CALL      GETSPL00
          GOTO      PCDDET99
.
. Normal Cost Model Calculation
.------------------------------------------------------------
PCDDET80  CALL      CALFR000
.
          CALL      CALTO000
.
PCDDET99  RETURN
.------------------------------------------------------------
. Calculate "From" Comparision Costs
.------------------------------------------------------------
CALFR000  PACK      KEY18,CCEAFYR,CCEAFCM,CCUPHCD,CCUPPCD
          CALL      RDCCMS1
          IF        OVRCD=1
            PACK      KEY26,CCEAFYR,CCEAFCM,CCUPHCD,CCUPDPT,CCUPPCD
            CALL      RDCCMT1
            IF        OVRCD=1
              MOVE      ZERO,CCMSUCT
              MOVE      ZERO,CCMSFIX
              MOVE      ZERO,CCMSFUC
            ELSE
              MOVE      CCMTUCT,CCMSUCT
              MOVE      CCMTFIX,CCMSFIX
              MOVE      CCMTFUC,CCMSFUC
            ENDIF
          ENDIF
.
          IF        CCMSFIX=1
            ASSIGN    CCUPQTY*CCMSFUC,COST1AMT
          ELSE
            ASSIGN    CCUPQTY*CCMSUCT,COST1AMT
          ENDIF
          RETURN
.------------------------------------------------------------
. Calculate "To" Comparision Costs
.------------------------------------------------------------
CALTO000  PACK      KEY18,CCEATYR,CCEATCM,CCUPHCD,CCUPPCD
          CALL      RDCCMS1
          IF        OVRCD=1
            PACK      KEY26,CCEATYR,CCEATCM,CCUPHCD,CCUPDPT,CCUPPCD
            CALL      RDCCMT1
            IF        OVRCD=1
              MOVE      ZERO,CCMSUCT
              MOVE      ZERO,CCMSFIX
              MOVE      ZERO,CCMSFUC
            ELSE
              MOVE      CCMTUCT,CCMSUCT
              MOVE      CCMTFIX,CCMSFIX
              MOVE      CCMTFUC,CCMSFUC
            ENDIF
          ENDIF
          IF        CCMSFIX=1
            ASSIGN    CCUPQTY*CCMSFUC,COST2AMT
          ELSE
            ASSIGN    CCUPQTY*CCMSUCT,COST2AMT
          ENDIF
          RETURN
.------------------------------------------------------------
. Get Split Cost Model Details
.------------------------------------------------------------
GETSPL00  PACK      KEY21,CCEASCM1,CCUPHCD,CCUPDPT,CCUPPCD
          CALL      RDCCRA1
          IF        OVRCD=0
            ASSIGN    (CCRAFDR+CCRAFID+CCRAVDR+CCRAVID)*CCUPQTY,COST1AMT
          ELSE
            MOVE    ZERO,COST1AMT
          ENDIF
.
          MOVE      ZERO,COST2AMT
          MATCH     SP70,CCEASCM2
          GOTO      GETSPL99 IF EQUAL
.
          PACK      KEY21,CCEASCM2,CCUPHCD,CCUPDPT,CCUPPCD
          CALL      RDCCRA1
          IF        OVRCD=0
            ASSIGN    (CCRAFDR+CCRAFID+CCRAVDR+CCRAVID)*CCUPQTY,COST2AMT
          ELSE
            MOVE    ZERO,COST2AMT
          ENDIF
.
GETSPL99  RETURN
.
.--------------------------------------------------------------------
. Graph Level 1 Casemix Analysis
.--------------------------------------------------------------------
GRAPH000  CALL    OPNGRAPH
.
          MOVE    "10",GPHNOCOX
          MOVE    "30",GPHNOCOY
          MOVE    ZERO,GPHNTYP
          MOVE    ONE,SECTOR
.
          IF      GPHEPS=1
            MOVE    "No. of Episodes",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
.
          IF      GPHLTO=1
            MOVE    "Total LOS",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHLAV=1
            MOVE    "Avg. LOS",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHLMN=1
            MOVE    "Min. LOS",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHLMX=1
            MOVE    "Max. LOS",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
.
          IF      GPHFTO=1
            MOVE    "Total Cost 1",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHFAV=1
            MOVE    "Avg. Cost 1",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHFMN=1
            MOVE    "Min. Cost 1",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHFMX=1
            MOVE    "Max. Cost 1",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
.
          IF      GPHTTO=1
            MOVE    "Total Cost 2",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHTAV=1
            MOVE    "Avg. Cost 2",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHTMN=1
            MOVE    "Min. Cost 2",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHTMX=1
            MOVE    "Max. Cost 2",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
.
          IF      GPHNTYP=GPHNOCOY
            ADD     ONE,GPHNOCOX
            ADD     ONE,GPHNOCOY
          ENDIF
          IF      GPHNTYP>GPHNOCOY
            MOVE    GPHNTYP,GPHNOCOX
            MOVE    GPHNTYP,GPHNOCOY
            ADD     ONE,GPHNOCOX
            ADD     ONE,GPHNOCOY
          ENDIF
.
          MOVE      ZERO,CCPERCNT
          DISPLAY   *P70:2,*BLINKON," Loading "
          BRANCH    GRAPHLEV,GRAPH100,GRAPH200,GRAPH300
.
GRAPH100  CALL     L1GPH000
          CLEAR    GPHNAME
          APPEND   "Casemix Extract Level 1 - ",GPHNAME
          STRIP    CLV1DES
          APPEND   CLV1DES,GPHNAME
          RESET    GPHNAME
          GOTO     GRAPH800
.
GRAPH200  CALL     L2GPH000
          CLEAR    GPHNAME
          APPEND   "Casemix Extract Level 2 - ",GPHNAME
          STRIP    CLV2DES
          APPEND   CLV2DES,GPHNAME
          RESET    GPHNAME
          GOTO     GRAPH800
.
GRAPH300  CALL     L3GPH000
          CLEAR    GPHNAME
          APPEND   "Casemix Extract Level 3 - ",GPHNAME
          STRIP    CLV3DES
          APPEND   CLV3DES,GPHNAME
          RESET    GPHNAME
          GOTO     GRAPH800
.
GRAPH800  MOVE    ZERO,HLEF
          HLINE   *G37,2,70,80
          CALL    GETSCR00
.
          MOVE    ONE,GPHTYPE
          CALL    DISGRAPH
          CALL    CLSGRAPH
.
          CALL    PUTSCR00
.
          RETURN
.
GRAPHWRT  ADD     ONE,F3
          MOVE    F3,SCGPITM
          MOVE     F12P2,SCGPVAL
          PACK    KEY6,SCGPPER,SCGPITM
          CALL    RASCGP1
          IF      OVRCD=0
            CALL    UPSCGP1
          ELSE
            CALL    WRSCGP1
          ENDIF
          RETURN
.--------------------------------------------------------
. Graph Casemix Level 1
.--------------------------------------------------------
L1GPH000  MOVE      ZERO,SECTOR
          PACK      KEY10,SP70
          CALL      RSCCEB1
L1GPH100  CALL      RKCCEB1
          BRANCH    OVRCD,L1GPH200
          ADD       ONE,SECTOR
          COMPARE   "100",SECTOR
          GOTO      L1GPH200 IF EQUAL
.
          PACK      KEY13,CCEALV1,CCEBLV1
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      SP70,CCXHDES
          ENDIF
.
          ADD       ONE,CCPERCNT
          MOVE      CCPERCNT,SCGPPER
          SFORMAT   VAR,CCSTLEN
          MOVE      CCEBLV1,VAR
          PACK      SCGPDES,VAR,SP1,CCXHDES     * mmm yy
          SFORMAT   VAR,127
          MOVE      ONE,F3
.
          IF      GPHEPS=1
            MOVE     CCEBNEP,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHLTO=1
            MOVE     CCEBLTO,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLAV=1
            ASSIGN   CCEBLTO/CCEBNEP,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLMN=1
            MOVE     CCEBLMN,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLMX=1
            MOVE     CCEBLMX,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHFTO=1
            MOVE     CCEBFTC,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFAV=1
            ASSIGN   CCEBFTC/CCEBNEP,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFMN=1
            MOVE     CCEBFMN,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFMX=1
            MOVE     CCEBFMX,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHTTO=1
            MOVE     CCEBTTC,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHTAV=1
            ASSIGN   CCEBTTC/CCEBNEP,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHTMN=1
            MOVE     CCEBTMN,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHTMX=1
            MOVE     CCEBTMX,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          GOTO    L1GPH100
.
L1GPH200
          RETURN
.--------------------------------------------------------
. Graph Casemix Level 2
.--------------------------------------------------------
L2GPH000  MOVE      ZERO,SECTOR
          PACK      KEY20,CCEBLV1,SP70
          CALL      RSCCED1
L2GPH100  CALL      RKCCED1
          BRANCH    OVRCD,L2GPH200
          MATCH     CCEDLV1,CCEBLV1
          GOTO      L2GPH200 IF NOT EQUAL
          ADD       ONE,SECTOR
          COMPARE   "100",SECTOR
          GOTO      L2GPH200 IF EQUAL
.
          PACK      KEY13,CCEALV2,CCEDLV2
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      SP70,CCXHDES
          ENDIF
.
          ADD       ONE,CCPERCNT
          MOVE      CCPERCNT,SCGPPER
          SFORMAT   VAR,CCSTLEN
          MOVE      CCEDLV2,VAR
          PACK      SCGPDES,VAR,SP1,CCXHDES     * mmm yy
          SFORMAT   VAR,127
          MOVE      ONE,F3
.
          IF      GPHEPS=1
            MOVE     CCEDNEP,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHLTO=1
            MOVE     CCEDLTO,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLAV=1
            ASSIGN   CCEDLTO/CCEDNEP,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLMN=1
            MOVE     CCEDLMN,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLMX=1
            MOVE     CCEDLMX,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHFTO=1
            MOVE     CCEDFTC,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFAV=1
            ASSIGN   CCEDFTC/CCEDNEP,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFMN=1
            MOVE     CCEDFMN,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFMX=1
            MOVE     CCEDFMX,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHTTO=1
            MOVE     CCEDTTC,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHTAV=1
            ASSIGN   CCEDTTC/CCEDNEP,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHTMN=1
            MOVE     CCEDTMN,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHTMX=1
            MOVE     CCEDTMX,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          GOTO    L2GPH100
.
L2GPH200
          RETURN
.--------------------------------------------------------
. Graph Casemix Level 3
.--------------------------------------------------------
L3GPH000  MOVE      ZERO,SECTOR
          PACK      KEY20,CCEBLV1,SP70
          CALL      RSCCEE1
L3GPH100  CALL      RKCCEE1
          BRANCH    OVRCD,L3GPH200
          MATCH     CCEELV1,CCEBLV1
          GOTO      L3GPH200 IF NOT EQUAL
          MATCH     CCEELV2,CCEDLV2
          GOTO      L3GPH200 IF NOT EQUAL
          ADD       ONE,SECTOR
          COMPARE   "100",SECTOR
          GOTO      L3GPH200 IF EQUAL
.
          PACK      KEY13,CCEALV3,CCEELV3
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      SP70,CCXHDES
          ENDIF
.
          ADD       ONE,CCPERCNT
          MOVE      CCPERCNT,SCGPPER
          SFORMAT   VAR,CCSTLEN
          MOVE      CCEELV3,VAR
          PACK      SCGPDES,VAR,SP1,CCXHDES     * mmm yy
          SFORMAT   VAR,127
          MOVE      ONE,F3
.
          IF      GPHEPS=1
            MOVE     CCEENEP,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHLTO=1
            MOVE     CCEELTO,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLAV=1
            ASSIGN   CCEELTO/CCEENEP,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLMN=1
            MOVE     CCEELMN,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLMX=1
            MOVE     CCEELMX,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHFTO=1
            MOVE     CCEEFTC,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFAV=1
            ASSIGN   CCEEFTC/CCEENEP,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFMN=1
            MOVE     CCEEFMN,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFMX=1
            MOVE     CCEEFMX,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHTTO=1
            MOVE     CCEETTC,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHTAV=1
            ASSIGN   CCEETTC/CCEENEP,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHTMN=1
            MOVE     CCEETMN,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHTMX=1
            MOVE     CCEETMX,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          GOTO    L3GPH100
.
L3GPH200
          RETURN
.
GPHEPS00  IF      GPHEPS=0
            MOVE    ONE,GPHEPS
          ELSE
            MOVE    ZERO,GPHEPS
          ENDIF
          RETURN
.
GPHLTO00  IF      GPHLTO=0
            MOVE    ONE,GPHLTO
          ELSE
            MOVE    ZERO,GPHLTO
          ENDIF
          RETURN
.
GPHLAV00  IF      GPHLAV=0
            MOVE    ONE,GPHLAV
          ELSE
            MOVE    ZERO,GPHLAV
          ENDIF
          RETURN
.
GPHLMX00  IF      GPHLMX=0
            MOVE    ONE,GPHLMX
          ELSE
            MOVE    ZERO,GPHLMX
          ENDIF
          RETURN
.
GPHLMN00  IF      GPHLMN=0
            MOVE    ONE,GPHLMN
          ELSE
            MOVE    ZERO,GPHLMN
          ENDIF
          RETURN
.
GPHFTO00  IF      GPHFTO=0
            MOVE    ONE,GPHFTO
          ELSE
            MOVE    ZERO,GPHFTO
          ENDIF
          RETURN
.
GPHFAV00  IF      GPHFAV=0
            MOVE    ONE,GPHFAV
          ELSE
            MOVE    ZERO,GPHFAV
          ENDIF
          RETURN
.
GPHFMX00  IF      GPHFMX=0
            MOVE    ONE,GPHFMX
          ELSE
            MOVE    ZERO,GPHFMX
          ENDIF
          RETURN
.
GPHFMN00  IF      GPHFMN=0
            MOVE    ONE,GPHFMN
          ELSE
            MOVE    ZERO,GPHFMN
          ENDIF
          RETURN
.
GPHTTO00  IF      GPHTTO=0
            MOVE    ONE,GPHTTO
          ELSE
            MOVE    ZERO,GPHTTO
          ENDIF
          RETURN
.
GPHTAV00  IF      GPHTAV=0
            MOVE    ONE,GPHTAV
          ELSE
            MOVE    ZERO,GPHTAV
          ENDIF
          RETURN
.
GPHTMX00  IF      GPHTMX=0
            MOVE    ONE,GPHTMX
          ELSE
            MOVE    ZERO,GPHTMX
          ENDIF
          RETURN
.
GPHTMN00  IF      GPHTMN=0
            MOVE    ONE,GPHTMN
          ELSE
            MOVE    ZERO,GPHTMN
          ENDIF
          RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CCSCEAIO/INC
          INC       CCSCEAKY    
          INC       CCSCEBIO/INC
          INC       CCSCECIO/INC
          INC       CCSCEDIO/INC
          INC       CCSCEEIO/INC
          INC       CCSCEFIO/INC
          INC       CCSCEGIO/INC
          INC       CCSCMAIO/INC
          INC       CCSCOPCD    
          INC       CCSDPTIO/INC
          INC       CCSEPSIO/INC
          INC       CCSHCDIO/INC
          INC       CCSMSCIO/INC
          INC       CCSMTSIO/INC
          INC       CCSPDPIO/INC
          INC       CCSRASIO/INC
          INC       CCSRBDIO/INC
          INC       CCSSPCIO/INC
          INC       CCSSTYIO/INC
          INC       CCSUPDIO/INC
          INC       CCSXHDIO/INC
          INC       CCSXHDKY    
          INC       GPHHISCD    
          INC       GPHSTDCD    
.
          INC       STDGENCD
.
