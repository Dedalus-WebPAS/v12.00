.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V10.01.01 16/12/2010  Mike Laming   CAR 233046
.           Mods to Misc.Charges PATMCHFD - Key change, logic changes
. V10.00.01 29/04/2010  J.Tan        CAR 220887
.           Checking for Active/Inactive of Misc.charge
. V9.03.01  16.09.2003  Lina Vo        CAR40497
.           Changed index and read of patmchgf to include Effective date.
. V9.02.01  09.07.2002  Glenn Saunders
.           Recompile for changes in includes shared with Southland, but with
.           previously different formats - now merged.  Includes effected :-
.           CCSCEAFD, CCSCONFD, CCSEPSFD, CCSHCDFD, CCSHLCFD, CCSIADFD
.-------------------------------------------------------
. V9.02.00  13.06.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.           Remove all PSN prefix PAS clone includes.
.-------------------------------------------------------
. V6.03.00  02.10.1995 B.G.Ackland
.           Release 6.03
. V6.03.02  30.10.1995 B.G.Ackland
.           Phase 1 WGH Changes
. V6.03.03  17.11.1995 B.G.Ackland
.           Casemix Type Mapping
. V6.04.01  07.07.1997 B.G.Ackland
.           File Layout Changes
.-------------------------------------------------------
CURRDATE  DIM       8
DOCTCODE  DIM       6
DOCTNAME  DIM       40
DOCTOTPC  FORM      12.2
ENDDOC    DIM       6
ENDDTY    DIM       3
ENDJCD    DIM       3
ENDMCC    DIM       3
ENDMGP    DIM       3
ENDSTY    DIM       3
F12P2     FORM      12.2
JCDTOTPC  FORM      12.2
JCDTOTSC  FORM      12.2
JCDTOTPQ  FORM      12.2
JCDTOTSQ  FORM      12.2
KEY21A    DIM       21
KEY26A    DIM       26
LASTCOD   DIM       3
LASTDOC   DIM       6
LASTDTY   DIM       3
LASTJCD   DIM       3
LASTKEY   DIM       10
LASTMCC   DIM       3
LASTMGP   DIM       3
LASTSPC   DIM       3
LASTSTY   DIM       3
MCCTOTPC  FORM      12.2
MCCTOTSC  FORM      12.2
MCCTOTPQ  FORM      12.2
MCCTOTSQ  FORM      12.2
MGPTOTPC  FORM      12.2
MGPTOTSC  FORM      12.2
MGPTOTPQ  FORM      12.2
MGPTOTSQ  FORM      12.2
NAMEDOS   DIM       12
NAMETYQ   DIM       12
PRICST    DIM       11
PRIQTY    DIM       9
SECCST    DIM       11
SECQTY    DIM       9
STRDOC    DIM       6
STRDTY    DIM       3
STRJCD    DIM       3
STRMCC    DIM       3
STRMGP    DIM       3
STRSTY    DIM       3
VMOFILOP  FORM      1
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACEA28
.   Function      :   Misc. & Journal Patient Service Map     
.   Generated  On :   04/01/2011
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CCSCONFD/INC
          INC       CCSSTYFD/INC
          INC       CCSXHDFD/INC
          INC       CEAMAPFD/INC
          INC       CEAMBPFD/INC
          INC       CEAMCPFD/INC
          INC       CEAMDPFD/INC
          INC       CEAMEPFD/INC
          INC       CEAPSCFD/INC
          INC       CEASPCFD/INC
          INC       CEAVAMFD/INC
          INC       CEAVBMFD/INC
          INC       PATCODFD/INC
          INC       PATDO1FD/INC
          INC       PATMCHFD/INC
.=========================
.Local Variable Definition
.-------------------------
REPTFMT   FORM      2 * Scr 01 Fld     4
FROMMGP   DIM      40 * Scr 01 Fld     5
TOMGP     DIM      40 * Scr 01 Fld     6
DESCFMT   DIM      20 * Scr 01 Fld     7
FROMMCC   DIM      40 * Scr 02 Fld     5
TOMCC     DIM      40 * Scr 02 Fld     6
FROMJCD   DIM      40 * Scr 03 Fld     5
TOJCD     DIM      40 * Scr 03 Fld     6
FROMDTY   DIM      40 * Scr 04 Fld     5
TODTY     DIM      40 * Scr 04 Fld     6
FROMDOC   DIM      40 * Scr 05 Fld     5
TODOC     DIM      40 * Scr 05 Fld     6
FROMSTY   DIM      40 * Scr 06 Fld     5
TOSTY     DIM      40 * Scr 06 Fld     6
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACEA28"
PRGNAM    INIT      "Misc. & Journal Patient Service Map     "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening ccsstyaf";
          OPEN      CCSSTYA1,"ccsstyaf"
          DISPLAY   *P56:24,"Opening ccsstyaf";
          OPEN      CCSSTYA2,"ccsstyaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA1,"ccsxhdaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA2,"ccsxhdaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA3,"ccsxhdaf"
          MOVE      "   64",AUDTSECT
          MOVE      " 39",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ceaaudps";
            OPEN      CEAAUDPS,"ceaaudps"
          ENDIF
          DISPLAY   *P56:24,"Opening  ceamapaf           ";
          OPEN      CEAMAPA1,"ceamapaf"          
          DISPLAY   *P56:24,"Opening ceambpaf";
          OPEN      CEAMBPA1,"ceambpaf"
          DISPLAY   *P56:24,"Opening ceamcpaf";
          OPEN      CEAMCPA1,"ceamcpaf"
          DISPLAY   *P56:24,"Opening ceamdpaf";
          OPEN      CEAMDPA1,"ceamdpaf"
          DISPLAY   *P56:24,"Opening ceamepaf";
          OPEN      CEAMEPA1,"ceamepaf"
          DISPLAY   *P56:24,"Opening ceapscaf";
          OPEN      CEAPSCA1,"ceapscaf"
          DISPLAY   *P56:24,"Opening ceaspcaf";
          OPEN      CEASPCA1,"ceaspcaf"
          DISPLAY   *P56:24,"Opening ceavamaf";
          OPEN      CEAVAMA1,"ceavamaf"
          DISPLAY   *P56:24,"Opening ceavbmaf";
          OPEN      CEAVBMA1,"ceavbmaf"
          DISPLAY   *P56:24,"Opening  patcodes           ";
          OPEN      PATCODE1,"patcodes"          
          DISPLAY   *P56:24,"Opening  patcodes           ";
          OPEN      PATCODE2,"patcodes"          
          DISPLAY   *P56:24,"Opening  patcodes           ";
          OPEN      PATCODE3,"patcodes"          
          DISPLAY   *P56:24,"Opening  patcodes           ";
          OPEN      PATCODE4,"patcodes"          
          DISPLAY   *P56:24,"Opening  patdo1af           ";
          OPEN      PATDO1A1,"patdo1af"          
          DISPLAY   *P56:24,"Opening  patdo1af           ";
          OPEN      PATDO1A2,"patdo1af"          
          DISPLAY   *P56:24,"Opening  patdo1af           ";
          OPEN      PATDO1A3,"patdo1af"          
          DISPLAY   *P56:24,"Opening  patmchgf           ";
          OPEN      PATMCHG1,"patmchgf"          
          DISPLAY   *P56:24,"Opening  patmchgf           ";
          OPEN      PATMCHG2,"patmchgf"          
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Report Options                     
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Misc Group Report                  
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Misc Code Mapping                  
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Journal Code Mapping               
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * VMO Doctor Type Mapping            
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * VMO Doctor Map Table               
          ENDIF
          MATCH     "06",SCRID
          IF         @EQUAL
            CALL       PS06L000   * Casmix Type Mapping Report         
          ENDIF
          RETURN
.--------------------------------
. Screen - Report Options                     
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Report Options                     
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Report Options                     
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Report Options                     
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Report Options                     
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Report Options                     
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Report Options                     
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Report Options                     
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105,SF00L106,SF00L107:
                            SF00L108
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          CALL      REPD0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L106
          CALL      SC05L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L107
          CALL      SC04L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L108
          CALL      SC06L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.--------------------------------
. Screen - Misc Group Report                  
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
          CALL      REPDEF00
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Misc Group Report                  
.-------------------------------------------------------
CF01L000
          MOVE      ZERO,REPTFMT 
          MOVE      SP70,FROMMGP 
          MOVE      SP70,TOMGP   
          MOVE      SP70,DESCFMT 
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Misc Group Report                  
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Misc Group Report                  
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Misc Group Report                  
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Misc Group Report                  
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Misc Group Report                  
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L101:
                            PS01L102,PS01L103,PS01L104
          GOTO     PS01L999
.
PS01L101
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      FROMMGP,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      TOMGP,VAR        
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      DESCFMT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Misc Group Report                  
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L104,SF01L006,SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L103:
                            SF01L104,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      REPA0000
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L103
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESCFMT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EFMTA000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L103
            ENDIF
            BRANCH    EXIT,SF01L103,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESCFMT,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L104
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOMGP   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RMGP0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L104
            ENDIF
            BRANCH    EXIT,SF01L104,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      FROMMGP,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOMGP,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
SF01L990  MOVE      FOUR,EXIT * Exit Char Exit
SF01L999  RETURN
.--------------------------------
. Screen - Misc Code Mapping                  
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
          CALL      REPDEF00
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Misc Code Mapping                  
.-------------------------------------------------------
CF02L000
          MOVE      ZERO,REPTFMT 
          MOVE      SP70,FROMMCC 
          MOVE      SP70,TOMCC   
          MOVE      SP70,DESCFMT 
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Misc Code Mapping                  
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Misc Code Mapping                  
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Misc Code Mapping                  
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Misc Code Mapping                  
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Misc Code Mapping                  
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L101:
                            PS02L102,PS02L103,PS02L104
          GOTO     PS02L999
.
PS02L101
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      FROMMCC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      TOMCC,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      DESCFMT,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Misc Code Mapping                  
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102,SF02L103:
                            SF02L104,SF02L006,SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L103:
                            SF02L104,SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L102
          CALL      REPB0000
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L103
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESCFMT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EFMTA000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L103
            ENDIF
            BRANCH    EXIT,SF02L103,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESCFMT,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L104
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOMCC   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RMCC0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L104
            ENDIF
            BRANCH    EXIT,SF02L104,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      FROMMCC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOMCC,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Journal Code Mapping               
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
          CALL      REPDEF00
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Journal Code Mapping               
.-------------------------------------------------------
CF03L000
          MOVE      ZERO,REPTFMT 
          MOVE      SP70,FROMJCD 
          MOVE      SP70,TOJCD   
          MOVE      SP70,DESCFMT 
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Journal Code Mapping               
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Journal Code Mapping               
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Journal Code Mapping               
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Journal Code Mapping               
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Journal Code Mapping               
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L101:
                            PS03L102,PS03L103,PS03L104
          GOTO     PS03L999
.
PS03L101
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      FROMJCD,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      TOJCD,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      DESCFMT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Journal Code Mapping               
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L103:
                            SF03L104,SF03L006,SF03L006
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L103:
                            SF03L104,SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L102
          CALL      REPC0000
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L103
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESCFMT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EFMTA000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L103
            ENDIF
            BRANCH    EXIT,SF03L103,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESCFMT,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L104
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOJCD   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RJCD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L104
            ENDIF
            BRANCH    EXIT,SF03L104,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      FROMJCD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOJCD,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - VMO Doctor Type Mapping            
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
          CALL      REPDEF00
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : VMO Doctor Type Mapping            
.-------------------------------------------------------
CF04L000
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for VMO Doctor Type Mapping            
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : VMO Doctor Type Mapping            
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : VMO Doctor Type Mapping            
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : VMO Doctor Type Mapping            
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : VMO Doctor Type Mapping            
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L999,PS04L101:
                            PS04L102,PS04L103,PS04L104
          GOTO     PS04L999
.
PS04L101
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      FROMDTY,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      TODTY,VAR        
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L104
          MOVE      DESCFMT,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : VMO Doctor Type Mapping            
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L102,SF04L103:
                            SF04L104,SF04L006,SF04L006
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L103:
                            SF04L104,SF04L020,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L102
          CALL      REPF0000
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L103
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESCFMT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EFMTA000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L103
            ENDIF
            BRANCH    EXIT,SF04L103,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESCFMT,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
.
SF04L104
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TODTY   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RDTY0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L104
            ENDIF
            BRANCH    EXIT,SF04L104,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      FROMDTY,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TODTY,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
SF04L990  MOVE      FOUR,EXIT * Exit Char Exit
SF04L999  RETURN
.--------------------------------
. Screen - VMO Doctor Map Table               
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC05L200
          CALL      CF05L000 * Clear Fields
          CALL      DOCDEF00
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : VMO Doctor Map Table               
.-------------------------------------------------------
CF05L000
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for VMO Doctor Map Table               
.--------------------------------------------------------
KY05L000
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : VMO Doctor Map Table               
.---------------------------------------------------------
WP05L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : VMO Doctor Map Table               
.---------------------------------------------------------
LM05L000
          RETURN
.---------------------------------------------------------
. Display Fields for : VMO Doctor Map Table               
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : VMO Doctor Map Table               
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L999,PS05L999,PS05L999,PS05L101:
                            PS05L102,PS05L103
          GOTO     PS05L999
.
PS05L101
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L102
          MOVE      FROMDOC,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L103
          MOVE      TODOC,VAR        
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : VMO Doctor Map Table               
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L006,SF05L101,SF05L102,SF05L103:
                            SF05L104,SF05L006
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L020,SF05L020,SF05L020,SF05L103:
                            SF05L104,SF05L020
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          GOTO     SF05L001
.
SF05L101
          MOVE      ZERO,EXIT
          GOTO      SF05L999
.
SF05L102
          CALL      REPE0000
          MOVE      ZERO,EXIT
          GOTO      SF05L999
.
SF05L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EFMTA000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L103
            ENDIF
            BRANCH    EXIT,SF05L103,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L104
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TODOC   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RDOC0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L104
            ENDIF
            BRANCH    EXIT,SF05L104,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      FROMDOC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TODOC,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF05L001
SF05L990  MOVE      ONE,EXIT * Exit Char Restart
SF05L999  RETURN
.--------------------------------
. Screen - Casmix Type Mapping Report         
.--------------------------------
SC06L000
SC06L100
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC06L200
          CALL      CF06L000 * Clear Fields
          CALL      DEFSTY00
SC06L300
          CALL      KY06L000 * Enter Key Fields
          BRANCH    EXIT,SC06L999,SC06L999
SC06L400
          CALL      WP06L000 * Load any WP Details
SC06L500
          CALL      LM06L000 * Load any Batch Details
SC06L600
          CALL      DF06L000 * Display Fields
SC06L700
          CALL      SF06L000 * Select Fields
          BRANCH    EXIT,SC06L100,SC06L100,SC06L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC06L800
SC06L900
SC06L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Casmix Type Mapping Report         
.-------------------------------------------------------
CF06L000
CF06L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Casmix Type Mapping Report         
.--------------------------------------------------------
KY06L000
          MOVE      ZERO,EXIT
          GOTO      KY06L999
.
KY06L900  MOVE      ONE,EXIT
KY06L999  RETURN
.---------------------------------------------------------
. Load WP files for : Casmix Type Mapping Report         
.---------------------------------------------------------
WP06L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Casmix Type Mapping Report         
.---------------------------------------------------------
LM06L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Casmix Type Mapping Report         
.---------------------------------------------------------
DF06L000
          BRANCH   ACCEPT,DF06L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF06L900
          MATCH    PRGID,SCPSPID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF06L010 IF NOT EQUAL
.
          CALL     PS06L000 * Display Field
          GOTO     DF06L010
DF06L900
DF06L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Casmix Type Mapping Report         
.---------------------------------------------------------
PS06L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS06L999,PS06L999,PS06L999,PS06L101:
                            PS06L102,PS06L103,PS06L104
          GOTO     PS06L999
.
PS06L101
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L102
          MOVE      FROMSTY,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L103
          MOVE      TOSTY,VAR        
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L104
          MOVE      DESCFMT,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
PS06L999
          RETURN
.---------------------------------------------------------
. Selections for : Casmix Type Mapping Report         
.---------------------------------------------------------
SF06L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF06L001  BRANCH   ACCEPT,SF06L020
.
SF06L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L006,SF06L101,SF06L102,SF06L103:
                            SF06L104,SF06L006,SF06L006
SF06L006  BEEP
          GOTO     SF06L005
SF06L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF06L090
          MATCH    PRGID,SCSLPID
          GOTO     SF06L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF06L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L020,SF06L020,SF06L020,SF06L103:
                            SF06L104,SF06L020,SF06L020
          GOTO     SF06L020
SF06L090  MOVE     ZERO,ACCEPT
          GOTO     SF06L001
.
SF06L101
          MOVE      ZERO,EXIT
          GOTO      SF06L999
.
SF06L102
          CALL      REPG0000
          MOVE      ZERO,EXIT
          GOTO      SF06L999
.
SF06L103
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DESCFMT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EFMTA000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF06L103
            ENDIF
            BRANCH    EXIT,SF06L103,SF06L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF06L990 IF EQUAL
          ENDIF
          MOVE      REPTFMT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DESCFMT,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF06L001
.
SF06L104
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOSTY   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RSTY0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF06L104
            ENDIF
            BRANCH    EXIT,SF06L104,SF06L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF06L990 IF EQUAL
          ENDIF
          MOVE      FROMSTY,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOSTY,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF06L001
SF06L990  MOVE      FOUR,EXIT * Exit Char Exit
SF06L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------
. Print Misc Group Mapping Report
.------------------------------------------------------------
REPD0000  DISPLAY   *P1:24,*EL,"Printing Report : ";
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
.
          MOVE      SP70,LASTCOD
          MOVE      SP70,LASTSPC
          PACK      KEY13,SP70
          CALL      RSCEMD1
REPD1000  CALL      RKCEMD1
          BRANCH    OVRCD,REPD9000
.
          MATCH     LASTCOD,CEMDCOD
          IF        !@EQUAL
            CALL      PRTDSC00
          ENDIF
.
          COMPARE   "55",CLNO
          CALL      HEDD0000 IF NOT LESS
.
          MATCH     LASTSPC,CEMDSPC
          IF        !@EQUAL
            MOVE       CEMDSPC,KEY3
            CALL       RDCESP1
            PRINT      *7,CEMDSPC,SP1,CESPDES;
            MOVE       CEMDSPC,LASTSPC
          ENDIF
.
          MOVE       CEMDPSC,KEY7
          CALL       RDCEPS1
          MOVE       "99,999.99",PRIQTY
          MOVE       "9999,999.99",PRICST
          FEDIT      CEMDQTY,PRIQTY
          ASSIGN     (CEPSST1+CEPSST2+CEPSST3+CEPSST4+CEPSST5)*CEMDQTY,F12P2
          FEDIT      F12P2,PRICST
          PRINT     *47,CEMDPSC,SP1,CEPSDES,SP1:
                    *112,PRIQTY,PRICST
          ADD       ONE,CLNO
          GOTO      REPD1000
.
REPD9000  CALL      UND132
          PRINT     *45,"***** End of Report *****"
          RETURN
.------------------------------------------------------------
. Page Header
.------------------------------------------------------------
HEDD0000  CALL      HEAD132
          DISPLAY   *P19:24,*V2LON,CPAGENO
          CALL      UND132
          PRINT     "Discharge Status                                   ":
                    "                                                   ":
                    "                             "
          PRINT     "      Service Provider                        Patie":
                    "nt Service                                         ":
                    "               Qty       Cost"
          CALL      UND132
          RETURN
.
PRTDSC00  COMPARE   "50",CLNO
          CALL      HEDD0000 IF NOT LESS
.
          ADD       ONE,CLNO
          MOVE      "D ",TCODE                                         * V90200
          PACK      KEY5,TCODE,CEMDCOD,SP70                            * V90200
          CALL      RDCODE1                                            * V90200
          MOVE      CEMDCOD,LASTCOD
          MOVE      SP70,LASTSPC
.
          PRINT     CEMDCOD,SP1,TDESC                                  * V90200
          PRINT      *7,CEMDSPC,SP1,CESPDES;
.
          RETURN
.
.------------------------------------------------------------
. Setup Report Defaults
.------------------------------------------------------------
REPDEF00  MOVE      SP70,STRMGP
          MOVE      Z70,ENDMGP
          MOVE      "Start                  ",FROMMGP
          MOVE      "Finish                 ",TOMGP
          MOVE      SP70,STRMCC
          MOVE      Z70,ENDMCC
          MOVE      "Start                  ",FROMMCC
          MOVE      "Finish                 ",TOMCC
          MOVE      SP70,STRJCD
          MOVE      Z70,ENDJCD
          MOVE      "Start                  ",FROMJCD
          MOVE      "Finish                 ",TOJCD
          MOVE      SP70,STRDTY
          MOVE      Z70,ENDDTY
          MOVE      "Start                  ",FROMDTY
          MOVE      "Finish                 ",TODTY
          MOVE      ZERO,REPTFMT
          MOVE      "Standard   ",DESCFMT
          RETURN
.------------------------------------------------------------
. Print Misc Group Mapping Report
.------------------------------------------------------------
REPA0000  DISPLAY   *P1:24,*EL,"Printing Report : ";
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
.
          MOVE      SP70,LASTMGP
          MOVE      SP70,LASTSPC
          PACK      KEY13,STRMGP,SP70
          CALL      RDCEMA1
          IF        OVRCD=0
            CALL      RPCEMA1
          ENDIF
REPA1000  CALL      RKCEMA1
          BRANCH    OVRCD,REPA9000
          MATCH     CEMAMGP,ENDMGP
          GOTO      REPA9000 IF LESS
.
          MATCH     LASTMGP,CEMAMGP
          IF        !@EQUAL
            CALL      PRTMGP00
          ENDIF
.
          COMPARE   "55",CLNO
          CALL      HEDA0000 IF NOT LESS
.
          MATCH     LASTSPC,CEMASPC
          IF        !@EQUAL
            MOVE       CEMASPC,KEY3
            CALL       RDCESP1
            PRINT      *7,CEMASPC,SP1,CESPDES;
            MOVE       CEMASPC,LASTSPC
          ENDIF
.
          MOVE       CEMAPSC,KEY7
          CALL       RDCEPS1
          MOVE       "99,999.99",PRIQTY
          MOVE       "99,999.99",SECQTY
          MOVE       "9999,999.99",PRICST
          MOVE       "9999,999.99",SECCST
          FEDIT      CEMADQTY,PRIQTY
          FEDIT      CEMATQTY,SECQTY
          ASSIGN     (CEPSST1+CEPSST2+CEPSST3+CEPSST4+CEPSST5)*CEMADQTY,F12P2
          FEDIT      F12P2,PRICST
          ADD        F12P2,MGPTOTPC       * Ward Primary Op Total
          ASSIGN     (CEPSST1+CEPSST2+CEPSST3+CEPSST4+CEPSST5)*CEMATQTY,F12P2
          FEDIT      F12P2,SECCST
          ADD        F12P2,MGPTOTSC
.
          PRINT     *47,CEMAPSC,SP1,CEPSDES,SP1:
                    PRIQTY,PRICST," |",SECQTY,SECCST
          ADD       ONE,CLNO
          GOTO      REPA1000
.
REPA9000  CALL      MGPTOT00
          PRINT     *45,"***** End of Report *****"
          RETURN
.------------------------------------------------------------
. Page Header
.------------------------------------------------------------
HEDA0000  CALL      HEAD132
          DISPLAY   *P19:24,*V2LON,CPAGENO
          PRINT     "Misc Group Mapping From : ",FROMMGP
          PRINT     "                   To   : ",TOMGP
          CALL      UND132
          PRINT     "Misc Group                                         ":
                    "                                                 pe":
                    "r Dollar |    per Transaction"
          PRINT     "      Service Provider                        Patie":
                    "nt Service                                   Qty   ":
                    "    Cost |      Qty      Cost"
          CALL      UND132
          RETURN
.
PRTMGP00  MATCH     SP70,LASTMGP
          CALL      MGPTOT00 IF NOT EQUAL
.
          COMPARE   "50",CLNO
          CALL      HEDA0000 IF NOT LESS
.
          ADD       ONE,CLNO
          MOVE      "FI",TCODE                                         * V90200
          PACK      KEY5,TCODE,CEMAMGP,SP70                            * V90200
          CALL      RDCODE1                                            * V90200
          MOVE      CEMAMGP,LASTMGP
          MOVE      SP70,LASTSPC
.
          PRINT     CEMAMGP,SP1,TDESC                                  * V90200
          PRINT      *7,CEMASPC,SP1,CESPDES;
.
          RETURN
.
MGPTOT00  CALL       UND132
          MOVE       "         ",PRIQTY
          MOVE       "         ",SECQTY
          MOVE       "9999,999.99",PRICST
          MOVE       "9999,999.99",SECCST
          FEDIT      MGPTOTPC,PRICST
          FEDIT      MGPTOTSC,SECCST
          PRINT     "Total",*91,PRIQTY,PRICST," |",SECQTY,SECCST
          ADD       ONE,CLNO
          CALL      UND132
          MOVE      ZERO,MGPTOTPC
          MOVE      ZERO,MGPTOTSC
MGPTOT99  RETURN
.
.------------------------------------------------------------
. Enter Report Format 0=Standard
.------------------------------------------------------------
EFMTA000   CALL      DFMTA000
           MOVE      ZERO,REPTFMT
EFMTA010   KEYIN     *PCCOL:CVERT,*V2LON,*RV,REPTFMT
           COMPARE   ZERO,REPTFMT
           GOTO      EFMTA900 IF EQUAL
           BEEP
           GOTO      EFMTA010
.
EFMTA900   MOVE      "Standard",DESCFMT
           GOTO      EFMTA999
.
EFMTA999   CALL      PUTSCR00
           RETURN
.
DFMTA000  MOVE      "19",HTOP
          MOVE      "50",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P55:20,*V2LON,*ULON,"Report Format",*HOFF:
                    *P52:21,*V2LON,"0. ",*HOFF,"Standard"
          RETURN
.
.------------------------------------------------------------
. Enter a Range Misc Groups
.------------------------------------------------------------
RMGP0000   MOVE     "    5",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           MOVE     "FI",TCODE                                         * V90200
           CALL     KPCODA00                                           * V90200
           BRANCH   EXIT,RMGP0100,RMGP0999
           MOVE     ACODE,STRMGP                                       * V90200
           PACK     FROMMGP,ACODE,SP1,TDESC                            * V90200
           GOTO     RMGP0140
RMGP0100   MOVE     "Start             ",FROMMGP
           MOVE     SP70,STRMGP
.
RMGP0140   MOVE     FROMMGP,VAR
           CALL     DISPITEM
.
RMGP0150   MOVE     "    6",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           MOVE     "FI",TCODE                                         * V90200
           CALL     KPCODA00                                           * V90200
           BRANCH   EXIT,RMGP0200,RMGP0999
           MOVE     ACODE,ENDMGP                                       * V90200
           PACK     TOMGP,ACODE,SP1,TDESC                              * V90200
           MATCH    STRMGP,ENDMGP
           GOTO     RMGP0999 IF EQUAL
           GOTO     RMGP0999 IF NOT LESS
           BEEP
           MOVE     "To Misc Group Must Be > From Misc Group - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RMGP0000
.
RMGP0200   MOVE     "Finish             ",TOMGP
           MOVE     "~~~~~~~~~~",ENDMGP
.
RMGP0999   MOVE     "    5",FLDID
           CALL     GETPOSIT
           RETURN
.------------------------------------------------------------
. Print Misc Group Mapping Report
.------------------------------------------------------------
REPB0000  DISPLAY   *P1:24,*EL,"Printing Report : ";
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
.
          MOVE      SP70,LASTMCC
          MOVE      SP70,LASTSPC
          PACK      KEY19,STRMCC,SP70
          CALL      RDCEMB1
          IF        OVRCD=0
            CALL      RPCEMB1
          ENDIF
REPB1000  CALL      RKCEMB1
          BRANCH    OVRCD,REPB9000
          MATCH     CEMBMCC,ENDMCC
          GOTO      REPB9000 IF LESS
.
          MATCH     LASTMCC,CEMBMCC
          IF        !@EQUAL
            CALL      PRTMCC00
          ENDIF
.
          COMPARE   "55",CLNO
          CALL      HEDB0000 IF NOT LESS
.
          MATCH     LASTSPC,CEMBSPC
          IF        !@EQUAL
            MOVE       CEMBSPC,KEY3
            CALL       RDCESP1
            PRINT      *7,CEMBSPC,SP1,CESPDES;
            MOVE       CEMBSPC,LASTSPC
          ENDIF
.
          MOVE       CEMBPSC,KEY7
          CALL       RDCEPS1
          MOVE       "99,999.99",PRIQTY
          MOVE       "99,999.99",SECQTY
          MOVE       "9999,999.99",PRICST
          MOVE       "9999,999.99",SECCST
          FEDIT      CEMBDQTY,PRIQTY
          FEDIT      CEMBTQTY,SECQTY
          ASSIGN     (CEPSST1+CEPSST2+CEPSST3+CEPSST4+CEPSST5)*CEMBDQTY,F12P2
          FEDIT      F12P2,PRICST
          ADD        F12P2,MCCTOTPC       * Ward Primary Op Total
          ASSIGN     (CEPSST1+CEPSST2+CEPSST3+CEPSST4+CEPSST5)*CEMBTQTY,F12P2
          FEDIT      F12P2,SECCST
          ADD        F12P2,MCCTOTSC
.
          PRINT     *47,CEMBPSC,SP1,CEPSDES,SP1:
                    PRIQTY,PRICST," |",SECQTY,SECCST
          ADD       ONE,CLNO
          GOTO      REPB1000
.
REPB9000  CALL      MCCTOT00
          PRINT     *45,"***** End of Report *****"
          RETURN
.------------------------------------------------------------
. Page Header
.------------------------------------------------------------
HEDB0000  CALL      HEAD132
          DISPLAY   *P19:24,*V2LON,CPAGENO
          PRINT     "Misc Code  Mapping From : ",FROMMCC
          PRINT     "                   To   : ",TOMCC
          CALL      UND132
          PRINT     "Misc Code                                          ":
                    "                                                 pe":
                    "r Dollar |    per Transaction"
          PRINT     "      Service Provider                        Patie":
                    "nt Service                                   Qty   ":
                    "    Cost |      Qty      Cost"
          CALL      UND132
          RETURN
.
PRTMCC00  MATCH     SP70,LASTMCC
          CALL      MCCTOT00 IF NOT EQUAL
.
          COMPARE   "50",CLNO
          CALL      HEDB0000 IF NOT LESS
.
          ADD       ONE,CLNO
          UNPACK    SP30,MHFUND,PTMCHFTT
          MOVE      "0  ",MCLMCOD                                      * V90200
          PACK      KEY29,MCLMCOD,SP6,SP3,CEMBMCC,SP20                *C-233046
          CALL      PATMCHRD                * read Misc.Charges file
          COMPARE   ZERO,EXIT
          GOTO      PRTMCC90 IF EQUAL
.
PRTMCC80  MOVE      SP70,MDESC
.
PRTMCC90  MOVE      CEMBMCC,LASTMCC
          MOVE      SP70,LASTSPC
.
          PRINT     CEMBMCC,SP1,MDESC                                  * V90200
          PRINT      *7,CEMBSPC,SP1,CESPDES;
.
          RETURN
.
MCCTOT00  CALL       UND132
          MOVE       "         ",PRIQTY
          MOVE       "         ",SECQTY
          MOVE       "9999,999.99",PRICST
          MOVE       "9999,999.99",SECCST
          FEDIT      MCCTOTPC,PRICST
          FEDIT      MCCTOTSC,SECCST
          PRINT     "Total",*91,PRIQTY,PRICST," |",SECQTY,SECCST
          ADD       ONE,CLNO
          CALL      UND132
          MOVE      ZERO,MCCTOTPC
          MOVE      ZERO,MCCTOTSC
MCCTOT99  RETURN
.
.------------------------------------------------------------
. Enter a Range Misc Groups
.------------------------------------------------------------
RMCC0000   MOVE     "    5",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           MOVE     "0",CKEYTYP
           CALL     KPMCHA00                                           * V90200
           BRANCH   EXIT,RMCC0100,RMCC0999
           MOVE     MCHARGE,STRMCC                                     * V90200
           PACK     FROMMCC,MCHARGE,SP1,MDESC                          * V90200
           GOTO     RMCC0140
RMCC0100   MOVE     "Start             ",FROMMCC
           MOVE     SP70,STRMCC
.
RMCC0140   MOVE     FROMMCC,VAR
           CALL     DISPITEM
.
RMCC0150   MOVE     "    6",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           CALL     KPMCHA00                                           * V90200
           BRANCH   EXIT,RMCC0200,RMCC0999
           MOVE     MCHARGE,ENDMCC                                     * V90200
           PACK     TOMCC,MCHARGE,SP1,MDESC                            * V90200
           MATCH    STRMCC,ENDMCC
           GOTO     RMCC0999 IF EQUAL
           GOTO     RMCC0999 IF NOT LESS
           BEEP
           MOVE     "To Misc Code Must Be > From Misc Code - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RMCC0000
.
RMCC0200   MOVE     "Finish             ",TOMCC
           MOVE     "~~~~~~~~~",ENDMCC
.
RMCC0999   MOVE     "    5",FLDID
           CALL     GETPOSIT
           RETURN
.------------------------------------------------------------
. Print Misc Group Mapping Report
.------------------------------------------------------------
REPC0000  DISPLAY   *P1:24,*EL,"Printing Report : ";
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
.
          MOVE      SP70,LASTJCD
          MOVE      SP70,LASTSPC
          PACK      KEY13,STRJCD,SP70
          CALL      RDCEMC1
          IF        OVRCD=0
            CALL      RPCEMC1
          ENDIF
REPC1000  CALL      RKCEMC1
          BRANCH    OVRCD,REPC9000
          MATCH     CEMCJCD,ENDJCD
          GOTO      REPC9000 IF LESS
.
          MATCH     LASTJCD,CEMCJCD
          IF        !@EQUAL
            CALL      PRTJCD00
          ENDIF
.
          COMPARE   "55",CLNO
          CALL      HEDC0000 IF NOT LESS
.
          MATCH     LASTSPC,CEMCSPC
          IF        !@EQUAL
            MOVE       CEMCSPC,KEY3
            CALL       RDCESP1
            PRINT      *7,CEMCSPC,SP1,CESPDES;
            MOVE       CEMCSPC,LASTSPC
          ENDIF
.
          MOVE       CEMCPSC,KEY7
          CALL       RDCEPS1
          MOVE       "99,999.99",PRIQTY
          MOVE       "99,999.99",SECQTY
          MOVE       "9999,999.99",PRICST
          MOVE       "9999,999.99",SECCST
          FEDIT      CEMCDQTY,PRIQTY
          FEDIT      CEMCTQTY,SECQTY
          ASSIGN     (CEPSST1+CEPSST2+CEPSST3+CEPSST4+CEPSST5)*CEMCDQTY,F12P2
          FEDIT      F12P2,PRICST
          ADD        F12P2,JCDTOTPC       * Ward Primary Op Total
          ASSIGN     (CEPSST1+CEPSST2+CEPSST3+CEPSST4+CEPSST5)*CEMCTQTY,F12P2
          FEDIT      F12P2,SECCST
          ADD        F12P2,JCDTOTSC
.
          PRINT     *47,CEMCPSC,SP1,CEPSDES,SP1:
                    PRIQTY,PRICST," |",SECQTY,SECCST
          ADD       ONE,CLNO
          GOTO      REPC1000
.
REPC9000  CALL      JCDTOT00
          PRINT     *45,"***** End of Report *****"
          RETURN
.------------------------------------------------------------
. Page Header
.------------------------------------------------------------
HEDC0000  CALL      HEAD132
          DISPLAY   *P19:24,*V2LON,CPAGENO
          PRINT     "Misc Group Mapping From : ",FROMJCD
          PRINT     "                   To   : ",TOJCD
          CALL      UND132
          PRINT     "Misc Group                                         ":
                    "                                                 pe":
                    "r Dollar |    per Transaction"
          PRINT     "      Service Provider                        Patie":
                    "nt Service                                   Qty   ":
                    "    Cost |      Qty      Cost"
          CALL      UND132
          RETURN
.
PRTJCD00  MATCH     SP70,LASTJCD
          CALL      JCDTOT00 IF NOT EQUAL
.
          COMPARE   "50",CLNO
          CALL      HEDC0000 IF NOT LESS
.
          ADD       ONE,CLNO
          MOVE      "J ",TCODE                                         * V90200
          PACK      KEY5,TCODE,CEMCJCD,SP70                            * V90200
          CALL      RDCODE1                                            * V90200
          MOVE      CEMCJCD,LASTJCD
          MOVE      SP70,LASTSPC
.
          PRINT     CEMCJCD,SP1,TDESC                                  * V90200
          PRINT      *7,CEMCSPC,SP1,CESPDES;
.
          RETURN
.
JCDTOT00  CALL       UND132
          MOVE       "         ",PRIQTY
          MOVE       "         ",SECQTY
          MOVE       "9999,999.99",PRICST
          MOVE       "9999,999.99",SECCST
          FEDIT      JCDTOTPC,PRICST
          FEDIT      JCDTOTSC,SECCST
          PRINT     "Total",*91,PRIQTY,PRICST," |",SECQTY,SECCST
          ADD       ONE,CLNO
          CALL      UND132
          MOVE      ZERO,JCDTOTPC
          MOVE      ZERO,JCDTOTSC
JCDTOT99  RETURN
.
.------------------------------------------------------------
. Enter a Range Journal Code
.------------------------------------------------------------
RJCD0000   MOVE     "    5",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           MOVE     "J ",TCODE                                         * V90200
           CALL     KPCODA00                                           * V90200
           BRANCH   EXIT,RJCD0100,RJCD0999
           MOVE     ACODE,STRJCD                                       * V90200
           PACK     FROMJCD,ACODE,SP1,TDESC                            * V90200
           GOTO     RJCD0140
RJCD0100   MOVE     "Start             ",FROMJCD
           MOVE     SP70,STRJCD
.
RJCD0140   MOVE     FROMJCD,VAR
           CALL     DISPITEM
.
RJCD0150   MOVE     "    6",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           MOVE     "J ",TCODE                                         * V90200
           CALL     KPCODA00                                           * V90200
           BRANCH   EXIT,RJCD0200,RJCD0999
           MOVE     ACODE,ENDJCD                                       * V90200
           PACK     TOJCD,ACODE,SP1,TDESC                              * V90200
           MATCH    STRJCD,ENDJCD
           GOTO     RJCD0999 IF EQUAL
           GOTO     RJCD0999 IF NOT LESS
           BEEP
           MOVE     "To Journal Code Must Be > From Journal Code - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RJCD0000
.
RJCD0200   MOVE     "Finish             ",TOJCD
           MOVE     "~~~~~~~~~",ENDJCD
.
RJCD0999   MOVE     "    5",FLDID
           CALL     GETPOSIT
           RETURN
.------------------------------------------------------------
. Print Misc Group Mapping Report
.------------------------------------------------------------
REPF0000  DISPLAY   *P1:24,*EL,"Printing Report : ";
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
.
          MOVE      SP70,LASTDTY
          MOVE      SP70,LASTSPC
          PACK      KEY13,STRDTY,SP70
          CALL      RDCEVB1
          IF        OVRCD=0
            CALL      RPCEVB1
          ENDIF
REPF1000  CALL      RKCEVB1
          BRANCH    OVRCD,REPF9000
          MATCH     CEVBDTY,ENDDTY
          GOTO      REPF9000 IF LESS
.
          MATCH     LASTDTY,CEVBDTY
          IF        !@EQUAL
            CALL      PRTDTY00
          ENDIF
.
          COMPARE   "55",CLNO
          CALL      HEDF0000 IF NOT LESS
.
          MATCH     LASTSPC,CEVBSPC
          IF        !@EQUAL
            MOVE       CEVBSPC,KEY3
            CALL       RDCESP1
            PRINT      *7,CEVBSPC,SP1,CESPDES;
            MOVE       CEVBSPC,LASTSPC
          ENDIF
.
          MOVE       CEVBPSC,KEY7
          CALL       RDCEPS1
          MOVE       "99,999.99",PRIQTY
          MOVE       "9999,999.99",PRICST
          FEDIT      CEVBQTY,PRIQTY
          ASSIGN     (CEPSST1+CEPSST2+CEPSST3+CEPSST4+CEPSST5)*CEVBQTY,F12P2
          FEDIT      F12P2,PRICST
.
          PRINT     *47,CEVBPSC,SP1,CEPSDES,SP1:
                    *112,PRIQTY,PRICST
          ADD       ONE,CLNO
          GOTO      REPF1000
.
REPF9000  CALL      DTYTOT00
          PRINT     *45,"***** End of Report *****"
          RETURN
.------------------------------------------------------------
. Page Header
.------------------------------------------------------------
HEDF0000  CALL      HEAD132
          DISPLAY   *P19:24,*V2LON,CPAGENO
          PRINT     "VMO Doctor Type Mapping From : ",FROMDTY
          PRINT     "                        To   : ",TODTY
          CALL      UND132
          PRINT     "Doctor Type                                        "
          PRINT     "      Service Provider                        Patie":
                    "nt Service                                         ":
                    "               Qty       Cost"
          CALL      UND132
          RETURN
.
PRTDTY00  MATCH     SP70,LASTDTY
          CALL      DTYTOT00 IF NOT EQUAL
.
          COMPARE   "50",CLNO
          CALL      HEDF0000 IF NOT LESS
.
          PACK      KEY6,CEVBDTY
          MOVE      "DT",TCODE                                         * V90200
          PACK      KEY5,TCODE,CEVBDTY,SP70                            * V90200
          CALL      RDCODE1                                            * V90200
          MOVE      CEVBDTY,LASTDTY
          MOVE      SP70,LASTSPC
.
          PRINT     CEVBDTY,SP1,TDESC                                  * V90200
          PRINT      *7,CEVBSPC,SP1,CESPDES;
.
          RETURN
.
DTYTOT00  CALL       UND132
.          MOVE       "         ",PRIQTY
.          MOVE       "9999,999.99",PRICST
.          FEDIT      DTYTOTPC,PRICST
.          PRINT     "Total",*112,PRIQTY,PRICST
.          ADD       ONE,CLNO
.          CALL      UND132
.          MOVE      ZERO,DTYTOTPC
DTYTOT99  RETURN
.
.------------------------------------------------------------
. Enter a Range Doctor Types
.------------------------------------------------------------
RDTY0000   MOVE     "    5",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           MOVE     "DT",TCODE                                         * V90200
           CALL     KPCODA00                                           * V90200
           BRANCH   EXIT,RDTY0100,RDTY0999
           MOVE     ACODE,STRDTY                                       * V90200
           PACK     FROMDTY,ACODE,SP1,TDESC                            * V90200
           GOTO     RDTY0140
RDTY0100   MOVE     "Start             ",FROMDTY
           MOVE     SP70,STRDTY
.
RDTY0140   MOVE     FROMDTY,VAR
           CALL     DISPITEM
.
RDTY0150   MOVE     "    6",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           MOVE     "DT",TCODE                                         * V90200
           CALL     KPCODA00                                           * V90200
           BRANCH   EXIT,RDTY0200,RDTY0999
           MOVE     ACODE,ENDDTY                                       * V90200
           PACK     TODTY,ACODE,SP1,TDESC                              * V90200
           MATCH    STRDTY,ENDDTY
           GOTO     RDTY0999 IF EQUAL
           GOTO     RDTY0999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RDTY0000
.
RDTY0200   MOVE     "Finish             ",TODTY
           MOVE     "~~~~~~~~~",ENDDTY
.
RDTY0999   MOVE     "    5",FLDID
           CALL     GETPOSIT
           RETURN
.------------------------------------------------------------
. Setup Report Defaults
.------------------------------------------------------------
DOCDEF00  MOVE      SP70,STRDOC
          MOVE      Z70,ENDDOC
          MOVE      "Start                  ",FROMDOC
          MOVE      "Finish                 ",TODOC
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      PATDO1A1,"patdo1af"                                * V90200
          TRAPCLR   IO
          MOVE      OVRCD,VMOFILOP
          GOTO      DOCDEF99
.
DOCDEF99  RETURN
.
.------------------------------------------------------------
. Print Misc Group Mapping Report
.------------------------------------------------------------
REPE0000  DISPLAY   *P1:24,*EL,"Printing Report : ";
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
.
          MOVE      SP70,LASTDOC
          MOVE      SP70,LASTSPC
          PACK      KEY16,STRDOC,SP70
          CALL      RDCEVA1
          IF        OVRCD=0
            CALL      RPCEVA1
          ENDIF
REPE1000  CALL      RKCEVA1
          BRANCH    OVRCD,REPE9000
          MATCH     CEVADOC,ENDDOC
          GOTO      REPE9000 IF LESS
.
          MATCH     LASTDOC,CEVADOC
          IF        !@EQUAL
            CALL      PRTDOC00
          ENDIF
.
          COMPARE   "55",CLNO
          CALL      HEDE0000 IF NOT LESS
.
          MATCH     LASTSPC,CEVASPC
          IF        !@EQUAL
            MOVE       CEVASPC,KEY3
            CALL       RDCESP1
            PRINT      *7,CEVASPC,SP1,CESPDES;
            MOVE       CEVASPC,LASTSPC
          ENDIF
.
          MOVE       CEVAPSC,KEY7
          CALL       RDCEPS1
          MOVE       "99,999.99",PRIQTY
          MOVE       "9999,999.99",PRICST
          FEDIT      CEVAQTY,PRIQTY
          ASSIGN     (CEPSST1+CEPSST2+CEPSST3+CEPSST4+CEPSST5)*CEVAQTY,F12P2
          FEDIT      F12P2,PRICST
.
          PRINT     *47,CEVAPSC,SP1,CEPSDES,SP1:
                    *112,PRIQTY,PRICST
          ADD       ONE,CLNO
          GOTO      REPE1000
.
REPE9000  CALL      DOCTOT00
          PRINT     *45,"***** End of Report *****"
          RETURN
.------------------------------------------------------------
. Page Header
.------------------------------------------------------------
HEDE0000  CALL      HEAD132
          DISPLAY   *P19:24,*V2LON,CPAGENO
          PRINT     "VMO Doctor Mapping From : ",FROMDOC
          PRINT     "                   To   : ",TODOC
          CALL      UND132
          PRINT     "Doctor Code                                        "
          PRINT     "      Service Provider                        Patie":
                    "nt Service                                         ":
                    "               Qty       Cost"
          CALL      UND132
          RETURN
.
PRTDOC00  MATCH     SP70,LASTDOC
          CALL      DOCTOT00 IF NOT EQUAL
.
          COMPARE   "50",CLNO
          CALL      HEDE0000 IF NOT LESS
.
          ADD       ONE,CLNO
          PACK      KEY6,CEVADOC
          CALL      RDDOCT1                                            * V90200
          MOVE      DGNAME,ANS                                         * V90200
          STRIP     DTITL                                              * V90200
          PACK      DOCTNAME,DTITL,SP1,ANS,SP1,DSNAME,SP70             * V90200
          MOVE      CEVADOC,LASTDOC
          MOVE      SP70,LASTSPC
.
          PRINT     CEVADOC,SP1,DOCTNAME
          PRINT      *7,CEVASPC,SP1,CESPDES;
.
          RETURN
.
DOCTOT00  CALL       UND132
.          MOVE       "         ",PRIQTY
.          MOVE       "9999,999.99",PRICST
.          FEDIT      DOCTOTPC,PRICST
.          PRINT     "Total",*112,PRIQTY,PRICST
.          ADD       ONE,CLNO
.          CALL      UND132
.          MOVE      ZERO,DOCTOTPC
DOCTOT99  RETURN
.
.------------------------------------------------------------
. Enter a Range of Doctor Codes
.------------------------------------------------------------
RDOC0000   MOVE     "    5",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           MOVE     "0",CKEYTYP
           CALL     EDOC0000
           BRANCH   EXIT,RDOC0100,RDOC0999
           MOVE     DOCTCODE,STRDOC
           PACK     FROMDOC,DOCTCODE,SP1,DOCTNAME
           GOTO     RDOC0140
RDOC0100   MOVE     "Start             ",FROMDOC
           MOVE     SP70,STRDOC
.
RDOC0140   MOVE     FROMDOC,VAR
           CALL     DISPITEM
.
RDOC0150   MOVE     "    6",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           CALL     EDOC0000
           BRANCH   EXIT,RDOC0200,RDOC0999
           MOVE     DOCTCODE,ENDDOC
           PACK     TODOC,DOCTCODE,SP1,DOCTNAME
           MATCH    STRDOC,ENDDOC
           GOTO     RDOC0999 IF EQUAL
           GOTO     RDOC0999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RDOC0000
.
RDOC0200   MOVE     "Finish             ",TODOC
           MOVE     "~~~~~~~~~",ENDDOC
.
RDOC0999   MOVE     "    5",FLDID
           CALL     GETPOSIT
           RETURN
.------------------------------------------------------------
. Enter Doctor Code
.------------------------------------------------------------
EDOC0000  MOVE      ZERO,CKEYTYP
          CALL      KPDOCA00                                           * V90200
          BRANCH    EXIT,EDOC9999,EDOC9999
          MOVE      DCODE,DOCTCODE                                     * V90200
          MOVE      DCODE,CEVADOC                                      * V90200
          MOVE      DGNAME,ANS                                         * V90200
          STRIP     DTITL                                              * V90200
          PACK      DOCTNAME,DTITL,SP1,ANS,SP1,DSNAME,SP70             * V90200
          GOTO      EDOC9999
.
EDOC9999  RETURN
.
.------------------------------------------------------------
. Setup Report Defaults
.------------------------------------------------------------
DEFSTY00  MOVE      SP70,STRSTY
          MOVE      Z70,ENDSTY
          MOVE      "Start                  ",FROMSTY
          MOVE      "Finish                 ",TOSTY
.
          RETURN
.
.------------------------------------------------------------
. Print Misc Group Mapping Report
.------------------------------------------------------------
REPG0000  DISPLAY   *P1:24,*EL,"Printing Report : ";
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3:
                                   *183,CCCOTH1,CCCOTH2,CCCOTH3,CCCOTH4
          MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
.
          MOVE      SP70,LASTSTY
          MOVE      SP70,LASTKEY
          MOVE      SP70,LASTSPC
          PACK      KEY23,STRSTY,SP70
          CALL      RDCEME1
          IF        OVRCD=0
            CALL      RPCEME1
          ENDIF
REPG1000  CALL      RKCEME1
          BRANCH    OVRCD,REPG9000
          MATCH     CEMESTY,ENDSTY
          GOTO      REPG9000 IF LESS
.
          MATCH     LASTSTY,CEMESTY
          IF        !@EQUAL
            CALL      HEDG0000
            CALL      PRTKEY00
          ENDIF
          MATCH     LASTKEY,CEMEKEY
          IF        !@EQUAL
            CALL      UND132
            CALL      PRTKEY00
          ENDIF
          COMPARE   "55",CLNO
          CALL      HEDG0000 IF NOT LESS
.
          MATCH     LASTSPC,CEMESPC
          IF        !@EQUAL
            MOVE       CEMESPC,KEY3
            CALL       RDCESP1
            PRINT      *7,CEMESPC,SP1,CESPDES;
            MOVE       CEMESPC,LASTSPC
          ENDIF
.
          MOVE       CEMEPSC,KEY7
          CALL       RDCEPS1
          CALL       GETCEM00
.
          PRINT     *47,CEMEPSC,SP1,CEPSDES,SP1,CEMEDOS,SP1,NAMEDOS,SP1:
                    CEMETYQ,SP1,NAMETYQ,SP2,CEMEQTY
          ADD       ONE,CLNO
          GOTO      REPG1000
.
REPG9000  CALL      UND132
          PRINT     *45,"***** End of Report *****"
          RETURN
.------------------------------------------------------------
. Page Header
.------------------------------------------------------------
HEDG0000  CALL      HEAD132
          DISPLAY   *P19:24,*V2LON,CPAGENO
          PRINT     "Casemix Type Mapping From : ",FROMSTY," To   : ",TOSTY
          MOVE      CEMESTY,LASTSTY
          MOVE      CEMEKEY,LASTKEY
          MOVE      CEMESTY,KEY3
          CALL      RDCCST1
          PRINT     "Casemix Type              : ",CCSTSTY,SP1,CCSTDES
          CALL      UND132
          PRINT     "Casemix Code                                       "
          PRINT     "      Service Provider                        Patie":
                    "nt Service                             Date of Serv":
                    ".   Base Quantity      Factor"
          CALL      UND132
          RETURN
.------------------------------------------------------------
. Print Casemix Code
.------------------------------------------------------------
PRTKEY00  COMPARE   "50",CLNO
          CALL      HEDG0000 IF NOT LESS
.
          PACK      KEY13,CEMESTY,CEMEKEY
          CALL      RDCCXH1
          MOVE      CEMEKEY,LASTKEY
          MOVE      SP70,LASTSPC
.
          PRINT     CEMEKEY,SP1,CCXHDES
          PRINT      *7,CEMESPC,SP1,CESPDES;
.
          RETURN
.------------------------------------------------------------
. Determine Fields for Casemix Type Mapping
.------------------------------------------------------------
GETCEM00  MOVE      "Discharge",NAMEDOS
          IF        CEMEDOS=1
            MOVE      "Admission",NAMEDOS
          ENDIF
          BRANCH    CEMETYQ,GETCEM10,GETCEM20,GETCEM30,GETCEM40,GETCEM50:
                            GETCEM60,GETCEM70,GETCEM80,GETCEM90
GETCEM10  MOVE     "Adm./Discharge",NAMETYQ
          GOTO     GETCEM99
GETCEM20  MOVE     "Bed Days (LOS)",NAMETYQ
          GOTO     GETCEM99
GETCEM30  MOVE     "LOS ",KEY4
          PACK     NAMETYQ,KEY4,CCCOIA1
          GOTO     GETCEM99
GETCEM40  MOVE     "LOS ",KEY4
          PACK     NAMETYQ,KEY4,CCCOIA2
          GOTO     GETCEM99
GETCEM50  MOVE     "LOS ",KEY4
          PACK     NAMETYQ,KEY4,CCCOIA3
          GOTO     GETCEM99
GETCEM60  MOVE     CCCOTH1,NAMETYQ
          GOTO     GETCEM99
GETCEM70  MOVE     CCCOTH2,NAMETYQ
          GOTO     GETCEM99
GETCEM80  MOVE     CCCOTH3,NAMETYQ
          GOTO     GETCEM99
GETCEM90  MOVE     CCCOTH4,NAMETYQ
          GOTO     GETCEM99
GETCEM99  RETURN
.
.
.------------------------------------------------------------
. Enter a Range Casemix Types
.------------------------------------------------------------
RSTY0000   MOVE     "    5",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           CALL     KCCSTA00
           BRANCH   EXIT,RSTY0100,RSTY0999
           MOVE     CCSTSTY,STRSTY
           PACK     FROMSTY,CCSTSTY,SP1,CCSTDES
           GOTO     RSTY0140
RSTY0100   MOVE     "Start             ",FROMSTY
           MOVE     SP70,STRSTY
.
RSTY0140   MOVE     FROMSTY,VAR
           CALL     DISPITEM
.
RSTY0150   MOVE     "    6",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
           CALL     KCCSTA00
           BRANCH   EXIT,RSTY0200,RSTY0999
           MOVE     CCSTSTY,ENDSTY
           PACK     TOSTY,CCSTSTY,SP1,CCSTDES
           MATCH    STRSTY,ENDSTY
           GOTO     RSTY0999 IF EQUAL
           GOTO     RSTY0999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RSTY0000
.
RSTY0200   MOVE     "Finish             ",TOSTY
           MOVE     "~~~~~~~~~",ENDSTY
.
RSTY0999   MOVE     "    5",FLDID
           CALL     GETPOSIT
           RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CCSSTYIO/INC
          INC       CCSSTYKY    
          INC       CCSXHDIO/INC
          INC       CEACODKY    
          INC       CEADOCKY    
          INC       CEAMAPIO/INC
          INC       CEAMBPIO/INC
          INC       CEAMCGKY    
          INC       CEAMCPIO/INC
          INC       CEAMDPIO/INC
          INC       CEAMEPIO/INC
          INC       CEAPSCIO/INC
          INC       CEASPCIO/INC
          INC       CEAVAMIO/INC
          INC       CEAVBMIO/INC
          INC       PATCODIO/INC
          INC       PATDO1IO/INC
          INC       PATMCHIO/INC
          INC       PATMCHRD    
.
          INC       STDGENCD
.
