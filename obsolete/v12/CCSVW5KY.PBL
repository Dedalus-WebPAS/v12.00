.---------------------------------------------------------------------------
.   System    :   Clinical Costing System            
.   Include   :   CCSVW5KY
.   Routine   :   HCCV5A00 DRG Code            
.   Return    :           
.-------------------------------------------------------------------------------
HCCV5A00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HCCV5A04
          CALL      GSCRN000
          BRANCH    EXIT,HCCV5A99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"DRG"                
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 5",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "40",STDCOL03
HCCV5A08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,CCV5DRG 
          PACK      KEY4,CCV5DRG,SP70                                           
.                                                                               
.                                                                               
          CALL      RSCCV51 
HCCV5A10
          CALL      RKCCV51 
          BRANCH    OVRCD,HCCV5A15
          PACK      KEY4,CCV5DRG,SP70                                           
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HCCV5A12
          CALL      HCCV5A60
          BRANCH    OVRCD,HCCV5A10
HCCV5A12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,CCV5DRG 
          DISPLAY   *PSTDCOL02:STDROW,CCV5DES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HCCV5A10 IF NOT EQUAL
HCCV5A15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HCCV5A20
          CALL      HSCRI000
          BRANCH    EXIT,HCCV5A30,HCCV5A35,HCCV5A40,HCCV5A45,HCCV5A04:
                              HCCV5A91,HCCV5A50
          GOTO      HCCV5A92
HCCV5A30
          CALL      RKCCV51 
          BRANCH    OVRCD,HCCV5A85
          PACK      KEY4,CCV5DRG,SP70                                           
.                                                                               
.                                                                               
          CALL      RPCCV51 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCV5A10
HCCV5A35
          MOVE      ST1,KEY4 
          CALL      RDCCV51 
          CALL      RPCCV51 
          BRANCH    OVRCD,HCCV5A85
          PACK      KEY4,CCV5DRG,SP70                                           
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HCCV5A36
          CALL      RPCCV51 
          BRANCH    OVRCD,HCCV5A37
          PACK      KEY4,CCV5DRG,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCCV5A36 IF NOT EQUAL
HCCV5A37
          MOVE      ZERO,XITEMNO
          GOTO      HCCV5A10
HCCV5A40
          MOVE      ST1,KEY4 
          CALL      RDCCV51 
          CALL      RPCCV51 
          BRANCH    OVRCD,HCCV5A85
          PACK      KEY4,CCV5DRG,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCV5A08
HCCV5A45
          CALL      RKCCV51 
          BRANCH    OVRCD,HCCV5A85
          PACK      KEY4,CCV5DRG,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY4,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSCCV51 
HCCV5A46
          CALL      RPCCV51 
          BRANCH    OVRCD,HCCV5A47
          PACK      KEY4,CCV5DRG,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCCV5A46 IF NOT EQUAL
HCCV5A47
          MOVE      ZERO,XITEMNO
          GOTO      HCCV5A10
HCCV5A50  COMPARE   ZERO,CSEARCH
          GOTO      HCCV5A55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCV5A08
HCCV5A55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCV5A08
HCCV5A60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HCCV5A61 IF EQUAL
          MATCH     SCHFLD01,CCV5DRG 
          GOTO      HCCV5A72 IF NOT EQUAL
HCCV5A61
          MATCH     SP70,SCHFLD02
          GOTO      HCCV5A62 IF EQUAL
          MATCH     SCHFLD02,CCV5DES 
          GOTO      HCCV5A72 IF NOT EQUAL
HCCV5A62
HCCV5A63
HCCV5A64
HCCV5A65
HCCV5A66
HCCV5A67
HCCV5A68
HCCV5A69
HCCV5A70
          GOTO      HCCV5A75
HCCV5A72  MOVE      ONE,OVRCD
HCCV5A75  RETURN
HCCV5A85
          LOAD      KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,CCV5DRG                                                
          CALL      RDCCV51 
HCCV5A90
.                                                                               
          BEEP
          GOTO      HCCV5A20
HCCV5A91
          MOVE      SP70,CCV5DES 
          MOVE      SP70,CCV5TYP 
          MOVE      SP70,CCV5SDMT
          MOVE      SP70,CCV5MVEX
          MOVE      SP70,CCV5MVEL
          MOVE      SP70,CCV5SDOD
          MOVE      ZERO,CCV5LOW 
          MOVE      ZERO,CCV5HIG 
          MOVE      ZERO,CCV5SLOS
          MOVE      ZERO,CCV5CWA 
          MOVE      ZERO,CCV5CWS 
          MOVE      ZERO,CCV5CWO 
          MOVE      ZERO,CCV5HOF 
          MOVE      ZERO,CCV5HOW 
          MOVE      ZERO,CCV5FWA 
          MOVE      ZERO,CCV5FWH 
          MOVE      ZERO,CCV5VWA 
          MOVE      ZERO,CCV5VWH 
          MOVE      SP70,CCV5SPA 
          MOVE      SP70,KEY4 
          MOVE      SP70,CCV5DRG 
          GOTO      HCCV5A96
HCCV5A92
          MOVE      SP70,KEY4 
          MOVE      SP70,CCV5DRG 
          LOAD      KEY4,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,CCV5DRG                                                
HCCV5A96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HCCV5A99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Clinical Costing System            
.   Include   :   CCSVW5KY
.   Routine   :   KCCV5A00 Keyin DRG Code            
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KCCV5A00 TOPIC     "CCV5DRG "
          MOVE      UNDLN70,CCV5DRG 
          KEYIN     *PCCOL:CVERT,*DV,CCV5DRG:                                   
                    *PCCOL:CVERT,*V2LON,CCV5DRG:                                
                    *PCCOL:CVERT,*DV,CCV5DRG 
.
          ENDSET    CCV5DRG 
          APPEND    SP70,CCV5DRG 
          RESET     CCV5DRG 
.
          MATCH     SP70,CCV5DRG 
          GOTO      KCCV5A90 IF EQUAL
.
          CMATCH    EXITCHAR,CCV5DRG 
          GOTO      KCCV5A95 IF EQUAL
.
          CMATCH    QUEST,CCV5DRG 
          GOTO      KCCV5A10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCV5A00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCV5DRG 
          APPEND    SP70,CCV5DRG 
          RESET     CCV5DRG 
.
          MATCH     SP70,CCV5DRG 
          GOTO      KCCV5A00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,CCV5DRG                                 
KCCV5A10
          PACK      KEY4,CCV5DRG                                                
          CALL      RACCV51 
          BRANCH    OVRCD,KCCV5A80
          BRANCH    CKEYTYP,KCCV5A75
          CALL      RDCCV51 
KCCV5A70
          MOVE      ZERO,EXIT
          GOTO      KCCV5A99
KCCV5A75
          MOVE      "DRG Code Already Exist - ",DISPMSG                                              
          CALL      MESSAGE1
          GOTO      KCCV5A00
KCCV5A80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KCCV5A99,KCCV5A99
          MOVE      "DRG Code Does Not Exist - ",DISPMSG                                             
          CALL      MESSAGE1
          GOTO      KCCV5A00
KCCV5A90
          MOVE      ONE,EXIT
          GOTO      KCCV5A99
KCCV5A95
          MOVE      TWO,EXIT
KCCV5A99 TOPIC    PRGID
          RETURN
