.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  04.07.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from r5.09
.-------------------------------------------------------
. V5.09.01  08/08/2001  Davin
.           Recompiled for change to CCSEPSFD
.-------------------------------------------------------
. V5.04.02  28.07.1996 B.G.Ackland
.           New Fields for Southern Health
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACCA04
.   Function      :   DRG Maintenance                         
.   Generated  On :   04/07/2002
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CCSDRGFD/INC
          INC       CCSEPSFD/INC
          INC       CCSXHDFD/INC
.=========================
.Local Variable Definition
.-------------------------
TOTALSCN  FORM      8 * Scr 01 Fld     5
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACCA04"
PRGNAM    INIT      "DRG Maintenance                         "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   64",AUDTSECT
          MOVE      " 37",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ccsaudep";
            OPEN      CCSAUDEP,"ccsaudep"
          ENDIF
          DISPLAY   *P56:24,"Opening ccsdrgaf";
          OPEN      CCSDRGA1,"ccsdrgaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA1,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA2,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA3,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA4,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA5,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA1,"ccsxhdaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA2,"ccsxhdaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Maintenace                         
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Options                            
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Update Patient Data for MDC Coding 
          ENDIF
          RETURN
.--------------------------------
. Screen - Maintenace                         
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Maintenace                         
.-------------------------------------------------------
CF00L000
          MOVE      SP70,CCDGDRGC
          MOVE      SP70,CCDGDES 
          MOVE      SP70,CCDGMDC 
          MOVE      ZERO,CCDGWAR 
          MOVE      SP70,CCDGTYP 
          MOVE      SP70,CCDGSDR 
          MOVE      SP70,CCDGSDT 
          MOVE      ZERO,CCDGLOW 
          MOVE      ZERO,CCDGHIG 
          MOVE      ZERO,CCDGSLOS
          MOVE      ZERO,CCDGSWGT
          MOVE      ZERO,CCDGNAT 
          MOVE      ZERO,CCDGNLOS
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Maintenace                         
.--------------------------------------------------------
KY00L000
.
KY00L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      KCCDGA00
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      OVRCD,ACCEPT
          MOVE      CCDGDRGC,VAR     
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Maintenace                         
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Maintenace                         
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Maintenace                         
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Maintenace                         
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L101,PS00L102,PS00L103:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L104,PS00L105,PS00L106:
                            PS00L107,PS00L108,PS00L109,PS00L110:
                            PS00L111,PS00L112
          GOTO     PS00L999
.
PS00L101
          MOVE      CCDGDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      CCDGMDC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCDGWAR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      CCDGTYP,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      CCDGSDR,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      CCDGSDT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      CCDGLOW,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      CCDGHIG,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      CCDGSLOS,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      CCDGSWGT,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      CCDGNAT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      CCDGNLOS,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Maintenace                         
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L006,SF00L104,SF00L105,SF00L106:
                            SF00L107,SF00L108,SF00L109,SF00L110:
                            SF00L111,SF00L112,SF00L113,SF00L114:
                            SF00L115,SF00L116
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L101,SF00L102,SF00L103:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L108,SF00L109,SF00L110:
                            SF00L111,SF00L112,SF00L113,SF00L114:
                            SF00L115,SF00L116
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL     SELECTED
          STRIP     CCDGDES 
          SFORMAT   VAR,SCPSLEN
          MOVE      CCDGDES,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CCDGDES 
          SFORMAT   VAR,127
          ENDSET    CCDGDES 
          APPEND    SP70,CCDGDES 
          RESET     CCDGDES 
          CMATCH    EXITCHAR,CCDGDES 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CCDGDES 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L101
            ENDIF
          ENDIF
          MOVE      CCDGDES,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L102
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EMDC0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L102
            ENDIF
            BRANCH    EXIT,SF00L102,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CCDGMDC,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L103
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CCDGWAR 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCDGWAR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L104
          CALL      POST0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L106
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF00L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF00L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF00L999
          ENDIF
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF00L000
          ENDIF
          GOTO      SF00L001
.
SF00L107
          CALL      LIST0000
          GOTO      SF00L001
.
SF00L108
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KTYP0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L108
            ENDIF
            BRANCH    EXIT,SF00L108,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CCDGTYP,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L109
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSDR0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L109
            ENDIF
            BRANCH    EXIT,SF00L109,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CCDGSDR,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L110
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSDT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L110
            ENDIF
            BRANCH    EXIT,SF00L110,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CCDGSDT,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L111
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CCDGLOW 
          IF        SCPSMAN=1
            COMPARE   ZERO,CCDGLOW 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L111
            ENDIF
          ENDIF
          MOVE      CCDGLOW,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L112
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CCDGHIG 
          IF        SCPSMAN=1
            COMPARE   ZERO,CCDGHIG 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L112
            ENDIF
          ENDIF
          MOVE      CCDGHIG,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L113
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CCDGSLOS
          IF        SCPSMAN=1
            COMPARE   ZERO,CCDGSLOS
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L113
            ENDIF
          ENDIF
          MOVE      CCDGSLOS,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L114
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CCDGSWGT
          IF        SCPSMAN=1
            COMPARE   ZERO,CCDGSWGT
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L114
            ENDIF
          ENDIF
          MOVE      CCDGSWGT,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L115
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CCDGNAT 
          IF        SCPSMAN=1
            COMPARE   ZERO,CCDGNAT 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L115
            ENDIF
          ENDIF
          MOVE      CCDGNAT,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L116
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CCDGNLOS
          IF        SCPSMAN=1
            COMPARE   ZERO,CCDGNLOS
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L116
            ENDIF
          ENDIF
          MOVE      CCDGNLOS,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.--------------------------------
. Screen - Options                            
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Options                            
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Options                            
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Options                            
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Options                            
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Options                            
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Options                            
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L101,PS01L999,PS01L999
          GOTO     PS01L999
.
PS01L101
          MOVE      TOTALSCN,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Options                            
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L006,SF01L104,SF01L105
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      SC00L000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L103
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L104
          CALL      FIXMDC00
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L105
          CALL      LIST0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Update Patient Data for MDC Coding 
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Update Patient Data for MDC Coding 
.-------------------------------------------------------
CF02L000
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Update Patient Data for MDC Coding 
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Update Patient Data for MDC Coding 
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Update Patient Data for MDC Coding 
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Update Patient Data for MDC Coding 
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Update Patient Data for MDC Coding 
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Update Patient Data for MDC Coding 
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L102
          CALL      PROC0000
          MOVE      ZERO,EXIT
          GOTO      SF02L999
SF02L990  MOVE      FOUR,EXIT * Exit Char Exit
SF02L999  RETURN
.@@@@@ Function Restart Point @@@@@
DEFAULTN    MOVE     ANSN,DEFYESNO
            RETURN
EMDC0000  KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,*JR,*ZF,KEY2
          PACK      CCDGMDC,KEY2,SP70
          RETURN
.------------------------------------------------------------
. Save DRG Record and Update Casemix Codes File
.------------------------------------------------------------
POST0000  PACK     KEY4,CCDGDRGC
          CALL     RACCDG1
          IF       OVRCD=0
            CALL     UPCCDG1
          ELSE
            CALL     WRCCDG1
          ENDIF
.
          MOVE     "001",CCXHSTY
          PACK     KEY13,CCXHSTY,CCDGDRGC,SP70
          UNPACK   KEY13,CCXHSTY,CCXHKEY
          CALL     RDCCXH1
          IF       OVRCD=0
            MOVE     CCDGDES,CCXHDES
            CALL     UPCCXH1
          ELSE
            MOVE     CCDGDES,CCXHDES
            CALL     WRCCXH1
          ENDIF
          RETURN
DELT0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DELT1000,DELT9000,DELT9100
.
DELT1000  PACK     KEY4,CCDGDRGC
          CALL     RACCDG1
          IF       OVRCD=0
            CALL     DECCDG1
          ENDIF
          MOVE     "001",CCXHSTY
          PACK     KEY13,CCXHSTY,CCDGDRGC,SP70
          CALL     RACCXH1
          IF       OVRCD=0
            CALL     DECCXH1
          ENDIF
          MOVE     TWO,EXIT            * Restart Screen
          GOTO     DELT9999
DELT9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DELT9999
DELT9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DELT9999
DELT9999  RETURN
.------------------------------------------------------------
. List Drg Codes
.------------------------------------------------------------
LIST0000  MOVE      "99",CLNO
          MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
          MOVE      SP70,KEY4
          CALL      RSCCDG1
.
LIST1000  CALL      RKCCDG1
          BRANCH    OVRCD,LIST9000
          COMPARE   "55",CLNO
          CALL      HEAD0000 IF NOT LESS
.
          ADD       ONE,CLNO
          MOVE      "No ",KEY3
          IF        CCDGWAR=1
            MOVE      "Yes",KEY3
          ENDIF
          PRINT     "| ",CCDGDRGC,SP1,CCDGDES," | ",CCDGMDC:
                    " | ",KEY3,*80,"|"
          GOTO      LIST1000
.
LIST9000  COMPARE   ZERO,CPAGENO
          CALL      HEAD0000 IF EQUAL
          CALL      UND80
          PRINT     *30,"***** End of Report *****"
          MOVE      "Printing Complete. - ",DISPMSG
          CALL      MESSAGE1
.
LIST9999  RETURN
.
HEAD0000  CALL      HEAD80
          CALL      UND80
          PRINT     "| Diagnosis Related Group                 ":
                    "                         | MDC | Warn|"
          CALL      UND80
          RETURN
.------------------------------------------------------------
. Enter Type P or M
.------------------------------------------------------------
KTYP0000  KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,CCDGTYP
          MATCH     "M",CCDGTYP
          GOTO      KTYP9999 IF EQUAL
          MATCH     "P",CCDGTYP
          GOTO      KTYP9999 IF EQUAL
          BEEP
          GOTO      KTYP0000
KTYP9999  RETURN
.------------------------------------------------------------
. Enter Same Day Reduction Y or N
.------------------------------------------------------------
KSDR0000  KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,CCDGSDR
          MATCH     "Y",CCDGSDR
          GOTO      KSDR9999 IF EQUAL
          MATCH     "N",CCDGSDR
          GOTO      KSDR9999 IF EQUAL
          BEEP
          GOTO      KSDR0000
KSDR9999  RETURN
.------------------------------------------------------------
. Enter Same Day Target Y or N
.------------------------------------------------------------
KSDT0000  KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,CCDGSDT
          MATCH     "Y",CCDGSDT
          GOTO      KSDT9999 IF EQUAL
          MATCH     "N",CCDGSDT
          GOTO      KSDT9999 IF EQUAL
          BEEP
          GOTO      KSDT0000
KSDT9999  RETURN
.----------------------------------------------------------
. Process Patient Data From IBA Patient Management System
.----------------------------------------------------------
FIXMDC00  PACK     KEY4,SP70
          CALL     RSCCDG1
.
FIXMDC10  CALL     RKCCDG1           * Process All Records
          BRANCH   OVRCD,FIXMDC99
.
          MOVE     CCDGMDC,F3
          MOVE     F3,F2
          MOVE     F2,KEY2
          REP      " 0",KEY2
          PACK     CCDGMDC,KEY2,SP70
          CALL     UPCCDG1
          GOTO     FIXMDC10
.
FIXMDC99  RETURN
.----------------------------------------------------------
. Process Patient Data From IBA Patient Management System
.----------------------------------------------------------
PROC0000  MOVE     ZERO,TOTALSCN      * Total Processed
          CLOCK    TIME,CTIMEIS
          DISPLAY  *P1:24,*EL,"Started : ",CTIMEIS
          PACK     KEY18,SP70
          CALL     RSCCEP1
PROC1000  CALL     RKCCEP1           * Process All Records
          BRANCH   OVRCD,PROC9000
.
          ADD      ONE,TOTALSCN      * Total Processed
          IF       (TOTALSCN%1000=0)
            CLOCK    TIME,CTIMEIS
            MOVE      "Y",ANS
            KEYIN     *P20:24,*EL,"Records Complete : ",*DV,TOTALSCN:
                     " at ",*DV,CTIMEIS,"  Continue (Y/N) ? ",*T3,ANS
            REP       UPPLOW,ANS
            MATCH     "N",ANS
            IF        @EQUAL
              CHAIN     PGM
            ENDIF
          ENDIF
.
          MOVE      CCEPDRGC,KEY4
          CALL      RDCCDG1
          BRANCH    OVRCD,PROC1000
          MATCH     CCDGMDC,CCEPMDCC
          GOTO      PROC1000 IF EQUAL
          MOVE      CCDGMDC,CCEPMDCC
.
          CALL     UPCCEP1
          GOTO     PROC1000
PROC9000
PROC9999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CCSDRGIO/INC
          INC       CCSDRGKY    
          INC       CCSEPSIO/INC
          INC       CCSXHDIO/INC
.
          INC       STDGENCD
.
