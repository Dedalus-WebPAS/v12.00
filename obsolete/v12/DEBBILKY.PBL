.------------------------------------------------------------
. External Call to Setup Variables
.------------------------------------------------------------
EDBBIA00  MOVE      DBBIITM,KEY8
          PACK      KEY35,SP70
          CALL      RDDBIT1
          IF        OVRCD=0
            PACK      KEY35,DBITDES
          ENDIF
          MOVE      "999,999.99",KEY10
          FEDIT     DBBIQTY,KEY10
          MOVE      "$999,999,999.99",KEY15
          FEDIT     DBBITOT,KEY15
          RETURN
.
.---------------------------------------------------------------------------
.   System    :   Accounts Receiveable               
.   Include   :   DEBBILKY
.   Routine   :   KDBBIA00 Keyin Charge No.          
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KDBBIA00 TOPIC     "DBBIUNI "
          MOVE      UNDLN70,DBBIUNI 
          KEYIN     *PCCOL:CVERT,*DV,DBBIUNI:                                   
                    *PCCOL:CVERT,*V2LON,*JR,*ZF,DBBIUNI:                        
                    *PCCOL:CVERT,*DV,DBBIUNI 
.
          ENDSET    DBBIUNI 
          APPEND    SP70,DBBIUNI 
          RESET     DBBIUNI 
.
          MATCH     SP70,DBBIUNI 
          GOTO      KDBBIA90 IF EQUAL
.
          ENDSET    DBBIUNI 
          CMATCH    EXITCHAR,DBBIUNI 
          GOTO      KDBBIA95 IF EQUAL
.
          CMATCH    QUEST,DBBIUNI 
          GOTO      KDBBIA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HDBBIA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    DBBIUNI 
          APPEND    SP70,DBBIUNI 
          RESET     DBBIUNI 
.
          MATCH     SP70,DBBIUNI 
          GOTO      KDBBIA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,DBBIUNI                                 
KDBBIA10
          RESET     DBBIUNI 
          PACK      KEY14,DBBIDEB,DBBIUNI                                       
          CALL      RADBBI1 
          BRANCH    OVRCD,KDBBIA80
          BRANCH    CKEYTYP,KDBBIA75
          CALL      RDDBBI1 
KDBBIA70
          MOVE      ZERO,EXIT
          GOTO      KDBBIA99
KDBBIA75
          MOVE      "Charge No. Already Exist - ",DISPMSG                                            
          CALL      MESSAGE1
          GOTO      KDBBIA00
KDBBIA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KDBBIA99,KDBBIA99
          MOVE      "Charge No. Does Not Exist - ",DISPMSG                                           
          CALL      MESSAGE1
          GOTO      KDBBIA00
KDBBIA90
          MOVE      ONE,EXIT
          GOTO      KDBBIA99
KDBBIA95
          MOVE      TWO,EXIT
KDBBIA99  TOPIC    PRGID
          RETURN
.
.---------------------------------------------------------------------------
.   System    :   Accounts Receiveable               
.   Include   :   DEBBILKY
.   Routine   :   HDBBIA00 Charge No.          
.   Return    :           
.-------------------------------------------------------------------------------
HDBBIA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "08",HTOP
            MOVE      "24",HBOT
            MOVE      "01",HLEF
            MOVE      "80",HRIG
          ENDIF
HDBBIA04
          CALL      GSCRN000
          BRANCH    EXIT,HDBBIA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Charge No."         
.
          MOVE      STDCOL01,STDCOL02
          ADD       "11",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Item"               
.
          MOVE      STDCOL02,STDCOL03
          ADD       "35",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"  Quantity"           
.
          MOVE      STDCOL03,STDCOL04
          ADD       "11",STDCOL04
          DISPLAY   *PSTDCOL04:STDROW,*V2LON,*ULON,"      Ext Total"          
.
          MOVE      STDCOL04,STDCOL05
          ADD       "15",STDCOL05
HDBBIA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,DBBIUNI 
          PACK      KEY14,DBBIDEB,DBBIUNI,SP70                                  
          PACK      SAVKEY80,DBBIDEB,DBBIUNI,SP70                               
          SETLPTR   SAVKEY80,8                                                  
          CALL      RSDBBI1 
HDBBIA10
          CALL      RKDBBI1 
          BRANCH    OVRCD,HDBBIA15
          PACK      KEY14,DBBIDEB,DBBIUNI,SP70                                  
          MATCH     SAVKEY80,KEY14                                              
          GOTO      HDBBIA15 IF NOT EQUAL                                       
.
          CALL      EDBBIA00
.
          BRANCH    CSEARCH,HDBBIA12
          CALL      HDBBIA60
          BRANCH    OVRCD,HDBBIA10
HDBBIA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY14,XITEMNO,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,DBBIUNI 
          DISPLAY   *PSTDCOL02:STDROW,KEY35   
          DISPLAY   *PSTDCOL03:STDROW,KEY10   
          DISPLAY   *PSTDCOL04:STDROW,KEY15   
          COMPARE   MAXITEM,XITEMNO
          GOTO      HDBBIA10 IF NOT EQUAL
.
HDBBIA15
          UNPACK    SAVKEY80,DBBIDEB,DBBIUNI                                    
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HDBBIA20
          CALL      HSCRI000
          BRANCH    EXIT,HDBBIA30,HDBBIA35,HDBBIA40,HDBBIA45,HDBBIA04:
                              HDBBIA91,HDBBIA50
          GOTO      HDBBIA92
HDBBIA30
          CALL      RKDBBI1 
          BRANCH    OVRCD,HDBBIA85
          PACK      KEY14,DBBIDEB,DBBIUNI,SP70                                  
          MATCH     SAVKEY80,KEY14                                              
          GOTO      HDBBIA85 IF NOT EQUAL                                       
          CALL      RPDBBI1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBBIA10
HDBBIA35
          MOVE      ST1,KEY14
          CALL      RDDBBI1 
          CALL      RPDBBI1 
          BRANCH    OVRCD,HDBBIA85
          PACK      KEY14,DBBIDEB,DBBIUNI,SP70                                  
          MATCH     SAVKEY80,KEY14                                              
          GOTO      HDBBIA85 IF NOT EQUAL                                       
          MATCH     SP70,DBBIUNI                                                
          GOTO      HDBBIA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HDBBIA36
          CALL      RPDBBI1 
          BRANCH    OVRCD,HDBBIA37
          PACK      KEY14,DBBIDEB,DBBIUNI,SP70                                  
          MATCH     SAVKEY80,KEY14                                              
          GOTO      HDBBIA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HDBBIA36 IF NOT EQUAL
HDBBIA37
          MOVE      ZERO,XITEMNO
          GOTO      HDBBIA10
HDBBIA40
          MOVE      ST1,KEY14
          CALL      RDDBBI1 
          CALL      RPDBBI1 
          BRANCH    OVRCD,HDBBIA85
          PACK      KEY14,DBBIDEB,DBBIUNI,SP70                                  
          MATCH     SAVKEY80,KEY14                                              
          GOTO      HDBBIA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBBIA08
HDBBIA45
          CALL      RKDBBI1 
          BRANCH    OVRCD,HDBBIA85
          PACK      KEY14,DBBIDEB,DBBIUNI,SP70                                  
          MATCH     SAVKEY80,KEY14                                              
          GOTO      HDBBIA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY14,SAVKEY80,Z70                                          
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSDBBI1 
HDBBIA46
          CALL      RPDBBI1 
          BRANCH    OVRCD,HDBBIA47
          PACK      KEY14,DBBIDEB,DBBIUNI,SP70                                  
          MATCH     SAVKEY80,KEY14                                              
          GOTO      HDBBIA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HDBBIA46 IF NOT EQUAL
HDBBIA47
          MOVE      ZERO,XITEMNO
          GOTO      HDBBIA10
HDBBIA50  COMPARE   ZERO,CSEARCH
          GOTO      HDBBIA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          KEYIN     *PSTDCOL04:STDROW,*V2LON,SCHFLD04
          RESET     SCHFLD04
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBBIA08
HDBBIA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBBIA08
HDBBIA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HDBBIA61 IF EQUAL
          MATCH     SCHFLD01,DBBIUNI 
          GOTO      HDBBIA72 IF NOT EQUAL
HDBBIA61
          MATCH     SP70,SCHFLD02
          GOTO      HDBBIA62 IF EQUAL
          MATCH     SCHFLD02,KEY35   
          GOTO      HDBBIA72 IF NOT EQUAL
HDBBIA62
          MATCH     SP70,SCHFLD03
          GOTO      HDBBIA63 IF EQUAL
          MATCH     SCHFLD03,KEY10   
          GOTO      HDBBIA72 IF NOT EQUAL
HDBBIA63
          MATCH     SP70,SCHFLD04
          GOTO      HDBBIA64 IF EQUAL
          MATCH     SCHFLD04,KEY15   
          GOTO      HDBBIA72 IF NOT EQUAL
HDBBIA64
HDBBIA65
HDBBIA66
HDBBIA67
HDBBIA68
HDBBIA69
HDBBIA70
          GOTO      HDBBIA75
HDBBIA72  MOVE      ONE,OVRCD
HDBBIA75  RETURN
HDBBIA85
          LOAD      KEY14,XITEMNO,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY14,DBBIDEB,DBBIUNI                                       
          CALL      RDDBBI1 
HDBBIA90
          UNPACK    SAVKEY80,DBBIDEB,DBBIUNI                                    
          BEEP
          GOTO      HDBBIA20
HDBBIA91
          MOVE      SP70,DBBISTA 
          MOVE      SP70,DBBIDAT 
          MOVE      SP70,DBBITIM 
          MOVE      SP70,DBBIUID 
          MOVE      SP70,DBBIITM 
          MOVE      SP70,DBBISDAT
          MOVE      SP70,DBBIDREF
          MOVE      SP70,DBBIOREF
          MOVE      ZERO,DBBIQTY 
          MOVE      ZERO,DBBIPRI 
          MOVE      ZERO,DBBITOT 
          MOVE      ZERO,DBBITRT 
          MOVE      ZERO,DBBITAX 
          MOVE      SP70,DBBIUR1 
          MOVE      SP70,DBBIUR2 
          MOVE      SP70,DBBIUD1 
          MOVE      SP70,DBBIUD2 
          MOVE      SP70,DBBIUY1 
          MOVE      SP70,DBBIUY2 
          MOVE      SP70,DBBIUC1 
          MOVE      SP70,DBBIUC2 
          MOVE      SP70,DBBIUC3 
          MOVE      SP70,DBBIUC4 
          MOVE      SP70,DBBIGST 
          MOVE      SP70,DBBISPA 
          MOVE      SP70,KEY14
          MOVE      SP70,DBBIUNI 
          GOTO      HDBBIA96
HDBBIA92
          MOVE      SP70,KEY14
          MOVE      SP70,DBBIUNI 
          LOAD      KEY14,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY14,DBBIDEB,DBBIUNI                                       
HDBBIA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HDBBIA99
          RETURN
