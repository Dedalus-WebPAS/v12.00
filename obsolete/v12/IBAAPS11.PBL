.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBAAPS11
.   Function      :   Payment Terms Maintenance               
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSPPDFD/INC
.=========================
.Local Variable Definition
.-------------------------
OFFSDESC  DIM      25 * Scr 00 Fld    14
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBAAPS11"
PRGNAM    INIT      "Payment Terms Maintenance               "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apsppdaf";
          OPEN      APSPPDA1,"apsppdaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Payment Terms Maintenance          
          ENDIF
          RETURN
.--------------------------------
. Screen - Payment Terms Maintenance          
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Payment Terms Maintenance          
.-------------------------------------------------------
CF00L000  COMPARE   ZERO,ACCEPT
              GOTO      CF00L999 IF EQUAL
          MOVE      SP70,APPPTER 
          MOVE      SP70,APPPDES 
          MOVE      ZERO,APPPTYP 
          MOVE      ZERO,APPPDA1 
          MOVE      ZERO,APPPPE1 
          MOVE      ZERO,APPPDA2 
          MOVE      ZERO,APPPPE2 
          MOVE      ZERO,APPPDA3 
          MOVE      ZERO,APPPPE3 
          MOVE      SP70,OFFSDESC
          MOVE      SP70,APPPPIN 
          MOVE      SP70,APPPMDI 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Payment Terms Maintenance          
.--------------------------------------------------------
KY00L000
.
KY00L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      KAPPPA00
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      OVRCD,ACCEPT
          MOVE      APPPTER,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Payment Terms Maintenance          
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Payment Terms Maintenance          
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Payment Terms Maintenance          
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Payment Terms Maintenance          
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L101,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L102,PS00L103:
                            PS00L104,PS00L105,PS00L106,PS00L107:
                            PS00L108,PS00L109,PS00L110,PS00L111
          GOTO     PS00L999
.
PS00L101
          MOVE      APPPDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      APPPTYP,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      APPPDA1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      APPPPE1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      APPPDA2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      APPPPE2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      APPPDA3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      APPPPE3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          CALL      OFFNAM00
          MOVE      OFFSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      APPPPIN,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      APPPMDI,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Payment Terms Maintenance          
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L006,SF00L102:
                            SF00L103,SF00L104,SF00L105,SF00L106:
                            SF00L107,SF00L108,SF00L109,SF00L110:
                            SF00L111,SF00L006,SF00L112,SF00L113
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L101,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L105,SF00L106:
                            SF00L107,SF00L108,SF00L109,SF00L110:
                            SF00L111,SF00L020,SF00L112,SF00L113
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL     SELECTED
          STRIP     APPPDES 
          SFORMAT   VAR,SCPSLEN
          MOVE      APPPDES,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APPPDES 
          SFORMAT   VAR,127
          ENDSET    APPPDES 
          APPEND    SP70,APPPDES 
          RESET     APPPDES 
          CMATCH    EXITCHAR,APPPDES 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APPPDES 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L101
            ENDIF
          ENDIF
          MOVE      APPPDES,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L102
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      WAPPP000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      DAPPP000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          CALL      OFFNAM00
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,OFFSDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      OFFSET00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L105
            ENDIF
            BRANCH    EXIT,SF00L105,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      APPPTYP,VAR      
          CALL      DISPITEM
          CALL      OFFNAM00
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      OFFSDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L106
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,APPPDA1 
          IF        SCPSMAN=1
            COMPARE   ZERO,APPPDA1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L106
            ENDIF
          ENDIF
          MOVE      APPPDA1,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L107
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,APPPPE1 
          IF        SCPSMAN=1
            COMPARE   ZERO,APPPPE1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L107
            ENDIF
          ENDIF
          MOVE      APPPPE1,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L108
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,APPPDA2 
          IF        SCPSMAN=1
            COMPARE   ZERO,APPPDA2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L108
            ENDIF
          ENDIF
          MOVE      APPPDA2,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L109
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,APPPPE2 
          IF        SCPSMAN=1
            COMPARE   ZERO,APPPPE2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L109
            ENDIF
          ENDIF
          MOVE      APPPPE2,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L110
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,APPPDA3 
          IF        SCPSMAN=1
            COMPARE   ZERO,APPPDA3 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L110
            ENDIF
          ENDIF
          MOVE      APPPDA3,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L111
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,APPPPE3 
          IF        SCPSMAN=1
            COMPARE   ZERO,APPPPE3 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L111
            ENDIF
          ENDIF
          MOVE      APPPPE3,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L112
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KPPIN000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L112
            ENDIF
            BRANCH    EXIT,SF00L112,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      APPPPIN,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L113
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KPMDI000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L113
            ENDIF
            BRANCH    EXIT,SF00L113,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      APPPMDI,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.@@@@@ Function Restart Point @@@@@
.--------------------------------------------------
. Determine Description for Offset Type
.--------------------------------------------------
OFFNAM00  BRANCH   APPPTYP,OFFNAM20,OFFNAM30,OFFNAM40,OFFNAM50
          MOVE     "Invoice Date        ",OFFSDESC
          GOTO     OFFNAM99
OFFNAM20
          MOVE     "Batch Entered Date  ",OFFSDESC
          GOTO     OFFNAM99
OFFNAM30
          MOVE     "Batch Period Date   ",OFFSDESC
          GOTO     OFFNAM99
OFFNAM40
          MOVE     "Fixed Day This Month",OFFSDESC
          GOTO     OFFNAM99
OFFNAM50
          MOVE     "Fixed Day Next Month",OFFSDESC
          GOTO     OFFNAM99
OFFNAM99  RETURN
.----------------------------------------------------------------------
. Write Payment Terms
.----------------------------------------------------------------------
WAPPP000
          PACK     KEY2,APPPTER
          CALL     RAAPPP1
          IF       OVRCD=0
            CALL     UPAPPP1
          ELSE
            CALL     WRAPPP1
          ENDIF
          RETURN
.----------------------------------------------------------------------
. Delete Payment Terms
.----------------------------------------------------------------------
DAPPP000
          PACK     KEY2,APPPTER
          CALL     RAAPPP1
          IF       OVRCD=0
            CALL     DEAPPP1
          ENDIF
          RETURN
.----------------------------------------------------------------------
. Enter Offset Type
.----------------------------------------------------------------------
OFFSET00  MOVE     SP70,DISPMSG
          CALL     MESSAGE2
          DISPLAY  *P1:24,"Offset from : ":
                   *V2LON,"0.",*HOFF,"Invoice, ":
                   *V2LON,"1.",*HOFF,"System, ":
                   *V2LON,"2.",*HOFF,"Batch Date, ":
                   *V2LON,"3.",*HOFF,"Day This Mth, ":
                   *V2LON,"4.",*HOFF,"Day Next Mth"
OFFSET10
          KEYIN    *PCCOL:CVERT,*V2LON,APPPTYP:
                   *PCCOL:CVERT,*DV,APPPTYP
          IF       APPPTYP>4|APPPTYP<0
            BEEP
            GOTO     OFFSET10
          ENDIF
          CALL     MESSAGE3
OFFSET99  RETURN
.----------------------------------------------------------------------
. Keyin Priority Indicator
.----------------------------------------------------------------------
KPPIN000
          PACK      DISPMSG,SP70,SP70
          CALL      MESSAGE2
          DISPLAY   *P1:24,*V2LON:
                    "1",*HOFF," = High Priority, ",*V2LON:
                    "2",*HOFF," = Priority, ",*V2LON:
                    "3",*HOFF," = Low Priority";
          MOVE      TWO,F1
          MOVE      APPPPIN,F1
.
          REPEAT
            KEYIN     *PCCOL:CVERT,*RV,*V2LON,F1
          UNTIL     F1=1 | F1=2 | F1=3
.
          MOVE      F1,APPPPIN
          CALL      MESSAGE3
.
KPPIN999  RETURN
.----------------------------------------------------------------------
. Keyin Mode of Distribition
.----------------------------------------------------------------------
KPMDI000
          PACK      DISPMSG,SP70,SP70
          CALL      MESSAGE2
          DISPLAY   *P1:24,*V2LON:
                    "COL",*HOFF," = Collect Cheque, ",*V2LON:
                    "NML",*HOFF," = Normal Mail";
.
          MOVE      ZERO,F1
          REPEAT
            KEYIN     *PCCOL:CVERT,*RV,*V2LON,APPPMDI
            PACK      APPPMDI,APPPMDI,SP70
            REP       UPPLOW,APPPMDI
.
            MATCH     "COL",APPPMDI
            IF        @EQUAL
              MOVE      ONE,F1
            ENDIF
.
            MATCH     "NML",APPPMDI
            IF        @EQUAL
              MOVE      TWO,F1
            ENDIF
          UNTIL     F1<>0
.
          CALL      MESSAGE3
.
KPMDI999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSPPDIO/INC
          INC       APSPPDKY    
.
          INC       STDGENCD
.
