.---------------------------------------------------------------------------
.   System    :   Accounts Receiveable               
.   Include   :   DEBDEPKY
.   Routine   :   KDBDEA00 Keyin Department          
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KDBDEA00 TOPIC     "DBDEDEP "
          MOVE      UNDLN70,DBDEDEP 
          KEYIN     *PCCOL:CVERT,*DV,DBDEDEP:                                   
                    *PCCOL:CVERT,*V2LON,DBDEDEP:                                
                    *PCCOL:CVERT,*DV,DBDEDEP 
.
          ENDSET    DBDEDEP 
          APPEND    SP70,DBDEDEP 
          RESET     DBDEDEP 
.
          MATCH     SP70,DBDEDEP 
          GOTO      KDBDEA90 IF EQUAL
.
          CMATCH    EXITCHAR,DBDEDEP 
          GOTO      KDBDEA95 IF EQUAL
.
          CMATCH    QUEST,DBDEDEP 
          GOTO      KDBDEA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HDBDEA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    DBDEDEP 
          APPEND    SP70,DBDEDEP 
          RESET     DBDEDEP 
.
          MATCH     SP70,DBDEDEP 
          GOTO      KDBDEA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,DBDEDEP                                 
KDBDEA10
          PACK      KEY8,DBDEDEP                                                
          CALL      RADBDE1 
          BRANCH    OVRCD,KDBDEA80
          BRANCH    CKEYTYP,KDBDEA75
          CALL      RDDBDE1 
KDBDEA70
          MOVE      ZERO,EXIT
          GOTO      KDBDEA99
KDBDEA75
          MOVE      "Department Already Exist - ",DISPMSG                                            
          CALL      MESSAGE1
          GOTO      KDBDEA00
KDBDEA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KDBDEA99,KDBDEA99
          MOVE      "Department Does Not Exist - ",DISPMSG                                           
          CALL      MESSAGE1
          GOTO      KDBDEA00
KDBDEA90
          MOVE      ONE,EXIT
          GOTO      KDBDEA99
KDBDEA95
          MOVE      TWO,EXIT
KDBDEA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   Accounts Receiveable               
.   Include   :   DEBDEPKY
.   Routine   :   HDBDEA00 Department          
.   Return    :           
.-------------------------------------------------------------------------------
HDBDEA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "30",HLEF
            MOVE      "80",HRIG
          ENDIF
HDBDEA04
          CALL      GSCRN000
          BRANCH    EXIT,HDBDEA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Department"         
.
          MOVE      STDCOL01,STDCOL02
          ADD       "11",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "36",STDCOL03
HDBDEA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,DBDEDEP 
          PACK      KEY8,DBDEDEP,SP70                                           
.                                                                               
.                                                                               
          CALL      RSDBDE1 
HDBDEA10
          CALL      RKDBDE1 
          BRANCH    OVRCD,HDBDEA15
          PACK      KEY8,DBDEDEP,SP70                                           
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HDBDEA12
          CALL      HDBDEA60
          BRANCH    OVRCD,HDBDEA10
HDBDEA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY8,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,DBDEDEP 
          DISPLAY   *PSTDCOL02:STDROW,DBDEDES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HDBDEA10 IF NOT EQUAL
HDBDEA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HDBDEA20
          CALL      HSCRI000
          BRANCH    EXIT,HDBDEA30,HDBDEA35,HDBDEA40,HDBDEA45,HDBDEA04:
                              HDBDEA91,HDBDEA50
          GOTO      HDBDEA92
HDBDEA30
          CALL      RKDBDE1 
          BRANCH    OVRCD,HDBDEA85
          PACK      KEY8,DBDEDEP,SP70                                           
.                                                                               
.                                                                               
          CALL      RPDBDE1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBDEA10
HDBDEA35
          MOVE      ST1,KEY8 
          CALL      RDDBDE1 
          CALL      RPDBDE1 
          BRANCH    OVRCD,HDBDEA85
          PACK      KEY8,DBDEDEP,SP70                                           
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HDBDEA36
          CALL      RPDBDE1 
          BRANCH    OVRCD,HDBDEA37
          PACK      KEY8,DBDEDEP,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HDBDEA36 IF NOT EQUAL
HDBDEA37
          MOVE      ZERO,XITEMNO
          GOTO      HDBDEA10
HDBDEA40
          MOVE      ST1,KEY8 
          CALL      RDDBDE1 
          CALL      RPDBDE1 
          BRANCH    OVRCD,HDBDEA85
          PACK      KEY8,DBDEDEP,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBDEA08
HDBDEA45
          CALL      RKDBDE1 
          BRANCH    OVRCD,HDBDEA85
          PACK      KEY8,DBDEDEP,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY8,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSDBDE1 
HDBDEA46
          CALL      RPDBDE1 
          BRANCH    OVRCD,HDBDEA47
          PACK      KEY8,DBDEDEP,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HDBDEA46 IF NOT EQUAL
HDBDEA47
          MOVE      ZERO,XITEMNO
          GOTO      HDBDEA10
HDBDEA50  COMPARE   ZERO,CSEARCH
          GOTO      HDBDEA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBDEA08
HDBDEA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HDBDEA08
HDBDEA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HDBDEA61 IF EQUAL
          MATCH     SCHFLD01,DBDEDEP 
          GOTO      HDBDEA72 IF NOT EQUAL
HDBDEA61
          MATCH     SP70,SCHFLD02
          GOTO      HDBDEA62 IF EQUAL
          MATCH     SCHFLD02,DBDEDES 
          GOTO      HDBDEA72 IF NOT EQUAL
HDBDEA62
HDBDEA63
HDBDEA64
HDBDEA65
HDBDEA66
HDBDEA67
HDBDEA68
HDBDEA69
HDBDEA70
          GOTO      HDBDEA75
HDBDEA72  MOVE      ONE,OVRCD
HDBDEA75  RETURN
HDBDEA85
          LOAD      KEY8,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY8,DBDEDEP                                                
          CALL      RDDBDE1 
HDBDEA90
.                                                                               
          BEEP
          GOTO      HDBDEA20
HDBDEA91
          MOVE      SP70,DBDEDES 
          MOVE      ZERO,DBDEACT 
          MOVE      SP70,DBDEUR1 
          MOVE      SP70,DBDEUR2 
          MOVE      SP70,DBDEUD1 
          MOVE      SP70,DBDEUD2 
          MOVE      SP70,DBDEUY1 
          MOVE      SP70,DBDEUY2 
          MOVE      SP70,DBDEUC1 
          MOVE      SP70,DBDEUC2 
          MOVE      SP70,DBDESPA 
          MOVE      SP70,KEY8 
          MOVE      SP70,DBDEDEP 
          GOTO      HDBDEA96
HDBDEA92
          MOVE      SP70,KEY8 
          MOVE      SP70,DBDEDEP 
          LOAD      KEY8,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY8,DBDEDEP                                                
HDBDEA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HDBDEA99
          RETURN
