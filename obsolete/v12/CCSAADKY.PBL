.---------------------------------------------------------------------------
.   System    :   Clinical Costing System            
.   Include   :   CCSAADKY
.   Routine   :   HCCADA00 Area Analysis       
.   Return    :           
.-------------------------------------------------------------------------------
HCCADA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "01",HLEF
            MOVE      "80",HRIG
          ENDIF
HCCADA04
          CALL      GSCRN000
          BRANCH    EXIT,HCCADA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Post Code"          
.
          MOVE      STDCOL01,STDCOL02
          ADD       "11",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Level 1"            
.
          MOVE      STDCOL02,STDCOL03
          ADD       "11",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Level 2"            
.
          MOVE      STDCOL03,STDCOL04
          ADD       "11",STDCOL04
          DISPLAY   *PSTDCOL04:STDROW,*V2LON,*ULON,"Level 3"            
.
          MOVE      STDCOL04,STDCOL05
          ADD       "11",STDCOL05
          DISPLAY   *PSTDCOL05:STDROW,*V2LON,*ULON,"Level 4"            
.
          MOVE      STDCOL05,STDCOL06
          ADD       "36",STDCOL06
HCCADA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,CCADPC  
          PACK      KEY11,CCADDEF,CCADPC,SP70                                   
          PACK      SAVKEY80,CCADDEF,CCADPC,SP70                                
          SETLPTR   SAVKEY80,1                                                  
          CALL      RSCCAD1 
HCCADA10
          CALL      RKCCAD1 
          BRANCH    OVRCD,HCCADA15
          PACK      KEY11,CCADDEF,CCADPC,SP70                                   
          MATCH     SAVKEY80,KEY11                                              
          GOTO      HCCADA15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,HCCADA12
          CALL      HCCADA60
          BRANCH    OVRCD,HCCADA10
HCCADA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY11,XITEMNO,ST1,ST2,ST3,ST4,ST5:                          
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,CCADPC  
          DISPLAY   *PSTDCOL02:STDROW,CCADLV2 
          DISPLAY   *PSTDCOL03:STDROW,CCADLV3 
          DISPLAY   *PSTDCOL04:STDROW,CCADLV4 
          DISPLAY   *PSTDCOL05:STDROW,CCADDES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HCCADA10 IF NOT EQUAL
HCCADA15
          UNPACK    SAVKEY80,CCADDEF,CCADPC                                     
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HCCADA20
          CALL      HSCRI000
          BRANCH    EXIT,HCCADA30,HCCADA35,HCCADA40,HCCADA45,HCCADA04:
                              HCCADA91,HCCADA50
          GOTO      HCCADA92
HCCADA30
          CALL      RKCCAD1 
          BRANCH    OVRCD,HCCADA85
          PACK      KEY11,CCADDEF,CCADPC,SP70                                   
          MATCH     SAVKEY80,KEY11                                              
          GOTO      HCCADA85 IF NOT EQUAL                                       
          CALL      RPCCAD1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCADA10
HCCADA35
          MOVE      ST1,KEY11
          CALL      RDCCAD1 
          CALL      RPCCAD1 
          BRANCH    OVRCD,HCCADA85
          PACK      KEY11,CCADDEF,CCADPC,SP70                                   
          MATCH     SAVKEY80,KEY11                                              
          GOTO      HCCADA85 IF NOT EQUAL                                       
          MATCH     SP70,CCADPC                                                 
          GOTO      HCCADA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HCCADA36
          CALL      RPCCAD1 
          BRANCH    OVRCD,HCCADA37
          PACK      KEY11,CCADDEF,CCADPC,SP70                                   
          MATCH     SAVKEY80,KEY11                                              
          GOTO      HCCADA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCCADA36 IF NOT EQUAL
HCCADA37
          MOVE      ZERO,XITEMNO
          GOTO      HCCADA10
HCCADA40
          MOVE      ST1,KEY11
          CALL      RDCCAD1 
          CALL      RPCCAD1 
          BRANCH    OVRCD,HCCADA85
          PACK      KEY11,CCADDEF,CCADPC,SP70                                   
          MATCH     SAVKEY80,KEY11                                              
          GOTO      HCCADA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCADA08
HCCADA45
          CALL      RKCCAD1 
          BRANCH    OVRCD,HCCADA85
          PACK      KEY11,CCADDEF,CCADPC,SP70                                   
          MATCH     SAVKEY80,KEY11                                              
          GOTO      HCCADA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY11,SAVKEY80,Z70                                          
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSCCAD1 
HCCADA46
          CALL      RPCCAD1 
          BRANCH    OVRCD,HCCADA47
          PACK      KEY11,CCADDEF,CCADPC,SP70                                   
          MATCH     SAVKEY80,KEY11                                              
          GOTO      HCCADA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCCADA46 IF NOT EQUAL
HCCADA47
          MOVE      ZERO,XITEMNO
          GOTO      HCCADA10
HCCADA50  COMPARE   ZERO,CSEARCH
          GOTO      HCCADA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          KEYIN     *PSTDCOL04:STDROW,*V2LON,SCHFLD04
          RESET     SCHFLD04
          KEYIN     *PSTDCOL05:STDROW,*V2LON,SCHFLD05
          RESET     SCHFLD05
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCADA08
HCCADA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCADA08
HCCADA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HCCADA61 IF EQUAL
          MATCH     SCHFLD01,CCADPC  
          GOTO      HCCADA72 IF NOT EQUAL
HCCADA61
          MATCH     SP70,SCHFLD02
          GOTO      HCCADA62 IF EQUAL
          MATCH     SCHFLD02,CCADLV2 
          GOTO      HCCADA72 IF NOT EQUAL
HCCADA62
          MATCH     SP70,SCHFLD03
          GOTO      HCCADA63 IF EQUAL
          MATCH     SCHFLD03,CCADLV3 
          GOTO      HCCADA72 IF NOT EQUAL
HCCADA63
          MATCH     SP70,SCHFLD04
          GOTO      HCCADA64 IF EQUAL
          MATCH     SCHFLD04,CCADLV4 
          GOTO      HCCADA72 IF NOT EQUAL
HCCADA64
          MATCH     SP70,SCHFLD05
          GOTO      HCCADA65 IF EQUAL
          MATCH     SCHFLD05,CCADDES 
          GOTO      HCCADA72 IF NOT EQUAL
HCCADA65
HCCADA66
HCCADA67
HCCADA68
HCCADA69
HCCADA70
          GOTO      HCCADA75
HCCADA72  MOVE      ONE,OVRCD
HCCADA75  RETURN
HCCADA85
          LOAD      KEY11,XITEMNO,ST1,ST2,ST3,ST4,ST5:                          
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY11,CCADDEF,CCADPC                                        
          CALL      RDCCAD1 
HCCADA90
          UNPACK    SAVKEY80,CCADDEF,CCADPC                                     
          BEEP
          GOTO      HCCADA20
HCCADA91
          MOVE      SP70,CCADDES 
          MOVE      SP70,CCADLV2 
          MOVE      SP70,CCADLV3 
          MOVE      SP70,CCADLV4 
          MOVE      SP70,CCADSPA 
          MOVE      SP70,KEY11
          MOVE      SP70,CCADPC  
          GOTO      HCCADA96
HCCADA92
          MOVE      SP70,KEY11
          MOVE      SP70,CCADPC  
          LOAD      KEY11,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY11,CCADDEF,CCADPC                                        
HCCADA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HCCADA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Clinical Costing System            
.   Include   :   CCSAADKY
.   Routine   :   KCCADA00 Keyin Post Code           
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KCCADA00 TOPIC     "CCADPC  "
          MOVE      UNDLN70,CCADPC  
          KEYIN     *PCCOL:CVERT,*DV,CCADPC:                                    
                    *PCCOL:CVERT,*V2LON,CCADPC:                                 
                    *PCCOL:CVERT,*DV,CCADPC  
.
          ENDSET    CCADPC  
          APPEND    SP70,CCADPC  
          RESET     CCADPC  
.
          MATCH     SP70,CCADPC  
          GOTO      KCCADA90 IF EQUAL
.
          CMATCH    EXITCHAR,CCADPC  
          GOTO      KCCADA95 IF EQUAL
.
          CMATCH    QUEST,CCADPC  
          GOTO      KCCADA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCADA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCADPC  
          APPEND    SP70,CCADPC  
          RESET     CCADPC  
.
          MATCH     SP70,CCADPC  
          GOTO      KCCADA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,CCADPC                                  
KCCADA10
          PACK      KEY11,CCADDEF,CCADPC                                        
          CALL      RACCAD1 
          BRANCH    OVRCD,KCCADA80
          BRANCH    CKEYTYP,KCCADA75
          CALL      RDCCAD1 
KCCADA70
          MOVE      ZERO,EXIT
          GOTO      KCCADA99
KCCADA75
          MOVE      "Post Code Already Exist - ",DISPMSG                                             
          CALL      MESSAGE1
          GOTO      KCCADA00
KCCADA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KCCADA99,KCCADA99
          MOVE      "Post Code Does Not Exist - ",DISPMSG                                            
          CALL      MESSAGE1
          GOTO      KCCADA00
KCCADA90
          MOVE      ONE,EXIT
          GOTO      KCCADA99
KCCADA95
          MOVE      TWO,EXIT
KCCADA99 TOPIC    PRGID
          RETURN
