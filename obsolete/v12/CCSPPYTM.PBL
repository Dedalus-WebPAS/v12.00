. *----------------------------------------------------------------------
. * Include Name  :   CCSPPYTM.PBL
. *
. * Function      :   CGI variables and tags for CCSPPYFD - ccsppyaf.dat
. *
. * Includes Needed :
. *
. *----------------------------------------------------------------------
.  Modifications Done :
.
.  V9.03.00   15/03/2004  Ebon Clements             CAR 45489
.             Created include
. *----------------------------------------------------------------------
.------------------------------------------------------------
. Clear PowerPlay table cgi variables
.------------------------------------------------------------
CPCSPY00  MOVE      Z70,CSPPY001                 * Use POWERXID
          MOVE      Z70,CSPPY002
          MOVE      Z70,CSPPY003
          MOVE      Z70,CSPPY004
          MOVE      Z70,CSPPY005
          MOVE      Z70,CSPPY006
          MOVE      Z70,CSPPY007
          MOVE      Z70,CSPPY008
          MOVE      Z70,CSPPY009 
          MOVE      Z70,CSPPY010
          MOVE      Z70,CSPPY011
          MOVE      Z70,CSPPY012
          MOVE      Z70,CSPPY013
          MOVE      Z70,CSPPY014
          MOVE      Z70,CSPPY015
          MOVE      Z70,CSPPY016
          MOVE      Z70,CSPPY017
          MOVE      Z70,CSPPY018
          MOVE      Z70,CSPPY019
          MOVE      Z70,CSPPY020
          MOVE      Z70,CSPPY021
          MOVE      Z70,CSPPY022
          MOVE      Z70,CSPPY023
          MOVE      Z70,CSPPY024
          MOVE      Z70,CSPPY025
          MOVE      Z70,CSPPY026
          MOVE      Z70,CSPPY027
          MOVE      Z70,CSPPY028
          MOVE      Z70,CSPPY029
          MOVE      Z70,CSPPY030
          MOVE      Z70,CSPPY031
          MOVE      Z70,CSPPY032
          MOVE      Z70,CSPPY033
          MOVE      Z70,CSPPY034
.
CPCSPY99  RETURN
.
.------------------------------------------------------------
. Display PowerPlay table
.------------------------------------------------------------
CSPY0000  BRANCH    FLDITMNO,CSPY0010,CSPY0020,CSPY0030,CSPY0040,CSPY0050:
                             CSPY0060,CSPY0070,CSPY0080,CSPY0090,CSPY0100:
                             CSPY0110,CSPY0120,CSPY0130,CSPY0140,CSPY0150:
                             CSPY0160,CSPY0170,CSPY0180,CSPY0190,CSPY0200:
                             CSPY0210,CSPY0220,CSPY0230,CSPY0240,CSPY0250:
                             CSPY0260,CSPY0270,CSPY0280,CSPY0290,CSPY0300:
                             CSPY0310,CSPY0320,CSPY0330,CSPY0340
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      CSPY9999
.
CSPY0010  WRITE     HTMLFILE;CCPPPID;
          GOTO      CSPY9999
.
CSPY0020  WRITE     HTMLFILE;CCPPDES;
          GOTO      CSPY9999
.
CSPY0030  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CSPY0035,CSPY0036
.
          PACK      KEY4,CCPPEID,SP70
          CALL      RDCCEA1
          IF        OVRCD=0 
            WRITE     HTMLFILE;CCEADES;
          ENDIF
          GOTO      CSPY9999
.
CSPY0035  WRITE     HTMLFILE;CCPPEID;
          GOTO      CSPY9999
.
CSPY0036  PACK      KEY4,CCPPEID,SP70
          CALL      RDCCEA1
          BRANCH    OVRCD,CSPY9999
.
          PACK      KEY3,CCEALV1,SP70
          CALL      RDCCST1
          BRANCH    OVRCD,CSPY9999
.
          WRITE     HTMLFILE;CCSTDES;
          GOTO      CSPY9999
.
CSPY0040  CALL      SELTIM00                     * Select Time Period
          GOTO      CSPY9999
.
CSPY0050  WRITE     HTMLFILE;CCPPARE;
          GOTO      CSPY9999
.
CSPY0060  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CSPY0065
.
          PACK      KEY3,CCPPCT1,SP70
          CALL      RDCCST1
          BRANCH    OVRCD,CSPY9999
.
          WRITE     HTMLFILE;CCSTDES;
          GOTO      CSPY9999

CSPY0065  WRITE     HTMLFILE;CCPPCT1;
          GOTO      CSPY9999
.
CSPY0070  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CSPY0075
.
          PACK      KEY3,CCPPCT2,SP70
          CALL      RDCCST1
          BRANCH    OVRCD,CSPY9999
.
          WRITE     HTMLFILE;CCSTDES;
          GOTO      CSPY9999

CSPY0075  WRITE     HTMLFILE;CCPPCT2;
          GOTO      CSPY9999
.
CSPY0080  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CSPY0085
.
          PACK      KEY3,CCPPCT3,SP70
          CALL      RDCCST1
          BRANCH    OVRCD,CSPY9999
.
          WRITE     HTMLFILE;CCSTDES;
          GOTO      CSPY9999

CSPY0085  WRITE     HTMLFILE;CCPPCT3;
          GOTO      CSPY9999
.
CSPY0090  WRITE     HTMLFILE;CCPPDN1;
          GOTO      CSPY9999
.
CSPY0100  WRITE     HTMLFILE;CCPPDN2;
          GOTO      CSPY9999
.
CSPY0110  WRITE     HTMLFILE;CCPPDN3;
          GOTO      CSPY9999
.
CSPY0120  WRITE     HTMLFILE;CCPPDN4;
          GOTO      CSPY9999
.
CSPY0130  WRITE     HTMLFILE;CCPPDN5;
          GOTO      CSPY9999
.
CSPY0140  WRITE     HTMLFILE;CCPPEPS;
          GOTO      CSPY9999
.
CSPY0150  WRITE     HTMLFILE;CCPPNE;
          GOTO      CSPY9999
.
CSPY0160  WRITE     HTMLFILE;CCPPBD;
          GOTO      CSPY9999
.
CSPY0170  WRITE     HTMLFILE;CCPPC1;
          GOTO      CSPY9999
.
CSPY0180  WRITE     HTMLFILE;CCPPC2;
          GOTO      CSPY9999
.
CSPY0190  WRITE     HTMLFILE;CCPPACC;
          GOTO      CSPY9999
.
CSPY0200  WRITE     HTMLFILE;CCPPTHE;
          GOTO      CSPY9999
.
CSPY0210  WRITE     HTMLFILE;CCPPOTH;
          GOTO      CSPY9999
.
CSPY0220  WRITE     HTMLFILE;CCPPALOS;
          GOTO      CSPY9999
.
CSPY0230  WRITE     HTMLFILE;CCPPAC1;
          GOTO      CSPY9999
.
CSPY0240  WRITE     HTMLFILE;CCPPAC2;
          GOTO      CSPY9999
.
CSPY0250  WRITE     HTMLFILE;CCPPAACC;
          GOTO      CSPY9999
.
CSPY0260  WRITE     HTMLFILE;CCPPATHE;
          GOTO      CSPY9999
.
CSPY0270  WRITE     HTMLFILE;CCPPAOTH;
          GOTO      CSPY9999
.
CSPY0280  WRITE     HTMLFILE;CCPPBC1;
          GOTO      CSPY9999
.
CSPY0290  WRITE     HTMLFILE;CCPPBC2;
          GOTO      CSPY9999
.
CSPY0300  WRITE     HTMLFILE;CCPPBACC;
          GOTO      CSPY9999
.
CSPY0310  WRITE     HTMLFILE;CCPPBTHE;
          GOTO      CSPY9999
.
CSPY0320  WRITE     HTMLFILE;CCPPBOTH;
          GOTO      CSPY9999
.
CSPY0330  WRITE     HTMLFILE;CCPPSPA1;
          GOTO      CSPY9999
.
CSPY0340  WRITE     HTMLFILE;CCPPSPA2;
          GOTO      CSPY9999
.
CSPY9999  RETURN
.
.
.------------------------------------------------------------
.   Set Parameters for PowerPlay file
.------------------------------------------------------------
SPCPY000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPCPY001,SPCPY002,SPCPY003,SPCPY004,SPCPY005:
                       SPCPY006,SPCPY007,SPCPY008,SPCPY009,SPCPY010:
                       SPCPY011,SPCPY012,SPCPY013,SPCPY014,SPCPY015:
                       SPCPY016,SPCPY017,SPCPY018,SPCPY019,SPCPY020:
                       SPCPY021,SPCPY022,SPCPY023,SPCPY024,SPCPY025:
                       SPCPY026,SPCPY027,SPCPY028,SPCPY029,SPCPY030:
                       SPCPY031,SPCPY032,SPCPY033,SPCPY034
.
          MOVE      ONE,EXIT
          GOTO      SPCPY999
.
SPCPY001  SQUEEZE   QRYDATA
          MOVE      QRYDATA,CSPPY001
          PACK      CSPPY001,CSPPY001,SP70
          GOTO      SPCPY999
.
SPCPY002  MOVE      QRYDATA,CSPPY002
          GOTO      SPCPY999
.
SPCPY003  MOVE      QRYDATA,CSPPY003
          GOTO      SPCPY999
.
SPCPY004  MOVE      QRYDATA,CSPPY004
          GOTO      SPCPY999
.
SPCPY005  MOVE      QRYDATA,CSPPY005
          GOTO      SPCPY999
.
SPCPY006  MOVE      QRYDATA,CSPPY006
          GOTO      SPCPY999
.
SPCPY007  MOVE      QRYDATA,CSPPY007
          GOTO      SPCPY999
.
SPCPY008  MOVE      QRYDATA,CSPPY008
          GOTO      SPCPY999
.
SPCPY009  MOVE      QRYDATA,CSPPY009
          GOTO      SPCPY999
.
SPCPY010  MOVE      QRYDATA,CSPPY010
          GOTO      SPCPY999
.
SPCPY011  MOVE      QRYDATA,CSPPY011
          GOTO      SPCPY999
.
SPCPY012  MOVE      QRYDATA,CSPPY012
          GOTO      SPCPY999
.
SPCPY013  MOVE      QRYDATA,CSPPY013
          GOTO      SPCPY999
.
SPCPY014  MOVE      QRYDATA,CSPPY014
          GOTO      SPCPY999
.
SPCPY015  MOVE      QRYDATA,CSPPY015
          GOTO      SPCPY999
.
SPCPY016  MOVE      QRYDATA,CSPPY016
          GOTO      SPCPY999
.
SPCPY017  MOVE      QRYDATA,CSPPY017
          GOTO      SPCPY999
.
SPCPY018  MOVE      QRYDATA,CSPPY018
          GOTO      SPCPY999
.
SPCPY019  MOVE      QRYDATA,CSPPY019
          GOTO      SPCPY999
.
SPCPY020  MOVE      QRYDATA,CSPPY020
          GOTO      SPCPY999
.
SPCPY021  MOVE      QRYDATA,CSPPY021
          GOTO      SPCPY999
.
SPCPY022  MOVE      QRYDATA,CSPPY022
          GOTO      SPCPY999
.
SPCPY023  MOVE      QRYDATA,CSPPY023
          GOTO      SPCPY999
.
SPCPY024  MOVE      QRYDATA,CSPPY024
          GOTO      SPCPY999
.
SPCPY025  MOVE      QRYDATA,CSPPY025
          GOTO      SPCPY999
.
SPCPY026  MOVE      QRYDATA,CSPPY026
          GOTO      SPCPY999
.
SPCPY027  MOVE      QRYDATA,CSPPY027
          GOTO      SPCPY999
.
SPCPY028  MOVE      QRYDATA,CSPPY028
          GOTO      SPCPY999
.
SPCPY029  MOVE      QRYDATA,CSPPY029
          GOTO      SPCPY999
.
SPCPY030  MOVE      QRYDATA,CSPPY030
          GOTO      SPCPY999
.
SPCPY031  MOVE      QRYDATA,CSPPY031
          GOTO      SPCPY999
.
SPCPY032  MOVE      QRYDATA,CSPPY032
          GOTO      SPCPY999
.
SPCPY033  MOVE      QRYDATA,CSPPY033
          GOTO      SPCPY999
.
SPCPY034  MOVE      QRYDATA,CSPPY034
          GOTO      SPCPY999
.
SPCPY999  RETURN
.
.------------------------------------------------------------
.  Update PowerPlay file
.------------------------------------------------------------
MVCSPY00  MATCH     CSPPY001,Z70                 * Use POWERXID
          IF        !@EQUAL
            MOVE      CSPPY001,CCPPPID
          ENDIF
.
          MATCH     CSPPY002,Z70
          IF        !@EQUAL
            MOVE      CSPPY002,CCPPDES
          ENDIF
.
          MATCH     CSPPY003,Z70
          IF        !@EQUAL
            MOVE      CSPPY003,CCPPEID
          ENDIF
.
          MATCH     CSPPY004,Z70
          IF        !@EQUAL
            MOVE      CSPPY004,CCPPTIM
          ENDIF
.
          MATCH     CSPPY005,Z70
          IF        !@EQUAL
            MOVE      CSPPY005,CCPPARE
          ENDIF
.
          MATCH     CSPPY006,Z70
          IF        !@EQUAL
            MOVE      CSPPY006,CCPPCT1
          ENDIF
.
          MATCH     CSPPY007,Z70
          IF        !@EQUAL
            MOVE      CSPPY007,CCPPCT2
          ENDIF
.
          MATCH     CSPPY008,Z70
          IF        !@EQUAL
            MOVE      CSPPY008,CCPPCT3
          ENDIF
.
          MATCH     CSPPY009,Z70
          IF        !@EQUAL
            MOVE      CSPPY009,CCPPDN1
          ENDIF
.
          MATCH     CSPPY010,Z70
          IF        !@EQUAL
            MOVE      CSPPY010,CCPPDN2
          ENDIF
.
          MATCH     CSPPY011,Z70
          IF        !@EQUAL
            MOVE      CSPPY011,CCPPDN3
          ENDIF
.
          MATCH     CSPPY012,Z70
          IF        !@EQUAL
            MOVE      CSPPY012,CCPPDN4
          ENDIF
.
          MATCH     CSPPY013,Z70
          IF        !@EQUAL
            MOVE      CSPPY013,CCPPDN5
          ENDIF
.
          MATCH     CSPPY014,Z70
          IF        !@EQUAL
            MOVE      CSPPY014,CCPPEPS
          ENDIF
.
          MATCH     CSPPY015,Z70
          IF        !@EQUAL
            MOVE      CSPPY015,CCPPNE
          ENDIF
.
          MATCH     CSPPY016,Z70
          IF        !@EQUAL
            MOVE      CSPPY016,CCPPBD
          ENDIF
.
          MATCH     CSPPY017,Z70
          IF        !@EQUAL
            MOVE      CSPPY017,CCPPC1
          ENDIF
.
          MATCH     CSPPY018,Z70
          IF        !@EQUAL
            MOVE      CSPPY018,CCPPC2
          ENDIF
.
          MATCH     CSPPY019,Z70
          IF        !@EQUAL
            MOVE      CSPPY019,CCPPACC
          ENDIF
.
          MATCH     CSPPY020,Z70
          IF        !@EQUAL
            MOVE      CSPPY020,CCPPTHE
          ENDIF
.
          MATCH     CSPPY021,Z70
          IF        !@EQUAL
            MOVE      CSPPY021,CCPPOTH
          ENDIF
.
          MATCH     CSPPY022,Z70
          IF        !@EQUAL
            MOVE      CSPPY022,CCPPALOS
          ENDIF
.
          MATCH     CSPPY023,Z70
          IF        !@EQUAL
            MOVE      CSPPY023,CCPPAC1
          ENDIF
.
          MATCH     CSPPY024,Z70
          IF        !@EQUAL
            MOVE      CSPPY024,CCPPAC2
          ENDIF
.
          MATCH     CSPPY025,Z70
          IF        !@EQUAL
            MOVE      CSPPY025,CCPPACC
          ENDIF
.
          MATCH     CSPPY026,Z70
          IF        !@EQUAL
            MOVE      CSPPY026,CCPPATHE
          ENDIF
.
          MATCH     CSPPY027,Z70
          IF        !@EQUAL
            MOVE      CSPPY027,CCPPAOTH 
          ENDIF
.
          MATCH     CSPPY028,Z70
          IF        !@EQUAL
            MOVE      CSPPY028,CCPPBC1
          ENDIF
.
          MATCH     CSPPY029,Z70
          IF        !@EQUAL
            MOVE      CSPPY029,CCPPBC2
          ENDIF
.
          MATCH     CSPPY030,Z70
          IF        !@EQUAL
            MOVE      CSPPY030,CCPPBACC
          ENDIF
.
          MATCH     CSPPY031,Z70
          IF        !@EQUAL
            MOVE      CSPPY031,CCPPBTHE
          ENDIF
.
          MATCH     CSPPY032,Z70
          IF        !@EQUAL
            MOVE      CSPPY032,CCPPBOTH
          ENDIF
.
          MATCH     CSPPY033,Z70
          IF        !@EQUAL
            MOVE      CSPPY033,CCPPSPA1
          ENDIF
.
          MATCH     CSPPY034,Z70
          IF        !@EQUAL
            MOVE      CSPPY034,CCPPSPA2
          ENDIF
.
MVCSPY99  RETURN
.
.------------------------------------------------------------
.  Clear CCSPPYFD variables
.------------------------------------------------------------
CLCSPY00  MOVE      SP70,CCPPPID
          MOVE      SP70,CCPPDES
          MOVE      SP70,CCPPEID
          MOVE      ZERO,CCPPTIM
          MOVE      ZERO,CCPPARE
          MOVE      SP70,CCPPCT1
          MOVE      SP70,CCPPCT2
          MOVE      SP70,CCPPCT3
          MOVE      SP70,CCPPDN1
          MOVE      SP70,CCPPDN2
          MOVE      SP70,CCPPDN3
          MOVE      SP70,CCPPDN4
          MOVE      SP70,CCPPDN5
          MOVE      ZERO,CCPPEPS  
          MOVE      ONE,CCPPNE   
          MOVE      ONE,CCPPBD   
          MOVE      ONE,CCPPC1   
          MOVE      ONE,CCPPC2   
          MOVE      ZERO,CCPPACC  
          MOVE      ZERO,CCPPTHE  
          MOVE      ZERO,CCPPOTH  
          MOVE      ONE,CCPPALOS 
          MOVE      ONE,CCPPAC1  
          MOVE      ONE,CCPPAC2  
          MOVE      ZERO,CCPPAACC 
          MOVE      ZERO,CCPPATHE 
          MOVE      ZERO,CCPPAOTH 
          MOVE      ONE,CCPPBC1  
          MOVE      ONE,CCPPBC2  
          MOVE      ZERO,CCPPBACC 
          MOVE      ZERO,CCPPBTHE 
          MOVE      ZERO,CCPPBOTH 
          MOVE      SP70,CCPPSPA1
          MOVE      SP70,CCPPSPA2
.
CLCSPY99  RETURN
.
.------------------------------------------------------------
. Select Time Period
.------------------------------------------------------------
SELTIM00  MATCH     "0",CCPPTIM
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",ZERO,"#" selected>":
                               ZERO,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",ZERO,"#">":
                               ZERO,"</option>"
          ENDIF
.
          MOVE      SP70,DIM1
          PACK      KEY9,SP70
          CALL      RSCCTM1
SELTIM10  CALL      RKCCTM1
          BRANCH    OVRCD,SELTIM99
.
          MATCH     DIM1,CCTMDEF
          GOTO      SELTIM10 IF EQUAL
.
          MATCH     CCPPTIM,CCTMDEF
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",CCTMDEF,"#" selected>":
                               CCTMDEF,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",CCTMDEF,"#">":
                               CCTMDEF,"</option>"
          ENDIF
.
          MOVE      CCTMDEF,DIM1
.
          GOTO      SELTIM10
.
SELTIM99  RETURN
