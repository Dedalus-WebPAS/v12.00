.----------------------------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.----------------------------------------------------------------------------
.V11.05.01  20/03/2025  Davin          TSK 0956210
.           Add ICD10 Ed.13 - Go-live Date PTCNGDX3 (Sect.130 Pos.86)
.V11.02.01  31/03/2022  Davin          TSK 0917793
.           Add ICD10 Ed.12 - Go-live Date PTCNGDX2 (Sect.128 Pos.231)
.----------------------------------------------------------------------------
.V10.10.01  17/03/2017  Davin          TSK 0833093     HDP 2017/2018
.           Add ICD10 Ed.10 - Go-live Date PTCNGDVX (Sect.110 Pos.85)
.V10.06.01  17/03/2015  Davin         CAR 311669      HDP 2015/16
.           Add PTCNGDV9 for ICD10 Ed.9 Go-live Date (Sect.110 Pos.77)
.V10.03.02  23/04/2013  Davin         CAR 284420      HDP 2013/14
.           Add PTCNGDV8 for ICD10 Ed.8 Go-live Date (Sect.110 Pos.69)
. V10.03.01 17/11/2011  Mike Laming     CAR 240184
.           Changes to IBAPOSTF Post Code table - added State to Keys
.V10.00.02  04/06/2010  Ebon Clements CAR 211936
.           Add state srg and transfer source codes
.V10.00.01  07/04/2010  Mike Laming   CAR 219246      HDP 2010
.           Add PTCNGDV7 for ICD10 Ed.7 Go-live Date (Sect.110 Pos.61)
. V9.12.01  12/08/2009 Ebon Clements CAR 198266
.           Added CCEPRHC1 to PDOC0000
. V9.11.01  28/01/2009 Ebon Clements CAR 178341
.           Added CCEPUC21 to CCEPUC28 at PROC0000
. V9.09.01  20/03/2008 Mike Laming   CAR 163918    HDP 2008
.           Add PTCNGDV6 for ICD10 Ed.6 Go-live
. V9.08.01  04/05/2007  Mike Laming  CAR 137125 HDP 2007 DRG 5.2
.           Mods to PATDGWFD - Add field PTDWDRGV (add to Keys)
. V9.06.01  15/05/2006  Mike Laming   CAR 105244      2006 HDP
.           ADD PTCNGDV5 for ICD10 Ed.5 Go-live
. V9.04.01  01.20.2004  Ebon Clements            CAR 52623
.           Changed LOADNAME to be a DIM 55
. V9.03.02  23.06.2004  Henry Son                CAR 49037
.           ICD10 Ed.4 changes - add PTCNGDV4.
. V9.03.01  10.03.2004  Sylvek Litewka  CAR 46521	
.           Added processing for new outpatients, emergency and allied health
.           Casemic types. (Added functions LOUT0000 and LALH0000. Modified
.           PROC0000).
.----------------------------------------------------------------------------
. V9.02.01  09.07.2002  Glenn Saunders
.           Recompile for changes in includes shared with Southland, but with
.           previously different formats - now merged.  Includes effected :-
.           CCSCEAFD, CCSCONFD, CCSEPSFD, CCSHCDFD, CCSHLCFD, CCSIADFD
.-------------------------------------------------------
. V9.02.00  14.06.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.           Remove PSN prefixed PAS cloned includes
.----------------------------------------------------------------------------
. V5.07.02  14.12.1999 Charles Handaya
.           Fixed DRG Codes
. V5.07.01  02.10.1999 B.G.Ackland
.           Open Fund File with OPPTFNS1
.----------------------------------------------------------------------------
. V6.03.02  30.10.1995 B.G.Ackland
.           Phase 1 WGH Changes
. V6.03.01  02.10.1995 B.G.Ackland
.           Upgrade to Release 5.03
. V6.03.00  02.10.1995 B.G.Ackland
.           Copied to Release 6.03
.----------------------------------------------------------------------------
. V6.01.02  22.06.1994 B.G.Ackland
.           Chnage MBS & ICD Descriptions to Include Code
.----------------------------------------------------------------------------
CCSTMPAF  FILE      ASCII, FIXED=80
OPROPROP  FORM      1
OPRCLIOP  FORM      1
OPCNCLSU  FORM      1        111      Using Clinic or Surgeon ?
.                                          0 = Clinic
.                                          1 = Surgeon
PATDOCOP  FORM      1
PTCNDGPV  DIM       3                                                 *I-137125
PTCNGDV3  DIM       8
PTCNGDV4  DIM       8                  * Ed4 golive date               *I-49037
PTCNGDV5  DIM       8                       * Ed5 golive date         *I-105244
PTCNGDV6  DIM       8                       * Ed.6 Go-live date       *I-163918
PTCNGDV7  DIM       8                       * Ed.7 Go-live date       *I-219246
PTCNGDV8  DIM       8                       * Ed.8 Go-live date       *I-284420
PTCNGDV9  DIM       8                       * Ed.9 Go-live date       *I-311669
PTCNGDVX  DIM       8                       * Ed.10 Go-live date      *I-0833093
PTCNGDX1  DIM       8                       * Go live date for ICD10 Ed.11
PTCNGDX2  DIM       8                       * Go live date for ICD10 Ed.12
PTCNGDX3  DIM       8                       * Go live date for ICD10 Ed.13
PTCNI10D  DIM       8
.
CFILEPRE  DIM       3   * Current Open File Prefix for Outpatient Files
PRFXDONE  FORM      1
.
.----------------------------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACIA07
.   Function      :   Casemix Codes Maintenance               
.   Generated  On :   17/11/2011
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       ALLDIAFD/INC
          INC       ALLPRRFD/INC
          INC       ALLSERFD/INC
          INC       CCSDRGFD/INC
          INC       CCSHLCFD/INC
          INC       CCSSTYFD/INC
          INC       CCSXHDFD/INC
          INC       IBAPOSFD/INC
          INC       OPRCLIFD/INC
          INC       OPROPRFD/INC
          INC       OUTCLIFD/INC
          INC       OUTCTYFD/INC
          INC       OUTSITFD/INC
          INC       PATCODFD/INC
          INC       PATDGWFD/INC
          INC       PATDO1FD/INC
          INC       PATFN1FD/INC
          INC       PATICDFD/INC
          INC       PATICOFD/INC
          INC       PATITMFD/INC
          INC       PATVADFD/INC
          INC       PATWR1FD/INC
          INC       PMSHCPFD/INC
.=========================
.Local Variable Definition
.-------------------------
LOADNAME  DIM      55 * Scr 00 Fld     2
CMIXSTY   DIM       3 * Scr 02 Fld     1
CMIXKEY   DIM      10 * Scr 02 Fld     2
CMIXDES   DIM      35 * Scr 02 Fld     4
CMIXSUM   DIM      10 * Scr 02 Fld     5
SUMDES    DIM      35 * Scr 02 Fld    10
SAVETYPE  DIM       3 * Scr 02 Fld    12
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACIA07"
PRGNAM    INIT      "Casemix Codes Maintenance               "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC01L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening alldiaaf";
          OPEN      ALLDIAA1,"alldiaaf"
          DISPLAY   *P56:24,"Opening alldiaaf";
          OPEN      ALLDIAA2,"alldiaaf"
          DISPLAY   *P56:24,"Opening allprraf";
          OPEN      ALLPRRA1,"allprraf"
          DISPLAY   *P56:24,"Opening allprraf";
          OPEN      ALLPRRA2,"allprraf"
          DISPLAY   *P56:24,"Opening allseraf";
          OPEN      ALLSERA1,"allseraf"
          DISPLAY   *P56:24,"Opening allseraf";
          OPEN      ALLSERA2,"allseraf"
          DISPLAY   *P56:24,"Opening ccsdrgaf";
          OPEN      CCSDRGA1,"ccsdrgaf"
          DISPLAY   *P56:24,"Opening ccshlcaf";
          OPEN      CCSHLCA1,"ccshlcaf"
          DISPLAY   *P56:24,"Opening ccsstyaf";
          OPEN      CCSSTYA1,"ccsstyaf"
          DISPLAY   *P56:24,"Opening ccsstyaf";
          OPEN      CCSSTYA2,"ccsstyaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA1,"ccsxhdaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA2,"ccsxhdaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA3,"ccsxhdaf"
          DISPLAY   *P56:24,"Opening  outsitaf           ";
          OPEN      OUTSITA3,"outsitaf"          
          DISPLAY   *P56:24,"Opening  patcodes           ";
          OPEN      PATCODE1,"patcodes"          
          DISPLAY   *P56:24,"Opening  patdo1af           ";
          OPEN      PATDO1A1,"patdo1af"          
          DISPLAY   *P56:24,"Opening  patfn1af           ";
          OPEN      PATFN1A1,"patfn1af"          
          DISPLAY   *P56:24,"Opening  patitemn           ";
          OPEN      PATITEM1,"patitemn"          
          DISPLAY   *P56:24,"Opening  patvadaf           ";
          OPEN      PATVADA1,"patvadaf"          
          DISPLAY   *P56:24,"Opening  patwr1af           ";
          OPEN      PATWR1A1,"patwr1af"          
          DISPLAY   *P56:24,"Opening pmshcpaf";
          OPEN      PMSHCPA1,"pmshcpaf"
          DISPLAY   *P56:24,"Opening pmshcpaf";
          OPEN      PMSHCPA2,"pmshcpaf"
          DISPLAY   *P56:24,"Opening pmshcpaf";
          OPEN      PMSHCPA3,"pmshcpaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Cross Reference Description Load   
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Options                            
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Maintain Casemix Codes             
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Casemix Type Maintenance           
          ENDIF
          RETURN
.--------------------------------
. Screen - Cross Reference Description Load   
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      MVACCEPT
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Cross Reference Description Load   
.-------------------------------------------------------
CF00L000
          MOVE      SP70,LOADNAME
          MOVE      SP70,CCSTSTY 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Cross Reference Description Load   
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Cross Reference Description Load   
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Cross Reference Description Load   
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Cross Reference Description Load   
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Cross Reference Description Load   
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L101,PS00L999,PS00L999:
                            PS00L102,PS00L103
          GOTO     PS00L999
.
PS00L101
          MOVE      LOADNAME,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      CCSTSTY,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      CCSTDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Cross Reference Description Load   
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L101,SF00L020,SF00L020:
                            SF00L104,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL     SELECTED
          STRIP     LOADNAME
          SFORMAT   VAR,SCPSLEN
          MOVE      LOADNAME,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,LOADNAME
          SFORMAT   VAR,127
          ENDSET    LOADNAME
          APPEND    SP70,LOADNAME
          RESET     LOADNAME
          CMATCH    EXITCHAR,LOADNAME
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,LOADNAME
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L101
            ENDIF
          ENDIF
          MOVE      LOADNAME,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L102
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      LOAD0000
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L104
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCSTDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCCSTA00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L104
            ENDIF
            BRANCH    EXIT,SF00L104,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CCSTSTY,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCSTDES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.--------------------------------
. Screen - Options                            
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Options                            
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Options                            
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Options                            
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Options                            
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Options                            
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Options                            
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Options                            
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L104,SF01L105,SF01L106,SF01L107:
                            SF01L108,SF01L109,SF01L110,SF01L111:
                            SF01L112,SF01L113,SF01L114,SF01L115:
                            SF01L116,SF01L117
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          CALL      SC00L000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      PROC0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L103
          CALL      PDOC0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L104
          CALL      PWAR0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L105
          CALL      PICD0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L106
          CALL      AICD0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L107
          CALL      PMBS0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L108
          CALL      PFUN0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L109
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L110
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L111
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L112
          CALL      PCLI0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L113
          CALL      PDRG0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L114
          CALL      PPST0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L115
          CALL      LOUT0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L116
          CALL      LALH0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L117
          CALL      PVAD0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Maintain Casemix Codes             
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Maintain Casemix Codes             
.-------------------------------------------------------
CF02L000
          MOVE      SP70,CMIXSTY 
          MOVE      SP70,CMIXKEY 
          MOVE      SP70,CMIXDES 
          MOVE      SP70,CMIXSUM 
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Maintain Casemix Codes             
.--------------------------------------------------------
KY02L000
.
KY02L110
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCSTDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ETYPE000
          BRANCH    EXIT,KY02L900,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      CMIXSTY,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCSTDES,VAR      
            CALL      DISPITEM
          ENDIF
.
KY02L120
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      ECODE000
          BRANCH    EXIT,KY02L110,KY02L900
          MOVE      OVRCD,ACCEPT
          MOVE      CMIXKEY,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Maintain Casemix Codes             
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Maintain Casemix Codes             
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Maintain Casemix Codes             
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Maintain Casemix Codes             
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L101,PS02L102:
                            PS02L103,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L104,PS02L999,PS02L105
          GOTO     PS02L999
.
PS02L101
          MOVE      CCSTDES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      CMIXDES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      CMIXSUM,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      SUMDES,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      SAVETYPE,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Maintain Casemix Codes             
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L006,SF02L006,SF02L101:
                            SF02L102,SF02L103,SF02L104,SF02L105:
                            SF02L006,SF02L006,SF02L006,SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L101:
                            SF02L102,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          CALL     SELECTED
          STRIP     CMIXDES 
          SFORMAT   VAR,SCPSLEN
          MOVE      CMIXDES,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CMIXDES 
          SFORMAT   VAR,127
          ENDSET    CMIXDES 
          APPEND    SP70,CMIXDES 
          RESET     CMIXDES 
          CMATCH    EXITCHAR,CMIXDES 
          GOTO      SF02L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CMIXDES 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L101
            ENDIF
          ENDIF
          MOVE      CMIXDES,VAR      
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L102
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SUMDES  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESUMM000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L102
            ENDIF
            BRANCH    EXIT,SF02L102,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      CMIXSUM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SUMDES,VAR       
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L103
          CALL      POST0000
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L104
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L105
          CALL      DELT0000
          MOVE      ONE,EXIT
          GOTO      SF02L999
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Casemix Type Maintenance           
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Casemix Type Maintenance           
.-------------------------------------------------------
CF03L000
          MOVE      SP70,CCSTSTY 
          MOVE      SP70,CCSTDES 
          MOVE      ZERO,CCSTLEN 
          MOVE      SP70,CCSTJR  
          MOVE      SP70,CCSTZF  
          MOVE      SP70,CCSTDE  
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Casemix Type Maintenance           
.--------------------------------------------------------
KY03L000
.
KY03L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCCSTA00
          BRANCH    EXIT,KY03L900,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      CCSTSTY,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Casemix Type Maintenance           
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Casemix Type Maintenance           
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Casemix Type Maintenance           
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Casemix Type Maintenance           
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L101,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L102,PS03L103:
                            PS03L104,PS03L105
          GOTO     PS03L999
.
PS03L101
          MOVE      CCSTDES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      CCSTLEN,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCSTJR,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCSTZF,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCSTDE,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Casemix Type Maintenance           
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L006,SF03L102:
                            SF03L103,SF03L104,SF03L105,SF03L106:
                            SF03L107,SF03L108
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L101,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L105,SF03L106:
                            SF03L107,SF03L108
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          CALL     SELECTED
          STRIP     CCSTDES 
          SFORMAT   VAR,SCPSLEN
          MOVE      CCSTDES,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CCSTDES 
          SFORMAT   VAR,127
          ENDSET    CCSTDES 
          APPEND    SP70,CCSTDES 
          RESET     CCSTDES 
          CMATCH    EXITCHAR,CCSTDES 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CCSTDES 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L101
            ENDIF
          ENDIF
          MOVE      CCSTDES,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L102
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L103
          CALL      WCCST000
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELA0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF03L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF03L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF03L999
          ENDIF
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF03L000
          ENDIF
          GOTO      SF03L001
.
SF03L105
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CCSTLEN 
          IF        SCPSMAN=1
            COMPARE   ZERO,CCSTLEN 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L105
            ENDIF
          ENDIF
          MOVE      CCSTLEN,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L106
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CCSTJR  
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCSTJR,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L107
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CCSTZF  
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCSTZF,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L108
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CCSTDE  
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCSTDE,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
SF03L990  MOVE      FOUR,EXIT * Exit Char Exit
SF03L999  RETURN
.@@@@@ Function Restart Point @@@@@
.----------------------------------------
. Move one to accept to for insert mode
.----------------------------------------
MVACCEPT  MOVE      ONE,ACCEPT
          RETURN
.------------------------------------
. Load Summary Cross Reference Names
.------------------------------------
LOAD0000  STRIP     LOADNAME
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCSTMPAF,LOADNAME
          TRAPCLR   IO
          BRANCH    OVRCD,LOAD0090
.
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
.
LOAD0010  READ      CCSTMPAF,SEQ;CCXHKEY,CCXHDES,CCXHSUM
          GOTO      LOAD0080 IF OVER
          PACK      KEY13,CCSTSTY,CCXHKEY
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          DISPLAY   *P30:24,CCXHKEY
          CALL      RACCXH1
          IF        OVRCD=0
            CALL      UPCCXH1
          ELSE
            CALL      WRCCXH1
          ENDIF
          GOTO      LOAD0010
.
LOAD0080  CALL      MESSAGE3
          MOVE      "Completed - ",DISPMSG
          CALL      MESSAGE1
          GOTO      LOAD0099
.
LOAD0090  MOVE      "File Not Found. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      LOAD0099
.
LOAD0099  RETURN
.
.------------------------------------------------------------
. Process IBA Extract
.------------------------------------------------------------
PROC0000  MOVE      "1 ",KEY2
          CALL      RDCCHL1
          IF        OVRCD=1
            MOVE      SP70,CCHLPCD
          ENDIF
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          MATCH    SP70,CCHLPCD
          IF       @EQUAL
            OPEN     PATCODE1,"patcodes"                               * V90200
          ELSE
            MOVE     "patcodes",KEY8
            STRIP    CCHLPCD
            PACK     KEY80,CCHLPCD,KEY8
            OPEN     PATCODE1,KEY80                                    * V90200
          ENDIF
          TRAPCLR  IO
          BRANCH    OVRCD,PROC9900
.
          MOVE      "D ",KEY2
          MOVE      "004",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "DD",KEY2
          MOVE      "005",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "A ",KEY2
          MOVE      "007",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "DT",KEY2
          MOVE      "008",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "S ",KEY2
          MOVE      "010",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "P ",KEY2
          MOVE      "011",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "CC",KEY2
          MOVE      "012",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "A ",KEY2
          MOVE      "014",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "DT",KEY2
          MOVE      "015",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          CALL      VISTYP00                * Load codes for Visit Types
.
          MOVE      "032",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          MOVE      ZERO,F3
PROC1000  MOVE      F3,KEY3
          REP       " 0",KEY3
          PACK      KEY13,CCSTSTY,KEY3,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            CLEAR     CCXHDES
            APPEND    "Age : ",CCXHDES
            APPEND    F3,CCXHDES
            RESET     CCXHDES
            CALL      WRCCXH1
          ENDIF
          ADD       ONE,F3
          COMPARE   "150",F3
          GOTO      PROC1000 IF NOT EQUAL
.
          MOVE      "033",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          PACK      KEY13,CCSTSTY,ANSM,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Male",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "033",CCSTSTY
          PACK      KEY13,CCSTSTY,ANSF,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Female",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "C ",KEY2
          MOVE      "034",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "R ",KEY2
          MOVE      "035",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "U1",KEY2
          MOVE      "047",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "U2",KEY2
          MOVE      "048",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "U3",KEY2
          MOVE      "049",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "U4",KEY2
          MOVE      "050",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "U5",KEY2
          MOVE      "051",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "U6",KEY2
          MOVE      "052",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "U7",KEY2
          MOVE      "053",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "CL",KEY2
          MOVE      "055",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          CALL      WEKDAY00              * Add Week Days
.
          MOVE      "TB",KEY2
          MOVE      "058",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "TB",KEY2
          MOVE      "059",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "40",AUDTSECT
          READ      CONTROLF,AUDTSECT;*111,OPCNCLSU
          IF        OPCNCLSU=1
            MOVE      "DT",KEY2
          ELSE
            MOVE      "YG",KEY2
          ENDIF
          MOVE      "061",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "OA",KEY2
          MOVE      "062",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "OY",KEY2
          MOVE      "063",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "OR",KEY2
          MOVE      "064",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "Y6",KEY2
          MOVE      "065",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "Y7",KEY2
          MOVE      "066",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "Y8",KEY2
          MOVE      "067",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "Y9",KEY2
          MOVE      "068",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "OK",KEY2
          MOVE      "070",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "SP",KEY2
          MOVE      "071",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "ST",KEY2
          MOVE      "072",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "U1",KEY2
          MOVE      "074",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "ES",KEY2
          MOVE      "075",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "EA",KEY2
          MOVE      "076",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "A1",KEY2
          MOVE      "077",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "A2",KEY2
          MOVE      "078",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "A3",KEY2
          MOVE      "079",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "A4",KEY2
          MOVE      "080",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "A5",KEY2
          MOVE      "081",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "A6",KEY2
          MOVE      "082",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "A7",KEY2
          MOVE      "083",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "A8",KEY2
          MOVE      "084",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "EW",KEY2
          MOVE      "085",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "EP",KEY2
          MOVE      "086",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "AE",KEY2
          MOVE      "087",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "AR",KEY2
          MOVE      "088",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "AI",KEY2
          MOVE      "089",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "AP",KEY2
          MOVE      "090",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "AA",KEY2
          MOVE      "091",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "CV",KEY2
          MOVE      "095",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "CS",KEY2
          MOVE      "097",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "DO",KEY2
          MOVE      "098",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "CA",KEY2
          MOVE      "099",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "PR",KEY2
          MOVE      "100",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "O1",KEY2
          MOVE      "101",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "O2",KEY2
          MOVE      "102",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "O3",KEY2
          MOVE      "103",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "O4",KEY2
          MOVE      "104",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "AC",KEY2
          MOVE      "105",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "OB",KEY2
          MOVE      "106",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "OL",KEY2
          MOVE      "107",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "OZ",KEY2
          MOVE      "108",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "CI",KEY2
          MOVE      "110",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "cs",KEY2
          MOVE      "111",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "DX",KEY2
          MOVE      "123",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "GI",KEY2
          MOVE      "124",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "126",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          PACK      KEY13,CCSTSTY,ZERO,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "No",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "126",CCSTSTY
          PACK      KEY13,CCSTSTY,ONE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Yes",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "VA",KEY2
          MOVE      "127",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "VB",KEY2
          MOVE      "128",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "VR",KEY2
          MOVE      "129",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "VI",KEY2
          MOVE      "130",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "VK",KEY2
          MOVE      "131",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "VJ",KEY2
          MOVE      "132",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "133",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          PACK      KEY13,CCSTSTY,ZERO,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "No",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "133",CCSTSTY
          PACK      KEY13,CCSTSTY,ONE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Yes",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "VM",KEY2
          MOVE      "134",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "VN",KEY2
          MOVE      "135",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "KA",KEY2
          MOVE      "136",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "KC",KEY2
          MOVE      "137",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "KD",KEY2
          MOVE      "138",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "KE",KEY2
          MOVE      "139",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "KF",KEY2
          MOVE      "140",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "KG",KEY2
          MOVE      "141",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "KH",KEY2
          MOVE      "142",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "KI",KEY2
          MOVE      "143",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "KJ",KEY2
          MOVE      "144",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "KK",KEY2
          MOVE      "145",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "KL",KEY2
          MOVE      "146",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "KM",KEY2
          MOVE      "147",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "KN",KEY2
          MOVE      "148",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "KO",KEY2
          MOVE      "149",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "KP",KEY2
          MOVE      "150",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "KB",KEY2
          MOVE      "151",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          CALL      PATCCL00                * Load Patient CCL values (152)
.
          MOVE      "FS",KEY2
          MOVE      "153",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "LL",KEY2
          MOVE      "154",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "CG",KEY2
          MOVE      "156",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "em",KEY2
          MOVE      "157",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "ea",KEY2
          MOVE      "158",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "el",KEY2
          MOVE      "159",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      "et",KEY2
          MOVE      "160",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          BEEP
          MOVE      "Extract Complete - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PROC9999
.
PROC9900  BEEP
          MOVE      "Unable to Open Codes File. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PROC9999
.
PROC9999  RETURN
.
PCODE000  PACK      KEY5,KEY2,SP3
          CALL      RDSCODE1                                           * V90200
PCODE100  CALL      RDKCODE1                                           * V90200
          BRANCH    OVRCD,PCODE900
          MATCH     KEY2,TCODE                                         * V90200
          GOTO      PCODE900 IF NOT EQUAL
          PACK      KEY13,CCSTSTY,ACODE,SP70                           * V90200
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=0
            MOVE      TDESC,CCXHDES                                    * V90200
            CALL      UPCCXH1
          ELSE
            MOVE      TDESC,CCXHDES                                    * V90200
            CALL      WRCCXH1
          ENDIF
          GOTO      PCODE100
.
PCODE900  RETURN
.
WEKDAY00  MOVE      "056",CCSTSTY
          PACK      KEY13,CCSTSTY,ONE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Monday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "056",CCSTSTY
          PACK      KEY13,CCSTSTY,TWO,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Tuesday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "056",CCSTSTY
          PACK      KEY13,CCSTSTY,THREE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Wednesday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "056",CCSTSTY
          PACK      KEY13,CCSTSTY,FOUR,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Thursday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "056",CCSTSTY
          PACK      KEY13,CCSTSTY,FIVE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Friday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "056",CCSTSTY
          PACK      KEY13,CCSTSTY,SIX,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Saturday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "056",CCSTSTY
          PACK      KEY13,CCSTSTY,SEVEN,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Sunday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "057",CCSTSTY
          PACK      KEY13,CCSTSTY,ONE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Monday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "057",CCSTSTY
          PACK      KEY13,CCSTSTY,TWO,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Tuesday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "057",CCSTSTY
          PACK      KEY13,CCSTSTY,THREE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Wednesday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "057",CCSTSTY
          PACK      KEY13,CCSTSTY,FOUR,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Thursday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "057",CCSTSTY
          PACK      KEY13,CCSTSTY,FIVE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Friday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "057",CCSTSTY
          PACK      KEY13,CCSTSTY,SIX,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Saturday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "057",CCSTSTY
          PACK      KEY13,CCSTSTY,SEVEN,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Sunday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "096",CCSTSTY
          PACK      KEY13,CCSTSTY,ONE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Monday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "096",CCSTSTY
          PACK      KEY13,CCSTSTY,TWO,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Tuesday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "096",CCSTSTY
          PACK      KEY13,CCSTSTY,THREE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Wednesday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "096",CCSTSTY
          PACK      KEY13,CCSTSTY,FOUR,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Thursday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "096",CCSTSTY
          PACK      KEY13,CCSTSTY,FIVE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Friday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "096",CCSTSTY
          PACK      KEY13,CCSTSTY,SIX,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Saturday",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "096",CCSTSTY
          PACK      KEY13,CCSTSTY,SEVEN,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Sunday",CCXHDES
            CALL      WRCCXH1
          ENDIF
          RETURN
.-----------------------------------------------------------------------------
.   Load Patient CC Class Level (CCL) codes
.-----------------------------------------------------------------------------
PATCCL00  MOVE      "152",CCSTSTY
          PACK      KEY13,CCSTSTY,ZERO,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Zero",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "152",CCSTSTY
          PACK      KEY13,CCSTSTY,ONE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "One",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "152",CCSTSTY
          PACK      KEY13,CCSTSTY,TWO,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Two",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "152",CCSTSTY
          PACK      KEY13,CCSTSTY,THREE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Three",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "152",CCSTSTY
          PACK      KEY13,CCSTSTY,FOUR,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Four",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          RETURN
.
VISTYP00  MOVE      "027",CCSTSTY
          PACK      KEY13,CCSTSTY,ONE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Emergency",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          PACK      KEY13,CCSTSTY,TWO,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Outpatient",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          PACK      KEY13,CCSTSTY,THREE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Inpatient",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          PACK      KEY13,CCSTSTY,TEN,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Allied Health",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          RETURN
.------------------------------------------------------------
. PDOCess IBA Extract
.------------------------------------------------------------
PDOC0000  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      PATDO1A1,"patdo1af"                                * V90200
          TRAPCLR   IO
          BRANCH    OVRCD,PDOC9900
.
          DISPLAY   *P1:24,*EL,"Extracting Doctor Codes : "
          PACK      KEY6,SP70
          CALL      RDSDOCT1                                           * V90200
PDOC1000  CALL      RDKDOCT1                                           * V90200
          BRANCH    OVRCD,PDOC5000
          DISPLAY   *P27:24,*V2LON,DCODE                               * V90200
          MOVE      "016",CCSTSTY
          CALL      UPDOC000
.
          MOVE      "017",CCSTSTY
          CALL      UPDOC000
.
          MOVE      "018",CCSTSTY
          CALL      UPDOC000
.
          MOVE      "019",CCSTSTY
          CALL      UPDOC000
.
          GOTO      PDOC1000
.
.         Load HCP Codes
PDOC5000  DISPLAY   *P1:24,*EL,"Extracting HCP Codes : "
          PACK      KEY10,SP70
          CALL      RSPMHCP1
PDOC6000  CALL      RKPMHCP1
          BRANCH    OVRCD,PDOC9000
.
          MOVE      "113",CCSTSTY
          CALL      UPHCP000
.
          MOVE      "121",CCSTSTY
          CALL      UPHCP000
.
          MOVE      "161",CCSTSTY
          CALL      UPHCP000
.
          GOTO      PDOC6000                * Get next record
.
PDOC9000  BEEP
          MOVE      "Extract Complete - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PDOC9999
.
PDOC9900  BEEP
          MOVE      "Unable to Open Doctors File. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PDOC9999
.
PDOC9999  RETURN
.
UPDOC000  PACK      KEY13,CCSTSTY,DCODE,SP70                           * V90200
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=0
            STRIP     DTITL                                            * V90200
            MOVE      DGNAME,ANS                                       * V90200
            MOVE      ".",KEY1
            PACK      CCXHDES,DTITL,SP1,ANS,KEY1,DSNAME                * V90200
            CALL      UPCCXH1
          ELSE
            STRIP     DTITL                                            * V90200
            MOVE      DGNAME,ANS                                       * V90200
            MOVE      ".",KEY1
            PACK      CCXHDES,DTITL,SP1,ANS,KEY1,DSNAME                * V90200
            CALL      WRCCXH1
          ENDIF
          RETURN
.
UPHCP000  PACK      KEY13,CCSTSTY,PMHCHCPC,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
.
          STRIP     PMHCTITL
          MOVE      PMHCGNAM,ANS
          MOVE      ".",KEY1
          PACK      CCXHDES,PMHCTITL,SP1,ANS,KEY1,PMHCSNAM
.
          IF        OVRCD=0
            CALL      UPCCXH1
          ELSE
            MOVE      SP70,CCXHSUM
            CALL      WRCCXH1
          ENDIF
          RETURN
.------------------------------------------------------------
. Ward IBA Extract
.------------------------------------------------------------
PWAR0000  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      PATWR1A3,"patwr1af"                                * V90200
          TRAPCLR   IO
          BRANCH    OVRCD,PWAR9900
.
          DISPLAY   *P1:24,*EL,"Extracting Ward Names : "
          PACK      KEY6,SP70
          CALL      RDSWARD3                                           * V90200
PWAR1000  CALL      RDKWARD3                                           * V90200
          BRANCH    OVRCD,PWAR9000
          MATCH     SP70,WBED                                          * V90200
          GOTO      PWAR9000 IF NOT EQUAL
          DISPLAY   *P27:24,*V2LON,WWARD                               * V90200
          MOVE      "003",CCSTSTY
          CALL      UPWAR000
.
          MOVE      "009",CCSTSTY
          CALL      UPWAR000
.
          GOTO      PWAR1000
.
PWAR9000  BEEP
          MOVE      "Extract Complete - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PWAR9999
.
PWAR9900  BEEP
          MOVE      "Unable to Open Ward File. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PWAR9999
.
PWAR9999  RETURN
.
UPWAR000  PACK      KEY13,CCSTSTY,WWARD,SP70                           * V90200
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=0
            PACK      CCXHDES,WBDESC,SP70                              * V90200
            CALL      UPCCXH1
          ELSE
            PACK      CCXHDES,WBDESC,SP70                              * V90200
            CALL      WRCCXH1
          ENDIF
          RETURN
.------------------------------------------------------------
. IBA Extract
.------------------------------------------------------------
PICD0000  CALL      OPICD1
          DISPLAY   *P1:24,*EL,"Extracting ICD Diagnosis Headers : "
          MOVE      ZERO,SECTOR
          PACK      KEY9,SP70
          CALL      RSPTICD1
PICD1000  CALL      RKPTICD1
          BRANCH    OVRCD,PICD1900
          ADD       ONE,SECTOR
          IF        (SECTOR%100=0)
            DISPLAY   *P40:24,*V2LON,SECTOR
          ENDIF
          MATCH     "H",DFLAG
          GOTO      PICD1000 IF NOT EQUAL
.
          MOVE      "028",CCSTSTY
          CALL      UPICD000
.
          MOVE      "029",CCSTSTY
          CALL      UPICD000
.
          GOTO      PICD1000
.
PICD1900  CALL      OPICO1
          DISPLAY   *P1:24,*EL,"Extracting ICD Operation Headers : "
          MOVE      ZERO,SECTOR
          PACK      KEY9,SP70
          CALL      RSPTICO1
PICD2000  CALL      RKPTICO1
          BRANCH    OVRCD,PICD2900
          ADD       ONE,SECTOR
          IF        (SECTOR%100=0)
            DISPLAY   *P40:24,*V2LON,SECTOR
          ENDIF
.
          MATCH     "H",OFLAG
          GOTO      PICD2000 IF NOT EQUAL
.
          MOVE      "030",CCSTSTY
          CALL      UPICO000
.
          MOVE      "031",CCSTSTY
          CALL      UPICO000
.
          GOTO      PICD2000
.
PICD2900  BEEP
          MOVE      "Extract Complete - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PICD9999
.
PICD9910  BEEP
          MOVE      "Unable to Open ICD Diagnosis File. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PICD9999
.
PICD9920  BEEP
          MOVE      "Unable to Open ICD Operation File. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PICD9999
.
PICD9999  RETURN
.
UPICD000  PACK      KEY13,CCSTSTY,DPCODE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=0
            SQUEEZE   DPCODE
            PACK      CCXHDES,DPCODE,SP1,DDESC,SP70
            CALL      UPCCXH1
          ELSE
            SQUEEZE   DPCODE
            PACK      CCXHDES,DPCODE,SP1,DDESC,SP70
            CALL      WRCCXH1
          ENDIF
          RETURN
.
UPICO000  PACK      KEY13,CCSTSTY,OPCODE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=0
            SQUEEZE   OPCODE
            PACK      CCXHDES,OPCODE,SP1,ODESC,SP70
            CALL      UPCCXH1
          ELSE
            SQUEEZE   OPCODE
            PACK      CCXHDES,OPCODE,SP1,ODESC,SP70
            CALL      WRCCXH1
          ENDIF
          RETURN
.------------------------------------------------------------
. IBA Extract All ICD Codes to Xref File
.------------------------------------------------------------
AICD0000  CALL      OPICD1
          DISPLAY   *P1:24,*EL,"Extracting ICD Diagnosis Codes   : "
          MOVE      ZERO,SECTOR
          PACK      KEY9,SP70
          CALL      RSPTICD1
AICD1000  CALL      RKPTICD1
          BRANCH    OVRCD,AICD1900
          ADD       ONE,SECTOR
          IF        SECTOR%100=0
            DISPLAY   *P40:24,*V2LON,SECTOR
          ENDIF
.
          MATCH     "H",DFLAG
          GOTO      AICD1100 IF EQUAL
.
          MOVE      "023",CCSTSTY
          CALL      UPICD000
          MOVE      "024",CCSTSTY
          CALL      UPICD000
          GOTO      AICD1000
.
AICD1100  MOVE      "028",CCSTSTY
          CALL      UPICD000
          MOVE      "029",CCSTSTY
          CALL      UPICD000
          GOTO      AICD1000
.
AICD1900  CALL      OPICO1
          DISPLAY   *P1:24,*EL,"Extracting ICD Operation Codes   : "
          MOVE      ZERO,SECTOR
          PACK      KEY9,SP70
          CALL      RSPTICO1
AICD2000  CALL      RKPTICO1
          BRANCH    OVRCD,AICD2900
          ADD       ONE,SECTOR
          IF        SECTOR%100=0
            DISPLAY   *P40:24,*V2LON,SECTOR
          ENDIF
.
          MATCH     "H",OFLAG
          GOTO      AICD2100 IF EQUAL
.
          MOVE      "025",CCSTSTY
          CALL      UPICO000
          MOVE      "026",CCSTSTY
          CALL      UPICO000
          GOTO      AICD2000
.
AICD2100  MOVE      "030",CCSTSTY
          CALL      UPICO000
          MOVE      "031",CCSTSTY
          CALL      UPICO000
          GOTO      AICD2000
.
AICD2900  BEEP
          MOVE      "Extract Complete - ",DISPMSG
          CALL      MESSAGE1
          GOTO      AICD9999
.
AICD9910  BEEP
          MOVE      "Unable to Open ICD Diagnosis File. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      AICD9999
.
AICD9920  BEEP
          MOVE      "Unable to Open ICD Operation File. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      AICD9999
.
AICD9999  RETURN
.
.------------------------------------------------------------
. IBA Extract
.------------------------------------------------------------
PMBS0000  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      PATITEM1,"patitemn"                                * V90200
          TRAPCLR   IO
          BRANCH    OVRCD,PMBS9910
.
          DISPLAY   *P1:24,*EL,"Extracting MBS Codes             : "
          MOVE      ZERO,SECTOR
          PACK      KEY9,SP70
          CALL      RDSITEM1                                           * V90200
PMBS1000  CALL      RDKITEM1                                           * V90200
          BRANCH    OVRCD,PMBS1900
          ADD       ONE,SECTOR
          IF        (SECTOR%100=0)
            DISPLAY   *P40:24,*V2LON,SECTOR
          ENDIF
.
          MOVE      "006",CCSTSTY
          CALL      UPMBS000
.
          MOVE      "013",CCSTSTY
          CALL      UPMBS000
.
          MOVE      "045",CCSTSTY
          CALL      UPMBS000
.
          MOVE      "046",CCSTSTY
          CALL      UPMBS000
.
          GOTO      PMBS1000
.
PMBS1900  BEEP
          MOVE      "Extract Complete - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PMBS9999
.
PMBS9910  BEEP
          MOVE      "Unable to Open MBS Item File. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PMBS9999
.
PMBS9999  RETURN
.
UPMBS000  PACK      KEY13,CCSTSTY,ITEMNO,SP70                          * V90200
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=0
            SQUEEZE   ITEMNO                                           * V90200
            PACK      CCXHDES,ITEMNO,SP1,IDESC,SP70                    * V90200
            CALL      UPCCXH1
          ELSE
            SQUEEZE   ITEMNO                                           * V90200
            PACK      CCXHDES,ITEMNO,SP1,IDESC,SP70                    * V90200
            CALL      WRCCXH1
          ENDIF
          RETURN
.
.------------------------------------------------------------
. IBA Extract
.------------------------------------------------------------
PFUN0000  OPEN      PATFN1A1,"patfn1af"                                * V90200
          DISPLAY   *P1:24,*EL,"Extracting Health Fund Tables    : "
          MOVE      ZERO,SECTOR
          PACK      KEY14,SP70
          CALL      RDSFUND1                                           * V90200
PFUN1000  CALL      RDKFUND1                                           * V90200
          BRANCH    OVRCD,PFUN1900
          ADD       ONE,SECTOR
          IF        (SECTOR%100=0)
            DISPLAY   *P40:24,*V2LON,SECTOR
          ENDIF
.
          MATCH     "0000",HFTABL                                      * V90200
          IF        @EQUAL
            CALL      UPFUN000
          ELSE
            CALL      UPTAB000
          ENDIF
.
          GOTO      PFUN1000
.
PFUN1900  BEEP
          MOVE      "Extract Complete - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PFUN9999
.
PFUN9910  BEEP
          MOVE      "Unable to Open Health Fund File. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PFUN9999
.
PFUN9999  RETURN
.
UPFUN000  MOVE      "020",CCSTSTY
          PACK      KEY13,CCSTSTY,HCODE,SP70                           * V90200
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=0
            PACK      CCXHDES,HFNAME,SP70                              * V90200
            CALL      UPCCXH1
          ELSE
            PACK      CCXHDES,HFNAME,SP70                              * V90200
            CALL      WRCCXH1
          ENDIF
          RETURN
.
UPTAB000  MOVE      "021",CCSTSTY
          PACK      KEY13,CCSTSTY,HFTABL,SP70                          * V90200
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=0
            PACK      CCXHDES,HFNAME,SP70                              * V90200
            CALL      UPCCXH1
          ELSE
            PACK      CCXHDES,HFNAME,SP70                              * V90200
            CALL      WRCCXH1
          ENDIF
          RETURN
.
.------------------------------------------------------------
. Process Clinic & Op Room Details IBA Extract
.------------------------------------------------------------
PCLI0000  CALL      OPNOPR00
          DISPLAY   *P1:24,*EL,"Extracting Theatre Codes : "
.
          BRANCH    OPROPROP,PCLI9900
          PACK      KEY6,SP70
          CALL      RSOPOPR1
PCLI1000  CALL      RKOPOPR1
          BRANCH    OVRCD,PCLI2000
          DISPLAY   *P27:24,*V2LON,OPRMROOM
          MOVE      "069",CCSTSTY
          PACK      KEY13,CCSTSTY,OPRMROOM,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=0
            MOVE      OPRMDESC,CCXHDES
            CALL      UPCCXH1
          ELSE
            MOVE      OPRMDESC,CCXHDES
            CALL      WRCCXH1
          ENDIF
          GOTO      PCLI1000
.
.
PCLI2000  BRANCH    OPCNCLSU,PCLI4000
.
. Using Clinic Details
.
          BRANCH    OPRCLIOP,PCLI9900
          PACK      KEY6,SP70
          CALL      RSOPCLI1
PCLI3000  CALL      RKOPCLI1
          BRANCH    OVRCD,PCLI9000
          DISPLAY   *P27:24,*V2LON,OPCLCLIN
          MOVE      "060",CCSTSTY
          PACK      KEY13,CCSTSTY,OPCLCLIN,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=0
            MOVE      OPCLDESC,CCXHDES
            CALL      UPCCXH1
          ELSE
            MOVE      OPCLDESC,CCXHDES
            CALL      WRCCXH1
          ENDIF
          GOTO      PCLI3000
.
. Using Surgeon Details
.
PCLI4000  BRANCH    PATDOCOP,PCLI9900
          PACK      KEY6,SP70
          CALL      RDSDOCT1                                           * V90200
PCLI5000  CALL      RDKDOCT1                                           * V90200
          BRANCH    OVRCD,PCLI9000
          DISPLAY   *P27:24,*V2LON,DCODE                               * V90200
          MOVE      "060",CCSTSTY
          CALL      UPDOC000
          GOTO      PCLI5000
.
PCLI9000  BEEP
          MOVE      "Extract Complete - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PCLI9999
.
PCLI9900  BEEP
          MOVE      "Unable to Open Files. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PCLI9999
.
PCLI9999  RETURN
.------------------------------------------------------------
. Open Files Required for OPR Interface
.------------------------------------------------------------
OPNOPR00  MOVE      "40",AUDTSECT
          READ      CONTROLF,AUDTSECT;*111,OPCNCLSU
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      PATDO1A1,"patdo1af"                                * V90200
          TRAPCLR   IO
          MOVE      OVRCD,PATDOCOP
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      OPRCLIA1,"oprcliaf"
          TRAPCLR   IO
          MOVE      OVRCD,OPRCLIOP
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      OPROPRA1,"opropraf"
          TRAPCLR   IO
          MOVE      OVRCD,OPROPROP
.
OPNOPR99  RETURN
.
.------------------------------------------------------------
. DRG IBA Extract
.------------------------------------------------------------
PDRG0000  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      PATDGWA1,"patdgwaf"
          TRAPCLR   IO
          BRANCH    OVRCD,PDRG9900
.
          READ      CONTROLF,HUND05;*158,PTCNDGPV                     *I-137125
          UNPACK    PTCNDGPV,ANS,KEY1,DIM1
          DISPLAY   *P1:24,*EL,"Extracting DRG Table : ":
                    *P35:24,"using DRG Version ",KEY1,DOT,DIM1
          PACK      KEY3,SP70
          PACK      KEY4,SP70
          PACK      KEY7,SP70                                         *I-137125
          CALL      RSPTDGW1
PDRG1000  CALL      RKPTDGW1
          BRANCH    OVRCD,PDRG9000
.
          MATCH     PTDWDRGV,PTCNDGPV                                 *I-137125
          GOTO      PDRG1000 IF NOT EQUAL                             *I-137125
.
          DISPLAY   *P27:24,*V2LON,PTDWDRGC
.
          MOVE      "001",CCSTSTY
          CALL      UPDRG000
.
          MOVE      "164",CCSTSTY
          CALL      UPDRG000
.
          GOTO      PDRG1000
.
PDRG9000  BEEP
          MOVE      "Extract Complete - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PDRG9999
.
PDRG9900  BEEP
          MOVE      "Unable to Open DRG File. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PDRG9999
.
PDRG9999  RETURN
.
UPDRG000  PACK      KEY13,CCSTSTY,PTDWDRGC,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=0
            PACK      CCXHDES,PTDWDESC,SP70
            CALL      UPCCXH1
          ELSE
            PACK      CCXHDES,PTDWDESC,SP70
            CALL      WRCCXH1
          ENDIF
          PACK      KEY4,PTDWDRGC,SP70
          CALL      RDCCDG1
          IF        OVRCD=0
            PACK      CCDGDES,PTDWDESC,SP70
            CALL      UPCCDG1
          ELSE
            MOVE      PTDWDRGC,CCDGDRGC
            PACK      CCDGDES,PTDWDESC,SP70
            MOVE      PTDWMDCC,CCDGMDC
            MOVE      ZERO,CCDGWAR
            MOVE      "P",CCDGTYP
            MOVE      "N",CCDGSDR
            MOVE      "N",CCDGSDT
            MOVE      PTDWLOWT,CCDGLOW
            MOVE      PTDWHIGH,CCDGHIG
            MOVE      ZERO,CCDGSLOS
            MOVE      PTDWRWGT,CCDGSWGT
            MOVE      ZERO,CCDGNAT
            MOVE      ZERO,CCDGNLOS
            MOVE      SP70,CCDGSPA
            CALL      WRCCDG1
          ENDIF
          RETURN
.------------------------------------------------------------
.------------------------------------------------------------
. IBA Extract
.------------------------------------------------------------
PPST0000  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      IBAPOST1,"ibapostf"
          TRAPCLR   IO
          BRANCH    OVRCD,PPST9910
.
          DISPLAY   *P1:24,*EL,"Extracting Post Codes            : "
          MOVE      ZERO,SECTOR
          PACK      KEY56,SP70
          CALL      RSIBPOS1
PPST1000  CALL      RKIBPOS1
          BRANCH    OVRCD,PPST1900
          ADD       ONE,SECTOR
          IF        (SECTOR%100=0)
            DISPLAY   *P40:24,*V2LON,SECTOR
          ENDIF
.
          MOVE      "054",CCSTSTY
          CALL      UPPST000
.
          GOTO      PPST1000
.
PPST1900  BEEP
          MOVE      "Extract Complete - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PPST9999
.
PPST9910  BEEP
          MOVE      "Unable to Open Post Code File. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PPST9999
.
PPST9999  RETURN
.
UPPST000  PACK      KEY13,CCSTSTY,IBPOPCOD,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=0
            MOVE      IBPOSUBR,KEY30
            STRIP     KEY30
            STRIP     IBPOSTAT
            MOVE      " (",KEY2
            MOVE      ")",KEY1
            PACK      CCXHDES,KEY30,KEY2,IBPOSTAT,KEY1,SP70
            CALL      UPCCXH1
          ELSE
            MOVE      IBPOSUBR,KEY30
            STRIP     KEY30
            STRIP     IBPOSTAT
            MOVE      " (",KEY2
            MOVE      ")",KEY1
            PACK      CCXHDES,KEY30,KEY2,IBPOSTAT,KEY1,SP70
            CALL      WRCCXH1
          ENDIF
          RETURN
.
LOUT0000  CALL      OUTDET00           * Casemix Types "092","093","094"
          CALL      OPSSTA00           * Load Outpatient Slot Status (109)
.
LOUT9999  RETURN
.
.------------------------------------------------------------------------------
. Build codes for the following outpatient Casemix Types:
.       092 - Outpatient Site
.       093 - Outpatient Clinic
.       094 - Outpatient Clinic Type
.------------------------------------------------------------------------------
OUTDET00  MOVE      SP70,CFILEPRE           * Initialize file prefix
          MOVE      ZERO,PRFXDONE           * This site prefix done = No
          PACK      KEY9,SP70
          CALL      RDSSITA3
OUTDET10  CALL      RDKSITA3
          BRANCH    OVRCD,OUTDET99
.
          MOVE      "092",CCSTSTY           * Store Site Code
          PACK      KEY13,CCSTSTY,OSTSITE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      OSTDESC,CCXHDES
            MOVE      SP70,CCXHSUM
            CALL      WRCCXH1
          ENDIF
.
          MATCH     OSTFILE,CFILEPRE        * Same as Current File Prefix
          IF        !@EQUAL
            MOVE      OSTFILE,CFILEPRE      * Save Current File Prefix
            CALL      OPNOUT00              * Open Files
            MOVE      ZERO,PRFXDONE         * This site prefix done = No
          ENDIF
.
          BRANCH    PRFXDONE,OUTDET10       * Skip if this site prefix is done
.
          MOVE     ONE,PRFXDONE             * Set this prefix processed to yes
          PACK     KEY42,SP70
          CALL     RDSCTYA2
OUTDET30  CALL     RDKCTYA2
          BRANCH   OVRCD,OUTDET50
.
          MOVE      "094",CCSTSTY           * Store Clinic Type
          PACK      KEY13,CCSTSTY,OCTCTYP,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      OCTDESC,CCXHDES
            MOVE      SP70,CCXHSUM
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "022",CCSTSTY           * Store Clinic Type
          PACK      KEY13,CCSTSTY,OCTCTYP,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      OCTDESC,CCXHDES
            MOVE      SP70,CCXHSUM
            CALL      WRCCXH1
          ENDIF
.
          GOTO     OUTDET30   * Next
.
OUTDET50  PACK     KEY20,Z70
          CALL     RDSCLIA1
OUTDET60  CALL     RDPCLIA1
          BRANCH   OVRCD,OUTDET10
.
          MOVE      "093",CCSTSTY           * Store Clinic ID
          PACK      KEY13,CCSTSTY,OCACLIN,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      OCADESC,CCXHDES
            MOVE      SP70,CCXHSUM
            CALL      WRCCXH1
          ENDIF
.
          GOTO     OUTDET60   * Next
.
OUTDET99  RETURN
..------------------------------------------------------------
. Open Outpatient Files
.------------------------------------------------------------
OPNOUT00  PACK      CFNAME,CFILEPRE,FILCLIA1  * Get the name of the CLIA1 file
          CLOSE     OUTCLIA1
          OPEN      OUTCLIA1,CFNAME           * Open the file
.
          PACK      CFNAME,CFILEPRE,FILCTYA2  * Get the name of the CTYA2 file
          CLOSE     OUTCTYA2
          OPEN      OUTCTYA2,CFNAME           * Open the file
.
OPNOUT99  RETURN
.
.------------------------------------------------------------------------------
.    Load Outpatient Slot Status
.------------------------------------------------------------------------------
OPSSTA00  MOVE      "109",CCSTSTY
          PACK      KEY13,CCSTSTY,ZERO,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Not Booked",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "109",CCSTSTY
          PACK      KEY13,CCSTSTY,ONE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Booked",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "109",CCSTSTY
          PACK      KEY13,CCSTSTY,TWO,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Not Used",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "109",CCSTSTY
          PACK      KEY13,CCSTSTY,THREE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Extended Slot",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "109",CCSTSTY
          PACK      KEY13,CCSTSTY,FOUR,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Attended",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "109",CCSTSTY
          PACK      KEY13,CCSTSTY,FIVE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "No Attendance",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "109",CCSTSTY
          PACK      KEY13,CCSTSTY,SIX,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Suspended",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "109",CCSTSTY
          PACK      KEY13,CCSTSTY,SEVEN,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Unavailable",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "109",CCSTSTY
          PACK      KEY13,CCSTSTY,NINE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Reserved",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          RETURN
.
.------------------------------------------------------------------------------
. Build Casemix Codes for various Allied Health Casemix Types
.------------------------------------------------------------------------------
LALH0000  CALL      ALRSTA00           * Load Allied Health Referral Stat (112)
          CALL      ENCNUM00           * Generate A/H Encounter Numbers (120)
          CALL      ALHDET00           * Casemix Types 122 and 155
.
          MOVE      "114",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Problem Codes : ",CCSTSTY
          CALL       PROB0000
.
          MOVE      "115",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Problem Codes : ",CCSTSTY
          CALL       PROB0000
.
          MOVE      "116",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Problem Codes : ",CCSTSTY
          CALL       PROB0000
.
          MOVE      "117",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Diagnosis Codes : ",CCSTSTY
          CALL       DIAG0000
.
          MOVE      "118",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Diagnosis Codes : ",CCSTSTY
          CALL       DIAG0000
.
          MOVE      "119",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Diagnosis Codes : ",CCSTSTY
          CALL       DIAG0000
.
          MOVE      "125",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Service Codes : ",CCSTSTY
          CALL       SERV0000
.
LALH9999  RETURN
.
.------------------------------------------------------------------------------
.    Load Allied Health Referral Status
.------------------------------------------------------------------------------
ALRSTA00  MOVE      "112",CCSTSTY
          PACK      KEY13,CCSTSTY,ZERO,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "On Waiting List",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "112",CCSTSTY
          PACK      KEY13,CCSTSTY,ONE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Active",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "112",CCSTSTY
          PACK      KEY13,CCSTSTY,TWO,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Closed",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "112",CCSTSTY
          PACK      KEY13,CCSTSTY,THREE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Inactive",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          MOVE      "112",CCSTSTY
          PACK      KEY13,CCSTSTY,FOUR,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      "Cancelled",CCXHDES
            CALL      WRCCXH1
          ENDIF
.
          RETURN
.
.------------------------------------------------------------------------------
.    Generate Allied Helath Encounter Numbers (1 - 998)
.------------------------------------------------------------------------------
ENCNUM00  MOVE      "120",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          MOVE      ONE,F3
ENCNUM10  MOVE      F3,KEY3
          REP       " 0",KEY3
          PACK      KEY13,CCSTSTY,KEY3,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            CLEAR     CCXHDES
            APPEND    "Enc Num : ",CCXHDES
            APPEND    F3,CCXHDES
            RESET     CCXHDES
            CALL      WRCCXH1
          ENDIF
          ADD       ONE,F3
          COMPARE   "999",F3
          GOTO      ENCNUM10 IF NOT EQUAL
.
          RETURN
.
PROB0000  PACK      KEY12,SP70
          CALL      RSALPRR1
PROB1000  CALL      RKALPRR1
          BRANCH    OVRCD,PROB9999
.
          MOVE      CCSTSTY,CCXHSTY
          MOVE      ALPRPROB,CCXHKEY
.
          PACK      KEY13,CCXHSTY,CCXHKEY,SP70
          CALL      RDCCXH1
          IF        OVRCD=0
            MOVE      ALPRDESC,CCXHDES
            CALL      UPCCXH1
          ELSE
            MOVE      ALPRDESC,CCXHDES
            MOVE      SP70,CCXHSUM
            CALL      WRCCXH1
          ENDIF
.
          GOTO      PROB1000
.
PROB9999  RETURN
.
.
DIAG0000  PACK      KEY12,SP70
          CALL      RSALDIA1
DIAG1000  CALL      RKALDIA1
          BRANCH    OVRCD,DIAG9999
.
          MOVE      CCSTSTY,CCXHSTY
          MOVE      ALDIDIAG,CCXHKEY
.
          PACK      KEY13,CCXHSTY,CCXHKEY,SP70
          CALL      RDCCXH1
          IF        OVRCD=0
            MOVE      ALDIDESC,CCXHDES
            CALL      UPCCXH1
          ELSE
            MOVE      ALDIDESC,CCXHDES
            MOVE      SP70,CCXHSUM
            CALL      WRCCXH1
          ENDIF
.
          GOTO      DIAG1000
.
DIAG9999  RETURN
.
SERV0000  PACK      KEY9,SP70
          CALL      RSALSER1
SERV1000  CALL      RKALSER1
          BRANCH    OVRCD,SERV9999
.
          MOVE      CCSTSTY,CCXHSTY
          MOVE      ALSRSERV,CCXHKEY
.
          PACK      KEY13,CCXHSTY,CCXHKEY,SP70
          CALL      RDCCXH1
          IF        OVRCD=0
            MOVE      ALSRDESC,CCXHDES
            CALL      UPCCXH1
          ELSE
            MOVE      ALSRDESC,CCXHDES
            MOVE      SP70,CCXHSUM
            CALL      WRCCXH1
          ENDIF
.
          GOTO      SERV1000
.
SERV9999  RETURN
.
ALHDET00  MOVE      "S ",KEY2
          MOVE      "155",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
          MOVE      SP70,CFILEPRE           * Initialize file prefix
          MOVE      ZERO,PRFXDONE           * This site prefix done = No
          PACK      KEY9,SP70
          CALL      RDSSITA3
ALHDET10  CALL      RDKSITA3
          BRANCH    OVRCD,ALHDET99
.
          MATCH     SP70,OSTCATG
          GOTO      ALHDET20 IF EQUAL
.
          MOVE      OSTCATG,KEY2
          MOVE      "155",CCSTSTY
          DISPLAY   *P1:24,*EL,"Extracting Casemix Type : ",CCSTSTY
          CALL      PCODE000
.
ALHDET20  MATCH     OSTFILE,CFILEPRE        * Same as Current File Prefix
          IF        !@EQUAL
            MOVE      OSTFILE,CFILEPRE      * Save Current File Prefix
            CALL      OPNOUT00              * Open Files
            MOVE      ZERO,PRFXDONE         * This site prefix done = No
          ENDIF
.
          BRANCH    PRFXDONE,ALHDET10       * Skip if this site prefix is done
.
          MOVE     ONE,PRFXDONE             * Set this prefix processed to yes
          PACK     KEY42,SP70
          CALL     RDSCTYA2
ALHDET30  CALL     RDKCTYA2
          BRANCH   OVRCD,ALHDET10
.
          MOVE      "122",CCSTSTY           * Store A/H Clinic Type
          PACK      KEY13,CCSTSTY,OCTCTYP,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      OCTDESC,CCXHDES
            MOVE      SP70,CCXHSUM
            CALL      WRCCXH1
          ENDIF
.
          GOTO     ALHDET30   * Next
.
ALHDET99  RETURN
.------------------------------------------------------------
. IBA Transfer Codes Extract
.------------------------------------------------------------
PVAD0000  MOVE      ZERO,OVRCD
          OPEN      PATVADA1,"patvadaf"
          TRAPCLR   IO
          BRANCH    OVRCD,PVAD9900
.
          DISPLAY   *P1:24,*EL,"Extracting Transfer Codes : "
          PACK      KEY5,SP70
          CALL      RSPTVAD1
PVAD1000  CALL      RKPTVAD1
          BRANCH    OVRCD,PVAD9000
.
          DISPLAY   *P27:24,*V2LON,PTVACODE
.
          MOVE      "162",CCSTSTY
          CALL      UPVAD000
.
          MOVE      "163",CCSTSTY
          CALL      UPVAD000
.
          GOTO      PVAD1000
.
PVAD9000  BEEP
          MOVE      "Extract Complete - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PVAD9999
.
PVAD9900  BEEP
          MOVE      "Unable to Open Transfer Codes File. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      PVAD9999
.
PVAD9999  RETURN
.
UPVAD000  PACK      KEY13,CCSTSTY,PTVACODE,SP70
          UNPACK    KEY13,CCXHSTY,CCXHKEY
          CALL      RDCCXH1
          IF        OVRCD=0
            PACK      CCXHDES,PTVADESC,SP70
            CALL      UPCCXH1
          ELSE
            PACK      CCXHDES,PTVADESC,SP70
            CALL      WRCCXH1
          ENDIF
          RETURN
ETYPE000  MATCH    SP70,SAVETYPE
          GOTO     ETYPE500 IF NOT EQUAL
.
ETYPE100  MOVE     ZERO,CKEYTYP
          CALL     KCCSTA00
          BRANCH   EXIT,ETYPE999,ETYPE999
          MOVE     CCSTSTY,CCXHSTY
          MOVE     CCSTSTY,SAVETYPE
          MOVE     CCSTSTY,CMIXSTY
          GOTO     ETYPE999
.
ETYPE500  MOVE     SAVETYPE,KEY3
          CALL     RDCCST1
          BRANCH   OVRCD,ETYPE100
          MOVE     CCSTSTY,CCXHSTY
          MOVE     CCSTSTY,CMIXSTY
.
ETYPE999  RETURN

.---------------------------------------------------------------------------
. Enter Casemix Code
.-------------------------------------------------------------------------------
ECODE000  TOPIC     "CCXHKEY "
          MOVE      CMIXSTY,CCXHSTY
          SFORMAT   VAR,CCSTLEN
          MATCH     "1",CCSTJR
          IF        @EQUAL
            KEYIN     *PCCOL:CVERT,*V2LON,*JR,VAR
          ELSE
            KEYIN     *PCCOL:CVERT,*V2LON,VAR
          ENDIF
.
          MATCH     "1",CCSTZF
          IF        @EQUAL
            REP       " 0",VAR
          ENDIF
.
          DISPLAY     *PCCOL:CVERT,*V2LON,VAR
.
          ENDSET    VAR
          APPEND    SP70,VAR
          RESET     VAR
.
          MATCH     SP70,VAR
          GOTO      ECODE090 IF EQUAL
.
          MATCH     "1",CCSTJR
          IF        @EQUAL
            ENDSET    VAR
          ENDIF
          CMATCH    EXITCHAR,VAR
          GOTO      ECODE095 IF EQUAL
.
          CMATCH    QUEST,VAR
          GOTO      ECODE010 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCXHA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCXHKEY
          APPEND    SP70,CCXHKEY
          RESET     CCXHKEY
.
          MATCH     SP70,CCXHKEY
          GOTO      ECODE000 IF EQUAL
          MOVE      CCXHKEY,VAR
.
          DISPLAY   *PCCOL:CVERT,*V2LON,VAR
ECODE010
          RESET     VAR
          MATCH     "1",CCSTDE
          IF        @EQUAL
            TYPE      VAR
            GOTO      ECODE015 IF EQUAL
            BEEP
            GOTO      ECODE000
          ENDIF
ECODE015
          MOVE      VAR,CCXHKEY
          MOVE      CCXHKEY,CMIXKEY
          PACK      KEY13,CCXHSTY,VAR
          CALL      RACCXH1
          BRANCH    OVRCD,ECODE080
          BRANCH    CKEYTYP,ECODE075
          CALL      RDCCXH1
          MOVE      CCXHSTY,CMIXSTY
          MOVE      CCXHKEY,CMIXKEY
          MOVE      CCXHDES,CMIXDES
          MOVE      CCXHSUM,CMIXSUM
.
          MOVE      CMIXSTY,F3
          ADD       "200",F3
          MOVE      F3,KEY3
          REP       " 0",KEY3
          PACK      KEY13,KEY3,CCXHSUM
          CALL      RDCCXH1
          IF        OVRCD=0
            MOVE      CCXHDES,SUMDES
          ELSE
            MOVE      SP70,SUMDES
          ENDIF
          PACK      KEY13,CMIXSTY,CMIXKEY
          CALL      RDCCXH1
.
ECODE070
          MOVE      ZERO,EXIT
          GOTO      ECODE099
ECODE075
          MOVE      "Code Already Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      ECODE000
ECODE080
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,ECODE099,ECODE099
          MOVE      "Code Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      ECODE000
ECODE085
          MOVE      SP70,CCXHKEY
          MOVE      SP70,CMIXKEY
          MOVE      ZERO,EXIT
          GOTO      ECODE099
ECODE090  MOVE      SP70,SAVETYPE
          MOVE      ONE,EXIT
          GOTO      ECODE099
ECODE095
          MOVE      TWO,EXIT
ECODE099  SFORMAT   VAR,127
          TOPIC     PRGID
          RETURN
.----------------------------------------------------------------------
. Enter Casemix Summary Codes
.----------------------------------------------------------------------
ESUMM000  MOVE    ZERO,CKEYTYP
          MOVE    CMIXSTY,F3
          IF      F3>200
            GOTO    ESUMM900
          ENDIF
.
          ADD     "200",F3
          MOVE    F3,CCXHSTY
          REP     " 0",CCXHSTY
          CALL    KCCXHA00
          BRANCH  EXIT,ESUMM900,ESUMM999
          MOVE    CCXHKEY,CMIXSUM
          MOVE    CCXHDES,SUMDES
          GOTO    ESUMM999
.
ESUMM900  MOVE    SP70,SUMDES
          MOVE    SP70,CMIXSUM
ESUMM999  RETURN
.
.------------------------------------
. Save Casemix Code Details
.------------------------------------
POST0000  MOVE      CMIXSTY,CCXHSTY
          MOVE      CMIXKEY,CCXHKEY
          MOVE      CMIXDES,CCXHDES
          MOVE      CMIXSUM,CCXHSUM
          MOVE      SP70,CCXHSPA
          PACK      KEY13,CCXHSTY,CCXHKEY
          CALL      RACCXH1
          IF        OVRCD=0
            CALL      UPCCXH1
          ELSE
            CALL      WRCCXH1
          ENDIF
.
          RETURN
.------------------------------------
. Save Summary File Details
.------------------------------------
DELT0000  PACK      KEY13,CMIXSTY,CMIXKEY
          CALL      RACCXH1
          IF        OVRCD=0
            CALL      DECCXH1
          ENDIF
          RETURN
.------------------------------------
. Update Summary Type
.------------------------------------
WCCST000  PACK      KEY3,CCSTSTY
          CALL      RACCST1
          IF        OVRCD=0
            CALL      UPCCST1
          ENDIF
          RETURN
DELA0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DELA1000,DELA9000,DELA9100
.
DELA1000  PACK     KEY13,CCSTSTY,SP70
          CALL     RACCXH1
          CALL     RKCCXH1
          BRANCH   OVRCD,DELA1900
          MATCH    CCXHSTY,CCSTSTY
          GOTO     DELA1900 IF EQUAL
          PACK     KEY13,CCXHSTY,CCXHKEY
          CALL     DECCXH1             * Delete Record
          GOTO     DELA1000
.
DELA1900  MOVE     TWO,EXIT            * Restart Screen
          GOTO     DELA9999
.
DELA9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DELA9999
.
DELA9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DELA9999
.
DELA9999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       ALLDIAIO/INC
          INC       ALLPRRIO/INC
          INC       ALLSERIO/INC
          INC       CCSDRGIO/INC
          INC       CCSHLCIO/INC
          INC       CCSSTYIO/INC
          INC       CCSSTYKY    
          INC       CCSXHDIO/INC
          INC       CCSXHDKY    
          INC       IBAPOSIO/INC
          INC       OPRCLIIO/INC
          INC       OPROPRIO/INC
          INC       OUTCLIIO/INC
          INC       OUTCTYIO/INC
          INC       OUTSITIO/INC
          INC       PATCODIO/INC
          INC       PATDGWIO/INC
          INC       PATDO1IO/INC
          INC       PATFN1IO/INC
          INC       PATICDIO/INC
          INC       PATICOIO/INC
          INC       PATITMIO/INC
          INC       PATVADIO/INC
          INC       PATWR1IO/INC
          INC       PMSHCPIO/INC
.
          INC       STDGENCD
.
