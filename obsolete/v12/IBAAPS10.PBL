.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
.V10.04.01  17/06/2014  Steve Armstrong CAR 301639
.           Added call to TFILENAM for FNAMPOST (AUTOPCOD)
.           in TMPFIL00 (new function).
.           Recompiled for changes to AUTOPCOD & AUPCDVAR.
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.01.01  17.05.2000 Charles Handaya
.           Add APMACEDI and painted it on Australia screen only
.-------------------------------------------------------
. VF.00.02  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
. VF.00.01  02.09.1999 Sandra Barcham
.           Add in Creditors Keyword Search
.           srf 631485
.-------------------------------------------------------
COMMAND   DIM       50
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBAAPS10
.   Function      :   Creditor Maintenance                    
.   Generated  On :   18/06/2014
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSCNTFD/INC
          INC       APSCTSFD/INC
          INC       APSIMSFD/INC
          INC       APSMASFD/INC
          INC       APSMXRFD/INC
          INC       APSPPDFD/INC
          INC       APSSNTFD/INC
          INC       AUPCDVAR/INC
          INC       FMSCODFD/INC
          INC       IBASEQFD/INC
          INC       TFILEVAR/INC
          INC       WEBERRFD/INC
.=========================
.Local Variable Definition
.-------------------------
.
.Word Processor File * Scr 00 Fld    11
.
NAMAPCN1  INIT      "Wapcn1"
FILAPCN1  DIM       8
.
CREDNAME  DIM      30 * Scr 00 Fld    22
UDC1DESC  DIM      20 * Scr 00 Fld    47
UDC2DESC  DIM      20 * Scr 00 Fld    48
DIMCITY   DIM      20 * Scr 00 Fld    50
DIMSTAT   DIM       4 * Scr 00 Fld    51
NZBANKAC  DIM      16 * Scr 00 Fld    52
PMETDES   DIM      30 * Scr 00 Fld    54
.
.Word Processor File * Scr 01 Fld    11
.
NAMAPSN1  INIT      "Wapsn1"
FILAPSN1  DIM       8
.
.
.    Multi Item Key Fields Scr 03 Fld     2
.-------------------------------------------------------
APMX2NAM  INIT      "APMX2"
APMX2LEN  FORM      "102"
APMX2IDX  INIT      "DC1-5 UC6-35"
APMX2FNM  DIM       8  * Filename
APMX2AFL  FORM      1  * End Accept Mode
APMX2END  FORM      1  * End Display
APMX2SNO  FORM      5  * Number of Items on the Screen
APMX2NXT  DIM         35
APMX2FL1  IFILE     SQL, FIXED=102,  KEY="D1-5"
APMX2FL2  IFILE     SQL, FIXED=102, KEY="U6-35"
APMX2CNT  FORM      3  * Number of Items on Screen
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBAAPS10"
PRGNAM    INIT      "Creditor Maintenance                    "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      TMPFIL00
          CALL      SC00L000
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPCN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPSN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     APMX2FL2
          CLOSE     APMX2FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   51",AUDTSECT
          MOVE      " 48",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening apsaudma";
            OPEN      APSAUDMA,"apsaudma"
          ENDIF
          DISPLAY   *P56:24,"Opening apscntaf";
          OPEN      APSCNTA1,"apscntaf"
          DISPLAY   *P56:24,"Opening apsctsaf";
          OPEN      APSCTSA1,"apsctsaf"
          DISPLAY   *P56:24,"Opening apsimsaf";
          OPEN      APSIMSA1,"apsimsaf"
          DISPLAY   *P56:24,"Opening apsimsaf";
          OPEN      APSIMSA2,"apsimsaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA1,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA2,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsppdaf";
          OPEN      APSPPDA1,"apsppdaf"
          DISPLAY   *P56:24,"Opening apssntaf";
          OPEN      APSSNTA1,"apssntaf"
          DISPLAY   *P56:24,"Opening  fmscodaf           ";
          OPEN      FMSCODA1,"fmscodaf"          
          DISPLAY   *P56:24,"Opening ibaseqaf";
          OPEN      IBASEQA1,"ibaseqaf"
          DISPLAY   *P56:24,"Opening weberraf";
          OPEN      WEBERRA1,"weberraf"
          DISPLAY   *P56:24,"Opening weberraf";
          OPEN      WEBERRA2,"weberraf"
          DISPLAY   *P56:24,"Opening weberraf";
          OPEN      WEBERRA3,"weberraf"
.--------------------------------------------------------
. Initialise Wp Filename for Creditor Notes                     
.--------------------------------------------------------
          PACK      FILAPCN1,NAMAPCN1,PORT
          REP       " 0",FILAPCN1
          DISPLAY   *P56:24,"Create & Open ",FILAPCN1;
          PREP      TEMPWORD,FILAPCN1
.
.--------------------------------------------------------
. Initialise Wp Filename for Supplier Notes                     
.--------------------------------------------------------
          PACK      FILAPSN1,NAMAPSN1,PORT
          REP       " 0",FILAPSN1
          DISPLAY   *P56:24,"Create & Open ",FILAPSN1;
          PREP      TEMPWORD,FILAPSN1
.
.--------------------------------------------------------
. Initialise Batch Screen Alias Description                  
.--------------------------------------------------------
          MOVE     ZERO,APMX2SNO
          MOVE     "03    2",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,APMX2SNO
            ENDIF
          ENDIF
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Master Creditor Maintenance Screen 
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Supplier Details                   
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Alias Maintenance                  
          ENDIF
          RETURN
.--------------------------------
. Screen - Master Creditor Maintenance Screen 
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Master Creditor Maintenance Screen 
.-------------------------------------------------------
CF00L000  COMPARE   ZERO,ACCEPT
              GOTO      CF00L999 IF EQUAL
          MOVE      SP70,APMACRD 
          MOVE      SP70,APMASKY 
          MOVE      SP70,APMACN1 
          MOVE      SP70,APMACN2 
          MOVE      SP70,APMACA1 
          MOVE      SP70,APMACA2 
          MOVE      SP70,APMACPC 
          MOVE      SP70,APMACTEL
          MOVE      SP70,APMACFAX
          MOVE      SP70,APMACON 
          MOVE      SP70,APMAPPD 
          MOVE      SP70,APMAUR1 
          MOVE      SP70,APMAUR2 
          MOVE      SP70,APMAUD1 
          MOVE      SP70,APMAUD2 
          MOVE      ZERO,APMAGREG
          MOVE      ZERO,APMAUY2 
          MOVE      SP70,APPPDES 
          MOVE      SP70,APMATYP 
          MOVE      SP70,APCTDESC
          MOVE      SP70,CREDNAME
          MOVE      SP70,APMACA3 
          MOVE      SP70,APMACMOD
          MOVE      SP70,APMACEDI
          MOVE      SP70,APMABSB 
          MOVE      SP70,APMABAC 
          MOVE      SP70,APMAPNM 
          MOVE      ZERO,APMAHOR 
          MOVE      ZERO,APMAHIN 
          MOVE      ZERO,APMAHCR 
          MOVE      ZERO,APMAHPY 
          MOVE      SP70,APMAUC1 
          MOVE      SP70,APMAUC2 
          MOVE      ZERO,APMADIS 
          MOVE      SP70,UDC1DESC
          MOVE      SP70,UDC2DESC
          MOVE      SP70,APMATSE 
          MOVE      SP70,DIMCITY 
          MOVE      SP70,DIMSTAT 
          MOVE      SP70,NZBANKAC
          MOVE      ZERO,APMAGMT 
          MOVE      SP70,PMETDES 
          MOVE      SP70,APMAABN 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Master Creditor Maintenance Screen 
.--------------------------------------------------------
KY00L000
.
KY00L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      KAPMA000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      OVRCD,ACCEPT
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Master Creditor Maintenance Screen 
.---------------------------------------------------------
WP00L000
          PREP     TEMPWORD,FILAPCN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPCN1 
          IF        OVRCD=0
            CALL      RPAPCN1 
          ENDIF
WP00L100
          CALL     RKAPCN1 
          BRANCH   OVRCD,WP00L105
          PACK     KEY8,APCNCRD,APCNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP00L105 IF NOT EQUAL
          PACK     VAR,APCNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APCNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP00L100
WP00L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Master Creditor Maintenance Screen 
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Master Creditor Maintenance Screen 
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Master Creditor Maintenance Screen 
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L101,PS00L102,PS00L103:
                            PS00L104,PS00L105,PS00L106,PS00L107:
                            PS00L108,PS00L109,PS00L110,PS00L111:
                            PS00L112,PS00L113,PS00L114,PS00L115:
                            PS00L116,PS00L117,PS00L118,PS00L119:
                            PS00L120,PS00L121,PS00L122,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L123,PS00L124:
                            PS00L125,PS00L126,PS00L127,PS00L128:
                            PS00L129,PS00L130,PS00L131,PS00L132:
                            PS00L133,PS00L134,PS00L135,PS00L136:
                            PS00L137,PS00L138,PS00L139,PS00L140:
                            PS00L141,PS00L142,PS00L143
          GOTO     PS00L999
.
PS00L101
          MOVE      APMASKY,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE     FILAPCN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS00L999
.
PS00L111
          MOVE      APMAPPD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      APMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      APPPDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      APMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE      APCTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          CALL      MVAPCN00
          MOVE      CREDNAME,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          MOVE      APMACMOD,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          MOVE      APMABSB,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L126
          MOVE      APMABAC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L127
          MOVE      APMAPNM,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L128
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHOR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L129
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHIN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L130
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHCR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHPY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L132
          MOVE      APMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L133
          MOVE      APMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L134
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L135
          MOVE      UDC1DESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L136
          MOVE      UDC2DESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L137
          MOVE      APMATSE,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L138
          MOVE      DIMCITY,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L139
          MOVE      DIMSTAT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L140
          MOVE      NZBANKAC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L141
          MOVE      APMAGMT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L142
          MOVE      PMETDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L143
          MOVE      APMAABN,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Master Creditor Maintenance Screen 
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105,SF00L106,SF00L107:
                            SF00L108,SF00L109,SF00L110,SF00L111:
                            SF00L112,SF00L113,SF00L114,SF00L115:
                            SF00L116,SF00L117,SF00L006,SF00L118:
                            SF00L006,SF00L006,SF00L119,SF00L006:
                           SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L006,SF00L120,SF00L121,SF00L122:
                            SF00L006,SF00L123,SF00L124,SF00L125:
                            SF00L126,SF00L127,SF00L128,SF00L129:
                            SF00L130,SF00L131,SF00L132,SF00L133:
                            SF00L134,SF00L135,SF00L006,SF00L006:
                            SF00L136,SF00L137,SF00L138,SF00L139:
                            SF00L140,SF00L006,SF00L141
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105,SF00L106,SF00L107:
                            SF00L108,SF00L109,SF00L110,SF00L111:
                            SF00L112,SF00L113,SF00L114,SF00L115:
                            SF00L116,SF00L117,SF00L020,SF00L118:
                            SF00L020,SF00L020,SF00L119,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L124,SF00L125:
                            SF00L126,SF00L127,SF00L128,SF00L129:
                            SF00L130,SF00L131,SF00L132,SF00L133:
                            SF00L134,SF00L135,SF00L020,SF00L020:
                            SF00L136,SF00L137,SF00L138,SF00L139:
                            SF00L140,SF00L020,SF00L141
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPSKA00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L101
            ENDIF
            BRANCH    EXIT,SF00L101,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      APMASKY,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L102
          CALL      MVAPCN00
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CREDNAME
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          STRIP     APMACN1 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMACN1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMACN1 
          SFORMAT   VAR,127
          ENDSET    APMACN1 
          APPEND    SP70,APMACN1 
          RESET     APMACN1 
          CMATCH    EXITCHAR,APMACN1 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMACN1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L102
            ENDIF
          ENDIF
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          CALL      MVAPCN00
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CREDNAME,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L103
          CALL     SELECTED
          STRIP     APMACN2 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMACN2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMACN2 
          SFORMAT   VAR,127
          ENDSET    APMACN2 
          APPEND    SP70,APMACN2 
          RESET     APMACN2 
          CMATCH    EXITCHAR,APMACN2 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMACN2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L103
            ENDIF
          ENDIF
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L104
          CALL     SELECTED
          STRIP     APMACA1 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMACA1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMACA1 
          SFORMAT   VAR,127
          ENDSET    APMACA1 
          APPEND    SP70,APMACA1 
          RESET     APMACA1 
          CMATCH    EXITCHAR,APMACA1 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMACA1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L104
            ENDIF
          ENDIF
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KADD2000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L105
            ENDIF
            BRANCH    EXIT,SF00L105,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L106
          CALL     SELECTED
          STRIP     APMACPC 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMACPC,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMACPC 
          SFORMAT   VAR,127
          ENDSET    APMACPC 
          APPEND    SP70,APMACPC 
          RESET     APMACPC 
          CMATCH    EXITCHAR,APMACPC 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMACPC 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L106
            ENDIF
          ENDIF
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L107
          CALL     SELECTED
          STRIP     APMACTEL
          SFORMAT   VAR,SCPSLEN
          MOVE      APMACTEL,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMACTEL
          SFORMAT   VAR,127
          ENDSET    APMACTEL
          APPEND    SP70,APMACTEL
          RESET     APMACTEL
          CMATCH    EXITCHAR,APMACTEL
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMACTEL
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L107
            ENDIF
          ENDIF
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L108
          CALL     SELECTED
          STRIP     APMACFAX
          SFORMAT   VAR,SCPSLEN
          MOVE      APMACFAX,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMACFAX
          SFORMAT   VAR,127
          ENDSET    APMACFAX
          APPEND    SP70,APMACFAX
          RESET     APMACFAX
          CMATCH    EXITCHAR,APMACFAX
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMACFAX
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L108
            ENDIF
          ENDIF
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L109
          CALL     SELECTED
          STRIP     APMACON 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMACON,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMACON 
          SFORMAT   VAR,127
          ENDSET    APMACON 
          APPEND    SP70,APMACON 
          RESET     APMACON 
          CMATCH    EXITCHAR,APMACON 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMACON 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L109
            ENDIF
          ENDIF
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L110
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPCN1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPCN1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          GOTO     SF00L001
.
SF00L111
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APPPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPPPA00
          MOVE      APPPTER,APMAPPD
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L111
            ENDIF
            BRANCH    EXIT,SF00L111,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      APMAPPD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APPPDES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L112
          CALL     SELECTED
          STRIP     APMAUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMAUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMAUR1 
          SFORMAT   VAR,127
          ENDSET    APMAUR1 
          APPEND    SP70,APMAUR1 
          RESET     APMAUR1 
          CMATCH    EXITCHAR,APMAUR1 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMAUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L112
            ENDIF
          ENDIF
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L113
          CALL     SELECTED
          STRIP     APMAUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMAUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMAUR2 
          SFORMAT   VAR,127
          ENDSET    APMAUR2 
          APPEND    SP70,APMAUR2 
          RESET     APMAUR2 
          CMATCH    EXITCHAR,APMAUR2 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMAUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L113
            ENDIF
          ENDIF
          MOVE      APMAUR2,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L114
          CALL     SELECTED
          CALL      KEYDATE
          PACK      APMAUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L115
          CALL     SELECTED
          CALL      KEYDATE
          PACK      APMAUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L116
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,APMAGREG
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L117
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,APMAUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L118
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APCTDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPCTA00
          MOVE      APCTCODE,APMATYP
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L118
            ENDIF
            BRANCH    EXIT,SF00L118,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      APMATYP,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APCTDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L119
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KADD3000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L119
            ENDIF
            BRANCH    EXIT,SF00L119,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L120
          CALL      CANCL000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L121
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      POST0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF00L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF00L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF00L999
          ENDIF
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF00L000
          ENDIF
          GOTO      SF00L001
.
SF00L122
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DAPMA000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF00L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF00L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF00L999
          ENDIF
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF00L000
          ENDIF
          GOTO      SF00L001
.
SF00L123
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC03L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L124
          CALL     SELECTED
          STRIP     APMACMOD
          SFORMAT   VAR,SCPSLEN
          MOVE      APMACMOD,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMACMOD
          SFORMAT   VAR,127
          ENDSET    APMACMOD
          APPEND    SP70,APMACMOD
          RESET     APMACMOD
          CMATCH    EXITCHAR,APMACMOD
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMACMOD
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L124
            ENDIF
          ENDIF
          MOVE      APMACMOD,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L125
          CALL     SELECTED
          STRIP     APMACEDI
          SFORMAT   VAR,SCPSLEN
          MOVE      APMACEDI,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMACEDI
          SFORMAT   VAR,127
          ENDSET    APMACEDI
          APPEND    SP70,APMACEDI
          RESET     APMACEDI
          CMATCH    EXITCHAR,APMACEDI
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMACEDI
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L125
            ENDIF
          ENDIF
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L126
          CALL     SELECTED
          STRIP     APMABSB 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMABSB,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMABSB 
          SFORMAT   VAR,127
          ENDSET    APMABSB 
          APPEND    SP70,APMABSB 
          RESET     APMABSB 
          CMATCH    EXITCHAR,APMABSB 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMABSB 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L126
            ENDIF
          ENDIF
          MOVE      APMABSB,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L127
          CALL     SELECTED
          STRIP     APMABAC 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMABAC,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMABAC 
          SFORMAT   VAR,127
          ENDSET    APMABAC 
          APPEND    SP70,APMABAC 
          RESET     APMABAC 
          CMATCH    EXITCHAR,APMABAC 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMABAC 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L127
            ENDIF
          ENDIF
          MOVE      APMABAC,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L128
          CALL     SELECTED
          STRIP     APMAPNM 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMAPNM,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMAPNM 
          SFORMAT   VAR,127
          ENDSET    APMAPNM 
          APPEND    SP70,APMAPNM 
          RESET     APMAPNM 
          CMATCH    EXITCHAR,APMAPNM 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMAPNM 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L128
            ENDIF
          ENDIF
          MOVE      APMAPNM,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L129
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      HORD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L129
            ENDIF
            BRANCH    EXIT,SF00L129,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHOR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L130
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      HINV0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L130
            ENDIF
            BRANCH    EXIT,SF00L130,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHIN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L131
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      HCRD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L131
            ENDIF
            BRANCH    EXIT,SF00L131,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHCR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L132
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      HPAY0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L132
            ENDIF
            BRANCH    EXIT,SF00L132,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHPY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L133
.
.
          MOVE      "   47",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UDC1DESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          STRIP     APMAUC1 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMAUC1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMAUC1 
          SFORMAT   VAR,127
          ENDSET    APMAUC1 
          APPEND    SP70,APMAUC1 
          RESET     APMAUC1 
          CMATCH    EXITCHAR,APMAUC1 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMAUC1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L133
            ENDIF
          ENDIF
          MOVE      APMAUC1,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   47",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UDC1DESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L134
.
.
          MOVE      "   48",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UDC2DESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          STRIP     APMAUC2 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMAUC2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMAUC2 
          SFORMAT   VAR,127
          ENDSET    APMAUC2 
          APPEND    SP70,APMAUC2 
          RESET     APMAUC2 
          CMATCH    EXITCHAR,APMAUC2 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMAUC2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L134
            ENDIF
          ENDIF
          MOVE      APMAUC2,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   48",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UDC2DESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L135
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,APMADIS 
          IF        SCPSMAN=1
            COMPARE   ZERO,APMADIS 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L135
            ENDIF
          ENDIF
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L136
          CALL     SELECTED
          STRIP     APMATSE 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMATSE,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMATSE 
          SFORMAT   VAR,127
          ENDSET    APMATSE 
          APPEND    SP70,APMATSE 
          RESET     APMATSE 
          CMATCH    EXITCHAR,APMATSE 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMATSE 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L136
            ENDIF
          ENDIF
          MOVE      APMATSE,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L137
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCITY000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L137
            ENDIF
            BRANCH    EXIT,SF00L137,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      DIMCITY,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L138
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSTAT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L138
            ENDIF
            BRANCH    EXIT,SF00L138,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      DIMSTAT,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L139
          CALL     SELECTED
          STRIP     NZBANKAC
          SFORMAT   VAR,SCPSLEN
          MOVE      NZBANKAC,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,NZBANKAC
          SFORMAT   VAR,127
          ENDSET    NZBANKAC
          APPEND    SP70,NZBANKAC
          RESET     NZBANKAC
          CMATCH    EXITCHAR,NZBANKAC
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,NZBANKAC
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L139
            ENDIF
          ENDIF
          MOVE      NZBANKAC,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L140
.
.
          MOVE      "   54",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,PMETDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EPMET000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L140
            ENDIF
            BRANCH    EXIT,SF00L140,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      APMAGMT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   54",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      PMETDES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L141
          CALL     SELECTED
          STRIP     APMAABN 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMAABN,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMAABN 
          SFORMAT   VAR,127
          ENDSET    APMAABN 
          APPEND    SP70,APMAABN 
          RESET     APMAABN 
          CMATCH    EXITCHAR,APMAABN 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMAABN 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L141
            ENDIF
          ENDIF
          MOVE      APMAABN,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Supplier Details                   
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC01L200
          CALL      CF01L000 * Clear Fields
          CALL      AP10A000
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Supplier Details                   
.-------------------------------------------------------
CF01L000  COMPARE   ZERO,ACCEPT
              GOTO      CF01L999 IF EQUAL
          MOVE      SP70,APMACRD 
          MOVE      ZERO,APMADIS 
          MOVE      SP70,APMACN1 
          MOVE      SP70,APMASA1 
          MOVE      SP70,APMASA2 
          MOVE      SP70,APMASA3 
          MOVE      SP70,APMASPC 
          MOVE      SP70,APMASTEL
          MOVE      SP70,APMASFAX
          MOVE      SP70,APMASCON
          MOVE      SP70,APMAUR1 
          MOVE      SP70,APMAUR2 
          MOVE      SP70,APMAUD1 
          MOVE      SP70,APMAUD2 
          MOVE      ZERO,APMAGREG
          MOVE      ZERO,APMAUY2 
          MOVE      SP70,APMASN1 
          MOVE      SP70,APMASN2 
          MOVE      SP70,APMASEDI
          MOVE      SP70,APMACEDI
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Supplier Details                   
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Supplier Details                   
.---------------------------------------------------------
WP01L000
          PREP     TEMPWORD,FILAPSN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPSN1 
          IF        OVRCD=0
            CALL      RPAPSN1 
          ENDIF
WP01L100
          CALL     RKAPSN1 
          BRANCH   OVRCD,WP01L105
          PACK     KEY8,APSNCRD,APSNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP01L105 IF NOT EQUAL
          PACK     VAR,APSNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APSNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP01L100
WP01L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Supplier Details                   
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Supplier Details                   
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Supplier Details                   
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L101,PS01L102,PS01L103,PS01L104:
                            PS01L105,PS01L106,PS01L107,PS01L108:
                            PS01L109,PS01L110,PS01L111,PS01L999:
                           PS01L112,PS01L113,PS01L114,PS01L115:
                            PS01L116,PS01L117,PS01L118,PS01L119:
                            PS01L120,PS01L121,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999
          GOTO     PS01L999
.
PS01L101
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE     FILAPSN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS01L999
.
PS01L112
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          MOVE      APMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L116
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L117
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L118
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L119
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L120
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L121
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Supplier Details                   
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L006,SF01L102:
                            SF01L103,SF01L104,SF01L105,SF01L106:
                            SF01L107,SF01L108,SF01L109,SF01L006:
                           SF01L110,SF01L111,SF01L112,SF01L113:
                            SF01L114,SF01L115,SF01L116,SF01L117:
                            SF01L118,SF01L119,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L120,SF01L121,SF01L006:
                           SF01L006,SF01L122
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L101,SF01L020,SF01L102:
                            SF01L103,SF01L104,SF01L105,SF01L106:
                            SF01L107,SF01L108,SF01L109,SF01L020:
                           SF01L110,SF01L111,SF01L112,SF01L113:
                            SF01L114,SF01L115,SF01L116,SF01L117:
                            SF01L118,SF01L119,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,APMADIS 
          IF        SCPSMAN=1
            COMPARE   ZERO,APMADIS 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L101
            ENDIF
          ENDIF
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L102
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPSA100
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L102
            ENDIF
            BRANCH    EXIT,SF01L102,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPSA200
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L103
            ENDIF
            BRANCH    EXIT,SF01L103,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPSA300
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L104
            ENDIF
            BRANCH    EXIT,SF01L104,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPSPC00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L105
            ENDIF
            BRANCH    EXIT,SF01L105,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L106
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPSTE00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L106
            ENDIF
            BRANCH    EXIT,SF01L106,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L107
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPSFA00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L107
            ENDIF
            BRANCH    EXIT,SF01L107,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L108
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPSCO00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L108
            ENDIF
            BRANCH    EXIT,SF01L108,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L109
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "15",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     " 6",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPSN1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPSN1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          GOTO     SF01L001
.
SF01L110
          CALL     SELECTED
          STRIP     APMAUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMAUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMAUR1 
          SFORMAT   VAR,127
          ENDSET    APMAUR1 
          APPEND    SP70,APMAUR1 
          RESET     APMAUR1 
          CMATCH    EXITCHAR,APMAUR1 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMAUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L110
            ENDIF
          ENDIF
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L111
          CALL     SELECTED
          STRIP     APMAUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMAUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMAUR2 
          SFORMAT   VAR,127
          ENDSET    APMAUR2 
          APPEND    SP70,APMAUR2 
          RESET     APMAUR2 
          CMATCH    EXITCHAR,APMAUR2 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMAUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L111
            ENDIF
          ENDIF
          MOVE      APMAUR2,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L112
          CALL     SELECTED
          CALL      KEYDATE
          PACK      APMAUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L113
          CALL     SELECTED
          CALL      KEYDATE
          PACK      APMAUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L114
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,APMAGREG
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L115
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,APMAUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L116
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPSN100
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L116
            ENDIF
            BRANCH    EXIT,SF01L116,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L117
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPSN200
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L117
            ENDIF
            BRANCH    EXIT,SF01L117,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L118
          CALL     SELECTED
          STRIP     APMASEDI
          SFORMAT   VAR,SCPSLEN
          MOVE      APMASEDI,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMASEDI
          SFORMAT   VAR,127
          ENDSET    APMASEDI
          APPEND    SP70,APMASEDI
          RESET     APMASEDI
          CMATCH    EXITCHAR,APMASEDI
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMASEDI
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L118
            ENDIF
          ENDIF
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L119
          CALL     SELECTED
          STRIP     APMACEDI
          SFORMAT   VAR,SCPSLEN
          MOVE      APMACEDI,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMACEDI
          SFORMAT   VAR,127
          ENDSET    APMACEDI
          APPEND    SP70,APMACEDI
          RESET     APMACEDI
          CMATCH    EXITCHAR,APMACEDI
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMACEDI
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L119
            ENDIF
          ENDIF
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L120
          CALL      CANCL000
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L121
          CALL      WAPMA000
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L122
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC03L000
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Alias Maintenance                  
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 57",CRIG
          MOVE      "11",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Alias Maintenance                  
.-------------------------------------------------------
CF03L000  COMPARE   ZERO,ACCEPT
              GOTO      CF03L999 IF EQUAL
          MOVE      SP70,APMXREF 
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Alias Maintenance                  
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Alias Maintenance                  
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Alias Maintenance                  
.---------------------------------------------------------
LM03L000
.---------------------------------------------------------
. Load for :     2 Alias Description                  
.---------------------------------------------------------
          UNPACK    SP70,APMXCRD,APMXREF
          PACK      APMX2FNM,ANST,APMX2NAM,PORT
          REP       " 0",APMX2FNM
          MOVE      ZERO,APMX2AFL
          CLOSE     APMX2FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      APMX2FL1,APMX2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     APMX2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,APMX2FNM,SP1,APMX2LEN,SP1,APMX2IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      APMX2FL1,APMX2FNM
          OPEN      APMX2FL2,APMX2FNM
          PACK      KEY35,APMACRD,SP70
          MOVE      KEY35,SAVKEY80
          SETLPTR   SAVKEY80,5 
          CALL      RDAPMX2 
          IF        OVRCD=0
            CALL      RPAPMX2 
          ENDIF
LM03L100
          CALL      RKAPMX2 
          BRANCH    OVRCD,LM03L105
          PACK      KEY35,APMXCRD,APMXREF
          MATCH     SAVKEY80,KEY35   
          GOTO      LM03L105 IF NOT EQUAL
          RESET     KEY35,6
          MOVE      KEY35,KEY30
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TAAPMX22
          IF        OVRCD=0
            CALL      TUAPMX22
          ELSE
            CALL      TWAPMX22
          ENDIF
          GOTO     LM03L100
LM03L105
          MOVE     SP70,KEY30  
          CALL     TSAPMX22
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Alias Maintenance                  
.---------------------------------------------------------
SM03L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM03L010 IF EQUAL
SM03L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM03L010,SM03L101,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010
SM03L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM03L007
          MATCH     PRGID,SCPSPID
          GOTO      SM03L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM03L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM03L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM03L006 IF NOT EQUAL
          GOTO      SM03L005
SM03L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM03L010
          BRANCH    STDGSFLG,SM03L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM03L900
          MATCH     PRGID,SCPSPID
          GOTO      SM03L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM03L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM03L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM03L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010
          GOTO      SM03L010
.
SM03L101
          CALL      MAPMX000
          MOVE     ZERO,APMX2AFL
          STRIP     APMXREF 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMXREF,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMXREF 
          SFORMAT   VAR,127
          ENDSET    APMXREF 
          APPEND    SP70,APMXREF 
          RESET     APMXREF 
          MATCH     SP70,APMXREF 
          GOTO      SM03L990 IF EQUAL
          CMATCH    EXITCHAR,APMXREF 
          GOTO      SM03L990 IF EQUAL
          PACK     KEY35,APMXCRD,APMXREF                                                           
          RESET    KEY35,6
          MOVE     KEY35,KEY30
          CALL      TAAPMX22
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM03L101
          ENDIF
          MOVE      APMXREF,VAR      
          CALL      DISPITEM
          GOTO     SM03L010
SM03L900
          MATCH    "APMX2",NAMSSFFI
          IF       @EQUAL
            PACK     KEY35,APMXCRD,APMXREF
            RESET    KEY35,6
            MOVE     KEY35,KEY30
            CALL      TAAPMX22
            IF        OVRCD=0
              CALL      TUAPMX22
            ELSE
              CALL      TWAPMX22
            ENDIF
            GOTO      SM03L999
          ENDIF
          GOTO      SM03L999
SM03L990
          MATCH    "APMX2",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,APMX2AFL
          ENDIF
SM03L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP03L000
          MOVE     ZERO,APMX2CNT
          MOVE     ZERO,APMX2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP03L600
          MATCH    PRGID,SCPSPID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP03L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP03L010,DP03L101,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010
          GOTO      DP03L010
.
DP03L101
          IF        APMX2END=0
            CALL      TKAPMX22
            IF        OVRCD=1
              MOVE      ONE,APMX2END
            ELSE
              MOVE      ZERO,APMX2END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUAPMX22
              MOVE      APMXREF,VAR      
              CALL      DISPITEM
            ENDIF
          ENDIF
          IF        APMX2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
DP03L600
          MATCH    "APMX2",NAMSSFFI
          GOTO     DP03L605 IF NOT EQUAL
          GOTO     DP03L999
DP03L605
DP03L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP03L000
.
          CALL     CT03L000
          MATCH    "APMX2",NAMSSFFI
          GOTO     FP03L105 IF NOT EQUAL
          MOVE     SP70,KEY30  
          CALL     TSAPMX22 * Start
          CALL     DP03L000
          GOTO     FP03L999
FP03L105
FP03L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP03L000
.
          CALL     CT03L000
          MATCH    "APMX2",NAMSSFFI
          GOTO     LP03L105 IF NOT EQUAL
          PACK     KEY30,Z70
          CALL     TSAPMX22
          IF       OVRCD=1
            CALL     TPAPMX22 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APMX2SNO
            CALL     TPAPMX22
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     LP03L999
LP03L105
LP03L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP03L000
.
PP03L100
          MATCH    "APMX2",NAMSSFFI
          GOTO     PP03L115 IF NOT EQUAL
PP03L105
          MOVE     SP70,APMX2NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSAPMX21
          CALL     TKAPMX21 * First on Page
          MOVE     KEY30,APMX2NXT
          CALL     TSAPMX22
          CALL     TPAPMX22 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP03L999
          ENDIF
.
          CALL     CT03L000
.
. Position and Display Page
.--------------------------
PP03L110
          MOVE     APMX2NXT,KEY30  
          CALL     TSAPMX22
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=APMX2SNO
            CALL     TPAPMX22
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     PP03L999
PP03L115
PP03L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP03L000
          MATCH    "APMX2",NAMSSFFI
          GOTO     NP03L115 IF NOT EQUAL
NP03L105
          MOVE     SP70,APMX2NXT
          PACK     KEY5,Z70
          CALL     TSAPMX21
          CALL     TPAPMX21
          MOVE     KEY30,APMX2NXT
          CALL     TSAPMX22
          CALL     TKAPMX22
          IF       OVRCD=1
            BEEP
            GOTO      NP03L999
          ENDIF
.
          CALL     CT03L000
.
. Position and Display Page
.--------------------------
NP03L110
          MOVE     APMX2NXT,KEY30  
          CALL     TSAPMX22
          CALL     DP03L000
          GOTO     NP03L999
NP03L115
NP03L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT03L000
          MATCH    "APMX2",NAMSSFFI
          GOTO     CT03L115 IF NOT EQUAL
CT03L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSAPMX21
          CALL     TKAPMX21
          BRANCH   OVRCD,CT03L110
          CALL     TRAPMX22
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUAPMX22
          GOTO     CT03L105
CT03L110
          GOTO     CT03L999
CT03L115
CT03L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP03L000
          CALL     CT03L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP03L999
          MATCH    PRGID,SCPSPID
          GOTO     CP03L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP03L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP03L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP03L010,CP03L100,CP03L010,CP03L010:
                            CP03L010,CP03L010,CP03L010,CP03L010:
                            CP03L010,CP03L010
.
CP03L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP03L010
CP03L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD03L000
          CALL      CP03L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD03L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD03L000
          MATCH     PRGID,SCPSPID
          GOTO      AD03L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD03L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD03L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM03L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "APMX2",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,APMX2AFL
            GOTO      AD03L010 IF EQUAL
            CALL      FP03L000
            GOTO      AD03L999
          ENDIF
AD03L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL03L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL03L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL03L900,DL03L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL03L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "APMX2",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRAPMX21
            IF        OVRCD=0
              CALL      TDAPMX22
            ELSE
              BEEP
              GOTO      DL03L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSAPMX21
            CALL      TKAPMX21
            MOVE     KEY30,APMX2NXT
            CALL      CT03L000
            MOVE      APMX2NXT,KEY30  
            CALL      TSAPMX22
            CALL      TPAPMX22
            CALL      DP03L000
            GOTO      DL03L005
          ENDIF
DL03L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL03L005
DL03L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Alias Maintenance                  
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     2 Alias Description                  
.---------------------------------------------------------
TSAPMX21  RESET     KEY5
          READ      APMX2FL1,KEY5;;
          RETURN
.
TSAPMX22  RESET     KEY30  
          READ      APMX2FL2,KEY30;;
          RETURN
.
TAAPMX22  RESET     KEY30  
          MOVE      ZERO,OVRCD
          READ      APMX2FL2,KEY30;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDAPMX21  RESET     KEY5
          DELETE    APMX2FL1,KEY5
          RETURN
.
TDAPMX22  RESET     KEY30
          DELETE    APMX2FL2,KEY30
          RETURN
.
TKAPMX21  MOVE      ZERO,OVRCD
          READKS    APMX2FL1;SCTMROW,SCTMCOL,KEY30:
                        APMXCRD,APMXREF,APMXTYP,APMXSPA                         
          GOTO      OVERCOND IF OVER
          RETURN
.
TKAPMX22  MOVE      ZERO,OVRCD
          READKS    APMX2FL2;SCTMROW,SCTMCOL,KEY30:
                        APMXCRD,APMXREF,APMXTYP,APMXSPA                         
          GOTO      OVERCOND IF OVER
          RETURN
.
TPAPMX21  MOVE      ZERO,OVRCD
          READKP    APMX2FL1;SCTMROW,SCTMCOL,KEY30:
                        APMXCRD,APMXREF,APMXTYP,APMXSPA                         
          GOTO      OVERCOND IF OVER
          RETURN
.
TPAPMX22  MOVE      ZERO,OVRCD
          READKP    APMX2FL2;SCTMROW,SCTMCOL,KEY30:
                        APMXCRD,APMXREF,APMXTYP,APMXSPA                         
          GOTO      OVERCOND IF OVER
          RETURN
.
TRAPMX21  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      APMX2FL1,KEY5;SCTMROW,SCTMCOL,KEY30:
                        APMXCRD,APMXREF,APMXTYP,APMXSPA                         
          GOTO      OVERCOND IF OVER
          RETURN
.
TRAPMX22  RESET     KEY30  
          MOVE      ZERO,OVRCD
          READ      APMX2FL2,KEY30;SCTMROW,SCTMCOL,KEY30:
                        APMXCRD,APMXREF,APMXTYP,APMXSPA                         
          GOTO      OVERCOND IF OVER
          RETURN
.
TUAPMX21  UPDATE    APMX2FL1;SCTMROW,SCTMCOL,KEY30:
                        APMXCRD,APMXREF,APMXTYP,APMXSPA                         
          RETURN
.
TUAPMX22
          UPDATE    APMX2FL2;SCTMROW,SCTMCOL,KEY30:
                        APMXCRD,APMXREF,APMXTYP,APMXSPA                         
          RETURN
.
TWAPMX22  RESET     KEY30  
          WRITE     APMX2FL2,KEY30;SCTMROW,SCTMCOL,KEY30:
                        APMXCRD,APMXREF,APMXTYP,APMXSPA                         
          RETURN
.---------------------------------------------------------
. Display Fields for : Alias Maintenance                  
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
          MOVE      "APMX2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      FP03L000
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Alias Maintenance                  
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Alias Maintenance                  
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L103:
                            SF03L104,SF03L105,SF03L106,SF03L107:
                            SF03L108,SF03L109
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L101,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          MOVE      "APMX2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L101
          CALL      SELECTED
          BRANCH    EXIT,SF03L001
          MOVE      "APMX2",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRAPMX21
            BRANCH    OVRCD,SF03L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF03L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF03L001 IF NOT EQUAL
            CALL      SM03L000 * Change Line
          ELSE
            IF        APMX2AFL=0
              MOVE      "APMX2",NAMSSFFI
              MOVE     "    2",ITMSSFFI
              CALL      AD03L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF03L001
.
SF03L102
          MOVE      "APMX2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      NP03L000
          GOTO     SF03L001
.
SF03L103
          MOVE      "APMX2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      PP03L000
          GOTO     SF03L001
.
SF03L104
          MOVE      "APMX2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      AD03L000
          GOTO     SF03L001
.
SF03L105
          MOVE      "APMX2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      DL03L000
          GOTO     SF03L001
.
SF03L106
          MOVE      "APMX2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L107
          MOVE      "APMX2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      LP03L000
          GOTO     SF03L001
.
SF03L108
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L109
          CALL      WAPMX000
          MOVE      ZERO,EXIT
          GOTO      SF03L999
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.@@@@@ Function Restart Point @@@@@
.**********************************************************************
. TMPFIL00 - set temp file name
.**********************************************************************
TMPFIL00  CALL      TFILENAM
          MOVE      TFILNAME,FNAMPOST
.
TMPFIL99  RETURN
.----------------------------------------------------------------------
. Move Creditors Name for Display
.----------------------------------------------------------------------
MVAPCN00  MOVE      APMACN1,CREDNAME
          RETURN
.
.----------------------------------------------------------------------
. Cancel Creditors Maintenance
.----------------------------------------------------------------------
KAPMA000  CALL      KILL0000                 * Remove Temporary Files
          CALL      KAPMAA00
          BRANCH    EXIT,KAPMA999,KAPMA999
.
KAPMA100  MOVE      APMACRD,KEY5
          CALL      RLAPMA1
          BRANCH    OVRCD,KAPMA900,KAPMA200
.
          MOVE      "Cheque",PMETDES
          BRANCH    APMAGMT,KAPMA110,KAPMA120,KAPMA130
          GOTO      KAPMA190
KAPMA110  MOVE      "Direct Dr (w Advice)          ",PMETDES
          GOTO      KAPMA190
KAPMA120  MOVE      "Direct Dr (w Advice if>1 Inv.)",PMETDES
          GOTO      KAPMA190
KAPMA130  MOVE      "Direct Dr (w/o Advice)        ",PMETDES
.
KAPMA190  UNPACK    APMACA3,DIMCITY,ANS,DIMSTAT
          PACK      NZBANKAC,APMABSB,APMABAC,SP70
.
          MOVE      TWO,AUDTTYPE
          CALL      WAAPMA00          * Write Before Audit
          MOVE      ZERO,EXIT
.
          MOVE      APMAPPD,KEY2
          CALL      RDAPPP1
.
          MOVE      APMATYP,KEY3
          CALL      RDAPCT1
.
          CLEAR     KEY5
          APPEND    "a1",KEY5
          APPEND    APMAUC1,KEY5
          RESET     KEY5
          CALL      RDFMCD1
          IF        OVRCD=0
            MOVE      FMCDDESC,UDC1DESC
          ELSE
            MOVE      SP70,UDC1DESC
          ENDIF
.
          CLEAR     KEY5
          APPEND    "a2",KEY5
          APPEND    APMAUC2,KEY5
          RESET     KEY5
          CALL      RDFMCD1
          IF        OVRCD=0
            MOVE      FMCDDESC,UDC2DESC
          ELSE
            MOVE      SP70,UDC2DESC
          ENDIF
.
          MOVE      ZERO,OVRCD
          GOTO      KAPMA999
.
KAPMA200  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          KEYIN     *P1:24,*EL,"Record Locked - (":
                    *V2LON,"R",*HOFF,")etry or e(":
                    *V2LON,"X",*HOFF,")it ? ",ANS
          CALL      MESSAGE3
          REP       UPPLOW,ANS
          MATCH     ANSR,ANS
          GOTO      KAPMA100 IF EQUAL
          MATCH     ANSX,ANS
          GOTO      KAPMA200 IF NOT EQUAL
          GOTO      KAPMA000
.
KAPMA900
          MOVE      SP70,NZBANKAC
          MOVE      SP70,APMATYP
          MOVE      SP70,APMASKY
          MOVE      SP70,APMACN1
          MOVE      SP70,APMACN2
          MOVE      SP70,APMACA1
          MOVE      SP70,APMACA2
          MOVE      SP70,APMACA3
          MOVE      SP70,APMACPC
          MOVE      SP70,APMACTEL
          MOVE      SP70,APMACFAX
          MOVE      SP70,APMACMOD
          MOVE      SP70,APMACEDI
          MOVE      SP70,APMACON
          MOVE      SP70,APMASN1
          MOVE      SP70,APMASN2
          MOVE      SP70,APMASA1
          MOVE      SP70,APMASA2
          MOVE      SP70,APMASA3
          MOVE      SP70,APMASPC
          MOVE      SP70,APMASTEL
          MOVE      SP70,APMASFAX
          MOVE      SP70,APMASMOD
          MOVE      SP70,APMASEDI
          MOVE      SP70,APMASCON
          MOVE      SP70,APMABSB
          MOVE      SP70,APMABAC
          MOVE      SP70,APMAPNM
          MOVE      ZERO,APMAPPT
          MOVE      ZERO,APMAPOT
          MOVE      ZERO,APMAHOR
          MOVE      ZERO,APMAHIN
          MOVE      ZERO,APMAHCR
          MOVE      ZERO,APMAHPY
          MOVE      ZERO,APMAPMT
          MOVE      ZERO,APMAGMT
          MOVE      SP70,APMAPPD
          MOVE      SP70,APMADTM
          MOVE      SP70,APMAUR1
          MOVE      SP70,APMAUR2
          MOVE      SP70,APMAUD1
          MOVE      SP70,APMAUD2
          MOVE      SP70,APMAUC1
          MOVE      SP70,APMAUC2
          MOVE      ZERO,APMAGREG
          MOVE      ZERO,APMAUY2
          MOVE      SP70,APMASPA
          MOVE      SP70,APMAABN
          UNPACK    APMACA3,DIMCITY,ANS,DIMSTAT
.
KAPMA999  RETURN
.
KILL0000  CLEAR     COMMAND
          APPEND    "iserase ",COMMAND
          APPEND    APMX2FNM,COMMAND
          RESET     COMMAND
          EXECUTE   COMMAND,TASKID
          RETURN
.
.----------------------------------------------------------------------
. Sort Key Keyin Default to Creditor Name if Blank
.----------------------------------------------------------------------
KAPSKA00   MATCH    SP70,APMASKY
           IF       @EQUAL
             MOVE     APMACN1,APMASKY
           ENDIF
           KEYIN    *PCCOL:CVERT,*V2LON,*RV,APMASKY
           RETURN
.------------------------------------------------------------
. Enter Address Line 2 and Validate Suburb
.------------------------------------------------------------
KADD2000  STRIP     APMACA2
          SFORMAT   VAR,SCPSLEN
          MOVE      APMACA2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMACA2
          SFORMAT   VAR,127
          ENDSET    APMACA2
          APPEND    SP70,APMACA2
          RESET     APMACA2
          CMATCH    EXITCHAR,APMACA2
          GOTO      KADD2900 IF EQUAL
.
          MOVE      TWO,SUBKYLIN
          PACK      IBAADLN2,APMACA2,SP30,SP30
          PACK      IBAADLN3,APMACA3,SP30,SP30
          PROC      AUTOPCOD
          BRANCH    EXIT,KADD2000,KADD2500
.
          MOVE      IBAPCOD,APMACPC
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACPC,VAR
            CALL      DISPITEM
          ENDIF
          MOVE      "    6",FLDID
          CALL      GETPOSIT
KADD2500  MOVE      ZERO,EXIT
          GOTO      KADD2999
.
KADD2900  MOVE      TWO,EXIT
.
KADD2999  RETURN
.------------------------------------------------------------
. Enter Address Line 3 and Validate Suburb
.------------------------------------------------------------
KADD3000  STRIP     APMACA3
          SFORMAT   VAR,SCPSLEN
          MOVE      APMACA3,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMACA3
          SFORMAT   VAR,127
          ENDSET    APMACA3
          APPEND    SP70,APMACA3
          RESET     APMACA3
          CMATCH    EXITCHAR,APMACA3
          GOTO      KADD3900 IF EQUAL
.
          MOVE      THREE,SUBKYLIN
          PACK      IBAADLN2,APMACA2,SP30,SP30
          PACK      IBAADLN3,APMACA3,SP30,SP30
          PROC      AUTOPCOD
          BRANCH    EXIT,KADD3000,KADD3500
.
          MOVE      IBAPCOD,APMACPC
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACPC,VAR
            CALL      DISPITEM
          ENDIF
          MOVE      "   23",FLDID
          CALL      GETPOSIT
KADD3500  MOVE      ZERO,EXIT
          GOTO      KADD3999
.
KADD3900  MOVE      TWO,EXIT
.
KADD3999  RETURN
.----------------------------------------------------------------------
. Cancel Creditors Maintenance
.----------------------------------------------------------------------
CANCL000  MOVE    APMACRD,KEY5
          CALL    RAAPMA1
          BRANCH  OVRCD,CANCL100
          CALL    UUAPMA1
          CALL    DAAPMA00    * Delete Before Audit
          GOTO    CANCL999
.
CANCL100  PACK    KEY35,APMACRD,SP70
          CALL    RSAPMX2
CANCL200  CALL    RKAPMX2
          BRANCH  OVRCD,CANCL999
          MATCH   APMACRD,APMXCRD
          GOTO    CANCL999 IF NOT EQUAL
          PACK    KEY35,APMXCRD,APMXREF
          CALL    DEAPMX2
          GOTO    CANCL200
.
CANCL999  RETURN
.
.----------------------------------------------------------------------
. Post Creditor Details
.----------------------------------------------------------------------
POST0000  COMPARE  ZERO,APMAGMT
          GOTO     POST9000 IF EQUAL
          MOVE     "00",SCRID
          MOVE     "   52",FLDID
          CALL     GETPOSIT
          IF       EXIT=0
            MATCH    SP70,NZBANKAC
            GOTO     POST8000 IF EQUAL
          ELSE
            MATCH    SP70,APMABSB
            GOTO     POST8000 IF EQUAL
            MATCH    SP70,APMABAC
            GOTO     POST8000 IF EQUAL
          ENDIF
          GOTO     POST9000
.
POST8000  BEEP
          MOVE     "Account Details Required for Direct Bank Transfer. ",DISPMSG
          CALL     MESSAGE1
          MOVE     ONE,EXIT
          GOTO     POST9999
.
POST9000  CALL     SC01L000     * Supplier Details
          MOVE     TWO,EXIT
.
POST9999  RETURN
.----------------------------------------------------------------------
. Delete Creditor Details
.----------------------------------------------------------------------
DAPMA000  PACK     KEY48,APMACRD,SP70
          CALL     RSAPIM2
          CALL     RKAPIM2
          BRANCH   OVRCD,DAPMA100
          MATCH    APMACRD,APIMCRD
          GOTO     DAPMA920 IF EQUAL
.
          COMPARE  ZERO,APMAPOT
          GOTO     DAPMA925 IF NOT EQUAL
.
DAPMA100  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DAPMA110,DAPMA900,DAPMA910
.
DAPMA110  MOVE     TWO,EXIT
          MOVE     APMACRD,KEY5
          CALL     RAAPMA1
          IF       OVRCD=0
            CALL     DAAPMA00   * Delete Before Audit
            MOVE     FOUR,AUDTTYPE
            CALL     WAAPMA00   * Write Audit Record
            CALL     DEAPMA1
          ENDIF
          PACK     KEY35,APMACRD,SP70
          CALL     RSAPMX2
.
DAPMA200  CALL     RKAPMX2
          BRANCH   OVRCD,DAPMA290
          MATCH    APMXCRD,APMACRD
          GOTO     DAPMA290 IF NOT EQUAL
          PACK     KEY35,APMXCRD,APMXREF
          CALL     DEAPMX2
          GOTO     DAPMA200
.
.
DAPMA290  PACK      KEY8,APMACRD,SP70
          CALL      RSAPCN1
.
DAPMA300  CALL      RKAPCN1
          BRANCH    OVRCD,DAPMA390
          MATCH     APMACRD,APCNCRD
          GOTO      DAPMA390 IF NOT EQUAL
          PACK      KEY8,APCNCRD,APCNLIN
          CALL      DEAPCN1
          GOTO      DAPMA300
.
DAPMA390  PACK      KEY8,APMACRD,SP70
          CALL      RSAPSN1
.
DAPMA400  CALL      RKAPSN1
          BRANCH    OVRCD,DAPMA999
          MATCH     APMACRD,APSNCRD
          GOTO      DAPMA999 IF NOT EQUAL
          PACK      KEY8,APSNCRD,APSNLIN
          CALL      DEAPSN1
          GOTO      DAPMA400
.
DAPMA900  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DAPMA999
.
DAPMA910  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DAPMA999
.
DAPMA920  BEEP
          MOVE     "Transactions Exist for Creditor - ",DISPMSG
          CALL     MESSAGE1
          MOVE     ONE,EXIT
          GOTO     DAPMA999
.
DAPMA925  BEEP
          MOVE     "Balance at Last Purge Exists for Creditor - ",DISPMSG
          CALL     MESSAGE1
          MOVE     ONE,EXIT
          GOTO     DAPMA999
.
DAPMA999  RETURN
.
.--------------------------------------------------
. Hold Orders
.--------------------------------------------------
HORD0000  MOVE      "NY",KEY2
          MOVE      SP70,YESNO
          MOVE      "N",ANS                      * get default
          KEYIN     *PCCOL:CVERT,*DV,ANS,"   ":  * read in description
                    *PCCOL:CVERT,*V2LON,*RV,ANS;
          REP       UPPLOW,ANS
          SCAN      ANS,KEY2
          IF        @EQUAL
            MOVEFPTR  KEY2,FYESNO
            LOAD      YESNO,FYESNO,NO,YES
            SUB       ONE,FYESNO
            DISPLAY   *PCCOL:CVERT,*V2LON,YESNO
          ELSE
            MOVE      ZERO,FYESNO
            MOVE      NO,YESNO
          ENDIF
          MOVE      FYESNO,APMAHOR
          RETURN
.--------------------------------------------------
. Hold Invoices
.--------------------------------------------------
HINV0000  MOVE      "NY",KEY2
          MOVE      SP70,YESNO
          MOVE      "N",ANS                 * get default
          KEYIN     *PCCOL:CVERT,*DV,ANS,"   ":  * read in description
                    *PCCOL:CVERT,*V2LON,*RV,ANS;
          REP       UPPLOW,ANS
          SCAN      ANS,KEY2
          IF        @EQUAL
            MOVEFPTR  KEY2,FYESNO
            LOAD      YESNO,FYESNO,NO,YES
            SUB       ONE,FYESNO
            DISPLAY   *PCCOL:CVERT,*V2LON,YESNO
          ELSE
            MOVE      ZERO,FYESNO
            MOVE      NO,YESNO
          ENDIF
          MOVE      FYESNO,APMAHIN
          RETURN
.--------------------------------------------------
. Hold Credits
.--------------------------------------------------
HCRD0000  MOVE      "NY",KEY2
          MOVE      SP70,YESNO
          MOVE      "N",ANS                 * get default
          KEYIN     *PCCOL:CVERT,*DV,ANS,"   ":  * read in description
                    *PCCOL:CVERT,*V2LON,*RV,ANS;
          REP       UPPLOW,ANS
          SCAN      ANS,KEY2
          IF        @EQUAL
            MOVEFPTR  KEY2,FYESNO
            LOAD      YESNO,FYESNO,NO,YES
            SUB       ONE,FYESNO
            DISPLAY   *PCCOL:CVERT,*V2LON,YESNO
          ELSE
            MOVE      ZERO,FYESNO
            MOVE      NO,YESNO
          ENDIF
          MOVE      FYESNO,APMAHCR
          RETURN
.--------------------------------------------------
. Hold Payments
.--------------------------------------------------
HPAY0000  MOVE      "NY",KEY2
          MOVE      SP70,YESNO
          MOVE      "N",ANS                 * get default
          KEYIN     *PCCOL:CVERT,*DV,ANS,"   ":  * read in description
                    *PCCOL:CVERT,*V2LON,*RV,ANS;
          REP       UPPLOW,ANS
          SCAN      ANS,KEY2
          IF        @EQUAL
            MOVEFPTR  KEY2,FYESNO
            LOAD      YESNO,FYESNO,NO,YES
            SUB       ONE,FYESNO
            DISPLAY   *PCCOL:CVERT,*V2LON,YESNO
          ELSE
            MOVE      ZERO,FYESNO
            MOVE      NO,YESNO
          ENDIF
          MOVE      FYESNO,APMAHPY
          RETURN
.----------------------------------------------------------------------
. Keyin City
.----------------------------------------------------------------------
KCITY000
          PACK      APMACA3,APMACA3,SP70
          UNPACK    APMACA3,DIMCITY,ANS,DIMSTAT
.
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,DIMCITY
          PACK      DIMCITY,DIMCITY,SP70
.
          PACK      APMACA3,DIMCITY,SP1,DIMSTAT,SP70
.
          MATCH     EXITCHAR,DIMCITY   * exitchar entered ?
          GOTO      KCITY970 IF EQUAL
.
          MATCH     SP70,DIMCITY       * nothing entered ?
          GOTO      KCITY950 IF EQUAL
.
KCITY900  MOVE      ZERO,EXIT
          GOTO      KCITY999
.
KCITY950  MOVE      ONE,EXIT
          GOTO      KCITY999
.
KCITY970  MOVE      TWO,EXIT
.
KCITY999  RETURN
.----------------------------------------------------------------------
. Keyin State
.----------------------------------------------------------------------
KSTAT000
          PACK      APMACA3,APMACA3,SP70
          UNPACK    APMACA3,DIMCITY,ANS,DIMSTAT
.
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,DIMSTAT
          PACK      DIMSTAT,DIMSTAT,SP70
.
          PACK      APMACA3,DIMCITY,SP1,DIMSTAT,SP70
.
          MATCH     EXITCHAR,DIMSTAT   * exitchar entered ?
          GOTO      KSTAT970 IF EQUAL
.
          MATCH     SP70,DIMSTAT       * nothing entered ?
          GOTO      KSTAT950 IF EQUAL
.
KSTAT900  MOVE      ZERO,EXIT
          GOTO      KSTAT999
.
KSTAT950  MOVE      ONE,EXIT
          GOTO      KSTAT999
.
KSTAT970  MOVE      TWO,EXIT
.
KSTAT999  RETURN
.----------------------------------------------------------------------
. Enter Payment Generation Method
.----------------------------------------------------------------------
EPMET000   CALL      DPMET000
           MOVE      ZERO,APMAGMT
EPMET001   KEYIN     *PCCOL:CVERT,*V2LON,*RV,APMAGMT
           COMPARE   ZERO,APMAGMT
           GOTO      EPMET900 IF EQUAL
           BRANCH    APMAGMT,EPMET010,EPMET020,EPMET030
           BEEP
           GOTO      EPMET001
.
EPMET010   MOVE      "Direct Dr (w Advice)",PMETDES
           GOTO      EPMET999
.                     xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
EPMET020   MOVE      "Direct Dr (w Advice if>1 Inv.)",PMETDES
           GOTO      EPMET999
.
EPMET030   MOVE      "Direct Dr (w/o Advice)",PMETDES
           GOTO      EPMET999
.
EPMET900   MOVE      "Cheque",PMETDES
           GOTO      EPMET999
.
EPMET999   CALL      PUTSCR00
           RETURN
.------------------------------------------------------------
. Display Options
.------------------------------------------------------------
DPMET000  MOVE      "13",HTOP
          MOVE      "40",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P45:14,*V2LON,*ULON,"Payment Method",*HOFF:
                    *P42:15,*V2LON,"0. ",*HOFF,"Cheque":
                    *P42:16,*V2LON,"1. ",*HOFF,"Direct Dr (w Advice)":
                    *P42:17,*V2LON,"2. ",*HOFF,"Direct Dr (w Advice if Inv >1)":
                    *P42:18,*V2LON,"3. ",*HOFF,"Direct Dr (w/o Advice)"
          RETURN
.
.----------------------------------------------------------------------
. Determine Insert Mode
.----------------------------------------------------------------------
AP10A000   MOVE     APMACRD,KEY5
           CALL     RAAPMA1
           MOVE     OVRCD,ACCEPT
           RETURN
.----------------------------------------------------------------------
. Keyin Supplier Address Line 2
.----------------------------------------------------------------------
KAPSA100  MATCH     SP70,APMASA1
          IF        @EQUAL
            MOVE      APMACA1,APMASA1
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,APMASA1
          MOVE      ZERO,EXIT
          CMATCH    EXITCHAR,APMASA1
          IF        @EQUAL
            MOVE      TWO,EXIT
          ENDIF
          RETURN
.
.----------------------------------------------------------------------
. Keyin Supplier Address Line 2
.----------------------------------------------------------------------
KAPSA200  MATCH     SP70,APMASA2
          IF        @EQUAL
            MOVE      APMACA2,APMASA2
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,APMASA2
          MOVE      ZERO,EXIT
          CMATCH    EXITCHAR,APMASA2
          GOTO      KAPSA290 IF EQUAL
.
          MOVE      TWO,SUBKYLIN
          PACK      IBAADLN2,APMASA2,SP30,SP30
          PACK      IBAADLN3,APMASA3,SP30,SP30
          PROC      AUTOPCOD
          BRANCH    EXIT,KAPSA200,KAPSA250
.
          MOVE      IBAPCOD,APMASPC
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASPC,VAR
            CALL      DISPITEM
          ENDIF
          MOVE      "    5",FLDID
          CALL      GETPOSIT
KAPSA250  MOVE      ZERO,EXIT
          GOTO      KAPSA299
.
KAPSA290  MOVE      TWO,EXIT
.
KAPSA299  RETURN
.
.----------------------------------------------------------------------
. Keyin Supplier Address Line 3
.----------------------------------------------------------------------
KAPSA300  MATCH     SP70,APMASA3
          IF        @EQUAL
            MOVE      APMACA3,APMASA3
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,APMASA3
          MOVE      ZERO,EXIT
          CMATCH    EXITCHAR,APMASA3
          GOTO      KAPSA390 IF EQUAL
.
          MOVE      THREE,SUBKYLIN
          RESET     APMASPC
          PACK      IBAADLN2,APMASA2,SP30,SP30
          PACK      IBAADLN3,APMASA3,SP30,SP30
          PACK      APMASPC,APMASPC,SP70
          PROC      AUTOPCOD
          BRANCH    EXIT,KAPSA300,KAPSA350
.
          MOVE      IBAPCOD,APMASPC
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASPC,VAR
            CALL      DISPITEM
          ENDIF
          MOVE      "    6",FLDID
          CALL      GETPOSIT
KAPSA350  MOVE      ZERO,EXIT
          GOTO      KAPSA399
.
KAPSA390  MOVE      TWO,EXIT
.
KAPSA399  RETURN
.
.----------------------------------------------------------------------
. Keyin Supplier Post Code
.----------------------------------------------------------------------
KAPSPC00  MATCH     SP70,APMASPC
          IF        @EQUAL
            MOVE      APMACPC,APMASPC
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,APMASPC
          MOVE      ZERO,EXIT
          CMATCH    EXITCHAR,APMASPC
          IF        @EQUAL
            MOVE      TWO,EXIT
          ENDIF
          RETURN
.
.----------------------------------------------------------------------
. Keyin Supplier Telephone
.----------------------------------------------------------------------
KAPSTE00  MATCH     SP70,APMASTEL
          IF        @EQUAL
            MOVE      APMACTEL,APMASTEL
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,APMASTEL
          MOVE      ZERO,EXIT
          CMATCH    EXITCHAR,APMASTEL
          IF        @EQUAL
            MOVE      TWO,EXIT
          ENDIF
          RETURN
.
.----------------------------------------------------------------------
. Keyin Supplier Fax
.----------------------------------------------------------------------
KAPSFA00  MATCH     SP70,APMASFAX
          IF        @EQUAL
            MOVE      APMACFAX,APMASFAX
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,APMASFAX
          MOVE      ZERO,EXIT
          CMATCH    EXITCHAR,APMASFAX
          IF        @EQUAL
            MOVE      TWO,EXIT
          ENDIF
          RETURN
.
.----------------------------------------------------------------------
. Keyin Supplier Contact
.----------------------------------------------------------------------
KAPSCO00  MATCH     SP70,APMASCON
          IF        @EQUAL
            MOVE      APMACON,APMASCON
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,APMASCON
          MOVE      ZERO,EXIT
          CMATCH    EXITCHAR,APMASCON
          IF        @EQUAL
            MOVE      TWO,EXIT
          ENDIF
          RETURN
.
.----------------------------------------------------------------------
. Keyin Supplier Name 1
.----------------------------------------------------------------------
KAPSN100  MATCH     SP70,APMASN1
          IF        @EQUAL
            MOVE      APMACN1,APMASN1
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,APMASN1
          MOVE      ZERO,EXIT
          CMATCH    EXITCHAR,APMASN1
          IF        @EQUAL
            MOVE      TWO,EXIT
          ENDIF
          RETURN
.
.----------------------------------------------------------------------
. Keyin Supplier Name 2
.----------------------------------------------------------------------
KAPSN200  MATCH     SP70,APMASN2
          IF        @EQUAL
            MOVE      APMACN2,APMASN2
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,APMASN2
          MOVE      ZERO,EXIT
          CMATCH    EXITCHAR,APMASN2
          IF        @EQUAL
            MOVE      TWO,EXIT
          ENDIF
          RETURN
.
.----------------------------------------------------------------------
. Post Creditor Details
.----------------------------------------------------------------------
WAPMA000  MOVE     "00",SCRID
          MOVE     "   52",FLDID
          CALL     GETPOSIT
          IF       EXIT=0
            UNPACK   NZBANKAC,APMABSB,APMABAC
          ENDIF
          MOVE     "01",SCRID
.
          MOVE     APMACRD,KEY5
          CALL     RAAPMA1
          IF       OVRCD=0
            CALL     UPAPMA1
            CALL     UUAPMA1
            MOVE     THREE,AUDTTYPE
            CALL     WAAPMA00
          ELSE
            MOVE     ZERO,APMAPPT
            MOVE     ZERO,APMAPOT
            CALL     WRAPMA1
            MOVE     ONE,AUDTTYPE
            CALL     WAAPMA00
          ENDIF
          PACK     KEY35,APMACRD,SP70
          CALL     RSAPMX2
.
WAPMA400  CALL     RKAPMX2
          BRANCH   OVRCD,WAPMA500
          MATCH    APMXCRD,APMACRD
          GOTO     WAPMA500 IF NOT EQUAL
          MATCH    "1",APMXTYP
          IF       @EQUAL
            PACK     KEY35,APMXCRD,APMXREF
            CALL     DEAPMX2
          ENDIF
          MATCH    "2",APMXTYP
          IF       @EQUAL
            PACK     KEY35,APMXCRD,APMXREF
            CALL     DEAPMX2
          ENDIF
          GOTO     WAPMA400
.
WAPMA500  MOVE     APMACRD,APMXCRD
          MOVE     APMACN1,APMXREF
          MOVE     ONE,APMXTYP
          MOVE     SP70,APMXSPA
          PACK     KEY35,APMXCRD,APMXREF
          MATCH    SP70,APMXREF
          GOTO     WAPMA510 IF EQUAL
          CALL     RAAPMX2
          IF       OVRCD=1
            CALL     WRAPMX2
          ENDIF
.
WAPMA510  MOVE     APMACRD,APMXCRD
          MOVE     APMASN1,APMXREF
          MOVE     TWO,APMXTYP
          MOVE     SP70,APMXSPA
          PACK     KEY35,APMXCRD,APMXREF
          MATCH    SP70,APMXREF
          GOTO     WAPMA520 IF EQUAL
          CALL     RAAPMX2
          IF       OVRCD=1
            CALL     WRAPMX2
          ENDIF
.
WAPMA520  PROC      APSCKIUP
.
          PACK      KEY8,APMACRD,SP70
          CALL      RSAPCN1
.
WAPMA800  CALL      RKAPCN1
          BRANCH    OVRCD,WAPMA850
          MATCH     APMACRD,APCNCRD
          GOTO      WAPMA850 IF NOT EQUAL
          PACK      KEY8,APCNCRD,APCNLIN
          CALL      DEAPCN1
          GOTO      WAPMA800
.
WAPMA850  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPCN1
          TRAPCLR   IO
          BRANCH    OVRCD,WAPMA890
          MOVE      ZERO,F3
.
WAPMA860  READ      TEMPWORD,SEQ;APCNDAT
          GOTO      WAPMA890 IF OVER
          MOVE      F3,APCNLIN
          PACK      KEY21,APMACRD,APCNLIN
          UNPACK    KEY21,APCNCRD,APCNLIN
          CALL      WRAPCN1
          ADD       ONE,F3
          GOTO      WAPMA860
.
WAPMA890  PACK      KEY8,APMACRD,SP70
          CALL      RSAPSN1
.
WAPMA900  CALL      RKAPSN1
          BRANCH    OVRCD,WAPMA950
          MATCH     APMACRD,APSNCRD
          GOTO      WAPMA950 IF NOT EQUAL
          PACK      KEY8,APSNCRD,APSNLIN
          CALL      DEAPSN1
          GOTO      WAPMA900
.
WAPMA950  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPSN1
          TRAPCLR   IO
          BRANCH    OVRCD,WAPMA999
          MOVE      ZERO,F3
.
WAPMA960  READ      TEMPWORD,SEQ;APSNDAT
          GOTO      WAPMA999 IF OVER
          MOVE      F3,APSNLIN
          PACK      KEY21,APMACRD,APSNLIN
          UNPACK    KEY21,APSNCRD,APSNLIN
          CALL      WRAPSN1
          ADD       ONE,F3
          GOTO      WAPMA960
.
WAPMA999  RETURN
.
.----------------------------------------------------------------------
. Clear Cross Reference Field
.----------------------------------------------------------------------
MAPMX000  MOVE     SP70,APMXREF
          RETURN
.
.----------------------------------------------------------------------
. Write Cross Reference Field
.----------------------------------------------------------------------
WAPMX000  PACK      KEY35,APMACRD,SP70
          CALL      RDAPMX2
          IF        OVRCD=0
            PACK      KEY35,APMXCRD,APMXREF
            CALL      DEAPMX2
          ENDIF
.
WAPMX100  CALL      RKAPMX2
          BRANCH    OVRCD,WAPMX200
          MATCH     APMACRD,APMXCRD
          GOTO      WAPMX200 IF NOT EQUAL
          MATCH     "1",APMXTYP
          GOTO      WAPMX100 IF EQUAL
          MATCH     "2",APMXTYP
          GOTO      WAPMX100 IF EQUAL
          PACK      KEY35,APMXCRD,APMXREF
          CALL      DEAPMX2
          GOTO      WAPMX100
.
WAPMX200  MOVE      SP70,KEY5
          CALL      TRAPMX21
          COMPARE   ZERO,OVRCD
          GOTO      WAPMX310 IF EQUAL
.
WAPMX300  CALL      TKAPMX21
          BRANCH    OVRCD,WAPMX400
.
WAPMX310  PACK      KEY35,APMACRD,APMXREF
          UNPACK    KEY35,APMXCRD,APMXREF
          MOVE      THREE,APMXTYP
          MATCH     SP70,APMXREF
          GOTO      WAPMX300 IF EQUAL
          CALL      RAAPMX2
          IF        OVRCD=1
            CALL      WRAPMX2
          ENDIF
          GOTO      WAPMX300
.
WAPMX400  PROC      APSCKIUP
.
WAPMX999  RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSCKIKY    
          INC       APSCKIPR    
          INC       APSCNTIO/INC
          INC       APSCTSIO/INC
          INC       APSCTSKY    
          INC       APSIMSIO/INC
          INC       APSMASIO/INC
          INC       APSMASKY    
          INC       APSMXRIO/INC
          INC       APSPPDIO/INC
          INC       APSPPDKY    
          INC       APSSNTIO/INC
          INC       AUTOPCOD    
          INC       FMSCODIO/INC
          INC       IBASEQIO/INC
          INC       TFILENAM    
          INC       WEBERRIO/INC
.
          INC       STDGENCD
.
