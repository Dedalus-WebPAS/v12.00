.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  03.06.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. V6.03.02  30.10.1995 B.G.Ackland
.           Phase 1 WGH Changes
. V6.03.01  10.10.1995 B.G.Ackland
.           Recompiled for Change to CEASTR & CEAPSC
. V6.03.00  02.10.1995 B.G.Ackland
.           Release 6.03
.-------------------------------------------------------
. V6.01.03  04.09.1995 B.G.Ackland
.           Fixed Summary Routine
. V6.01.02  12.12.1994 B.G.Ackland
.           Add IBA GL Interface
. V6.01.01  16.03.1994 B.G.Ackland
.           Add All Period Option
.-------------------------------------------------------
ACTUAL    FORM      12.2
BUDGET    FORM      12.2
ENDDAT    DIM       8
LOADFILE  FILE      ASCII, FIXED=350
SAVEPER   DIM       2
SAVEYEAR  DIM       4
STRDAT    DIM       8
TMPPER    DIM       2
TMPYEAR   DIM       4
TOTAL1    FORM      12.2
TOTAL2    FORM      12.2
TOTAL3    FORM      12.2
TOTAL4    FORM      12.2
TOTAL5    FORM      12.2
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACEA09
.   Function      :   Process Service Summary                 
.   Generated  On :   03/06/2002
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CEAPAAFD/INC
          INC       CEAPBAFD/INC
          INC       CEAPERFD/INC
          INC       CEAPSCFD/INC
          INC       CEASAAFD/INC
          INC       CEASPCFD/INC
          INC       CEASTRFD/INC
          INC       FMSAMAFD/INC
          INC       FMSBTYFD/INC
          INC       FMSBUDFD/INC
          INC       FMSFPSFD/INC
          INC       FMSSBUFD/INC
          INC       FMSSMAFD/INC
.=========================
.Local Variable Definition
.-------------------------
ALLPERD   FORM      1 * Scr 01 Fld     8
LOADNAME  DIM      40 * Scr 02 Fld     4
LOADACT   FORM      1 * Scr 02 Fld     5
LOADBUD   FORM      1 * Scr 02 Fld     6
FINYEAR   DIM       4 * Scr 03 Fld     4
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACEA09"
PRGNAM    INIT      "Process Service Summary                 "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   64",AUDTSECT
          MOVE      " 39",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ceaaudps";
            OPEN      CEAAUDPS,"ceaaudps"
          ENDIF
          MOVE      "   64",AUDTSECT
          MOVE      " 40",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ceaaudst";
            OPEN      CEAAUDST,"ceaaudst"
          ENDIF
          DISPLAY   *P56:24,"Opening ceapaaaf";
          OPEN      CEAPAAA1,"ceapaaaf"
          DISPLAY   *P56:24,"Opening ceapbaaf";
          OPEN      CEAPBAA1,"ceapbaaf"
          DISPLAY   *P56:24,"Opening ceaperaf";
          OPEN      CEAPERA1,"ceaperaf"
          DISPLAY   *P56:24,"Opening ceaperaf";
          OPEN      CEAPERA2,"ceaperaf"
          DISPLAY   *P56:24,"Opening ceapscaf";
          OPEN      CEAPSCA1,"ceapscaf"
          DISPLAY   *P56:24,"Opening ceasaaaf";
          OPEN      CEASAAA1,"ceasaaaf"
          DISPLAY   *P56:24,"Opening ceaspcaf";
          OPEN      CEASPCA1,"ceaspcaf"
          DISPLAY   *P56:24,"Opening ceastraf";
          OPEN      CEASTRA1,"ceastraf"
          DISPLAY   *P56:24,"Opening ceastraf";
          OPEN      CEASTRA2,"ceastraf"
          DISPLAY   *P56:24,"Opening ceastraf";
          OPEN      CEASTRA3,"ceastraf"
          DISPLAY   *P56:24,"Opening ceastraf";
          OPEN      CEASTRA4,"ceastraf"
          DISPLAY   *P56:24,"Opening ceastraf";
          OPEN      CEASTRA5,"ceastraf"
          MOVE      "   51",AUDTSECT
          MOVE      " 49",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening fmsaudbu";
            OPEN      FMSAUDBU,"fmsaudbu"
          ENDIF
          DISPLAY   *P56:24,"Opening fmsbudaf";
          OPEN      FMSBUDA1,"fmsbudaf"
          DISPLAY   *P56:24,"Opening fmsbudaf";
          OPEN      FMSBUDA2,"fmsbudaf"
          DISPLAY   *P56:24,"Opening fmsbudaf";
          OPEN      FMSBUDA3,"fmsbudaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Selections                         
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Generate Period Analysis Details   
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Load General Ledger Details        
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Load IBA GL Details                
          ENDIF
          RETURN
.--------------------------------
. Screen - Selections                         
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Selections                         
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Selections                         
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Selections                         
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Selections                         
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Selections                         
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Selections                         
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Selections                         
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Generate Period Analysis Details   
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
          CALL      MVACCEPT
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Generate Period Analysis Details   
.-------------------------------------------------------
CF01L000
          MOVE      SP70,CEPEYEAR
          MOVE      SP70,CEPEPER 
          MOVE      SP70,CEPEDES 
          MOVE      SP70,CEPEEND 
          MOVE      ZERO,ALLPERD 
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Generate Period Analysis Details   
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Generate Period Analysis Details   
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Generate Period Analysis Details   
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Generate Period Analysis Details   
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Generate Period Analysis Details   
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L101:
                            PS01L102,PS01L103,PS01L104,PS01L105
          GOTO     PS01L999
.
PS01L101
          MOVE      CEPEYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      CEPEPER,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      CEPEDES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          UNPACK    CEPEEND,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      ALLPERD,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Generate Period Analysis Details   
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L104,SF01L006,SF01L006,SF01L105
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L103:
                            SF01L104,SF01L020,SF01L020,SF01L105
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GENB0000
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF01L000
          GOTO      SF01L001
.
SF01L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KYEAR000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L103
            ENDIF
            BRANCH    EXIT,SF01L103,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      CEPEYEAR,VAR     
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L104
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CEPEDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CEPEEND 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCEPEA00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L104
            ENDIF
            BRANCH    EXIT,SF01L104,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      CEPEPER,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CEPEDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            UNPACK    CEPEEND,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L105
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,ALLPERD 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      ALLPERD,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Load General Ledger Details        
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
          CALL      MVACCEPT
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Load General Ledger Details        
.-------------------------------------------------------
CF02L000
          MOVE      SP70,LOADNAME
          MOVE      ZERO,LOADACT 
          MOVE      ZERO,LOADBUD 
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Load General Ledger Details        
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Load General Ledger Details        
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Load General Ledger Details        
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Load General Ledger Details        
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Load General Ledger Details        
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L101:
                            PS02L102,PS02L103
          GOTO     PS02L999
.
PS02L101
          MOVE      LOADNAME,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LOADACT,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LOADBUD,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Load General Ledger Details        
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102,SF02L103:
                            SF02L104,SF02L105
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L103:
                            SF02L104,SF02L105
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L102
          CALL      LOAD0000
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L103
          CALL     SELECTED
          STRIP     LOADNAME
          SFORMAT   VAR,SCPSLEN
          MOVE      LOADNAME,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,LOADNAME
          SFORMAT   VAR,127
          ENDSET    LOADNAME
          APPEND    SP70,LOADNAME
          RESET     LOADNAME
          CMATCH    EXITCHAR,LOADNAME
          GOTO      SF02L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,LOADNAME
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L103
            ENDIF
          ENDIF
          MOVE      LOADNAME,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L104
          CALL      DEFAULTY
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,LOADACT 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LOADACT,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L105
          CALL      DEFAULTY
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,LOADBUD 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LOADBUD,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Load IBA GL Details                
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
          CALL      MVACCEPT
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Load IBA GL Details                
.-------------------------------------------------------
CF03L000
          MOVE      SP70,FINYEAR 
          MOVE      SP70,FMBTCODE
          MOVE      SP70,FMBTDESC
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Load IBA GL Details                
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Load IBA GL Details                
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Load IBA GL Details                
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Load IBA GL Details                
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Load IBA GL Details                
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L101:
                            PS03L102,PS03L103
          GOTO     PS03L999
.
PS03L101
          MOVE      FINYEAR,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      FMBTCODE,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      FMBTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Load IBA GL Details                
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L103:
                            SF03L104,SF03L006
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L103:
                            SF03L104,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L102
          CALL      IBGL0000
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EYEAR000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L103
            ENDIF
            BRANCH    EXIT,SF03L103,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      FINYEAR,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L104
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FMBTDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EBUDT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L104
            ENDIF
            BRANCH    EXIT,SF03L104,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      FMBTCODE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMBTDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.@@@@@ Function Restart Point @@@@@
.----------------------------------------
. Move one to accept to for insert mode
.----------------------------------------
MVACCEPT  MOVE      ONE,ACCEPT
          RETURN
DEFAULTN    MOVE     ANSN,DEFYESNO
            RETURN
.-------------------------------------------------------------
. Generate Service Analysis Details
.-------------------------------------------------------------
GENB0000  COMPARE   ZERO,ALLPERD      * One Period Only
          GOTO      GENB8000 IF EQUAL * Yes
.
          MOVE      CEPEYEAR,SAVEYEAR
          PACK      KEY6,CEPEYEAR,SP70
          CALL      RSCEPE1
GENB1000  CALL      RKCEPE1
          BRANCH    OVRCD,GENB9999
          MATCH     SAVEYEAR,CEPEYEAR
          GOTO      GENB9999 IF NOT EQUAL
          MOVE      CEPEPER,SAVEPER
          CALL      PROC0000
          PACK      KEY6,SAVEYEAR,SAVEPER
          CALL      RDCEPE1
          GOTO      GENB1000
.
GENB8000  CALL      PROC0000
.
GENB9999  BEEP
          MOVE      "Complete - ",DISPMSG
          CALL      MESSAGE1
          RETURN
.-------------------------------------------------------------
. Generate Service Analysis Details
.-------------------------------------------------------------
PROC0000  PACK      KEY6,CEPEYEAR,CEPEPER
          CALL      RDCEPE1
          BRANCH    OVRCD,PROC9100
          MOVE      CEPEEND,ENDDAT
          MOVE      CEPEYEAR,TMPYEAR
          MOVE      CEPEPER,TMPPER
          DISPLAY   *P1:24,*EL,"Processing Period ",TMPPER,"/",TMPYEAR
          PACK      KEY14,CEPEEND,CEPEYEAR,CEPEPER
          CALL      RDCEPE2             * Position via Period Ending Date
          BRANCH    OVRCD,PROC9100
          CALL      RPCEPE2             * Read Previous Record for Start Date
          IF        OVRCD=1
            MOVE      SP70,STRDAT
          ELSE
            MOVE      CEPEEND,STRDAT
          ENDIF
.
          CALL      CLEAR000         * Clear Summaries
.
          CALL      SUMA0000         * Summarise
.
          GOTO      PROC9999
.
PROC9100  MOVE      "Invalid Period - ",DISPMSG
          CALL      MESSAGE1
.
PROC9999  RETURN                      * Return to program.
.----------------------------------------------------------------------
. Summarize Detail
.----------------------------------------------------------------------
SUMA0000  DISPLAY   *P1:24,*EL,"Creating Summary for Period ":
                    TMPPER,"/",TMPYEAR
          PACK      KEY3,SP70
          CALL      RSCESP1
SUMA1000  CALL      RKCESP1
          BRANCH    OVRCD,SUMA9000
          DISPLAY   *P40:24,CESPSPC
          MOVE      ZERO,TOTAL1
          MOVE      ZERO,TOTAL2
          MOVE      ZERO,TOTAL3
          MOVE      ZERO,TOTAL4
          MOVE      ZERO,TOTAL5
          PACK      KEY20,CESPSPC,STRDAT,Z70
          CALL      RSCEST4
SUMA1100  CALL      RKCEST4
          BRANCH    OVRCD,SUMA1190
          MATCH     CESTSPC,CESPSPC
          GOTO      SUMA1190 IF NOT EQUAL
          MATCH     CESTDAT,ENDDAT
          GOTO      SUMA1190 IF LESS
.
          CALL      ADTOT000     * Calculate Totals for Service Providers
.
          CALL      PATSER00     * Add to Patient Service Summary Files
.
          GOTO      SUMA1100
.
SUMA1190  CALL      SERPRO00     * Post Service Provider Summary
          GOTO      SUMA1000
.
SUMA9000  PACK      KEY6,TMPYEAR,TMPPER
          CALL      RDCEPE1
          CALL      RKCEPE1
          RETURN
.------------------------------------------------------------
. Add Service Provider Totals
.------------------------------------------------------------
ADTOT000  ASSIGN    TOTAL1+(CESTST1*CESTQTY),TOTAL1
          ASSIGN    TOTAL2+(CESTST2*CESTQTY),TOTAL2
          ASSIGN    TOTAL3+(CESTST3*CESTQTY),TOTAL3
          ASSIGN    TOTAL4+(CESTST4*CESTQTY),TOTAL4
          ASSIGN    TOTAL5+(CESTST5*CESTQTY),TOTAL5
          RETURN
.------------------------------------------------------------
. Post Service Provider Summary
.------------------------------------------------------------
SERPRO00  PACK      KEY9,CESPSPC,TMPYEAR,TMPPER
          CALL      RDCESA1
          IF        OVRCD=0
            MOVE      TOTAL1,CESACST1
            MOVE      TOTAL2,CESACST2
            MOVE      TOTAL3,CESACST3
            MOVE      TOTAL4,CESACST4
            MOVE      TOTAL5,CESACST5
            CALL      UPCESA1
          ELSE
            MOVE      TOTAL1,CESACST1
            MOVE      TOTAL2,CESACST2
            MOVE      TOTAL3,CESACST3
            MOVE      TOTAL4,CESACST4
            MOVE      TOTAL5,CESACST5
            MOVE      ZERO,CESAGLA
            MOVE      ZERO,CESAGLB
            MOVE      SP70,CESASPA
            UNPACK    KEY9,CESASPC,CESAYEAR,CESAPER
            CALL      WRCESA1
          ENDIF
          RETURN
.------------------------------------------------------------
. Add to Patient Services Summary
.------------------------------------------------------------
PATSER00  PACK      KEY16,CESTSPC,CESTPSC,TMPYEAR,TMPPER
          CALL      RDCEPA1
          IF        OVRCD=0
            ADD       CESTQTY,CEPAQTY
            ASSIGN    CEPACST1+(CESTST1*CESTQTY),CEPACST1
            ASSIGN    CEPACST2+(CESTST2*CESTQTY),CEPACST2
            ASSIGN    CEPACST3+(CESTST3*CESTQTY),CEPACST3
            ASSIGN    CEPACST4+(CESTST4*CESTQTY),CEPACST4
            ASSIGN    CEPACST5+(CESTST5*CESTQTY),CEPACST5
            CALL      UPCEPA1
          ELSE
            UNPACK    KEY16,CEPASPC,CEPAPSC,CEPAYEAR,CEPAPER
            MOVE      CESTQTY,CEPAQTY
            ASSIGN    (CESTST1*CESTQTY),CEPACST1
            ASSIGN    (CESTST2*CESTQTY),CEPACST2
            ASSIGN    (CESTST3*CESTQTY),CEPACST3
            ASSIGN    (CESTST4*CESTQTY),CEPACST4
            ASSIGN    (CESTST5*CESTQTY),CEPACST5
            CALL      WRCEPA1
          ENDIF
.
          PACK      KEY13,CESTPSC,TMPYEAR,TMPPER
          CALL      RDCEPB1
          IF        OVRCD=0
            ADD       CESTQTY,CEPBQTY
            ASSIGN    CEPBCST1+(CESTST1*CESTQTY),CEPBCST1
            ASSIGN    CEPBCST2+(CESTST2*CESTQTY),CEPBCST2
            ASSIGN    CEPBCST3+(CESTST3*CESTQTY),CEPBCST3
            ASSIGN    CEPBCST4+(CESTST4*CESTQTY),CEPBCST4
            ASSIGN    CEPBCST5+(CESTST5*CESTQTY),CEPBCST5
            CALL      UPCEPB1
          ELSE
            UNPACK    KEY13,CEPBPSC,CEPBYEAR,CEPBPER
            MOVE      CESTQTY,CEPBQTY
            ASSIGN    (CESTST1*CESTQTY),CEPBCST1
            ASSIGN    (CESTST2*CESTQTY),CEPBCST2
            ASSIGN    (CESTST3*CESTQTY),CEPBCST3
            ASSIGN    (CESTST4*CESTQTY),CEPBCST4
            ASSIGN    (CESTST5*CESTQTY),CEPBCST5
            CALL      WRCEPB1
          ENDIF
.
          RETURN
.------------------------------------------------------------
. Clear Summary Files for Period
.------------------------------------------------------------
CLEAR000  PACK     KEY7,SP70
          DISPLAY   *P1:24,*EL,"Clearing Summary Period ",TMPPER,"/",TMPYEAR
          CALL     RSCEPS1
CLEAR100  CALL     RKCEPS1
          BRANCH   OVRCD,CLEAR900
          PACK     KEY13,CEPSPSC,TMPYEAR,TMPPER
          CALL     RDCEPB1
          IF       OVRCD=0
            CALL     DECEPB1
          ENDIF
          PACK     KEY3,SP70
          CALL     RSCESP1
CLEAR200  CALL     RKCESP1
          BRANCH   OVRCD,CLEAR100
          PACK     KEY16,CESPSPC,CEPSPSC,TMPYEAR,TMPPER
          CALL     RDCEPA1
          IF       OVRCD=0
            CALL     DECEPA1
          ENDIF
          GOTO     CLEAR200
CLEAR900  RETURN
.-------------------------------------------------------------
. Enter Year
.-------------------------------------------------------------
KYEAR000  MOVE       CYY,CYEAR
          MOVE       CCC,CCENT
          PACK       C4YEAR WITH CCENT,CYEAR
          KEYIN      *PCCOL:CVERT,*V2LON,*DE,*JR,C4YEAR;
          RESET      C4YEAR
          GOTO       KYEAR900 IF EOS
.
          UNPACK     C4YEAR WITH XCENT,XYEAR
          MATCH      SP2,XCENT
          GOTO       KYEAR100 IF NOT EQUAL
          MOVE       CCENT,XCENT
.
KYEAR100  REP        " 0",XYEAR
          MOVE       XYEAR,IYEAR
          REP        " 0",XCENT
          MOVE       XCENT,ICENT
.
.         Check for a valid year
.
          COMPARE    ZERO,IYEAR
          IF         @LESS
            MOVE       "Invalid Year",DDISPMSG
            CALL       DATEMSGC
            GOTO       KYEAR000
          ENDIF
.
          PACK       CEPEYEAR,XCENT,XYEAR
          MOVE       ZERO,EXIT
          GOTO       KYEAR999
.
KYEAR900  MOVE       ONE,EXIT
          GOTO       KYEAR999
.
KYEAR999  RETURN

DEFAULTY    MOVE     ANSY,DEFYESNO
            RETURN
.----------------------------------------------------------------------
. Load ASCII Interface File
. Interface Format -
. Service Provider Code   Char 3
. Year                    Char 4
. Period                  Char 2
. Actual                  Char 15 format 999999999999.99
. Budget                  Char 15 format 999999999999.99
.----------------------------------------------------------------------
LOAD0000  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      LOADFILE,LOADNAME
          TRAPCLR   IO
          BRANCH    OVRCD,LOAD9100
.
LOAD1000  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      LOADFILE,SEQ;CESASPC,CESAYEAR,CESAPER,CESAGLA,CESAGLB
          GOTO      LOAD1900 IF OVER
          BRANCH    OVRCD,LOAD9200
          GOTO      LOAD1000
.
LOAD1900  OPEN      LOADFILE,LOADNAME    * Start of File
.
LOAD2000  READ      LOADFILE,SEQ;CESASPC,CESAYEAR,CESAPER,ACTUAL,BUDGET
          GOTO      LOAD9900 IF OVER
.
          PACK      KEY9,CESASPC,CESAYEAR,CESAPER
          CALL      RDCESA1              * Get Current Details if Available
          IF        OVRCD=0
            IF        LOADACT=1
              MOVE      ACTUAL,CESAGLA
            ENDIF
            IF        LOADBUD=1
              MOVE      BUDGET,CESAGLB
            ENDIF
            CALL      UPCESA1
          ELSE
            MOVE      ZERO,CESACST1
            MOVE      ZERO,CESACST2
            MOVE      ZERO,CESACST3
            MOVE      ZERO,CESACST4
            MOVE      ZERO,CESACST5
            MOVE      SP70,CESASPA
            IF        LOADACT=1
              MOVE      ACTUAL,CESAGLA
            ENDIF
            IF        LOADBUD=1
              MOVE      BUDGET,CESAGLB
            ENDIF
            CALL      WRCESA1
          ENDIF
.
          GOTO      LOAD2000
.
. Can't Open File
.------------------------
LOAD9100  MOVE      "Unable to Open ASCII File - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          MOVE      "2",EXIT
          GOTO      LOAD9999
.
. Error in Format
.------------------------
LOAD9200  MOVE      "Format Error File - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          MOVE      "2",EXIT
          GOTO      LOAD9999
.
LOAD9900  MOVE      "Load Complete - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          MOVE      "0",EXIT
          GOTO      LOAD9999
.
LOAD9999  RETURN
.
.------------------------------------------------------------
. Extract General Ledger Details
.------------------------------------------------------------
IBGL0000  MATCH    SP70,FINYEAR
          GOTO     IBGL9000 IF EQUAL
.
          PACK     KEY3,SP70
          CALL     RSCESP1
IBGL1000  CALL     RKCESP1
          BRANCH   OVRCD,IBGL9999
          DISPLAY  *P1:24,*EL,"Service Provider : ",CESPSPC
.
          UNPACK   CESPUR1,KEY2,KEY1,KEY12
          PACK     KEY14,KEY2,KEY12,SP70
          CALL     RDFMAM1
          BRANCH   OVRCD,IBGL1000
          MATCH    "8",FMAMTYPE
          GOTO     IBGL1100 IF EQUAL
          MATCH    "9",FMAMTYPE
          GOTO     IBGL1100 IF EQUAL
.
          CALL     FINSUM00
          GOTO     IBGL1000
.
IBGL1100  CALL     STASUM00
          GOTO     IBGL1000
.
IBGL9000  BEEP
          MOVE     "Financial Year Invalid - ",DISPMSG
          CALL     MESSAGE1
          GOTO     IBGL9999
.
IBGL9999  RETURN
.
FINSUM00  UNPACK   CESPUR1,KEY2,KEY1,KEY12
          PACK     KEY14,KEY2,KEY12,SP70
          CALL     RDFMFP1
          BRANCH   OVRCD,FINSUM90
.
          PACK     KEY14,KEY2,KEY12,SP70
          CALL     RDFMBU1
          IF       OVRCD=1
            CALL     CLRBUD00
          ENDIF
          MOVE     ZERO,F2
.
FINSUM10  ADD      ONE,F2               * Hard Coded to 12 Periods
          COMPARE  "13",F2              * If and When we get a 13 period site
          GOTO     FINSUM99 IF EQUAL    * then Fix Program
.
          LOAD     ACTUAL,F2,FMFPA01,FMFPA02,FMFPA03,FMFPA04,FMFPA05:
                             FMFPA06,FMFPA07,FMFPA08,FMFPA09,FMFPA10:
                             FMFPA11,FMFPA12,FMFPA13
.
          LOAD     BUDGET,F2,FMBUCA01,FMBUCA02,FMBUCA03,FMBUCA04,FMBUCA05:
                             FMBUCA06,FMBUCA07,FMBUCA08,FMBUCA09,FMBUCA10:
                             FMBUCA11,FMBUCA12,FMBUCA13
.
          MOVE     CESPSPC,CESASPC
          MOVE     FINYEAR,CESAYEAR
          MOVE     F2,CESAPER
          REP      " 0",CESAPER
          PACK     KEY9,CESASPC,CESAYEAR,CESAPER
          CALL     RDCESA1
          IF       OVRCD=0
            MOVE     ACTUAL,CESAGLA
            MOVE     BUDGET,CESAGLB
            CALL     UPCESA1
          ELSE
            MOVE     ZERO,CESACST1
            MOVE     ZERO,CESACST2
            MOVE     ZERO,CESACST3
            MOVE     ZERO,CESACST4
            MOVE     ZERO,CESACST5
            MOVE     ACTUAL,CESAGLA
            MOVE     BUDGET,CESAGLB
            CALL     WRCESA1
          ENDIF
          GOTO     FINSUM10
.
FINSUM90  PRINT   "NOTE : No Financial Summary Details for Service Provider - ":
                   CESPSPC,"  Ledger/Account : ",CESPUR1
          GOTO     FINSUM99
FINSUM99  RETURN
.
CLRBUD00  MOVE     ZERO,FMBUCA01
          MOVE     ZERO,FMBUCA02
          MOVE     ZERO,FMBUCA03
          MOVE     ZERO,FMBUCA04
          MOVE     ZERO,FMBUCA05
          MOVE     ZERO,FMBUCA06
          MOVE     ZERO,FMBUCA07
          MOVE     ZERO,FMBUCA08
          MOVE     ZERO,FMBUCA09
          MOVE     ZERO,FMBUCA10
          MOVE     ZERO,FMBUCA11
          MOVE     ZERO,FMBUCA12
          MOVE     ZERO,FMBUCA13
          MOVE     ZERO,FMSTCA01
          MOVE     ZERO,FMSTCA02
          MOVE     ZERO,FMSTCA03
          MOVE     ZERO,FMSTCA04
          MOVE     ZERO,FMSTCA05
          MOVE     ZERO,FMSTCA06
          MOVE     ZERO,FMSTCA07
          MOVE     ZERO,FMSTCA08
          MOVE     ZERO,FMSTCA09
          MOVE     ZERO,FMSTCA10
          MOVE     ZERO,FMSTCA11
          MOVE     ZERO,FMSTCA12
          MOVE     ZERO,FMSTCA13
          PRINT    "NOTE : No Budget Summary Details for Service Provider - ":
                   CESPSPC,"  Ledger/Account : ",CESPUR1
          RETURN
.
STASUM00  UNPACK   CESPUR1,KEY2,KEY1,KEY12
          PACK     KEY14,KEY2,KEY12,SP70
          CALL     RDFMSS1
          BRANCH   OVRCD,STASUM90
.
          PACK     KEY14,KEY2,KEY12,SP70
          CALL     RDFMST1
          IF       OVRCD=1
            CALL     CLRBUD00
          ENDIF
          MOVE     ZERO,F2
.
STASUM10  ADD      ONE,F2               * Hard Coded to 12 Periods
          COMPARE  "13",F2              * If and When we get a 13 period site
          GOTO     STASUM99 IF EQUAL    * then Fix Program
.
          LOAD     ACTUAL,F2,FMSSA1,FMSSA2,FMSSA3,FMSSA4,FMSSA5:
                             FMSSA6,FMSSA7,FMSSA8,FMSSA9,FMSSA10:
                             FMSSA11,FMSSA12,FMSSA13
.
          LOAD     BUDGET,F2,FMSTCA01,FMSTCA02,FMSTCA03,FMSTCA04,FMSTCA05:
                             FMSTCA06,FMSTCA07,FMSTCA08,FMSTCA09,FMSTCA10:
                             FMSTCA11,FMSTCA12,FMSTCA13
.
          MOVE     CESPSPC,CESASPC
          MOVE     FINYEAR,CESAYEAR
          MOVE     F2,CESAPER
          REP      " 0",CESAPER
          PACK     KEY9,CESASPC,CESAYEAR,CESAPER
          CALL     RDCESA1
          IF       OVRCD=0
            MOVE     ACTUAL,CESAGLA
            MOVE     BUDGET,CESAGLB
            CALL     UPCESA1
          ELSE
            MOVE     ZERO,CESACST1
            MOVE     ZERO,CESACST2
            MOVE     ZERO,CESACST3
            MOVE     ZERO,CESACST4
            MOVE     ZERO,CESACST5
            MOVE     ACTUAL,CESAGLA
            MOVE     BUDGET,CESAGLB
            CALL     WRCESA1
          ENDIF
          GOTO     STASUM10
.
STASUM90  PRINT   "NOTE : No Financial Summary Details for Service Provider - ":
                   CESPSPC,"  Ledger/Account : ",CESPUR1
          GOTO     STASUM99
STASUM99  RETURN
.
EYEAR000  KEYIN    *PCCOL:CVERT,*V2LON,FINYEAR
          ENDSET   FINYEAR
          APPEND   SP70,FINYEAR
          RESET    FINYEAR
          MATCH    SP70,FINYEAR
          GOTO     EYEAR900 IF EQUAL
          MATCH    EXITCHAR,FINYEAR
          GOTO     EYEAR900 IF EQUAL
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     FMSAMAA1,"fmsamaaf"
          TRAPCLR  IO
          BRANCH   OVRCD,EYEAR800
.
          CLEAR    KEY8
          APPEND   "fmsp",KEY8
          APPEND   FINYEAR,KEY8
          RESET    KEY8
          REP      " 0",KEY8
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     FMSFPSA1,KEY8
          TRAPCLR  IO
          BRANCH   OVRCD,EYEAR800
.
          CLEAR    KEY8
          APPEND   "fmss",KEY8
          APPEND   FINYEAR,KEY8
          RESET    KEY8
          REP      " 0",KEY8
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     FMSSMAA1,KEY8
          TRAPCLR  IO
          COMPARE  ZERO,OVRCD
          GOTO     EYEAR990 IF EQUAL
.
EYEAR800  MOVE     "Period Summary File Not Available for Year - ",DISPMSG
          BEEP
          CALL     MESSAGE1
          GOTO     EYEAR000
.
EYEAR900  MOVE     TWO,EXIT
          GOTO     EYEAR999
EYEAR990  MOVE     ZERO,EXIT
EYEAR999  RETURN
EBUDT000  MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     FMSBTYA1,"fmsbtyaf"
          TRAPCLR  IO
          IF       OVRCD=1
            MOVE     "Budget Types File Not Available - ",DISPMSG
            BEEP
            CALL     MESSAGE1
            GOTO     EBUDT999
          ENDIF
.
          MOVE     ZERO,CKEYTYP
          CALL     KFMBTA00
          BRANCH   EXIT,EBUDT999,EBUDT999
.
          CLEAR    KEY8
          APPEND   "fmsb",KEY8
          APPEND   FMBTCODE,KEY8
          RESET    KEY8
          REP      " 0",KEY8
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     FMSBUDA1,KEY8
          TRAPCLR  IO
          BRANCH   OVRCD,EBUDT800
.
          CLEAR    KEY8
          APPEND   "fmsc",KEY8
          APPEND   FMBTCODE,KEY8
          RESET    KEY8
          REP      " 0",KEY8
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     FMSSBUA1,KEY8
          TRAPCLR  IO
          COMPARE  ZERO,OVRCD
          GOTO     EBUDT990 IF EQUAL
.
EBUDT800  MOVE     "Budget Summary Tables Not Available - ",DISPMSG
          BEEP
          CALL     MESSAGE1
          GOTO     EBUDT000
.
EBUDT900  MOVE     TWO,EXIT
          GOTO     EBUDT999
EBUDT990  MOVE     ZERO,EXIT
EBUDT999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CEAPAAIO/INC
          INC       CEAPBAIO/INC
          INC       CEAPERIO/INC
          INC       CEAPERKY    
          INC       CEAPSCIO/INC
          INC       CEASAAIO/INC
          INC       CEASPCIO/INC
          INC       CEASTRIO/INC
          INC       FMSAMAIO/INC
          INC       FMSBTYIO/INC
          INC       FMSBTYKY    
          INC       FMSBUDIO/INC
          INC       FMSFPSIO/INC
          INC       FMSSBUIO/INC
          INC       FMSSMAIO/INC
.
          INC       STDGENCD
.
