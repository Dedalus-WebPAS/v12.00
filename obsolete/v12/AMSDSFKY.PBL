.---------------------------------------------------------------------------
.   System    :   Asset Management System            
.   Include   :   AMSDSFKY
.   Routine   :   HAMDSA00 Dep'n Year          
.   Return    :           
.-------------------------------------------------------------------------------
HAMDSA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "15",HTOP
            MOVE      "24",HBOT
            MOVE      "68",HLEF
            MOVE      "80",HRIG
          ENDIF
HAMDSA04
          CALL      GSCRN000
          BRANCH    EXIT,HAMDSA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Year"               
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 5",STDCOL02
HAMDSA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,AMDSYEAR
          PACK      KEY18,AMDSREG,AMDSASS,AMDSYEAR,SP70                         
          PACK      SAVKEY80,AMDSREG,AMDSASS,AMDSYEAR,SP70                      
          SETLPTR   SAVKEY80,14                                                 
          CALL      RSAMDS1 
HAMDSA10
          CALL      RKAMDS1 
          BRANCH    OVRCD,HAMDSA15
          PACK      KEY18,AMDSREG,AMDSASS,AMDSYEAR,SP70                         
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HAMDSA15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,HAMDSA12
          CALL      HAMDSA60
          BRANCH    OVRCD,HAMDSA10
HAMDSA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY18,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,AMDSYEAR
          COMPARE   MAXITEM,XITEMNO
          GOTO      HAMDSA10 IF NOT EQUAL
HAMDSA15
          UNPACK    SAVKEY80,AMDSREG,AMDSASS,AMDSYEAR                           
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HAMDSA20
          CALL      HSCRI000
          BRANCH    EXIT,HAMDSA30,HAMDSA35,HAMDSA40,HAMDSA45,HAMDSA04:
                              HAMDSA91,HAMDSA50
          GOTO      HAMDSA92
HAMDSA30
          CALL      RKAMDS1 
          BRANCH    OVRCD,HAMDSA85
          PACK      KEY18,AMDSREG,AMDSASS,AMDSYEAR,SP70                         
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HAMDSA85 IF NOT EQUAL                                       
          CALL      RPAMDS1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAMDSA10
HAMDSA35
          MOVE      ST1,KEY18
          CALL      RDAMDS1 
          CALL      RPAMDS1 
          BRANCH    OVRCD,HAMDSA85
          PACK      KEY18,AMDSREG,AMDSASS,AMDSYEAR,SP70                         
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HAMDSA85 IF NOT EQUAL                                       
          MATCH     SP70,AMDSYEAR                                               
          GOTO      HAMDSA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HAMDSA36
          CALL      RPAMDS1 
          BRANCH    OVRCD,HAMDSA37
          PACK      KEY18,AMDSREG,AMDSASS,AMDSYEAR,SP70                         
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HAMDSA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HAMDSA36 IF NOT EQUAL
HAMDSA37
          MOVE      ZERO,XITEMNO
          GOTO      HAMDSA10
HAMDSA40
          MOVE      ST1,KEY18
          CALL      RDAMDS1 
          CALL      RPAMDS1 
          BRANCH    OVRCD,HAMDSA85
          PACK      KEY18,AMDSREG,AMDSASS,AMDSYEAR,SP70                         
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HAMDSA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAMDSA08
HAMDSA45
          CALL      RKAMDS1 
          BRANCH    OVRCD,HAMDSA85
          PACK      KEY18,AMDSREG,AMDSASS,AMDSYEAR,SP70                         
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HAMDSA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY18,SAVKEY80,Z70                                          
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSAMDS1 
HAMDSA46
          CALL      RPAMDS1 
          BRANCH    OVRCD,HAMDSA47
          PACK      KEY18,AMDSREG,AMDSASS,AMDSYEAR,SP70                         
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HAMDSA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HAMDSA46 IF NOT EQUAL
HAMDSA47
          MOVE      ZERO,XITEMNO
          GOTO      HAMDSA10
HAMDSA50  COMPARE   ZERO,CSEARCH
          GOTO      HAMDSA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAMDSA08
HAMDSA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAMDSA08
HAMDSA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HAMDSA61 IF EQUAL
          MATCH     SCHFLD01,AMDSYEAR
          GOTO      HAMDSA72 IF NOT EQUAL
HAMDSA61
HAMDSA62
HAMDSA63
HAMDSA64
HAMDSA65
HAMDSA66
HAMDSA67
HAMDSA68
HAMDSA69
HAMDSA70
          GOTO      HAMDSA75
HAMDSA72  MOVE      ONE,OVRCD
HAMDSA75  RETURN
HAMDSA85
          LOAD      KEY18,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY18,AMDSREG,AMDSASS,AMDSYEAR                              
          CALL      RDAMDS1 
HAMDSA90
          UNPACK    SAVKEY80,AMDSREG,AMDSASS,AMDSYEAR                           
          BEEP
          GOTO      HAMDSA20
HAMDSA91
          MOVE      ZERO,AMDSG01 
          MOVE      ZERO,AMDSG02 
          MOVE      ZERO,AMDSG03 
          MOVE      ZERO,AMDSG04 
          MOVE      ZERO,AMDSG05 
          MOVE      ZERO,AMDSG06 
          MOVE      ZERO,AMDSG07 
          MOVE      ZERO,AMDSG08 
          MOVE      ZERO,AMDSG09 
          MOVE      ZERO,AMDSG10 
          MOVE      ZERO,AMDSG11 
          MOVE      ZERO,AMDSG12 
          MOVE      ZERO,AMDSG13 
          MOVE      ZERO,AMDSA01 
          MOVE      ZERO,AMDSA02 
          MOVE      ZERO,AMDSA03 
          MOVE      ZERO,AMDSA04 
          MOVE      ZERO,AMDSA05 
          MOVE      ZERO,AMDSA06 
          MOVE      ZERO,AMDSA07 
          MOVE      ZERO,AMDSA08 
          MOVE      ZERO,AMDSA09 
          MOVE      ZERO,AMDSA10 
          MOVE      ZERO,AMDSA11 
          MOVE      ZERO,AMDSA12 
          MOVE      ZERO,AMDSA13 
          MOVE      ZERO,AMDST01 
          MOVE      ZERO,AMDST02 
          MOVE      ZERO,AMDST03 
          MOVE      ZERO,AMDST04 
          MOVE      ZERO,AMDST05 
          MOVE      ZERO,AMDST06 
          MOVE      ZERO,AMDST07 
          MOVE      ZERO,AMDST08 
          MOVE      ZERO,AMDST09 
          MOVE      ZERO,AMDST10 
          MOVE      ZERO,AMDST11 
          MOVE      ZERO,AMDST12 
          MOVE      ZERO,AMDST13 
          MOVE      ZERO,AMDSAAD 
          MOVE      ZERO,AMDSTAD 
          MOVE      ZERO,AMDSRVT 
          MOVE      SP70,AMDSTDT 
          MOVE      SP70,AMDSADT 
          MOVE      SP70,AMDSSPA 
          MOVE      SP70,KEY18
          MOVE      SP70,AMDSYEAR
          GOTO      HAMDSA96
HAMDSA92
          MOVE      SP70,KEY18
          MOVE      SP70,AMDSYEAR
          LOAD      KEY18,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY18,AMDSREG,AMDSASS,AMDSYEAR                              
HAMDSA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HAMDSA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Asset Management System            
.   Include   :   AMSDSFKY
.   Routine   :   KAMDSA00 Keyin Dep'n Year          
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KAMDSA00 TOPIC     "AMDSYEAR"
          MOVE      UNDLN70,AMDSYEAR
          KEYIN     *PCCOL:CVERT,*DV,AMDSYEAR:                                  
                    *PCCOL:CVERT,*V2LON,AMDSYEAR:                               
                    *PCCOL:CVERT,*DV,AMDSYEAR
.
          ENDSET    AMDSYEAR
          APPEND    SP70,AMDSYEAR
          RESET     AMDSYEAR
.
          MATCH     SP70,AMDSYEAR
          GOTO      KAMDSA90 IF EQUAL
.
          CMATCH    EXITCHAR,AMDSYEAR
          GOTO      KAMDSA95 IF EQUAL
.
          CMATCH    QUEST,AMDSYEAR
          GOTO      KAMDSA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HAMDSA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    AMDSYEAR
          APPEND    SP70,AMDSYEAR
          RESET     AMDSYEAR
.
          MATCH     SP70,AMDSYEAR
          GOTO      KAMDSA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,AMDSYEAR                                
KAMDSA10
          PACK      KEY18,AMDSREG,AMDSASS,AMDSYEAR                              
          CALL      RAAMDS1 
          BRANCH    OVRCD,KAMDSA80
          BRANCH    CKEYTYP,KAMDSA75
          CALL      RDAMDS1 
KAMDSA70
          MOVE      ZERO,EXIT
          GOTO      KAMDSA99
KAMDSA75
          MOVE      "Dep'n Year Already Exist - ",DISPMSG                                            
          CALL      MESSAGE1
          GOTO      KAMDSA00
KAMDSA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KAMDSA99,KAMDSA99
          MOVE      "Dep'n Year Does Not Exist - ",DISPMSG                                           
          CALL      MESSAGE1
          GOTO      KAMDSA00
KAMDSA90
          MOVE      ONE,EXIT
          GOTO      KAMDSA99
KAMDSA95
          MOVE      TWO,EXIT
KAMDSA99 TOPIC    PRGID
          RETURN
