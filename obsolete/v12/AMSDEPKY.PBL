.---------------------------------------------------------------------------
.   System    :   Asset Management System            
.   Include   :   AMSDEPKY
.   Routine   :   HAMDEA00 Depreciation Type   
.   Return    :           
.-------------------------------------------------------------------------------
HAMDEA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HAMDEA04
          CALL      GSCRN000
          BRANCH    EXIT,HAMDEA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Dep'n Code"         
.
          MOVE      STDCOL01,STDCOL02
          ADD       "11",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "36",STDCOL03
HAMDEA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,AMDEDEP 
          PACK      KEY4,AMDEDEP,SP70                                           
.                                                                               
.                                                                               
          CALL      RSAMDE1 
HAMDEA10
          CALL      RKAMDE1 
          BRANCH    OVRCD,HAMDEA15
          PACK      KEY4,AMDEDEP,SP70                                           
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HAMDEA12
          CALL      HAMDEA60
          BRANCH    OVRCD,HAMDEA10
HAMDEA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,AMDEDEP 
          DISPLAY   *PSTDCOL02:STDROW,AMDEDES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HAMDEA10 IF NOT EQUAL
HAMDEA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HAMDEA20
          CALL      HSCRI000
          BRANCH    EXIT,HAMDEA30,HAMDEA35,HAMDEA40,HAMDEA45,HAMDEA04:
                              HAMDEA91,HAMDEA50
          GOTO      HAMDEA92
HAMDEA30
          CALL      RKAMDE1 
          BRANCH    OVRCD,HAMDEA85
          PACK      KEY4,AMDEDEP,SP70                                           
.                                                                               
.                                                                               
          CALL      RPAMDE1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAMDEA10
HAMDEA35
          MOVE      ST1,KEY4 
          CALL      RDAMDE1 
          CALL      RPAMDE1 
          BRANCH    OVRCD,HAMDEA85
          PACK      KEY4,AMDEDEP,SP70                                           
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HAMDEA36
          CALL      RPAMDE1 
          BRANCH    OVRCD,HAMDEA37
          PACK      KEY4,AMDEDEP,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HAMDEA36 IF NOT EQUAL
HAMDEA37
          MOVE      ZERO,XITEMNO
          GOTO      HAMDEA10
HAMDEA40
          MOVE      ST1,KEY4 
          CALL      RDAMDE1 
          CALL      RPAMDE1 
          BRANCH    OVRCD,HAMDEA85
          PACK      KEY4,AMDEDEP,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAMDEA08
HAMDEA45
          CALL      RKAMDE1 
          BRANCH    OVRCD,HAMDEA85
          PACK      KEY4,AMDEDEP,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY4,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSAMDE1 
HAMDEA46
          CALL      RPAMDE1 
          BRANCH    OVRCD,HAMDEA47
          PACK      KEY4,AMDEDEP,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HAMDEA46 IF NOT EQUAL
HAMDEA47
          MOVE      ZERO,XITEMNO
          GOTO      HAMDEA10
HAMDEA50  COMPARE   ZERO,CSEARCH
          GOTO      HAMDEA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAMDEA08
HAMDEA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAMDEA08
HAMDEA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HAMDEA61 IF EQUAL
          MATCH     SCHFLD01,AMDEDEP 
          GOTO      HAMDEA72 IF NOT EQUAL
HAMDEA61
          MATCH     SP70,SCHFLD02
          GOTO      HAMDEA62 IF EQUAL
          MATCH     SCHFLD02,AMDEDES 
          GOTO      HAMDEA72 IF NOT EQUAL
HAMDEA62
HAMDEA63
HAMDEA64
HAMDEA65
HAMDEA66
HAMDEA67
HAMDEA68
HAMDEA69
HAMDEA70
          GOTO      HAMDEA75
HAMDEA72  MOVE      ONE,OVRCD
HAMDEA75  RETURN
HAMDEA85
          LOAD      KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,AMDEDEP                                                
          CALL      RDAMDE1 
HAMDEA90
.                                                                               
          BEEP
          GOTO      HAMDEA20
HAMDEA91
          MOVE      SP70,AMDEDES 
          MOVE      ZERO,AMDEBAS 
          MOVE      ZERO,AMDEFRQ 
          MOVE      ZERO,AMDERAT 
          MOVE      ZERO,AMDERT01
          MOVE      ZERO,AMDERT02
          MOVE      ZERO,AMDERT03
          MOVE      ZERO,AMDERT04
          MOVE      ZERO,AMDERT05
          MOVE      ZERO,AMDERT06
          MOVE      ZERO,AMDERT07
          MOVE      ZERO,AMDERT08
          MOVE      ZERO,AMDERT09
          MOVE      ZERO,AMDERT10
          MOVE      SP70,AMDEUR1 
          MOVE      SP70,AMDEUR2 
          MOVE      SP70,AMDEUD1 
          MOVE      SP70,AMDEUD2 
          MOVE      SP70,AMDEUY1 
          MOVE      SP70,AMDEUY2 
          MOVE      SP70,AMDESPA 
          MOVE      SP70,KEY4 
          MOVE      SP70,AMDEDEP 
          GOTO      HAMDEA96
HAMDEA92
          MOVE      SP70,KEY4 
          MOVE      SP70,AMDEDEP 
          LOAD      KEY4,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,AMDEDEP                                                
HAMDEA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HAMDEA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Asset Management System            
.   Include   :   AMSDEPKY
.   Routine   :   KAMDEA00 Keyin Depreciation Code   
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KAMDEA00 TOPIC     "AMDEDEP "
          MOVE      UNDLN70,AMDEDEP 
          KEYIN     *PCCOL:CVERT,*DV,AMDEDEP:                                   
                    *PCCOL:CVERT,*V2LON,AMDEDEP:                                
                    *PCCOL:CVERT,*DV,AMDEDEP 
.
          ENDSET    AMDEDEP 
          APPEND    SP70,AMDEDEP 
          RESET     AMDEDEP 
.
          MATCH     SP70,AMDEDEP 
          GOTO      KAMDEA90 IF EQUAL
.
          CMATCH    EXITCHAR,AMDEDEP 
          GOTO      KAMDEA95 IF EQUAL
.
          CMATCH    QUEST,AMDEDEP 
          GOTO      KAMDEA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HAMDEA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    AMDEDEP 
          APPEND    SP70,AMDEDEP 
          RESET     AMDEDEP 
.
          MATCH     SP70,AMDEDEP 
          GOTO      KAMDEA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,AMDEDEP                                 
KAMDEA10
          PACK      KEY4,AMDEDEP                                                
          CALL      RAAMDE1 
          BRANCH    OVRCD,KAMDEA80
          BRANCH    CKEYTYP,KAMDEA75
          CALL      RDAMDE1 
KAMDEA70
          MOVE      ZERO,EXIT
          GOTO      KAMDEA99
KAMDEA75
          MOVE      "Depreciation Code Already Exist - ",DISPMSG                                     
          CALL      MESSAGE1
          GOTO      KAMDEA00
KAMDEA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KAMDEA99,KAMDEA99
          MOVE      "Depreciation Code Does Not Exist - ",DISPMSG                                    
          CALL      MESSAGE1
          GOTO      KAMDEA00
KAMDEA90
          MOVE      ONE,EXIT
          GOTO      KAMDEA99
KAMDEA95
          MOVE      TWO,EXIT
KAMDEA99 TOPIC    PRGID
          RETURN
