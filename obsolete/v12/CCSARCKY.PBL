.---------------------------------------------------------------------------
.   System    :   Clinical Costing System            
.   Include   :   CCSARCKY
.   Routine   :   KCCARA00 Keyin Masterfile Archive  
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KCCARA00 TOPIC     "CCARARC "
          MOVE      UNDLN70,CCARARC 
          KEYIN     *PCCOL:CVERT,*DV,CCARARC:                                   
                    *PCCOL:CVERT,*V2LON,CCARARC:                                
                    *PCCOL:CVERT,*DV,CCARARC 
.
          ENDSET    CCARARC 
          APPEND    SP70,CCARARC 
          RESET     CCARARC 
.
          MATCH     SP70,CCARARC 
          GOTO      KCCARA90 IF EQUAL
.
          CMATCH    EXITCHAR,CCARARC 
          GOTO      KCCARA95 IF EQUAL
.
          CMATCH    QUEST,CCARARC 
          GOTO      KCCARA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCARA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCARARC 
          APPEND    SP70,CCARARC 
          RESET     CCARARC 
.
          MATCH     SP70,CCARARC 
          GOTO      KCCARA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,CCARARC                                 
KCCARA10
          PACK      KEY4,CCARARC                                                
          CALL      RACCAR1 
          BRANCH    OVRCD,KCCARA80
          BRANCH    CKEYTYP,KCCARA75
          CALL      RDCCAR1 
KCCARA70
          MOVE      ZERO,EXIT
          GOTO      KCCARA99
KCCARA75
          MOVE      "Masterfile Archive Already Exist - ",DISPMSG                                    
          CALL      MESSAGE1
          GOTO      KCCARA00
KCCARA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KCCARA99,KCCARA99
          MOVE      "Masterfile Archive Does Not Exist - ",DISPMSG                                   
          CALL      MESSAGE1
          GOTO      KCCARA00
KCCARA90
          MOVE      ONE,EXIT
          GOTO      KCCARA99
KCCARA95
          MOVE      TWO,EXIT
KCCARA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   Clinical Costing System            
.   Include   :   CCSARCKY
.   Routine   :   HCCARA00 Archive Code Help   
.   Return    :           
.-------------------------------------------------------------------------------
HCCARA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "14",HTOP
            MOVE      "24",HBOT
            MOVE      "10",HLEF
            MOVE      "80",HRIG
          ENDIF
HCCARA04
          CALL      GSCRN000
          BRANCH    EXIT,HCCARA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Archive"            
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 8",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "36",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Directory"          
.
          MOVE      STDCOL03,STDCOL04
          ADD       "35",STDCOL04
HCCARA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,CCARARC 
          PACK      KEY4,CCARARC,SP70                                           
.                                                                               
.                                                                               
          CALL      RSCCAR1 
HCCARA10
          CALL      RKCCAR1 
          BRANCH    OVRCD,HCCARA15
          PACK      KEY4,CCARARC,SP70                                           
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HCCARA12
          CALL      HCCARA60
          BRANCH    OVRCD,HCCARA10
HCCARA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,CCARARC 
          DISPLAY   *PSTDCOL02:STDROW,CCARDES 
          DISPLAY   *PSTDCOL03:STDROW,CCARDIR 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HCCARA10 IF NOT EQUAL
HCCARA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HCCARA20
          CALL      HSCRI000
          BRANCH    EXIT,HCCARA30,HCCARA35,HCCARA40,HCCARA45,HCCARA04:
                              HCCARA91,HCCARA50
          GOTO      HCCARA92
HCCARA30
          CALL      RKCCAR1 
          BRANCH    OVRCD,HCCARA85
          PACK      KEY4,CCARARC,SP70                                           
.                                                                               
.                                                                               
          CALL      RPCCAR1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCARA10
HCCARA35
          MOVE      ST1,KEY4 
          CALL      RDCCAR1 
          CALL      RPCCAR1 
          BRANCH    OVRCD,HCCARA85
          PACK      KEY4,CCARARC,SP70                                           
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HCCARA36
          CALL      RPCCAR1 
          BRANCH    OVRCD,HCCARA37
          PACK      KEY4,CCARARC,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCCARA36 IF NOT EQUAL
HCCARA37
          MOVE      ZERO,XITEMNO
          GOTO      HCCARA10
HCCARA40
          MOVE      ST1,KEY4 
          CALL      RDCCAR1 
          CALL      RPCCAR1 
          BRANCH    OVRCD,HCCARA85
          PACK      KEY4,CCARARC,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCARA08
HCCARA45
          CALL      RKCCAR1 
          BRANCH    OVRCD,HCCARA85
          PACK      KEY4,CCARARC,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY4,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSCCAR1 
HCCARA46
          CALL      RPCCAR1 
          BRANCH    OVRCD,HCCARA47
          PACK      KEY4,CCARARC,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCCARA46 IF NOT EQUAL
HCCARA47
          MOVE      ZERO,XITEMNO
          GOTO      HCCARA10
HCCARA50  COMPARE   ZERO,CSEARCH
          GOTO      HCCARA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCARA08
HCCARA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCARA08
HCCARA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HCCARA61 IF EQUAL
          MATCH     SCHFLD01,CCARARC 
          GOTO      HCCARA72 IF NOT EQUAL
HCCARA61
          MATCH     SP70,SCHFLD02
          GOTO      HCCARA62 IF EQUAL
          MATCH     SCHFLD02,CCARDES 
          GOTO      HCCARA72 IF NOT EQUAL
HCCARA62
          MATCH     SP70,SCHFLD03
          GOTO      HCCARA63 IF EQUAL
          MATCH     SCHFLD03,CCARDIR 
          GOTO      HCCARA72 IF NOT EQUAL
HCCARA63
HCCARA64
HCCARA65
HCCARA66
HCCARA67
HCCARA68
HCCARA69
HCCARA70
          GOTO      HCCARA75
HCCARA72  MOVE      ONE,OVRCD
HCCARA75  RETURN
HCCARA85
          LOAD      KEY4,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,CCARARC                                                
          CALL      RDCCAR1 
HCCARA90
.                                                                               
          BEEP
          GOTO      HCCARA20
HCCARA91
          MOVE      SP70,CCARDES 
          MOVE      ZERO,CCARCMP 
          MOVE      SP70,CCARDIR 
          MOVE      SP70,CCARSPA 
          MOVE      SP70,KEY4 
          MOVE      SP70,CCARARC 
          GOTO      HCCARA96
HCCARA92
          MOVE      SP70,KEY4 
          MOVE      SP70,CCARARC 
          LOAD      KEY4,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY4,CCARARC                                                
HCCARA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HCCARA99
          RETURN
