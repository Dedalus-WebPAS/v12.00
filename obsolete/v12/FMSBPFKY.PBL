.-------------------------------------------------------------------------------
.   Routine   :   KBPFFM00 Keyin Budget Type
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
ABPFFM00  MOVE      "1",CKEYTYP        * insert
          GOTO      KBPFFM10
.
KBPFFM00  MOVE      "0",CKEYTYP        * modify
          GOTO      KBPFFM10
.
KBPFFM10  MOVE      FMLALEDG,FMBPLEDG
          MOVE      FMLCYEAR,FMBPYEAR
          CALL      KFMBPA00
          RETURN
.---------------------------------------------------------------------------
.   System    :   Financial Management System        
.   Include   :   FMSBPFKY
.   Routine   :   KFMBPA00 Keyin Budget Profile      
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KFMBPA00 TOPIC     "FMBPCODE"
          MOVE      UNDLN70,FMBPCODE
          KEYIN     *PCCOL:CVERT,*DV,FMBPCODE:                                  
                    *PCCOL:CVERT,*V2LON,FMBPCODE:                               
                    *PCCOL:CVERT,*DV,FMBPCODE
.
          ENDSET    FMBPCODE
          APPEND    SP70,FMBPCODE
          RESET     FMBPCODE
.
          MATCH     SP70,FMBPCODE
          GOTO      KFMBPA90 IF EQUAL
.
          CMATCH    EXITCHAR,FMBPCODE
          GOTO      KFMBPA95 IF EQUAL
.
          CMATCH    QUEST,FMBPCODE
          GOTO      KFMBPA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HFMBPA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    FMBPCODE
          APPEND    SP70,FMBPCODE
          RESET     FMBPCODE
.
          MATCH     SP70,FMBPCODE
          GOTO      KFMBPA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,FMBPCODE                                
KFMBPA10
          PACK      KEY9,FMBPLEDG,FMBPYEAR,FMBPCODE                             
          CALL      RAFMBP1 
          BRANCH    OVRCD,KFMBPA80
          BRANCH    CKEYTYP,KFMBPA75
          CALL      RDFMBP1 
KFMBPA70
          MOVE      ZERO,EXIT
          GOTO      KFMBPA99
KFMBPA75
          MOVE      "Budget Profile Already Exist - ",DISPMSG                                        
          CALL      MESSAGE1
          GOTO      KFMBPA00
KFMBPA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KFMBPA99,KFMBPA99
          MOVE      "Budget Profile Does Not Exist - ",DISPMSG                                       
          CALL      MESSAGE1
          GOTO      KFMBPA00
KFMBPA90
          MOVE      ONE,EXIT
          GOTO      KFMBPA99
KFMBPA95
          MOVE      TWO,EXIT
KFMBPA99 TOPIC    PRGID
          RETURN
.-------------------------------------------------------------------------------
.   Routine   :   KPROFM00 Keyin Budget Profile      
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
APROFM00  MOVE      "1",CKEYTYP        * insert
          GOTO      KPROFM10
.
KPROFM00  MOVE      "0",CKEYTYP        * modify
          GOTO      KPROFM10
.
KPROFM10  MOVE      FMLALEDG,FMBPLEDG
          MOVE      FMLCYEAR,FMBPYEAR
          CALL      KFMBPA00
          RETURN
.---------------------------------------------------------------------------
.   System    :   Financial Management System        
.   Include   :   FMSBPFKY
.   Routine   :   HFMBPA00 Budget Profile Help 
.   Return    :           
.-------------------------------------------------------------------------------
HFMBPA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HFMBPA04
          CALL      GSCRN000
          BRANCH    EXIT,HFMBPA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Budget Profile"     
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 5",STDCOL02
          MOVE      STDCOL02,STDCOL03
          ADD       "30",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Ledger"             
.
          MOVE      STDCOL03,STDCOL04
          ADD       " 8",STDCOL04
          DISPLAY   *PSTDCOL04:STDROW,*V2LON,*ULON,"Fin Year"           
.
          MOVE      STDCOL04,STDCOL05
          ADD       "10",STDCOL05
HFMBPA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,FMBPCODE
          PACK      KEY9,FMBPLEDG,FMBPYEAR,FMBPCODE,SP70                        
          PACK      SAVKEY80,FMBPLEDG,FMBPYEAR,FMBPCODE,SP70                    
          SETLPTR   SAVKEY80,6                                                  
          CALL      RSFMBP1 
HFMBPA10
          CALL      RKFMBP1 
          BRANCH    OVRCD,HFMBPA15
          PACK      KEY9,FMBPLEDG,FMBPYEAR,FMBPCODE,SP70                        
          MATCH     SAVKEY80,KEY9                                               
          GOTO      HFMBPA15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,HFMBPA12
          CALL      HFMBPA60
          BRANCH    OVRCD,HFMBPA10
HFMBPA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY9,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,FMBPCODE
          DISPLAY   *PSTDCOL02:STDROW,FMBPDESC
          DISPLAY   *PSTDCOL03:STDROW,FMBPLEDG
          DISPLAY   *PSTDCOL04:STDROW,FMBPYEAR
          COMPARE   MAXITEM,XITEMNO
          GOTO      HFMBPA10 IF NOT EQUAL
HFMBPA15
          UNPACK    SAVKEY80,FMBPLEDG,FMBPYEAR,FMBPCODE                         
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HFMBPA20
          CALL      HSCRI000
          BRANCH    EXIT,HFMBPA30,HFMBPA35,HFMBPA40,HFMBPA45,HFMBPA04:
                              HFMBPA91,HFMBPA50
          GOTO      HFMBPA92
HFMBPA30
          CALL      RKFMBP1 
          BRANCH    OVRCD,HFMBPA85
          PACK      KEY9,FMBPLEDG,FMBPYEAR,FMBPCODE,SP70                        
          MATCH     SAVKEY80,KEY9                                               
          GOTO      HFMBPA85 IF NOT EQUAL                                       
          CALL      RPFMBP1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMBPA10
HFMBPA35
          MOVE      ST1,KEY9 
          CALL      RDFMBP1 
          CALL      RPFMBP1 
          BRANCH    OVRCD,HFMBPA85
          PACK      KEY9,FMBPLEDG,FMBPYEAR,FMBPCODE,SP70                        
          MATCH     SAVKEY80,KEY9                                               
          GOTO      HFMBPA85 IF NOT EQUAL                                       
          MATCH     SP70,FMBPCODE                                               
          GOTO      HFMBPA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HFMBPA36
          CALL      RPFMBP1 
          BRANCH    OVRCD,HFMBPA37
          PACK      KEY9,FMBPLEDG,FMBPYEAR,FMBPCODE,SP70                        
          MATCH     SAVKEY80,KEY9                                               
          GOTO      HFMBPA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HFMBPA36 IF NOT EQUAL
HFMBPA37
          MOVE      ZERO,XITEMNO
          GOTO      HFMBPA10
HFMBPA40
          MOVE      ST1,KEY9 
          CALL      RDFMBP1 
          CALL      RPFMBP1 
          BRANCH    OVRCD,HFMBPA85
          PACK      KEY9,FMBPLEDG,FMBPYEAR,FMBPCODE,SP70                        
          MATCH     SAVKEY80,KEY9                                               
          GOTO      HFMBPA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMBPA08
HFMBPA45
          CALL      RKFMBP1 
          BRANCH    OVRCD,HFMBPA85
          PACK      KEY9,FMBPLEDG,FMBPYEAR,FMBPCODE,SP70                        
          MATCH     SAVKEY80,KEY9                                               
          GOTO      HFMBPA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY9,SAVKEY80,Z70                                           
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSFMBP1 
HFMBPA46
          CALL      RPFMBP1 
          BRANCH    OVRCD,HFMBPA47
          PACK      KEY9,FMBPLEDG,FMBPYEAR,FMBPCODE,SP70                        
          MATCH     SAVKEY80,KEY9                                               
          GOTO      HFMBPA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HFMBPA46 IF NOT EQUAL
HFMBPA47
          MOVE      ZERO,XITEMNO
          GOTO      HFMBPA10
HFMBPA50  COMPARE   ZERO,CSEARCH
          GOTO      HFMBPA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          KEYIN     *PSTDCOL04:STDROW,*V2LON,SCHFLD04
          RESET     SCHFLD04
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMBPA08
HFMBPA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMBPA08
HFMBPA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HFMBPA61 IF EQUAL
          MATCH     SCHFLD01,FMBPCODE
          GOTO      HFMBPA72 IF NOT EQUAL
HFMBPA61
          MATCH     SP70,SCHFLD02
          GOTO      HFMBPA62 IF EQUAL
          MATCH     SCHFLD02,FMBPDESC
          GOTO      HFMBPA72 IF NOT EQUAL
HFMBPA62
          MATCH     SP70,SCHFLD03
          GOTO      HFMBPA63 IF EQUAL
          MATCH     SCHFLD03,FMBPLEDG
          GOTO      HFMBPA72 IF NOT EQUAL
HFMBPA63
          MATCH     SP70,SCHFLD04
          GOTO      HFMBPA64 IF EQUAL
          MATCH     SCHFLD04,FMBPYEAR
          GOTO      HFMBPA72 IF NOT EQUAL
HFMBPA64
HFMBPA65
HFMBPA66
HFMBPA67
HFMBPA68
HFMBPA69
HFMBPA70
          GOTO      HFMBPA75
HFMBPA72  MOVE      ONE,OVRCD
HFMBPA75  RETURN
HFMBPA85
          LOAD      KEY9,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY9,FMBPLEDG,FMBPYEAR,FMBPCODE                             
          CALL      RDFMBP1 
HFMBPA90
          UNPACK    SAVKEY80,FMBPLEDG,FMBPYEAR,FMBPCODE                         
          BEEP
          GOTO      HFMBPA20
HFMBPA91
          MOVE      SP70,FMBPDESC
          MOVE      ZERO,FMBPPC1 
          MOVE      ZERO,FMBPPC2 
          MOVE      ZERO,FMBPPC3 
          MOVE      ZERO,FMBPPC4 
          MOVE      ZERO,FMBPPC5 
          MOVE      ZERO,FMBPPC6 
          MOVE      ZERO,FMBPPC7 
          MOVE      ZERO,FMBPPC8 
          MOVE      ZERO,FMBPPC9 
          MOVE      ZERO,FMBPPC10
          MOVE      ZERO,FMBPPC11
          MOVE      ZERO,FMBPPC12
          MOVE      ZERO,FMBPPC13
          MOVE      SP70,FMBPSPAR
          MOVE      SP70,KEY9 
          MOVE      SP70,FMBPCODE
          GOTO      HFMBPA96
HFMBPA92
          MOVE      SP70,KEY9 
          MOVE      SP70,FMBPCODE
          LOAD      KEY9,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY9,FMBPLEDG,FMBPYEAR,FMBPCODE                             
HFMBPA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HFMBPA99
          RETURN
