.******************************************************************************
.* System         : Clinical costing interface                                *
.* Program        : IBACCI98                                                  *
.* Description    : System Parameter Maintenance                              *
.******************************************************************************
.* Author         : Peter Eddey (copied from IBARUS98)                        *
.* Date           : 20/01/92                                                  *
.* Modifications  :                                                           *
.*        V9.02.01  27/02/2002  Tonii (St Vincent's Only)                     *
.*                  Added CCCNSVHM - Using SVHM Transition II                 *
.*                  Added CCCNX7SD - Start date for Extract 7 (ccyymmdd)      *
.*                  Added CCCNX7FP - Extract 7 File path                      *
.******************************************************************************
.*        V5.08.B01 15/03/2000  Steve Armstrong                               *
.*                  Added CCCNOUTL                                            *
.******************************************************************************
.*        V5.04.03  05/08/1997  Steve Armstrong    WHL Mods                   *
.*                  Added CCCNSERV                                            *
.*        V5.04.02  09/07/1997  Steve Armstrong    WHL Mods                   *
.*                  Added CCCNAEDP                                            *
.*                  Mods for CCCNUFCD                                         *
.******************************************************************************
.*        V5.03.04  29/04/1996  Steve Armstrong    Quote 8534                 *
.*                  Added CCCNECPA                                            *
.*        V5.03.03  04/01/1996  Greg Horvat                                   *
.*                  Removed the menu program, security key, IBA screen        *
.*                  password & data directory keyins & changed to use a       *
.*                  standard keyin for the IBA screen security password       *
.*        V5.03.02  27/12/1995    Justin Coates                               *
.*                  added cccntshc                                            *
.*        V5.03.01  20/07/1995    Justin Coates                               *
.*                  allow default site to be blank                            *
.******************************************************************************
.*        V5.02.03  09/05/1995    Justin Coates                               *
.*                  fix up posting for hospital screen B                      *
.*        V5.02.02  28/04/1995    Justin Coates  (Quote 8372)                 *
.*                  time for proc type 32 has to be TWO pre-op times          *
.*        V5.02.01  24/04/1995    Justin Coates  (Quote 8372)                 *
.*                  added procedure type 32 for theatre times                 *
.*                  and made the theatre Times screen hospital changeable     *
.*                  removed the parameter for external batch format           *
.******************************************************************************
          INC       STD001FD
          INC       CCICONFD/INC
          INC       FMSLMAFD/INC
          INC       IBACONFD/INC
          INC       OUTSITFD/INC
          INC       PATCODFD/INC
          INC       PATDRGFD/INC
.
.         program variables
.
CODE      DIM       2
COSDEPT   DIM       25
CPTDATE   DIM       8
CURRDTE   DIM       8
DANS3     DIM       3
DANS4     DIM       3
DANS5     DIM       3
DANS6     DIM       3
DANSX     DIM       3
DIM1A     DIM       1
DIM5      DIM       5
DIM7      DIM       7
DISP      DIM       3
DYESNO    DIM       3
DYN01     DIM       3
DYN02     DIM       3
ENCODE    DIM       3         * common code
FIELD     FORM      2
FORM8     FORM      8
PASS      DIM       8
REPFLAG   FORM      1
ROW       FORM      2
SCRNFLAG  FORM      1         * redisplay flag
X7STRTDT  DIM       10
.
.         program constants
.
CATA      INIT      "A "      * category for patient type for boarder
CATP      INIT      "P "
CATRP     INIT      "RP"      * category for CCI patient types
COSDEP1   INIT      "Normal     (3 characters)"
COSDEP2   INIT      "Trendstar  (4 characters)"
COSDEP3   INIT      "Transition (5 characters)"
KTP0      FORM      "72"
KTP1      FORM      "74"
KTP2      FORM      "75"
STD       INIT      "Standard"
TYPE0     INIT      "New Zealand"
TYPE1     INIT      "Epworth"
TYPE2     INIT      "Hawkes Bay "
.
PRGID     INIT      "IBACCI98"
PRGNAM    INIT      "CCI Parameter Maintenance"
VERSION   INIT      "V12.00.00"
.
.*********************************************************************
.*                  ML0000                                           *
.*        Mainline Code / Controlling Logic                          *
.*********************************************************************
ML0000    CALL      INIT0000
.
ML0500    CALL      OPTN0000                * enter option
          BRANCH    EXIT,ML9999             * exit
          BRANCH    OPTION,ML1000,ML2000,ML3000,ML3200,ML3500
.
.         do the Audits
.
ML1000    CALL      DAUD0000
          CALL      KAUD0000
          BRANCH    EXIT,ML0500
          CALL      WAUD0000
          GOTO      ML0500
.
.         Do THE IBA  Controlled Screen 1
.
ML2000    CALL      IBASECUR                * Keyin IBA screen security passwd
          BRANCH    EXIT,ML0500
.
ML2100    CALL      IBAO0000                * IBA option menus
          BRANCH    EXIT,ML0500
          
          PERFORM   OPTION,RIBA0000
          PERFORM   OPTION,DIBA0000
          PERFORM   OPTION,KIBA0000
          BRANCH    EXIT,ML2100
          PERFORM   OPTION,WIBA0000
          GOTO      ML2100
.
.         Do the Hospital controlled screen 1
.
ML3000    CALL      RHSA0000                * read original data
          CALL      DHSA0000                * display screen
          CALL      KHSA0000                * keyin data
          BRANCH    EXIT,ML0500             * exit entered
          CALL      WHSA0000                * update values
          GOTO      ML0500
.
.         Do the Hospital controlled screen 2
.
ML3200    CALL      RHSB0000                * read original data
          CALL      DHSB0000                * display screen
          CALL      KHSB0000                * keyin data
          BRANCH    EXIT,ML0500             * exit entered
          CALL      WHSB0000                * update values
          GOTO      ML0500
.
.         Do the Theatre times screen
.
ML3500    CALL      RTHT0000                * read original data
          CALL      DTHT0000                * display screen
          CALL      KTHT0000                * keyin data
          BRANCH    EXIT,ML0500             * exit entered
          CALL      WTHT0000                * update values
          GOTO      ML0500
.
ML9999    CHAIN     PGM
+
.*********************************************************************
.*                  INIT0000                    Called by : ML0000   *
.*        Initialization and open files                              *
.*********************************************************************
INIT0000  CALL      DISPHEAD
.
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening patcodes";
          OPEN      PATCODE1,"patcodes"
          OPEN      PATCODE2,"patcodes"
          DISPLAY   *P56:24,"Opening fmslmaaf";
          OPEN      FMSLMAA1,"fmslmaaf"
          DISPLAY   *P56:24,"Opening outsitaf";
          OPEN      OUTSITA1,"outsitaf"
          MOVE      ONE,CNEWDS              * new ? mark
          MOVE      ZERO,HLEF
.
INIT9999  RETURN
+
.*********************************************************************
.*                  OPTN0000                    Called by : ML0500   *
.*        Enter the screen desired                                   *
.*********************************************************************
OPTN0000  HLINE     *G37,2,53,80
          MOVE      ZERO,REPFLAG
          DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON,ZERO,*HOFF," = Exit":
                    *P1:5,*V2LON,ONE,*HOFF:
                    " = Audits ":
                    *P1:6,*V2LON,TWO,*HOFF:
                    " = I.B.A. Controlled Screens ":
                    *P1:7,*V2LON,THREE,*HOFF:
                    " = Hospital Controlled Screen 1":
                    *P1:8,*V2LON,FOUR,*HOFF:
                    " = Hospital Controlled Screen 2":
                    *P1:9,*V2LON,FIVE,*HOFF:
                    " = Theatre Times";
.
OPTN1000  KEYIN     *P1:11,*EL,"Please Select : ",*V2LON,OPTION
.
          MOVE      ZERO,EXIT
          BRANCH    OPTION,OPTN9999,OPTN9999,OPTN9999,OPTN9999,OPTN9999
          MOVE      ONE,EXIT
          COMPARE   ZERO,OPTION
          GOTO      OPTN9999 IF EQUAL       * exit selected
          BEEP
          GOTO      OPTN1000
.
OPTN9999  RETURN
+
TEAM0000  DISPLAY *P53:ROW,*EL,"per team    "
TEAM9999  RETURN
BOOK0000  DISPLAY *P53:ROW,*EL,"per booking "
BOOK9999  RETURN
+
.*********************************************************************
.*                  DAUD0000                    Called by : ML5100   *
.*        DISPlay AUDit screen                                       *
.*********************************************************************
DAUD0000  READ      CONTROLF,SEVENTY1;*109,CCCNAUDA
.
          DISPLAY   *P53:2,*V2LON,"- Audits ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". G.L. Translation   :":
                    *P1:05,*V2LON," 2",*HOFF,". Audit B (Not used) :":
                    *P1:06,*V2LON," 3",*HOFF,". Audit C (Not used) :":
                    *P1:07,*V2LON," 4",*HOFF,". Audit D (Not used) :":
                    *P1:08,*V2LON," 5",*HOFF,". Audit E (Not used) :":
                    *P1:09,*V2LON," 6",*HOFF,". Audit F (Not used) :":
                    *P1:10,*V2LON," 7",*HOFF,". Audit G (Not used) :":
                    *P1:11,*V2LON," 8",*HOFF,". Audit H (Not used) :":
                    *P1:12,*V2LON," 9",*HOFF,". Audit I (Not Used) :":
                    *P1:13,*V2LON,"10",*HOFF,". Audit J (Not used) :":
                    *P1:14,*V2LON,"11",*HOFF,". Audit K (Not used) :":
                    *P1:15,*V2LON,"12",*HOFF,". Audit L (Not used) :":
                    *P1:16,*V2LON,"13",*HOFF,". Audit M (Not Used) :":
                    *P41:4,*V2LON,"14",*HOFF,". Audit N (Not Used) :":
                    *P41:5,*V2LON,"15",*HOFF,". Audit O (Not Used) :":
                    *P41:6,*V2LON,"16",*HOFF,". Audit P (Not Used) :":
                    *P41:7,*V2LON,"17",*HOFF,". Audit Q (Not used) :":
                    *P41:8,*V2LON,"18",*HOFF,". Audit R (Not used) :":
                    *P41:9,*V2LON,"19",*HOFF,". Audit S (Not used) :":
                    *P41:10,*V2LON,"20",*HOFF,". Audit T (Not Used) :":
                    *P41:11,*V2LON,"21",*HOFF,". Audit U (Not used) :":
                    *P41:12,*V2LON,"22",*HOFF,". Audit V (Not used) :":
                    *P41:13,*V2LON,"23",*HOFF,". Audit W (Not used) :":
                    *P41:14,*V2LON,"24",*HOFF,". Audit X (Not used) :":
                    *P41:15,*V2LON,"25",*HOFF,". Audit Y (Not used) :":
                    *P41:16,*V2LON,"26",*HOFF,". Audit Z (Not used) :"
.
          MOVE      ZERO,FORM2
          MOVE      THREE,CVERT
          MOVE      "26",CCOL
.
DAUD1000  ADD       ONE,FORM2
          ADD       ONE,CVERT
          COMPARE   "27",FORM2
          GOTO      DAUD9999 IF EQUAL       * finished
.
          COMPARE   "17",CVERT
          GOTO      DAUD2000 IF LESS
.
          MOVE      FOUR,CVERT
          MOVE      "66",CCOL
.
DAUD2000  LOAD      FIELD,FORM2,CCCNAUDA,ONE,ONE,ONE,ONE:
                                ONE,ONE,ONE,ONE,ONE:
                                ONE,ONE,ONE,ONE,ONE:
                                ONE,ONE,ONE,ONE,ONE:
                                ONE,ONE,ONE,ONE,ONE:
                                ONE
          MOVE      DYES,DANSX
          LOAD      DANSX,FIELD,DNO
          DISPLAY   *PCCOL:CVERT,*V2LON,DANSX;
          GOTO      DAUD1000
.
DAUD9999  RETURN
+
.*********************************************************************
.*                  KAUD0000                    Called by : ML5100   *
.*        update audit screen                                        *
.*********************************************************************
KAUD0000  CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      KAUD9900 IF EQUAL       * Post
          GOTO      KAUD9910 IF LESS        * cancel
.
          BRANCH    CCITEM,KAUD1000
.
          BEEP    
          GOTO      KAUD0000
.
KAUD1000  MOVE      "26",CCOL               * set column
          MOVE      THREE,CVERT             * set up row
          ADD       CCITEM,CVERT            * get the row
.
          COMPARE   "17",CVERT
          GOTO      KAUD2000 IF LESS        * on LHS of screen
.
          MOVE      "66",CCOL               * set col
          SUB       "13",CVERT              * set row
.
KAUD2000  KEYIN     *PCCOL:CVERT,*DV,SP3:
                    *PCCOL:CVERT,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          CMATCH    ANSY,ANS
          GOTO      KAUD3000 IF EQUAL       * Yes
          CMATCH    ANSN,ANS
          GOTO      KAUD3100 IF EQUAL       * No
.
          BEEP
          GOTO      KAUD2000
.
KAUD3000  MOVE      DYES,DANSX
          MOVE      ZERO,FORM1
          GOTO      KAUD4000
.
KAUD3100  MOVE      DNO,DANSX
          MOVE      ONE,FORM1
.
KAUD4000  STORE     FORM1,CCITEM,CCCNAUDA
          DISPLAY   *PCCOL:CVERT,*V2LON,DANSX
          GOTO      KAUD0000
.
.         set exit flags
.
KAUD9900  MOVE      ZERO,EXIT              * post
          GOTO      KAUD9999
.
KAUD9910  MOVE      ONE,EXIT               * cancel
.
KAUD9999  RETURN
+
.*********************************************************************
.*                  WAUD0000                    Called by : ML5100   *
.*        Update values for Audit screen                             *
.*********************************************************************
WAUD0000  WRITAB    CONTROLF,SEVENTY1;*109,CCCNAUDA
          DISPLAY   *P60:24,*V2LON,"*** Posted ***";
WAUD9999  RETURN
+
.*********************************************************************
.*                  IBAO0000                    Called by : ML0500   *
.*        Enter the screen desired                                   *
.*********************************************************************
IBAO0000  DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON,ZERO,*HOFF," = Exit":
                    *P1:5,*V2LON,ONE,*HOFF:
                    " = System Parameters"
.
IBAO1000  KEYIN     *P1:7,*EL,"Please Select : ",*V2LON,OPTION
.
          BRANCH    OPTION,IBAO9000
          COMPARE   ZERO,OPTION
          GOTO      IBAO9100 IF EQUAL       * exit selected
.
          BEEP
          GOTO      IBAO1000
.
IBAO9000  MOVE      ZERO,EXIT               * contine
          GOTO      IBAO9999
.
IBAO9100  MOVE      ONE,EXIT                * exit selected
.
IBAO9999  RETURN
+
.*********************************************************************
.*        Read the original data for IBA screen A                    *
.*********************************************************************
RIBA0000  READ      CONTROLF,SEVENTY1;*15,CCCNDATA,*69,CCCNDELY,*94,CCCNVUFM:
                                      *99,CCCNBATC,*107,CCCNUFCD,*194,CCCNECPA:
                                      *198,CCCNSERV,*200,CCCNSVHM
          RETURN
.
.*********************************************************************
.*                  DIBA0000                    Called by : ML2000   *
.*        Display IBA screen A                                       *
.*********************************************************************
DIBA0000  DISPLAY   *P53:2,*V2LON,"- I.B.A System Parameters ",*P1:3,*EF,*HOFF:
                    *P1:4,*V2LON," 1",*HOFF:
                          ". (No longer used)                                :":
                    *P1:5,*V2LON," 2",*HOFF:
                          ". (No longer used)                                :":
                    *P1:6,*V2LON," 3",*HOFF:
                          ". (No longer used)                                :":
                    *P1:7,*V2LON," 4",*HOFF:
                          ". CCI Data Directory                              :":
                    *P1:8,*V2LON," 5",*HOFF:
                          ". No. of Days Delay for Auto Extract (CCI69)      :":
                    *P1:9,*V2LON," 6",*HOFF:
                          ". Format for CCIVOL/CCIUTL (CCI24) ?              :":
                    *P1:10,*V2LON," 7",*HOFF:
                          ". Next Batch Number (Zero for manual)             :":
                    *P1:11,*V2LON," 8",*HOFF:
                          ". Costing Department to be used                   :":
                    *P1:12,*V2LON," 9",*HOFF:
                          ". Extr. Contracts Payment Advisor Rec. Type (Y/N) :":
                    *P1:13,*V2LON,"10",*HOFF:
                          ". Using Health Service Code/Ordering Doctor (Y/N) :":
                    *P1:14,*V2LON,"11",*HOFF:
                          ". Using SVHM Transition II (Y/N)                  :":
                    *P55:7,*V2LON,CCCNDATA,*P55:8,CCCNDELY,*P55:9,CCCNVUFM:
                    *P55:10,CCCNBATC
.
          MOVE      TYPE0,KEY11
          LOAD      KEY11,CCCNVUFM,TYPE1
          DISPLAY   *P55:9,*V2LON,KEY11
.
          MOVE      COSDEP1,COSDEPT
          LOAD      COSDEPT,CCCNUFCD,COSDEP2,COSDEP3
          DISPLAY   *P55:11,*V2LON,COSDEPT
.
          MOVE      DNO,KEY3
          LOAD      KEY3,CCCNECPA,DYES
          DISPLAY   *P55:12,*V2LON,KEY3
.
          MOVE      DNO,KEY3
          LOAD      KEY3,CCCNSERV,DYES
          DISPLAY   *P55:13,*V2LON,KEY3
.
          MOVE      DNO,KEY3
          LOAD      KEY3,CCCNSVHM,DYES
          DISPLAY   *P55:14,*V2LON,KEY3
.
DIBA9999  RETURN
.
.*********************************************************************
.*                  KIBA0000                    Called by : ML2000   *
.*        Change the data for IBA screen A/1                         *
.*********************************************************************
KIBA0000  CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      KIBA9900 IF EQUAL       * Post entered
          GOTO      KIBA9910 IF LESS        * Cancel entered
.
          BRANCH    CCITEM,KIBA0100,KIBA0200,KIBA0300,KIBA0400,KIBA0500:
                           KIBA0600,KIBA0700,KIBA0800,KIBA0900,KIBA1000:
                           KIBA1100
.
          BEEP
          GOTO      KIBA0000
.
KIBA0100  GOTO      KIBA0000
.
KIBA0200  GOTO      KIBA0000
.
KIBA0300  GOTO      KIBA0000
.
.         CCI data directory
.
KIBA0400  DISPLAY   *P1:24,*EL,*V2LON:
                    "** Note : Directory must be full path & ":
                    " have a SLASH as THE last character **"

          KEYIN     *P55:7,*DV,UNDLN10,*DV,UNDLN10:
                    *P55:7,*V2LON,CCCNDATA,*P55:7,*DV,CCCNDATA
.
          ENDSET    CCCNDATA
          APPEND    SP30,CCCNDATA
          RESET     CCCNDATA
          GOTO      KIBA0000
.
.         Number of days delay for auto extract
.
KIBA0500  KEYIN     *P55:8,*EL,*DV,UNDLN1:
                    *P55:8,*V2LON,CCCNDELY
.
          DISPLAY   *P55:8,*V2LON,CCCNDELY
          GOTO      KIBA0000
.
.         which type of interface
.
KIBA0600  DISPLAY   *P1:24,*EL,*V2LON,"0",*HOFF," = ",TYPE0,", ":
                    *V2LON,"1",*HOFF," = ",TYPE1
          KEYIN     *P55:9,*EL,*V2LON,CCCNVUFM:
                    *P55:9,*DV,CCCNVUFM
          BRANCH    CCCNVUFM,KIBA0620
          COMPARE   ZERO,CCCNVUFM
          GOTO      KIBA0620 IF EQUAL
          BEEP
          GOTO      KIBA0600
.
KIBA0620  MOVE      TYPE0,KEY11
          LOAD      KEY11,CCCNVUFM,TYPE1
          DISPLAY   *P55:9,*EL,*V2LON,KEY11
          GOTO      KIBA0000
.
.         next batch number 
.
KIBA0700  KEYIN     *P55:10,*EL,*V2LON,CCCNBATC:
                    *P55:10,*DV,CCCNBATC;
.
          IF        CCCNBATC < 0
             BEEP
             GOTO      KIBA0700
          ENDIF
          GOTO      KIBA0000
.
.         using four character department ??
.
KIBA0800  CALL      COST0000
          GOTO      KIBA0000
.
.         Extracting "Contracts Payment Advisor" Record Type
.
KIBA0900  MOVE      TEN2,CVERT
          MOVE      "55",CCOL
          CALL      KYN0000
          MOVE      EXIT,CCCNECPA           * set the value
          GOTO      KIBA0000
.
.         Using Health Service Code/Ordering Doctor          
.
KIBA1000  MOVE      TEN3,CVERT
          MOVE      "55",CCOL
          CALL      KYN0000
          MOVE      EXIT,CCCNSERV           * set the value
          GOTO      KIBA0000
.
KIBA1100  MOVE      TEN4,CVERT
          MOVE      "55",CCOL
          CALL      KYN0000
          MOVE      EXIT,CCCNSVHM           * Set the value
          GOTO      KIBA0000
.
KIBA9900  MOVE      ZERO,EXIT              * Post
          GOTO      KIBA9999
KIBA9910  MOVE      ONE,EXIT               * Cancel
.
KIBA9999  RETURN
+
.****************************************************************************
.*                            COST0000                 Called by: KIBA0000  *
.*               Get the type of costing department used                    *
.****************************************************************************
.
COST0000  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = Normal, ",*V2LON,ONE,*HOFF:
                    " = Trendstar, ",*V2LON,TWO,*HOFF," = Transition"
.
          KEYIN     *P55:11,*EL:
                    *P55:11,*V2LON,*RV,CCCNUFCD:
                    *P55:11,*DV,CCCNUFCD
.
          COMPARE   ZERO,CCCNUFCD
          GOTO      COST5000 IF EQUAL
.
          BRANCH    CCCNUFCD,COST5000,COST5000
.
          BEEP
          GOTO      COST0000
.
COST5000  MOVE      COSDEP1,COSDEPT
          LOAD      COSDEPT,CCCNUFCD,COSDEP2,COSDEP3
          DISPLAY   *P55:11,*V2LON,COSDEPT
.
COST9999  RETURN
+
.*********************************************************************
.*        write the values for IBA screen A
.*********************************************************************
WIBA0000  WRITAB    CONTROLF,SEVENTY1;*15,CCCNDATA,*69,CCCNDELY,*94,CCCNVUFM:
                                      *99,CCCNBATC,*107,CCCNUFCD,*194,CCCNECPA:
                                      *198,CCCNSERV,*200,CCCNSVHM
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***";
          RETURN
+
.*********************************************************************
.*                  RHSA0000                    Called by : ML3000   *
.*        Read the original data for hospital screen A               *
.*********************************************************************
RHSA0000  READ      CONTROLF,SEVENTY1;*43,CCCNPCTP,CCCNAECD,CCCNBRDR,CCCNBDCD:
                                          CCCNIPCD,CCCNDCCD,CCCNOPCD,CCCNAECO:
                                      *84,CCCNOPO1,CCCNOPO2,CCCNOPO3:
                                          CCCNOPO4,CCCNOPO5,CCCNOPO6,CCCNOPO7:
                                      *91,CCCNVPRO,CCCNFYOS,CCCNCLFL:
                                      *108,CCCNGLCF
RHSA9999  RETURN
+
.*********************************************************************
.*                  DHSA0000                    Called by : ML3000   *
.*        Display the hospital screen                                *
.*********************************************************************
DHSA0000  DISPLAY   *P1:3,*EF,*P53:2,*V2LON,"- Hospital Screen 1 ",*HOFF:
                    *P1:4,*V2LON," 1",*HOFF:
                      ". Temp File Name for PC Interface to CCI      :":
                    *P1:5,*V2LON," 2",*HOFF:
                      ". Clinical department code for A&E            :":
                    *P1:6,*V2LON," 3",*HOFF:
                      ". Code for Boarder                            :":
                    *P1:7,*V2LON," 4",*HOFF:
                      ". Patient Type for Boarder                    :":
                    *P1:8,*V2LON," 5",*HOFF:
                      ". Default code for IP (Inpatients)            :":
                    *P1:9,*V2LON," 6",*HOFF:
                      ". Default code for DC (Day case)              :":
                    *P1:10,*V2LON," 7",*HOFF:
                      ". Default code for OP (Outpatients)           :":
                    *P1:11,*V2LON," 8",*HOFF:
                      ". Default code for AE (A&E)                   :":
                    *P1:12,*V2LON," 9",*HOFF:
                      ". Theatre setup procedure per team ?          :":
                    *P1:13,*V2LON,"10",*HOFF:
                      ". Theatre operation procedure per team ?      :":
                    *P1:14,*V2LON,"11",*HOFF:
                      ". Theatre known infection procedure per team ?:":
                    *P1:15,*V2LON,"12",*HOFF:
                      ". Theatre expensive item procedure per team ? :":
                    *P1:16,*V2LON,"13",*HOFF:
                      ". Theatre recovery procedure per team ?       :":
                    *P1:17,*V2LON,"14",*HOFF:
                      ". Theatre anaesthetic procedure per team ?    :":
                    *P1:18,*V2LON,"15",*HOFF:
                      ". Theatre after hours procedure per team ?    :":
                    *P1:19,*V2LON,"16",*HOFF:
                      ". Validate procedures for external batches ?  :":
                    *P1:20,*V2LON,"17",*HOFF:
                      ". Fiscal Year offset (0 or 1 years ) ?        :":
                    *P1:21,*V2LON,"18",*HOFF:
                      ". Clear files for handover (Y/N) (CCI24,25,56):":
                    *P1:22,*V2LON,"19",*HOFF:
                      ". Clear Handover file for G.L. (Y/N) (CCI63)  :":
                    *P51:4,*V2LON,CCCNPCTP:
                    *P51:5,CCCNAECD:
                    *P51:6,CCCNBRDR:
                    *P51:7,CCCNBDCD:
                    *P51:8,CCCNIPCD:
                    *P51:9,CCCNDCCD:
                    *P51:10,CCCNOPCD:
                    *P51:11,CCCNAECO 
          DISPLAY   *P51:12,*V2LON,CCCNOPO1 
          MOVE      TEN2,ROW
          IF        CCCNOPO1 = 1
            CALL      BOOK0000
          ELSE
            CALL      TEAM0000
          ENDIF
          DISPLAY   *P51:13,*V2LON,CCCNOPO2 
          MOVE      TEN3,ROW
          IF        CCCNOPO2 = 1
            CALL      BOOK0000
          ELSE
            CALL      TEAM0000
          ENDIF
          DISPLAY   *P51:14,*V2LON,CCCNOPO3 
          MOVE      TEN4,ROW
          IF        CCCNOPO3 = 1
            CALL      BOOK0000
          ELSE
            CALL      TEAM0000
          ENDIF
          DISPLAY   *P51:15,*V2LON,CCCNOPO4 
          MOVE      TEN5,ROW
          IF        CCCNOPO4 = 1
            CALL      BOOK0000
          ELSE
            CALL      TEAM0000
          ENDIF
          DISPLAY   *P51:16,*V2LON,CCCNOPO5 
          MOVE      TEN6,ROW
          IF        CCCNOPO5 = 1
            CALL      BOOK0000
          ELSE
            CALL      TEAM0000
          ENDIF
          DISPLAY   *P51:17,*V2LON,CCCNOPO6 
          MOVE      TEN7,ROW
          IF        CCCNOPO6 = 1
            CALL      BOOK0000
          ELSE
            CALL      TEAM0000
          ENDIF
          DISPLAY   *P51:18,*V2LON,CCCNOPO7 
          MOVE      TEN8,ROW
          IF        CCCNOPO7 = 1
            CALL      BOOK0000
          ELSE
            CALL      TEAM0000
          ENDIF
.
          MOVE      DNO,DYN01
          LOAD      DYN01,CCCNVPRO,DYES
          DISPLAY   *P51:19,*V2LON,DYN01

          MOVE      DNO,DYN01
          LOAD      DYN01,CCCNCLFL,DYES
          MOVE      DNO,DYN02
          LOAD      DYN02,CCCNGLCF,DYES
          DISPLAY   *P51:20,*V2LON,CCCNFYOS:
                    *P51:21,DYN01,*P51:22,DYN02
.
DHSA9999  RETURN
+
.*********************************************************************
.*                  KHSA0000                    Called by : ML3000   *
.*        Change the data for Hospital Screen A/1                    *
.*********************************************************************
KHSA0000  CALL      MAINQST
          MOVE      ZERO,CKYIMAND
          BRANCH    CCITEM,KHSA0100,KHSA0200,KHSA0300,KHSA0400,KHSA0500:
                           KHSA0600,KHSA0700,KHSA0800,KHSA0900,KHSA1000:
                           KHSA1100,KHSA1200,KHSA1300,KHSA1400,KHSA1500:
                           KHSA1600,KHSA1700,KHSA1800,KHSA1900
.
          COMPARE   ZERO,CCITEM
          GOTO      KHSA9900 IF EQUAL       * Post selected
          GOTO      KHSA9910 IF LESS        * Cancel selected
.
          BEEP
          GOTO      KHSA0000
.
.         temp file name for PC interface to CCI
.
KHSA0100  KEYIN     *P51:4,*EL,*DV,UNDLN5:
                    *P51:4,*V2LON,CCCNPCTP:
                    *P51:4,*DV,CCCNPCTP
.
          ENDSET    CCCNPCTP
          APPEND    SP5,CCCNPCTP
          RESET     CCCNPCTP
          GOTO      KHSA0000
.
.         Clinical department code for A&E
.
KHSA0200  KEYIN     *P51:5,*EL,*DV,UNDLN3:
                    *P51:5,*V2LON,CCCNAECD:
                    *P51:5,*DV,CCCNAECD
.
          ENDSET    CCCNAECD
          APPEND    SP3,CCCNAECD
          RESET     CCCNAECD
.
          DISPLAY   *P51:5,*V2LON,CCCNAECD
          GOTO      KHSA0000
.
.         Code for Boarder
.
KHSA0300  MOVE      "51",ECOL               * Column for keyin
          MOVE      "6",EVERT               * Line for keyin
          MOVE      CATP,CODE               * Category for religion
          MOVE      CCCNBRDR,CKYIDEF3
          MOVE      SP3,CCCNBRDR
.
          CALL      PATCODKY                * Keyin the code
          BRANCH    EXIT,KHSA0000,KHSA9910
.
          MOVE      ACODE,CCCNBRDR          * the code
          DISPLAY   *P51:6,*V2LON,CCCNBRDR
          GOTO      KHSA0000
.
.         Patient type for Boarder
.
KHSA0400  MOVE      "51",ECOL               * Column for keyin
          MOVE      "7",EVERT               * Line for keyin
          MOVE      CATRP,CODE              * Category for religion
          MOVE      CCCNBDCD,CKYIDEF3       * clear the field
.
          CALL      PATCODKY                * Keyin the code
          BRANCH    EXIT,KHSA0000,KHSA9910
          MOVE      ACODE,CCCNBDCD          * the code
          DISPLAY   *P51:7,*V2LON,CCCNBDCD
          GOTO      KHSA0000
.
.         enter default code for IP
.
KHSA0500  MOVE      "51",ECOL               * Column for keyin
          MOVE      "8",EVERT               * Line for keyin
          MOVE      CATRP,CODE              * Category for religion
          MOVE      CCCNIPCD,CKYIDEF3       * clear the field
.
          CALL      PATCODKY                * Keyin the code
          BRANCH    EXIT,KHSA0000,KHSA9910
          MOVE      ACODE,CCCNIPCD          * the code
          DISPLAY   *P51:8,*V2LON,CCCNIPCD
          GOTO      KHSA0000
.
.         enter default code for DC
.
KHSA0600  MOVE      "51",ECOL               * Column for keyin
          MOVE      "9",EVERT               * Line for keyin
          MOVE      CATRP,CODE              * Category for religion
          MOVE      CCCNDCCD,CKYIDEF3       * clear the field
.
          CALL      PATCODKY                * Keyin the code
          BRANCH    EXIT,KHSA0000,KHSA9910
.
          MOVE      ACODE,CCCNDCCD          * the code
          DISPLAY   *P51:9,*V2LON,CCCNDCCD
          GOTO      KHSA0000
.
.         enter default code for OP
.
KHSA0700  MOVE      "51",ECOL               * Column for keyin
          MOVE      "10",EVERT              * Line for keyin
          MOVE      CATRP,CODE              * Category for religion
          MOVE      CCCNOPCD,CKYIDEF3       * clear the field
.
          CALL      PATCODKY                * Keyin the code
          BRANCH    EXIT,KHSA0000,KHSA9910
          MOVE      ACODE,CCCNOPCD          * the code
          DISPLAY   *P51:10,*V2LON,CCCNOPCD
          GOTO      KHSA0000
.
.         enter default code for AE
.
KHSA0800  MOVE      "51",ECOL               * Column for keyin
          MOVE      "11",EVERT              * Line for keyin
          MOVE      CATRP,CODE              * Category for religion
          MOVE      CCCNAECO,CKYIDEF3       * clear the field
.
          CALL      PATCODKY                * Keyin the code
          BRANCH    EXIT,KHSA0000,KHSA9910
.
          MOVE      ACODE,CCCNAECO          * the code
          DISPLAY   *P51:11,*V2LON,CCCNAECO
          GOTO      KHSA0000
.
. Theatre setup procedure per team ?
.
KHSA0900  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = per team, ":
                    *V2LON,ONE,*HOFF," = per booking "
          KEYIN     *P51:12,*EL,*DV,UNDLN1:
                    *P51:12,*V2LON,CCCNOPO1:
                    *P51:12,*DV,CCCNOPO1
          
          IF        CCCNOPO1 > 1
            BEEP
            GOTO      KHSA0900
          ENDIF
          MOVE      TEN2,ROW
          IF        CCCNOPO1 = 1
            CALL      BOOK0000
          ELSE
            CALL      TEAM0000
          ENDIF
          GOTO      KHSA0000
.
. Theatre operation procedure per team ?
.
KHSA1000  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = per team, ":
                    *V2LON,ONE,*HOFF," = per booking "
          KEYIN     *P51:13,*EL,*DV,UNDLN1:
                    *P51:13,*V2LON,CCCNOPO2:
                    *P51:13,*DV,CCCNOPO2
          
          IF        CCCNOPO2 > 1
            BEEP
            GOTO      KHSA1000
          ENDIF
          MOVE      TEN3,ROW
          IF        CCCNOPO2 = 1
            CALL      BOOK0000
          ELSE
            CALL      TEAM0000
          ENDIF
          GOTO      KHSA0000
.
. Theatre known infection procedure per team ?
.
KHSA1100  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = per team, ":
                    *V2LON,ONE,*HOFF," = per booking "
          KEYIN     *P51:14,*EL,*DV,UNDLN1:
                    *P51:14,*V2LON,CCCNOPO3:
                    *P51:14,*DV,CCCNOPO3
          
          IF        CCCNOPO3 > 1
            BEEP
            GOTO      KHSA1100
          ENDIF
          MOVE      TEN4,ROW
          IF        CCCNOPO3 = 1
            CALL      BOOK0000
          ELSE
            CALL      TEAM0000
          ENDIF
          GOTO      KHSA0000
.
. Theatre expensive item procedure per team ?
.
KHSA1200  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = per team, ":
                    *V2LON,ONE,*HOFF," = per booking "
          KEYIN     *P51:15,*EL,*DV,UNDLN1:
                    *P51:15,*V2LON,CCCNOPO4:
                    *P51:15,*DV,CCCNOPO4
          
          IF        CCCNOPO4 > 1
            BEEP
            GOTO      KHSA1200
          ENDIF
          MOVE      TEN5,ROW
          IF        CCCNOPO4 = 1
            CALL      BOOK0000
          ELSE
            CALL      TEAM0000
          ENDIF
          GOTO      KHSA0000
.
. Theatre recovery procedure per team ?
.
KHSA1300  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = per team, ":
                    *V2LON,ONE,*HOFF," = per booking "
          KEYIN     *P51:16,*EL,*DV,UNDLN1:
                    *P51:16,*V2LON,CCCNOPO5:
                    *P51:16,*DV,CCCNOPO5
          
          IF        CCCNOPO5 > 1
            BEEP
            GOTO      KHSA1300
          ENDIF
          MOVE      TEN6,ROW
          IF        CCCNOPO5 = 1
            CALL      BOOK0000
          ELSE
            CALL      TEAM0000
          ENDIF
          GOTO      KHSA0000
.
. Theatre anaestheic procedure per team ?
.
KHSA1400  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = per team, ":
                    *V2LON,ONE,*HOFF," = per booking "
          KEYIN     *P51:17,*EL,*DV,UNDLN1:
                    *P51:17,*V2LON,CCCNOPO6:
                    *P51:17,*DV,CCCNOPO6
          
          IF        CCCNOPO6 > 1
            BEEP
            GOTO      KHSA1400
          ENDIF
          MOVE      TEN7,ROW
          IF        CCCNOPO6 = 1
            CALL      BOOK0000
          ELSE
            CALL      TEAM0000
          ENDIF
          GOTO      KHSA0000
.
. Theatre after hours procedure per team ?
.
KHSA1500  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = per team, ":
                    *V2LON,ONE,*HOFF," = per booking "
          KEYIN     *P51:18,*EL,*DV,UNDLN1:
                    *P51:18,*V2LON,CCCNOPO7:
                    *P51:18,*DV,CCCNOPO7
          
          IF        CCCNOPO7 > 1
            BEEP
            GOTO      KHSA1500
          ENDIF
          MOVE      TEN8,ROW
          IF        CCCNOPO7 = 1
            CALL      BOOK0000
          ELSE
            CALL      TEAM0000
          ENDIF
          GOTO      KHSA0000
.
. ------ validate procedure for external batches ? ------
.
KHSA1600  MOVE      "51",CCOL                * column for keyin
          MOVE      TEN9,CVERT               * row for keyin
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,CCCNVPRO            * set parameter
          GOTO      KHSA0000
.
.------   Fiscal year offset -----
.
KHSA1700  KEYIN     *P51:20,*DV,UNDLN1:   
                    *P51:20,*V2LON,FORM1:   
                    *P51:20,*DV,FORM1      
. 
          IF        FORM1 > 1
            BEEP
            GOTO      KHSA1700
          ENDIF
.
          MOVE      FORM1,CCCNFYOS
          GOTO      KHSA0000
.
. ------ Clear files for run - ibacci24 ibacci25  ------
.
KHSA1800  MOVE      "51",CCOL                * column for keyin
          MOVE      "21",CVERT               * row for keyin
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,CCCNCLFL            * set parameter
          GOTO      KHSA0000
.
. ------ Clear files for handover - ibacci63 ------
.
KHSA1900  MOVE      "51",CCOL                * column for keyin
          MOVE      "22",CVERT               * row for keyin
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,CCCNGLCF            * set parameter
          GOTO      KHSA0000
.
.         set exit flags
.
KHSA9900  MOVE      ZERO,EXIT               * Post
          GOTO      KHSA9999
.
KHSA9910  MOVE      ONE,EXIT                * cancel

KHSA9999  RETURN
+
.*********************************************************************
.*                  WHSA0000                    Called by : ML3000   *
.*        Write the values for Hospital screen A                     *
.*********************************************************************
WHSA0000  WRITAB    CONTROLF,SEVENTY1;*43,CCCNPCTP,CCCNAECD:
                                        CCCNBRDR,CCCNBDCD:
                    CCCNIPCD,CCCNDCCD,CCCNOPCD,CCCNAECO:
                    *84,CCCNOPO1,CCCNOPO2,CCCNOPO3,CCCNOPO4,CCCNOPO5:
                    CCCNOPO6,CCCNOPO7,*91,CCCNVPRO,*92,CCCNFYOS,*93,CCCNCLFL:
                    *108,CCCNGLCF
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***"
WHSA9999  RETURN
+
.*********************************************************************
.*                  RHSB0000                                         *
.*        Read the original data for hospital screen B               *
.*********************************************************************
RHSB0000  READ      CONTROLF,SEVENTY1;*158,CCCNDLDG,*162,CCCNSITE,*184,CCCNXRPT:
                                      CCCNVDPT,CCCNPRTL,*191,CCCNTSHC,*195:
                                      CCCNAEDP,*199,CCCNOUTL,*201,CCCNX7SD:
                                      *209,CCCNX7FP
RHSB9999  RETURN
+
.*********************************************************************
.*                  DHSB0000
.*        Display the hospital screen B
.*********************************************************************
DHSB0000  DISPLAY   *P53:2,*V2LON,"- Hospital Screen 2 ",*P1:3,*EF
.
          MOVE      DNO,DANS3
          LOAD      DANS3,CCCNXRPT,DYES
          MOVE      DNO,DANS4
          LOAD      DANS4,CCCNVDPT,DYES
          MOVE      DNO,DANS5
          LOAD      DANS5,CCCNPRTL,DYES
          MOVE      DYES,DANS6
          LOAD      DANS6,CCCNOUTL,DNO
.
          UNPACK    CCCNX7SD,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,X7STRTDT
.
          DISPLAY   *P1:4,*V2LON," 1",*HOFF:
                      ". Default Ledger Number                       :":
                    *V2LON,*P51:4,CCCNDLDG:
                    *P1:5,*V2LON," 2",*HOFF:
                      ". Default Site for Trendstar handover (CCI56) :":
                    *V2LON,*P51:5,CCCNSITE:
                    *P1:6,*V2LON," 3",*HOFF:
                      ". Do reporting in extract programs (Y/N)      :":
                    *V2LON,*P51:6,DANS3,*HOFF:
                    *P1:7,*V2LON," 4",*HOFF:
                      ". Validate Department in IBACCI42 (Y/N)       :":
                    *V2LON,*P51:7,DANS4,*HOFF:
                    *P1:8,*V2LON," 5",*HOFF:
                      ". Using Manual Procedures Translation (Y/N)   :":
                    *V2LON,*P51:8,DANS5,*HOFF:
                    *P1:9,*V2LON," 6",*HOFF:
                      ". Trendstar Hospital Code                     :":
                    *V2LON,*P51:9,CCCNTSHC,*HOFF:
                    *P1:10,*V2LON," 7",*HOFF:
                      ". A&E Extract Default Department              :":
                    *V2LON,*P51:10,CCCNAEDP,*HOFF:
                    *P1:11,*V2LON," 8",*HOFF:
                      ". Using Linked Outpatient Events (Y/N)        :":
                    *V2LON,*P51:11,DANS6,*HOFF:
                    *P1:12,*V2LON," 9",*HOFF:
                      ". Start Date for Extract 7                    :":
                    *V2LON,*P51:12,X7STRTDT,*HOFF:
                    *P1:13,*V2LON,"10",*HOFF:
                      ". Extract 7 File path                         :":
                    *V2LON,*P51:13,CCCNX7FP,*HOFF
.
          MOVE      SP30,FMLADESC
          MOVE      CCCNDLDG,KEY2
          CALL      RDFMLA1
          MOVE      FMLADESC,KEY20
          DISPLAY   *P60:4,KEY20
.
          MOVE      SP30,OSTDESC
          MOVE      CCCNSITE,KEY6
          CALL      RDSITA1
          MOVE      OSTDESC,KEY20
          DISPLAY   *P60:5,KEY20
.
DHSB9999  RETURN
+
.*********************************************************************
.*                  KHSB0000
.*        Change the data for Hospital Screen 2
.*********************************************************************
KHSB0000  CALL      MAINQST
          BRANCH    CCITEM,KHSB0100,KHSB0200,KHSB0300,KHSB0400,KHSB0500:
                           KHSB0600,KHSB0700,KHSB0800,KHSB0900,KHSB1000
.         
          COMPARE   ZERO,CCITEM
          GOTO      KHSB9900 IF EQUAL       * Post selected
          GOTO      KHSB9910 IF LESS        * Cancel selected
.
          BEEP
          GOTO      KHSB0000
.
. ------- default ledger number -------
.
KHSB0100  MOVE      SP2,CCCNDLDG            * clear value
          KEYIN     *P51:4,*EL,*V2LON,KEY2:
                    *P51:4,*DV,KEY2
          PACK      KEY2,KEY2,SP2
          CALL      RDFMLA1
          BRANCH    OVRCD,KHSB0110
.
          MOVE      FMLALEDG,CCCNDLDG
          MOVE      FMLADESC,KEY20
          DISPLAY   *P60:4,KEY20
          GOTO      KHSB0000
.
KHSB0110  MATCH     SP2,KEY2
          GOTO      KHSB0000 IF EQUAL       * nothing entered
.
          DISPLAY   *P1:24,*B,"Invalid Ledger Number.  ",*EL;
          CALL      HITENTER
          GOTO      KHSB0100
.
. ------- keyin the default site -------
.
KHSB0200  KEYIN     *P51:5,*EL,*V2LON,KEY6:
                    *P51:5,*DV,KEY6
          PACK      KEY6,KEY6,SP6
.
          MOVE      SP6,CCCNSITE
          MATCH     SP6,KEY6
          GOTO      KHSB0000 IF EQUAL       * blank site is OK
.
          CALL      RDSITA1
          BRANCH    OVRCD,KHSB0210
.
          MOVE      OSTSITE,CCCNSITE
          MOVE      OSTDESC,KEY20
          DISPLAY   *P60:5,KEY20
          GOTO      KHSB0000
.
KHSB0210  DISPLAY   *P1:24,*B,"Invalid Site.  ",*EL;
          CALL      HITENTER
          GOTO      KHSB0200
.
. ------- doing reporting in extract program -------
.
KHSB0300  MOVE      "51",CCOL
          MOVE      SIX,CVERT
          CALL      KYN0000
          MOVE      EXIT,CCCNXRPT
          GOTO      KHSB0000
.
. ------- validate department throughout system -------
.
KHSB0400  MOVE      "51",CCOL
          MOVE      SEVEN,CVERT
          CALL      KYN0000
          MOVE      EXIT,CCCNVDPT
          GOTO      KHSB0000
.
. ------- using translation for Manual Procedures -------
.
KHSB0500  MOVE      "51",CCOL
          MOVE      EIGHT,CVERT
          CALL      KYN0000
          MOVE      EXIT,CCCNPRTL
          GOTO      KHSB0000
.
. ------- trendstar hospital code -------
.
KHSB0600  KEYIN     *P51:9,*EL,*V2LON,CCCNTSHC:
                    *P51:9,*DV,CCCNTSHC
          PACK      CCCNTSHC,CCCNTSHC,SP6
          GOTO      KHSB0000
.
. ------- A&E Extract Default Department -----------
.
KHSB0700  KEYIN     *P51:10,*EL,*V2LON,CCCNAEDP:
                    *P51:10,*DV,CCCNAEDP
          PACK      CCCNAEDP,CCCNAEDP,SP3
          GOTO      KHSB0000
.
KHSB0800  KEYIN     *P51:11,*EL,*V2LON,ANS
          PACK      ANS,ANS,SP1
          REP       UPPLOW,ANS
.
          MATCH     ANSY,ANS
          IF        @EQUAL
            MOVE      ZERO,CCCNOUTL
            DISPLAY   *P51:11,*EL,*V2LON,DYES
            GOTO      KHSB0000
          ENDIF
.
          MATCH     ANSN,ANS
          IF        @EQUAL
            MOVE      ONE,CCCNOUTL           
            DISPLAY   *P51:11,*EL,*V2LON,DNO
            GOTO      KHSB0000
          ENDIF
.
          BEEP
          GOTO      KHSB0800
.
KHSB0900  MOVE      "51",CCOL
          MOVE      "12",CVERT
          PACK      CURRDTE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDTE
          UNPACK    SP20,CCENT,CYEAR,CMON,CDAY
          CALL      KEYDATE
          PACK      CCCNX7SD,CCENT,CYEAR,CMON,CDAY
.
          MATCH     CCCNX7SD,CURRDTE
          IF        @EQUAL
            GOTO      KHSB0950
          ENDIF
.
          MATCH     CCCNX7SD,CURRDTE
          IF        @LESS
            GOTO      KHSB0950
          ENDIF
.
          GOTO      KHSB0000 
.
KHSB0950  DISPLAY   *P1:24,*EL,*B,"Start date must not be >= today's date. ";
          CALL      HITENTER
          GOTO      KHSB0900
.
KHSB1000  KEYIN     *P51:13,*V2LON,*RV,CCCNX7FP
          GOTO      KHSB0000
.
KHSB9900  MOVE      ZERO,EXIT
          GOTO      KHSB9999
KHSB9910  MOVE      ONE,EXIT
KHSB9999  RETURN
+
.*********************************************************************
.*                  WHSB0000
.*        Write the data for hospital screen B
.*********************************************************************
WHSB0000  WRITAB    CONTROLF,SEVENTY1;*158,CCCNDLDG,*162,CCCNSITE,*184,CCCNXRPT:
                                      CCCNVDPT,CCCNPRTL,*191,CCCNTSHC,*195:
                                      CCCNAEDP,*199,CCCNOUTL,*201,CCCNX7SD:
                                      *209,CCCNX7FP
WHSB9999  RETURN
+
.
.*********************************************************************
.*        Read the original data for Theatre Times                   *
.*********************************************************************
RTHT0000  READ      CONTROLF,SEVENTY1;*72,CCCN009A,CCCN009B,CCCN012A,CCCN012B:
                                      CCCN013A,CCCN013B,*95,CCCN008A,CCCN008B:
                                      *187,CCCN032A,CCCN032B
          RETURN
+
.*********************************************************************
.*                  DTHT0000                    Called by : ML2000   *
.*        Display Theatre Times screen                               *
.*********************************************************************
DTHT0000  DISPLAY   *P1:3,*EF,*P53:2,*V2LON,"- Theatre special parameters ":
                    *P1:4,*V2LON," 1",*HOFF:
                           ". From Time for Procedure type 9 & 30  (Operation)":
                    *P1:5,*V2LON," 2",*HOFF:
                           ". To   Time for Procedure type 9 & 30  (Operation)":
                    *P1:6,*V2LON," 3",*HOFF:
                           ". From Time for Procedure type 12      (Recovery )":
                    *P1:7,*V2LON," 4",*HOFF:
                           ". To   Time for Procedure type 12      (Recovery )":
                    *P1:8,*V2LON," 5",*HOFF:
                           ". From Time for Procedure type 13 & 31 (Anaesthetic)":
                    *P1:9,*V2LON," 6",*HOFF:
                           ". To   Time for Procedure type 13 & 31 (Anaesthetic)":
                    *P1:10,*V2LON," 7",*HOFF:
                           ". From Time for Procedure type 8       (Setup)":
                    *P1:11,*V2LON," 8",*HOFF:
                           ". To   Time for Procedure type 8       (Setup)":
                    *P1:12,*V2LON," 9",*HOFF:
                           ". From Time for Procedure type 32      (Waiting Time)":
                    *P1:13,*V2LON,"10",*HOFF:
                           ". To   Time for Procedure type 32      (Waiting Time)":
                    *PKTP0:4,":",*PKTP0:5,":",*PKTP0:6,":",*PKTP0:7,":":
                    *PKTP0:8,":",*PKTP0:9,":",*PKTP0:10,":",*PKTP0:11,":":
                    *PKTP0:12,":",*PKTP0:13,":":
                    *PKTP1:4,*V2LON,CCCN009A:
                    *PKTP1:5,CCCN009B,*PKTP1:6,CCCN012A,*PKTP1:7,CCCN012B:
                    *PKTP1:8,CCCN013A,*PKTP1:9,CCCN013B,*PKTP1:10,CCCN008A:
                    *PKTP1:11,CCCN008B,*PKTP1:12,CCCN032A,*PKTP1:13,CCCN032B
DTHT9999  RETURN
+
.*********************************************************************
.         keyin details for theatre times screen
.*********************************************************************
KTHT0000  CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      KTHT9900 IF EQUAL       * Post entered
          GOTO      KTHT9910 IF LESS        * Cancel entered
.
          BRANCH    CCITEM,KTHT0100,KTHT0200,KTHT0300,KTHT0400,KTHT0500:
                           KTHT0600,KTHT0700,KTHT0800,KTHT0900,KTHT1000
.
          BEEP
          GOTO      KTHT0000
.
.         From time for procedure type 9
.
KTHT0100  DISPLAY   *P1:24,*V2LON,ANSP,*HOFF," = Pre-op time , ":
                    *V2LON,ANSO,*HOFF," = Operation time "
          KEYIN     *PKTP1:4,*EL,*DV,UNDLN2:
                    *PKTP1:4,*V2LON,*+,DIM1     
.
          MATCH     ANSO,DIM1
          IF        @EQUAL
            DISPLAY   *P1:24,*EL,"Valid Operation times ",*V2LON,ONE," - ":
                      FOUR
KTHT0120    KEYIN     *PKTP2:4,*EL,*DV,UNDLN1:
                      *PKTP2:4,*V2LON,FORM1    
.
.****** Validate range for operation time ******
.
            IF        FORM1 > 4
              BEEP
              GOTO      KTHT0120
            ELSE
              IF      FORM1 < 1
                BEEP
                GOTO      KTHT0120
              ENDIF
            ENDIF
            
            MOVE      FORM1,DIM1A
            PACK      CCCN009A,DIM1,DIM1A
        
          ELSE
            MATCH     ANSP,DIM1
            IF        @EQUAL
              DISPLAY   *P1:24,*EL,"Valid Pre-op times ",*V2LON,ONE," - ":
                        FIVE
KTHT0140      KEYIN     *PKTP2:4,*EL,*DV,UNDLN1:
                        *PKTP2:4,*V2LON,FORM1    
.
.****** Validate range for pre-op times ****
.
              IF        FORM1 > 5
                BEEP
                GOTO      KTHT0140
              ELSE
                IF      FORM1 < 1
                  BEEP
                  GOTO      KTHT0140
                ENDIF
              ENDIF
            
              MOVE      FORM1,DIM1A
              PACK      CCCN009A,DIM1,DIM1A
        
            ELSE
              BEEP
              GOTO      KTHT0100
            ENDIF
          ENDIF
.
          DISPLAY   *PKTP1:4,*V2LON,CCCN009A
          DISPLAY   *P1:24,*EL        
          GOTO      KTHT0000
.
.         To time for procedure type 9
.
KTHT0200  DISPLAY   *P1:24,*V2LON,ANSP,*HOFF," = Post-op time , ":
                    *V2LON,ANSO,*HOFF," = Operation time "
          KEYIN     *PKTP1:5,*DV,UNDLN2:
                    *PKTP1:5,*V2LON,*+,DIM1
.
          MATCH     ANSO,DIM1
          IF        @EQUAL
            DISPLAY   *P1:24,*EL,"Valid Operation times ",*V2LON,ONE," - ":
                      FOUR
KTHT0210    KEYIN     *PKTP2:5,*EL,*DV,UNDLN1:
                      *PKTP2:5,*V2LON,FORM1    
.
.****** Validate range for operation time ******
.
            IF        FORM1 > 4
              BEEP
              GOTO      KTHT0210
            ELSE
              IF      FORM1 < 1
                BEEP
                GOTO      KTHT0210
              ENDIF
            ENDIF
            
            MOVE      FORM1,DIM1A
            PACK      CCCN009B,DIM1,DIM1A
        
          ELSE
            MATCH     ANSP,DIM1
            IF        @EQUAL
              DISPLAY   *P1:24,*EL,"Valid Post-op times ",*V2LON,ONE," - ":
                        FOUR
KTHT0220      KEYIN     *PKTP2:5,*EL,*DV,UNDLN1:
                        *PKTP2:5,*V2LON,FORM1    
.
.******** Validate range for post-op times *****
.
              IF        FORM1 > 4
                BEEP
                GOTO      KTHT0220
              ELSE
                IF      FORM1 < 1
                  BEEP
                  GOTO      KTHT0220
                ENDIF
              ENDIF
            
              MOVE      FORM1,DIM1A
              PACK      CCCN009B,DIM1,DIM1A
        
            ELSE
              BEEP
              GOTO      KTHT0200
            ENDIF
          ENDIF
.
          DISPLAY   *PKTP1:5,*V2LON,CCCN009B
          DISPLAY   *P1:24,*EL        
          GOTO      KTHT0000
.
.         From Time for procedure Type 12
.
KTHT0300  DISPLAY   *P1:24,*V2LON,ANSP,*HOFF," = Post-op time , ":
                    *V2LON,ANSO,*HOFF," = Operation time "
          KEYIN     *PKTP1:6,*DV,UNDLN2:
                    *PKTP1:6,*V2LON,*+,DIM1  
.
          MATCH     ANSO,DIM1
          IF        @EQUAL
            DISPLAY   *P1:24,*EL,"Valid Operation times ",*V2LON,ONE," - ":
                      FOUR
KTHT0310    KEYIN     *PKTP2:6,*EL,*DV,UNDLN1:
                      *PKTP2:6,*V2LON,FORM1    
.
.****** Validate range for operation time ******
.
            IF        FORM1 > 4
              BEEP
              GOTO      KTHT0310
            ELSE
              IF      FORM1 < 1
                BEEP
                GOTO      KTHT0310
              ENDIF
            ENDIF
            
            MOVE      FORM1,DIM1A
            PACK      CCCN012A,DIM1,DIM1A
        
          ELSE
            MATCH     ANSP,DIM1
            IF        @EQUAL
              DISPLAY   *P1:24,*EL,"Valid Post-op times ",*V2LON,ONE," - ":
                        FOUR
KTHT0320      KEYIN     *PKTP2:6,*EL,*DV,UNDLN1:
                        *PKTP2:6,*V2LON,FORM1    
.
.****** Validate range for pre-op times ****
.
              IF        FORM1 > 4
                BEEP
                GOTO      KTHT0320
              ELSE
                IF      FORM1 < 1
                  BEEP
                  GOTO      KTHT0320
                ENDIF
              ENDIF
            
              MOVE      FORM1,DIM1A
              PACK      CCCN012A,DIM1,DIM1A
        
            ELSE
              BEEP
              GOTO      KTHT0300
            ENDIF
          ENDIF
.
          DISPLAY   *PKTP1:6,*V2LON,CCCN012A
          DISPLAY   *P1:24,*EL        
          GOTO      KTHT0000
.
.         To time for procedure type 12
.
KTHT0400  DISPLAY   *P1:24,*V2LON,ANSP,*HOFF," = Post-op time , ":
                    *V2LON,ANSO,*HOFF," = Operation time "
          KEYIN     *PKTP1:7,*DV,UNDLN2:
                    *PKTP1:7,*V2LON,*+,DIM1
.
          MATCH     ANSO,DIM1
          IF        @EQUAL
            DISPLAY   *P1:24,*EL,"Valid Operation times ",*V2LON,ONE," - ":
                      FOUR
KTHT0410    KEYIN     *PKTP2:7,*EL,*DV,UNDLN1:
                      *PKTP2:7,*V2LON,FORM1    
.
.****** Validate range for operation time ******
.
            IF        FORM1 > 4
              BEEP
              GOTO      KTHT0410
            ELSE
              IF      FORM1 < 1
                BEEP
                GOTO      KTHT0410
              ENDIF
            ENDIF
            
            MOVE      FORM1,DIM1A
            PACK      CCCN012B,DIM1,DIM1A
        
          ELSE
            MATCH     ANSP,DIM1
            IF        @EQUAL
              DISPLAY   *P1:24,*EL,"Valid Post-op times ",*V2LON,ONE," - ":
                        FOUR
KTHT0420      KEYIN     *PKTP2:7,*EL,*DV,UNDLN1:
                        *PKTP2:7,*V2LON,FORM1    
.
.******** Validate range for post-op times *****
.
              IF        FORM1 > 4
                BEEP
                GOTO      KTHT0420
              ELSE
                IF      FORM1 < 1
                  BEEP
                  GOTO      KTHT0420
                ENDIF
              ENDIF
            
              MOVE      FORM1,DIM1A
              PACK      CCCN012B,DIM1,DIM1A
        
            ELSE
              BEEP
              GOTO      KTHT0400
            ENDIF
          ENDIF
.
          DISPLAY   *PKTP1:7,*V2LON,CCCN012B
          DISPLAY   *P1:24,*EL        
          GOTO      KTHT0000
.
.         From Time for procedure Type 13
.
KTHT0500  DISPLAY   *P1:24,*V2LON,ANSP,*HOFF," = Pre-op time , ":
                    *V2LON,ANSO,*HOFF," = Operation time "
          KEYIN     *PKTP1:8,*DV,UNDLN2:
                    *PKTP1:8,*V2LON,*+,DIM1  
.
          MATCH     ANSO,DIM1
          IF        @EQUAL
            DISPLAY   *P1:24,*EL,"Valid Operation times ",*V2LON,ONE," - ":
                      FOUR
KTHT0510    KEYIN     *PKTP2:8,*EL,*DV,UNDLN1:
                      *PKTP2:8,*V2LON,FORM1    
.
.****** Validate range for operation time ******
.
            IF        FORM1 > 4
              BEEP
              GOTO      KTHT0510
            ELSE
              IF      FORM1 < 1
                BEEP
                GOTO      KTHT0510
              ENDIF
            ENDIF
            
            MOVE      FORM1,DIM1A
            PACK      CCCN013A,DIM1,DIM1A
        
          ELSE
            MATCH     ANSP,DIM1
            IF        @EQUAL
              DISPLAY   *P1:24,*EL,"Valid Pre-op times ",*V2LON,ONE," - ":
                        FIVE
KTHT0520      KEYIN     *PKTP2:8,*EL,*DV,UNDLN1:
                        *PKTP2:8,*V2LON,FORM1    
.
.****** Validate range for pre-op times ****
.
              IF        FORM1 > 5
                BEEP
                GOTO      KTHT0520
              ELSE
                IF      FORM1 < 1
                  BEEP
                  GOTO      KTHT0520
                ENDIF
              ENDIF
            
              MOVE      FORM1,DIM1A
              PACK      CCCN013A,DIM1,DIM1A
        
            ELSE
              BEEP
              GOTO      KTHT0500
            ENDIF
          ENDIF
.
          DISPLAY   *PKTP1:8,*V2LON,CCCN013A
          DISPLAY   *P1:24,*EL        
          GOTO      KTHT0000
.
.
.         To time for procedure type 13
.
KTHT0600  DISPLAY   *P1:24,*V2LON,ANSP,*HOFF," = Post-op time , ":
                    *V2LON,ANSO,*HOFF," = Operation time "
          KEYIN     *PKTP1:9,*DV,UNDLN2:
                    *PKTP1:9,*V2LON,*+,DIM1  
.
          MATCH     ANSO,DIM1
          IF        @EQUAL
            DISPLAY   *P1:24,*EL,"Valid Operation times ",*V2LON,ONE," - ":
                      FOUR
KTHT0610    KEYIN     *PKTP2:9,*EL,*DV,UNDLN1:
                      *PKTP2:9,*V2LON,FORM1    
.
.****** Validate range for operation time ******
.
            IF        FORM1 > 4
              BEEP
              GOTO      KTHT0610 
            ELSE
              IF      FORM1 < 1
                BEEP
                GOTO      KTHT0610
              ENDIF
            ENDIF
            
            MOVE      FORM1,DIM1A
            PACK      CCCN013B,DIM1,DIM1A
        
          ELSE
            MATCH     ANSP,DIM1
            IF        @EQUAL
              DISPLAY   *P1:24,*EL,"Valid Post-op times ",*V2LON,ONE," - ":
                        FOUR
KTHT0620      KEYIN     *PKTP2:9,*EL,*DV,UNDLN1:
                        *PKTP2:9,*V2LON,FORM1    
.
.******** Validate range for post-op times *****
.
              IF        FORM1 > 4
                BEEP
                GOTO      KTHT0620
              ELSE
                IF      FORM1 < 1
                  BEEP
                  GOTO      KTHT0620
                ENDIF
              ENDIF
            
              MOVE      FORM1,DIM1A
              PACK      CCCN013B,DIM1,DIM1A
        
            ELSE
              BEEP
              GOTO      KTHT0600
            ENDIF
          ENDIF
.
          DISPLAY   *PKTP1:9,*V2LON,CCCN013B
          DISPLAY   *P1:24,*EL        
          GOTO      KTHT0000
.
.         From time for procedure type 9
.
KTHT0700  DISPLAY   *P1:24,*V2LON,ANSP,*HOFF," = Pre-op time , ":
                    *V2LON,ANSO,*HOFF," = Operation time "
        
          KEYIN     *PKTP1:10,*EL,*DV,UNDLN2:
                    *PKTP1:10,*V2LON,*+,DIM1     
.
          MATCH     ANSO,DIM1
          IF        @EQUAL
            DISPLAY   *P1:24,*EL,"Valid Operation times ",*V2LON,ONE," - ":
                      FOUR
KTHT0710    KEYIN     *PKTP2:10,*EL,*DV,UNDLN1:
                      *PKTP2:10,*V2LON,FORM1    
.
.****** Validate range for operation time ******
.
            IF        FORM1 > 4
              BEEP
              GOTO      KTHT0710
            ELSE
              IF      FORM1 < 1
                BEEP
                GOTO      KTHT0710
              ENDIF
            ENDIF
            
            MOVE      FORM1,DIM1A
            PACK      CCCN008A,DIM1,DIM1A
        
          ELSE
            MATCH     ANSP,DIM1
            IF        @EQUAL
              DISPLAY   *P1:24,*EL,"Valid Pre-op times ",*V2LON,ONE," - ":
                        FIVE
KTHT0720      KEYIN     *PKTP2:10,*EL,*DV,UNDLN1:
                        *PKTP2:10,*V2LON,FORM1    
.
.****** Validate range for pre-op times ****
.
              IF        FORM1 > 5
                BEEP
                GOTO      KTHT0720
              ELSE
                IF      FORM1 < 1
                  BEEP
                  GOTO      KTHT0720
                ENDIF
              ENDIF
            
              MOVE      FORM1,DIM1A
              PACK      CCCN008A,DIM1,DIM1A
        
            ELSE
              BEEP
              GOTO      KTHT0700
            ENDIF
          ENDIF
.
          DISPLAY   *PKTP1:10,*V2LON,CCCN008A
          DISPLAY   *P1:24,*EL        
          GOTO      KTHT0000
.
.         To time for procedure type 9
.
KTHT0800  
          DISPLAY   *P1:24,*V2LON,ANSP,*HOFF," = Post-op time , ":
                    *V2LON,ANSO,*HOFF," = Operation time "
          KEYIN     *PKTP1:11,*DV,UNDLN2:
                    *PKTP1:11,*V2LON,*+,DIM1
.
          MATCH     ANSO,DIM1
          IF        @EQUAL
            DISPLAY   *P1:24,*EL,"Valid Operation times ",*V2LON,ONE," - ":
                      FOUR
KTHT0810    KEYIN     *PKTP2:11,*EL,*DV,UNDLN1:
                      *PKTP2:11,*V2LON,FORM1    
.
.****** Validate range for operation time ******
.
            IF        FORM1 > 4
              BEEP
              GOTO      KTHT0810
            ELSE
              IF      FORM1 < 1
                BEEP
                GOTO      KTHT0810
              ENDIF
            ENDIF
            
            MOVE      FORM1,DIM1A
            PACK      CCCN008B,DIM1,DIM1A
        
          ELSE
            MATCH     ANSP,DIM1
            IF        @EQUAL
              DISPLAY   *P1:24,*EL,"Valid Post-op times ",*V2LON,ONE," - ":
                        FOUR
KTHT0820      KEYIN     *PKTP2:11,*EL,*DV,UNDLN1:
                        *PKTP2:11,*V2LON,FORM1    
.
.******** Validate range for post-op times *****
.
              IF        FORM1 > 4
                BEEP
                GOTO      KTHT0820
              ELSE
                IF      FORM1 < 1
                  BEEP
                  GOTO      KTHT0820
                ENDIF
              ENDIF
            
              MOVE      FORM1,DIM1A
              PACK      CCCN008B,DIM1,DIM1A
        
            ELSE
              BEEP
              GOTO      KTHT0800
            ENDIF
          ENDIF
.
          DISPLAY   *PKTP1:11,*V2LON,CCCN008B
          DISPLAY   *P1:24,*EL        
          GOTO      KTHT0000
.
. ------- From time for procedure type 32 ------
.
KTHT0900  DISPLAY   *P1:24,*V2LON,ANSP,*HOFF," = Pre-op time , ":
                    *V2LON,ANSO,*HOFF," = Operation time "
          KEYIN     *PKTP1:12,*EL,*DV,UNDLN2:
                    *PKTP1:12,*V2LON,*+,DIM1     
.
          MATCH     ANSO,DIM1
          IF        @EQUAL
            DISPLAY   *P1:24,*EL,"Valid Operation times ",*V2LON,ONE," - ":
                      FOUR
KTHT0920    KEYIN     *PKTP2:12,*EL,*DV,UNDLN1:
                      *PKTP2:12,*V2LON,FORM1    
.
.****** Validate range for operation time ******
.
            IF        FORM1 > 4
              BEEP
              GOTO      KTHT0920
            ELSE
              IF      FORM1 < 1
                BEEP
                GOTO      KTHT0920
              ENDIF
            ENDIF
            
            MOVE      FORM1,DIM1A
            PACK      CCCN032A,DIM1,DIM1A
        
          ELSE
            MATCH     ANSP,DIM1
            IF        @EQUAL
              DISPLAY   *P1:24,*EL,"Valid Pre-op times ",*V2LON,ONE," - ":
                        FIVE
KTHT0940      KEYIN     *PKTP2:12,*EL,*DV,UNDLN1:
                        *PKTP2:12,*V2LON,FORM1    
.
.****** Validate range for pre-op times ****
.
              IF        FORM1 > 5
                BEEP
                GOTO      KTHT0940
              ELSE
                IF      FORM1 < 1
                  BEEP
                  GOTO      KTHT0940
                ENDIF
              ENDIF
            
              MOVE      FORM1,DIM1A
              PACK      CCCN032A,DIM1,DIM1A
        
            ELSE
              BEEP
              GOTO      KTHT0900
            ENDIF
          ENDIF
.
          DISPLAY   *PKTP1:12,*V2LON,CCCN032A
          DISPLAY   *P1:24,*EL        
          GOTO      KTHT0000
.
. ------- To time for procedure type 32 -------
. ------- NOTE : THIS IS ALSO A PRE-OP/OPERATION TIME -------
.
KTHT1000  DISPLAY   *P1:24,*V2LON,ANSP,*HOFF," = Pre-op time , ":
                    *V2LON,ANSO,*HOFF," = Operation time "
          KEYIN     *PKTP1:13,*DV,UNDLN2:
                    *PKTP1:13,*V2LON,*+,DIM1
.
          MATCH     ANSO,DIM1
          IF        @EQUAL
            DISPLAY   *P1:24,*EL,"Valid Operation times ",*V2LON,ONE," - ":
                      FOUR
KTHT1010    KEYIN     *PKTP2:13,*EL,*DV,UNDLN1:
                      *PKTP2:13,*V2LON,FORM1    
.
.****** Validate range for operation time ******
.
            IF        FORM1 > 4
              BEEP
              GOTO      KTHT1010
            ELSE
              IF      FORM1 < 1
                BEEP
                GOTO      KTHT1010
              ENDIF
            ENDIF
            
            MOVE      FORM1,DIM1A
            PACK      CCCN032B,DIM1,DIM1A
        
          ELSE
            MATCH     ANSP,DIM1
            IF        @EQUAL
              DISPLAY   *P1:24,*EL,"Valid Pre-op times ",*V2LON,ONE," - ":
                        FIVE
KTHT1020      KEYIN     *PKTP2:13,*EL,*DV,UNDLN1:
                        *PKTP2:13,*V2LON,FORM1    
.
.******** Validate range for post-op times *****
.
              IF        FORM1 > 5
                BEEP
                GOTO      KTHT1020
              ELSE
                IF      FORM1 < 1
                  BEEP
                  GOTO      KTHT1020
                ENDIF
              ENDIF
            
              MOVE      FORM1,DIM1A
              PACK      CCCN032B,DIM1,DIM1A
        
            ELSE
              BEEP
              GOTO      KTHT1000
            ENDIF
          ENDIF
.
          DISPLAY   *PKTP1:13,*V2LON,CCCN032B
          DISPLAY   *P1:24,*EL        
          GOTO      KTHT0000
.
KTHT9900  MOVE      ZERO,EXIT               * Post
          GOTO      KTHT9999
KTHT9910  MOVE      ONE,EXIT                * Cancel
.
KTHT9999  RETURN
+
.*********************************************************************
.*        write the values for theatre screen
.*********************************************************************
WTHT0000  WRITAB    CONTROLF,SEVENTY1;*72,CCCN009A,CCCN009B:
                             CCCN012A,CCCN012B,CCCN013A,CCCN013B:
                             *95,CCCN008A,CCCN008B,*187,CCCN032A,CCCN032B
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***";
WIBA9999  RETURN
+
.------------------------------------------------------------------------------
.         Yes/No standard keyin
.------------------------------------------------------------------------------
.
KYN0000  KEYIN      *PCCOL:CVERT,*DV,SP3:    * clear previous display
                    *PCCOL:CVERT,*V2LON,ANS:
                    *PCCOL:CVERT,*DV,ANS;
.
          TYPE      ANS                      * check if a number was input
          GOTO      KYN9000 IF EQUAL         * yes, invalid
.
          REP       "Y1y1N0n0",ANS           * convert valid answers to numerics
.
          TYPE      ANS                      * check if now a number
          GOTO      KYN9000 IF NOT EQUAL     * no, invalid
.
          MOVE      ANS,EXIT                 * set exit to Y/N value
.
          MOVE      DNO,DYESNO               * assume answer was "No "
          LOAD      DYESNO,EXIT,DYES,DNO     * unless otherwise stated
.
          DISPLAY   *PCCOL:CVERT,*V2LON,DYESNO
          GOTO      KYN9999
.
KYN9000   BEEP
          GOTO      KYN0000
.
KYN9999   RETURN
+
.
.         I/O includes needed
.
          INC       STD001IO
          INC       IBASECUR                * Keyin IBA screen security passwd
          INC       OUTSITIO/INC
          INC       PATCOMN3
          INC       PATDRGIO/INC
          INC       PATCODIO/INC
          INC       PATCODKY
          INC       FMSLMAIO/INC
................................................................................
