.-------------------------------------------------------
          INC       FMSSTDDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.00.03  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
. VF.00.02  18.10.1999  Charles Handaya
.           Verify Account Code Status (0=open, 1=journal, 2=closed)
.           srf 646145
. VF.00.01  02.09.1999 Sandra Barcham
.           Add in Creditor Keyword Search
.           srf 631485
.-------------------------------------------------------
MYCOL     FORM      2
MYVERT    FORM      2
.
SAVECRD   DIM       5      Creditor Code
SAVEDTRC  DIM       8      Date Invoice Received (YYYYMMDD)
SAVEUNIQ  DIM       3      Unique Id
SAVEDTIN  DIM       8      Invoice Date (YYYYMMDD)
SAVEREF   DIM       15     Invoice Reference
SAVEORD   DIM       8      Purchase Order Number
SAVELED   DIM       2      Ledger
SAVECCEN  DIM       12     G/L Cost Centre Code
SAVEDEPT  DIM       30     Department Description
SAVEAMT   FORM      12.2   Invoice Amount
SAVEDTPR  DIM       8      Date Invoice Processed (YYYYMMDD)
SAVEBAT   DIM       5      Invoice Batch Number
SAVEUID   DIM       4      Operator User Id
SAVEDATE  DIM       8      Date Entered
SAVETIME  DIM       8      Time Entered
SAVEUR1   DIM       25     User Def Ref 1
SAVEUR2   DIM       25     User Def Ref 2
SAVEUD1   DIM       8      User Def Date 1
SAVEUD2   DIM       8      User Def Date 2
SAVEUY1   DIM       1      User Def Y/N 1
SAVEUY2   DIM       1      User Def Y/N 2
SAVESPA   DIM       20     Spare
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBAAPS20
.   Function      :   Invoice Tracking Input                  
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSCIOFD/INC
          INC       APSISLFD/INC
          INC       APSMASFD/INC
          INC       APSMXRFD/INC
          INC       APSTCMFD/INC
          INC       APSTRKFD/INC
          INC       FMSAMAFD/INC
          INC       FMSCCAFD/INC
          INC       FMSCONFD/INC
          INC       FMSLMAFD/INC
          INC       SINPOAFD/INC
.=========================
.Local Variable Definition
.-------------------------
LEDGCOST  DIM      15 * Scr 01 Fld    15
.
.Word Processor File * Scr 01 Fld    49
.
NAMAPTC1  INIT      "Waptc1"
FILAPTC1  DIM       8
.
.
.    Multi Item Key Fields Scr 02 Fld    40
.-------------------------------------------------------
APTK3NAM  INIT      "APTK3"
APTK3END  FORM      1   * End Display
APTK3SNO  FORM      5   * Number of Items on the Screen
APTK3MKY  DIM       127 * Match Key 
APTK3EKY  DIM       127 * End Key
APTK3SKY  DIM       127 * Start Key
APTK3IDX  INIT      " 132 UC1-5"
APTK3FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
APTK3FNM  DIM       8  * Filename
APTK3CNT  FORM      3  * Number of Items on Screen
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBAAPS20"
PRGNAM    INIT      "Invoice Tracking Input                  "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      REDCON00
          CALL      SC00L000
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPTC1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     APTK3FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPTC1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apscioaf";
          OPEN      APSCIOA1,"apscioaf"
          DISPLAY   *P56:24,"Opening apscioaf";
          OPEN      APSCIOA2,"apscioaf"
          DISPLAY   *P56:24,"Opening apsislaf";
          OPEN      APSISLA1,"apsislaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA1,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA2,"apsmxraf"
          DISPLAY   *P56:24,"Opening apstcmaf";
          OPEN      APSTCMA1,"apstcmaf"
          DISPLAY   *P56:24,"Opening apstrkaf";
          OPEN      APSTRKA1,"apstrkaf"
          DISPLAY   *P56:24,"Opening apstrkaf";
          OPEN      APSTRKA2,"apstrkaf"
          DISPLAY   *P56:24,"Opening apstrkaf";
          OPEN      APSTRKA3,"apstrkaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA1,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA2,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA3,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA4,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmsccaaf";
          OPEN      FMSCCAA1,"fmsccaaf"
          DISPLAY   *P56:24,"Opening fmsccaaf";
          OPEN      FMSCCAA2,"fmsccaaf"
          DISPLAY   *P56:24,"Opening fmslmaaf";
          OPEN      FMSLMAA1,"fmslmaaf"
.--------------------------------------------------------
. Initialise Wp Filename for Comments                           
.--------------------------------------------------------
          PACK      FILAPTC1,NAMAPTC1,PORT
          REP       " 0",FILAPTC1
          DISPLAY   *P56:24,"Create & Open ",FILAPTC1;
          PREP      TEMPWORD,FILAPTC1
.
.--------------------------------------------------------
. Initialise Batch Screen Date Received                      
.--------------------------------------------------------
          MOVE     ZERO,APTK3SNO
          MOVE     "02   40",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,APTK3SNO
            ENDIF
          ENDIF
          PACK      APTK3FNM,ANST,APTK3NAM,PORT
          REP       " 0",APTK3FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      APTK3FL1,APTK3FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     APTK3FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,APTK3FNM,APTK3IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",APTK3FNM;
          EXECUTE   KEY80,TASKID
          OPEN      APTK3FL1,APTK3FNM
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Options Screen                     
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Insert Invoice Tracking Record     
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Modify Invoice Tracking            
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Tracking Detail                    
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Modify Processed Tracking Entries  
          ENDIF
          RETURN
.--------------------------------
. Screen - Options Screen                     
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Options Screen                     
.-------------------------------------------------------
CF00L000  COMPARE   ZERO,ACCEPT
              GOTO      CF00L999 IF EQUAL
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Options Screen                     
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Options Screen                     
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Options Screen                     
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Options Screen                     
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Options Screen                     
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Options Screen                     
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC04L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Insert Invoice Tracking Record     
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Insert Invoice Tracking Record     
.-------------------------------------------------------
CF01L000
          MOVE      SP70,APTKDTRC
          MOVE      SP70,APTKCRD 
          MOVE      SP70,APTKDTIN
          MOVE      SP70,APTKREF 
          MOVE      SP70,APTKORD 
          MOVE      SP70,LEDGCOST
          MOVE      SP70,APTKDEPT
          MOVE      ZERO,APTKAMT 
          MOVE      SP70,APTKUR1 
          MOVE      SP70,APTKUR2 
          MOVE      SP70,APTKUD1 
          MOVE      SP70,APTKUD2 
          MOVE      SP70,APTKUY1 
          MOVE      SP70,APTKUY2 
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Insert Invoice Tracking Record     
.--------------------------------------------------------
KY01L000
.
KY01L110
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "1",CKEYTYP
          CALL      EKEYF000
          BRANCH    EXIT,KY01L900,KY01L900
          MOVE      ONE,ACCEPT
          UNPACK    APTKDTRC,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Insert Invoice Tracking Record     
.---------------------------------------------------------
WP01L000
          PREP     TEMPWORD,FILAPTC1
          PACK     KEY19,APTKCRD,APTKDTRC,SP70
          MOVE     KEY19,SAVKEY80
          SETLPTR  SAVKEY80,16
          CALL      RDAPTC1 
          IF        OVRCD=0
            CALL      RPAPTC1 
          ENDIF
WP01L100
          CALL     RKAPTC1 
          BRANCH   OVRCD,WP01L105
          PACK     KEY19,APTCCRD,APTCDTRC,APTCUNIQ,APTCLINE
          MATCH    SAVKEY80,KEY19   
          GOTO     WP01L105 IF NOT EQUAL
          PACK     VAR,APTCCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APTCCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP01L100
WP01L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Insert Invoice Tracking Record     
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Insert Invoice Tracking Record     
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Insert Invoice Tracking Record     
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L101,PS01L102:
                            PS01L103,PS01L104,PS01L105,PS01L106:
                            PS01L107,PS01L108,PS01L109,PS01L110:
                            PS01L111,PS01L112,PS01L113,PS01L114:
                            PS01L115,PS01L116,PS01L117,PS01L118:
                            PS01L119,PS01L120,PS01L121,PS01L122:
                            PS01L123,PS01L124,PS01L125,PS01L126:
                            PS01L127,PS01L128,PS01L129,PS01L130:
                            PS01L131,PS01L132,PS01L133,PS01L134:
                            PS01L135,PS01L136,PS01L137,PS01L138:
                            PS01L139
          GOTO     PS01L999
.
PS01L101
          MOVE      APTKCRD,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          UNPACK    APTKDTIN,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      APTKREF,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      APTKORD,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      LEDGCOST,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      FMCCDESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      APTKDEPT,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      APTKAMT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      APTKUR1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      APTKUR2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          UNPACK    APTKUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          UNPACK    APTKUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APTKUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APTKUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          MOVE      APMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L116
          MOVE      APMASKY,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L117
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L118
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L119
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L120
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L121
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L122
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L123
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L124
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L125
          MOVE      APMACMOD,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L126
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L127
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L128
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L129
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L130
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L131
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L132
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L133
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L134
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L135
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L136
          MOVE      APMASMOD,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L137
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L138
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L139
          MOVE     FILAPTC1,WORDNAME
          CALL     DISPWORD
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Insert Invoice Tracking Record     
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L006:
                           SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L103,SF01L104:
                            SF01L105,SF01L106,SF01L107,SF01L006:
                            SF01L108,SF01L109,SF01L110,SF01L111:
                            SF01L112,SF01L113,SF01L114,SF01L115:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L116
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L103,SF01L104:
                            SF01L105,SF01L106,SF01L107,SF01L020:
                            SF01L108,SF01L109,SF01L110,SF01L111:
                            SF01L112,SF01L113,SF01L114,SF01L115:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L116
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      POST0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L103
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMATYP 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASKY 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACN1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACN2 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACA1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACA2 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACA3 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACPC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACTEL
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACFAX
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   35",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACMOD
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   36",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACEDI
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   37",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACON 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASN1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   39",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASN2 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   40",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASA1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   41",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASA2 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASA3 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   43",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASPC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   44",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASTEL
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   45",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASFAX
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   46",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASMOD
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   47",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASEDI
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   48",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASCON
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCRED000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L103
            ENDIF
            BRANCH    EXIT,SF01L103,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      APTKCRD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMATYP,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASKY,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACN1,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACN2,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACA1,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACA2,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACA3,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACPC,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACTEL,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACFAX,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   35",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACMOD,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   36",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACEDI,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   37",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACON,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASN1,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   39",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASN2,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   40",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASA1,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   41",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASA2,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASA3,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   43",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASPC,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   44",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASTEL,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   45",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASFAX,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   46",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASMOD,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   47",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASEDI,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   48",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASCON,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L104
          CALL     SELECTED
          CALL      KEYDATE
          PACK      APTKDTIN,CCENT,CYEAR,CMON,CDAY          
          UNPACK    APTKDTIN,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L105
          CALL     SELECTED
          STRIP     APTKREF 
          SFORMAT   VAR,SCPSLEN
          MOVE      APTKREF,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APTKREF 
          SFORMAT   VAR,127
          ENDSET    APTKREF 
          APPEND    SP70,APTKREF 
          RESET     APTKREF 
          CMATCH    EXITCHAR,APTKREF 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APTKREF 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L105
            ENDIF
          ENDIF
          MOVE      APTKREF,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L106
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EORDN000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L106
            ENDIF
            BRANCH    EXIT,SF01L106,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      APTKORD,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L107
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FMCCDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L107
            ENDIF
            BRANCH    EXIT,SF01L107,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      LEDGCOST,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMCCDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L108
          CALL     SELECTED
          STRIP     APTKDEPT
          SFORMAT   VAR,SCPSLEN
          MOVE      APTKDEPT,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APTKDEPT
          SFORMAT   VAR,127
          ENDSET    APTKDEPT
          APPEND    SP70,APTKDEPT
          RESET     APTKDEPT
          CMATCH    EXITCHAR,APTKDEPT
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APTKDEPT
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L108
            ENDIF
          ENDIF
          MOVE      APTKDEPT,VAR     
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L109
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,APTKAMT 
          IF        SCPSMAN=1
            COMPARE   ZERO,APTKAMT 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L109
            ENDIF
          ENDIF
          CALL      CLRACC00
          MOVE      APTKAMT,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L110
          CALL     SELECTED
          STRIP     APTKUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      APTKUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APTKUR1 
          SFORMAT   VAR,127
          ENDSET    APTKUR1 
          APPEND    SP70,APTKUR1 
          RESET     APTKUR1 
          CMATCH    EXITCHAR,APTKUR1 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APTKUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L110
            ENDIF
          ENDIF
          MOVE      APTKUR1,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L111
          CALL     SELECTED
          STRIP     APTKUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      APTKUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APTKUR2 
          SFORMAT   VAR,127
          ENDSET    APTKUR2 
          APPEND    SP70,APTKUR2 
          RESET     APTKUR2 
          CMATCH    EXITCHAR,APTKUR2 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APTKUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L111
            ENDIF
          ENDIF
          MOVE      APTKUR2,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L112
          CALL     SELECTED
          CALL      KEYDATE
          PACK      APTKUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    APTKUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L113
          CALL     SELECTED
          CALL      KEYDATE
          PACK      APTKUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    APTKUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L114
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,APTKUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APTKUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L115
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,APTKUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APTKUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L116
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "10",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 70",SCPSLEN
              MOVE     "10",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPTC1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPTC1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          GOTO     SF01L001
SF01L990  MOVE      FOUR,EXIT * Exit Char Exit
SF01L999  RETURN
.--------------------------------
. Screen - Modify Invoice Tracking            
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Modify Invoice Tracking            
.-------------------------------------------------------
CF02L000  COMPARE   ZERO,ACCEPT
              GOTO      CF02L999 IF EQUAL
          MOVE      SP70,APMACRD 
          MOVE      SP70,APMATYP 
          MOVE      SP70,APMASKY 
          MOVE      SP70,APMACN1 
          MOVE      SP70,APMACN2 
          MOVE      SP70,APMACA1 
          MOVE      SP70,APMACA2 
          MOVE      SP70,APMACA3 
          MOVE      SP70,APMACPC 
          MOVE      SP70,APMACTEL
          MOVE      SP70,APMACFAX
          MOVE      SP70,APMACMOD
          MOVE      SP70,APMACEDI
          MOVE      SP70,APMACON 
          MOVE      SP70,APMASN1 
          MOVE      SP70,APMASN2 
          MOVE      SP70,APMASA1 
          MOVE      SP70,APMASA2 
          MOVE      SP70,APMASA3 
          MOVE      SP70,APMASPC 
          MOVE      SP70,APMASTEL
          MOVE      SP70,APMASFAX
          MOVE      SP70,APMASMOD
          MOVE      SP70,APMASEDI
          MOVE      SP70,APMASCON
          MOVE      SP70,APTKDTRC
          MOVE      SP70,APTKUNIQ
          MOVE      SP70,APTKDTIN
          MOVE      SP70,APTKREF 
          MOVE      SP70,APTKORD 
          MOVE      SP70,APTKLED 
          MOVE      SP70,APTKCCEN
          MOVE      SP70,APTKDEPT
          MOVE      ZERO,APTKAMT 
          MOVE      SP70,APTKDTPR
          MOVE      SP70,APTKBAT 
          MOVE      SP70,APTKUID 
          MOVE      SP70,APTKDATE
          MOVE      SP70,APTKTIME
          MOVE      SP70,APTKUR1 
          MOVE      SP70,APTKUR2 
          MOVE      SP70,APTKUD1 
          MOVE      SP70,APTKUD2 
          MOVE      SP70,APTKUY1 
          MOVE      SP70,APTKUY2 
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Modify Invoice Tracking            
.--------------------------------------------------------
KY02L000
.
KY02L110
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ECRED000
          BRANCH    EXIT,KY02L900,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Modify Invoice Tracking            
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Modify Invoice Tracking            
.---------------------------------------------------------
LM02L000
.---------------------------------------------------------
. Load for :    40 Date Received                      
.---------------------------------------------------------
          UNPACK    SP70,APTKCRD,APTKBAT,APTKDTRC,APTKUNIQ
          PACK      KEY21,APMACRD,SP70
          MOVE      KEY21,APTK3EKY
          STRIP     APTK3SKY
          SETLPTR   APTK3EKY,10
          MOVE      APTK3EKY,APTK3SKY
          CALL      RDAPTK3 
          IF        OVRCD=0
            CALL      RPAPTK3 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP02L000
          MOVE     ZERO,APTK3CNT
          MOVE     ZERO,APTK3END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP02L600
          MATCH    PRGID,SCPSPID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                           DP02L010,DP02L010,DP02L010,DP02L010:
                           DP02L010,DP02L010,DP02L010,DP02L010:
                           DP02L010,DP02L010,DP02L010,DP02L101:
                            DP02L102,DP02L103,DP02L104,DP02L105:
                            DP02L106,DP02L107,DP02L108,DP02L109:
                            DP02L110,DP02L111,DP02L112,DP02L113:
                            DP02L114,DP02L115,DP02L116,DP02L117:
                            DP02L118,DP02L119,DP02L120,DP02L010:
                            DP02L010,DP02L010,DP02L010
          GOTO      DP02L010
.
DP02L101
          PACK      APTK3MKY,SP70,SP70
          CALL      UPTAPTK3
          IF        APTK3END=0
            CALL      RPAPTK3 
            IF        OVRCD=0
              PACK      APTK3MKY,APTKCRD,APTKBAT,APTKDTRC,APTKUNIQ                                              
              MATCH     APTK3EKY,APTK3MKY
              IF        @EQUAL
                MOVE      ZERO,APTK3END
                ADD       ONE,APTK3CNT
                CALL      UPTAPTK3
                UNPACK    APTKDTRC,CCENT,CYEAR,CMON,CDAY          
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
              ELSE
                MOVE      ONE,APTK3END
              ENDIF
            ELSE
              MOVE      ONE,APTK3END
            ENDIF
          ENDIF
          IF        APTK3END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L102
          IF        APTK3END=0
            MOVE      APTKUNIQ,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L103
          IF        APTK3END=0
            UNPACK    APTKDTIN,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L104
          IF        APTK3END=0
            MOVE      APTKREF,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L105
          IF        APTK3END=0
            MOVE      APTKORD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L106
          IF        APTK3END=0
            MOVE      APTKLED,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L107
          IF        APTK3END=0
            MOVE      APTKCCEN,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L108
          IF        APTK3END=0
            MOVE      APTKDEPT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L109
          IF        APTK3END=0
            MOVE      APTKAMT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L110
          IF        APTK3END=0
            UNPACK    APTKDTPR,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L111
          IF        APTK3END=0
            MOVE      APTKBAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L112
          IF        APTK3END=0
            MOVE      APTKUID,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L113
          IF        APTK3END=0
            UNPACK    APTKDATE,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L114
          IF        APTK3END=0
            MOVE      APTKTIME,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L115
          IF        APTK3END=0
            MOVE      APTKUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L116
          IF        APTK3END=0
            MOVE      APTKUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L117
          IF        APTK3END=0
            UNPACK    APTKUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L118
          IF        APTK3END=0
            UNPACK    APTKUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L119
          IF        APTK3END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      APTKUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L120
          IF        APTK3END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      APTKUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
DP02L600
          MATCH    "APTK3",NAMSSFFI
          GOTO     DP02L605 IF NOT EQUAL
          GOTO     DP02L999
DP02L605
DP02L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP02L000
.
          MATCH    "APTK3",NAMSSFFI
          GOTO     FP02L105 IF NOT EQUAL
          PACK     KEY21,APTK3SKY,Z70
          CALL     RDAPTK3  * Start
          IF       OVRCD=0
            CALL     RPAPTK3  * Start
          ENDIF
          CALL     DP02L000
          GOTO     FP02L999
FP02L105
FP02L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP02L000
.
          MATCH    "APTK3",NAMSSFFI
          GOTO     LP02L105 IF NOT EQUAL
          PACK     KEY21,APTK3SKY,SP70
          CALL     RSAPTK3  * End
          IF       OVRCD=1
            CALL     RKAPTK3 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APTK3SNO
            CALL     RKAPTK3 
            IF       OVRCD=1
              MOVE     APTK3SNO,SECTOR
            ENDIF
            PACK     APTK3MKY,APTKCRD,APTKBAT,APTKDTRC,APTKUNIQ                                              
            MATCH    APTK3EKY,APTK3MKY
            IF       !@EQUAL
              MOVE     APTK3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     LP02L999
LP02L105
LP02L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP02L000
.
          MATCH    "APTK3",NAMSSFFI
          GOTO     PP02L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP02L105
          CALL      RFTAPTK3
          BRANCH   OVRCD,PP02L115
          MOVE      APTK3MKY,KEY21 
          CALL      RSAPTK3 
PP02L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=APTK3SNO
            CALL     RKAPTK3 
            IF       OVRCD=1
              MOVE     APTK3SNO,SECTOR
            ENDIF
            PACK     APTK3MKY,APTKCRD,APTKBAT,APTKDTRC,APTKUNIQ                                              
            MATCH    APTK3EKY,APTK3MKY
            IF       !@EQUAL
              MOVE     APTK3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     PP02L999
PP02L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APTK3SNO
            CALL     RPAPTK3 
            IF       OVRCD=1
              MOVE     APTK3SNO,SECTOR
            ENDIF
            PACK     APTK3MKY,APTKCRD,APTKBAT,APTKDTRC,APTKUNIQ                                              
            MATCH    APTK3EKY,APTK3MKY
            IF       !@EQUAL
              MOVE     APTK3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP02L999
PP02L120
PP02L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP02L000
          MATCH    "APTK3",NAMSSFFI
          GOTO     NP02L115 IF NOT EQUAL
NP02L105
          CALL     RPAPTK3 
          BRANCH   OVRCD,NP02L110
          PACK     APTK3MKY,APTKCRD,APTKBAT,APTKDTRC,APTKUNIQ                                              
          MATCH    APTK3EKY,APTK3MKY
          GOTO     NP02L110 IF NOT EQUAL
          CALL     RKAPTK3 
          CALL     DP02L000
          GOTO     NP02L999
NP02L110
          CALL     RKAPTK3 
          BEEP
          GOTO     NP02L999
NP02L115
NP02L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT02L000
CT02L105
CT02L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Modify Invoice Tracking            
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    40 Date Received                      
.---------------------------------------------------------
UPTAPTK3
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      APTK3FL1,KEY5;ANS
          IF        @OVER
            WRITE     APTK3FL1,KEY5;SCPSROW,SCPSCOL,APTK3MKY
          ELSE
            UPDATE    APTK3FL1;SCPSROW,SCPSCOL,APTK3MKY
          ENDIF
          RETURN
RDTAPTK3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      APTK3FL1,KEY5;SCPSROW,SCPSCOL,APTK3MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTAPTK3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      APTK3FL1,KEY5;;
          READKS    APTK3FL1;SCPSROW,SCPSCOL,APTK3MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,APTK3MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Modify Invoice Tracking            
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
          MOVE      "APTK3",NAMSSFFI
          MOVE      "   40",ITMSSFFI
          CALL      FP02L000
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Modify Invoice Tracking            
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L101:
                            PS02L102,PS02L103,PS02L104,PS02L105:
                            PS02L106,PS02L107,PS02L108,PS02L109:
                            PS02L110,PS02L111,PS02L112,PS02L113:
                            PS02L114,PS02L115,PS02L116,PS02L117:
                            PS02L118,PS02L119,PS02L120,PS02L121:
                            PS02L122,PS02L123,PS02L124,PS02L999:
                           PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999
          GOTO     PS02L999
.
PS02L101
          MOVE      APMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      APMASKY,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          MOVE      APMACMOD,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L112
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L113
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L114
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L115
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L116
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L117
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L118
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L119
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L120
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L121
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L122
          MOVE      APMASMOD,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L123
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L124
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Modify Invoice Tracking            
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L006,SF02L006,SF02L006,SF02L102:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L103:
                            SF02L104,SF02L105,SF02L106
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L102:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          MOVE      "APTK3",NAMSSFFI
          MOVE      "   40",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L102
          CALL      SELECTED
          BRANCH    EXIT,SF02L001
          COMPARE   ONE,ACCEPT
          GOTO      SF02L001 IF EQUAL
          CALL      RDTAPTK3
          IF        OVRCD=1
            BEEP
            GOTO      SF02L001
          ENDIF
          MATCH     SP70,APTK3MKY
          IF        @EQUAL
            BEEP
            GOTO      SF02L001
          ENDIF
          MOVE      APTK3MKY,KEY21 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELT0000
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTAPTK3
          IF        OVRCD=1
            CALL      FP02L000
          ELSE
            MOVE      APTK3MKY,KEY21 
            CALL      RSAPTK3 
            CALL      RKAPTK3 
            CALL      DP02L000
          ENDIF
          GOTO     SF02L001
.
SF02L103
          MOVE      "APTK3",NAMSSFFI
          MOVE      "   40",ITMSSFFI
          CALL      NP02L000
          GOTO     SF02L001
.
SF02L104
          MOVE      "APTK3",NAMSSFFI
          MOVE      "   40",ITMSSFFI
          CALL      PP02L000
          GOTO     SF02L001
.
SF02L105
          MOVE      "APTK3",NAMSSFFI
          MOVE      "   40",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L106
          MOVE      "APTK3",NAMSSFFI
          MOVE      "   40",ITMSSFFI
          CALL      LP02L000
          GOTO     SF02L001
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Tracking Detail                    
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Tracking Detail                    
.-------------------------------------------------------
CF03L000
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Tracking Detail                    
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Tracking Detail                    
.---------------------------------------------------------
WP03L000
          PREP     TEMPWORD,FILAPTC1
          PACK     KEY19,SAVECRD,SAVEDTRC,SAVEUNIQ,SP70
          MOVE     KEY19,SAVKEY80
          SETLPTR  SAVKEY80,16
          CALL      RDAPTC1 
          IF        OVRCD=0
            CALL      RPAPTC1 
          ENDIF
WP03L100
          CALL     RKAPTC1 
          BRANCH   OVRCD,WP03L105
          PACK     KEY19,APTCCRD,APTCDTRC,APTCUNIQ,APTCLINE
          MATCH    SAVKEY80,KEY19   
          GOTO     WP03L105 IF NOT EQUAL
          PACK     VAR,APTCCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APTCCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP03L100
WP03L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Tracking Detail                    
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Tracking Detail                    
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Tracking Detail                    
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L101,PS03L102,PS03L103:
                            PS03L104,PS03L105,PS03L106,PS03L107:
                            PS03L108,PS03L109,PS03L110,PS03L111:
                            PS03L112,PS03L113,PS03L114,PS03L115:
                            PS03L116,PS03L117,PS03L118,PS03L119:
                            PS03L120,PS03L121,PS03L122,PS03L123:
                            PS03L124,PS03L125,PS03L126,PS03L127:
                            PS03L128,PS03L129,PS03L130,PS03L131:
                            PS03L132,PS03L133,PS03L134,PS03L135:
                            PS03L136,PS03L137,PS03L138,PS03L139:
                            PS03L140,PS03L141,PS03L142,PS03L143:
                            PS03L144,PS03L145
          GOTO     PS03L999
.
PS03L101
          UNPACK    APTKDTRC,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      APTKCRD,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          UNPACK    APTKDTIN,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      APTKREF,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L105
          MOVE      APTKORD,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L106
          MOVE      LEDGCOST,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L107
          MOVE      FMCCDESC,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L108
          MOVE      APTKDEPT,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L109
          MOVE      APTKAMT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L110
          MOVE      APTKUR1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L111
          MOVE      APTKUR2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L112
          UNPACK    APTKUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L113
          UNPACK    APTKUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APTKUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APTKUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L116
          MOVE      APMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L117
          MOVE      APMASKY,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L118
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L119
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L120
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L121
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L122
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L123
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L124
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L125
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L126
          MOVE      APMACMOD,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L127
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L128
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L129
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L130
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L131
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L132
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L133
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L134
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L135
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L136
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L137
          MOVE      APMASMOD,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L138
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L139
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L140
          MOVE     FILAPTC1,WORDNAME
          CALL     DISPWORD
          GOTO     PS03L999
.
PS03L141
          MOVE      APTKUID,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L142
          UNPACK    APTKDATE,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L143
          MOVE      APTKTIME,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L144
          MOVE      APTKBAT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L145
          UNPACK    APTKDTPR,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Tracking Detail                    
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L103:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L104,SF03L105,SF03L106:
                            SF03L107,SF03L108,SF03L109,SF03L006:
                            SF03L110,SF03L111,SF03L112,SF03L113:
                            SF03L114,SF03L115,SF03L116,SF03L117:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L118,SF03L006,SF03L006,SF03L006:
                            SF03L119,SF03L120
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L104,SF03L105,SF03L106:
                            SF03L107,SF03L108,SF03L109,SF03L020:
                            SF03L110,SF03L111,SF03L112,SF03L113:
                            SF03L114,SF03L115,SF03L116,SF03L117:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L118,SF03L020,SF03L020,SF03L020:
                            SF03L119,SF03L120
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L102
          CALL      SAVE0000
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF03L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF03L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF03L999
          ENDIF
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF03L000
          ENDIF
          GOTO      SF03L001
.
SF03L104
          CALL     SELECTED
          MOVE      "1",CKEYTYP
          CALL      EKEYF000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L104
            ENDIF
            BRANCH    EXIT,SF03L104,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          UNPACK    APTKDTRC,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L105
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMATYP 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASKY 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACN1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACN2 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACA1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACA2 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACA3 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACPC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACTEL
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACFAX
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   35",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACMOD
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   36",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACEDI
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   37",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMACON 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASN1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   39",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASN2 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   40",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASA1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   41",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASA2 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASA3 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   43",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASPC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   44",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASTEL
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   45",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASFAX
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   46",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASMOD
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   47",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASEDI
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   48",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASCON
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCRED000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L105
            ENDIF
            BRANCH    EXIT,SF03L105,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      APTKCRD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMATYP,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASKY,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACN1,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACN2,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACA1,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACA2,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACA3,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACPC,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACTEL,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACFAX,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   35",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACMOD,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   36",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACEDI,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   37",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACON,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASN1,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   39",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASN2,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   40",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASA1,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   41",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASA2,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASA3,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   43",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASPC,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   44",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASTEL,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   45",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASFAX,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   46",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASMOD,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   47",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASEDI,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   48",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASCON,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L106
          CALL     SELECTED
          CALL      KEYDATE
          PACK      APTKDTIN,CCENT,CYEAR,CMON,CDAY          
          UNPACK    APTKDTIN,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L107
          CALL     SELECTED
          STRIP     APTKREF 
          SFORMAT   VAR,SCPSLEN
          MOVE      APTKREF,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APTKREF 
          SFORMAT   VAR,127
          ENDSET    APTKREF 
          APPEND    SP70,APTKREF 
          RESET     APTKREF 
          CMATCH    EXITCHAR,APTKREF 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APTKREF 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L107
            ENDIF
          ENDIF
          MOVE      APTKREF,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L108
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EORDN000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L108
            ENDIF
            BRANCH    EXIT,SF03L108,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      APTKORD,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L109
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FMCCDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L109
            ENDIF
            BRANCH    EXIT,SF03L109,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      LEDGCOST,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMCCDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L110
          CALL     SELECTED
          STRIP     APTKDEPT
          SFORMAT   VAR,SCPSLEN
          MOVE      APTKDEPT,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APTKDEPT
          SFORMAT   VAR,127
          ENDSET    APTKDEPT
          APPEND    SP70,APTKDEPT
          RESET     APTKDEPT
          CMATCH    EXITCHAR,APTKDEPT
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APTKDEPT
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L110
            ENDIF
          ENDIF
          MOVE      APTKDEPT,VAR     
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L111
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,APTKAMT 
          IF        SCPSMAN=1
            COMPARE   ZERO,APTKAMT 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L111
            ENDIF
          ENDIF
          CALL      CLRACC00
          MOVE      APTKAMT,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L112
          CALL     SELECTED
          STRIP     APTKUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      APTKUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APTKUR1 
          SFORMAT   VAR,127
          ENDSET    APTKUR1 
          APPEND    SP70,APTKUR1 
          RESET     APTKUR1 
          CMATCH    EXITCHAR,APTKUR1 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APTKUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L112
            ENDIF
          ENDIF
          MOVE      APTKUR1,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L113
          CALL     SELECTED
          STRIP     APTKUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      APTKUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APTKUR2 
          SFORMAT   VAR,127
          ENDSET    APTKUR2 
          APPEND    SP70,APTKUR2 
          RESET     APTKUR2 
          CMATCH    EXITCHAR,APTKUR2 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APTKUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L113
            ENDIF
          ENDIF
          MOVE      APTKUR2,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L114
          CALL     SELECTED
          CALL      KEYDATE
          PACK      APTKUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    APTKUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L115
          CALL     SELECTED
          CALL      KEYDATE
          PACK      APTKUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    APTKUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L116
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,APTKUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APTKUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L117
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,APTKUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APTKUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L118
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "10",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 70",SCPSLEN
              MOVE     "10",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPTC1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPTC1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          GOTO     SF03L001
.
SF03L119
          CALL     SELECTED
          STRIP     APTKBAT 
          SFORMAT   VAR,SCPSLEN
          MOVE      APTKBAT,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APTKBAT 
          SFORMAT   VAR,127
          ENDSET    APTKBAT 
          APPEND    SP70,APTKBAT 
          RESET     APTKBAT 
          CMATCH    EXITCHAR,APTKBAT 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APTKBAT 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L119
            ENDIF
          ENDIF
          MOVE      APTKBAT,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L120
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EPDAT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L120
            ENDIF
            BRANCH    EXIT,SF03L120,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          UNPACK    APTKDTPR,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF03L001
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Modify Processed Tracking Entries  
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Modify Processed Tracking Entries  
.-------------------------------------------------------
CF04L000
          MOVE      SP70,APMACRD 
          MOVE      SP70,APTKDTRC
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Modify Processed Tracking Entries  
.--------------------------------------------------------
KY04L000
.
KY04L110
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ECRED000
          BRANCH    EXIT,KY04L900,KY04L900
          MOVE      ZERO,ACCEPT
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Modify Processed Tracking Entries  
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Modify Processed Tracking Entries  
.---------------------------------------------------------
LM04L000
.---------------------------------------------------------
. Load for :    40 Date Invoice Received              
.---------------------------------------------------------
          UNPACK    SP70,APTKCRD,APTKBAT,APTKDTRC,APTKUNIQ
          PACK      KEY21,APMACRD,SP70
          MOVE      KEY21,APTK3EKY
          STRIP     APTK3SKY
          SETLPTR   APTK3EKY,5
          MOVE      APTK3EKY,APTK3SKY
          CALL      RDAPTK3 
          IF        OVRCD=0
            CALL      RPAPTK3 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP04L000
          MOVE     ZERO,APTK3CNT
          MOVE     ZERO,APTK3END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP04L600
          MATCH    PRGID,SCPSPID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP04L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                           DP04L010,DP04L010,DP04L010,DP04L010:
                           DP04L010,DP04L010,DP04L010,DP04L010:
                           DP04L010,DP04L010,DP04L010,DP04L101:
                            DP04L102,DP04L103,DP04L104,DP04L105:
                            DP04L106,DP04L107,DP04L108,DP04L109:
                            DP04L110,DP04L111,DP04L112,DP04L113:
                            DP04L114,DP04L115,DP04L116,DP04L117:
                            DP04L118,DP04L119,DP04L120,DP04L010:
                            DP04L010,DP04L010,DP04L010
          GOTO      DP04L010
.
DP04L101
          PACK      APTK3MKY,SP70,SP70
          CALL      UPTAPTK3
          IF        APTK3END=0
            CALL      RPAPTK3 
            IF        OVRCD=0
              PACK      APTK3MKY,APTKCRD,APTKBAT,APTKDTRC,APTKUNIQ                                              
              MATCH     APTK3EKY,APTK3MKY
              IF        @EQUAL
                MOVE      ZERO,APTK3END
                ADD       ONE,APTK3CNT
                CALL      UPTAPTK3
                UNPACK    APTKDTRC,CCENT,CYEAR,CMON,CDAY          
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
              ELSE
                MOVE      ONE,APTK3END
              ENDIF
            ELSE
              MOVE      ONE,APTK3END
            ENDIF
          ENDIF
          IF        APTK3END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L102
          IF        APTK3END=0
            MOVE      APTKUNIQ,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L103
          IF        APTK3END=0
            UNPACK    APTKDTIN,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L104
          IF        APTK3END=0
            MOVE      APTKREF,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L105
          IF        APTK3END=0
            MOVE      APTKORD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L106
          IF        APTK3END=0
            MOVE      APTKLED,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L107
          IF        APTK3END=0
            MOVE      APTKCCEN,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L108
          IF        APTK3END=0
            MOVE      APTKDEPT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L109
          IF        APTK3END=0
            MOVE      APTKAMT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L110
          IF        APTK3END=0
            UNPACK    APTKDTPR,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L111
          IF        APTK3END=0
            MOVE      APTKBAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L112
          IF        APTK3END=0
            MOVE      APTKUID,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L113
          IF        APTK3END=0
            UNPACK    APTKDATE,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L114
          IF        APTK3END=0
            MOVE      APTKTIME,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L115
          IF        APTK3END=0
            MOVE      APTKUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L116
          IF        APTK3END=0
            MOVE      APTKUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L117
          IF        APTK3END=0
            UNPACK    APTKUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L118
          IF        APTK3END=0
            UNPACK    APTKUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L119
          IF        APTK3END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      APTKUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L120
          IF        APTK3END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      APTKUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
DP04L600
          MATCH    "APTK3",NAMSSFFI
          GOTO     DP04L605 IF NOT EQUAL
          GOTO     DP04L999
DP04L605
DP04L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP04L000
.
          MATCH    "APTK3",NAMSSFFI
          GOTO     FP04L105 IF NOT EQUAL
          PACK     KEY21,APTK3SKY,Z70
          CALL     RDAPTK3  * Start
          IF       OVRCD=0
            CALL     RPAPTK3  * Start
          ENDIF
          CALL     DP04L000
          GOTO     FP04L999
FP04L105
FP04L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP04L000
.
          MATCH    "APTK3",NAMSSFFI
          GOTO     LP04L105 IF NOT EQUAL
          PACK     KEY21,APTK3SKY,SP70
          CALL     RSAPTK3  * End
          IF       OVRCD=1
            CALL     RKAPTK3 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APTK3SNO
            CALL     RKAPTK3 
            IF       OVRCD=1
              MOVE     APTK3SNO,SECTOR
            ENDIF
            PACK     APTK3MKY,APTKCRD,APTKBAT,APTKDTRC,APTKUNIQ                                              
            MATCH    APTK3EKY,APTK3MKY
            IF       !@EQUAL
              MOVE     APTK3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     LP04L999
LP04L105
LP04L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP04L000
.
          MATCH    "APTK3",NAMSSFFI
          GOTO     PP04L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP04L105
          CALL      RFTAPTK3
          BRANCH   OVRCD,PP04L115
          MOVE      APTK3MKY,KEY21 
          CALL      RSAPTK3 
PP04L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=APTK3SNO
            CALL     RKAPTK3 
            IF       OVRCD=1
              MOVE     APTK3SNO,SECTOR
            ENDIF
            PACK     APTK3MKY,APTKCRD,APTKBAT,APTKDTRC,APTKUNIQ                                              
            MATCH    APTK3EKY,APTK3MKY
            IF       !@EQUAL
              MOVE     APTK3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     PP04L999
PP04L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APTK3SNO
            CALL     RPAPTK3 
            IF       OVRCD=1
              MOVE     APTK3SNO,SECTOR
            ENDIF
            PACK     APTK3MKY,APTKCRD,APTKBAT,APTKDTRC,APTKUNIQ                                              
            MATCH    APTK3EKY,APTK3MKY
            IF       !@EQUAL
              MOVE     APTK3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP04L999
PP04L120
PP04L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP04L000
          MATCH    "APTK3",NAMSSFFI
          GOTO     NP04L115 IF NOT EQUAL
NP04L105
          CALL     RPAPTK3 
          BRANCH   OVRCD,NP04L110
          PACK     APTK3MKY,APTKCRD,APTKBAT,APTKDTRC,APTKUNIQ                                              
          MATCH    APTK3EKY,APTK3MKY
          GOTO     NP04L110 IF NOT EQUAL
          CALL     RKAPTK3 
          CALL     DP04L000
          GOTO     NP04L999
NP04L110
          CALL     RKAPTK3 
          BEEP
          GOTO     NP04L999
NP04L115
NP04L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT04L000
CT04L105
CT04L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Modify Processed Tracking Entries  
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Modify Processed Tracking Entries  
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
          MOVE      "APTK3",NAMSSFFI
          MOVE      "   40",ITMSSFFI
          CALL      FP04L000
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Modify Processed Tracking Entries  
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L999,PS04L101:
                            PS04L102,PS04L103,PS04L104,PS04L105:
                            PS04L106,PS04L107,PS04L108,PS04L109:
                            PS04L110,PS04L111,PS04L112,PS04L113:
                            PS04L114,PS04L115,PS04L116,PS04L117:
                            PS04L118,PS04L119,PS04L120,PS04L121:
                            PS04L122,PS04L123,PS04L124,PS04L999:
                           PS04L999,PS04L999,PS04L999,PS04L999:
                           PS04L999,PS04L999,PS04L999,PS04L999:
                           PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999
          GOTO     PS04L999
.
PS04L101
          MOVE      APMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      APMASKY,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L104
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L105
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L106
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L107
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L108
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L109
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L110
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L111
          MOVE      APMACMOD,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L112
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L113
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L114
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L115
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L116
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L117
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L118
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L119
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L120
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L121
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L122
          MOVE      APMASMOD,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L123
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L124
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Modify Processed Tracking Entries  
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                           SF04L006,SF04L006,SF04L006,SF04L006:
                           SF04L006,SF04L006,SF04L006,SF04L006:
                           SF04L006,SF04L006,SF04L006,SF04L102:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L103:
                            SF04L104,SF04L105,SF04L106
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L102:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          MOVE      "APTK3",NAMSSFFI
          MOVE      "   40",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L101
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L102
          CALL      SELECTED
          BRANCH    EXIT,SF04L001
          COMPARE   ONE,ACCEPT
          GOTO      SF04L001 IF EQUAL
          CALL      RDTAPTK3
          IF        OVRCD=1
            BEEP
            GOTO      SF04L001
          ENDIF
          MATCH     SP70,APTK3MKY
          IF        @EQUAL
            BEEP
            GOTO      SF04L001
          ENDIF
          MOVE      APTK3MKY,KEY21 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELT0000
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTAPTK3
          IF        OVRCD=1
            CALL      FP04L000
          ELSE
            MOVE      APTK3MKY,KEY21 
            CALL      RSAPTK3 
            CALL      RKAPTK3 
            CALL      DP04L000
          ENDIF
          GOTO     SF04L001
.
SF04L103
          MOVE      "APTK3",NAMSSFFI
          MOVE      "   40",ITMSSFFI
          CALL      NP04L000
          GOTO     SF04L001
.
SF04L104
          MOVE      "APTK3",NAMSSFFI
          MOVE      "   40",ITMSSFFI
          CALL      PP04L000
          GOTO     SF04L001
.
SF04L105
          MOVE      "APTK3",NAMSSFFI
          MOVE      "   40",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L106
          MOVE      "APTK3",NAMSSFFI
          MOVE      "   40",ITMSSFFI
          CALL      LP04L000
          GOTO     SF04L001
SF04L990  MOVE      ONE,EXIT * Exit Char Restart
SF04L999  RETURN
.@@@@@ Function Restart Point @@@@@
.----------------------------------------------------------------------
. Read Control File
.----------------------------------------------------------------------
REDCON00  CALL      RDFMCO50
          CALL      RDFMCO51
          CALL      RDFMCO52
          RETURN
.
.----------------------------------------
. Skip WP in Insert Mode
.----------------------------------------
CLRACC00  MOVE      ZERO,ACCEPT
          RETURN
.------------------------------------------------------------
. Save Input
.------------------------------------------------------------
POST0000  CALL     GETUNI00
          PACK     KEY16,APTKCRD,APTKDTRC,APTKUNIQ,SP70
          CALL     RDAPTK1
          BRANCH   OVRCD,POST1000
          BEEP
          MOVE     "ERROR: Item Not Posted. Unique ID Already Exists. ",DISPMSG
          CALL     MESSAGE1
          GOTO     POST9999
.
POST1000  CALL     WRAPTK1
          CALL     PNOTE000               * Post Notes
.
POST9999  RETURN
.------------------------------------------------------------
. Post Notes
.------------------------------------------------------------
PNOTE000  PACK      KEY19,APTKCRD,APTKDTRC,APTKUNIQ,SP70
          CALL      RSAPTC1
PNOTE100  CALL      RKAPTC1
          BRANCH    OVRCD,PNOTE190
          PACK      KEY19,APTCCRD,APTCDTRC,APTCUNIQ,APTCLINE,SP70
          PACK      KEY16,APTKCRD,APTKDTRC,APTKUNIQ,SP70
          MATCH     KEY16,KEY19
          GOTO      PNOTE190 IF NOT EQUAL
          CALL      DEAPTC1
          GOTO      PNOTE100
.
PNOTE190  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPTC1
          TRAPCLR   IO
          BRANCH    OVRCD,PNOTE290
          MOVE      ZERO,F3
.
PNOTE200  READ      TEMPWORD,SEQ;APTCCOM
          GOTO      PNOTE290 IF OVER
.
          MOVE      F3,APTCLINE
          PACK      KEY19,APTKCRD,APTKDTRC,APTKUNIQ,APTCLINE,SP70
          UNPACK    KEY19,APTCCRD,APTCDTRC,APTCUNIQ,APTCLINE
          CALL      WRAPTC1
          ADD       ONE,F3
          GOTO      PNOTE200
.
PNOTE290
.
PNOTE999  RETURN
.------------------------------------------------------------
. Get Unique ID
.------------------------------------------------------------
GETUNI00  CALL      SAVTRK00        * Save Tracking Record
          MOVE      ZERO,F3
          PACK      KEY16,SAVECRD,SAVEDTRC,Z70
          CALL      RSAPTK1
          CALL      RPAPTK1
          BRANCH    OVRCD,GETUNI10
          MATCH     SAVECRD,APTKCRD
          GOTO      GETUNI10 IF NOT EQUAL
          MATCH     SAVEDTRC,APTKDTRC
          GOTO      GETUNI10 IF NOT EQUAL
          MOVE      APTKUNIQ,F3
.
GETUNI10  ADD       ONE,F3
          MOVE      F3,APTKUNIQ
          CALL      RESTRK00        * Restore Tracking Record
          MOVE      SP70,APTKDTPR
          MOVE      SP70,APTKBAT
          MOVE      PASSCODE,APTKUID
          PACK      APTKDATE,CCC,CYY,CMM,CDD
          REP       " 0",APTKDATE
          CLOCK     TIME,APTKTIME
          MOVE      SP70,APTKSPA
.
GETUNI99  RETURN
.------------------------------------------------------------
. Save Tracking Record
.------------------------------------------------------------
SAVTRK00  MOVE      APTKCRD,SAVECRD
          MOVE      APTKDTRC,SAVEDTRC
          MOVE      APTKDTIN,SAVEDTIN
          MOVE      APTKREF,SAVEREF
          MOVE      APTKORD,SAVEORD
          MOVE      APTKLED,SAVELED
          MOVE      APTKCCEN,SAVECCEN
          MOVE      APTKDEPT,SAVEDEPT
          MOVE      APTKAMT,SAVEAMT
          MOVE      APTKUR1,SAVEUR1
          MOVE      APTKUR2,SAVEUR2
          MOVE      APTKUD1,SAVEUD1
          MOVE      APTKUD2,SAVEUD2
          MOVE      APTKUY1,SAVEUY1
          MOVE      APTKUY2,SAVEUY2
          RETURN
.------------------------------------------------------------
. Restore Tracking Record
.------------------------------------------------------------
RESTRK00  MOVE      SAVECRD,APTKCRD
          MOVE      SAVEDTRC,APTKDTRC
          MOVE      SAVEDTIN,APTKDTIN
          MOVE      SAVEREF,APTKREF
          MOVE      SAVEORD,APTKORD
          MOVE      SAVELED,APTKLED
          MOVE      SAVECCEN,APTKCCEN
          MOVE      SAVEDEPT,APTKDEPT
          MOVE      SAVEAMT,APTKAMT
          MOVE      SAVEUR1,APTKUR1
          MOVE      SAVEUR2,APTKUR2
          MOVE      SAVEUD1,APTKUD1
          MOVE      SAVEUD2,APTKUD2
          MOVE      SAVEUY1,APTKUY1
          MOVE      SAVEUY2,APTKUY2
          RETURN
.------------------------------------------------------------
. Enter Date Received
.------------------------------------------------------------
EKEYF000   MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           MOVE     CDD,CDAY
           MOVE     ONE,CDEFDTE
           CALL     KEYDATE
           BRANCH   OVRCD,EKEYF900
           MATCH    SP2,CDAY
           GOTO     EKEYF900 IF EQUAL
           MATCH    "00",CDAY
           GOTO     EKEYF900 IF EQUAL
           PACK     APTKDTRC,CCENT,CYEAR,CMON,CDAY
           REP      " 0",APTKDTRC
           MOVE     ZERO,EXIT
           GOTO     EKEYF999
.
EKEYF900   MOVE     TWO,EXIT
.
EKEYF999   RETURN
.
.----------------------------------------------------------------------
. Enter Creditor Code
.----------------------------------------------------------------------
KCRED000  MATCH     SP70,APTKORD
          GOTO      KCRED500 IF NOT EQUAL
.
KCRED100  MOVE      ZERO,CKEYTYP
          CALL      KAPMAA00
          BRANCH    EXIT,KCRED999,KCRED999
          MOVE      APMACRD,APTKCRD
          GOTO      KCRED999
.
KCRED500  CALL      GETCRD00
          BRANCH    EXIT,KCRED100
.
KCRED999  RETURN
.
GETCRD00  MOVE      APTKORD,KEY8
          CALL      RDAPCI1
          BRANCH    OVRCD,GETCRD10
          MOVE      APCICRD,KEY5
          CALL      RDAPMA1
          BRANCH    OVRCD,GETCRD10
          MOVE      APMACRD,APTKCRD
          MOVE      ZERO,EXIT
          GOTO      GETCRD99

GETCRD10  BRANCH    APISTYP,GETCRD90
.
          UNPACK    APTKORD,APCIISC,KEY7
          CALL      RDSIPA1
          BRANCH    OVRCD,GETCRD90
.
          MOVE      SIPASUP,KEY5
          CALL      RDAPMA1
          BRANCH    OVRCD,GETCRD90
.
          MOVE      APMACRD,APTKCRD
          MOVE      ZERO,EXIT
          GOTO      GETCRD99
.
GETCRD90  MOVE      ONE,EXIT
.
GETCRD99  RETURN
.----------------------------------------------------------------------
. Enter Creditor Code
.----------------------------------------------------------------------
EORDN000  MOVE       TWO,CKEYTYP
          CALL       KAPCIB00         * New Keyin Consolidated Orders
          BRANCH     EXIT,EORDN999,EORDN999
.
          CALL       CLRCRD00
          CALL       GETISL00         * Check Inventory System Linkage
          BRANCH     EXIT,EORDN000
.
          PACK       APTKORD,APCIISC,APCIORD
          PACK       KEY8,APCIISC,APCIORD
          CALL       RAAPCI1          * Read Order AP Receival Details
          BRANCH     OVRCD,EORDN100
          MOVE       APCICRD,KEY5
          CALL       RDAPMA1
          BRANCH     OVRCD,EORDN000
          MOVE       APMACRD,APTKCRD
          GOTO       EORDN200
.
EORDN100  MOVE       "Order Not on Inventory Receivals. ",DISPMSG
          CALL       MESSAGE4
          BRANCH     EXIT,EORDN000
          MOVE       ZERO,EXIT
.
EORDN200  IF         APISTYP=0
            MOVE       "sinpoaaf",KEY8
            PACK       KEY80,APISDIR,KEY8
            SQUEEZE    KEY80
            OPEN       SINPOAA1,KEY80
            OPEN       SINPOAA3,KEY80
            OPEN       SINPOAA4,KEY80
            UNPACK     APTKORD,APCIISC,KEY7
            CALL       RDSIPA1
            IF         OVRCD=1
              BEEP
              MOVE       "Invalid Order Number - ",DISPMSG
              CALL       MESSAGE1
              GOTO       EORDN000
            ENDIF
            MOVE       SIPASUP,KEY5
            CALL       RDAPMA1
            IF         OVRCD=1
              BEEP
              MOVE       "Invalid Creditor on Order Details - ",DISPMSG
              CALL       MESSAGE1
              GOTO       EORDN000
            ENDIF
            MOVE       APMACRD,APTKCRD
          ENDIF
.
          IF         ACCEPT=0
            CALL       DISCRD00
            MOVE       "   14",FLDID
            CALL       GETPOSIT
          ENDIF
EORDN999  RETURN
.------------------------------------------------------------
. Get Inventory System Linkage Details
.------------------------------------------------------------
GETISL00  MOVE       APCIISC,KEY1
          CALL       RDAPIS1          * Read Inventory Directory Inform
          BRANCH     OVRCD,GETISL90
          MOVE       ZERO,EXIT
          GOTO       GETISL99
.
GETISL90  CLEAR      DISPMSG
          APPEND     "Invalid Order Prefix ",DISPMSG
          APPEND     KEY1,DISPMSG
          APPEND     ". ",DISPMSG
          CALL       MESSAGE1
          MOVE       ONE,EXIT
GETISL99  RETURN
.------------------------------------------------------------
. Display Creditor Details
.------------------------------------------------------------
DISCRD00  MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APTKCRD,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMATYP,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASKY,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACN1,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACN2,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACA1,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACA2,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACA3,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACPC,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACTEL,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACFAX,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   35",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACMOD,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   36",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACEDI,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   37",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMACON,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASN1,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   39",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASN2,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   40",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASA1,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   41",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASA2,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASA3,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   43",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASPC,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   44",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASTEL,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   45",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASFAX,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   46",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASMOD,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   47",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASEDI,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   48",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASCON,VAR
            CALL      DISPITEM
          ENDIF
.
          RETURN
.------------------------------------------------------------
. Clear Creditor Details
.------------------------------------------------------------
CLRCRD00  MOVE      SP70,APTKCRD
          MOVE      SP70,APMATYP
          MOVE      SP70,APMASKY
          MOVE      SP70,APMACN1
          MOVE      SP70,APMACN2
          MOVE      SP70,APMACA1
          MOVE      SP70,APMACA2
          MOVE      SP70,APMACA3
          MOVE      SP70,APMACPC
          MOVE      SP70,APMACTEL
          MOVE      SP70,APMACFAX
          MOVE      SP70,APMACMOD
          MOVE      SP70,APMACEDI
          MOVE      SP70,APMACON
          MOVE      SP70,APMASN1
          MOVE      SP70,APMASN2
          MOVE      SP70,APMASA1
          MOVE      SP70,APMASA2
          MOVE      SP70,APMASA3
          MOVE      SP70,APMASA3
          MOVE      SP70,APMASPC
          MOVE      SP70,APMASTEL
          MOVE      SP70,APMASFAX
          MOVE      SP70,APMASMOD
          MOVE      SP70,APMASEDI
          MOVE      SP70,APMASCON
.
          RETURN
.
.------------------------------------------------------------
. Enter Ledger & Cost Centre
.------------------------------------------------------------
ECOST000  MOVE     ZERO,CKEYTYP
          CALL     KFMLAA00
          BRANCH   EXIT,ECOST999,ECOST999
          MOVE     "/",KEY1
          PACK     VAR,FMLALEDG,KEY1,SP70
          CALL     DISPITEM
          ADD      "3",CCOL
          MOVE     FMLALEDG,FMCCLEDG
          CALL     KFMCCA00
          SUB      "3",CCOL
          BRANCH   EXIT,ECOST999,ECOST999
          MOVE     "/",KEY1
.
          PACK     KEY14,FMLALEDG,FMCCCOCE,SP70  * srf 646145
          CALL     RDFMCC1
.
          MATCH    " 2",FMCCSTAT                 * closed account status ?
          GOTO     ECOST900 IF EQUAL             * yes
.
          PACK     LEDGCOST,FMLALEDG,KEY1,FMCCCOCE,SP70
          MOVE     FMLALEDG,APTKLED
          MOVE     FMCCCOCE,APTKCCEN
          GOTO     ECOST999
.
ECOST900  MOVE     "Cost Centre is Closed. - ",DISPMSG
          CALL     MESSAGE1
          GOTO     ECOST000
.
ECOST999  RETURN
.
.----------------------------------------------------------------------
. Enter Creditor Code for Enquiries and Read all Relevant Information
.----------------------------------------------------------------------
ECRED000  MOVE      ZERO,CKEYTYP
          CALL      KAPMAA00
          BRANCH    EXIT,ECRED100,ECRED999
          GOTO      ECRED999
.
ECRED100  PACK      APMACRD,SP70
          MOVE      ZERO,EXIT
.
ECRED999  RETURN
.
.------------------------------------------------------------
. Invoice Item Selected
.------------------------------------------------------------
SELT0000  CALL     RDAPTK3
          BRANCH   OVRCD,SELT9000
.
          MOVE     APTKCRD,SAVECRD
          MOVE     APTKDTRC,SAVEDTRC
          MOVE     APTKUNIQ,SAVEUNIQ
          MOVE     "/",KEY1
          PACK     LEDGCOST,APTKLED,KEY1,APTKCCEN
.
          CALL     SC03L000
.
          GOTO     SELT9999
.
SELT9000  BEEP
.
SELT9999  RETURN
.
.------------------------------------------------------------
. Save Input
.------------------------------------------------------------
SAVE0000  PACK     KEY16,SAVECRD,SAVEDTRC,SAVEUNIQ,SP70
          CALL     RAAPTK1
          IF       OVRCD=0
            CALL     UPAPTK1
          ELSE
            BEEP
            MOVE     "ERROR: Saving Changes. Call IBA. ",DISPMSG
            CALL     MESSAGE1
            GOTO     POST9999
          ENDIF
.
SAVE1000  CALL     SNOTE000               * Post Notes
.
SAVE9999  RETURN
.------------------------------------------------------------
. Post Notes
.------------------------------------------------------------
SNOTE000  PACK      KEY19,SAVECRD,SAVEDTRC,SAVEUNIQ,SP70
          CALL      RSAPTC1
SNOTE100  CALL      RKAPTC1
          BRANCH    OVRCD,SNOTE190
          PACK      KEY19,APTCCRD,APTCDTRC,APTCUNIQ,APTCLINE,SP70
          PACK      KEY16,SAVECRD,SAVEDTRC,SAVEUNIQ,SP70
          MATCH     KEY16,KEY19
          GOTO      SNOTE190 IF NOT EQUAL
          CALL      DEAPTC1
          GOTO      SNOTE100
.
SNOTE190  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPTC1
          TRAPCLR   IO
          BRANCH    OVRCD,SNOTE290
          MOVE      ONE,F3
.
SNOTE200  READ      TEMPWORD,SEQ;APTCCOM
          GOTO      SNOTE290 IF OVER
.
          MOVE      F3,APTCLINE
          PACK      KEY19,APTKCRD,APTKDTRC,APTKUNIQ,APTCLINE,SP70
          UNPACK    KEY19,APTCCRD,APTCDTRC,APTCUNIQ,APTCLINE
          CALL      WRAPTC1
          ADD       ONE,F3
          GOTO      SNOTE200
.
SNOTE290
.
SNOTE999  RETURN
.
.-------------------------------------------------------------
. Locking Standard Routine to Delete Record.
.-------------------------------------------------------------
DELT0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DELT1000,DELT9000,DELT9100
.
DELT1000  PACK     KEY16,SAVECRD,SAVEDTRC,SAVEUNIQ,SP70
          CALL     RAAPTK1
          IF       OVRCD=0
            CALL     DEAPTK1           * Delete Record
          ENDIF
          CALL     DNOTE000
          MOVE     ZERO,EXIT           * Exit Screen
          GOTO     DELT9999
DELT9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DELT9999
DELT9100  MOVE     ZERO,EXIT           * Exit Screen on "Cancel"
          GOTO     DELT9999
DELT9999  RETURN
.----------------------------------------
. Delete any Notes
.----------------------------------------
DNOTE000  PACK      KEY19,SAVECRD,SAVEDTRC,SAVEUNIQ,SP70
          CALL      RSAPTC1
DNOTE100  CALL      RKAPTC1
          BRANCH    OVRCD,DNOTE190
          PACK      KEY19,APTCCRD,APTCDTRC,APTCUNIQ,APTCLINE,SP70
          PACK      KEY16,SAVECRD,SAVEDTRC,SAVEUNIQ,SP70
          MATCH     KEY16,KEY19
          GOTO      DNOTE190 IF NOT EQUAL
          CALL      DEAPTC1
          GOTO      DNOTE100
.
DNOTE190
.
DNOTE999  RETURN
.
.------------------------------------------------------------
. Enter Date Received
.------------------------------------------------------------
EPDAT000   MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           MOVE     SP70,CDAY
           MOVE     ONE,CDEFDTE
           CALL     KEYDATE
           BRANCH   OVRCD,EKEYF900
           MATCH    SP2,CDAY
           GOTO     EKEYF900 IF EQUAL
           MATCH    "00",CDAY
           GOTO     EKEYF900 IF EQUAL
           PACK     APTKDTPR,CCENT,CYEAR,CMON,CDAY
           REP      " 0",APTKDTPR
           MOVE     ZERO,EXIT
           GOTO     EKEYF999
.
EPDAT900   MOVE     SP70,APTKDTPR
           MOVE     ZERO,EXIT
.
EPDAT999   RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSCIOIO/INC
          INC       APSCIOKY    
          INC       APSCKIKY    
          INC       APSISLIO/INC
          INC       APSMASIO/INC
          INC       APSMASKY    
          INC       APSMXRIO/INC
          INC       APSTCMIO/INC
          INC       APSTRKIO/INC
          INC       FMSAMAIO/INC
          INC       FMSCCAIO/INC
          INC       FMSCCAKY    
          INC       FMSCODCD    
          INC       FMSCONIO/INC
          INC       FMSLMAIO/INC
          INC       FMSLMAKY    
          INC       SINPOAIO/INC
          INC       SINPOAKY    
.
          INC       STDGENCD
.
