.***************************************************************************
.* System    :   Cash Receipting                                           *
.* Program   :   F93CMDEP.PBL                                              *
.* Desc      :   Fix program to load deposits from the old files           *
.*           :   patcashf and pridep that are no longer used in V9.03    *
.*           :                                                             *
.***************************************************************************
.* Date      :   07/10/2002                                                *
.* Author    :   Ebon Clements                                             *
.* Function  :   This program will load all deposits from patcashf and     *
.*           :   pridepaf and write them to comdepaf, rcpbnkaf, rcpbdtaf   *
.*           :   and rcpdteaf                                              *
.*                                                                         *
.* Modifications:                                                          *
.*      V9.04.01 16/11/2004  J.Tan   CAR 54982                             *
.*               Fixed to set released date (RCDTRELD) to transaction date *
.*               Fixed trans count of comdepaf to be uniq for each receipt *
.*      V9.03.05 02/07/2004  Lina Vo    CAR 50811                          *
.*               Put RCPCHQFD & IO, RCPCRDFD & IO, RCPTRNFD & IO           *
.*               PATCSHFD & IO and PRIDEPFD & IO within the program        *
.*               because they are now obsolete.                            *
.*      V9.03.04 31/05/2004 Lina Vo          CAR 50266                     *
.*               Fixed Private practice deposit to have cmdesyst=4         *
.*      V9.03.03 12/05/2004 Lina Vo          CAR 49813                     *
.*               Changed Money Order to use same field as Cheque Number    *
.*               13/05/2004 J.Tan   CAR 49769                              *
.*               Fixed scanflag for comdepaf file                          *
.*               V9.03.02  23/01/2004 J.Tan                                *
.*               Mods to set up the created date/time & user id for comdep *
.*               V9.03.01  09/01/2004 J.Tan                                *
.*               Fixed setting invoice number for rcpdteaf file            *
.*                                                                         *
.*                                                                         *
.***************************************************************************
.
          INC       STD001FD
.
. FILE DESCRIPTION INCLUDES
. -------------------------
          INC       COMDEPFD/INC
          INC       RCPBNKFD/INC
          INC       RCPBDTFD/INC
          INC       RCPDTEFD/INC
          INC       PATINVFD/INC
          INC       PRIINVFD/INC
          INC       RCPREGFD/INC
          INC       PATVISFD/INC
          INC       WEBSECFD/INC
.
.     Include Obsolete FD Files in program
.
. V5.07.001 19/08/1998 Glenn  507 Changes
.  **********************************************************************
.  *                                                                    *
.  *     Include Name : PATCSHFD.INC                                    *
.  *                                                                    *
.  *     Function     : File Definition include for Patient             *
.  *                    Pre-Admission Cash                              *
.  *                                                                    *
.  *                                                                    *
.  *     File Type    : SQL                                             *
.  *                                                                    *
.  *     File Name    : patcashf.dat                                    *
.  *                                                                    *
.  *     Keys         : KEY 11, KEY14                                   *
.  *                                                                    *
.  **********************************************************************
.
PATCASH1   IFILE SQL, FIXED=156, KEY="U1-8,9-11"
PATCASH2   IFILE SQL, FIXED=156, KEY="U1-8,135-137,9-11"
.
. NAME     TYPE   LENGTH   PHYSICAL  START LOC.   DESCRIPTION
. ----     ----   ------   --------  ----------   -----------
DCSHADMN   DIM       8           8         1      ADMISSION NUMBER
DCSHTRANS  DIM       3           3         9      TRANSACTION NUMBER
PTCHAMOU   FORM   12.2           8        12      CASH PAYMENT AMOUNT
PTCHCENT   FORM      2           2        20      CENTURY
CSHYEAR    FORM      2           2        22      YEAR
CSHMON     FORM      2           2        24      MONTH
CSHDAY     FORM      2           2        26      DAY
CSHREPNO   DIM      12          12        28      RECEIPT NUMBER
CSHTYPEF   FORM      1           2        40      PAYMENT METHOD
.                                                 0 = NOT APPLICABLE
.                                                 1 = CASH
.                                                 2 = CHEQUE
.                                                 3 = CREDIT CARD
.                                                 4 = MERCHANT CARDS EG AMEX
CSHDRAW    DIM      30          30        42      CHEQUE DRAWER
.                                                 /CREDIT CARD CODE FOR PATIENT
.                                                 /MERCHANT CODE FOR PATIENT
CSHBANK    DIM      30          30        72      CHEQUE BANK NAME
CSHBRNC    DIM      30          30       102      CHEQUE BRANCH NAME
CSHAUDF    FORM      1           2       132      0=CASH NOT AUDITED
.                                                 1=CASH AUDITED
CSHDEP     DIM       1           1       134      " " = NORMAL
.                                                 "D" = DEPOSIT
CSHDTYP    DIM       3           3       135      DEPOSIT TYPE
.                                                 (CODES FILE, CATEGORIES=DP)
CSHSYST    FORM      1           2       138      SYSTEM INDICATOR
.                                                 1 = A + E
.                                                 2 = Outpatients
.                                                 3 = Inpatients
.                                                 4 = Other Financial
.                                                 5 = Day Centre
CSHSPARE   DIM      16          16       140      SPARE
.
.End of Record                           156
.
.redefine form fields from key
CSHADMN    FORM     8
CSHTRANS   FORM     3
.
.
CSHAMNT    FORM    6.2
.
.
. V5.07.001 13/08/1998 Glenn  507 Changes
. **********************************************************************
. *                                                                    *
. *     Include Name  : PRIDEPFD.INC                                   *
. *                                                                    *
. *     Function      : File Definition include for Private Practice   *
. *                     Cash Deposits Details                          *
. *                                                                    *
. *     File Type     : SQL                                            *
. *                                                                    *
. *     File Name     : pridepaf.dat                                   *
. *                                                                    *
. *     Keys          : KEY 31                                         *
. *                                                                    *
. *                                                                    *
. **********************************************************************
.
.Data File Definition
.--------------------
PRIDEPA1  IFILE     SQL, FIXED=68, KEY="U1-8,9-10,11-16,17-28,29-31"
.
. NAME     TYPE   LENGTH   PHYSICAL  START LOC.   DESCRIPTION
. ----     ----   ------   --------  ----------   -----------
PRDPDEBT   DIM       8         8           1      Debtor Number
DPRDPSCN   DIM       2         2           9      Scan Flag
.                                                   0 = Debtor
.                                                   1 = PMI
PRDPPRAC   DIM       6         6          11      Medical Practice
PRDPRECT   DIM      12        12          17      Receipt Number
DPRDPTCN   DIM       3         3          29      Transaction Count
.                                                   (For RCPTRNFD file)
PRDPAMOU   FORM     12.2       8          32      Amount Deposited
PRDPDATE   DIM       8         8          40      Deposit Date (CCYYMMDD)
PRDPSPAR   DIM       20       20          48      Spare Variable
.
.End of Record                            68
.
.  redefine form fields from key
.  -----------------------------
.NAME       TYPE
.----       ----
PRDPSCAN    FORM        2
PRDPTCNT    FORM        3
.
.
PRDPAMNT   FORM      8.2
.
.
. V5.07.001 07/08/1998 Jim Stathopoulos  507 Changes
.  **********************************************************************
.  *                                                                    *
.  *     Include Name : RCPCHQFD.INC                                    *
.  *                                                                    *
.  *     Function     : File Definition include for Receipting          *
.  *                    Cheque Details                                  *
.  *                                                                    *
.  *     File Type    : SQL                                             *
.  *                                                                    *
.  *     File Name    : rcpchqaf.dat                                    *
.  *                                                                    *
.  *     Keys         : KEY 24                                          *
.  *                                                                    *
.  **********************************************************************
.
RCPCHQA1    IFILE   SQL, FIXED=131, KEY="U1-12,107-118"
.
.NAME       TYPE     LENGTH   PHYSICAL   START     DESCRIPTION
.----       ----     ------   --------   -----     -----------
CHQRECPT     DIM         12      12          1     RECEIPT NUMBER
CHQDATE      DIM          8       8         13     DATE
CHQCASHR     DIM          6       6         21     CASHIER
CHQDRAW      DIM         20      20         27     DRAWER
CHQBANK      DIM         30      30         47     BANK
CHQBRNCH     DIM         30      30         77     BRANCH
CHQNUM       DIM         12      12        107     CHEQUE NUMBER
DCHQAMNT     FORM      12.2       8        119     AMOUNT
CHQSTAT1     FORM         1       2        127     STATUS 1
.                                                  0 = O.K.
.                                                  1 = CANCELLED
CHQSTAT2     FORM         1       2        129     STATUS 2
.                                                  0 = NOT PRINTED
.                                                  1 = PRINTED
.End of Record                             131
.
CHQAMNT      FORM       8.2
.
.
. V5.07.001 07/08/1998 Jim Stathopoulos  507 Changes
.  **********************************************************************
.  *                                                                    *
.  *     Include Name : RCPCRDFD.INC                                    *
.  *                                                                    *
.  *     Function     : File Definition include for Receipting          *
.  *                    Card Details                                    *
.  *                                                                    *
.  *     File Type    : SQL                                             *
.  *                                                                    *
.  *     File Name    : rcpcrdaf.dat                                    *
.  *                                                                    *
.  *     Keys         : KEY 26                                          *
.  *                                                                    *
.  **********************************************************************
.
RCPCRDA1    IFILE   SQL, FIXED=57, KEY="U1-8,9-9,10-12,13-24,25-26"
.
.NAME       TYPE     LENGTH  PHYSICAL   START     DESCRIPTION
.----       ----     ------  --------   -----     -----------
CRDDATE      DIM          8      8          1     DATE
DCRDFLAG     DIM          1      1          9     TYPE INDICATOR
.                                                   3 - Credit Card
.                                                   4 - Merchant Card
CRDCODE      DIM          3      3         10     CARD CODE
CRDRECNO     DIM         12     12         13     RECEIPT NUMBER
DCRDCOUN     DIM          2      2         25     TRX COUNT
.
CRDNAME      DIM         20     20         27     PAYEE NAME
DCRDAMNT     FORM      12.2      8         47     TRX AMOUNT
CRDSTAT      FORM         1      2         55     STATUS INDICATOR
.                                                   0 - Not Printed
.                                                   1 - Printed
.End of Record                             57
.
.     redefine form fields from key
.     -----------------------------
.NAME       TYPE     LENGTH    START     DESCRIPTION
.----       ----     ------    -----     -----------
CRDFLAG      FORM         1       7      TYPE INDICATOR
CRDCOUNT     FORM         2      19      TRX COUNT
CRDAMNT      FORM       8.2
.
.
. V9.03.001 03/11/2003 Lina Vo       CAR 44080
.           Added TRNPTYPE description.
. V5.07.001 07/08/1998 Jim Stathopoulos  507 Changes
.  **********************************************************************
.  *                                                                    *
.  *     Include Name : RCPTRNFD.INC                                    *
.  *                                                                    *
.  *     Function     : File Definition include for Receipting          *
.  *                    Transaction details                             *
.  *                                                                    *
.  *     File Type    : SQL                                             *
.  *                                                                    *
.  *     File Name    : rcptrnaf.dat                                    *
.  *                                                                    *
.  *     Keys         : KEY29, KEY15, KEY32, KEY31, KEY28               *
.  *                                                                    *
.  **********************************************************************
.
RCPTRNA1    IFILE  SQL, FIXED=260, KEY="U1-8,9-14,15-26,27-29"
RCPTRNA2    IFILE  SQL, FIXED=260, KEY="U15-26,27-29"
RCPTRNA3    IFILE  SQL, FIXED=260, KEY="U1-8,30-32,9-14,15-26,27-29"
RCPTRNA4    IFILE  SQL, FIXED=260, KEY="U36-43,1-8,15-26,27-29"
RCPTRNA5    IFILE  SQL, FIXED=260, KEY="U36-43,30-32,15-26,27-29"
.
.NAME       TYPE    LENGTH  PHYSICAL   START     DESCRIPTION
.----       ----    ------  --------   -----     -----------
TRNDATE      DIM       8       8           1     TRANSACTION CODE
TRNCASHR     DIM       6       6           9     CASHIER
TRNRECNO     DIM      12      12          15     RECEIPT NUMBER
DTRNCOUN     DIM       3       3          27     TRANSACTION COUNT
TRNREG       DIM       3       3          30     REGISTER
TRNMODE      DIM       1       1          33     MODE
.                                                C = COUNTER
.                                                M = MAIL
TRNSYS       FORM      2       2          34     IBA SYSTEM CODE
TRNINV       DIM       8       8          36     INVOICE NUMBER
TRNREF       DIM      17      17          44     REFERENCE NUMBER
.
.   For DEBTORS Only ---->    38-38   Aging
.                             39-44   Debtor No
.                             45-57   Spaces
.
.   For MEDISAVE Number ->    38-46   Admisson No
.                             47-57   Spaces
.
TRNCARD      DIM       3       3          61     CARD CODE
TRNPAYEE     DIM      20      20          64     PAYEE
TRNADD1      DIM      20      20          84     ADDRESS 1
TRNADD2      DIM      20      20         104     ADDRESS 2
TRNPOST      DIM       4       4         124     POST
TRNPTYPE     FORM      1       2         128     PAYMENT TYPE
.                                                1 = CASH
.                                                2 = CHEQUE
.                                                3 = CREDIT CARD
.                                                4 = DIRECT DEBIT
.                                                5 = MONEY ORDER
.                                                6 = EFTPOS
TRNINACC     DIM      14      14         130     INCOME ACCOUNT
TRNBNKAC     DIM      14      14         144     BANK ACCOUNT
DTRNAMNT     FORM   12.2       8         158     AMOUNT
DTRNDISC     FORM   12.2       8         166     DISCOUNT
TRNSTAT      FORM      1       2         174     STATUS
.                                                0 = O.K.
.                                                1 = CANCELLED
.                                                2 = RELEASED
TRNBANK      FORM      1       2         176     BANK DEPOSIT
.                                                0 = NOT PRINTED
.                                                1 = PRINTED
TRNTYPE      FORM      1       2         178     0 = PATIENT
.                                                1 = HEALTH FUND
.                                                2 = INSURANCE COMP.
.                                                3 = GOV. DEPARTMENT
TRNCHEQ      DIM      12      12         180     CHEQUE NUMBER
.
TRNHOSP      DIM       2       2         192     HOSPITAL
TRNGSTC      DIM       6       6         194     GST CODE
TRNGSTA      DIM      14      14         200     GST ACCOUNT
TRNBDDTE     DIM       8       8         214     BANK DEPOSIT DATE
TRNSPARE     DIM      38      38         222     SPARE
.
.End of Record                           260
.
.     redefine form fields from key
.     -----------------------------
.NAME       TYPE     LENGTH    START     DESCRIPTION
.----       ----     ------    -----     -----------
TRNCOUNT     FORM        3        21     TRANSACTION COUNT
TRNAMNT      FORM      8.2
TRNDISC      FORM      8.2
.
.
.
. LOCAL VARIABLE DEFINITION
. -------------------------
.
FORM3     FORM      3
RCPFLAG   FORM      1
SETBANKV  FORM      1
SCANFLAG  DIM       1
TOTALREC  FORM      12.2
.
PRGID     INIT      "F93CMDEP"
PRGNAM    INIT      "Load Common Deposits Table   "
VERSION   INIT      "V12.00.00"
+
.**************************************************************************
.*                              ML0000                                    *
.*                      Controlling Logic (Mainline code)                 *
.**************************************************************************
.
ML0000    CALL      INIT0000               * initialisation and open files
.
ML0100    CALL      OPTN0000               * select options
          BRANCH    EXIT,ML9999            * EXIT = 1 if 0 chosen in menu
          BRANCH    COPTION,ML1000         * proceed with clean up
.
ML1000    CALL      CONTQST                * Ok to continue ?
          BRANCH    CEXIT,ML2000:          * yes
                          ML0100:          * no
                          ML0100           * cancel
.
ML2000    CALL      PROC0000               * process
.
ML9999    CHAIN     PGM                    * chain back to program
+
.****************************************************************************
.*                                INIT0000             Called by: ML0000    *
.*                             initialisation                               *
.*  The initialisation routine is used to display headings and open files.  *
.****************************************************************************
.
INIT0000  CALL      DISPHEAD                  * display heading
.
          OPEN      PATCASH1,"patcashf"
          OPEN      PRIDEPA1,"pridepaf"
          OPEN      COMDEPA1,"comdepaf"
          OPEN      RCPBNKA1,"rcpbnkaf"
          OPEN      RCPBDTA1,"rcpbdtaf"
          OPEN      RCPDTEA1,"rcpdteaf"
          OPEN      RCPTRNA2,"rcptrnaf"
          OPEN      RCPCHQA1,"rcpchqaf"
          OPEN      RCPCRDA1,"rcpcrdaf"
          OPEN      PATINVR1,"patinvrf"
          OPEN      PRIINVO1,"priinvof"
          OPEN      RCPREGA1,"rcpregaf"
          OPEN      PATVISA1,"patvisaf"
          OPEN      WEBSECA3,"websecaf"
.
INIT9999  RETURN
+
.****************************************************************************
.*                                OPTN0000             Called by: ML0000    *
.*                        get user options or exit                          *
.*                                                                          *
.*    Returns:  EXIT    = FALSE (0)  Run clean up                           *
.*                        TRUE  (1)  Exit option selected                   *
.****************************************************************************
.
OPTN0000  DISPLAY   *P1:3,*EF,*P1:4,*V2LON,ZERO,*HOFF,". Exit":
                    *P1:5,*V2LON,ONE,*HOFF,". Load Deposits from":
                                           " pridepaf and patcashf"
.
OPTN0500  KEYIN     *P1:7,*EL,"Select Option : ",*DV,UNDLN1:
                    *P17:7,*V2LON,COPTION
.
          COMPARE   ZERO,COPTION                 * exit selected ?
          GOTO      OPTN9500 IF EQUAL            * yes
.
          BRANCH    COPTION,OPTN9000             * run clean-up
.
          BEEP
          GOTO      OPTN0500
.
OPTN9000  MOVE      ZERO,EXIT
          GOTO      OPTN9999
.
OPTN9500  MOVE      ONE,EXIT
.
OPTN9999  RETURN
+
.**************************************************************************
.*                               PROC0000              Called by: ML0000  *
.*                                                                        *
.**************************************************************************
.
PROC0000  CALL      PATC0000                * Process patcashf
          CALL      PRIC0000                * Process pridepaf
.
PROC9999  RETURN
.
.**************************************************************************
.*                               PATC0000              Called by:PROC0000 *
.* Load old patcashf deposits to new files                                *
.**************************************************************************
PATC0000  DISPLAY   *P1:24,*EL,"Processing Patient Cash Deposit....";
          PACK      KEY11,SP70
          CALL      RDSCASH1
PATC1000  CALL      RDKCASH1
          BRANCH    OVRCD,PATC9999
          MOVE      "0",SCANFLAG
.
          DISPLAY   *P45:24,*V2LON,CSHADMN;
.
          CALL      CLCMDP00                          * clear comdepaf
          MOVE      CSHREPNO,CMDERECN
          MOVE      CSHTRANS,CMDETCNT
          MOVE      CSHDTYP,CMDEDTYP
          MOVE      CSHADMN,CMDEADMN
          PACK      CMDETDAT,PTCHCENT,CSHYEAR,CSHMON,CSHDAY
          REP       " 0",CMDETDAT
          MOVE      THREE,CMDESYST            * default to patient
.
          PACK      KEY8,CMDEADMN,SP70
          CALL      RDPTVIS1
          BRANCH    OVRCD,PATC7000
          MOVE      PVIURNO,CMDEURNO
          MOVE      PVITYPE,CMDESYST          * visit type
.
PATC7000  CALL      CAST0000                        * process rcptrnaf
.
PATC8000  MOVE      ONE,FORM3
          MOVE      FORM3,CMDETCNT
.
PATC8200  PACK      KEY15,CMDERECN,CMDETCNT,SP70
          CALL      RACMDEP1
          COMPARE   ZERO,OVRCD
          IF        @EQUAL
            ADD       ONE,FORM3
            MOVE      FORM3,CMDETCNT
.           PRINT     *1,"Patient Receipt No: ",CMDERECN,"  Trans: ",CMDETCNT
            GOTO      PATC8200
          ELSE
            PACK      CMDECDAT,CCC,CYY,CMM,CDD
            REP       " 0",CMDECDAT
            CLOCK     TIME,CMDECTIM
.
            PACK      KEY14,PASSCODE,SP20
            CALL      RSWBSE3
            CALL      RKWBSE3
            IF        OVRCD=0
              MATCH     PASSCODE,WBSEPCD     * Same password
              IF        @EQUAL
                MOVE      WBSEUID,CMDECUID
              ENDIF
            ENDIF
            CALL      WRCMDEP1
          ENDIF
          GOTO      PATC1000
.
PATC9999  RETURN
.
.**************************************************************************
.*                               PRIC0000              Called by:PROC0000 *
.* Load old pridepaf deposits to new files                                *
.**************************************************************************
PRIC0000  DISPLAY   *P1:24,*EL,"Processing Private Practice Cash Deposit....";
          PACK      KEY31,SP70
          CALL      RSPRDP1
PRIC1000  CALL      RKPRDP1
          BRANCH    OVRCD,PRIC9999
.
          DISPLAY   *P45:24,*V2LON,CSHADMN;
          MOVE      SP70,CSHDRAW
          MOVE      SP70,CSHBANK
          MOVE      SP70,CSHBRNC
          MOVE      PRDPRECT,CSHREPNO
          MOVE      PRDPDEBT,CSHADMN
          MOVE      PRDPTCNT,CSHTRANS
          MOVE      ZERO,FORM1
          MOVE      PRDPSCAN,FORM1
          MOVE      FORM1,SCANFLAG
          MOVE      PRDPAMNT,CSHAMNT
          REP       " 0",PRDPDATE
          UNPACK    PRDPDATE,XCENT,XYEAR,XMON,XDAY
          MOVE      XCENT,PTCHCENT
          MOVE      XYEAR,CSHYEAR
          MOVE      XMON,CSHMON
          MOVE      XDAY,CSHDAY
.
          CALL      CLCMDP00                          * clear comdepaf
          MOVE      PRDPRECT,CMDERECN
          MOVE      PRDPTCNT,CMDETCNT
          MOVE      PRDPPRAC,CMDEPRAC
          MOVE      SP10,CMDEDTYP
.
          MOVE      PRDPDEBT,CMDEURNO                 * U/R or debtor no
          MOVE      SP70,CMDEADMN    
          MOVE      ZERO,FORM1
          MOVE      PRDPSCAN,FORM1
          MOVE      FORM1,CMDESFLG
          PACK      CMDETDAT,PTCHCENT,CSHYEAR,CSHMON,CSHDAY
          REP       " 0",CMDETDAT
          MOVE      FOUR,CMDESYST            * private practice
.
PRIC7000  CALL      CAST0000                        * process rcptrnaf
.
PRIC8000  PACK      KEY15,CMDERECN,CMDETCNT,SP70
          CALL      RACMDEP1
          IF        OVRCD=0
            MOVE      ZERO,FORM3
            MOVE      CMDETCNT,FORM3
            ADD       ONE,FORM3
            MOVE      FORM3,CMDETCNT
.           PRINT     *1,"Pri.Prac Receipt No: ",CMDERECN,"  Trans: ",CMDETCNT
            GOTO      PRIC8000
          ELSE
            PACK      CMDECDAT,CCC,CYY,CMM,CDD
            REP       " 0",CMDECDAT
            CLOCK     TIME,CMDECTIM
.
            PACK      KEY14,PASSCODE,SP20
            CALL      RSWBSE3
            CALL      RKWBSE3
            IF        OVRCD=0
              MATCH     PASSCODE,WBSEPCD     * Same password
              IF        @EQUAL
                MOVE      WBSEUID,CMDECUID
              ENDIF
            ENDIF
            CALL      WRCMDEP1
          ENDIF
          GOTO      PRIC1000
.
PRIC9999  RETURN
.
+
.**************************************************************************
.*                               CAST0000              Called by:PROC0000 *
.* Load rcptrnaf records to the new files                                 *
.**************************************************************************
CAST0000  MOVE      ZERO,TOTALREC
          MOVE      ZERO,SETBANKV
          MOVE      ZERO,RCPFLAG
.
          PACK      KEY15,CSHREPNO,SP70
          CALL      RSRCBDT1
          CALL      RKRCBDT1
          BRANCH    OVRCD,CAST0800
.
          MATCH     CSHREPNO,RCBDRECN                 * Exit if receipt has
          GOTO      CAST0800 IF NOT EQUAL
.
.         Check if this receipt is in the rcptrnaf file, if not exist then
.         just add to rcpdte and rcpbdt
.
          PACK      KEY15,CSHREPNO,SP70
          CALL      RDSTRNA2
          CALL      RDKTRNA2
          BRANCH    OVRCD,CAST2000
          MATCH     CSHREPNO,TRNRECNO
          GOTO      CAST2000 IF NOT EQUAL
          GOTO      CAST9999
.
CAST0800  PACK      KEY15,CSHREPNO,SP70
          CALL      RDSTRNA2
CAST1000  CALL      RDKTRNA2
          BRANCH    OVRCD,CAST2000
.
          MATCH     CSHREPNO,TRNRECNO
          GOTO      CAST2000 IF NOT EQUAL
.
          MOVE      ONE,RCPFLAG
          IF        SETBANKV = 0
            CALL      CLRPBK00                        * clear rcpbnkaf
            CALL      SETBNK00                        * set rcpbnkaf variables
            MOVE      ONE,SETBANKV
          ENDIF
          ADD       TRNAMNT,TOTALREC
.
          CALL      CLRPBT00                          * clear rcpbdtaf
          CALL      SETBDT00                          * set rcpbdtaf variables
.
CAST1200  PACK      KEY15,RCBDRECN,RCBDUNIQ,SP70
          CALL      RARCBDT1
          IF        OVRCD=0
            MOVE      ZERO,FORM3
            MOVE      RCBDUNIQ,FORM3
            ADD       ONE,FORM3
            MOVE      FORM3,RCBDUNIQ
            GOTO      CAST1200
          ELSE
            CALL      WRRCBDT1
          ENDIF
.
          CALL      CLRPDE00                          * clear rcpdteaf
          CALL      SETDTE00                          * set rcpdteaf variables
CAST1400  PACK      KEY15,RCDTRECN,RCDTTCNT,SP70
          CALL      RARCDTE1
          IF        OVRCD=0
            MOVE      ZERO,FORM3
            MOVE      RCDTTCNT,FORM3
            ADD       ONE,FORM3
            MOVE      FORM3,RCDTTCNT
            GOTO      CAST1400
          ELSE
            CALL      WRRCDTE1
          ENDIF
.
          GOTO      CAST1000
.
.         check if record found in rcptranf file
.
CAST2000  BRANCH    RCPFLAG,CAST3000
.
          CALL      CLRPBK00                        * clear rcpbnkaf
          CALL      SETNBK00                        * set rcpbnkaf variables
          ADD       CSHAMNT,TOTALREC
.
          CALL      CLRPBT00                          * clear rcpbdtaf
          CALL      SETNBD00                          * set rcpbdtaf variables
.
CAST2200  PACK      KEY15,RCBDRECN,RCBDUNIQ,SP70
          CALL      RARCBDT1
          IF        OVRCD=0
            MOVE      ZERO,FORM3
            MOVE      RCBDUNIQ,FORM3
            ADD       ONE,FORM3
            MOVE      FORM3,RCBDUNIQ
            GOTO      CAST2200
          ELSE
            CALL      WRRCBDT1
          ENDIF
.
          CALL      CLRPDE00                          * clear rcpdteaf
          CALL      SETNDT00                          * set rcpdteaf variables
.
CAST2400  PACK      KEY15,RCDTRECN,RCDTTCNT,SP70
          CALL      RARCDTE1
          IF        OVRCD=0
            MOVE      ZERO,FORM3
            MOVE      RCDTTCNT,FORM3
            ADD       ONE,FORM3
            MOVE      FORM3,RCDTTCNT
            GOTO      CAST2400
          ELSE
            CALL      WRRCDTE1
          ENDIF
.
CAST3000  PACK      KEY12,RCBNRECN,SP70
          CALL      RARCBNK1
          IF        OVRCD=0
            CALL      RDRCBNK1
            ADD       TOTALREC,RCBNTOTP         * set receipt total
            CALL      UPRCBNK1
          ELSE
            MOVE      TOTALREC,RCBNTOTP         * set receipt total
            CALL      WRRCBNK1
          ENDIF
.
CAST9999  RETURN
+
.------------------------------------------------------------
.  clear bank header fields
.------------------------------------------------------------
CLRPBK00  MOVE      SP70,RCBNRECN
          MOVE      SP70,RCBNTDAT
          MOVE      ZERO,RCBNTOTP
          MOVE      SP70,RCBNCDRW
          MOVE      SP70,RCBNMHOS
          MOVE      SP70,RCBNMDHS
          MOVE      SP70,RCBNTTYP
          MOVE      SP70,RCBNRCOD
          MOVE      SP70,RCBNSTAT
          MOVE      SP70,RCBNBDAT
          MOVE      SP70,RCBNBTIM
          MOVE      SP70,RCBNRDAT
          MOVE      SP70,RCBNRTIM
          MOVE      SP70,RCBNCDAT
          MOVE      SP70,RCBNCTIM
          MOVE      SP70,RCBNCUID
          MOVE      SP70,RCBNUDAT
          MOVE      SP70,RCBNUTIM
          MOVE      SP70,RCBNUUID
          MOVE      SP70,RCBNSPAR
CLRPBK99  RETURN
.
.------------------------------------------------------------
.  Set bank header fields
.------------------------------------------------------------
SETBNK00  MOVE      TRNRECNO,RCBNRECN
          MOVE      TRNDATE,RCBNTDAT
          MOVE      TRNCASHR,RCBNCDRW
          MOVE      TRNHOSP,RCBNMDHS
          MOVE      TRNTYPE,RCBNTTYP
          MOVE      TRNREF,RCBNRCOD
          MOVE      TRNSTAT,RCBNSTAT 
          MOVE      TRNBDDTE,RCBNBDAT
          MOVE      TRNBDDTE,RCBNRDAT
SETBNK99  RETURN
.
.------------------------------------------------------------
.  Set bank header fields
.------------------------------------------------------------
SETNBK00  MOVE      CSHREPNO,RCBNRECN
          PACK      RCBNTDAT,PTCHCENT,CSHYEAR,CSHMON,CSHDAY
          REP       " 0",RCBNTDAT
          MOVE      SP70,CSHDRAW
          MOVE      "0",RCBNTTYP
          MOVE      "2",RCBNSTAT                 * banked
SETNBK99  RETURN
.------------------------------------------------------------
.  Clear bank details file
.------------------------------------------------------------
CLRPBT00  MOVE      SP70,RCBDTDAT
          MOVE      SP70,RCBDRECN
          MOVE      SP70,RCBDUNIQ
          MOVE      SP70,RCBDMHOS
          MOVE      SP70,RCBDMDHS
          MOVE      SP70,RCBDPTYP
          MOVE      ZERO,RCBDPAMT
          MOVE      SP70,RCBDPAYD
          MOVE      SP70,RCBDCHQN
          MOVE      SP70,RCBDDRAW
          MOVE      SP70,RCBDBANK
          MOVE      SP70,RCBDBRCH
          MOVE      SP70,RCBDCRDT
          MOVE      SP70,RCBDSTRF
.>>>>     MOVE      SP70,RCBDMONM
          MOVE      SP70,RCBDEFTT
          MOVE      SP70,RCBDCDAT
          MOVE      SP70,RCBDCTIM
          MOVE      SP70,RCBDCUID
          MOVE      SP70,RCBDUDAT
          MOVE      SP70,RCBDUTIM
          MOVE      SP70,RCBDUUID
          MOVE      SP70,RCBDSPAR
.
CLRCBT99  RETURN
.
.------------------------------------------------------------
.  Set receipt bank detail fields
.------------------------------------------------------------
SETBDT00  MOVE      TRNDATE,RCBDTDAT
          MOVE      TRNRECNO,RCBDRECN
          MOVE      TRNCOUNT,RCBDUNIQ
          MOVE      TRNHOSP,RCBDMDHS
          MOVE      TRNPTYPE,RCBDPTYP
          MOVE      TRNAMNT,RCBDPAMT
          MOVE      TRNPAYEE,RCBDPAYD
          MOVE      TRNCARD,RCBDCRDT
          MOVE      TRNCHEQ,RCBDCHQN
.
          COMPARE   "2",TRNPTYPE                      * Cheque
          GOTO      SETBDT30 IF NOT EQUAL
.
          PACK      KEY24,TRNRECNO,TRNCHEQ,SP70
          CALL      RDCHQA1
          BRANCH    OVRCD,SETBDT99
.
          MOVE      CHQDRAW,RCBDDRAW
          MOVE      CHQBANK,RCBDBANK
          MOVE      CHQBRNCH,RCBDBRCH
.
SETBDT30  COMPARE   "5",TRNPTYPE                      * Money Order
          GOTO      SETBDT99 IF NOT EQUAL
.
          MOVE      TRNCHEQ,RCBDCHQN

SETBDT99  RETURN
.
.------------------------------------------------------------
.  Set receipt bank detail fields from cash file
.------------------------------------------------------------
SETNBD00  PACK      RCBDTDAT,PTCHCENT,CSHYEAR,CSHMON,CSHDAY
          REP       " 0",RCBDTDAT
          MOVE      CSHREPNO,RCBDRECN
          MOVE      CSHTRANS,RCBDUNIQ
          MOVE      "1",RCBDPTYP                 * cash
          MOVE      CSHAMNT,RCBDPAMT
          MOVE      CSHDRAW,RCBDDRAW
          MOVE      CSHBANK,RCBDBANK
          MOVE      CSHBRNC,RCBDBRCH
SETNBD99  RETURN
.
.------------------------------------------------------------
.  Clear receipt details file
.------------------------------------------------------------
CLRPDE00  MOVE      SP70,RCDTTDAT
          MOVE      SP70,RCDTRECN
          MOVE      SP70,RCDTTCNT
          MOVE      SP70,RCDTREGI
          MOVE      SP70,RCDTINVN
          MOVE      SP70,RCDTVIST
          MOVE      SP70,RCDTURNO
          MOVE      SP70,RCDTSFLG
          MOVE      SP70,RCDTNAME
          MOVE      SP70,RCDTADD1
          MOVE      SP70,RCDTADD2
          MOVE      SP70,RCDTADD3
          MOVE      SP70,RCDTADD4 
          MOVE      SP70,RCDTPOST 
          MOVE      SP70,RCDTREFR
          MOVE      SP70,RCDTINCA
          MOVE      SP70,RCDTBNKA
          MOVE      ZERO,RCDTAMNT
          MOVE      ZERO,RCDTDISC
          MOVE      SP70,RCDTMHOS
          MOVE      SP70,RCDTMDHS
          MOVE      SP70,RCDTGSTC
          MOVE      SP70,RCDTGSTA
          MOVE      SP70,RCDTALLO
          MOVE      SP70,RCDTRELD
          MOVE      SP70,RCDTRELT
          MOVE      SP70,RCDTCDAT
          MOVE      SP70,RCDTPRAC
          MOVE      SP70,RCDTCTIM
          MOVE      SP70,RCDTCUID
          MOVE      SP70,RCDTUDAT
          MOVE      SP70,RCDTUTIM
          MOVE      SP70,RCDTUUID
          MOVE      SP70,RCDTSPAR
.
CLRPDE99  RETURN
.
.------------------------------------------------------------
.  Set receipt detail fields
.------------------------------------------------------------
SETDTE00  MOVE      TRNDATE,RCDTTDAT
          MOVE      TRNRECNO,RCDTRECN
          MOVE      TRNCOUNT,RCDTTCNT
          MOVE      TRNREG,RCDTREGI
          PACK      RCDTINVN,SP4,TRNINV
          MOVE      TRNDATE,RCDTRELD
          MOVE      ONE,RCDTALLO
          CALL      IBACLOCK                     * get current date
.
          MOVE      CTIMEIS,RCDTRELT
.
          PACK      KEY3,TRNREG,SP70
          CALL      RDREGA1
          BRANCH    OVRCD,SETDTE30
.
          MOVE      CMDEADMN,RCDTVIST
          MOVE      CMDEURNO,RCDTURNO
          MOVE      SCANFLAG,RCDTSFLG
          IF        REGIBACD=2
            PACK      KEY8,TRNINV,SP70
            CALL      RDPRIN1
            IF        OVRCD=0
              MOVE      PRINSCAN,RCDTSFLG
              MOVE      PRINPRAC,RCDTPRAC
              MOVE      PRINDEBT,RCDTURNO
              MOVE      ZERO,FORM1
              MOVE      PRINSCAN,FORM1
              MOVE      FORM1,RCDTSFLG
            ENDIF  
          ELSE
            PACK      KEY8,TRNINV,SP70
            CALL      RDINV1 
            IF        OVRCD=0
              MOVE      PINVADM,RCDTVIST
              MOVE      PINVUR,RCDTURNO 
            ENDIF
          ENDIF

SETDTE30  MOVE      TRNINACC,RCDTINCA
          MOVE      TRNBNKAC,RCDTBNKA
          MOVE      TRNAMNT,RCDTAMNT
          MOVE      TRNDISC,RCDTDISC
          MOVE      TRNHOSP,RCDTMDHS
          MOVE      TRNGSTC,RCDTGSTC
          MOVE      TRNGSTA,RCDTGSTA
          MOVE      TRNREF,RCDTREFR
          MOVE      TRNPAYEE,RCDTNAME
          MOVE      TRNADD1,RCDTADD1
          MOVE      TRNADD2,RCDTADD2
          MOVE      SP70,RCDTADD3
          MOVE      SP70,RCDTADD4
          MOVE      TRNPOST,RCDTPOST 
.
SETDTE99  RETURN
.
.------------------------------------------------------------
.  Set receipt detail (rcpdteaf) fields 
.------------------------------------------------------------
SETNDT00  PACK      RCDTTDAT,PTCHCENT,CSHYEAR,CSHMON,CSHDAY
          REP       " 0",RCDTTDAT
          MOVE      CSHREPNO,RCDTRECN
          MOVE      CSHTRANS,RCDTTCNT
          MOVE      ONE,RCDTALLO
          MOVE      CMDEURNO,RCDTURNO
          MOVE      CMDEADMN,RCDTVIST
          MOVE      SCANFLAG,RCDTSFLG
          MOVE      CSHAMNT,RCDTAMNT
SETNDT99  RETURN
.------------------------------------------------------------
.  Clear common deposit file
.------------------------------------------------------------
CLCMDP00  MOVE      SP70,CMDETDAT
          MOVE      SP70,CMDERECN
          MOVE      SP70,CMDETCNT
          MOVE      SP70,CMDEDTYP
          MOVE      SP70,CMDERRFN
          MOVE      SP70,CMDEREFD
          MOVE      SP70,CMDEREFT
          MOVE      SP10,CMDEPRAC
          MOVE      SP70,CMDEURNO
          MOVE      SP70,CMDEADMN
          MOVE      "1",CMDESFLG
          MOVE      ZERO,CMDESYST
          MOVE      SP10,CMDEPRAC
          MOVE      SP70,CMDECDAT
          MOVE      SP70,CMDECTIM
          MOVE      SP70,CMDECUID
          MOVE      SP70,CMDEUDAT
          MOVE      SP70,CMDEUTIM
          MOVE      SP70,CMDEUUID
          MOVE      SP70,CMDESPAR
.
CLCMDP99  RETURN
+
.
.     Include Obsolete FD Files in program
.
.
. **********************************************************
. *                                                        *
. *  Include Name :  PATIOCSH                              *
. *                                                        *
. *  Function     :  I/O for patcashf file                 *
. *                                                        *
. *  Keys         :  KEY11                                 *
. *                                                        *
. **********************************************************
.
RDACASH1 MOVE      ZERO,OVRCD
         RESET     KEY11
         READ      PATCASH1,KEY11;ANS
         GOTO      OVERCOND IF OVER
         RETURN
.
RDSCASH1
         MOVE      ZERO,OVRCD
         RESET     KEY11
         READ      PATCASH1,KEY11;;
         GOTO      OVERCOND IF OVER
         RETURN
RDCASH1
         MOVE      ZERO,OVRCD
         RESET     KEY11
         READ      PATCASH1,KEY11;DCSHADMN,DCSHTRANS:
                                 PTCHAMOU,PTCHCENT,CSHYEAR,CSHMON:
                                 CSHDAY,CSHREPNO,CSHTYPEF,CSHDRAW,CSHBANK:
                                 CSHBRNC,CSHAUDF,CSHDEP,CSHDTYP:
                                 CSHSYST,CSHSPARE
         GOTO      OVERCOND IF OVER
         MOVE      DCSHADMN,CSHADMN
         MOVE      DCSHTRANS,CSHTRANS
         MOVE      PTCHAMOU,CSHAMNT
         RETURN
.
RDKCASH1
         MOVE      ZERO,OVRCD
         READKS    PATCASH1;DCSHADMN,DCSHTRANS:
                                 PTCHAMOU,PTCHCENT,CSHYEAR,CSHMON:
                                 CSHDAY,CSHREPNO,CSHTYPEF,CSHDRAW,CSHBANK:
                                 CSHBRNC,CSHAUDF,CSHDEP,CSHDTYP:
                                 CSHSYST,CSHSPARE
         GOTO      OVERCOND IF OVER
         MOVE      DCSHADMN,CSHADMN
         MOVE      DCSHTRANS,CSHTRANS
         MOVE      PTCHAMOU,CSHAMNT
         RETURN
.
RDPCASH1 MOVE      ZERO,OVRCD
         READKP    PATCASH1;DCSHADMN,DCSHTRANS:
                                 PTCHAMOU,PTCHCENT,CSHYEAR,CSHMON:
                                 CSHDAY,CSHREPNO,CSHTYPEF,CSHDRAW,CSHBANK:
                                 CSHBRNC,CSHAUDF,CSHDEP,CSHDTYP:
                                 CSHSYST,CSHSPARE
         GOTO      OVERCOND IF OVER
         MOVE      DCSHADMN,CSHADMN
         MOVE      DCSHTRANS,CSHTRANS
         MOVE      PTCHAMOU,CSHAMNT
         RETURN
.
UPCASH1  MOVE      CSHADMN,DCSHADMN
         MOVE      CSHTRANS,DCSHTRANS
         MOVE      CSHAMNT,PTCHAMOU
         UPDATE    PATCASH1;DCSHADMN,DCSHTRANS:
                                 PTCHAMOU,PTCHCENT,CSHYEAR,CSHMON:
                                 CSHDAY,CSHREPNO,CSHTYPEF,CSHDRAW,CSHBANK:
                                 CSHBRNC,CSHAUDF,CSHDEP,CSHDTYP:
                                 CSHSYST,CSHSPARE
         RETURN
.
WRCASH1  RESET     KEY11
         MOVE      CSHADMN,DCSHADMN
         MOVE      CSHTRANS,DCSHTRANS
         MOVE      CSHAMNT,PTCHAMOU
         WRITE     PATCASH1,KEY11;KEY11,PTCHAMOU,PTCHCENT,CSHYEAR,CSHMON:
                                 CSHDAY,CSHREPNO,CSHTYPEF,CSHDRAW,CSHBANK:
                                 CSHBRNC,CSHAUDF,CSHDEP,CSHDTYP:
                                 CSHSYST,CSHSPARE
.
         RETURN
.
DECASH1  RESET     KEY11
         DELETE    PATCASH1,KEY11
         RETURN
.
.        2nd Index
.
RDACASH2 MOVE      ZERO,OVRCD
         RESET     KEY14
         READ      PATCASH2,KEY14;ANS
         GOTO      OVERCOND IF OVER
         RETURN
.
RDSCASH2 MOVE      ZERO,OVRCD
         RESET     KEY14
         READ      PATCASH2,KEY14;;
         GOTO      OVERCOND IF OVER
         RETURN
.
RDCASH2  MOVE      ZERO,OVRCD
         RESET     KEY14
         READ      PATCASH2,KEY14;DCSHADMN,DCSHTRANS:
                                 PTCHAMOU,PTCHCENT,CSHYEAR,CSHMON:
                                 CSHDAY,CSHREPNO,CSHTYPEF,CSHDRAW,CSHBANK:
                                 CSHBRNC,CSHAUDF,CSHDEP,CSHDTYP:
                                 CSHSYST,CSHSPARE
         GOTO      OVERCOND IF OVER
         MOVE      DCSHADMN,CSHADMN
         MOVE      DCSHTRANS,CSHTRANS
         MOVE      PTCHAMOU,CSHAMNT
         RETURN
.
RDKCASH2 MOVE      ZERO,OVRCD
         READKS    PATCASH2;DCSHADMN,DCSHTRANS:
                                 PTCHAMOU,PTCHCENT,CSHYEAR,CSHMON:
                                 CSHDAY,CSHREPNO,CSHTYPEF,CSHDRAW,CSHBANK:
                                 CSHBRNC,CSHAUDF,CSHDEP,CSHDTYP:
                                 CSHSYST,CSHSPARE
         GOTO      OVERCOND IF OVER
         MOVE      DCSHADMN,CSHADMN
         MOVE      DCSHTRANS,CSHTRANS
         MOVE      PTCHAMOU,CSHAMNT
         RETURN
.
RDPCASH2 MOVE      ZERO,OVRCD
         READKP    PATCASH2;DCSHADMN,DCSHTRANS:
                                 PTCHAMOU,PTCHCENT,CSHYEAR,CSHMON:
                                 CSHDAY,CSHREPNO,CSHTYPEF,CSHDRAW,CSHBANK:
                                 CSHBRNC,CSHAUDF,CSHDEP,CSHDTYP:
                                 CSHSYST,CSHSPARE
         GOTO      OVERCOND IF OVER
         MOVE      DCSHADMN,CSHADMN
         MOVE      DCSHTRANS,CSHTRANS
         MOVE      PTCHAMOU,CSHAMNT
         RETURN
.
.
.
. PRIDEPIO.INC
. ------------
. Filename     : pridepaf
. Description  : Private Practice Cash Deposits File I/O Subroutines
. Variables    : OVRCD    FORM    1
.                KEY31    DIM     31
.
RAPRDP1   MOVE      ZERO,OVRCD
          RESET     KEY31
          READ      PRIDEPA1,KEY31;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
RSPRDP1   MOVE      ZERO,OVRCD
          RESET     KEY31
          READ      PRIDEPA1,KEY31;;
          RETURN
.
RDPRDP1   MOVE      ZERO,OVRCD
          RESET     KEY31
          READ      PRIDEPA1,KEY31;PRDPDEBT,DPRDPSCN,PRDPPRAC,PRDPRECT:
                                   DPRDPTCN,PRDPAMOU,PRDPDATE,PRDPSPAR
          GOTO      OVERCOND IF OVER
          MOVE      DPRDPSCN,PRDPSCAN
          MOVE      DPRDPTCN,PRDPTCNT
          MOVE      PRDPAMOU,PRDPAMNT
          RETURN
.
RKPRDP1   MOVE      ZERO,OVRCD
          RESET     KEY31
          READKS    PRIDEPA1;PRDPDEBT,DPRDPSCN,PRDPPRAC,PRDPRECT,DPRDPTCN:
                             PRDPAMOU,PRDPDATE,PRDPSPAR
          GOTO      OVERCOND IF OVER
          MOVE      DPRDPSCN,PRDPSCAN
          MOVE      DPRDPTCN,PRDPTCNT
          MOVE      PRDPAMOU,PRDPAMNT
          RETURN
.
RPPRDP1   MOVE      ZERO,OVRCD
          RESET     KEY31
          READKP    PRIDEPA1;PRDPDEBT,DPRDPSCN,PRDPPRAC,PRDPRECT,DPRDPTCN:
                             PRDPAMOU,PRDPDATE,PRDPSPAR
          GOTO      OVERCOND IF OVER
          MOVE      DPRDPSCN,PRDPSCAN
          MOVE      DPRDPTCN,PRDPTCNT
          MOVE      PRDPAMOU,PRDPAMNT
          RETURN
.
WRPRDP1   MOVE      ZERO,OVRCD
          MOVE      PRDPAMNT,PRDPAMOU
          WRITE     PRIDEPA1,KEY31;KEY31:
                             PRDPAMOU,PRDPDATE,PRDPSPAR
          RETURN
.
UPPRDP1   MOVE      PRDPSCAN,DPRDPSCN
          MOVE      PRDPTCNT,DPRDPTCN
          MOVE      PRDPAMNT,PRDPAMOU
          UPDATE    PRIDEPA1;PRDPDEBT,DPRDPSCN,PRDPPRAC,PRDPRECT,DPRDPTCN:
                             PRDPAMOU,PRDPDATE,PRDPSPAR
          RETURN
.
DEPRDP1   RESET     KEY31
          DELETE    PRIDEPA1,KEY31
          RETURN
.
.
.
.   INC       RCPCHQIO.INC
.
.   FILE  I/O REQUESTS FOR BANK ACCOUNT FILE.
.
.OVRCD  FORM            1             0=NOT OVER
.                                     1= OVER
.KEY24  DIM            24             KEY FOR RCPCHQA1
.
.       NOTE  OVRCD=1   RECORD DOES NOT EXIST
.                   2   RECORD IS LOCKED
.
RDACHQA1 RESET     KEY24
         MOVE      ZERO,OVRCD
         READ      RCPCHQA1,KEY24;ANS
         GOTO      OVERCOND IF OVER
         RETURN
.
RDSCHQA1 RESET     KEY24
         READ      RCPCHQA1,KEY24;;
         RETURN
.
RDCHQA1  MOVE      ZERO,OVRCD
         RESET     KEY24
         READ      RCPCHQA1,KEY24;CHQRECPT,CHQDATE,CHQCASHR,CHQDRAW:
                                  CHQBANK,CHQBRNCH,CHQNUM,DCHQAMNT:
                                  CHQSTAT1,CHQSTAT2
         GOTO      OVERCOND IF OVER
         MOVE      DCHQAMNT,CHQAMNT
         RETURN
.
RDKCHQA1 MOVE      ZERO,OVRCD
         READKS    RCPCHQA1;CHQRECPT,CHQDATE,CHQCASHR,CHQDRAW:
                            CHQBANK,CHQBRNCH,CHQNUM,DCHQAMNT:
                            CHQSTAT1,CHQSTAT2
         GOTO      OVERCOND IF OVER
         MOVE      DCHQAMNT,CHQAMNT
         RETURN
.
RDPCHQA1 MOVE      ZERO,OVRCD
         READKP    RCPCHQA1;CHQRECPT,CHQDATE,CHQCASHR,CHQDRAW:
                            CHQBANK,CHQBRNCH,CHQNUM,DCHQAMNT:
                            CHQSTAT1,CHQSTAT2
         GOTO      OVERCOND IF OVER
         MOVE      DCHQAMNT,CHQAMNT
         RETURN
.
WRCHQA1  RESET     KEY24
         MOVE      CHQAMNT,DCHQAMNT
         MOVE      ZERO,OVRCD
         WRITE     RCPCHQA1,KEY24;CHQRECPT,CHQDATE,CHQCASHR,CHQDRAW:
                                  CHQBANK,CHQBRNCH,CHQNUM,DCHQAMNT:
                                  CHQSTAT1,CHQSTAT2
         RETURN
.
UPCHQA1  MOVE      CHQAMNT,DCHQAMNT
         UPDATE    RCPCHQA1;CHQRECPT,CHQDATE,CHQCASHR,CHQDRAW:
                            CHQBANK,CHQBRNCH,CHQNUM,DCHQAMNT:
                            CHQSTAT1,CHQSTAT2
         RETURN
.
.
DECHQA1  RESET     KEY24
         MOVE      ZERO,OVRCD
         DELETE    RCPCHQA1,KEY24
         RETURN
.
.
.
.
.   INC       RCPCRDIO.INC
.
.   FILE  I/O REQUESTS FOR CREDIT/MERCHANT CARD FILE.
.
.OVRCD  FORM            1             0=NOT OVER
.                                     1= OVER
.KEY26  DIM            26             KEY FOR RCPCRDA1
.
.       NOTE  OVRCD=1   RECORD DOES NOT EXIST
.                   2   RECORD IS LOCKED
.
RDACRDA1 RESET     KEY26
         MOVE      ZERO,OVRCD
         READ      RCPCRDA1,KEY26;ANS
         GOTO      OVERCOND IF OVER
         RETURN
.
RDSCRDA1 RESET     KEY26
         READ      RCPCRDA1,KEY26;;
         RETURN
.
RDCRDA1  MOVE      ZERO,OVRCD
         RESET     KEY26
         READ      RCPCRDA1,KEY26;CRDDATE,DCRDFLAG,CRDCODE,CRDRECNO,DCRDCOUN:
                                  CRDNAME,DCRDAMNT,CRDSTAT
         GOTO      OVERCOND IF OVER
         MOVE      DCRDFLAG,CRDFLAG
         MOVE      DCRDCOUN,CRDCOUNT
         MOVE      DCRDAMNT,CRDAMNT
         RETURN
.
RDKCRDA1 MOVE      ZERO,OVRCD
         READKS    RCPCRDA1;CRDDATE,DCRDFLAG,CRDCODE,CRDRECNO,DCRDCOUN:
                            CRDNAME,DCRDAMNT,CRDSTAT
         GOTO      OVERCOND IF OVER
         MOVE      DCRDFLAG,CRDFLAG
         MOVE      DCRDCOUN,CRDCOUNT
         MOVE      DCRDAMNT,CRDAMNT
         RETURN
.
WRCRDA1  RESET     KEY26
         MOVE      ZERO,OVRCD
         MOVE      CRDFLAG,DCRDFLAG
         MOVE      CRDCOUNT,DCRDCOUN
         MOVE      CRDAMNT,DCRDAMNT
         WRITE     RCPCRDA1,KEY26;CRDDATE,DCRDFLAG,CRDCODE,CRDRECNO,DCRDCOUN:
                                  CRDNAME,DCRDAMNT,CRDSTAT
         RETURN
.
UPCRDA1  MOVE      CRDFLAG,DCRDFLAG
         MOVE      CRDCOUNT,DCRDCOUN
         MOVE      CRDAMNT,DCRDAMNT
         UPDATE    RCPCRDA1;CRDDATE,DCRDFLAG,CRDCODE,CRDRECNO,DCRDCOUN:
                            CRDNAME,DCRDAMNT,CRDSTAT
         RETURN
.
.
DECRDA1  RESET     KEY26
         MOVE      ZERO,OVRCD
         DELETE    RCPCRDA1,KEY26
         RETURN
.
.
.
.
.   INC       RCPTRNIO.INC
.
.   FILE  I/O REQUESTS FOR TRANSACTION FILE.
.
.OVRCD  FORM            1             0 = NOT OVER
.                                     1 = OVER
.
.KEY29    DIM          29             KEY FOR RCPTRNA1
.KEY15    DIM          15             KEY FOR RCPTRNA2
.KEY32    DIM          32             KEY FOR RCPTRNA3
.KEY31    DIM          31             KEY FOR RCPTRNA4
.KEY28    DIM          28             KEY FOR RCPTRNA5
.
.         NOTE  OVRCD = 1   RECORD DOES NOT EXIST
.                       2   RECORD IS LOCKED
.
RDATRNA1 RESET     KEY29
         MOVE      ZERO,OVRCD
         READ      RCPTRNA1,KEY29;ANS
         GOTO      OVERCOND IF OVER
         RETURN
.
RDSTRNA1 RESET     KEY29
         READ      RCPTRNA1,KEY29;;
         RETURN
.
RDTRNA1  MOVE      ZERO,OVRCD
         RESET     KEY29
         READ      RCPTRNA1,KEY29;TRNDATE,TRNCASHR,TRNRECNO,DTRNCOUN,TRNREG:
                                  TRNMODE,TRNSYS,TRNINV,TRNREF,TRNCARD:
                                  TRNPAYEE,TRNADD1,TRNADD2,TRNPOST,TRNPTYPE:
                                  TRNINACC,TRNBNKAC,DTRNAMNT,DTRNDISC,TRNSTAT:
                                  TRNBANK,TRNTYPE,TRNCHEQ,TRNHOSP,TRNGSTC:
                                  TRNGSTA,TRNBDDTE,TRNSPARE
         GOTO      OVERCOND IF OVER
         MOVE      DTRNCOUN,TRNCOUNT
         MOVE      DTRNAMNT,TRNAMNT
         MOVE      DTRNDISC,TRNDISC
         RETURN
.
RDKTRNA1 MOVE      ZERO,OVRCD
         READKS    RCPTRNA1;TRNDATE,TRNCASHR,TRNRECNO,DTRNCOUN,TRNREG:
                            TRNMODE,TRNSYS,TRNINV,TRNREF,TRNCARD:
                            TRNPAYEE,TRNADD1,TRNADD2,TRNPOST,TRNPTYPE:
                            TRNINACC,TRNBNKAC,DTRNAMNT,DTRNDISC,TRNSTAT:
                            TRNBANK,TRNTYPE,TRNCHEQ,TRNHOSP,TRNGSTC:
                            TRNGSTA,TRNBDDTE,TRNSPARE
         GOTO      OVERCOND IF OVER
         MOVE      DTRNCOUN,TRNCOUNT
         MOVE      DTRNAMNT,TRNAMNT
         MOVE      DTRNDISC,TRNDISC
         RETURN
.
RDATRNA2 RESET     KEY15
         MOVE      ZERO,OVRCD
         READ      RCPTRNA2,KEY15;ANS
         GOTO      OVERCOND IF OVER
         RETURN
.
RDSTRNA2 RESET     KEY15
         READ      RCPTRNA2,KEY15;;
         RETURN
.
RDTRNA2  MOVE      ZERO,OVRCD
         RESET     KEY15
         READ      RCPTRNA2,KEY15;TRNDATE,TRNCASHR,TRNRECNO,DTRNCOUN,TRNREG:
                                  TRNMODE,TRNSYS,TRNINV,TRNREF,TRNCARD:
                                  TRNPAYEE,TRNADD1,TRNADD2,TRNPOST,TRNPTYPE:
                                  TRNINACC,TRNBNKAC,DTRNAMNT,DTRNDISC,TRNSTAT:
                                  TRNBANK,TRNTYPE,TRNCHEQ,TRNHOSP,TRNGSTC:
                                  TRNGSTA,TRNBDDTE,TRNSPARE
         GOTO      OVERCOND IF OVER
         MOVE      DTRNCOUN,TRNCOUNT
         MOVE      DTRNAMNT,TRNAMNT
         MOVE      DTRNDISC,TRNDISC
         RETURN
.
RDKTRNA2 MOVE      ZERO,OVRCD
         READKS    RCPTRNA2;TRNDATE,TRNCASHR,TRNRECNO,DTRNCOUN,TRNREG:
                            TRNMODE,TRNSYS,TRNINV,TRNREF,TRNCARD:
                            TRNPAYEE,TRNADD1,TRNADD2,TRNPOST,TRNPTYPE:
                            TRNINACC,TRNBNKAC,DTRNAMNT,DTRNDISC,TRNSTAT:
                            TRNBANK,TRNTYPE,TRNCHEQ,TRNHOSP,TRNGSTC:
                            TRNGSTA,TRNBDDTE,TRNSPARE
         GOTO      OVERCOND IF OVER
         MOVE      DTRNCOUN,TRNCOUNT
         MOVE      DTRNAMNT,TRNAMNT
         MOVE      DTRNDISC,TRNDISC
         RETURN
.
RDATRNA3 RESET     KEY32
         MOVE      ZERO,OVRCD
         READ      RCPTRNA3,KEY32;ANS
         GOTO      OVERCOND IF OVER
         RETURN
.
RDSTRNA3 RESET     KEY32
         READ      RCPTRNA3,KEY32;;
         RETURN
.
RDTRNA3  MOVE      ZERO,OVRCD
         RESET     KEY32
         READ      RCPTRNA3,KEY32;TRNDATE,TRNCASHR,TRNRECNO,DTRNCOUN,TRNREG:
                                  TRNMODE,TRNSYS,TRNINV,TRNREF,TRNCARD:
                                  TRNPAYEE,TRNADD1,TRNADD2,TRNPOST,TRNPTYPE:
                                  TRNINACC,TRNBNKAC,DTRNAMNT,DTRNDISC,TRNSTAT:
                                  TRNBANK,TRNTYPE,TRNCHEQ,TRNHOSP,TRNGSTC:
                                  TRNGSTA,TRNBDDTE,TRNSPARE
         GOTO      OVERCOND IF OVER
         MOVE      DTRNCOUN,TRNCOUNT
         MOVE      DTRNAMNT,TRNAMNT
         MOVE      DTRNDISC,TRNDISC
         RETURN
.
RDKTRNA3 MOVE      ZERO,OVRCD
         READKS    RCPTRNA3;TRNDATE,TRNCASHR,TRNRECNO,DTRNCOUN,TRNREG:
                            TRNMODE,TRNSYS,TRNINV,TRNREF,TRNCARD:
                            TRNPAYEE,TRNADD1,TRNADD2,TRNPOST,TRNPTYPE:
                            TRNINACC,TRNBNKAC,DTRNAMNT,DTRNDISC,TRNSTAT:
                            TRNBANK,TRNTYPE,TRNCHEQ,TRNHOSP,TRNGSTC:
                            TRNGSTA,TRNBDDTE,TRNSPARE
         GOTO      OVERCOND IF OVER
         MOVE      DTRNCOUN,TRNCOUNT
         MOVE      DTRNAMNT,TRNAMNT
         MOVE      DTRNDISC,TRNDISC
         RETURN
.
RDATRNA4 RESET     KEY31
         MOVE      ZERO,OVRCD
         READ      RCPTRNA4,KEY31;ANS
         GOTO      OVERCOND IF OVER
         RETURN
.
RDSTRNA4 RESET     KEY31
         READ      RCPTRNA4,KEY31;;
         RETURN
.
RDTRNA4  MOVE      ZERO,OVRCD
         RESET     KEY31
         READ      RCPTRNA4,KEY31;TRNDATE,TRNCASHR,TRNRECNO,DTRNCOUN,TRNREG:
                                  TRNMODE,TRNSYS,TRNINV,TRNREF,TRNCARD:
                                  TRNPAYEE,TRNADD1,TRNADD2,TRNPOST,TRNPTYPE:
                                  TRNINACC,TRNBNKAC,DTRNAMNT,DTRNDISC,TRNSTAT:
                                  TRNBANK,TRNTYPE,TRNCHEQ,TRNHOSP,TRNGSTC:
                                  TRNGSTA,TRNBDDTE,TRNSPARE
         GOTO      OVERCOND IF OVER
         MOVE      DTRNCOUN,TRNCOUNT
         MOVE      DTRNAMNT,TRNAMNT
         MOVE      DTRNDISC,TRNDISC
         RETURN
.
RDKTRNA4 MOVE      ZERO,OVRCD
         READKS    RCPTRNA4;TRNDATE,TRNCASHR,TRNRECNO,DTRNCOUN,TRNREG:
                            TRNMODE,TRNSYS,TRNINV,TRNREF,TRNCARD:
                            TRNPAYEE,TRNADD1,TRNADD2,TRNPOST,TRNPTYPE:
                            TRNINACC,TRNBNKAC,DTRNAMNT,DTRNDISC,TRNSTAT:
                            TRNBANK,TRNTYPE,TRNCHEQ,TRNHOSP,TRNGSTC:
                            TRNGSTA,TRNBDDTE,TRNSPARE
         GOTO      OVERCOND IF OVER
         MOVE      DTRNCOUN,TRNCOUNT
         MOVE      DTRNAMNT,TRNAMNT
         MOVE      DTRNDISC,TRNDISC
         RETURN
.
RDATRNA5 RESET     KEY28
         MOVE      ZERO,OVRCD
         READ      RCPTRNA5,KEY28;ANS
         GOTO      OVERCOND IF OVER
         RETURN
.
RDSTRNA5 RESET     KEY28
         READ      RCPTRNA5,KEY28;;
         RETURN
.
RDTRNA5  MOVE      ZERO,OVRCD
         RESET     KEY28
         READ      RCPTRNA5,KEY28;TRNDATE,TRNCASHR,TRNRECNO,DTRNCOUN,TRNREG:
                                  TRNMODE,TRNSYS,TRNINV,TRNREF,TRNCARD:
                                  TRNPAYEE,TRNADD1,TRNADD2,TRNPOST,TRNPTYPE:
                                  TRNINACC,TRNBNKAC,DTRNAMNT,DTRNDISC,TRNSTAT:
                                  TRNBANK,TRNTYPE,TRNCHEQ,TRNHOSP,TRNGSTC:
                                  TRNGSTA,TRNBDDTE,TRNSPARE
         GOTO      OVERCOND IF OVER
         MOVE      DTRNCOUN,TRNCOUNT
         MOVE      DTRNAMNT,TRNAMNT
         MOVE      DTRNDISC,TRNDISC
         RETURN
.
RDKTRNA5 MOVE      ZERO,OVRCD
         READKS    RCPTRNA5;TRNDATE,TRNCASHR,TRNRECNO,DTRNCOUN,TRNREG:
                            TRNMODE,TRNSYS,TRNINV,TRNREF,TRNCARD:
                            TRNPAYEE,TRNADD1,TRNADD2,TRNPOST,TRNPTYPE:
                            TRNINACC,TRNBNKAC,DTRNAMNT,DTRNDISC,TRNSTAT:
                            TRNBANK,TRNTYPE,TRNCHEQ,TRNHOSP,TRNGSTC:
                            TRNGSTA,TRNBDDTE,TRNSPARE
         GOTO      OVERCOND IF OVER
         MOVE      DTRNCOUN,TRNCOUNT
         MOVE      DTRNAMNT,TRNAMNT
         MOVE      DTRNDISC,TRNDISC
         RETURN
.
WRTRNA1  RESET     KEY29
         MOVE      ZERO,OVRCD
         MOVE      TRNAMNT,DTRNAMNT
         MOVE      TRNDISC,DTRNDISC
         MOVE      TRNCOUNT,DTRNCOUN
         WRITE     RCPTRNA1,KEY29;TRNDATE,TRNCASHR,TRNRECNO,DTRNCOUN,TRNREG:
                                  TRNMODE,TRNSYS,TRNINV,TRNREF,TRNCARD:
                                  TRNPAYEE,TRNADD1,TRNADD2,TRNPOST,TRNPTYPE:
                                  TRNINACC,TRNBNKAC,DTRNAMNT,DTRNDISC,TRNSTAT:
                                  TRNBANK,TRNTYPE,TRNCHEQ,TRNHOSP,TRNGSTC:
                                  TRNGSTA,TRNBDDTE,TRNSPARE
.
         RETURN
.
UPTRNA1  MOVE      TRNCOUNT,DTRNCOUN
         MOVE      TRNAMNT,DTRNAMNT
         MOVE      TRNDISC,DTRNDISC
         UPDATE    RCPTRNA1;TRNDATE,TRNCASHR,TRNRECNO,DTRNCOUN,TRNREG:
                            TRNMODE,TRNSYS,TRNINV,TRNREF,TRNCARD:
                            TRNPAYEE,TRNADD1,TRNADD2,TRNPOST,TRNPTYPE:
                            TRNINACC,TRNBNKAC,DTRNAMNT,DTRNDISC,TRNSTAT:
                            TRNBANK,TRNTYPE,TRNCHEQ,TRNHOSP,TRNGSTC:
                            TRNGSTA,TRNBDDTE,TRNSPARE
         RETURN
.
UPTRNA2  MOVE      TRNCOUNT,DTRNCOUN
         MOVE      TRNAMNT,DTRNAMNT
         MOVE      TRNDISC,DTRNDISC
         UPDATE    RCPTRNA2;TRNDATE,TRNCASHR,TRNRECNO,DTRNCOUN,TRNREG:
                            TRNMODE,TRNSYS,TRNINV,TRNREF,TRNCARD:
                            TRNPAYEE,TRNADD1,TRNADD2,TRNPOST,TRNPTYPE:
                            TRNINACC,TRNBNKAC,DTRNAMNT,DTRNDISC,TRNSTAT:
                            TRNBANK,TRNTYPE,TRNCHEQ,TRNHOSP,TRNGSTC:
                            TRNGSTA,TRNBDDTE,TRNSPARE
         RETURN
.
UPTRNA3  MOVE      TRNCOUNT,DTRNCOUN
         MOVE      TRNAMNT,DTRNAMNT
         MOVE      TRNDISC,DTRNDISC
         UPDATE    RCPTRNA3;TRNDATE,TRNCASHR,TRNRECNO,DTRNCOUN,TRNREG:
                            TRNMODE,TRNSYS,TRNINV,TRNREF,TRNCARD:
                            TRNPAYEE,TRNADD1,TRNADD2,TRNPOST,TRNPTYPE:
                            TRNINACC,TRNBNKAC,DTRNAMNT,DTRNDISC,TRNSTAT:
                            TRNBANK,TRNTYPE,TRNCHEQ,TRNHOSP,TRNGSTC:
                            TRNGSTA,TRNBDDTE,TRNSPARE
         RETURN
.
DETRNA1  RESET     KEY29
         MOVE      ZERO,OVRCD
         DELETE    RCPTRNA1,KEY29
.
         RETURN
.
DETRNA2  RESET     KEY15
         MOVE      ZERO,OVRCD
         DELETE    RCPTRNA2,KEY15
         RETURN
.
RDPTRNA2 MOVE      ZERO,OVRCD
         READKP    RCPTRNA2;TRNDATE,TRNCASHR,TRNRECNO,DTRNCOUN,TRNREG:
                            TRNMODE,TRNSYS,TRNINV,TRNREF,TRNCARD:
                            TRNPAYEE,TRNADD1,TRNADD2,TRNPOST,TRNPTYPE:
                            TRNINACC,TRNBNKAC,DTRNAMNT,DTRNDISC,TRNSTAT:
                            TRNBANK,TRNTYPE,TRNCHEQ,TRNHOSP,TRNGSTC:
                            TRNGSTA,TRNBDDTE,TRNSPARE
         GOTO      OVERCOND IF OVER
         MOVE      DTRNCOUN,TRNCOUNT
         MOVE      DTRNAMNT,TRNAMNT
         MOVE      DTRNDISC,TRNDISC
         RETURN
.
WRTRNA2  RESET     KEY15
         MOVE      ZERO,OVRCD
         MOVE      TRNAMNT,DTRNAMNT
         MOVE      TRNDISC,DTRNDISC
         MOVE      TRNCOUNT,DTRNCOUN
         WRITE     RCPTRNA2,KEY15;TRNDATE,TRNCASHR,TRNRECNO,DTRNCOUN,TRNREG:
                                  TRNMODE,TRNSYS,TRNINV,TRNREF,TRNCARD:
                                  TRNPAYEE,TRNADD1,TRNADD2,TRNPOST,TRNPTYPE:
                                  TRNINACC,TRNBNKAC,DTRNAMNT,DTRNDISC,TRNSTAT:
                                  TRNBANK,TRNTYPE,TRNCHEQ,TRNHOSP,TRNGSTC:
                                  TRNGSTA,TRNBDDTE,TRNSPARE
.
         RETURN
.
.

. =========================================================================
.         I/O Includes
. =========================================================================
.
.
          INC       STD001IO
.
          INC       COMDEPIO/INC
          INC       RCPBNKIO/INC
          INC       RCPBDTIO/INC
          INC       RCPDTEIO/INC
          INC       PATINVIO/INC
          INC       PRIINVIO/INC
          INC       RCPREGIO/INC
          INC       PATVISIO/INC
          INC       WEBSECIO/INC
.
