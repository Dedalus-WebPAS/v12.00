.---------------------------------------------------------------------------
.   System    :   Accounts Payable System            
.   Include   :   APSISLKY
.   Routine   :   HAPISA00 Inventory System    
.   Return    :           
.-------------------------------------------------------------------------------
HAPISA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HAPISA04
          CALL      GSCRN000
          BRANCH    EXIT,HAPISA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Code"               
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 5",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "35",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Directory"          
.
          MOVE      STDCOL03,STDCOL04
          ADD       "30",STDCOL04
HAPISA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,APISISC 
          PACK      KEY1,APISISC,SP70                                           
.                                                                               
.                                                                               
          CALL      RSAPIS1 
HAPISA10
          CALL      RKAPIS1 
          BRANCH    OVRCD,HAPISA15
          PACK      KEY1,APISISC,SP70                                           
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HAPISA12
          CALL      HAPISA60
          BRANCH    OVRCD,HAPISA10
HAPISA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY1,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,APISISC 
          DISPLAY   *PSTDCOL02:STDROW,APISDES 
          DISPLAY   *PSTDCOL03:STDROW,APISDIR 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HAPISA10 IF NOT EQUAL
HAPISA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HAPISA20
          CALL      HSCRI000
          BRANCH    EXIT,HAPISA30,HAPISA35,HAPISA40,HAPISA45,HAPISA04:
                              HAPISA91,HAPISA50
          GOTO      HAPISA92
HAPISA30
          CALL      RKAPIS1 
          BRANCH    OVRCD,HAPISA85
          PACK      KEY1,APISISC,SP70                                           
.                                                                               
.                                                                               
          CALL      RPAPIS1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAPISA10
HAPISA35
          MOVE      ST1,KEY1 
          CALL      RDAPIS1 
          CALL      RPAPIS1 
          BRANCH    OVRCD,HAPISA85
          PACK      KEY1,APISISC,SP70                                           
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HAPISA36
          CALL      RPAPIS1 
          BRANCH    OVRCD,HAPISA37
          PACK      KEY1,APISISC,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HAPISA36 IF NOT EQUAL
HAPISA37
          MOVE      ZERO,XITEMNO
          GOTO      HAPISA10
HAPISA40
          MOVE      ST1,KEY1 
          CALL      RDAPIS1 
          CALL      RPAPIS1 
          BRANCH    OVRCD,HAPISA85
          PACK      KEY1,APISISC,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAPISA08
HAPISA45
          CALL      RKAPIS1 
          BRANCH    OVRCD,HAPISA85
          PACK      KEY1,APISISC,SP70                                           
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY1,Z70                                                    
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSAPIS1 
HAPISA46
          CALL      RPAPIS1 
          BRANCH    OVRCD,HAPISA47
          PACK      KEY1,APISISC,SP70                                           
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HAPISA46 IF NOT EQUAL
HAPISA47
          MOVE      ZERO,XITEMNO
          GOTO      HAPISA10
HAPISA50  COMPARE   ZERO,CSEARCH
          GOTO      HAPISA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAPISA08
HAPISA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAPISA08
HAPISA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HAPISA61 IF EQUAL
          MATCH     SCHFLD01,APISISC 
          GOTO      HAPISA72 IF NOT EQUAL
HAPISA61
          MATCH     SP70,SCHFLD02
          GOTO      HAPISA62 IF EQUAL
          MATCH     SCHFLD02,APISDES 
          GOTO      HAPISA72 IF NOT EQUAL
HAPISA62
          MATCH     SP70,SCHFLD03
          GOTO      HAPISA63 IF EQUAL
          MATCH     SCHFLD03,APISDIR 
          GOTO      HAPISA72 IF NOT EQUAL
HAPISA63
HAPISA64
HAPISA65
HAPISA66
HAPISA67
HAPISA68
HAPISA69
HAPISA70
          GOTO      HAPISA75
HAPISA72  MOVE      ONE,OVRCD
HAPISA75  RETURN
HAPISA85
          LOAD      KEY1,XITEMNO,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY1,APISISC                                                
          CALL      RDAPIS1 
HAPISA90
.                                                                               
          BEEP
          GOTO      HAPISA20
HAPISA91
          MOVE      SP70,APISDES 
          MOVE      SP70,APISDIR 
          MOVE      ZERO,APISTYP 
          MOVE      SP70,APISSPA 
          MOVE      SP70,KEY1 
          MOVE      SP70,APISISC 
          GOTO      HAPISA96
HAPISA92
          MOVE      SP70,KEY1 
          MOVE      SP70,APISISC 
          LOAD      KEY1,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY1,APISISC                                                
HAPISA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HAPISA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Accounts Payable System            
.   Include   :   APSISLKY
.   Routine   :   KAPISA00 Keyin Inventory System    
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KAPISA00 TOPIC     "APISISC "
          MOVE      UNDLN70,APISISC 
          KEYIN     *PCCOL:CVERT,*DV,APISISC:                                   
                    *PCCOL:CVERT,*V2LON,APISISC:                                
                    *PCCOL:CVERT,*DV,APISISC 
.
          ENDSET    APISISC 
          APPEND    SP70,APISISC 
          RESET     APISISC 
.
          MATCH     SP70,APISISC 
          GOTO      KAPISA90 IF EQUAL
.
          CMATCH    EXITCHAR,APISISC 
          GOTO      KAPISA95 IF EQUAL
.
          CMATCH    QUEST,APISISC 
          GOTO      KAPISA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HAPISA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    APISISC 
          APPEND    SP70,APISISC 
          RESET     APISISC 
.
          MATCH     SP70,APISISC 
          GOTO      KAPISA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,APISISC                                 
KAPISA10
          PACK      KEY1,APISISC                                                
          CALL      RAAPIS1 
          BRANCH    OVRCD,KAPISA80
          BRANCH    CKEYTYP,KAPISA75
          CALL      RDAPIS1 
KAPISA70
          MOVE      ZERO,EXIT
          GOTO      KAPISA99
KAPISA75
          MOVE      "Inventory System Already Exist - ",DISPMSG                                      
          CALL      MESSAGE1
          GOTO      KAPISA00
KAPISA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KAPISA99,KAPISA99
          MOVE      "Inventory System Does Not Exist - ",DISPMSG                                     
          CALL      MESSAGE1
          GOTO      KAPISA00
KAPISA90
          MOVE      ONE,EXIT
          GOTO      KAPISA99
KAPISA95
          MOVE      TWO,EXIT
KAPISA99 TOPIC    PRGID
          RETURN
.
.
.---------------------------------------------------------------------------
.   System    :   Accounts Payable System
.   Include   :   APSISLKY
.   Routine   :   KAPISZ00 Keyin Inventory System
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KAPISZ00 TOPIC     "APISISC "
          MOVE      UNDLN70,APISISC
          KEYIN     *PCCOL:CVERT,*DV,APISISC:
                    *PCCOL:CVERT,*V2LON,*+,APISISC:
                    *PCCOL:CVERT,*DV,APISISC
.
          ENDSET    APISISC
          APPEND    SP70,APISISC
          RESET     APISISC
.
          MATCH     SP70,APISISC
          GOTO      KAPISZ90 IF EQUAL
.
          CMATCH    EXITCHAR,APISISC
          GOTO      KAPISZ95 IF EQUAL
.
          CMATCH    QUEST,APISISC
          GOTO      KAPISZ10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HAPISA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    APISISC
          APPEND    SP70,APISISC
          RESET     APISISC
.
          MATCH     SP70,APISISC
          GOTO      KAPISZ00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,APISISC
KAPISZ10
          PACK      KEY1,APISISC
          CALL      RAAPIS1
          BRANCH    OVRCD,KAPISZ80
          BRANCH    CKEYTYP,KAPISZ75
          CALL      RDAPIS1
KAPISZ70
          MOVE      ZERO,EXIT
          GOTO      KAPISZ99
KAPISZ75
          MOVE      "Inventory System Already Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KAPISZ00
KAPISZ80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KAPISZ99,KAPISZ99
          MOVE      "Inventory System Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KAPISZ00
KAPISZ90
          MOVE      ONE,EXIT
          GOTO      KAPISZ99
KAPISZ95
          MOVE      TWO,EXIT
KAPISZ99 TOPIC    PRGID
          RETURN
.
.
