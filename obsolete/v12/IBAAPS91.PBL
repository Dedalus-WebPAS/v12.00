.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V10.07.01 08.12.2015  Steve Armstrong  CAR 324595
.           Replaced IHAPASFD with IBAPASFD
.-------------------------------------------------------
. V9.04.01  30/08/2005  Mike Laming   CAR 72257
.           Clear more FMSWASaf variables in "Add Item" - ADDITM00
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.01.01  06.01.2000 Sandra Barcham
.           Re-Added new description types lost in release change
.-------------------------------------------------------
. VF.00.01  23.11.1999 Sandra Barcham
.           Recompiled for FMSCCAFD
.           srf 646145
. VF.00.00  30.08.1999 B.G.Ackland
.           Ported
.-------------------------------------------------------
NAMFMWB1  INIT      "Wfmwb1"
FILFMWB1  DIM       8
.
INSERT    FORM      1
SAVSEQ    DIM       3
SAVLEDG   DIM       2
SAVACCT   DIM       12
SAVYR     FORM      4
SAVPR     FORM      2
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBAAPS91
.   Function      :   Web Page Security                       
.   Generated  On :   08/12/2015
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       FMSAMADF    
          INC       FMSAMAFD/INC
          INC       FMSCCAFD/INC
          INC       FMSCONFD/INC
          INC       FMSLMAFD/INC
          INC       FMSSBAFD/INC
          INC       FMSSQUFD/INC
          INC       FMSWASFD/INC
          INC       FMSWBCFD/INC
          INC       IBAPASFD/INC
.=========================
.Local Variable Definition
.-------------------------
.
.    Multi Item Key Fields Scr 01 Fld    10
.-------------------------------------------------------
FMWA1NAM  INIT      "FMWA1"
FMWA1END  FORM      1   * End Display
FMWA1SNO  FORM      5   * Number of Items on the Screen
FMWA1MKY  DIM       127 * Match Key 
FMWA1EKY  DIM       127 * End Key
FMWA1SKY  DIM       127 * Start Key
FMWA1IDX  INIT      " 132 UC1-5"
FMWA1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
FMWA1FNM  DIM       8  * Filename
FMWA1CNT  FORM      3  * Number of Items on Screen
ACCOUNTN  DIM      35 * Scr 01 Fld    13
DDTYDES   DIM      20 * Scr 02 Fld    11
.
.    Multi Item Key Fields Scr 03 Fld    10
.-------------------------------------------------------
FMWB1NAM  INIT      "FMWB1"
FMWB1END  FORM      1   * End Display
FMWB1SNO  FORM      5   * Number of Items on the Screen
FMWB1MKY  DIM       127 * Match Key 
FMWB1EKY  DIM       127 * End Key
FMWB1SKY  DIM       127 * Start Key
FMWB1IDX  INIT      " 132 UC1-5"
FMWB1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
FMWB1FNM  DIM       8  * Filename
FMWB1CNT  FORM      3  * Number of Items on Screen
FINYR     FORM      4 * Scr 04 Fld     5
FINPR     FORM      2 * Scr 04 Fld     6
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBAAPS91"
PRGNAM    INIT      "Web Page Security                       "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      REDCON00
          CALL      SC00L000
          CLOSE     FMWA1FL1,DELETE
.
          CLOSE     FMWB1FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILFMWB1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA1,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA2,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA3,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA4,"fmsamaaf"
          MOVE      "   51",AUDTSECT
          MOVE      " 46",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening fmsaudla";
            OPEN      FMSAUDLA,"fmsaudla"
          ENDIF
          DISPLAY   *P56:24,"Opening fmsccaaf";
          OPEN      FMSCCAA1,"fmsccaaf"
          DISPLAY   *P56:24,"Opening fmslmaaf";
          OPEN      FMSLMAA1,"fmslmaaf"
          DISPLAY   *P56:24,"Opening  fmssbaaf           ";
          OPEN      FMSSBAA1,"fmssbaaf"          
          DISPLAY   *P56:24,"Opening  fmssquaf           ";
          OPEN      FMSSQUA1,"fmssquaf"          
          DISPLAY   *P56:24,"Opening fmswasaf";
          OPEN      FMSWASA1,"fmswasaf"
          DISPLAY   *P56:24,"Opening fmswbcaf";
          OPEN      FMSWBCA1,"fmswbcaf"
          DISPLAY   *P56:24,"Opening  ihapassf           ";
          OPEN      IHAPASS1,"ihapassf"          
          DISPLAY   *P56:24,"Opening  ihapassf           ";
          OPEN      IHAPASS2,"ihapassf"          
          DISPLAY   *P56:24,"Opening  ihapassf           ";
          OPEN      IHAPASS3,"ihapassf"          
.--------------------------------------------------------
. Initialise Batch Screen Sequence Number                    
.--------------------------------------------------------
          MOVE     ZERO,FMWA1SNO
          MOVE     "01   10",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,FMWA1SNO
            ENDIF
          ENDIF
          PACK      FMWA1FNM,ANST,FMWA1NAM,PORT
          REP       " 0",FMWA1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      FMWA1FL1,FMWA1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     FMWA1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,FMWA1FNM,FMWA1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",FMWA1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      FMWA1FL1,FMWA1FNM
.--------------------------------------------------------
. Initialise Batch Screen Year                               
.--------------------------------------------------------
          MOVE     ZERO,FMWB1SNO
          MOVE     "03   10",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,FMWB1SNO
            ENDIF
          ENDIF
          PACK      FMWB1FNM,ANST,FMWB1NAM,PORT
          REP       " 0",FMWB1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      FMWB1FL1,FMWB1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     FMWB1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,FMWB1FNM,FMWB1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",FMWB1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      FMWB1FL1,FMWB1FNM
.--------------------------------------------------------
. Initialise Wp Filename for Comments                           
.--------------------------------------------------------
          PACK      FILFMWB1,NAMFMWB1,PORT
          REP       " 0",FILFMWB1
          DISPLAY   *P56:24,"Create & Open ",FILFMWB1;
          PREP      TEMPWORD,FILFMWB1
.
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Menu                               
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Edit Account List                  
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Account Details                    
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Edit User Based Comments           
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Edit Comments                      
          ENDIF
          RETURN
.--------------------------------
. Screen - Menu                               
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Menu                               
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Menu                               
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Menu                               
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Menu                               
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Menu                               
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Menu                               
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Menu                               
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      CONVT000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Edit Account List                  
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Edit Account List                  
.-------------------------------------------------------
CF01L000
          MOVE      SP70,SECODE  
          MOVE      SP70,SECUSER 
          MOVE      SP70,FMWASEQ 
          MOVE      SP70,FMWALEDG
          MOVE      SP70,FMWAACCT
          MOVE      SP70,ACCOUNTN
          MOVE      ZERO,FMWABLD 
          MOVE      ZERO,FMWADEC 
          MOVE      SP70,FMWABCK 
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Edit Account List                  
.--------------------------------------------------------
KY01L000
.
KY01L110
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SECUSER 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KIBPSA00
          BRANCH    EXIT,KY01L900,KY01L900
          MOVE      ZERO,ACCEPT
          MOVE      SECODE,VAR       
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SECUSER,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Edit Account List                  
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Edit Account List                  
.---------------------------------------------------------
LM01L000
.---------------------------------------------------------
. Load for :    10 Sequence Number                    
.---------------------------------------------------------
          UNPACK    SP70,FMWASEC,FMWASEQ,FMWALEDG,FMWAACCT
          PACK      KEY21,SECODE,SP70
          MOVE      KEY21,FMWA1EKY
          STRIP     FMWA1SKY
          SETLPTR   FMWA1EKY,4
          MOVE      FMWA1EKY,FMWA1SKY
          CALL      RDFMWA1 
          IF        OVRCD=0
            CALL      RPFMWA1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP01L000
          MOVE     ZERO,FMWA1CNT
          MOVE     ZERO,FMWA1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP01L600
          MATCH    PRGID,SCPSPID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP01L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP01L010,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L101,DP01L102,DP01L103:
                            DP01L104,DP01L105,DP01L106,DP01L107:
                            DP01L010,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L010
          GOTO      DP01L010
.
DP01L101
          PACK      FMWA1MKY,SP70,SP70
          CALL      UPTFMWA1
          IF        FMWA1END=0
            CALL      RKFMWA1 
            IF        OVRCD=0
              PACK      FMWA1MKY,FMWASEC,FMWASEQ,FMWALEDG,FMWAACCT                                              
              MATCH     FMWA1EKY,FMWA1MKY
              IF        @EQUAL
                MOVE      ZERO,FMWA1END
                ADD       ONE,FMWA1CNT
                CALL      UPTFMWA1
          CALL      GETACC00
                MOVE      FMWASEQ,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,FMWA1END
              ENDIF
            ELSE
              MOVE      ONE,FMWA1END
            ENDIF
          ENDIF
          IF        FMWA1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L102
          IF        FMWA1END=0
            MOVE      FMWALEDG,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L103
          IF        FMWA1END=0
            MOVE      FMWAACCT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L104
          IF        FMWA1END=0
            MOVE      ACCOUNTN,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L105
          IF        FMWA1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      FMWABLD,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L106
          IF        FMWA1END=0
            MOVE      FMWADEC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L107
          IF        FMWA1END=0
            MOVE      FMWABCK,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
DP01L600
          MATCH    "FMWA1",NAMSSFFI
          GOTO     DP01L605 IF NOT EQUAL
          GOTO     DP01L999
DP01L605
DP01L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP01L000
.
          MATCH    "FMWA1",NAMSSFFI
          GOTO     FP01L105 IF NOT EQUAL
          PACK     KEY21,FMWA1SKY,SP70
          CALL     RDFMWA1  * Start
          IF       OVRCD=0
            CALL     RPFMWA1  * Start
          ENDIF
          CALL     DP01L000
          GOTO     FP01L999
FP01L105
FP01L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP01L000
.
          MATCH    "FMWA1",NAMSSFFI
          GOTO     LP01L105 IF NOT EQUAL
          PACK     KEY21,FMWA1SKY,Z70
          CALL     RSFMWA1  * End
          IF       OVRCD=1
            CALL     RPFMWA1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<FMWA1SNO
            CALL     RPFMWA1 
            IF       OVRCD=1
              MOVE     FMWA1SNO,SECTOR
            ENDIF
            PACK     FMWA1MKY,FMWASEC,FMWASEQ,FMWALEDG,FMWAACCT                                              
            MATCH    FMWA1EKY,FMWA1MKY
            IF       !@EQUAL
              MOVE     FMWA1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     LP01L999
LP01L105
LP01L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP01L000
.
          MATCH    "FMWA1",NAMSSFFI
          GOTO     PP01L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP01L105
          CALL      RFTFMWA1
          BRANCH   OVRCD,PP01L115
          MOVE      FMWA1MKY,KEY21 
          CALL      RSFMWA1 
PP01L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=FMWA1SNO
            CALL     RPFMWA1 
            IF       OVRCD=1
              MOVE     FMWA1SNO,SECTOR
            ENDIF
            PACK     FMWA1MKY,FMWASEC,FMWASEQ,FMWALEDG,FMWAACCT                                              
            MATCH    FMWA1EKY,FMWA1MKY
            IF       !@EQUAL
              MOVE     FMWA1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     PP01L999
PP01L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<FMWA1SNO
            CALL     RKFMWA1 
            IF       OVRCD=1
              MOVE     FMWA1SNO,SECTOR
            ENDIF
            PACK     FMWA1MKY,FMWASEC,FMWASEQ,FMWALEDG,FMWAACCT                                              
            MATCH    FMWA1EKY,FMWA1MKY
            IF       !@EQUAL
              MOVE     FMWA1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP01L999
PP01L120
PP01L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP01L000
          MATCH    "FMWA1",NAMSSFFI
          GOTO     NP01L115 IF NOT EQUAL
NP01L105
          CALL     RKFMWA1 
          BRANCH   OVRCD,NP01L110
          PACK     FMWA1MKY,FMWASEC,FMWASEQ,FMWALEDG,FMWAACCT                                              
          MATCH    FMWA1EKY,FMWA1MKY
          GOTO     NP01L110 IF NOT EQUAL
          CALL     RPFMWA1 
          CALL     DP01L000
          GOTO     NP01L999
NP01L110
          CALL     RPFMWA1 
          BEEP
          GOTO     NP01L999
NP01L115
NP01L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT01L000
CT01L105
CT01L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Edit Account List                  
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    10 Sequence Number                    
.---------------------------------------------------------
UPTFMWA1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      FMWA1FL1,KEY5;ANS
          IF        @OVER
            WRITE     FMWA1FL1,KEY5;SCPSROW,SCPSCOL,FMWA1MKY
          ELSE
            UPDATE    FMWA1FL1;SCPSROW,SCPSCOL,FMWA1MKY
          ENDIF
          RETURN
RDTFMWA1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      FMWA1FL1,KEY5;SCPSROW,SCPSCOL,FMWA1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTFMWA1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      FMWA1FL1,KEY5;;
          READKS    FMWA1FL1;SCPSROW,SCPSCOL,FMWA1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,FMWA1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Edit Account List                  
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
          MOVE      "FMWA1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP01L000
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Edit Account List                  
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L101,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999
          GOTO     PS01L999
.
PS01L101
          MOVE      SECUSER,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Edit Account List                  
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L006:
                           SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L103,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L104,SF01L105,SF01L006,SF01L006:
                           SF01L106,SF01L107
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L103,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          MOVE      "FMWA1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      ADDITM00
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF01L000
          GOTO      SF01L001
.
SF01L103
          CALL      SELECTED
          BRANCH    EXIT,SF01L001
          COMPARE   ONE,ACCEPT
          GOTO      SF01L001 IF EQUAL
          CALL      RDTFMWA1
          IF        OVRCD=1
            BEEP
            GOTO      SF01L001
          ENDIF
          MATCH     SP70,FMWA1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF01L001
          ENDIF
          MOVE      FMWA1MKY,KEY21 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELITM00
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTFMWA1
          IF        OVRCD=1
            CALL      FP01L000
          ELSE
            MOVE      FMWA1MKY,KEY21 
            CALL      RSFMWA1 
            CALL      RPFMWA1 
            CALL      DP01L000
          ENDIF
          GOTO     SF01L001
.
SF01L104
          MOVE      "FMWA1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      NP01L000
          GOTO     SF01L001
.
SF01L105
          MOVE      "FMWA1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      PP01L000
          GOTO     SF01L001
.
SF01L106
          MOVE      "FMWA1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L107
          MOVE      "FMWA1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      LP01L000
          GOTO     SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Account Details                    
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Account Details                    
.-------------------------------------------------------
CF02L000
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Account Details                    
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Account Details                    
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Account Details                    
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Account Details                    
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Account Details                    
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L101,PS02L102,PS02L103,PS02L104:
                            PS02L105,PS02L106,PS02L107,PS02L108:
                            PS02L109,PS02L110,PS02L111,PS02L112:
                            PS02L113,PS02L114,PS02L115,PS02L116:
                            PS02L117
          GOTO     PS02L999
.
PS02L101
          MOVE      FMWASEQ,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      FMWADTY,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      FMWADIV,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      FMWADEC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      FMWABLD,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      FMWABCK,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      DDTYDES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      FMWALEDG,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          MOVE      FMWAACCT,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          MOVE      FMAMDESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      FMWACHD,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L112
          MOVE      FMWATMP,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L113
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      FMWANEG,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L114
          MOVE      FMWALPC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L115
          MOVE      FMWAREP,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L116
          MOVE      FMWAPRG,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L117
          MOVE      FMWAURL,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Account Details                    
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102,SF02L103:
                            SF02L104,SF02L105,SF02L106,SF02L107:
                            SF02L108,SF02L109,SF02L006,SF02L110:
                            SF02L006,SF02L006,SF02L111,SF02L112:
                            SF02L113,SF02L114,SF02L115,SF02L116:
                            SF02L117
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L104,SF02L105,SF02L106,SF02L107:
                            SF02L108,SF02L109,SF02L020,SF02L110:
                            SF02L020,SF02L020,SF02L111,SF02L112:
                            SF02L113,SF02L114,SF02L115,SF02L116:
                            SF02L117
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L102
          CALL      POST0000
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF02L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF02L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF02L999
          ENDIF
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF02L000
          ENDIF
          GOTO      SF02L001
.
SF02L104
          CALL     SELECTED
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,*JR,*ZF,FMWASEQ: 
                    *PCCOL:CVERT
          ENDSET    FMWASEQ 
          CMATCH    EXITCHAR,FMWASEQ 
          GOTO      SF02L990 IF EQUAL
          RESET     FMWASEQ 
          IF        SCPSMAN=1
            MATCH     SP70,FMWASEQ 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L104
            ENDIF
          ENDIF
          MOVE      FMWASEQ,VAR      
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L105
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DDTYDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KDTY0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L105
            ENDIF
            BRANCH    EXIT,SF02L105,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      FMWADTY,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DDTYDES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L106
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,FMWADIV 
          IF        SCPSMAN=1
            COMPARE   ZERO,FMWADIV 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L106
            ENDIF
          ENDIF
          MOVE      FMWADIV,VAR      
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L107
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,FMWADEC 
          IF        SCPSMAN=1
            COMPARE   ZERO,FMWADEC 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L107
            ENDIF
          ENDIF
          MOVE      FMWADEC,VAR      
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L108
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,FMWABLD 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      FMWABLD,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L109
          CALL     SELECTED
          STRIP     FMWABCK 
          SFORMAT   VAR,SCPSLEN
          MOVE      FMWABCK,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,FMWABCK 
          SFORMAT   VAR,127
          ENDSET    FMWABCK 
          APPEND    SP70,FMWABCK 
          RESET     FMWABCK 
          CMATCH    EXITCHAR,FMWABCK 
          GOTO      SF02L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,FMWABCK 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L109
            ENDIF
          ENDIF
          MOVE      FMWABCK,VAR      
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L110
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FMWAACCT
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FMAMDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KLACC000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L110
            ENDIF
            BRANCH    EXIT,SF02L110,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      FMWALEDG,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMWAACCT,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMAMDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L111
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,FMWACHD 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      FMWACHD,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L112
          CALL     SELECTED
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,*JR,*ZF,FMWATMP: 
                    *PCCOL:CVERT
          ENDSET    FMWATMP 
          CMATCH    EXITCHAR,FMWATMP 
          GOTO      SF02L990 IF EQUAL
          RESET     FMWATMP 
          IF        SCPSMAN=1
            MATCH     SP70,FMWATMP 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L112
            ENDIF
          ENDIF
          MOVE      FMWATMP,VAR      
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L113
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,FMWANEG 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      FMWANEG,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L114
          CALL     SELECTED
          STRIP     FMWALPC 
          SFORMAT   VAR,SCPSLEN
          MOVE      FMWALPC,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,FMWALPC 
          SFORMAT   VAR,127
          ENDSET    FMWALPC 
          APPEND    SP70,FMWALPC 
          RESET     FMWALPC 
          CMATCH    EXITCHAR,FMWALPC 
          GOTO      SF02L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,FMWALPC 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L114
            ENDIF
          ENDIF
          MOVE      FMWALPC,VAR      
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L115
          CALL     SELECTED
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,*JR,*ZF,FMWAREP: 
                    *PCCOL:CVERT
          ENDSET    FMWAREP 
          CMATCH    EXITCHAR,FMWAREP 
          GOTO      SF02L990 IF EQUAL
          RESET     FMWAREP 
          IF        SCPSMAN=1
            MATCH     SP70,FMWAREP 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L115
            ENDIF
          ENDIF
          MOVE      FMWAREP,VAR      
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L116
          CALL     SELECTED
          STRIP     FMWAPRG 
          SFORMAT   VAR,SCPSLEN
          MOVE      FMWAPRG,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,FMWAPRG 
          SFORMAT   VAR,127
          ENDSET    FMWAPRG 
          APPEND    SP70,FMWAPRG 
          RESET     FMWAPRG 
          CMATCH    EXITCHAR,FMWAPRG 
          GOTO      SF02L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,FMWAPRG 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L116
            ENDIF
          ENDIF
          MOVE      FMWAPRG,VAR      
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L117
          CALL     SELECTED
          STRIP     FMWAURL 
          SFORMAT   VAR,SCPSLEN
          MOVE      FMWAURL,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,FMWAURL 
          SFORMAT   VAR,127
          ENDSET    FMWAURL 
          APPEND    SP70,FMWAURL 
          RESET     FMWAURL 
          CMATCH    EXITCHAR,FMWAURL 
          GOTO      SF02L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,FMWAURL 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L117
            ENDIF
          ENDIF
          MOVE      FMWAURL,VAR      
          CALL      DISPITEM
          GOTO     SF02L001
SF02L990  MOVE      FOUR,EXIT * Exit Char Exit
SF02L999  RETURN
.--------------------------------
. Screen - Edit User Based Comments           
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Edit User Based Comments           
.-------------------------------------------------------
CF03L000
          MOVE      SP70,SECODE  
          MOVE      SP70,SECUSER 
          MOVE      SP70,FMWBYR  
          MOVE      SP70,FMWBPR  
          MOVE      SP70,FMWBLIN 
          MOVE      SP70,FMWBCOM 
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Edit User Based Comments           
.--------------------------------------------------------
KY03L000
.
KY03L110
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KIBPSA00
          BRANCH    EXIT,KY03L900,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      SECODE,VAR       
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Edit User Based Comments           
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Edit User Based Comments           
.---------------------------------------------------------
LM03L000
.---------------------------------------------------------
. Load for :    10 Year                               
.---------------------------------------------------------
          UNPACK    SP70,FMWBUID,FMWBYR,FMWBPR,FMWBLIN
          PACK      KEY13,SECODE,SP70
          MOVE      KEY13,FMWB1EKY
          STRIP     FMWB1SKY
          SETLPTR   FMWB1EKY,4
          MOVE      FMWB1EKY,FMWB1SKY
          CALL      RDFMWB1 
          IF        OVRCD=0
            CALL      RPFMWB1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP03L000
          MOVE     ZERO,FMWB1CNT
          MOVE     ZERO,FMWB1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP03L600
          MATCH    PRGID,SCPSPID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP03L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                           DP03L010,DP03L101,DP03L102,DP03L103:
                            DP03L104,DP03L010,DP03L010,DP03L010:
                           DP03L010,DP03L010,DP03L010,DP03L010:
                           DP03L010,DP03L010,DP03L010,DP03L010:
                           DP03L010,DP03L010
          GOTO      DP03L010
.
DP03L101
          PACK      FMWB1MKY,SP70,SP70
          CALL      UPTFMWB1
          IF        FMWB1END=0
            CALL      RKFMWB1 
            IF        OVRCD=0
              PACK      FMWB1MKY,FMWBUID,FMWBYR,FMWBPR,FMWBLIN                                                  
              MATCH     FMWB1EKY,FMWB1MKY
              IF        @EQUAL
                MOVE      ZERO,FMWB1END
                ADD       ONE,FMWB1CNT
                CALL      UPTFMWB1
                MOVE      FMWBYR,VAR       
                CALL      DISPITEM
              ELSE
                MOVE      ONE,FMWB1END
              ENDIF
            ELSE
              MOVE      ONE,FMWB1END
            ENDIF
          ENDIF
          IF        FMWB1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L102
          IF        FMWB1END=0
            MOVE      FMWBPR,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L103
          IF        FMWB1END=0
            MOVE      FMWBLIN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L104
          IF        FMWB1END=0
            MOVE      FMWBCOM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
DP03L600
          MATCH    "FMWB1",NAMSSFFI
          GOTO     DP03L605 IF NOT EQUAL
          GOTO     DP03L999
DP03L605
DP03L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP03L000
.
          MATCH    "FMWB1",NAMSSFFI
          GOTO     FP03L105 IF NOT EQUAL
          PACK     KEY13,FMWB1SKY,SP70
          CALL     RDFMWB1  * Start
          IF       OVRCD=0
            CALL     RPFMWB1  * Start
          ENDIF
          CALL     DP03L000
          GOTO     FP03L999
FP03L105
FP03L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP03L000
.
          MATCH    "FMWB1",NAMSSFFI
          GOTO     LP03L105 IF NOT EQUAL
          PACK     KEY13,FMWB1SKY,Z70
          CALL     RSFMWB1  * End
          IF       OVRCD=1
            CALL     RPFMWB1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<FMWB1SNO
            CALL     RPFMWB1 
            IF       OVRCD=1
              MOVE     FMWB1SNO,SECTOR
            ENDIF
            PACK     FMWB1MKY,FMWBUID,FMWBYR,FMWBPR,FMWBLIN                                                  
            MATCH    FMWB1EKY,FMWB1MKY
            IF       !@EQUAL
              MOVE     FMWB1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     LP03L999
LP03L105
LP03L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP03L000
.
          MATCH    "FMWB1",NAMSSFFI
          GOTO     PP03L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP03L105
          CALL      RFTFMWB1
          BRANCH   OVRCD,PP03L115
          MOVE      FMWB1MKY,KEY13 
          CALL      RSFMWB1 
PP03L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=FMWB1SNO
            CALL     RPFMWB1 
            IF       OVRCD=1
              MOVE     FMWB1SNO,SECTOR
            ENDIF
            PACK     FMWB1MKY,FMWBUID,FMWBYR,FMWBPR,FMWBLIN                                                  
            MATCH    FMWB1EKY,FMWB1MKY
            IF       !@EQUAL
              MOVE     FMWB1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     PP03L999
PP03L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<FMWB1SNO
            CALL     RKFMWB1 
            IF       OVRCD=1
              MOVE     FMWB1SNO,SECTOR
            ENDIF
            PACK     FMWB1MKY,FMWBUID,FMWBYR,FMWBPR,FMWBLIN                                                  
            MATCH    FMWB1EKY,FMWB1MKY
            IF       !@EQUAL
              MOVE     FMWB1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP03L999
PP03L120
PP03L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP03L000
          MATCH    "FMWB1",NAMSSFFI
          GOTO     NP03L115 IF NOT EQUAL
NP03L105
          CALL     RKFMWB1 
          BRANCH   OVRCD,NP03L110
          PACK     FMWB1MKY,FMWBUID,FMWBYR,FMWBPR,FMWBLIN                                                  
          MATCH    FMWB1EKY,FMWB1MKY
          GOTO     NP03L110 IF NOT EQUAL
          CALL     RPFMWB1 
          CALL     DP03L000
          GOTO     NP03L999
NP03L110
          CALL     RPFMWB1 
          BEEP
          GOTO     NP03L999
NP03L115
NP03L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT03L000
CT03L105
CT03L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Edit User Based Comments           
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    10 Year                               
.---------------------------------------------------------
UPTFMWB1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      FMWB1FL1,KEY5;ANS
          IF        @OVER
            WRITE     FMWB1FL1,KEY5;SCPSROW,SCPSCOL,FMWB1MKY
          ELSE
            UPDATE    FMWB1FL1;SCPSROW,SCPSCOL,FMWB1MKY
          ENDIF
          RETURN
RDTFMWB1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      FMWB1FL1,KEY5;SCPSROW,SCPSCOL,FMWB1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTFMWB1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      FMWB1FL1,KEY5;;
          READKS    FMWB1FL1;SCPSROW,SCPSCOL,FMWB1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,FMWB1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Edit User Based Comments           
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
          MOVE      "FMWB1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP03L000
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Edit User Based Comments           
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L101,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999
          GOTO     PS03L999
.
PS03L101
          MOVE      SECUSER,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Edit User Based Comments           
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L103,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L104,SF03L105,SF03L006,SF03L006:
                           SF03L106,SF03L107
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L103,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          MOVE      "FMWB1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      ADDCOM00
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF03L000
          GOTO      SF03L001
.
SF03L103
          CALL      SELECTED
          BRANCH    EXIT,SF03L001
          COMPARE   ONE,ACCEPT
          GOTO      SF03L001 IF EQUAL
          CALL      RDTFMWB1
          IF        OVRCD=1
            BEEP
            GOTO      SF03L001
          ENDIF
          MATCH     SP70,FMWB1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF03L001
          ENDIF
          MOVE      FMWB1MKY,KEY13 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELCOM00
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTFMWB1
          IF        OVRCD=1
            CALL      FP03L000
          ELSE
            MOVE      FMWB1MKY,KEY13 
            CALL      RSFMWB1 
            CALL      RPFMWB1 
            CALL      DP03L000
          ENDIF
          GOTO     SF03L001
.
SF03L104
          MOVE      "FMWB1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      NP03L000
          GOTO     SF03L001
.
SF03L105
          MOVE      "FMWB1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      PP03L000
          GOTO     SF03L001
.
SF03L106
          MOVE      "FMWB1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L107
          MOVE      "FMWB1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      LP03L000
          GOTO     SF03L001
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Edit Comments                      
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Edit Comments                      
.-------------------------------------------------------
CF04L000
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Edit Comments                      
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Edit Comments                      
.---------------------------------------------------------
WP04L000
          PREP     TEMPWORD,FILFMWB1
          PACK     KEY13,SECODE,FINYR,FINPR,SP70
          MOVE     KEY13,SAVKEY80
          SETLPTR  SAVKEY80,10
          CALL      RDFMWB1 
          IF        OVRCD=0
            CALL      RPFMWB1 
          ENDIF
WP04L100
          CALL     RKFMWB1 
          BRANCH   OVRCD,WP04L105
          PACK     KEY13,FMWBUID,FMWBYR,FMWBPR,FMWBLIN
          MATCH    SAVKEY80,KEY13   
          GOTO     WP04L105 IF NOT EQUAL
          PACK     VAR,FMWBCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     FMWBCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP04L100
WP04L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Edit Comments                      
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Edit Comments                      
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Edit Comments                      
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L101,PS04L102,PS04L103
          GOTO     PS04L999
.
PS04L101
          MOVE      FINYR,VAR        
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      FINPR,VAR        
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE     FILFMWB1,WORDNAME
          CALL     DISPWORD
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Edit Comments                      
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L102,SF04L103:
                            SF04L104,SF04L105,SF04L106
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L104,SF04L105,SF04L106
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L102
          CALL      PCOMM000
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DCOMM000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF04L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF04L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF04L999
          ENDIF
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF04L000
          ENDIF
          GOTO      SF04L001
.
SF04L104
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,FINYR   
          IF        SCPSMAN=1
            COMPARE   ZERO,FINYR   
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L104
            ENDIF
          ENDIF
          MOVE      FINYR,VAR        
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L105
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,FINPR   
          IF        SCPSMAN=1
            COMPARE   ZERO,FINPR   
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L105
            ENDIF
          ENDIF
          MOVE      FINPR,VAR        
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L106
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "10",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 60",SCPSLEN
              MOVE     " 8",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILFMWB1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILFMWB1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          GOTO     SF04L001
SF04L990  MOVE      ONE,EXIT * Exit Char Restart
SF04L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------
. Read Control File
.------------------------------------------------------------
REDCON00   CALL     RDFMCO50
           CALL     RDFMCO51
           CALL     RDFMCO52
           CALL     RDFMCO65
REDCON99   RETURN
.------------------------------------------------------------
. Convert Old Security Allocation
.------------------------------------------------------------
CONVT000  PACK      KEY21,SP70
          CALL      RSFMSQ1
CONVT100  CALL      RKFMSQ1
          BRANCH    OVRCD,CONVT999
          MOVE      FMSQSEC,FMWASEC
          MOVE      FMSQLEDG,FMWALEDG
          MOVE      FMSQACCT,FMWAACCT
          MOVE      FMSQSEQ,FMWASEQ
          MOVE      ZERO,FMWADEC
          MOVE      ZERO,FMWADTY
          MOVE      ONE,FMWADIV
          MOVE      ZERO,FMWABLD
          MOVE      "001",FMWATMP
          MOVE      SP70,FMWABCK
          MOVE      SP70,FMWASPA
          PACK      KEY14,FMSQLEDG,FMSQACCT
          CALL      RDFMAM1
          BRANCH    OVRCD,CONVT100
          MOVE      FMAMTYPE,F1
          IF        F1<6
            GOTO      CONVT100
          ENDIF
          IF        F1>7
            MOVE      FMAMDPLA,FMWADEC
          ENDIF
          IF        F1=7
            MOVE      ONE,FMWABLD
          ENDIF
          PACK      KEY21,FMWASEC,FMWASEQ,FMWALEDG,FMWAACCT
          CALL      RDFMWA1
          IF        OVRCD=1
            CALL      WRFMWA1
          ENDIF
          GOTO      CONVT100
.
CONVT999  RETURN
.------------------------------------------------------------
. Get Account
.------------------------------------------------------------
GETACC00  PACK      KEY14,FMWALEDG,FMWAACCT
          CALL      RDFMAM1
          BRANCH    OVRCD,GETACC99
          MOVE      FMAMDESC,ACCOUNTN
          COMPARE   ZERO,FMWADTY
          GOTO      GETACC99 IF EQUAL
.
          MOVE      FMSUUD4A,F2
          ADD       FMSUUD2A,F2
          ADD       ONE,F2
          RESET     FMAMACCT,F2
          PACK      KEY14,FMAMLEDG,FMAMACCT
          CALL      RDFMSA1
          RESET     FMAMACCT
          STORE     FMAMACCT,FMSUUD4A,KEY1,KEY2,KEY3,KEY4,KEY5,KEY6:
                                      KEY7,KEY8,KEY9,KEY10,KEY11,KEY12
          LOAD      FMCCCOCE,FMSUUD4A,KEY1,KEY2,KEY3,KEY4,KEY5,KEY6:
                                     KEY7,KEY8,KEY9,KEY10,KEY11,KEY12
          PACK      KEY14,FMAMLEDG,FMCCCOCE,SP70
          CALL      RDFMCC1
          BRANCH    FMWADTY,GETACC10,GETACC20
          GOTO      GETACC99
.
GETACC10  MOVE      FMSADESC,ACCOUNTN
          GOTO      GETACC99
.
GETACC20  MOVE      FMCCDESC,ACCOUNTN
          GOTO      GETACC99
.
GETACC99  RETURN
.
.------------------------------------------------------------
. Select Item
.------------------------------------------------------------
ADDITM00  MOVE    ONE,INSERT
          MOVE    SP70,SAVSEQ
          MOVE    SP70,SAVLEDG
          MOVE    SP70,SAVACCT
          MOVE    ONE,ACCEPT
          MOVE    SP70,DDTYDES
          MOVE    SP70,FMAMDESC
          MOVE    SECODE,FMWASEC
          MOVE    SP70,FMWALEDG
          MOVE    SP70,FMWAACCT
          MOVE    SP70,FMWASEQ
          MOVE    ZERO,FMWADTY
          MOVE    ONE,FMWADIV
          MOVE    ZERO,FMWADEC
          MOVE    ZERO,FMWABLD
          MOVE    SP70,FMWABCK
.
          MOVE    SP70,FMWALPC                                         *I-72257
          MOVE    SP70,FMWAPRG                                         *I-72257
          MOVE    SP70,FMWAREP                                         *I-72257
          MOVE    SP70,FMWAURL                                         *I-72257
.
          MOVE    SP70,FMWASPA
.
          CALL    SC02L000
.
ADDITM99  RETURN
.
.------------------------------------------------------------
. Select Item
.------------------------------------------------------------
SELITM00  MOVE    ZERO,INSERT
          CALL    RDFMWA1
          PACK    KEY14,FMWALEDG,FMWAACCT
          CALL    RDFMAM1
          MOVE    FMWASEQ,SAVSEQ
          MOVE    FMWALEDG,SAVLEDG
          MOVE    FMWAACCT,SAVACCT
.
          BRANCH  FMWADTY,SELITM10,SELITM20,SELITM30,SELITM40,SELITM50
          MOVE    "Posting Account",DDTYDES
          GOTO    SELITM80
.
SELITM10  MOVE    "Subjective",DDTYDES
          GOTO    SELITM80
.
SELITM20  MOVE    "Cost Centre",DDTYDES
          GOTO    SELITM80
.
SELITM30  MOVE    "Posting Code & Desc",DDTYDES
          GOTO    SELITM80
.
SELITM40  MOVE    "Subjective Code & Desc",DDTYDES
          GOTO    SELITM80
.
SELITM50  MOVE    "Cost Centre Code & Desc",DDTYDES
          GOTO    SELITM80
.
SELITM80  CALL    SC02L000
.
SELITM99  RETURN
.
DEFAULTN    MOVE     ANSN,DEFYESNO
            RETURN
.------------------------------------------------------------
. Post Details
.------------------------------------------------------------
POST0000   IF       INSERT=1
             MOVE     FMWASEQ,SAVSEQ
             MOVE     FMWALEDG,SAVLEDG
             MOVE     FMWAACCT,SAVACCT
           ENDIF
.
           PACK     KEY21,FMWASEC,SAVSEQ,SAVLEDG,SAVACCT
           CALL     RAFMWA1
           IF       OVRCD=0
             CALL     UPFMWA1
           ELSE
             CALL     WRFMWA1
           ENDIF
.
POST9999   RETURN
.
.-------------------------------------------------------------
. File : /users/bga/std/auditdel
.-------------------------------------------------------------
DELT0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DELT1000,DELT9000,DELT9100
.
DELT1000  IF       INSERT=1
            MOVE     FMWASEQ,SAVSEQ
            MOVE     FMWALEDG,SAVLEDG
            MOVE     FMWAACCT,SAVACCT
          ENDIF
          PACK     KEY21,FMWASEC,SAVSEQ,SAVLEDG,SAVACCT
          CALL     RAFMWA1             * Read Record
          IF       OVRCD=0
            CALL     DEFMWA1           * Delete Record
          ENDIF
          MOVE     ZERO,EXIT            * Restart Screen
          GOTO     DELT9999
DELT9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DELT9999
DELT9100  MOVE     ZERO,EXIT            * Restart Screen on "Cancel"
          GOTO     DELT9999
DELT9999  RETURN
.----------------------------------------------------------------------
. Enter Description Type
.----------------------------------------------------------------------
KDTY0000   CALL      DDTY0000
           MOVE      ZERO,FMWADTY
KDTY0001   KEYIN     *PCCOL:CVERT,*V2LON,*RV,FMWADTY
           COMPARE   ZERO,FMWADTY
           GOTO      KDTY0900 IF EQUAL
           BRANCH    FMWADTY,KDTY0010,KDTY0020,KDTY0030,KDTY0040,KDTY0050
           BEEP
           GOTO      KDTY0001
.
KDTY0010   MOVE      "Subjective",DDTYDES
           GOTO      KDTY0999
.
KDTY0020   MOVE      "Cost Centre",DDTYDES
           GOTO      KDTY0999
.
KDTY0030   MOVE      "Posting Code & Desc",DDTYDES
           GOTO      KDTY0999
.
KDTY0040   MOVE      "Subjective Code & Desc",DDTYDES
           GOTO      KDTY0999
.
KDTY0050   MOVE      "Cost Centre Code & Desc",DDTYDES
           GOTO      KDTY0999
.
KDTY0900   MOVE      "Posting Account",DDTYDES
           GOTO      KDTY0999
.
KDTY0999   CALL      PUTSCR00
           RETURN
.------------------------------------------------------------
. Display Options
.------------------------------------------------------------
DDTY0000  MOVE      "13",HTOP
          MOVE      "40",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P45:14,*V2LON,*ULON,"Description Format",*HOFF:
                    *P42:15,*V2LON,"0. ",*HOFF,"Posting Account":
                    *P42:16,*V2LON,"1. ",*HOFF,"Subjective":
                    *P42:17,*V2LON,"2. ",*HOFF,"Cost Centre":
                    *P42:18,*V2LON,"3. ",*HOFF,"Posting Account Code & Desc":
                    *P42:19,*V2LON,"4. ",*HOFF,"Subjective Code & Desc":
                    *P42:20,*V2LON,"5. ",*HOFF,"Cost Centre Code & Desc"
          RETURN
.
.-------------------------------------------------------------
. Enter Ledger/Account
.-------------------------------------------------------------
KLACC000  MOVE     "   12",FLDID
          CALL     GETPOSIT
          MOVE     ZERO,CKEYTYP
          CALL     KFMLAA00
          BRANCH   EXIT,KLACC999,KLACC999
          MOVE     FMLALEDG,FMAMLEDG
          MOVE     FMLALEDG,FMWALEDG
.
KLACC100  MOVE     "0",CACCTIND
          MOVE     "   13",FLDID
          CALL     GETPOSIT
          MOVE     ZERO,CKEYTYP
          CALL     KFMAMA00
          BRANCH   EXIT,KLACC000,KLACC999
          MOVE     FMAMACCT,FMWAACCT
.
KLACC999  MOVE     "   12",FLDID
          CALL     GETPOSIT
          RETURN
.
.------------------------------------------------------------
. Add Comments
.------------------------------------------------------------
ADDCOM00  MOVE      ONE,ACCEPT
          MOVE      ONE,INSERT
          CALL      SC04L000
ADDCOM99  RETURN
.------------------------------------------------------------
. Select Item
.------------------------------------------------------------
SELCOM00  MOVE    ZERO,INSERT
          CALL    RDFMWB1
          MOVE    FMWBYR,FINYR
          MOVE    FMWBPR,FINPR
          MOVE    FMWBYR,SAVYR
          MOVE    FMWBPR,SAVPR
.
          CALL    SC04L000
.
SELCOM99  RETURN
.
.------------------------------------------------------------
. Post Comment Details
.------------------------------------------------------------
PCOMM000  IF        INSERT=1
            MOVE      FINYR,SAVYR
            MOVE      FINPR,SAVPR
          ENDIF
          PACK      KEY10,SECODE,SAVYR,SAVPR,SP70
          PACK      KEY13,SECODE,SAVYR,SAVPR,SP70
          CALL      RSFMWB1
PCOMM100  CALL      RKFMWB1
          BRANCH    OVRCD,PCOMM190
          PACK      KEY13,FMWBUID,FMWBYR,FMWBPR,FMWBLIN
          MATCH     KEY10,KEY13
          GOTO      PCOMM190 IF NOT EQUAL
          CALL      DEFMWB1
          GOTO      PCOMM100
.
PCOMM190  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILFMWB1
          TRAPCLR   IO
          BRANCH    OVRCD,PCOMM900
          PACK      KEY10,SECODE,FINYR,FINPR
          MOVE      ZERO,F3
PCOMM200  READ      TEMPWORD,SEQ;FMWBCOM
          GOTO      PCOMM900 IF OVER
          MOVE      F3,FMWBLIN
          PACK      KEY13,KEY10,FMWBLIN
          UNPACK    KEY13,FMWBUID,FMWBYR,FMWBPR,FMWBLIN
          CALL      WRFMWB1
          ADD       ONE,F3
          GOTO      PCOMM200
.
PCOMM900  RETURN
.-------------------------------------------------------------
. File : /users/bga/std/auditdel
.
. Audit & Locking Standard Routine to Delete Record.
.
. where   xx = Key Length
.         ss = System 2 Character Code
.         ff = File 2 Character Code
.       yyyy = Key Field IDs
.-------------------------------------------------------------
DCOMM000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DCOMM100,DCOMM900,DCOMM910
.
DCOMM100  IF        INSERT=1
            MOVE      FINYR,SAVYR
            MOVE      FINPR,SAVPR
          ENDIF
          PACK      KEY10,SECODE,SAVYR,SAVPR,SP70
          PACK      KEY13,SECODE,SAVYR,SAVPR,SP70
          CALL      RSFMWB1
DCOMM110  CALL      RKFMWB1
          BRANCH    OVRCD,DCOMM190
          PACK      KEY13,FMWBUID,FMWBYR,FMWBPR,FMWBLIN
          MATCH     KEY10,KEY13
          GOTO      DCOMM190 IF NOT EQUAL
          CALL      DEFMWB1
          GOTO      DCOMM100
.
DCOMM190  MOVE     ZERO,EXIT            * Restart Screen
          GOTO     DCOMM999
DCOMM900  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DCOMM999
DCOMM910  MOVE     ZERO,EXIT            * Restart Screen on "Cancel"
          GOTO     DCOMM999
DCOMM999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       FMSAMAIO/INC
          INC       FMSAMAKY    
          INC       FMSCCAIO/INC
          INC       FMSCONIO/INC
          INC       FMSLMAIO/INC
          INC       FMSLMAKY    
          INC       FMSSBAIO/INC
          INC       FMSSQUIO/INC
          INC       FMSWASIO/INC
          INC       FMSWBCIO/INC
          INC       IBAPASIO/INC
          INC       IBAPASKY    
.
          INC       STDGENCD
.
