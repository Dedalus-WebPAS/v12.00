.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.03.01  29.06.2004  Sandra Barcham     50674
.           Removed Table PATTCOFD & PATTCOIO
.-------------------------------------------------------
. V9.02.01  09.07.2002  Glenn Saunders
.           Recompile for changes in includes shared with Southland, but with
.           previously different formats - now merged.  Includes effected :-
.           CCSCEAFD, CCSCONFD, CCSEPSFD, CCSHCDFD, CCSHLCFD, CCSIADFD
.-------------------------------------------------------
. V9.02.00  03.06.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.           Remove all PSN PAS clone includes.
.-------------------------------------------------------
. V5.07.01  14.12.1999 Charles Handaya
.           Fixed DRG Codes
.-------------------------------------------------------
. V6.03.01  02.10.1995 B.G.Ackland
.           Upgrade to Release 5.03
. V6.03.00  02.10.1995 B.G.Ackland
.           Release 6.03
. V6.01.02  28.09.1995 B.G.Ackland
.           Fixed Copy Option to Post First
. V6.01.01  13.07.1995 B.G.Ackland
.           Added DRG Cost Variation Maintenance
.-------------------------------------------------------
COPYALL   FORM      1
ENDCOD    DIM       3
ENDWRD    DIM       3      3        4     Ward  End
FROMWRD   DIM       3      3        4     Ward  Copy From
STRCOD    DIM       3
STRWRD    DIM       3      3        4     Ward  Start
TOWRD     DIM       3      3        4     Ward  Copy To
.
SAVESPC   DIM       3
SAVEATY   DIM       3      3        1     Admission Type (Cat A )
SAVEWRD   DIM       3      3        4     Ward
SAVEFC1   FORM      6.4    6        7     Factor Cost 1
SAVEFC2   FORM      6.4    6        13    Factor Cost 2
SAVEFC3   FORM      6.4    6        19    Factor Cost 3
SAVEFC4   FORM      6.4    6        25    Factor Cost 4
SAVEFC5   FORM      6.4    6        31    Factor Cost 5
SAVESPA   DIM       20     20       37    Spare
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACEA14
.   Function      :   Bed Time Patient Service Mapping        
.   Generated  On :   29/06/2004
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CCSCONFD/INC
          INC       CCSDRGFD/INC
          INC       CEANAMFD/INC
          INC       CEANBMFD/INC
          INC       CEANCMFD/INC
          INC       CEANDMFD/INC
          INC       CEAPSCFD/INC
          INC       CEASPCFD/INC
          INC       PATCODFD/INC
          INC       PATWR1FD/INC
.=========================
.Local Variable Definition
.-------------------------
.
.    Multi Item Key Fields Scr 01 Fld    15
.-------------------------------------------------------
CENA1NAM  INIT      "CENA1"
CENA1LEN  FORM      "56"
CENA1IDX  INIT      "DC1-5 UC6-12"
CENA1FNM  DIM       8  * Filename
CENA1AFL  FORM      1  * End Accept Mode
CENA1END  FORM      1  * End Display
CENA1SNO  FORM      5  * Number of Items on the Screen
CENA1NXT  DIM         12
CENA1FL1  IFILE     SQL, FIXED=56,  KEY="D1-5"
CENA1FL2  IFILE     SQL, FIXED=56, KEY="U6-12"
CENA1CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 03 Fld    15
.-------------------------------------------------------
CENC1NAM  INIT      "CENC1"
CENC1LEN  FORM      "51"
CENC1IDX  INIT      "DC1-5 UC6-12"
CENC1FNM  DIM       8  * Filename
CENC1AFL  FORM      1  * End Accept Mode
CENC1END  FORM      1  * End Display
CENC1SNO  FORM      5  * Number of Items on the Screen
CENC1NXT  DIM         12
CENC1FL1  IFILE     SQL, FIXED=51,  KEY="D1-5"
CENC1FL2  IFILE     SQL, FIXED=51, KEY="U6-12"
CENC1CNT  FORM      3  * Number of Items on Screen
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACEA14"
PRGNAM    INIT      "Bed Time Patient Service Mapping        "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CLOSE     CENA1FL2
          CLOSE     CENA1FL1,DELETE
.
          CLOSE     CENC1FL2
          CLOSE     CENC1FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening ccsdrgaf";
          OPEN      CCSDRGA1,"ccsdrgaf"
          MOVE      "   64",AUDTSECT
          MOVE      " 39",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ceaaudps";
            OPEN      CEAAUDPS,"ceaaudps"
          ENDIF
          DISPLAY   *P56:24,"Opening ceanamaf";
          OPEN      CEANAMA1,"ceanamaf"
          DISPLAY   *P56:24,"Opening ceanbmaf";
          OPEN      CEANBMA1,"ceanbmaf"
          DISPLAY   *P56:24,"Opening ceanbmaf";
          OPEN      CEANBMA2,"ceanbmaf"
          DISPLAY   *P56:24,"Opening ceancmaf";
          OPEN      CEANCMA1,"ceancmaf"
          DISPLAY   *P56:24,"Opening ceandmaf";
          OPEN      CEANDMA1,"ceandmaf"
          DISPLAY   *P56:24,"Opening ceapscaf";
          OPEN      CEAPSCA1,"ceapscaf"
          DISPLAY   *P56:24,"Opening ceaspcaf";
          OPEN      CEASPCA1,"ceaspcaf"
          DISPLAY   *P56:24,"Opening  patcodes           ";
          OPEN      PATCODE1,"patcodes"          
          DISPLAY   *P56:24,"Opening  patcodes           ";
          OPEN      PATCODE2,"patcodes"          
          DISPLAY   *P56:24,"Opening  patcodes           ";
          OPEN      PATCODE3,"patcodes"          
          DISPLAY   *P56:24,"Opening  patcodes           ";
          OPEN      PATCODE4,"patcodes"          
          DISPLAY   *P56:24,"Opening  patwr1af           ";
          OPEN      PATWR1A2,"patwr1af"          
          DISPLAY   *P56:24,"Opening  patwr1af           ";
          OPEN      PATWR1A3,"patwr1af"          
          DISPLAY   *P56:24,"Opening  patwr1af           ";
          OPEN      PATWR1A4,"patwr1af"          
.--------------------------------------------------------
. Initialise Batch Screen Patient Service                    
.--------------------------------------------------------
          MOVE     ZERO,CENA1SNO
          MOVE     "01   15",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CENA1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Patient Service Code               
.--------------------------------------------------------
          MOVE     ZERO,CENC1SNO
          MOVE     "03   15",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CENC1SNO
            ENDIF
          ENDIF
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Options Menu                       
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Map Ward to Patient Services       
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Admission Type Variations          
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Bed Type to Patient Serv.          
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * DRG Nursing Cost Variation         
          ENDIF
          RETURN
.--------------------------------
. Screen - Options Menu                       
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Options Menu                       
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Options Menu                       
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Options Menu                       
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Options Menu                       
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Options Menu                       
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Options Menu                       
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Options Menu                       
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          CALL      SC04L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Map Ward to Patient Services       
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Map Ward to Patient Services       
.-------------------------------------------------------
CF01L000
          MOVE      SP70,CENAWRD 
          MOVE      SP70,CESPSPC 
          MOVE      SP70,WBDESC  
          MOVE      SP70,CESPDES 
          MOVE      SP70,CENAPSC 
          MOVE      SP70,CEPSDES 
          MOVE      ZERO,CENAHQTY
          MOVE      ZERO,CENADQTY
          MOVE      SP70,CEPSQDES
          MOVE      SP70,CENAWRD 
          MOVE      SP70,CENASPC 
          MOVE      SP70,CENAPSC 
          MOVE      ZERO,CENAHQTY
          MOVE      ZERO,CENADQTY
          MOVE      SP70,CENASPA 
          MOVE      SP70,CENAWRD 
          MOVE      SP70,CENASPC 
          MOVE      SP70,CENAPSC 
          MOVE      ZERO,CENAHQTY
          MOVE      ZERO,CENADQTY
          MOVE      SP70,CENASPA 
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Map Ward to Patient Services       
.--------------------------------------------------------
KY01L000
.
KY01L110
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,WBDESC  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     CENAWRD 
          SFORMAT   VAR,SCPSLEN
          MOVE      CENAWRD,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CENAWRD 
          SFORMAT   VAR,127
          ENDSET    CENAWRD 
          APPEND    SP70,CENAWRD 
          RESET     CENAWRD 
          MATCH     SP70,CENAWRD 
          GOTO      KY01L900 IF EQUAL
          CMATCH    EXITCHAR,CENAWRD 
          GOTO      KY01L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      CENAWRD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      WBDESC,VAR       
            CALL      DISPITEM
          ENDIF
.
KY01L120
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CESPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCESPA00
          BRANCH    EXIT,KY01L110,KY01L900
          MOVE      ZERO,ACCEPT
          MOVE      CESPSPC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CESPDES,VAR      
            CALL      DISPITEM
          ENDIF
.
KY01L130
          MOVE      "   37",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     CENAWRD 
          SFORMAT   VAR,SCPSLEN
          MOVE      CENAWRD,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CENAWRD 
          SFORMAT   VAR,127
          ENDSET    CENAWRD 
          APPEND    SP70,CENAWRD 
          RESET     CENAWRD 
          MATCH     SP70,CENAWRD 
          GOTO      KY01L120 IF EQUAL
          CMATCH    EXITCHAR,CENAWRD 
          GOTO      KY01L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      CENAWRD,VAR      
          CALL      DISPITEM
.
KY01L140
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     CENASPC 
          SFORMAT   VAR,SCPSLEN
          MOVE      CENASPC,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CENASPC 
          SFORMAT   VAR,127
          ENDSET    CENASPC 
          APPEND    SP70,CENASPC 
          RESET     CENASPC 
          MATCH     SP70,CENASPC 
          GOTO      KY01L130 IF EQUAL
          CMATCH    EXITCHAR,CENASPC 
          GOTO      KY01L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      CENASPC,VAR      
          CALL      DISPITEM
.
KY01L150
          MOVE      "   39",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     CENAPSC 
          SFORMAT   VAR,SCPSLEN
          MOVE      CENAPSC,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CENAPSC 
          SFORMAT   VAR,127
          ENDSET    CENAPSC 
          APPEND    SP70,CENAPSC 
          RESET     CENAPSC 
          MATCH     SP70,CENAPSC 
          GOTO      KY01L140 IF EQUAL
          CMATCH    EXITCHAR,CENAPSC 
          GOTO      KY01L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      CENAPSC,VAR      
          CALL      DISPITEM
.
KY01L160
          MOVE      "   40",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CENAHQTY
          MOVE      ZERO,ACCEPT
          MOVE      CENAHQTY,VAR     
          CALL      DISPITEM
.
KY01L170
          MOVE      "   41",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CENADQTY
          MOVE      ZERO,ACCEPT
          MOVE      CENADQTY,VAR     
          CALL      DISPITEM
.
KY01L180
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     CENASPA 
          SFORMAT   VAR,SCPSLEN
          MOVE      CENASPA,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CENASPA 
          SFORMAT   VAR,127
          ENDSET    CENASPA 
          APPEND    SP70,CENASPA 
          RESET     CENASPA 
          MATCH     SP70,CENASPA 
          GOTO      KY01L170 IF EQUAL
          CMATCH    EXITCHAR,CENASPA 
          GOTO      KY01L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      CENASPA,VAR      
          CALL      DISPITEM
.
KY01L190
          MOVE      "   43",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     CENAWRD 
          SFORMAT   VAR,SCPSLEN
          MOVE      CENAWRD,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CENAWRD 
          SFORMAT   VAR,127
          ENDSET    CENAWRD 
          APPEND    SP70,CENAWRD 
          RESET     CENAWRD 
          MATCH     SP70,CENAWRD 
          GOTO      KY01L180 IF EQUAL
          CMATCH    EXITCHAR,CENAWRD 
          GOTO      KY01L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      CENAWRD,VAR      
          CALL      DISPITEM
.
KY01L200
          MOVE      "   44",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     CENASPC 
          SFORMAT   VAR,SCPSLEN
          MOVE      CENASPC,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CENASPC 
          SFORMAT   VAR,127
          ENDSET    CENASPC 
          APPEND    SP70,CENASPC 
          RESET     CENASPC 
          MATCH     SP70,CENASPC 
          GOTO      KY01L190 IF EQUAL
          CMATCH    EXITCHAR,CENASPC 
          GOTO      KY01L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      CENASPC,VAR      
          CALL      DISPITEM
.
KY01L210
          MOVE      "   45",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     CENAPSC 
          SFORMAT   VAR,SCPSLEN
          MOVE      CENAPSC,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CENAPSC 
          SFORMAT   VAR,127
          ENDSET    CENAPSC 
          APPEND    SP70,CENAPSC 
          RESET     CENAPSC 
          MATCH     SP70,CENAPSC 
          GOTO      KY01L200 IF EQUAL
          CMATCH    EXITCHAR,CENAPSC 
          GOTO      KY01L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      CENAPSC,VAR      
          CALL      DISPITEM
.
KY01L220
          MOVE      "   46",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CENAHQTY
          MOVE      ZERO,ACCEPT
          MOVE      CENAHQTY,VAR     
          CALL      DISPITEM
.
KY01L230
          MOVE      "   47",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CENADQTY
          MOVE      ZERO,ACCEPT
          MOVE      CENADQTY,VAR     
          CALL      DISPITEM
.
KY01L240
          MOVE      "   48",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     CENASPA 
          SFORMAT   VAR,SCPSLEN
          MOVE      CENASPA,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CENASPA 
          SFORMAT   VAR,127
          ENDSET    CENASPA 
          APPEND    SP70,CENASPA 
          RESET     CENASPA 
          MATCH     SP70,CENASPA 
          GOTO      KY01L230 IF EQUAL
          CMATCH    EXITCHAR,CENASPA 
          GOTO      KY01L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      CENASPA,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Map Ward to Patient Services       
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Map Ward to Patient Services       
.---------------------------------------------------------
LM01L000
.---------------------------------------------------------
. Load for :    15 Patient Service                    
.---------------------------------------------------------
          UNPACK    SP70,CENAWRD,CENASPC,CENAPSC
          PACK      CENA1FNM,ANST,CENA1NAM,PORT
          REP       " 0",CENA1FNM
          MOVE      ZERO,CENA1AFL
          CLOSE     CENA1FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CENA1FL1,CENA1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CENA1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CENA1FNM,SP1,CENA1LEN,SP1,CENA1IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      CENA1FL1,CENA1FNM
          OPEN      CENA1FL2,CENA1FNM
          PACK      KEY13,WWARD,CESPSPC,SP70
          MOVE      KEY13,SAVKEY80
          SETLPTR   SAVKEY80,6 
          CALL      RDCENA1 
          IF        OVRCD=0
            CALL      RPCENA1 
          ENDIF
LM01L100
          CALL      RKCENA1 
          BRANCH    OVRCD,LM01L105
          PACK      KEY13,CENAWRD,CENASPC,CENAPSC
          MATCH     SAVKEY80,KEY13   
          GOTO      LM01L105 IF NOT EQUAL
          RESET     KEY13,7
          MOVE      KEY13,KEY7
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TACENA12
          IF        OVRCD=0
            CALL      TUCENA12
          ELSE
            CALL      TWCENA12
          ENDIF
          GOTO     LM01L100
LM01L105
          MOVE     SP70,KEY7   
          CALL     TSCENA12
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Map Ward to Patient Services       
.---------------------------------------------------------
SM01L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM01L010 IF EQUAL
SM01L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L101,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010
SM01L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM01L007
          MATCH     PRGID,SCPSPID
          GOTO      SM01L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM01L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM01L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM01L006 IF NOT EQUAL
          GOTO      SM01L005
SM01L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM01L010
          BRANCH    STDGSFLG,SM01L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM01L900
          MATCH     PRGID,SCPSPID
          GOTO      SM01L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM01L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM01L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM01L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L102,SM01L103,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010
          GOTO      SM01L010
.
SM01L101
          MOVE     ZERO,CENA1AFL
          CALL      KCEPSA00
          MOVE      CEPSPSC,CENAPSC
          BRANCH    EXIT,SM01L990,SM01L990
          PACK     KEY13,CENAWRD,CENASPC,CENAPSC                                                   
          RESET    KEY13,7
          MOVE     KEY13,KEY7
          CALL      TACENA12
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM01L101
          ENDIF
          MOVE      CENAPSC,VAR      
          CALL      DISPITEM
          CALL      RPSC0000
.
.
          MOVE      "   16",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   19",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM01L010
.
SM01L102
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CENAHQTY
          IF        SCPSMAN=1
            COMPARE   ZERO,CENAHQTY
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM01L102
            ENDIF
          ENDIF
          MOVE      CENAHQTY,VAR     
          CALL      DISPITEM
          GOTO     SM01L010
.
SM01L103
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CENADQTY
          IF        SCPSMAN=1
            COMPARE   ZERO,CENADQTY
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM01L103
            ENDIF
          ENDIF
          MOVE      CENADQTY,VAR     
          CALL      DISPITEM
          GOTO     SM01L010
SM01L900
          MATCH    "CENA1",NAMSSFFI
          IF       @EQUAL
            PACK     KEY13,CENAWRD,CENASPC,CENAPSC
            RESET    KEY13,7
            MOVE     KEY13,KEY7
            CALL      TACENA12
            IF        OVRCD=0
              CALL      TUCENA12
            ELSE
              CALL      TWCENA12
            ENDIF
            GOTO      SM01L999
          ENDIF
          GOTO      SM01L999
SM01L990
          MATCH    "CENA1",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,CENA1AFL
          ENDIF
SM01L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP01L000
          MOVE     ZERO,CENA1CNT
          MOVE     ZERO,CENA1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP01L600
          MATCH    PRGID,SCPSPID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP01L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L010,DP01L101,DP01L102:
                            DP01L103,DP01L104,DP01L105,DP01L010:
                           DP01L010,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L010,DP01L010
          GOTO      DP01L010
.
DP01L101
          IF        CENA1END=0
            CALL      TKCENA12
            IF        OVRCD=1
              MOVE      ONE,CENA1END
            ELSE
              MOVE      ZERO,CENA1END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUCENA12
              MOVE      CENAPSC,VAR      
              CALL      DISPITEM
          CALL      RPSC0000
            ENDIF
          ENDIF
          IF        CENA1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L102
          IF        CENA1END=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L103
          IF        CENA1END=0
            MOVE      CENAHQTY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L104
          IF        CENA1END=0
            MOVE      CENADQTY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L105
          IF        CENA1END=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
DP01L600
          MATCH    "CENA1",NAMSSFFI
          GOTO     DP01L605 IF NOT EQUAL
          GOTO     DP01L999
DP01L605
DP01L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP01L000
.
          CALL     CT01L000
          MATCH    "CENA1",NAMSSFFI
          GOTO     FP01L105 IF NOT EQUAL
          MOVE     SP70,KEY7   
          CALL     TSCENA12 * Start
          CALL     DP01L000
          GOTO     FP01L999
FP01L105
FP01L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP01L000
.
          CALL     CT01L000
          MATCH    "CENA1",NAMSSFFI
          GOTO     LP01L105 IF NOT EQUAL
          PACK     KEY7,Z70
          CALL     TSCENA12
          IF       OVRCD=1
            CALL     TPCENA12 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CENA1SNO
            CALL     TPCENA12
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     LP01L999
LP01L105
LP01L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP01L000
.
PP01L100
          MATCH    "CENA1",NAMSSFFI
          GOTO     PP01L115 IF NOT EQUAL
PP01L105
          MOVE     SP70,CENA1NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCENA11
          CALL     TKCENA11 * First on Page
          MOVE     KEY7,CENA1NXT
          CALL     TSCENA12
          CALL     TPCENA12 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP01L999
          ENDIF
.
          CALL     CT01L000
.
. Position and Display Page
.--------------------------
PP01L110
          MOVE     CENA1NXT,KEY7   
          CALL     TSCENA12
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CENA1SNO
            CALL     TPCENA12
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     PP01L999
PP01L115
PP01L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP01L000
          MATCH    "CENA1",NAMSSFFI
          GOTO     NP01L115 IF NOT EQUAL
NP01L105
          MOVE     SP70,CENA1NXT
          PACK     KEY5,Z70
          CALL     TSCENA11
          CALL     TPCENA11
          MOVE     KEY7,CENA1NXT
          CALL     TSCENA12
          CALL     TKCENA12
          IF       OVRCD=1
            BEEP
            GOTO      NP01L999
          ENDIF
.
          CALL     CT01L000
.
. Position and Display Page
.--------------------------
NP01L110
          MOVE     CENA1NXT,KEY7   
          CALL     TSCENA12
          CALL     DP01L000
          GOTO     NP01L999
NP01L115
NP01L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT01L000
          MATCH    "CENA1",NAMSSFFI
          GOTO     CT01L115 IF NOT EQUAL
CT01L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCENA11
          CALL     TKCENA11
          BRANCH   OVRCD,CT01L110
          CALL     TRCENA12
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUCENA12
          GOTO     CT01L105
CT01L110
          GOTO     CT01L999
CT01L115
CT01L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP01L000
          CALL     CT01L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP01L999
          MATCH    PRGID,SCPSPID
          GOTO     CP01L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP01L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP01L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP01L010,CP01L010,CP01L010,CP01L010:
                            CP01L010,CP01L010,CP01L010,CP01L010:
                            CP01L010,CP01L010,CP01L010,CP01L010:
                           CP01L010,CP01L010,CP01L100,CP01L100:
                            CP01L100,CP01L100,CP01L100,CP01L010:
                           CP01L010,CP01L010,CP01L010,CP01L010:
                           CP01L010,CP01L010,CP01L010,CP01L010:
                           CP01L010,CP01L010,CP01L010,CP01L010:
                            CP01L010,CP01L010,CP01L010,CP01L010:
                            CP01L010,CP01L010,CP01L010,CP01L010:
                            CP01L010,CP01L010,CP01L010,CP01L010:
                            CP01L010,CP01L010,CP01L010,CP01L010
.
CP01L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP01L010
CP01L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD01L000
          CALL      CP01L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD01L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD01L000
          MATCH     PRGID,SCPSPID
          GOTO      AD01L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD01L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD01L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM01L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "CENA1",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,CENA1AFL
            GOTO      AD01L010 IF EQUAL
            CALL      FP01L000
            GOTO      AD01L999
          ENDIF
AD01L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL01L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL01L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL01L900,DL01L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL01L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "CENA1",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRCENA11
            IF        OVRCD=0
              CALL      TDCENA12
            ELSE
              BEEP
              GOTO      DL01L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSCENA11
            CALL      TKCENA11
            MOVE     KEY7,CENA1NXT
            CALL      CT01L000
            MOVE      CENA1NXT,KEY7   
            CALL      TSCENA12
            CALL      TPCENA12
            CALL      DP01L000
            GOTO      DL01L005
          ENDIF
DL01L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL01L005
DL01L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Map Ward to Patient Services       
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    15 Patient Service                    
.---------------------------------------------------------
TSCENA11  RESET     KEY5
          READ      CENA1FL1,KEY5;;
          RETURN
.
TSCENA12  RESET     KEY7   
          READ      CENA1FL2,KEY7;;
          RETURN
.
TACENA12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CENA1FL2,KEY7;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDCENA11  RESET     KEY5
          DELETE    CENA1FL1,KEY5
          RETURN
.
TDCENA12  RESET     KEY7
          DELETE    CENA1FL2,KEY7
          RETURN
.
TKCENA11  MOVE      ZERO,OVRCD
          READKS    CENA1FL1;SCTMROW,SCTMCOL,KEY7:
                        CENAWRD,CENASPC,CENAPSC,CENAHQTY,CENADQTY:
                        CENASPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TKCENA12  MOVE      ZERO,OVRCD
          READKS    CENA1FL2;SCTMROW,SCTMCOL,KEY7:
                        CENAWRD,CENASPC,CENAPSC,CENAHQTY,CENADQTY:
                        CENASPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCENA11  MOVE      ZERO,OVRCD
          READKP    CENA1FL1;SCTMROW,SCTMCOL,KEY7:
                        CENAWRD,CENASPC,CENAPSC,CENAHQTY,CENADQTY:
                        CENASPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCENA12  MOVE      ZERO,OVRCD
          READKP    CENA1FL2;SCTMROW,SCTMCOL,KEY7:
                        CENAWRD,CENASPC,CENAPSC,CENAHQTY,CENADQTY:
                        CENASPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCENA11  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      CENA1FL1,KEY5;SCTMROW,SCTMCOL,KEY7:
                        CENAWRD,CENASPC,CENAPSC,CENAHQTY,CENADQTY:
                        CENASPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCENA12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CENA1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CENAWRD,CENASPC,CENAPSC,CENAHQTY,CENADQTY:
                        CENASPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TUCENA11  UPDATE    CENA1FL1;SCTMROW,SCTMCOL,KEY7:
                        CENAWRD,CENASPC,CENAPSC,CENAHQTY,CENADQTY:
                        CENASPA                                                 
          RETURN
.
TUCENA12
          UPDATE    CENA1FL2;SCTMROW,SCTMCOL,KEY7:
                        CENAWRD,CENASPC,CENAPSC,CENAHQTY,CENADQTY:
                        CENASPA                                                 
          RETURN
.
TWCENA12  RESET     KEY7   
          WRITE     CENA1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CENAWRD,CENASPC,CENAPSC,CENAHQTY,CENADQTY:
                        CENASPA                                                 
          RETURN
.---------------------------------------------------------
. Display Fields for : Map Ward to Patient Services       
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
          MOVE      "CENA1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      FP01L000
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Map Ward to Patient Services       
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L101,PS01L102:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999
          GOTO     PS01L999
.
PS01L101
          MOVE      WBDESC,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      CESPDES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Map Ward to Patient Services       
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L104,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L105,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L106,SF01L107:
                            SF01L108,SF01L109,SF01L110,SF01L111:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L105,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          MOVE      "CENA1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L101
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      POSA0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELA0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF01L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF01L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF01L999
          ENDIF
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF01L000
          ENDIF
          GOTO      SF01L001
.
SF01L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      COPA0000
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF01L000
          GOTO      SF01L001
.
SF01L105
          CALL      SELECTED
          BRANCH    EXIT,SF01L001
          MOVE      "CENA1",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRCENA11
            BRANCH    OVRCD,SF01L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF01L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF01L001 IF NOT EQUAL
            CALL      SM01L000 * Change Line
          ELSE
            IF        CENA1AFL=0
              MOVE      "CENA1",NAMSSFFI
              MOVE     "   15",ITMSSFFI
              CALL      AD01L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF01L001
.
SF01L106
          MOVE      "CENA1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      NP01L000
          GOTO     SF01L001
.
SF01L107
          MOVE      "CENA1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      PP01L000
          GOTO     SF01L001
.
SF01L108
          MOVE      "CENA1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      AD01L000
          GOTO     SF01L001
.
SF01L109
          MOVE      "CENA1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      DL01L000
          GOTO     SF01L001
.
SF01L110
          MOVE      "CENA1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L111
          MOVE      "CENA1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      LP01L000
          GOTO     SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Admission Type Variations          
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Admission Type Variations          
.-------------------------------------------------------
CF02L000
          MOVE      SP70,CENBATY 
          MOVE      SP70,CENBWRD 
          MOVE      ZERO,CENBFC1 
          MOVE      ZERO,CENBFC2 
          MOVE      ZERO,CENBFC3 
          MOVE      ZERO,CENBFC4 
          MOVE      ZERO,CENBFC5 
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Admission Type Variations          
.--------------------------------------------------------
KY02L000
.
KY02L110
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TDESC   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL      DISCTY00
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KATY0000
          BRANCH    EXIT,KY02L900,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      CENBATY,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TDESC,VAR        
            CALL      DISPITEM
          ENDIF
.
KY02L120
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,WBDESC  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      KWRD0000
          BRANCH    EXIT,KY02L110,KY02L900
          MOVE      OVRCD,ACCEPT
          MOVE      CENBWRD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      WBDESC,VAR       
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Admission Type Variations          
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Admission Type Variations          
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Admission Type Variations          
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Admission Type Variations          
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L101,PS02L102:
                            PS02L103,PS02L104,PS02L105,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L106,PS02L107:
                            PS02L108,PS02L109,PS02L110,PS02L111:
                            PS02L112
          GOTO     PS02L999
.
PS02L101
          MOVE      CCCOCD1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      CCCOCD2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      CCCOCD3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      CCCOCD4,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      CCCOCD5,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      CENBFC1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      CENBFC2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      CENBFC3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          MOVE      CENBFC4,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          MOVE      CENBFC5,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          MOVE      TDESC,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L112
          MOVE      WBDESC,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Admission Type Variations          
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L102:
                            SF02L103,SF02L104,SF02L105,SF02L106:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L006,SF02L006,SF02L107,SF02L108:
                            SF02L109,SF02L110,SF02L111,SF02L006:
                            SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L107,SF02L108:
                            SF02L109,SF02L110,SF02L111,SF02L020:
                            SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L102
          CALL      POSB0000
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L103
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELB0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF02L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF02L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF02L999
          ENDIF
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF02L000
          ENDIF
          GOTO      SF02L001
.
SF02L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      COPB0000
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF02L001
.
SF02L106
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      ADMC0000
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF02L001
.
SF02L107
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CENBFC1 
          IF        SCPSMAN=1
            COMPARE   ZERO,CENBFC1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L107
            ENDIF
          ENDIF
          MOVE      CENBFC1,VAR      
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L108
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CENBFC2 
          IF        SCPSMAN=1
            COMPARE   ZERO,CENBFC2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L108
            ENDIF
          ENDIF
          MOVE      CENBFC2,VAR      
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L109
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CENBFC3 
          IF        SCPSMAN=1
            COMPARE   ZERO,CENBFC3 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L109
            ENDIF
          ENDIF
          MOVE      CENBFC3,VAR      
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L110
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CENBFC4 
          IF        SCPSMAN=1
            COMPARE   ZERO,CENBFC4 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L110
            ENDIF
          ENDIF
          MOVE      CENBFC4,VAR      
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L111
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CENBFC5 
          IF        SCPSMAN=1
            COMPARE   ZERO,CENBFC5 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L111
            ENDIF
          ENDIF
          MOVE      CENBFC5,VAR      
          CALL      DISPITEM
          GOTO     SF02L001
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Bed Type to Patient Serv.          
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Bed Type to Patient Serv.          
.-------------------------------------------------------
CF03L000
          MOVE      SP70,CENCBTY 
          MOVE      SP70,CENCSPC 
          MOVE      SP70,TDESC   
          MOVE      SP70,CESPDES 
          MOVE      SP70,CENCPSC 
          MOVE      SP70,CEPSDES 
          MOVE      ZERO,CENCQTY 
          MOVE      SP70,CEPSQDES
          MOVE      SP70,TCODE   
          MOVE      SP70,ACODE   
          MOVE      SP70,TDESC   
          MOVE      SP70,THCSCOD 
          MOVE      ZERO,TCFORM6 
          MOVE      SP70,TCINDC1 
          MOVE      SP70,TCINDC2 
          MOVE      SP70,TCINDC3 
          MOVE      SP70,TCINDC4 
          MOVE      SP70,TCINDC5 
          MOVE      SP70,PTCOACTV
          MOVE      SP70,TCINDC6 
          MOVE      SP70,TCINDC7 
          MOVE      SP70,TCINDC8 
          MOVE      SP70,TCINDC9 
          MOVE      SP70,TCINDC10
          MOVE      SP70,TCINDC11
          MOVE      SP70,TCSPARE 
          MOVE      SP70,TCODE   
          MOVE      SP70,ACODE   
          MOVE      SP70,TDESC   
          MOVE      SP70,THCSCOD 
          MOVE      ZERO,TCFORM6 
          MOVE      SP70,TCINDC1 
          MOVE      SP70,TCINDC2 
          MOVE      SP70,TCINDC3 
          MOVE      SP70,TCINDC4 
          MOVE      SP70,TCINDC5 
          MOVE      SP70,PTCOACTV
          MOVE      SP70,TCINDC6 
          MOVE      SP70,TCINDC7 
          MOVE      SP70,TCINDC8 
          MOVE      SP70,TCINDC9 
          MOVE      SP70,TCINDC10
          MOVE      SP70,TCINDC11
          MOVE      SP70,TCSPARE 
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Bed Type to Patient Serv.          
.--------------------------------------------------------
KY03L000
.
KY03L110
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TDESC   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EBTYP000
          BRANCH    EXIT,KY03L900,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      CENCBTY,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TDESC,VAR        
            CALL      DISPITEM
          ENDIF
.
KY03L120
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CESPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCESPA00
          MOVE      CESPSPC,CENCSPC
          BRANCH    EXIT,KY03L110,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      CENCSPC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CESPDES,VAR      
            CALL      DISPITEM
          ENDIF
.
KY03L130
          MOVE      "   37",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCODE   
          SFORMAT   VAR,SCPSLEN
          MOVE      TCODE,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCODE   
          SFORMAT   VAR,127
          ENDSET    TCODE   
          APPEND    SP70,TCODE   
          RESET     TCODE   
          MATCH     SP70,TCODE   
          GOTO      KY03L120 IF EQUAL
          CMATCH    EXITCHAR,TCODE   
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCODE,VAR        
          CALL      DISPITEM
.
KY03L140
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KWRD0000
          BRANCH    EXIT,KY03L130,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      ACODE,VAR        
          CALL      DISPITEM
.
KY03L150
          MOVE      "   39",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TDESC   
          SFORMAT   VAR,SCPSLEN
          MOVE      TDESC,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TDESC   
          SFORMAT   VAR,127
          ENDSET    TDESC   
          APPEND    SP70,TDESC   
          RESET     TDESC   
          MATCH     SP70,TDESC   
          GOTO      KY03L140 IF EQUAL
          CMATCH    EXITCHAR,TDESC   
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TDESC,VAR        
          CALL      DISPITEM
.
KY03L160
          MOVE      "   40",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     THCSCOD 
          SFORMAT   VAR,SCPSLEN
          MOVE      THCSCOD,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,THCSCOD 
          SFORMAT   VAR,127
          ENDSET    THCSCOD 
          APPEND    SP70,THCSCOD 
          RESET     THCSCOD 
          MATCH     SP70,THCSCOD 
          GOTO      KY03L150 IF EQUAL
          CMATCH    EXITCHAR,THCSCOD 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      THCSCOD,VAR      
          CALL      DISPITEM
.
KY03L170
          MOVE      "   41",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,TCFORM6 
          MOVE      ZERO,ACCEPT
          MOVE      TCFORM6,VAR      
          CALL      DISPITEM
.
KY03L180
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC1 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC1 
          SFORMAT   VAR,127
          ENDSET    TCINDC1 
          APPEND    SP70,TCINDC1 
          RESET     TCINDC1 
          MATCH     SP70,TCINDC1 
          GOTO      KY03L170 IF EQUAL
          CMATCH    EXITCHAR,TCINDC1 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC1,VAR      
          CALL      DISPITEM
.
KY03L190
          MOVE      "   43",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC2 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC2 
          SFORMAT   VAR,127
          ENDSET    TCINDC2 
          APPEND    SP70,TCINDC2 
          RESET     TCINDC2 
          MATCH     SP70,TCINDC2 
          GOTO      KY03L180 IF EQUAL
          CMATCH    EXITCHAR,TCINDC2 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC2,VAR      
          CALL      DISPITEM
.
KY03L200
          MOVE      "   44",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC3 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC3,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC3 
          SFORMAT   VAR,127
          ENDSET    TCINDC3 
          APPEND    SP70,TCINDC3 
          RESET     TCINDC3 
          MATCH     SP70,TCINDC3 
          GOTO      KY03L190 IF EQUAL
          CMATCH    EXITCHAR,TCINDC3 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC3,VAR      
          CALL      DISPITEM
.
KY03L210
          MOVE      "   45",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC4 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC4,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC4 
          SFORMAT   VAR,127
          ENDSET    TCINDC4 
          APPEND    SP70,TCINDC4 
          RESET     TCINDC4 
          MATCH     SP70,TCINDC4 
          GOTO      KY03L200 IF EQUAL
          CMATCH    EXITCHAR,TCINDC4 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC4,VAR      
          CALL      DISPITEM
.
KY03L220
          MOVE      "   46",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC5 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC5,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC5 
          SFORMAT   VAR,127
          ENDSET    TCINDC5 
          APPEND    SP70,TCINDC5 
          RESET     TCINDC5 
          MATCH     SP70,TCINDC5 
          GOTO      KY03L210 IF EQUAL
          CMATCH    EXITCHAR,TCINDC5 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC5,VAR      
          CALL      DISPITEM
.
KY03L230
          MOVE      "   47",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     PTCOACTV
          SFORMAT   VAR,SCPSLEN
          MOVE      PTCOACTV,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,PTCOACTV
          SFORMAT   VAR,127
          ENDSET    PTCOACTV
          APPEND    SP70,PTCOACTV
          RESET     PTCOACTV
          MATCH     SP70,PTCOACTV
          GOTO      KY03L220 IF EQUAL
          CMATCH    EXITCHAR,PTCOACTV
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      PTCOACTV,VAR     
          CALL      DISPITEM
.
KY03L240
          MOVE      "   48",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC6 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC6,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC6 
          SFORMAT   VAR,127
          ENDSET    TCINDC6 
          APPEND    SP70,TCINDC6 
          RESET     TCINDC6 
          MATCH     SP70,TCINDC6 
          GOTO      KY03L230 IF EQUAL
          CMATCH    EXITCHAR,TCINDC6 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC6,VAR      
          CALL      DISPITEM
.
KY03L250
          MOVE      "   49",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC7 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC7,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC7 
          SFORMAT   VAR,127
          ENDSET    TCINDC7 
          APPEND    SP70,TCINDC7 
          RESET     TCINDC7 
          MATCH     SP70,TCINDC7 
          GOTO      KY03L240 IF EQUAL
          CMATCH    EXITCHAR,TCINDC7 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC7,VAR      
          CALL      DISPITEM
.
KY03L260
          MOVE      "   50",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC8 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC8,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC8 
          SFORMAT   VAR,127
          ENDSET    TCINDC8 
          APPEND    SP70,TCINDC8 
          RESET     TCINDC8 
          MATCH     SP70,TCINDC8 
          GOTO      KY03L250 IF EQUAL
          CMATCH    EXITCHAR,TCINDC8 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC8,VAR      
          CALL      DISPITEM
.
KY03L270
          MOVE      "   51",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC9 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC9,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC9 
          SFORMAT   VAR,127
          ENDSET    TCINDC9 
          APPEND    SP70,TCINDC9 
          RESET     TCINDC9 
          MATCH     SP70,TCINDC9 
          GOTO      KY03L260 IF EQUAL
          CMATCH    EXITCHAR,TCINDC9 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC9,VAR      
          CALL      DISPITEM
.
KY03L280
          MOVE      "   52",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC10
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC10,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC10
          SFORMAT   VAR,127
          ENDSET    TCINDC10
          APPEND    SP70,TCINDC10
          RESET     TCINDC10
          MATCH     SP70,TCINDC10
          GOTO      KY03L270 IF EQUAL
          CMATCH    EXITCHAR,TCINDC10
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC10,VAR     
          CALL      DISPITEM
.
KY03L290
          MOVE      "   53",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC11
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC11,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC11
          SFORMAT   VAR,127
          ENDSET    TCINDC11
          APPEND    SP70,TCINDC11
          RESET     TCINDC11
          MATCH     SP70,TCINDC11
          GOTO      KY03L280 IF EQUAL
          CMATCH    EXITCHAR,TCINDC11
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC11,VAR     
          CALL      DISPITEM
.
KY03L300
          MOVE      "   54",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCSPARE 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCSPARE,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCSPARE 
          SFORMAT   VAR,127
          ENDSET    TCSPARE 
          APPEND    SP70,TCSPARE 
          RESET     TCSPARE 
          MATCH     SP70,TCSPARE 
          GOTO      KY03L290 IF EQUAL
          CMATCH    EXITCHAR,TCSPARE 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCSPARE,VAR      
          CALL      DISPITEM
.
KY03L310
          MOVE      "   55",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCODE   
          SFORMAT   VAR,SCPSLEN
          MOVE      TCODE,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCODE   
          SFORMAT   VAR,127
          ENDSET    TCODE   
          APPEND    SP70,TCODE   
          RESET     TCODE   
          MATCH     SP70,TCODE   
          GOTO      KY03L300 IF EQUAL
          CMATCH    EXITCHAR,TCODE   
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCODE,VAR        
          CALL      DISPITEM
.
KY03L320
          MOVE      "   56",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     ACODE   
          SFORMAT   VAR,SCPSLEN
          MOVE      ACODE,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,ACODE   
          SFORMAT   VAR,127
          ENDSET    ACODE   
          APPEND    SP70,ACODE   
          RESET     ACODE   
          MATCH     SP70,ACODE   
          GOTO      KY03L310 IF EQUAL
          CMATCH    EXITCHAR,ACODE   
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      ACODE,VAR        
          CALL      DISPITEM
.
KY03L330
          MOVE      "   57",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TDESC   
          SFORMAT   VAR,SCPSLEN
          MOVE      TDESC,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TDESC   
          SFORMAT   VAR,127
          ENDSET    TDESC   
          APPEND    SP70,TDESC   
          RESET     TDESC   
          MATCH     SP70,TDESC   
          GOTO      KY03L320 IF EQUAL
          CMATCH    EXITCHAR,TDESC   
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TDESC,VAR        
          CALL      DISPITEM
.
KY03L340
          MOVE      "   58",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     THCSCOD 
          SFORMAT   VAR,SCPSLEN
          MOVE      THCSCOD,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,THCSCOD 
          SFORMAT   VAR,127
          ENDSET    THCSCOD 
          APPEND    SP70,THCSCOD 
          RESET     THCSCOD 
          MATCH     SP70,THCSCOD 
          GOTO      KY03L330 IF EQUAL
          CMATCH    EXITCHAR,THCSCOD 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      THCSCOD,VAR      
          CALL      DISPITEM
.
KY03L350
          MOVE      "   59",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,TCFORM6 
          MOVE      ZERO,ACCEPT
          MOVE      TCFORM6,VAR      
          CALL      DISPITEM
.
KY03L360
          MOVE      "   60",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC1 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC1 
          SFORMAT   VAR,127
          ENDSET    TCINDC1 
          APPEND    SP70,TCINDC1 
          RESET     TCINDC1 
          MATCH     SP70,TCINDC1 
          GOTO      KY03L350 IF EQUAL
          CMATCH    EXITCHAR,TCINDC1 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC1,VAR      
          CALL      DISPITEM
.
KY03L370
          MOVE      "   61",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC2 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC2 
          SFORMAT   VAR,127
          ENDSET    TCINDC2 
          APPEND    SP70,TCINDC2 
          RESET     TCINDC2 
          MATCH     SP70,TCINDC2 
          GOTO      KY03L360 IF EQUAL
          CMATCH    EXITCHAR,TCINDC2 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC2,VAR      
          CALL      DISPITEM
.
KY03L380
          MOVE      "   62",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC3 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC3,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC3 
          SFORMAT   VAR,127
          ENDSET    TCINDC3 
          APPEND    SP70,TCINDC3 
          RESET     TCINDC3 
          MATCH     SP70,TCINDC3 
          GOTO      KY03L370 IF EQUAL
          CMATCH    EXITCHAR,TCINDC3 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC3,VAR      
          CALL      DISPITEM
.
KY03L390
          MOVE      "   63",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC4 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC4,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC4 
          SFORMAT   VAR,127
          ENDSET    TCINDC4 
          APPEND    SP70,TCINDC4 
          RESET     TCINDC4 
          MATCH     SP70,TCINDC4 
          GOTO      KY03L380 IF EQUAL
          CMATCH    EXITCHAR,TCINDC4 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC4,VAR      
          CALL      DISPITEM
.
KY03L400
          MOVE      "   64",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC5 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC5,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC5 
          SFORMAT   VAR,127
          ENDSET    TCINDC5 
          APPEND    SP70,TCINDC5 
          RESET     TCINDC5 
          MATCH     SP70,TCINDC5 
          GOTO      KY03L390 IF EQUAL
          CMATCH    EXITCHAR,TCINDC5 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC5,VAR      
          CALL      DISPITEM
.
KY03L410
          MOVE      "   65",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     PTCOACTV
          SFORMAT   VAR,SCPSLEN
          MOVE      PTCOACTV,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,PTCOACTV
          SFORMAT   VAR,127
          ENDSET    PTCOACTV
          APPEND    SP70,PTCOACTV
          RESET     PTCOACTV
          MATCH     SP70,PTCOACTV
          GOTO      KY03L400 IF EQUAL
          CMATCH    EXITCHAR,PTCOACTV
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      PTCOACTV,VAR     
          CALL      DISPITEM
.
KY03L420
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC6 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC6,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC6 
          SFORMAT   VAR,127
          ENDSET    TCINDC6 
          APPEND    SP70,TCINDC6 
          RESET     TCINDC6 
          MATCH     SP70,TCINDC6 
          GOTO      KY03L410 IF EQUAL
          CMATCH    EXITCHAR,TCINDC6 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC6,VAR      
          CALL      DISPITEM
.
KY03L430
          MOVE      "   67",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC7 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC7,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC7 
          SFORMAT   VAR,127
          ENDSET    TCINDC7 
          APPEND    SP70,TCINDC7 
          RESET     TCINDC7 
          MATCH     SP70,TCINDC7 
          GOTO      KY03L420 IF EQUAL
          CMATCH    EXITCHAR,TCINDC7 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC7,VAR      
          CALL      DISPITEM
.
KY03L440
          MOVE      "   68",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC8 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC8,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC8 
          SFORMAT   VAR,127
          ENDSET    TCINDC8 
          APPEND    SP70,TCINDC8 
          RESET     TCINDC8 
          MATCH     SP70,TCINDC8 
          GOTO      KY03L430 IF EQUAL
          CMATCH    EXITCHAR,TCINDC8 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC8,VAR      
          CALL      DISPITEM
.
KY03L450
          MOVE      "   69",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC9 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC9,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC9 
          SFORMAT   VAR,127
          ENDSET    TCINDC9 
          APPEND    SP70,TCINDC9 
          RESET     TCINDC9 
          MATCH     SP70,TCINDC9 
          GOTO      KY03L440 IF EQUAL
          CMATCH    EXITCHAR,TCINDC9 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC9,VAR      
          CALL      DISPITEM
.
KY03L460
          MOVE      "   70",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC10
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC10,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC10
          SFORMAT   VAR,127
          ENDSET    TCINDC10
          APPEND    SP70,TCINDC10
          RESET     TCINDC10
          MATCH     SP70,TCINDC10
          GOTO      KY03L450 IF EQUAL
          CMATCH    EXITCHAR,TCINDC10
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC10,VAR     
          CALL      DISPITEM
.
KY03L470
          MOVE      "   71",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCINDC11
          SFORMAT   VAR,SCPSLEN
          MOVE      TCINDC11,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCINDC11
          SFORMAT   VAR,127
          ENDSET    TCINDC11
          APPEND    SP70,TCINDC11
          RESET     TCINDC11
          MATCH     SP70,TCINDC11
          GOTO      KY03L460 IF EQUAL
          CMATCH    EXITCHAR,TCINDC11
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCINDC11,VAR     
          CALL      DISPITEM
.
KY03L480
          MOVE      "   72",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          STRIP     TCSPARE 
          SFORMAT   VAR,SCPSLEN
          MOVE      TCSPARE,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,TCSPARE 
          SFORMAT   VAR,127
          ENDSET    TCSPARE 
          APPEND    SP70,TCSPARE 
          RESET     TCSPARE 
          MATCH     SP70,TCSPARE 
          GOTO      KY03L470 IF EQUAL
          CMATCH    EXITCHAR,TCSPARE 
          GOTO      KY03L900 IF EQUAL
          MOVE      ZERO,ACCEPT
          MOVE      TCSPARE,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Bed Type to Patient Serv.          
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Bed Type to Patient Serv.          
.---------------------------------------------------------
LM03L000
.---------------------------------------------------------
. Load for :    15 Patient Service Code               
.---------------------------------------------------------
          UNPACK    SP70,CENCBTY,CENCSPC,CENCPSC
          PACK      CENC1FNM,ANST,CENC1NAM,PORT
          REP       " 0",CENC1FNM
          MOVE      ZERO,CENC1AFL
          CLOSE     CENC1FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CENC1FL1,CENC1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CENC1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CENC1FNM,SP1,CENC1LEN,SP1,CENC1IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      CENC1FL1,CENC1FNM
          OPEN      CENC1FL2,CENC1FNM
          PACK      KEY13,ACODE,CESPSPC,SP70
          MOVE      KEY13,SAVKEY80
          SETLPTR   SAVKEY80,6 
          CALL      RDCENC1 
          IF        OVRCD=0
            CALL      RPCENC1 
          ENDIF
LM03L100
          CALL      RKCENC1 
          BRANCH    OVRCD,LM03L105
          PACK      KEY13,CENCBTY,CENCSPC,CENCPSC
          MATCH     SAVKEY80,KEY13   
          GOTO      LM03L105 IF NOT EQUAL
          RESET     KEY13,7
          MOVE      KEY13,KEY7
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TACENC12
          IF        OVRCD=0
            CALL      TUCENC12
          ELSE
            CALL      TWCENC12
          ENDIF
          GOTO     LM03L100
LM03L105
          MOVE     SP70,KEY7   
          CALL     TSCENC12
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Bed Type to Patient Serv.          
.---------------------------------------------------------
SM03L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM03L010 IF EQUAL
SM03L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L101,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010
SM03L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM03L007
          MATCH     PRGID,SCPSPID
          GOTO      SM03L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM03L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM03L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM03L006 IF NOT EQUAL
          GOTO      SM03L005
SM03L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM03L010
          BRANCH    STDGSFLG,SM03L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM03L900
          MATCH     PRGID,SCPSPID
          GOTO      SM03L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM03L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM03L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM03L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L102,SM03L010,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010
          GOTO      SM03L010
.
SM03L101
          MOVE     ZERO,CENC1AFL
          CALL      KCEPSA00
          MOVE      CEPSPSC,CENCPSC
          BRANCH    EXIT,SM03L990,SM03L990
          PACK     KEY13,CENCBTY,CENCSPC,CENCPSC                                                   
          RESET    KEY13,7
          MOVE     KEY13,KEY7
          CALL      TACENC12
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM03L101
          ENDIF
          MOVE      CENCPSC,VAR      
          CALL      DISPITEM
          CALL      RPSC0000
.
.
          MOVE      "   16",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   19",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM03L010
.
SM03L102
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CENCQTY 
          IF        SCPSMAN=1
            COMPARE   ZERO,CENCQTY 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM03L102
            ENDIF
          ENDIF
          MOVE      CENCQTY,VAR      
          CALL      DISPITEM
          GOTO     SM03L010
SM03L900
          MATCH    "CENC1",NAMSSFFI
          IF       @EQUAL
            PACK     KEY13,CENCBTY,CENCSPC,CENCPSC
            RESET    KEY13,7
            MOVE     KEY13,KEY7
            CALL      TACENC12
            IF        OVRCD=0
              CALL      TUCENC12
            ELSE
              CALL      TWCENC12
            ENDIF
            GOTO      SM03L999
          ENDIF
          GOTO      SM03L999
SM03L990
          MATCH    "CENC1",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,CENC1AFL
          ENDIF
SM03L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP03L000
          MOVE     ZERO,CENC1CNT
          MOVE     ZERO,CENC1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP03L600
          MATCH    PRGID,SCPSPID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP03L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                           DP03L010,DP03L010,DP03L101,DP03L102:
                            DP03L103,DP03L010,DP03L104,DP03L010:
                           DP03L010,DP03L010,DP03L010,DP03L010:
                           DP03L010,DP03L010,DP03L010,DP03L010:
                           DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010
          GOTO      DP03L010
.
DP03L101
          IF        CENC1END=0
            CALL      TKCENC12
            IF        OVRCD=1
              MOVE      ONE,CENC1END
            ELSE
              MOVE      ZERO,CENC1END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUCENC12
              MOVE      CENCPSC,VAR      
              CALL      DISPITEM
          CALL      RPSC0000
            ENDIF
          ENDIF
          IF        CENC1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L102
          IF        CENC1END=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L103
          IF        CENC1END=0
            MOVE      CENCQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L104
          IF        CENC1END=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
DP03L600
          MATCH    "CENC1",NAMSSFFI
          GOTO     DP03L605 IF NOT EQUAL
          GOTO     DP03L999
DP03L605
DP03L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP03L000
.
          CALL     CT03L000
          MATCH    "CENC1",NAMSSFFI
          GOTO     FP03L105 IF NOT EQUAL
          MOVE     SP70,KEY7   
          CALL     TSCENC12 * Start
          CALL     DP03L000
          GOTO     FP03L999
FP03L105
FP03L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP03L000
.
          CALL     CT03L000
          MATCH    "CENC1",NAMSSFFI
          GOTO     LP03L105 IF NOT EQUAL
          PACK     KEY7,Z70
          CALL     TSCENC12
          IF       OVRCD=1
            CALL     TPCENC12 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CENC1SNO
            CALL     TPCENC12
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     LP03L999
LP03L105
LP03L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP03L000
.
PP03L100
          MATCH    "CENC1",NAMSSFFI
          GOTO     PP03L115 IF NOT EQUAL
PP03L105
          MOVE     SP70,CENC1NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCENC11
          CALL     TKCENC11 * First on Page
          MOVE     KEY7,CENC1NXT
          CALL     TSCENC12
          CALL     TPCENC12 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP03L999
          ENDIF
.
          CALL     CT03L000
.
. Position and Display Page
.--------------------------
PP03L110
          MOVE     CENC1NXT,KEY7   
          CALL     TSCENC12
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CENC1SNO
            CALL     TPCENC12
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     PP03L999
PP03L115
PP03L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP03L000
          MATCH    "CENC1",NAMSSFFI
          GOTO     NP03L115 IF NOT EQUAL
NP03L105
          MOVE     SP70,CENC1NXT
          PACK     KEY5,Z70
          CALL     TSCENC11
          CALL     TPCENC11
          MOVE     KEY7,CENC1NXT
          CALL     TSCENC12
          CALL     TKCENC12
          IF       OVRCD=1
            BEEP
            GOTO      NP03L999
          ENDIF
.
          CALL     CT03L000
.
. Position and Display Page
.--------------------------
NP03L110
          MOVE     CENC1NXT,KEY7   
          CALL     TSCENC12
          CALL     DP03L000
          GOTO     NP03L999
NP03L115
NP03L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT03L000
          MATCH    "CENC1",NAMSSFFI
          GOTO     CT03L115 IF NOT EQUAL
CT03L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCENC11
          CALL     TKCENC11
          BRANCH   OVRCD,CT03L110
          CALL     TRCENC12
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUCENC12
          GOTO     CT03L105
CT03L110
          GOTO     CT03L999
CT03L115
CT03L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP03L000
          CALL     CT03L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP03L999
          MATCH    PRGID,SCPSPID
          GOTO     CP03L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP03L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP03L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP03L010,CP03L010,CP03L010,CP03L010:
                            CP03L010,CP03L010,CP03L010,CP03L010:
                            CP03L010,CP03L010,CP03L010,CP03L010:
                           CP03L010,CP03L010,CP03L100,CP03L100:
                            CP03L100,CP03L010,CP03L100,CP03L010:
                           CP03L010,CP03L010,CP03L010,CP03L010:
                           CP03L010,CP03L010,CP03L010,CP03L010:
                           CP03L010,CP03L010,CP03L010,CP03L010:
                            CP03L010,CP03L010,CP03L010,CP03L010:
                            CP03L010,CP03L010,CP03L010,CP03L010:
                            CP03L010,CP03L010,CP03L010,CP03L010:
                            CP03L010,CP03L010,CP03L010,CP03L010:
                            CP03L010,CP03L010,CP03L010,CP03L010:
                            CP03L010,CP03L010,CP03L010,CP03L010:
                            CP03L010,CP03L010,CP03L010,CP03L010:
                            CP03L010,CP03L010,CP03L010,CP03L010:
                            CP03L010,CP03L010,CP03L010,CP03L010:
                            CP03L010,CP03L010,CP03L010,CP03L010
.
CP03L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP03L010
CP03L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD03L000
          CALL      CP03L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD03L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD03L000
          MATCH     PRGID,SCPSPID
          GOTO      AD03L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD03L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD03L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM03L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "CENC1",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,CENC1AFL
            GOTO      AD03L010 IF EQUAL
            CALL      FP03L000
            GOTO      AD03L999
          ENDIF
AD03L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL03L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL03L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL03L900,DL03L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL03L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "CENC1",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRCENC11
            IF        OVRCD=0
              CALL      TDCENC12
            ELSE
              BEEP
              GOTO      DL03L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSCENC11
            CALL      TKCENC11
            MOVE     KEY7,CENC1NXT
            CALL      CT03L000
            MOVE      CENC1NXT,KEY7   
            CALL      TSCENC12
            CALL      TPCENC12
            CALL      DP03L000
            GOTO      DL03L005
          ENDIF
DL03L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL03L005
DL03L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Bed Type to Patient Serv.          
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    15 Patient Service Code               
.---------------------------------------------------------
TSCENC11  RESET     KEY5
          READ      CENC1FL1,KEY5;;
          RETURN
.
TSCENC12  RESET     KEY7   
          READ      CENC1FL2,KEY7;;
          RETURN
.
TACENC12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CENC1FL2,KEY7;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDCENC11  RESET     KEY5
          DELETE    CENC1FL1,KEY5
          RETURN
.
TDCENC12  RESET     KEY7
          DELETE    CENC1FL2,KEY7
          RETURN
.
TKCENC11  MOVE      ZERO,OVRCD
          READKS    CENC1FL1;SCTMROW,SCTMCOL,KEY7:
                        CENCBTY,CENCSPC,CENCPSC,CENCQTY,CENCSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TKCENC12  MOVE      ZERO,OVRCD
          READKS    CENC1FL2;SCTMROW,SCTMCOL,KEY7:
                        CENCBTY,CENCSPC,CENCPSC,CENCQTY,CENCSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCENC11  MOVE      ZERO,OVRCD
          READKP    CENC1FL1;SCTMROW,SCTMCOL,KEY7:
                        CENCBTY,CENCSPC,CENCPSC,CENCQTY,CENCSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCENC12  MOVE      ZERO,OVRCD
          READKP    CENC1FL2;SCTMROW,SCTMCOL,KEY7:
                        CENCBTY,CENCSPC,CENCPSC,CENCQTY,CENCSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCENC11  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      CENC1FL1,KEY5;SCTMROW,SCTMCOL,KEY7:
                        CENCBTY,CENCSPC,CENCPSC,CENCQTY,CENCSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCENC12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CENC1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CENCBTY,CENCSPC,CENCPSC,CENCQTY,CENCSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TUCENC11  UPDATE    CENC1FL1;SCTMROW,SCTMCOL,KEY7:
                        CENCBTY,CENCSPC,CENCPSC,CENCQTY,CENCSPA                 
          RETURN
.
TUCENC12
          UPDATE    CENC1FL2;SCTMROW,SCTMCOL,KEY7:
                        CENCBTY,CENCSPC,CENCPSC,CENCQTY,CENCSPA                 
          RETURN
.
TWCENC12  RESET     KEY7   
          WRITE     CENC1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CENCBTY,CENCSPC,CENCPSC,CENCQTY,CENCSPA                 
          RETURN
.---------------------------------------------------------
. Display Fields for : Bed Type to Patient Serv.          
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
          MOVE      "CENC1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      FP03L000
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Bed Type to Patient Serv.          
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L101,PS03L102:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999
          GOTO     PS03L999
.
PS03L101
          MOVE      TDESC,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      CESPDES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Bed Type to Patient Serv.          
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L103:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L006,SF03L104,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L006,SF03L105,SF03L106:
                            SF03L107,SF03L108,SF03L109,SF03L110:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L104,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          MOVE      "CENC1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L101
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L102
          CALL      POSC0000
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELC0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF03L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF03L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF03L999
          ENDIF
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF03L000
          ENDIF
          GOTO      SF03L001
.
SF03L104
          CALL      SELECTED
          BRANCH    EXIT,SF03L001
          MOVE      "CENC1",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRCENC11
            BRANCH    OVRCD,SF03L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF03L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF03L001 IF NOT EQUAL
            CALL      SM03L000 * Change Line
          ELSE
            IF        CENC1AFL=0
              MOVE      "CENC1",NAMSSFFI
              MOVE     "   15",ITMSSFFI
              CALL      AD03L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF03L001
.
SF03L105
          MOVE      "CENC1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      NP03L000
          GOTO     SF03L001
.
SF03L106
          MOVE      "CENC1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      PP03L000
          GOTO     SF03L001
.
SF03L107
          MOVE      "CENC1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      AD03L000
          GOTO     SF03L001
.
SF03L108
          MOVE      "CENC1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      DL03L000
          GOTO     SF03L001
.
SF03L109
          MOVE      "CENC1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L110
          MOVE      "CENC1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      LP03L000
          GOTO     SF03L001
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - DRG Nursing Cost Variation         
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : DRG Nursing Cost Variation         
.-------------------------------------------------------
CF04L000
          MOVE      SP70,CCCOCD1 
          MOVE      SP70,CCCOCD2 
          MOVE      SP70,CCCOCD3 
          MOVE      SP70,CCCOCD4 
          MOVE      SP70,CCCOCD5 
          MOVE      SP70,CENDDRGC
          MOVE      ZERO,CENDFC1 
          MOVE      ZERO,CENDFC2 
          MOVE      ZERO,CENDFC3 
          MOVE      ZERO,CENDFC4 
          MOVE      ZERO,CENDFC5 
          MOVE      SP70,CCDGDES 
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for DRG Nursing Cost Variation         
.--------------------------------------------------------
KY04L000
.
KY04L110
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCDGDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL      DISCTY00
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      EDRG0000
          BRANCH    EXIT,KY04L900,KY04L900
          MOVE      OVRCD,ACCEPT
          MOVE      CENDDRGC,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCDGDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : DRG Nursing Cost Variation         
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : DRG Nursing Cost Variation         
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : DRG Nursing Cost Variation         
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : DRG Nursing Cost Variation         
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L101,PS04L102:
                            PS04L103,PS04L104,PS04L105,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                           PS04L999,PS04L999,PS04L999,PS04L999:
                           PS04L999,PS04L999,PS04L999,PS04L999:
                           PS04L999,PS04L999,PS04L106,PS04L107:
                            PS04L108,PS04L109,PS04L110,PS04L111
          GOTO     PS04L999
.
PS04L101
          MOVE      CCCOCD1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      CCCOCD2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      CCCOCD3,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L104
          MOVE      CCCOCD4,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L105
          MOVE      CCCOCD5,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L106
          MOVE      CENDFC1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L107
          MOVE      CENDFC2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L108
          MOVE      CENDFC3,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L109
          MOVE      CENDFC4,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L110
          MOVE      CENDFC5,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L111
          MOVE      CCDGDES,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : DRG Nursing Cost Variation         
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L102:
                            SF04L103,SF04L104,SF04L006,SF04L006:
                           SF04L006,SF04L006,SF04L006,SF04L006:
                           SF04L006,SF04L006,SF04L006,SF04L006:
                           SF04L006,SF04L006,SF04L105,SF04L106:
                            SF04L107,SF04L108,SF04L109,SF04L006
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L105,SF04L106:
                            SF04L107,SF04L108,SF04L109,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L102
          CALL      POSD0000
          MOVE      ONE,EXIT
          GOTO      SF04L999
.
SF04L103
          MOVE      ONE,EXIT
          GOTO      SF04L999
.
SF04L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELD0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF04L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF04L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF04L999
          ENDIF
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF04L000
          ENDIF
          GOTO      SF04L001
.
SF04L105
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CENDFC1 
          IF        SCPSMAN=1
            COMPARE   ZERO,CENDFC1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L105
            ENDIF
          ENDIF
          MOVE      CENDFC1,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L106
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CENDFC2 
          IF        SCPSMAN=1
            COMPARE   ZERO,CENDFC2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L106
            ENDIF
          ENDIF
          MOVE      CENDFC2,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L107
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CENDFC3 
          IF        SCPSMAN=1
            COMPARE   ZERO,CENDFC3 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L107
            ENDIF
          ENDIF
          MOVE      CENDFC3,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L108
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CENDFC4 
          IF        SCPSMAN=1
            COMPARE   ZERO,CENDFC4 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L108
            ENDIF
          ENDIF
          MOVE      CENDFC4,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L109
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CENDFC5 
          IF        SCPSMAN=1
            COMPARE   ZERO,CENDFC5 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L109
            ENDIF
          ENDIF
          MOVE      CENDFC5,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
SF04L990  MOVE      ONE,EXIT * Exit Char Restart
SF04L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------
. Read Patient Service Description
.------------------------------------------------------------
RPSC0000  MATCH     "01",SCRID
          IF        @EQUAL
            PACK      KEY7,CENAPSC
          ELSE
            PACK      KEY7,CENCPSC
          ENDIF
          CALL      RDCEPS1
          IF        OVRCD=1
            MOVE      "Invalid",CEPSDES
          ENDIF
          RETURN
.------------------------------------------------------------
. Save Ward/Patient Service Mapping
.------------------------------------------------------------
POSA0000  PACK      KEY13,WWARD,CESPSPC,SP70                           * V90200
          CALL      RSCENA1
POSA1000  CALL      RKCENA1                * Delete all Patient Services
          BRANCH    OVRCD,POSA1900
          MATCH     WWARD,CENAWRD                                      * V90200
          GOTO      POSA1900 IF NOT EQUAL
          MATCH     CESPSPC,CENASPC
          GOTO      POSA1900 IF NOT EQUAL
          PACK      KEY13,CENAWRD,CENASPC,CENAPSC
          CALL      DECENA1
          GOTO      POSA1000
.
. Insert New Patient Services
.-----------------------------
POSA1900  MOVE      SP70,KEY5
          CALL      TRCENA11
          COMPARE   ZERO,OVRCD
          GOTO      POSA2100 IF EQUAL
.
POSA2000  CALL      TKCENA11
          BRANCH    OVRCD,POSA2900
.
POSA2100  MOVE      WWARD,CENAWRD                                      * V90200
          MOVE      CESPSPC,CENASPC
          PACK      KEY13,CENAWRD,CENASPC,CENAPSC
          CALL      RACENA1
          IF        OVRCD=0
            CALL      UPCENA1
          ELSE
            CALL      WRCENA1
          ENDIF
          GOTO      POSA2000
POSA2900
POSA9999  RETURN
.------------------------------------------------------------
. Delete Ward/Patient Service Mapping
.------------------------------------------------------------
DELA0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DELA1000,DELA9000,DELA9100
.
DELA1000  PACK     KEY13,WWARD,CESPSPC,SP70                            * V90200
          CALL     RSCENA1
DELA1100  CALL     RKCENA1                * Delete all Patient Services
          BRANCH   OVRCD,DELA1900
          MATCH    WWARD,CENAWRD                                       * V90200
          GOTO     DELA1900 IF NOT EQUAL
          MATCH    CESPSPC,CENASPC
          GOTO     DELA1900 IF NOT EQUAL
          PACK     KEY13,CENAWRD,CENASPC,CENAPSC
          CALL     DECENA1
          GOTO     DELA1100
.
DELA1900  MOVE     TWO,EXIT            * Restart Screen
          GOTO     DELA9999
DELA9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DELA9999
DELA9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DELA9999
DELA9999  RETURN
.
.------------------------------------------------------------
. Copy Patient Service Mappings
.------------------------------------------------------------
COPA0000  MOVE      CENAWRD,SAVEWRD
          MOVE      CENASPC,SAVESPC
.
          CALL      POSA0000
.
          DISPLAY   *P1:12,*EF
          HLINE     *G37,12,1,80
          DISPLAY   *P1:14,*V2LON,*ULON,"Copy Patient Services",*HOFF:
                    *P1:16,*V2LON," 0.",*HOFF," Exit":
                    *P1:17,*V2LON," 1.",*HOFF," From Another Ward":
                    *P1:18,*V2LON," 2.",*HOFF," To a Range of Wards"
          KEYIN     *P1:20,"Select Option : ",*V2LON,F1
          COMPARE   ZERO,F1
          GOTO      COPA9999 IF EQUAL
          BRANCH    F1,COPA1000,COPA2000
          BEEP
          GOTO      COPA0000
.
. From Another Ward
.
COPA1000  MOVE      ZERO,CKEYTYP
          DISPLAY   *P1:22,"Copy From Ward : "
          MOVE      "18",CCOL
          MOVE      "22",CVERT
          CALL      KPWR1A00                                          * V90200
          BRANCH    EXIT,COPA9000,COPA9000
          DISPLAY   *P16:22,*V2LON,WWARD,*HOFF,SP1,WBDESC             * V90200
.
          DISPLAY   *P1:23,"Copy Details for All Service Providers (":
                            *V2LON,"Y",*HOFF,"/":
                            *V2LON,"N",*HOFF,") ? "
          MOVE      "48",CCOL
          MOVE      "23",CVERT
          CALL      YORN0000
          MOVE      FYESNO,COPYALL
.
          DISPLAY   *P1:24,"Post Copy (",*V2LON,"Y",*HOFF,"/":
                                                  *V2LON,"N",*HOFF,") ? "
          MOVE      "19",CCOL
          MOVE      "24",CVERT
          CALL      YORN0000
          COMPARE   ONE,FYESNO
          GOTO      COPA9000 IF NOT EQUAL
.
          MOVE      WWARD,FROMWRD                                     * V90200
          MOVE      SAVEWRD,TOWRD
          CALL      CWRD0000
          GOTO      COPA9000
.
. Copy This Ward To a Range of Wards
.
COPA2000  DISPLAY   *P1:12,*EF
          HLINE     *G37,15,1,80
          DISPLAY   *P1:17,*V2LON,*ULON:
                    "Copy Patient Services to a Range of Wards",*HOFF:
                    *P1:19,"    Ward From : ":
                    *P1:20,"         To   : "
          MOVE      "17",CCOL
          MOVE      "19",CVERT
          MOVE      ZERO,CKEYTYP
          CALL      KPWR1A00                                           * V90200
          BRANCH    EXIT,COPA9000,COPA9000
          MOVE      WWARD,STRWRD                                       * V90200
          DISPLAY   *PCCOL:CVERT,*V2LON,WWARD,*HOFF,SP1,WBDESC         * V90200
.
          COMPARE   ZERO,F1
          MOVE      "17",CCOL
          MOVE      "20",CVERT
          MOVE      ZERO,CKEYTYP
          CALL      KPWR1A00                                           * V90200
          BRANCH    EXIT,COPA9000,COPA9000
          MOVE      WWARD,ENDWRD                                       * V90200
          DISPLAY   *PCCOL:CVERT,*V2LON,WWARD,*HOFF,SP1,WBDESC         * V90200
.
          MATCH     STRWRD,ENDWRD
          GOTO      COPA2100 IF EQUAL
          GOTO      COPA2100 IF NOT LESS
          BEEP
          MOVE      "To Ward Must Be > From Ward - ",DISPMSG
          CALL      MESSAGE1
          GOTO      COPA2000
.
COPA2100  DISPLAY   *P1:23,"Copy Details for All Service Providers (":
                            *V2LON,"Y",*HOFF,"/":
                            *V2LON,"N",*HOFF,") ? "
          MOVE      "48",CCOL
          MOVE      "23",CVERT
          CALL      YORN0000
          MOVE      FYESNO,COPYALL
.
          DISPLAY   *P1:24,"Post Copy (",*V2LON,"Y",*HOFF,"/":
                                                  *V2LON,"N",*HOFF,") ? "
          MOVE      "19",CCOL
          MOVE      "24",CVERT
          CALL      YORN0000
          COMPARE   ONE,FYESNO
          GOTO      COPA9000 IF NOT EQUAL
.
          PACK      KEY6,SP3,STRWRD,SP70
          CALL      RDWARD3                                            * V90200
          IF        OVRCD=0
            CALL      RDPWARD3                                         * V90200
          ENDIF
COPA2200  CALL      RDKWARD3                                           * V90200
          BRANCH    OVRCD,COPA9000
          MATCH     SP70,WBED                                          * V90200
          GOTO      COPA9000 IF NOT EQUAL
          MATCH     WWARD,ENDWRD                                       * V90200
          GOTO      COPA9000 IF LESS
          MOVE      SAVEWRD,FROMWRD
          MOVE      WWARD,TOWRD                                        * V90200
          CALL      CWRD0000
          GOTO      COPA2200
.
COPA9000  MOVE      SAVEWRD,CENAWRD
          MOVE      SAVESPC,CENASPC
          MOVE      SAVEWRD,WWARD                                      * V90200
          MOVE      SAVESPC,CESPSPC
          PACK      KEY6,WWARD,SP70                                    * V90200
          CALL      RDWARD1                                            * V90200
          PACK      KEY3,CESPSPC,SP70
          CALL      RDCESP1
.
COPA9999  RETURN
.------------------------------------------------------------
. Copy a Wards Details
. From Ward = FROMWRD
. To   Ward = TOWRD
. All Service Providers 1=Yes
.------------------------------------------------------------
CWRD0000  IF        COPYALL=1
            PACK      KEY13,FROMWRD,SP70
          ELSE
            PACK      KEY13,FROMWRD,SAVESPC,SP70
          ENDIF
          CALL      RSCENA1
CWRD1000  CALL      RKCENA1
          BRANCH    OVRCD,CWRD9999
          MATCH     FROMWRD,CENAWRD
          GOTO      CWRD9999 IF NOT EQUAL
          BRANCH    COPYALL,CWRD1100
          MATCH     SAVESPC,CENASPC
          GOTO      CWRD9999 IF NOT EQUAL
.
CWRD1100  PACK      KEY13,TOWRD,CENASPC,CENAPSC
          UNPACK    KEY13,CENAWRD,CENASPC,CENAPSC
          CALL      RACENA1
          IF        OVRCD=0
              CALL      UPCENA1
          ELSE
              CALL      WRCENA1
          ENDIF
          PACK      KEY13,FROMWRD,CENASPC,CENAPSC
          CALL      RDCENA1
          GOTO      CWRD1000
CWRD9999  RETURN
.
.------------------------------------------------------------
. Display Cost Component Types
.------------------------------------------------------------
DISCTY00  MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            PACK      VAR,CCCOCD1,SP70
            CALL      DISPITEM
          ENDIF
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            PACK      VAR,CCCOCD2,SP70
            CALL      DISPITEM
          ENDIF
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            PACK      VAR,CCCOCD3,SP70
            CALL      DISPITEM
          ENDIF
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            PACK      VAR,CCCOCD4,SP70
            CALL      DISPITEM
          ENDIF
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            PACK      VAR,CCCOCD5,SP70
            CALL      DISPITEM
          ENDIF
.
          RETURN

.-------------------------------------------------------------
. Save Adm Factors
.-------------------------------------------------------------
POSB0000  PACK     KEY6,CENBATY,CENBWRD,SP70
          CALL     RACENB1            * Check for record on file
          IF       OVRCD=0
            CALL     UPCENB1          * Update Changes
          ELSE
            CALL     WRCENB1          * Write New Record
          ENDIF
          RETURN                      * Return to program.
.-------------------------------------------------------------
. Delete Adm Factors
.-------------------------------------------------------------
DELB0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DELB1000,DELB9000,DELB9100
.
DELB1000  PACK     KEY6,CENBATY,CENBWRD,SP70
          CALL     RACENB1             * Read Record
          IF       OVRCD=0
            CALL     DECENB1           * Delete Record
          ENDIF
          MOVE     TWO,EXIT            * Restart Screen
          GOTO     DELB9999
DELB9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DELB9999
DELB9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DELB9999
DELB9999  RETURN
.---------------------------------------------------
. Copy Admission Type Factors to a Range of Wards
.---------------------------------------------------
COPB0000  MOVE      CENBATY,SAVEATY
          MOVE      CENBWRD,SAVEWRD
          MOVE      CENBFC1,SAVEFC1
          MOVE      CENBFC2,SAVEFC2
          MOVE      CENBFC3,SAVEFC3
          MOVE      CENBFC4,SAVEFC4
          MOVE      CENBFC5,SAVEFC5
.
          CALL      POSB0000
.
          DISPLAY   *P1:15,*EF
          HLINE     *G37,15,1,80
          DISPLAY   *P1:17,*V2LON,*ULON:
                    "Copy Factors to a Range of Wards",*HOFF:
                    *P1:19,"    Ward From : ":
                    *P1:20,"         To   : "
          MOVE      "17",CCOL
          MOVE      "19",CVERT
          MOVE      ZERO,CKEYTYP
          CALL      KPWR1A00                                           * V90200
          BRANCH    EXIT,COPB9000,COPB9000
          MOVE      WWARD,STRWRD                                       * V90200
          DISPLAY   *PCCOL:CVERT,*V2LON,WWARD,*HOFF,SP1,WBDESC         * V90200
.
          COMPARE   ZERO,F1
          MOVE      "17",CCOL
          MOVE      "20",CVERT
          MOVE      ZERO,CKEYTYP
          CALL      KPWR1A00                                           * V90200
          BRANCH    EXIT,COPB9000,COPB9000
          MOVE      WWARD,ENDWRD                                       * V90200
          DISPLAY   *PCCOL:CVERT,*V2LON,WWARD,*HOFF,SP1,WBDESC         * V90200
.
          MATCH     STRWRD,ENDWRD
          GOTO      COPB0100 IF EQUAL
          GOTO      COPB0100 IF NOT LESS
          BEEP
          MOVE      "To Ward Must Be > From Ward - ",DISPMSG
          CALL      MESSAGE1
          GOTO      COPB0000
.
COPB0100  DISPLAY   *P1:24,"This will overwrite existing Factors. ":
                    "Post Copy (",*V2LON,"Y",*HOFF,"/":
                                  *V2LON,"N",*HOFF,") ? "
          MOVE      "19",CCOL
          MOVE      "24",CVERT
          CALL      YORN0000
          COMPARE   ONE,FYESNO
          GOTO      COPB9000 IF NOT EQUAL
.
          PACK      KEY6,SP3,STRWRD,SP70
          CALL      RDWARD3                                            * V90200
          IF        OVRCD=0
            CALL      RDPWARD3                                         * V90200
          ENDIF
COPB1000  CALL      RDKWARD3                                           * V90200
          BRANCH    OVRCD,COPB1900
          MATCH     SP70,WBED                                          * V90200
          GOTO      COPB1900 IF NOT EQUAL
          MATCH     WWARD,ENDWRD                                       * V90200
          GOTO      COPB1900 IF LESS
.
          PACK      KEY6,SAVEATY,WWARD                                 * V90200
          UNPACK    KEY6,CENBATY,CENBWRD
          MOVE      SAVEFC1,CENBFC1
          MOVE      SAVEFC2,CENBFC2
          MOVE      SAVEFC3,CENBFC3
          MOVE      SAVEFC4,CENBFC4
          MOVE      SAVEFC5,CENBFC5
          CALL      RACENB1
          IF        OVRCD=0
            CALL      UPCENB1
          ELSE
            CALL      WRCENB1
          ENDIF
          GOTO      COPB1000
.
COPB1900  MOVE      "Copy Complete - ",DISPMSG
          CALL      MESSAGE1
.
COPB9000  MOVE      "3",EXIT
          MOVE      SAVEATY,CENBATY
          MOVE      SAVEWRD,CENBWRD
          MOVE      SAVEFC1,CENBFC1
          MOVE      SAVEFC2,CENBFC2
          MOVE      SAVEFC3,CENBFC3
          MOVE      SAVEFC4,CENBFC4
          MOVE      SAVEFC5,CENBFC5
.
COPB9999  RETURN
.---------------------------------------------------
. Copy Admission Type Factors to a Range of Wards
.---------------------------------------------------
ADMC0000  MOVE      CENBATY,SAVEATY
          MOVE      CENBWRD,SAVEWRD
          MOVE      CENBFC1,SAVEFC1
          MOVE      CENBFC2,SAVEFC2
          MOVE      CENBFC3,SAVEFC3
          MOVE      CENBFC4,SAVEFC4
          MOVE      CENBFC5,SAVEFC5
.
          DISPLAY   *P1:15,*EF
          HLINE     *G37,15,1,80
          DISPLAY   *P1:17,*V2LON,*ULON:
                    "Copy Factors to a Range of Admission Types",*HOFF:
                    *P1:19,"    Admission Type From : ":
                    *P1:20,"                   To   : "
          MOVE      "27",CCOL
          MOVE      "19",CVERT
          MOVE      "A ",TCODE                                         * V90200
          MOVE      ZERO,CKEYTYP
          CALL      KPCODA00                                           * V90200
          BRANCH    EXIT,ADMC9000,ADMC9000
          MOVE      ACODE,STRCOD                                       * V90200
          DISPLAY   *PCCOL:CVERT,*V2LON,ACODE,*HOFF,SP1,TDESC          * V90200
.
          COMPARE   ZERO,F1
          MOVE      "27",CCOL
          MOVE      "20",CVERT
          MOVE      "A ",TCODE                                         * V90200
          MOVE      ZERO,CKEYTYP
          CALL      KPCODA00                                           * V90200
          BRANCH    EXIT,ADMC9000,ADMC9000
          MOVE      ACODE,ENDCOD                                       * V90200
          DISPLAY   *PCCOL:CVERT,*V2LON,ACODE,*HOFF,SP1,TDESC          * V90200
.
          MATCH     STRCOD,ENDCOD
          GOTO      ADMC0100 IF EQUAL
          GOTO      ADMC0100 IF NOT LESS
          BEEP
          MOVE      "To Code Must Be > From Code - ",DISPMSG
          CALL      MESSAGE1
          GOTO      ADMC0000
.
ADMC0100  DISPLAY   *P1:24,"This will overwrite existing Factors. ":
                    "Post Copy (",*V2LON,"Y",*HOFF,"/":
                                  *V2LON,"N",*HOFF,") ? "
          MOVE      "57",CCOL
          MOVE      "24",CVERT
          CALL      YORN0000
          COMPARE   ONE,FYESNO
          GOTO      ADMC9000 IF NOT EQUAL
.
          MOVE      "A ",TCODE                                         * V90200
          PACK      KEY5,TCODE,STRCOD,SP70                             * V90200
          CALL      RDCODE1
          IF        OVRCD=0
            CALL      RDPCODE1
          ENDIF
ADMC1000  CALL      RDKCODE1
          BRANCH    OVRCD,ADMC1900
          MATCH     "A ",TCODE                                         * V90200
          GOTO      ADMC1900 IF NOT EQUAL
          MATCH     ACODE,ENDCOD                                       * V90200
          GOTO      ADMC1900 IF LESS
.
          PACK      KEY6,ACODE,SAVEWRD                                 * V90200
          UNPACK    KEY6,CENBATY,CENBWRD
          MOVE      SAVEFC1,CENBFC1
          MOVE      SAVEFC2,CENBFC2
          MOVE      SAVEFC3,CENBFC3
          MOVE      SAVEFC4,CENBFC4
          MOVE      SAVEFC5,CENBFC5
          CALL      RACENB1
          IF        OVRCD=0
            CALL      UPCENB1
          ELSE
            CALL      WRCENB1
          ENDIF
          GOTO      ADMC1000
.
ADMC1900  MOVE      "Copy Complete - ",DISPMSG
          CALL      MESSAGE1
.
ADMC9000  MOVE      "3",EXIT
          MOVE      SAVEATY,CENBATY
          MOVE      SAVEWRD,CENBWRD
          MOVE      SAVEFC1,CENBFC1
          MOVE      SAVEFC2,CENBFC2
          MOVE      SAVEFC3,CENBFC3
          MOVE      SAVEFC4,CENBFC4
          MOVE      SAVEFC5,CENBFC5
.
ADMC9999  RETURN
.------------------------------------------------------------
. Enter Admission Type
.------------------------------------------------------------
KATY0000  MOVE      "A ",TCODE                                         * V90200
          MOVE      ZERO,CKEYTYP
          CALL      KPCODA00                                           * V90200
          BRANCH    EXIT,KATY0099,KATY0099
          MOVE      ACODE,CENBATY                                      * V90200
KATY0099  RETURN

.------------------------------------------------------------
. Enter Ward
.------------------------------------------------------------
KWRD0000  MOVE      ZERO,CKEYTYP
          CALL      KPWR1A00                                           * V90200
          BRANCH    EXIT,KWRD9999,KWRD9999
          MOVE      WWARD,CENBWRD                                      * V90200
.
          PACK      KEY6,CENBATY,CENBWRD
          CALL      RDCENB1
          IF        OVRCD=1
            MOVE      ONE,CENBFC1
            MOVE      ONE,CENBFC2
            MOVE      ONE,CENBFC3
            MOVE      ONE,CENBFC4
            MOVE      ONE,CENBFC5
          ENDIF
.
KWRD9999  RETURN

.------------------------------------------------------------
. Save Bed Type Service Mapping
.------------------------------------------------------------
POSC0000  PACK      KEY13,ACODE,CESPSPC,SP70                           * V90200
          CALL      RSCENC1
POSC1000  CALL      RKCENC1                * Delete all Patient Services
          BRANCH    OVRCD,POSC1900
          MATCH     ACODE,CENCBTY                                      * V90200
          GOTO      POSC1900 IF NOT EQUAL
          MATCH     CESPSPC,CENCSPC
          GOTO      POSC1900 IF NOT EQUAL
          PACK      KEY13,CENCBTY,CENCSPC,CENCPSC
          CALL      DECENC1
          GOTO      POSC1000
.
. Insert New Patient Services
.-----------------------------
POSC1900  MOVE      SP70,KEY5
          CALL      TRCENC11
          COMPARE   ZERO,OVRCD
          GOTO      POSC2100 IF EQUAL
.
POSC2000  CALL      TKCENC11
          BRANCH    OVRCD,POSC2900
.
POSC2100  MOVE      ACODE,CENCBTY                                      * V90200
          MOVE      CESPSPC,CENCSPC
          PACK      KEY13,CENCBTY,CENCSPC,CENCPSC
          CALL      RACENC1
          IF        OVRCD=0
            CALL      UPCENC1
          ELSE
            CALL      WRCENC1
          ENDIF
          GOTO      POSC2000
POSC2900
POSC9999  RETURN
.
.------------------------------------------------------------
. Delete Bed Type Service Mapping
.------------------------------------------------------------
DELC0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DELC1000,DELC9000,DELC9100
.
DELC1000  PACK     KEY13,ACODE,CESPSPC,SP70                            * V90200
          CALL     RSCENC1
DELC1100  CALL     RKCENC1                * Delete all Patient Services
          BRANCH   OVRCD,DELC1900
          MATCH    ACODE,CENCBTY                                       * V90200
          GOTO     DELC1900 IF NOT EQUAL
          MATCH    CESPSPC,CENCSPC
          GOTO     DELC1900 IF NOT EQUAL
.
          PACK     KEY13,CENCBTY,CENCSPC,CENCPSC
          CALL     DECENC1
          GOTO     DELC1100
.
DELC1900  MOVE     TWO,EXIT            * Restart Screen
          GOTO     DELC9999
DELC9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DELC9999
DELC9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DELC9999
DELC9999  RETURN
.
.------------------------------------------------------------
. Enter Bed Type
.------------------------------------------------------------
EBTYP000  MOVE      "BT",TCODE                                         * V90200
          MOVE      ZERO,CKEYTYP
          CALL      KPCODA00                                           * V90200
          BRANCH    EXIT,EBTYP999,EBTYP999
          MOVE      ACODE,CENCBTY                                      * V90200
EBTYP999  RETURN

.-------------------------------------------------------------
. Save DRG Factors
.-------------------------------------------------------------
POSD0000  PACK     KEY4,CENDDRGC,SP70
          CALL     RACEND1            * Check for record on file
          IF       OVRCD=0
            CALL     UPCEND1          * Update Changes
          ELSE
            CALL     WRCEND1          * Write New Record
          ENDIF
          RETURN                      * Return to program.
.
.-------------------------------------------------------------
. Delete DRG Factors
.-------------------------------------------------------------
DELD0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DELD1000,DELD9000,DELD9100
.
DELD1000  PACK     KEY4,CENDDRGC,SP70
          CALL     RACEND1             * Read Record
          IF       OVRCD=0
            CALL     DECEND1           * Delete Record
          ENDIF
          MOVE     TWO,EXIT            * Restart Screen
          GOTO     DELD9999
DELD9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DELD9999
DELD9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DELD9999
DELD9999  RETURN
.
.------------------------------------------------------------
. Enter DRG Code
.------------------------------------------------------------
EDRG0000  MOVE      ZERO,CKEYTYP
          CALL      KCCDGA00
          BRANCH    EXIT,EDRG9999,EDRG9999
          MOVE      CCDGDRGC,CENDDRGC
          MOVE      CCDGDRGC,KEY4
          CALL      RDCEND1
          IF        OVRCD=1
            MOVE      ONE,CENDFC1
            MOVE      ONE,CENDFC2
            MOVE      ONE,CENDFC3
            MOVE      ONE,CENDFC4
            MOVE      ONE,CENDFC5
          ENDIF
.
EDRG9999  RETURN

.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CCSCONIO/INC
          INC       CCSDRGIO/INC
          INC       CCSDRGKY    
          INC       CEACODKY    
          INC       CEANAMIO/INC
          INC       CEANBMIO/INC
          INC       CEANCMIO/INC
          INC       CEANDMIO/INC
          INC       CEAPSCIO/INC
          INC       CEAPSCKY    
          INC       CEASPCIO/INC
          INC       CEASPCKY    
          INC       CEAWRDKY    
          INC       PATCODIO/INC
          INC       PATWR1IO/INC
.
          INC       STDGENCD
.
