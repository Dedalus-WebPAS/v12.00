.-------------------------------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.01  09.07.2002  Glenn Saunders
.           Recompile for changes in includes shared with Southland, but with
.           previously different formats - now merged.  Includes effected :-
.           CCSCEAFD, CCSCONFD, CCSEPSFD, CCSHCDFD, CCSHLCFD, CCSIADFD
.-------------------------------------------------------
. V9.02.00  14.06.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.           Remove PSN prefixed PAS cloned includes
.-------------------------------------------------------
. VF.09.01  18.12.2001 Glenn Saunders  srf:14575
.           Recompile for changes in CCSG58CD
. VF.09.B01 22.11.2000 Sandra Barcham
.           Allow for changed ccsepsaf
.-------------------------------------------------------
. V6.06.01  15.12.1999 Charles Handaya
.           Fixed DRG Codes
.-------------------------------------------------------
. V6.03.00  02.10.1995 B.G.Ackland
.           Release 6.03
. V6.03.02  30.10.1995 B.G.Ackland
.           Phase 1 WGH Changes
.-------------------------------------------------------
. V6.01.03  13.07.1995 B.G.Ackland
.           Added Casemix Type 58 & 59 for 1st & 2nd Theatre Band
. V6.01.01  20.06.1995 B.G.Ackland
.           Added Casemix Type 56 & 57 for Day of Adm & Dis
. V6.01.00  30.12.1993 B.G.Ackland
.           New Patient Service Costing Analysis
.-------------------------------------------------------
. V6.00.02  16.12.1993 B.G.Ackland
.           Add Day Case Only Option
. V6.00.01  08.11.1993 B.G.Ackland
.           Fix Casemix Type 15 to CCEPASER Not CCEPDSER
.           Use include CCSGETCD
.-------------------------------------------------------------------------------
BEDCALC   FORM      1
COMMAND   DIM       80
CSTB01    FORM      6.2
CSTB02    FORM      6.2
CSTB03    FORM      6.2
CSTB04    FORM      6.2
CSTB05    FORM      6.2
CSTB06    FORM      6.2
CSTB07    FORM      6.2
CSTB08    FORM      6.2
CSTB09    FORM      6.2
CSTB10    FORM      6.2
CSTB11    FORM      6.2
CSTB12    FORM      6.2
CSTB13    FORM      6.2
CSTB14    FORM      6.2
CSTB15    FORM      6.2
CSTICU    FORM      6.2
CSTINCI   FORM      1
CSTUTH    FORM      1
EXCOMPS   FORM      1
EXTRSUMM  FORM      1
F12P4     FORM      12.4
FILENAME  DIM       8
FLAGCEAS  FORM      1
INCB01    FORM      6.2
INCB02    FORM      6.2
INCB03    FORM      6.2
INCB04    FORM      6.2
INCB05    FORM      6.2
INCB06    FORM      6.2
INCB07    FORM      6.2
INCB08    FORM      6.2
INCB09    FORM      6.2
INCB10    FORM      6.2
INCB11    FORM      6.2
INCB12    FORM      6.2
INCB13    FORM      6.2
INCB14    FORM      6.2
INCB15    FORM      6.2
INCICU    FORM      6.2
INCINCI   FORM      1
INCUTH    FORM      1
NEWFROM   DIM       8
NEWTO     DIM       8
PATMBSOP  FORM      1
PDIA01    DIM       9
POPP01    DIM       9
SDIA01    DIM       9
SOPP01    DIM       9
THEBAND   DIM       10
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACIA53
.   Function      :   Casemix Extract Update                  
.   Generated  On :   09/07/2002
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CCSAGEFD/INC
          INC       CCSCEAFD/INC
          INC       CCSCEBFD/INC
          INC       CCSCECFD/INC
          INC       CCSCEDFD/INC
          INC       CCSCEEFD/INC
          INC       CCSCEFFD/INC
          INC       CCSCEGFD/INC
          INC       CCSCEXFD/INC
          INC       CCSCONFD/INC
          INC       CCSDRGFD/INC
          INC       CCSEPSFD/INC
          INC       CCSEYAFD/INC
          INC       CCSHCDFD/INC
          INC       CCSIADFD/INC
          INC       CCSSTYFD/INC
          INC       CCSXHDFD/INC
          INC       CEAPMDFD/INC
          INC       CEAPPMFD/INC
          INC       CEASPCFD/INC
          INC       PATITMFD/INC
.=========================
.Local Variable Definition
.-------------------------
FROMNEW   DIM      10 * Scr 00 Fld    18
TONEW     DIM      10 * Scr 00 Fld    19
FROMAD    DIM      10 * Scr 00 Fld    20
TOAD      DIM      10 * Scr 00 Fld    21
VISITDES  DIM      15 * Scr 00 Fld    22
TOTALEPS  FORM      6 * Scr 00 Fld    27
TOTALEXT  FORM      6 * Scr 00 Fld    28
EXTRBRAN  FORM      3 * Scr 00 Fld    29
CLV1DES   DIM      35 * Scr 00 Fld    30
CLV2DES   DIM      35 * Scr 00 Fld    31
CLV3DES   DIM      35 * Scr 00 Fld    32
COST1AMT  FORM     12.2 * Scr 00 Fld    33
COST2AMT  FORM     12.2 * Scr 00 Fld    34
EPISODE   FORM      1 * Scr 00 Fld    35
EXSTR     DIM      10 * Scr 00 Fld    37
EXEND     DIM      10 * Scr 00 Fld    38
AGERANGE  DIM       3 * Scr 00 Fld    39
FROMDD    DIM      10 * Scr 00 Fld    40
TODD      DIM      10 * Scr 00 Fld    41
DAYCDESC  DIM      25 * Scr 00 Fld    42
CASPAYTP  DIM       1 * Scr 00 Fld    43
DESC01    DIM      35 * Scr 01 Fld     5
FROM01    DIM      35 * Scr 01 Fld     6
TO01      DIM      35 * Scr 01 Fld     7
DESC02    DIM      35 * Scr 01 Fld     8
FROM02    DIM      35 * Scr 01 Fld     9
TO02      DIM      35 * Scr 01 Fld    10
DESC03    DIM      35 * Scr 01 Fld    11
FROM03    DIM      35 * Scr 01 Fld    12
TO03      DIM      35 * Scr 01 Fld    13
DESC04    DIM      35 * Scr 01 Fld    14
FROM04    DIM      35 * Scr 01 Fld    15
TO04      DIM      35 * Scr 01 Fld    16
DESC05    DIM      35 * Scr 01 Fld    17
FROM05    DIM      35 * Scr 01 Fld    18
TO05      DIM      35 * Scr 01 Fld    19
DESC06    DIM      35 * Scr 01 Fld    20
FROM06    DIM      35 * Scr 01 Fld    21
TO06      DIM      35 * Scr 01 Fld    22
DESC07    DIM      35 * Scr 01 Fld    23
FROM07    DIM      35 * Scr 01 Fld    24
TO07      DIM      35 * Scr 01 Fld    25
DESC08    DIM      35 * Scr 01 Fld    26
FROM08    DIM      35 * Scr 01 Fld    27
TO08      DIM      35 * Scr 01 Fld    28
DESC09    DIM      35 * Scr 01 Fld    29
FROM09    DIM      35 * Scr 01 Fld    30
TO09      DIM      35 * Scr 01 Fld    31
DESC10    DIM      35 * Scr 01 Fld    32
FROM10    DIM      35 * Scr 01 Fld    33
TO10      DIM      35 * Scr 01 Fld    34
DESC11    DIM      35 * Scr 01 Fld    35
FROM11    DIM      35 * Scr 01 Fld    36
TO11      DIM      35 * Scr 01 Fld    37
DESC12    DIM      35 * Scr 01 Fld    38
FROM12    DIM      35 * Scr 01 Fld    39
TO12      DIM      35 * Scr 01 Fld    40
DESC13    DIM      35 * Scr 01 Fld    41
FROM13    DIM      35 * Scr 01 Fld    42
TO13      DIM      35 * Scr 01 Fld    43
DESC14X   DIM      35 * Scr 01 Fld    44
FROM14    DIM      35 * Scr 01 Fld    45
TO14      DIM      35 * Scr 01 Fld    46
EXRANGE   FORM      1 * Scr 01 Fld    50
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACIA53"
PRGNAM    INIT      "Casemix Extract Update                  "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening ccsageaf";
          OPEN      CCSAGEA1,"ccsageaf"
          DISPLAY   *P56:24,"Opening ccsageaf";
          OPEN      CCSAGEA2,"ccsageaf"
          MOVE      "   64",AUDTSECT
          MOVE      " 38",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ccsaudia";
            OPEN      CCSAUDIA,"ccsaudia"
          ENDIF
          DISPLAY   *P56:24,"Opening ccsceaaf";
          OPEN      CCSCEAA1,"ccsceaaf"
          DISPLAY   *P56:24,"Opening ccscexaf";
          OPEN      CCSCEXA1,"ccscexaf"
          DISPLAY   *P56:24,"Opening ccsdrgaf";
          OPEN      CCSDRGA1,"ccsdrgaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA1,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA2,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA3,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA4,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA5,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccseyaaf";
          OPEN      CCSEYAA1,"ccseyaaf"
          DISPLAY   *P56:24,"Opening ccshcdaf";
          OPEN      CCSHCDA1,"ccshcdaf"
          DISPLAY   *P56:24,"Opening ccshcdaf";
          OPEN      CCSHCDA2,"ccshcdaf"
          DISPLAY   *P56:24,"Opening ccsiadaf";
          OPEN      CCSIADA1,"ccsiadaf"
          DISPLAY   *P56:24,"Opening ccsstyaf";
          OPEN      CCSSTYA1,"ccsstyaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA1,"ccsxhdaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA2,"ccsxhdaf"
          DISPLAY   *P56:24,"Opening ceapmdaf";
          OPEN      CEAPMDA1,"ceapmdaf"
          DISPLAY   *P56:24,"Opening ceappmaf";
          OPEN      CEAPPMA1,"ceappmaf"
          DISPLAY   *P56:24,"Opening  patitemn           ";
          OPEN      PATITEM1,"patitemn"          
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Options                            
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Range Options for Casemix Analysis 
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Analysis Measure Display           
          ENDIF
          RETURN
.--------------------------------
. Screen - Options                            
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Options                            
.-------------------------------------------------------
CF00L000
          MOVE      SP70,CCEAEID 
          MOVE      SP70,FROMNEW 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Options                            
.--------------------------------------------------------
KY00L000
.
KY00L110
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EEID0000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      CCEAEID,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Options                            
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Options                            
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Options                            
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Options                            
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L101,PS00L999:
                            PS00L999,PS00L102,PS00L103,PS00L104:
                            PS00L105,PS00L106,PS00L107,PS00L108:
                            PS00L109,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L110,PS00L111,PS00L112:
                            PS00L113,PS00L114,PS00L999,PS00L115:
                            PS00L999,PS00L999,PS00L116,PS00L117:
                            PS00L118,PS00L119,PS00L120,PS00L121:
                            PS00L122,PS00L123,PS00L124,PS00L999:
                           PS00L125,PS00L126,PS00L127,PS00L128:
                            PS00L129,PS00L130,PS00L131
          GOTO     PS00L999
.
PS00L101
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEAUST,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      CCEADES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      CCEAHCD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEAINC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      CCEAVIS,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      CCEADAY,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      CCEALV1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      CCEALV2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      CCEALV3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      FROMNEW,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      TONEW,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      FROMAD,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      TOAD,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      VISITDES,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      CCHCDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      TOTALEPS,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          MOVE      TOTALEXT,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      EXTRBRAN,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      CLV1DES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE      CLV2DES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          MOVE      CLV3DES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      COST1AMT,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          MOVE      COST2AMT,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          MOVE      EPISODE,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          MOVE      EXSTR,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L126
          MOVE      EXEND,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L127
          MOVE      AGERANGE,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L128
          MOVE      FROMDD,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L129
          MOVE      TODD,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L130
          MOVE      DAYCDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L131
          MOVE      CASPAYTP,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Options                            
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L006,SF00L102:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L103,SF00L104,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L105,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L104,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      POST0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC02L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L104
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TONEW   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RDATE000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L104
            ENDIF
            BRANCH    EXIT,SF00L104,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMNEW,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TONEW,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC01L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Range Options for Casemix Analysis 
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC01L200
          CALL      CF01L000 * Clear Fields
          CALL      GETEXT00
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Range Options for Casemix Analysis 
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Range Options for Casemix Analysis 
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Range Options for Casemix Analysis 
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Range Options for Casemix Analysis 
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Range Options for Casemix Analysis 
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Range Options for Casemix Analysis 
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L101,PS01L102,PS01L103,PS01L104:
                            PS01L105,PS01L106,PS01L107,PS01L108:
                            PS01L109,PS01L110,PS01L111,PS01L112:
                            PS01L113,PS01L114,PS01L115,PS01L116:
                            PS01L117,PS01L118,PS01L119,PS01L120:
                            PS01L121,PS01L122,PS01L123,PS01L124:
                            PS01L125,PS01L126,PS01L127,PS01L128:
                            PS01L129,PS01L130,PS01L131,PS01L132:
                            PS01L133,PS01L134,PS01L135,PS01L136:
                            PS01L137,PS01L138,PS01L139,PS01L140:
                            PS01L141,PS01L142,PS01L999,PS01L999:
                           PS01L999,PS01L143
          GOTO     PS01L999
.
PS01L101
          MOVE      DESC01,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      FROM01,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      TO01,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      DESC02,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      FROM02,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      TO02,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      DESC03,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      FROM03,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      TO03,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      DESC04,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      FROM04,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          MOVE      TO04,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          MOVE      DESC05,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          MOVE      FROM05,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          MOVE      TO05,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L116
          MOVE      DESC06,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L117
          MOVE      FROM06,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L118
          MOVE      TO06,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L119
          MOVE      DESC07,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L120
          MOVE      FROM07,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L121
          MOVE      TO07,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L122
          MOVE      DESC08,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L123
          MOVE      FROM08,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L124
          MOVE      TO08,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L125
          MOVE      DESC09,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L126
          MOVE      FROM09,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L127
          MOVE      TO09,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L128
          MOVE      DESC10,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L129
          MOVE      FROM10,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L130
          MOVE      TO10,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L131
          MOVE      DESC11,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L132
          MOVE      FROM11,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L133
          MOVE      TO11,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L134
          MOVE      DESC12,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L135
          MOVE      FROM12,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L136
          MOVE      TO12,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L137
          MOVE      DESC13,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L138
          MOVE      FROM13,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L139
          MOVE      TO13,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L140
          MOVE      DESC14X,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L141
          MOVE      FROM14,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L142
          MOVE      TO14,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L143
          MOVE      EXRANGE,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Range Options for Casemix Analysis 
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Analysis Measure Display           
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   72",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC02L200
          CALL      CF02L000 * Clear Fields
          CALL      GETMEA00
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Analysis Measure Display           
.-------------------------------------------------------
CF02L000
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Analysis Measure Display           
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Analysis Measure Display           
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Analysis Measure Display           
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Analysis Measure Display           
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Analysis Measure Display           
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L101,PS02L102,PS02L103,PS02L104:
                            PS02L105,PS02L106,PS02L107,PS02L108:
                            PS02L109,PS02L110,PS02L111,PS02L112:
                            PS02L113,PS02L114,PS02L115,PS02L116:
                            PS02L117,PS02L118,PS02L119,PS02L120:
                            PS02L121,PS02L122,PS02L123,PS02L124:
                            PS02L125,PS02L126,PS02L127,PS02L128:
                            PS02L129,PS02L130,PS02L131,PS02L132:
                            PS02L133,PS02L134,PS02L135,PS02L136:
                            PS02L137,PS02L138,PS02L139,PS02L140:
                            PS02L141,PS02L142,PS02L143,PS02L144:
                            PS02L145,PS02L146,PS02L147,PS02L148:
                            PS02L149,PS02L150,PS02L151,PS02L152:
                            PS02L153,PS02L154,PS02L155,PS02L156:
                            PS02L157,PS02L158,PS02L159,PS02L160:
                            PS02L161,PS02L162,PS02L163,PS02L164:
                            PS02L165,PS02L166,PS02L167,PS02L168:
                            PS02L169,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L170:
                            PS02L171,PS02L172
          GOTO     PS02L999
.
PS02L101
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYBA1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYBA2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYBA3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYBAO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYITH,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIA1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIA2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIA3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIAO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIM1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIM2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L112
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIM3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L113
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIMO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYETH1,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA11,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L116
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA21,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L117
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA31,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L118
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEAO1,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM11,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L120
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM21,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L121
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM31,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L122
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEMO1,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L123
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYETH2,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L124
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA12,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L125
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA22,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L126
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA32,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L127
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEAO2,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L128
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM12,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L129
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM22,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L130
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM32,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEMO2,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L132
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYETH3,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L133
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA13,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L134
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA23,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L135
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA33,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L136
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEAO3,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L137
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM13,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L138
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM23,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L139
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM33,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L140
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEMO3,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L141
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYETH4,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L142
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA14,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L143
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA24,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L144
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA34,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L145
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEAO4,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L146
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM14,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L147
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM24,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L148
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM34,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L149
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEMO4,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L150
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYETH5,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L151
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA15,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L152
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA25,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L153
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA35,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L154
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEAO5,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L155
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM15,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L156
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM25,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L157
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM35,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L158
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEMO5,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L159
          MOVE      CCCOCD1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L160
          MOVE      CCCOCD2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L161
          MOVE      CCCOCD3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L162
          MOVE      CCCOCD4,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L163
          MOVE      CCCOCD5,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L164
          MOVE      CCCOIA1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L165
          MOVE      CCCOIA2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L166
          MOVE      CCCOIA3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L167
          MOVE      CCCOIM1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L168
          MOVE      CCCOIM2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L169
          MOVE      CCCOIM3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L170
          MOVE      CCCOIA1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L171
          MOVE      CCCOIA2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L172
          MOVE      CCCOIA3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Analysis Measure Display           
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L101,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
SF02L990  MOVE      FOUR,EXIT * Exit Char Exit
SF02L999  RETURN
.@@@@@ Function Restart Point @@@@@
DEFAULTN    MOVE     ANSN,DEFYESNO
            RETURN
.---------------------------------------------------------------------------
. Post Casemix Extract Details and Perofrm Extract
.---------------------------------------------------------------------------
POST0000  MATCH    "0",CCEAUST
          IF       !@EQUAL
            MOVE     ONE,CCEAUST
          ENDIF
.
          PACK     KEY4,CCEAEID
          CALL     RACCEA1             * Read Record
          BRANCH   OVRCD,POST9999
.
          MOVE     ZERO,OVRCD
          MOVE     ZERO,EXIT
          MATCH    CCEAFDD,NEWFROM
          IF       @LESS
            ADD      ONE,OVRCD
            MOVE     NEWFROM,CCEAFDD
            MATCH    CCEAFDD,NEWTO
            IF       @LESS
              MOVE     ONE,EXIT
            ENDIF
          ENDIF
.
          MATCH    NEWTO,CCEATDD
          IF       @LESS
            ADD      ONE,OVRCD
            MOVE     NEWTO,CCEATDD
            MATCH    NEWFROM,CCEATDD
            IF       @LESS
              MOVE     ONE,EXIT
            ENDIF
          ENDIF
.
.----------------------------------------------------------------------
. OVRCD = 0 If Range Included in existing Date Range
.         1 If Range Adds to Either end of existing Date Range
.         2 If Add to Both Ends of Date Range
. EXIT  = 0 Date Range Joins Existing Date Range
.         1 Date Range does not join Existing Date Range
.----------------------------------------------------------------------
.
          BRANCH   EXIT,POST0100
          BRANCH   OVRCD,POST1000,POST0200
          BEEP
          DISPLAY  *P1:24,"New Date Range Included in Old. Continue (":
                   *V2LON,"Y",*HOFF,"/":
                   *V2LON,"N",*HOFF,") ? "
          MOVE     "50",CCOL
          MOVE     "24",CVERT
          CALL     YORN0000
          BRANCH   FYESNO,POST1000
          GOTO     POST9999
.
POST0100  BEEP
          MOVE     "Date Range must Join with Existing Date Range. - ",DISPMSG
          CALL     MESSAGE1
          GOTO     POST9999
.
POST0200  BEEP
          MOVE     "Date Range Includes all of Existing Date Range. - ",DISPMSG
          CALL     MESSAGE1
          MOVE     "Use Casemix Extract Generation. - ",DISPMSG
          CALL     MESSAGE1
          GOTO     POST9999
.
POST1000  CALL     UPCCEA1             * Update Record
          PACK     KEY4,CCEAEID
.
          CALL     RDCCEX1             * Read Record
          MOVE     OVRCD,EXRANGE       * 1 = no more ranges
.
          PACK     KEY4,CCEAEID
          CALL     RDCCEY1             * Read Record
          MOVE     OVRCD,EXCOMPS       * 1 = No Components Specified
          MOVE     ZERO,BEDCALC
          IF       EXCOMPS=0
            IF       (CCEYBA1+CCEYBA2+CCEYBA3+CCEYBAO=4)
              MOVE     ZERO,BEDCALC    * No LOS Calc Required
            ELSE
              MOVE     ONE,BEDCALC     * LOS Calculation Required
            ENDIF
          ENDIF
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     CEASPCA1,"ceaspcaf"
          TRAPCLR  IO
          MOVE     OVRCD,FLAGCEAS      * Costing Available 1=No 0=Yes
.
          CALL     GETMOD00            * Get Payment Model Details
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     PATITEM1,"patitemn"                                 * V90200
          TRAPCLR  IO
          MOVE     OVRCD,PATMBSOP
.
. Open Files
.---------------------------------------------------------------------------
          CALL     OPEN0000
          BRANCH   EXIT,POST9999
.
. Extract Episodes to the ccec file
.---------------------------------------------------------------------------
          CALL     EXTR0000
.
. Calculate Statistical Variances
.---------------------------------------------------------------------------
          MATCH    "0",CCEAUST
          GOTO     POST9999 IF EQUAL   * Update Stats Y or N 0=N
.
          CALL     STAT0000
.
POST9999  RETURN
.---------------------------------------------------------------------------
. Open Files
.---------------------------------------------------------------------------
OPEN0000  DISPLAY   *P1:24,*EL,"Opening Extract Files : "
          MOVE      "cceb",KEY4
          PACK      FILENAME,KEY4,CCEAEID
          DISPLAY   *P26:24,*EL,FILENAME
          REP       " 0",FILENAME
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCSCEBA1,FILENAME
          TRAPCLR   IO
          BRANCH    OVRCD,OPEN9000
.
          MOVE      "ccec",KEY4
          PACK      FILENAME,KEY4,CCEAEID
          DISPLAY   *P26:24,*EL,FILENAME
          REP       " 0",FILENAME
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCSCECA1,FILENAME
          TRAPCLR   IO
          BRANCH    OVRCD,OPEN9000
          OPEN      CCSCECA2,FILENAME
.
          MOVE      "cced",KEY4
          PACK      FILENAME,KEY4,CCEAEID
          DISPLAY   *P26:24,*EL,FILENAME
          REP       " 0",FILENAME
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCSCEDA1,FILENAME
          TRAPCLR   IO
          BRANCH    OVRCD,OPEN9000
.
          MOVE      "ccee",KEY4
          PACK      FILENAME,KEY4,CCEAEID
          DISPLAY   *P26:24,*EL,FILENAME
          REP       " 0",FILENAME
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCSCEEA1,FILENAME
          TRAPCLR   IO
          BRANCH    OVRCD,OPEN9000
.
          MOVE      ZERO,EXIT
          GOTO      OPEN9999
.
OPEN9000  BEEP
          MOVE      "Unable to Open Casemix Extract Files - ",DISPMSG
          CALL      MESSAGE1
          MOVE      ONE,EXIT
.
OPEN9999  RETURN
.======================================================================
. Extract Casemix Analysis
.======================================================================
EXTR0000  PACK      KEY18,SP70
          DISPLAY   *P1:24,*EL,"Scanning Episodes : "
          MOVE      ZERO,TOTALEPS
          MOVE      ZERO,TOTALEXT
          PACK      KEY26,NEWFROM,SP70
          CALL      RSCCEP4
EXTR1000  CALL      RKCCEP4
          BRANCH    OVRCD,EXTR9000
          MATCH     CCEPDDAT,NEWTO
          GOTO      EXTR9000 IF LESS
.
          ADD       ONE,TOTALEPS
          IF        (TOTALEPS%500=0)
            DISPLAY   *P21:24,*V2LON,TOTALEPS
          ENDIF
.
          PACK      KEY18,CCEPHCD,CCEPEPS
          CALL      RDCCEC1
          IF        OVRCD=0
            CALL      CLLEV000     * Clear Epiosde Details if On File
            CALL      DECCEC1
          ENDIF
.
          CALL      RANGE000     * Check Range Options
          BRANCH    EXIT,EXTR1000
.
          MOVE      SP70,CCECLV1
          MOVE      SP70,CCECLV2
          MOVE      SP70,CCECLV3
          MOVE      CCEALV1,EXTRBRAN
          CALL      GETCD000     * Get Extract Code Level 1
          MOVE      KEY10,CCECLV1
          MATCH     SP70,CCECLV1
          IF        @EQUAL
            MOVE      Z70,CCECLV1
          ENDIF
.
          MATCH     SP70,CCEALV2
          IF        !@EQUAL
            MOVE      CCEALV2,EXTRBRAN
            CALL      GETCD000     * Get Extract Code Level 2
            MOVE      KEY10,CCECLV2
            MATCH     SP70,CCECLV2
            IF        @EQUAL
              MOVE      Z70,CCECLV2
            ENDIF
          ENDIF
.
          MATCH     SP70,CCEALV3
          IF        !@EQUAL
            MOVE      CCEALV3,EXTRBRAN
            CALL      GETCD000     * Get Extract Code Level 3
            MOVE      KEY10,CCECLV3
            MATCH     SP70,CCECLV3
            IF        @EQUAL
              MOVE      Z70,CCECLV3
            ENDIF
          ENDIF
.
          MOVE      CCEPHCD,CCECHCD
          MOVE      CCEPEPS,CCECEPS
          MOVE      CCEPEXC,CCECEXC
          PACK      KEY18,CCECHCD,CCECEPS
          CALL      RDCCIA1            * Income Analysis File
          IF        OVRCD=0
            CALL      CALEPS00
          ELSE
            MOVE      ZERO,CCECFTC
            MOVE      ZERO,CCECTTC
          ENDIF
.
          MOVE      CCEPLOS,CCECLOS
          IF        BEDCALC=1
            MOVE      ZERO,CCECLOS
            ASSIGN    ((CCEPLOS-CCIABA1-CCIABA2-CCIABA3)*CCEYBAO),CCECLOS
            ASSIGN    CCECLOS+(CCIABA1*CCEYBA1),CCECLOS
            ASSIGN    CCECLOS+(CCIABA2*CCEYBA2),CCECLOS
            ASSIGN    CCECLOS+(CCIABA3*CCEYBA3),CCECLOS
          ENDIF
.
          PACK      KEY18,CCECHCD,CCECEPS
          CALL      RACCEC1
          IF        OVRCD=0
            CALL      UPCCEC1
          ELSE
            CALL      WRCCEC1
          ENDIF
          CALL      UPLEV000
          GOTO      EXTR1000
.
EXTR9000  RETURN
.-------------------------------------------------------------------------------
. Clear Levels
.-------------------------------------------------------------------------------
CLLEV000  MATCH     "1",CCECEXC         * Excluded from Summary
          GOTO      CLLEV999 IF EQUAL   * Therefore No Clear Required
.
          CALL      SUBEB000            * Clear Level 1
.
          MATCH     SP70,CCEALV2
          GOTO      CLLEV999 IF EQUAL   * No Level 2 ?
          CALL      SUBED000            * Clear Level 2
.
          MATCH     SP70,CCEALV3
          GOTO      CLLEV999 IF EQUAL   * No Level 3 ?
          CALL      SUBEE000            * Clear Level 3
.
CLLEV999  RETURN
.-------------------------------------------------------------------------------
. Update Levels
.-------------------------------------------------------------------------------
UPLEV000  MATCH     "1",CCECEXC         * Excluded from Summary
          GOTO      UPLEV999 IF EQUAL
.
          CALL      UPDEB000
.
          MATCH     SP70,CCEALV2
          GOTO      UPLEV999 IF EQUAL
          CALL      UPDED000
.
          MATCH     SP70,CCEALV3
          GOTO      UPLEV999 IF EQUAL
          CALL      UPDEE000
.
UPLEV999  RETURN
.-------------------------------------------
. Check for Range Option - EXIT 0=In Range
.-------------------------------------------
RANGE000  MATCH     CCEAHCD,CCEPHCD
          GOTO      RANGE900 IF NOT EQUAL
.
          MATCH     SP70,CCEPADAT   * Admission Date Range
          GOTO      RANGE010 IF EQUAL
.
          MATCH     CCEAFAD,CCEPADAT   * Admission Date Range
          GOTO      RANGE900 IF LESS
          MATCH     CCEPADAT,CCEATAD
          GOTO      RANGE900 IF LESS
.
RANGE010  MATCH     "0",CCEAVIS       * Include Visits 0=All
          IF        !(@EQUAL)
            MOVE      CCEPVIST,ANS
            MATCH     CCEAVIS,ANS
            GOTO      RANGE900 IF NOT EQUAL
          ENDIF
.
          MATCH     "0",CCEADAY       * Day Cases 0=Excluded
          IF        @EQUAL
            MATCH     "1",CCEPDAY      * Day Case 0=NO
            GOTO      RANGE900 IF EQUAL
          ENDIF
          MATCH     "2",CCEADAY       * Day Cases 2=Only
          IF        @EQUAL
            MATCH     "1",CCEPDAY      * Day Case 0=NO
            GOTO      RANGE900 IF NOT EQUAL
          ENDIF
.
          MATCH     "0",CCEAINC       * Include Incompleted 0=No
          IF        @EQUAL
            MATCH     "0",CCEPCOM     * Complete 0=NO
            GOTO      RANGE900 IF EQUAL
          ENDIF
.
          BRANCH    EXRANGE,RANGE800
          MOVE      ZERO,F2
RANGE700  ADD       ONE,F2
          COMPARE   "15",F2
          GOTO      RANGE800 IF EQUAL
          LOAD      KEY3,F2,CCEXR01,CCEXR02,CCEXR03,CCEXR04,CCEXR05:
                            CCEXR06,CCEXR07,CCEXR08,CCEXR09,CCEXR10:
                            CCEXR11,CCEXR12,CCEXR13,CCEXR14
          MATCH     SP70,KEY3
          GOTO      RANGE700 IF EQUAL
.
          MOVE      KEY3,EXTRBRAN
          CALL      GETCD000     * Get Extract Code
.
          LOAD      EXSTR,F2,CCEXF01,CCEXF02,CCEXF03,CCEXF04,CCEXF05:
                                   CCEXF06,CCEXF07,CCEXF08,CCEXF09,CCEXF10:
                                   CCEXF11,CCEXF12,CCEXF13,CCEXF14
          LOAD      EXEND,F2,CCEXT01,CCEXT02,CCEXT03,CCEXT04,CCEXT05:
                                   CCEXT06,CCEXT07,CCEXT08,CCEXT09,CCEXT10:
                                   CCEXT11,CCEXT12,CCEXT13,CCEXT14
.
          MATCH     EXSTR,KEY10   * Range
          GOTO      RANGE900 IF LESS
          MATCH     KEY10,EXEND
          GOTO      RANGE900 IF LESS
          GOTO      RANGE700
.
RANGE800  MOVE      ZERO,EXIT
          GOTO      RANGE999
RANGE900  MOVE      ONE,EXIT
RANGE999  RETURN
.------------------------------------------------------------
. Clear Episode from Casemix Level 1
.------------------------------------------------------------
SUBEB000  PACK      KEY10,CCECLV1
          CALL      RDCCEB1
          BRANCH    OVRCD,SUBEB999
          SUB       ONE,CCEBNEP    * Decrease Number of Episodes
          SUB       CCECFTC,CCEBFTC
          SUB       CCECTTC,CCEBTTC
          SUB       CCECLOS,CCEBLTO
          CALL      UPCCEB1
SUBEB999  RETURN
.------------------------------------------------------------
. Clear Episode from Casemix Level 2
.------------------------------------------------------------
SUBED000  PACK      KEY20,CCECLV1,CCECLV2
          CALL      RDCCED1
          BRANCH    OVRCD,SUBED999
          SUB       ONE,CCEDNEP    * Decrease Number of Episodes
          SUB       CCECFTC,CCEDFTC
          SUB       CCECTTC,CCEDTTC
          SUB       CCECLOS,CCEDLTO
          CALL      UPCCED1
SUBED999  RETURN
.------------------------------------------------------------
. Clear Episode from Casemix Level 3
.------------------------------------------------------------
SUBEE000  PACK      KEY30,CCECLV1,CCECLV2,CCECLV3
          CALL      RDCCEE1
          BRANCH    OVRCD,SUBEE999
          SUB       ONE,CCEENEP    * Decrease Number of Episodes
          SUB       CCECFTC,CCEEFTC
          SUB       CCECTTC,CCEETTC
          SUB       CCECLOS,CCEELTO
          CALL      UPCCEE1
SUBEE999  RETURN
.------------------------------------------------------------
. Update Casemix Level 1
.------------------------------------------------------------
UPDEB000  PACK      KEY10,CCECLV1
          CALL      RDCCEB1
          IF        OVRCD=1
            CALL      CLREB000
            MOVE      CCECLV1,CCEBLV1
            CALL      WRCCEB1
            CALL      RDCCEB1
          ENDIF
          ADD       ONE,CCEBNEP    * Increase Number of Episodes
          ADD       CCECFTC,CCEBFTC
          ADD       CCECTTC,CCEBTTC
          ADD       CCECLOS,CCEBLTO
          CALL      UPCCEB1
          RETURN
.------------------------------------------------------------
. Update Casemix Level 2
.------------------------------------------------------------
UPDED000  PACK      KEY20,CCECLV1,CCECLV2,SP70
          MATCH     SP70,KEY20
          GOTO      UPDED999 IF EQUAL
          CALL      RDCCED1
          IF        OVRCD=1
            CALL      CLRED000
            UNPACK    KEY20,CCEDLV1,CCEDLV2
            CALL      WRCCED1
            CALL      RDCCED1
          ENDIF
          ADD       ONE,CCEDNEP    * Increase Number of Episodes
          ADD       CCECFTC,CCEDFTC
          ADD       CCECTTC,CCEDTTC
          ADD       CCECLOS,CCEDLTO
          CALL      UPCCED1
UPDED999  RETURN
.------------------------------------------------------------
. Update Casemix Level 3
.------------------------------------------------------------
UPDEE000  PACK      KEY30,CCECLV1,CCECLV2,CCECLV3,SP70
          MATCH     SP70,KEY30
          GOTO      UPDEE999 IF EQUAL
          CALL      RDCCEE1
          IF        OVRCD=1
            CALL      CLREE000
            UNPACK    KEY30,CCEELV1,CCEELV2,CCEELV3
            CALL      WRCCEE1
            CALL      RDCCEE1
          ENDIF
          ADD       ONE,CCEENEP    * Increase Number of Episodes
          ADD       CCECFTC,CCEEFTC
          ADD       CCECTTC,CCEETTC
          ADD       CCECLOS,CCEELTO
          CALL      UPCCEE1
.
UPDEE999  RETURN
.------------------------------------------------------------
. Clear Summary File Details
.------------------------------------------------------------
CLREB000  MOVE      ZERO,CCEBNEP
          MOVE      ZERO,CCEBFTC
          MOVE      "999999999999",CCEBFMN
          MOVE      ZERO,CCEBFMX
          MOVE      ZERO,CCEBFSV
          MOVE      ZERO,CCEBTTC
          MOVE      "999999999999",CCEBTMN
          MOVE      ZERO,CCEBTMX
          MOVE      ZERO,CCEBTSV
          MOVE      "999999999999",CCEBLMN
          MOVE      ZERO,CCEBLMX
          MOVE      ZERO,CCEBLSV
          MOVE      ZERO,CCEBLTO
          RETURN
.
CLRED000  MOVE      ZERO,CCEDNEP
          MOVE      ZERO,CCEDFTC
          MOVE      "999999999999",CCEDFMN
          MOVE      ZERO,CCEDFMX
          MOVE      ZERO,CCEDFSV
          MOVE      ZERO,CCEDTTC
          MOVE      "999999999999",CCEDTMN
          MOVE      ZERO,CCEDTMX
          MOVE      ZERO,CCEDTSV
          MOVE      "999999999999",CCEDLMN
          MOVE      ZERO,CCEDLMX
          MOVE      ZERO,CCEDLSV
          MOVE      ZERO,CCEDLTO
          RETURN
.
CLREE000  MOVE      ZERO,CCEENEP
          MOVE      ZERO,CCEEFTC
          MOVE      "999999999999",CCEEFMN
          MOVE      ZERO,CCEEFMX
          MOVE      ZERO,CCEEFSV
          MOVE      ZERO,CCEETTC
          MOVE      "999999999999",CCEETMN
          MOVE      ZERO,CCEETMX
          MOVE      ZERO,CCEETSV
          MOVE      "999999999999",CCEELMN
          MOVE      ZERO,CCEELMX
          MOVE      ZERO,CCEELSV
          MOVE      ZERO,CCEELTO
          RETURN
.------------------------------------------------------------
. Calculate Statistics
.------------------------------------------------------------
STAT0000  PACK      KEY10,SP70
          DISPLAY   *P1:24,*EL,"Calculating Statistics : "
          MOVE      ZERO,TOTALEXT
.
          CALL      STEB0000  * Level 1 Min , Max  & Variance Calculation
          CALL      STED0000  * Level 2 Min , Max  & Variance Calculation
          CALL      STEE0000  * Level 3 Min , Max  & Variance Calculation
.
STAT9999  RETURN
.------------------------------------------------------------
. Update Variance Casemix Level 1
.------------------------------------------------------------
STEB0000  PACK      KEY10,SP70
          CALL      RDCCEB1
          IF        OVRCD=0
            CALL      RPCCEB1
          ENDIF
.
STEB1000  CALL      RKCCEB1
          BRANCH    OVRCD,STEB9999
.
          ADD       ONE,TOTALEXT
          IF        (TOTALEXT%100=0)
            DISPLAY   *P26:24,*V2LON,TOTALEXT,"/1"
          ENDIF
.
          MOVE      "999999999999",CCEBFMN
          MOVE      ZERO,CCEBFMX
          MOVE      ZERO,CCEBFSV
          MOVE      "999999999999",CCEBTMN
          MOVE      ZERO,CCEBTMX
          MOVE      ZERO,CCEBTSV
          MOVE      "999999999999",CCEBLMN
          MOVE      ZERO,CCEBLMX
          MOVE      ZERO,CCEBLSV
.
          PACK      KEY48,CCEBLV1,SP70
          CALL      RSCCEC2
STEB1100  CALL      RKCCEC2
          BRANCH    OVRCD,STEB1900
          MATCH     CCEBLV1,CCECLV1
          GOTO      STEB1900 IF NOT EQUAL
.
          MATCH     "1",CCECEXC  * Excluded
          GOTO      STEB1100 IF EQUAL
.
          CALL      CHKEB000
.
          ASSIGN    CCECFTC-(CCEBFTC/CCEBNEP),F12P4
          ASSIGN    CCEBFSV+(F12P4*F12P4),CCEBFSV
.
          ASSIGN    CCECTTC-(CCEBTTC/CCEBNEP),F12P4
          ASSIGN    CCEBTSV+(F12P4*F12P4),CCEBTSV
.
          ASSIGN    CCECLOS-(CCEBLTO/CCEBNEP),F12P4
          ASSIGN    CCEBLSV+(F12P4*F12P4),CCEBLSV
.
          GOTO      STEB1100
.
STEB1900  IF        CCEBNEP>1
            ASSIGN    CCEBFSV/(CCEBNEP-1),CCEBFSV
            ASSIGN    CCEBTSV/(CCEBNEP-1),CCEBTSV
            ASSIGN    CCEBLSV/(CCEBNEP-1),CCEBLSV
          ENDIF
          CALL      UPCCEB1
          GOTO      STEB1000
.
STEB9999  RETURN
.
.------------------------------------------------------------
. Update Variance Casemix Level 2
.------------------------------------------------------------
STED0000  PACK      KEY20,SP70
          CALL      RDCCED1
          IF        OVRCD=0
            CALL      RPCCED1
          ENDIF
STED1000  CALL      RKCCED1
          BRANCH    OVRCD,STED9999
.
          ADD       ONE,TOTALEXT
          IF        (TOTALEXT%100=0)
            DISPLAY   *P26:24,*V2LON,TOTALEXT,"/2"
          ENDIF
.
          MOVE      "999999999999",CCEDFMN
          MOVE      ZERO,CCEDFMX
          MOVE      ZERO,CCEDFSV
          MOVE      "999999999999",CCEDTMN
          MOVE      ZERO,CCEDTMX
          MOVE      ZERO,CCEDTSV
          MOVE      "999999999999",CCEDLMN
          MOVE      ZERO,CCEDLMX
          MOVE      ZERO,CCEDLSV
.
          PACK      KEY48,CCEDLV1,CCEDLV2,SP70
          PACK      KEY20,CCEDLV1,CCEDLV2,SP70
          CALL      RSCCEC2
STED1100  CALL      RKCCEC2
          BRANCH    OVRCD,STED1900
          PACK      KEY48,CCECLV1,CCECLV2,SP70
          MATCH     KEY20,KEY48
          GOTO      STED1900 IF NOT EQUAL
.
          MATCH     "1",CCECEXC  * Excluded
          GOTO      STED1100 IF EQUAL
.
          CALL      CHKED000
.
          ASSIGN    CCECFTC-(CCEDFTC/CCEDNEP),F12P4
          ASSIGN    CCEDFSV+(F12P4*F12P4),CCEDFSV
.
          ASSIGN    CCECTTC-(CCEDTTC/CCEDNEP),F12P4
          ASSIGN    CCEDTSV+(F12P4*F12P4),CCEDTSV
.
          ASSIGN    CCECLOS-(CCEDLTO/CCEDNEP),F12P4
          ASSIGN    CCEDLSV+(F12P4*F12P4),CCEDLSV
.
          GOTO      STED1100
.
STED1900  IF        CCEDNEP>1
            ASSIGN    CCEDFSV/(CCEDNEP-1),CCEDFSV
            ASSIGN    CCEDTSV/(CCEDNEP-1),CCEDTSV
            ASSIGN    CCEDLSV/(CCEDNEP-1),CCEDLSV
          ENDIF
          CALL      UPCCED1
          GOTO      STED1000
.
STED9999  RETURN
.
.------------------------------------------------------------
. Update Variance Casemix Level 3
.------------------------------------------------------------
STEE0000  PACK      KEY30,SP70
          CALL      RDCCEE1
          IF        OVRCD=0
            CALL      RPCCEE1
          ENDIF
.
STEE1000  CALL      RKCCEE1
          BRANCH    OVRCD,STEE9999
.
          ADD       ONE,TOTALEXT
          IF        (TOTALEXT%100=0)
            DISPLAY   *P26:24,*V2LON,TOTALEXT,"/3"
          ENDIF
.
          MOVE      "999999999999",CCEEFMN
          MOVE      ZERO,CCEEFMX
          MOVE      ZERO,CCEEFSV
          MOVE      "999999999999",CCEETMN
          MOVE      ZERO,CCEETMX
          MOVE      ZERO,CCEETSV
          MOVE      "999999999999",CCEELMN
          MOVE      ZERO,CCEELMX
          MOVE      ZERO,CCEELSV
.
          PACK      KEY48,CCEELV1,CCEELV2,CCEELV3,SP70
          PACK      KEY30,CCEELV1,CCEELV2,CCEELV3,SP70
          CALL      RSCCEC2
STEE1100  CALL      RKCCEC2
          BRANCH    OVRCD,STEE1900
          PACK      KEY48,CCECLV1,CCECLV2,CCECLV3,SP70
          MATCH     KEY30,KEY48
          GOTO      STEE1900 IF NOT EQUAL
.
          MATCH     "1",CCECEXC  * Excluded
          GOTO      STEE1100 IF EQUAL
.
          CALL      CHKEE000
.
          ASSIGN    CCECFTC-(CCEEFTC/CCEENEP),F12P4
          ASSIGN    CCEEFSV+(F12P4*F12P4),CCEEFSV
.
          ASSIGN    CCECTTC-(CCEETTC/CCEENEP),F12P4
          ASSIGN    CCEETSV+(F12P4*F12P4),CCEETSV
.
          ASSIGN    CCECLOS-(CCEELTO/CCEENEP),F12P4
          ASSIGN    CCEELSV+(F12P4*F12P4),CCEELSV
.
          GOTO      STEE1100
.
STEE1900  IF        CCEENEP>1
            ASSIGN    CCEEFSV/(CCEENEP-1),CCEEFSV
            ASSIGN    CCEETSV/(CCEENEP-1),CCEETSV
            ASSIGN    CCEELSV/(CCEENEP-1),CCEELSV
          ENDIF
          CALL      UPCCEE1
          GOTO      STEE1000
.
STEE9999  RETURN
.------------------------------------------------------------
. Check Level 1 Min & Max
.------------------------------------------------------------
CHKEB000  IF        CCECFTC>CCEBFMX
            MOVE      CCECFTC,CCEBFMX
          ENDIF
          IF        CCECFTC<CCEBFMN
            MOVE      CCECFTC,CCEBFMN
          ENDIF
.
          IF        CCECTTC>CCEBTMX
            MOVE      CCECTTC,CCEBTMX
          ENDIF
          IF        CCECTTC<CCEBTMN
            MOVE      CCECTTC,CCEBTMN
          ENDIF
.
          IF        CCECLOS>CCEBLMX
            MOVE      CCECLOS,CCEBLMX
          ENDIF
          IF        CCECLOS<CCEBLMN
            MOVE      CCECLOS,CCEBLMN
          ENDIF
          RETURN
.------------------------------------------------------------
. Check Min & Max for Level 2
.------------------------------------------------------------
CHKED000  IF        CCECFTC>CCEDFMX
            MOVE      CCECFTC,CCEDFMX
          ENDIF
          IF        CCECFTC<CCEDFMN
            MOVE      CCECFTC,CCEDFMN
          ENDIF
.
          IF        CCECTTC>CCEDTMX
            MOVE      CCECTTC,CCEDTMX
          ENDIF
          IF        CCECTTC<CCEDTMN
            MOVE      CCECTTC,CCEDTMN
          ENDIF
.
          IF        CCECLOS>CCEDLMX
            MOVE      CCECLOS,CCEDLMX
          ENDIF
          IF        CCECLOS<CCEDLMN
            MOVE      CCECLOS,CCEDLMN
          ENDIF
          RETURN
.------------------------------------------------------------
. Check Level 3 Min & Max
.------------------------------------------------------------
CHKEE000  IF        CCECFTC>CCEEFMX
            MOVE      CCECFTC,CCEEFMX
          ENDIF
          IF        CCECFTC<CCEEFMN
            MOVE      CCECFTC,CCEEFMN
          ENDIF
.
          IF        CCECTTC>CCEETMX
            MOVE      CCECTTC,CCEETMX
          ENDIF
          IF        CCECTTC<CCEETMN
            MOVE      CCECTTC,CCEETMN
          ENDIF
.
          IF        CCECLOS>CCEELMX
            MOVE      CCECLOS,CCEELMX
          ENDIF
          IF        CCECLOS<CCEELMN
            MOVE      CCECLOS,CCEELMN
          ENDIF
          RETURN
.--------------------------------------------------
. Calculate Episode Income/Costs
.--------------------------------------------------
CALEPS00  MOVE      ZERO,CCECFTC
          MOVE      ZERO,CCECTTC
.
          MATCH     SP70,CCEAIMOD        * Use Payment Model Calculation
          GOTO      CALEPS10 IF NOT EQUAL
          MATCH     SP70,CCEAITHE        * Use Theatre Time in place of Income
          GOTO      CALEPS30 IF NOT EQUAL
.
          BRANCH    EXCOMPS,CALEPS20     * Simple Calculation (All)
.
. Partial Components Specified
.-----------------------------
          ASSIGN    CCECFTC+(CCIAITH*CCEYITH)+(CCIAIA1*CCEYIA1),CCECFTC
          ASSIGN    CCECFTC+(CCIAIA2*CCEYIA2)+(CCIAIA3*CCEYIA3),CCECFTC
          ASSIGN    CCECFTC+(CCIAIAO*CCEYIAO)+(CCIAIM1*CCEYIM1),CCECFTC
          ASSIGN    CCECFTC+(CCIAIM2*CCEYIM2)+(CCIAIM3*CCEYIM3),CCECFTC
          ASSIGN    CCECFTC+(CCIAIMO*CCEYIMO),CCECFTC
          GOTO      CALEPS50
.
. Payment Model Calculation
.---------------------------
CALEPS10  MOVE    ZERO,CCECFTC               * Keep Theatre Component
          IF      INCUTH=1
            MOVE    CCIAITH,CCECFTC               * Keep Theatre Component
          ELSE
            IF      PATMBSOP=0
              PACK    KEY9,CCEPPMBS
              CALL    RDITEM1                                          * V90200
              IF      OVRCD=0
                SQUEEZE  IBAND1                                        * V90200
                MOVE     IBAND1,F2                                     * V90200
                LOAD     CCECFTC,F2,INCB01,INCB02,INCB03,INCB04,INCB05:
                                    INCB06,INCB07,INCB08,INCB09,INCB10:
                                    INCB11,INCB12,INCB13,INCB14,INCB15
              ENDIF
            ENDIF
          ENDIF
.
. Add Charge per ICU Day Assume Accom. Component 1
.
          ASSIGN  (INCICU*CCIABA1)+CCECFTC,CCECFTC
.
. Add Charge per day & per case from drg
.
          PACK    KEY5,CCEAIMOD,CCEPDRGC
          CALL    RDCEPM1
          IF      OVRCD=0
            IF      INCINCI=1
              ASSIGN  (CEPMPDAY*CCIALOS)+CEPMPCAS+CCECFTC,CCECFTC
            ELSE
              ASSIGN  (CEPMPDAY*(CCIALOS-CCIABA1))+CEPMPCAS+CCECFTC,CCECFTC
            ENDIF
          ENDIF
          GOTO    CALEPS50
.
. No Component Measures Specified (ALL)
.---------------------------------
CALEPS20  ASSIGN  CCECFTC+CCIAITH+CCIAIA1+CCIAIA2+CCIAIA3+CCIAIAO,CCECFTC
          ASSIGN  CCECFTC+CCIAIM1+CCIAIM2+CCIAIM3+CCIAIMO,CCECFTC
          GOTO    CALEPS50
.
. Theatre Time Replacing Income
.---------------------------------
CALEPS30  MOVE      CCEAITHE,F1
          LOAD      CCECFTC,F1,CCIATT1,CCIATT2,CCIATT3,CCIATT4
.
.--------------------------------------------------
. Calculate Episode Income/Costs
.--------------------------------------------------
CALEPS50  BRANCH    FLAGCEAS,CALEPS99    * No Costing Files
          MATCH     SP70,CCEACMOD        * Use Payment Model Calculation
          GOTO      CALEPS60 IF NOT EQUAL
          MATCH     SP70,CCEACTHE        * Use Theatre Time in place of Cost
          GOTO      CALEPS80 IF NOT EQUAL
.
          BRANCH    EXCOMPS,CALEPS70     * Simple Calculation
.
          ASSIGN    CCECTTC+(CCIAETH1*CCEYETH1)+(CCIAEA11*CCEYEA11),CCECTTC
          ASSIGN    CCECTTC+(CCIAEA21*CCEYEA21)+(CCIAEA31*CCEYEA31),CCECTTC
          ASSIGN    CCECTTC+(CCIAEAO1*CCEYEAO1)+(CCIAEM11*CCEYEM11),CCECTTC
          ASSIGN    CCECTTC+(CCIAEM21*CCEYEM21)+(CCIAEM31*CCEYEM31),CCECTTC
          ASSIGN    CCECTTC+(CCIAEMO1*CCEYEMO1),CCECTTC
.
          ASSIGN    CCECTTC+(CCIAETH2*CCEYETH2)+(CCIAEA12*CCEYEA12),CCECTTC
          ASSIGN    CCECTTC+(CCIAEA22*CCEYEA22)+(CCIAEA32*CCEYEA32),CCECTTC
          ASSIGN    CCECTTC+(CCIAEAO2*CCEYEAO2)+(CCIAEM12*CCEYEM12),CCECTTC
          ASSIGN    CCECTTC+(CCIAEM22*CCEYEM22)+(CCIAEM32*CCEYEM32),CCECTTC
          ASSIGN    CCECTTC+(CCIAEMO2*CCEYEMO2),CCECTTC
.
          ASSIGN    CCECTTC+(CCIAETH3*CCEYETH3)+(CCIAEA13*CCEYEA13),CCECTTC
          ASSIGN    CCECTTC+(CCIAEA23*CCEYEA23)+(CCIAEA33*CCEYEA33),CCECTTC
          ASSIGN    CCECTTC+(CCIAEAO3*CCEYEAO3)+(CCIAEM13*CCEYEM13),CCECTTC
          ASSIGN    CCECTTC+(CCIAEM23*CCEYEM23)+(CCIAEM33*CCEYEM33),CCECTTC
          ASSIGN    CCECTTC+(CCIAEMO3*CCEYEMO3),CCECTTC
.
          ASSIGN    CCECTTC+(CCIAETH4*CCEYETH4)+(CCIAEA14*CCEYEA14),CCECTTC
          ASSIGN    CCECTTC+(CCIAEA24*CCEYEA24)+(CCIAEA34*CCEYEA34),CCECTTC
          ASSIGN    CCECTTC+(CCIAEAO4*CCEYEAO4)+(CCIAEM14*CCEYEM14),CCECTTC
          ASSIGN    CCECTTC+(CCIAEM24*CCEYEM24)+(CCIAEM34*CCEYEM34),CCECTTC
          ASSIGN    CCECTTC+(CCIAEMO4*CCEYEMO4),CCECTTC
.
          ASSIGN    CCECTTC+(CCIAETH5*CCEYETH5)+(CCIAEA15*CCEYEA15),CCECTTC
          ASSIGN    CCECTTC+(CCIAEA25*CCEYEA25)+(CCIAEA35*CCEYEA35),CCECTTC
          ASSIGN    CCECTTC+(CCIAEAO5*CCEYEAO5)+(CCIAEM15*CCEYEM15),CCECTTC
          ASSIGN    CCECTTC+(CCIAEM25*CCEYEM25)+(CCIAEM35*CCEYEM35),CCECTTC
          ASSIGN    CCECTTC+(CCIAEMO5*CCEYEMO5),CCECTTC
.
          GOTO      CALEPS99
.
. Payment Model Calculation
.---------------------------
CALEPS60  MOVE    ZERO,CCECTTC
          IF      CSTUTH=1
            MOVE    CCIAITH,CCECTTC               * Keep Theatre Component
          ELSE
            IF      PATMBSOP=0
              PACK    KEY9,CCEPPMBS
              CALL    RDITEM1                                          * V90200
              IF      OVRCD=0
                SQUEEZE  IBAND1                                        * V90200
                MOVE     IBAND1,F2                                     * V90200
                LOAD     CCECTTC,F2,CSTB01,CSTB02,CSTB03,CSTB04,CSTB05:
                                    CSTB06,CSTB07,CSTB08,CSTB09,CSTB10:
                                    CSTB11,CSTB12,CSTB13,CSTB14,CSTB15
              ENDIF
            ENDIF
          ENDIF
.
. Add Charge per ICU Day Assume Accom. Component 1
.
          ASSIGN  (CSTICU*CCIABA1)+CCECTTC,CCECTTC
.
. Add Charge per day & per case from drg
.
          PACK    KEY5,CCEACMOD,CCEPDRGC
          CALL    RDCEPM1
          IF      OVRCD=0
            IF      CSTINCI=1
              ASSIGN  (CEPMPDAY*CCIALOS)+CEPMPCAS+CCECTTC,CCECTTC
            ELSE
              ASSIGN  (CEPMPDAY*(CCIALOS-CCIABA1))+CEPMPCAS+CCECTTC,CCECTTC
            ENDIF
          ENDIF
          GOTO    CALEPS99
.
. No Component Measures Specified
.---------------------------------
CALEPS70  ASSIGN  CCECTTC+CCIAETH1+CCIAEA11+CCIAEA21+CCIAEA31+CCIAEAO1,CCECTTC
          ASSIGN  CCECTTC+CCIAEM11+CCIAEM21+CCIAEM31+CCIAEMO1,CCECTTC
          ASSIGN  CCECTTC+CCIAETH2+CCIAEA12+CCIAEA22+CCIAEA32+CCIAEAO2,CCECTTC
          ASSIGN  CCECTTC+CCIAEM12+CCIAEM22+CCIAEM32+CCIAEMO2,CCECTTC
          ASSIGN  CCECTTC+CCIAETH3+CCIAEA13+CCIAEA23+CCIAEA33+CCIAEAO3,CCECTTC
          ASSIGN  CCECTTC+CCIAEM13+CCIAEM23+CCIAEM33+CCIAEMO3,CCECTTC
          ASSIGN  CCECTTC+CCIAETH4+CCIAEA14+CCIAEA24+CCIAEA34+CCIAEAO4,CCECTTC
          ASSIGN  CCECTTC+CCIAEM14+CCIAEM24+CCIAEM34+CCIAEMO4,CCECTTC
          ASSIGN  CCECTTC+CCIAETH5+CCIAEA15+CCIAEA25+CCIAEA35+CCIAEAO5,CCECTTC
          ASSIGN  CCECTTC+CCIAEM15+CCIAEM25+CCIAEM35+CCIAEMO5,CCECTTC
          GOTO    CALEPS99
.
. Theatre Time Replacing Cost
.---------------------------------
CALEPS80  MOVE      CCEACTHE,F1
          LOAD      CCECTTC,F1,CCIATT1,CCIATT2,CCIATT3,CCIATT4
.
CALEPS99  RETURN
.------------------------------------------------------------
. Get Payment Model Details
.------------------------------------------------------------
GETMOD00  MATCH    SP70,CCEAIMOD
          GOTO     GETMOD50 IF EQUAL
          MOVE     CCEAIMOD,KEY1
          CALL     RDCEPP1
          BRANCH   OVRCD,GETMOD50
          MOVE     CEPPICU,INCICU
          MOVE     CEPPINCI,INCINCI
          MOVE     CEPPUTH,INCUTH
          MOVE     CEPPB01,INCB01
          MOVE     CEPPB02,INCB02
          MOVE     CEPPB03,INCB03
          MOVE     CEPPB04,INCB04
          MOVE     CEPPB05,INCB05
          MOVE     CEPPB06,INCB06
          MOVE     CEPPB07,INCB07
          MOVE     CEPPB08,INCB08
          MOVE     CEPPB09,INCB09
          MOVE     CEPPB10,INCB10
          MOVE     CEPPB11,INCB11
          MOVE     CEPPB12,INCB12
          MOVE     CEPPB13,INCB13
          MOVE     CEPPB14,INCB14
          MOVE     CEPPB15,INCB15
.
          GOTO     GETMOD99
.
GETMOD50  MATCH    SP70,CCEACMOD
          GOTO     GETMOD99 IF EQUAL
          MOVE     CCEACMOD,KEY1
          CALL     RDCEPP1
          BRANCH   OVRCD,GETMOD99
          MOVE     CEPPICU,CSTICU
          MOVE     CEPPINCI,CSTINCI
          MOVE     CEPPUTH,CSTUTH
          MOVE     CEPPB01,CSTB01
          MOVE     CEPPB02,CSTB02
          MOVE     CEPPB03,CSTB03
          MOVE     CEPPB04,CSTB04
          MOVE     CEPPB05,CSTB05
          MOVE     CEPPB06,CSTB06
          MOVE     CEPPB07,CSTB07
          MOVE     CEPPB08,CSTB08
          MOVE     CEPPB09,CSTB09
          MOVE     CEPPB10,CSTB10
          MOVE     CEPPB11,CSTB11
          MOVE     CEPPB12,CSTB12
          MOVE     CEPPB13,CSTB13
          MOVE     CEPPB14,CSTB14
          MOVE     CEPPB15,CSTB15
.
GETMOD99  RETURN
.
.----------------------------------------------------------------------
. Enter Casemix Extract ID
.----------------------------------------------------------------------
EEID0000  MOVE      ZERO,CKEYTYP
          CALL      KCCEAA00
          BRANCH    EXIT,EEID9999,EEID9999
          CALL      GETCME00
          MOVE      ZERO,OVRCD
.
EEID9999  RETURN
.======================================================================
. Determine Display Values for a Valid Casemix Extract Code
.======================================================================
GETCME00  MATCH     SP70,CCEAFDD
          IF        @EQUAL
            MOVE      "Start     ",FROMDD
          ELSE
            UNPACK    CCEAFDD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,FROMDD
          ENDIF
.
          MATCH     "99999999",CCEATDD
          IF        @EQUAL
            MOVE      "Finish    ",TODD
            MOVE      "Start     ",FROMNEW
            MOVE      "Finish    ",TONEW
            MOVE      SP70,NEWFROM
            MOVE      "99999999",NEWTO
          ELSE
            MOVE      CCEATDD,NEWFROM
            UNPACK    CCEATDD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,TODD
            MOVE      CPCDATE,FROMNEW
            MOVE      CMON,F2
            ADD       ONE,F2
            MOVE      F2,CMON
            PACK      NEWTO,CCENT,CYEAR,CMON,CDAY
            REP       " 0",NEWTO
            UNPACK    NEWTO,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,TONEW
          ENDIF
.
          MATCH     SP70,CCEAFAD
          IF        @EQUAL
            MOVE      "Start     ",FROMAD
          ELSE
            UNPACK    CCEAFAD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,FROMAD
          ENDIF
.
          MATCH     "99999999",CCEATAD
          IF        @EQUAL
            MOVE      "Finish    ",TOAD
          ELSE
            UNPACK    CCEATAD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,TOAD
          ENDIF
.
          MOVE     CCEAVIS,F1
          BRANCH   F1,GETCME10,GETCME20,GETCME30
          MOVE     "All        ",VISITDES
          GOTO     GETCME40
GETCME10  MOVE     "A & E      ",VISITDES
          GOTO     GETCME40
GETCME20  MOVE     "Outpatients ",VISITDES
          GOTO     GETCME40
GETCME30  MOVE     "Inpatients",VISITDES
          GOTO     GETCME40
.
GETCME40
          MOVE     SP70,CLV1DES
          MOVE     SP70,CLV2DES
          MOVE     SP70,CLV3DES
          MOVE     CCEALV1,KEY3
          CALL     RDCCST1
          IF       OVRCD=0
            MOVE     CCSTDES,CLV1DES
          ENDIF
.
          MOVE     CCEALV2,KEY3
          CALL     RDCCST1
          IF       OVRCD=0
            MOVE     CCSTDES,CLV2DES
          ENDIF
.
          MOVE     CCEALV3,KEY3
          CALL     RDCCST1
          IF       OVRCD=0
            MOVE     CCSTDES,CLV3DES
          ENDIF
.
          MATCH    "0",CCEAUST
          IF       !@EQUAL
            MOVE     ONE,CCEAUST
          ENDIF
.
          MOVE       CCEADAY,F1
          IF         F1=0
            MOVE       "Exclude Day Cases",DAYCDESC
          ELSE
            IF         F1=2
              MOVE       "Day Cases Only",DAYCDESC
            ELSE
              MOVE       "Include Day Cases",DAYCDESC
            ENDIF
          ENDIF
.
          RETURN
RDATE000   MOVE     "   18",FLDID
           CALL     GETPOSIT
           UNPACK   CCEATDD,CCENT,CYEAR,CMON,CDAY
           CALL     KEYDATE
           BRANCH   OVRCD,RDATE100
           MATCH    SP2,CDAY
           GOTO     RDATE100 IF EQUAL
           PACK     NEWFROM,CCENT,CYEAR,CMON,CDAY
           REP      " 0",NEWFROM
           CALL     PACDATE
           MOVE     CPCDATE,FROMNEW
           GOTO     RDATE140
RDATE100   MOVE     "Start             ",FROMNEW
           MOVE     SP70,NEWFROM
.
RDATE140   MOVE     FROMNEW,VAR
           CALL     DISPITEM
.
RDATE150   MOVE     "   19",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RDATE200
           MATCH    SP2,CDAY
           GOTO     RDATE200 IF EQUAL
           PACK     NEWTO,CCENT,CYEAR,CMON,CDAY
           REP      " 0",NEWTO
           CALL     PACDATE
           MOVE     CPCDATE,TONEW
           MATCH    NEWFROM,NEWTO
           GOTO     RDATE999 IF EQUAL
           GOTO     RDATE999 IF NOT LESS
           BEEP
           MOVE     "To Date Must Be > From Date - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RDATE000
.
RDATE200   MOVE     "Finish             ",TONEW
           MOVE     "99999999",NEWTO
.
RDATE999   MOVE     "   18",FLDID
           CALL     GETPOSIT
           RETURN

.---------------------------------------------------------------------------
. Read any Range Details
.---------------------------------------------------------------------------
GETEXT00  PACK     KEY4,CCEAEID
          CALL     CLREXT00          * Clear Record
          CALL     RDCCEX1             * Read Record
          IF       OVRCD=0
            CALL     SETEXT00          * Setup Names
          ENDIF
          RETURN
.
SETEXT00  MOVE      ZERO,SECTOR
          REPEAT
            ADD       ONE,SECTOR
            LOAD      KEY3,SECTOR,CCEXR01,CCEXR02,CCEXR03,CCEXR04,CCEXR05:
                                  CCEXR06,CCEXR07,CCEXR08,CCEXR09,CCEXR10:
                                  CCEXR11,CCEXR12,CCEXR13,CCEXR14
            MATCH     SP70,KEY3
            IF        !@EQUAL
              CALL      RDCCST1
              STORE     CCSTDES,SECTOR,DESC01,DESC02,DESC03,DESC04,DESC05:
                                       DESC06,DESC07,DESC08,DESC09,DESC10:
                                       DESC11,DESC12,DESC13,DESC14
.
              LOAD      KEY10,SECTOR,CCEXF01,CCEXF02,CCEXF03,CCEXF04,CCEXF05:
                                     CCEXF06,CCEXF07,CCEXF08,CCEXF09,CCEXF10:
                                     CCEXF11,CCEXF12,CCEXF13,CCEXF14
              SFORMAT   VAR,CCSTLEN
              MATCH     SP70,KEY10
              IF        @EQUAL
                MOVE      "Start                        ",KEY35
              ELSE
                PACK      KEY13,CCSTSTY,KEY10
                CALL      RDCCXH1
                MOVE      KEY10,VAR
                PACK      KEY35,VAR,SP1,CCXHDES
              ENDIF
              STORE     KEY35,SECTOR,FROM01,FROM02,FROM03,FROM04,FROM05:
                                    FROM06,FROM07,FROM08,FROM09,FROM10:
                                    FROM11,FROM12,FROM13,FROM14
.
              LOAD      KEY10,SECTOR,CCEXT01,CCEXT02,CCEXT03,CCEXT04,CCEXT05:
                                     CCEXT06,CCEXT07,CCEXT08,CCEXT09,CCEXT10:
                                     CCEXT11,CCEXT12,CCEXT13,CCEXT14
              SFORMAT   VAR,CCSTLEN
              MATCH     Z70,KEY10
              IF        @EQUAL
                MOVE      "Finish                       ",KEY35
              ELSE
                PACK      KEY13,CCSTSTY,KEY10
                CALL      RDCCXH1
                MOVE      KEY10,VAR
                PACK      KEY35,VAR,SP1,CCXHDES
              ENDIF
              STORE     KEY35,SECTOR,TO01,TO02,TO03,TO04,TO05:
                                    TO06,TO07,TO08,TO09,TO10:
                                    TO11,TO12,TO13,TO14
              SFORMAT   VAR,127
            ENDIF
         UNTIL      SECTOR=14
         RETURN
.
CLREXT00  MOVE      SP70,CCEXR01
          MOVE      SP70,CCEXF01
          MOVE      SP70,CCEXT01
          MOVE      SP70,CCEXR02
          MOVE      SP70,CCEXF02
          MOVE      SP70,CCEXT02
          MOVE      SP70,CCEXR03
          MOVE      SP70,CCEXF03
          MOVE      SP70,CCEXT03
          MOVE      SP70,CCEXR04
          MOVE      SP70,CCEXF04
          MOVE      SP70,CCEXT04
          MOVE      SP70,CCEXR05
          MOVE      SP70,CCEXF05
          MOVE      SP70,CCEXT05
          MOVE      SP70,CCEXR06
          MOVE      SP70,CCEXF06
          MOVE      SP70,CCEXT06
          MOVE      SP70,CCEXR07
          MOVE      SP70,CCEXF07
          MOVE      SP70,CCEXT07
          MOVE      SP70,CCEXR08
          MOVE      SP70,CCEXF08
          MOVE      SP70,CCEXT08
          MOVE      SP70,CCEXR09
          MOVE      SP70,CCEXF09
          MOVE      SP70,CCEXT09
          MOVE      SP70,CCEXR10
          MOVE      SP70,CCEXF10
          MOVE      SP70,CCEXT10
          MOVE      SP70,CCEXR11
          MOVE      SP70,CCEXF11
          MOVE      SP70,CCEXT11
          MOVE      SP70,CCEXR12
          MOVE      SP70,CCEXF12
          MOVE      SP70,CCEXT12
          MOVE      SP70,CCEXR13
          MOVE      SP70,CCEXF13
          MOVE      SP70,CCEXT13
          MOVE      SP70,CCEXR14
          MOVE      SP70,CCEXF14
          MOVE      SP70,CCEXT14
          MOVE      SP70,DESC01
          MOVE      SP70,DESC02
          MOVE      SP70,DESC03
          MOVE      SP70,DESC04
          MOVE      SP70,DESC05
          MOVE      SP70,DESC06
          MOVE      SP70,DESC07
          MOVE      SP70,DESC08
          MOVE      SP70,DESC09
          MOVE      SP70,DESC10
          MOVE      SP70,DESC11
          MOVE      SP70,DESC12
          MOVE      SP70,DESC13
          MOVE      SP70,DESC14
          MOVE      SP70,FROM01
          MOVE      SP70,FROM02
          MOVE      SP70,FROM03
          MOVE      SP70,FROM04
          MOVE      SP70,FROM05
          MOVE      SP70,FROM06
          MOVE      SP70,FROM07
          MOVE      SP70,FROM08
          MOVE      SP70,FROM09
          MOVE      SP70,FROM10
          MOVE      SP70,FROM11
          MOVE      SP70,FROM12
          MOVE      SP70,FROM13
          MOVE      SP70,FROM14
          MOVE      SP70,TO01
          MOVE      SP70,TO02
          MOVE      SP70,TO03
          MOVE      SP70,TO04
          MOVE      SP70,TO05
          MOVE      SP70,TO06
          MOVE      SP70,TO07
          MOVE      SP70,TO08
          MOVE      SP70,TO09
          MOVE      SP70,TO10
          MOVE      SP70,TO11
          MOVE      SP70,TO12
          MOVE      SP70,TO13
          MOVE      SP70,TO14
          RETURN
.---------------------------------------------------------------------------
. Read any Range Details
.---------------------------------------------------------------------------
GETMEA00  MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          PACK     KEY4,CCEAEID
          CALL     CLRMEA00          * Clear Record
          CALL     RDCCEY1           * Read Record
          RETURN
.
CLRMEA00  MOVE     CCEAEID,CCEYEID * Include All As Default
          MOVE     ONE,CCEYBA1
          MOVE     ONE,CCEYBA2
          MOVE     ONE,CCEYBA3
          MOVE     ONE,CCEYBAO
          MOVE     ONE,CCEYITH
          MOVE     ONE,CCEYIA1
          MOVE     ONE,CCEYIA2
          MOVE     ONE,CCEYIA3
          MOVE     ONE,CCEYIAO
          MOVE     ONE,CCEYIM1
          MOVE     ONE,CCEYIM2
          MOVE     ONE,CCEYIM3
          MOVE     ONE,CCEYIMO
          MOVE     ONE,CCEYETH1
          MOVE     ONE,CCEYEA11
          MOVE     ONE,CCEYEA21
          MOVE     ONE,CCEYEA31
          MOVE     ONE,CCEYEAO1
          MOVE     ONE,CCEYEM11
          MOVE     ONE,CCEYEM21
          MOVE     ONE,CCEYEM31
          MOVE     ONE,CCEYEMO1
          MOVE     ONE,CCEYETH2
          MOVE     ONE,CCEYEA12
          MOVE     ONE,CCEYEA22
          MOVE     ONE,CCEYEA32
          MOVE     ONE,CCEYEAO2
          MOVE     ONE,CCEYEM12
          MOVE     ONE,CCEYEM22
          MOVE     ONE,CCEYEM32
          MOVE     ONE,CCEYEMO2
          MOVE     ONE,CCEYETH3
          MOVE     ONE,CCEYEA13
          MOVE     ONE,CCEYEA23
          MOVE     ONE,CCEYEA33
          MOVE     ONE,CCEYEAO3
          MOVE     ONE,CCEYEM13
          MOVE     ONE,CCEYEM23
          MOVE     ONE,CCEYEM33
          MOVE     ONE,CCEYEMO3
          MOVE     ONE,CCEYETH4
          MOVE     ONE,CCEYEA14
          MOVE     ONE,CCEYEA24
          MOVE     ONE,CCEYEA34
          MOVE     ONE,CCEYEAO4
          MOVE     ONE,CCEYEM14
          MOVE     ONE,CCEYEM24
          MOVE     ONE,CCEYEM34
          MOVE     ONE,CCEYEMO4
          MOVE     ONE,CCEYETH5
          MOVE     ONE,CCEYEA15
          MOVE     ONE,CCEYEA25
          MOVE     ONE,CCEYEA35
          MOVE     ONE,CCEYEAO5
          MOVE     ONE,CCEYEM15
          MOVE     ONE,CCEYEM25
          MOVE     ONE,CCEYEM35
          MOVE     ONE,CCEYEMO5
          MOVE     SP70,CCEYSPA
          RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CCSAGEIO/INC
          INC       CCSCEAIO/INC
          INC       CCSCEAKY    
          INC       CCSCEBIO/INC
          INC       CCSCECIO/INC
          INC       CCSCEDIO/INC
          INC       CCSCEEIO/INC
          INC       CCSCEFIO/INC
          INC       CCSCEGIO/INC
          INC       CCSCEXIO/INC
          INC       CCSCONIO/INC
          INC       CCSCOPCD    
          INC       CCSDRGIO/INC
          INC       CCSEPSIO/INC
          INC       CCSEYAIO/INC
          INC       CCSG58CD    
          INC       CCSHCDIO/INC
          INC       CCSIADIO/INC
          INC       CCSSTYIO/INC
          INC       CCSSTYKY    
          INC       CCSXHDIO/INC
          INC       CCSXHDKY    
          INC       CEAPMDIO/INC
          INC       CEAPPMIO/INC
          INC       PATITMIO/INC
.
          INC       STDGENCD
.
