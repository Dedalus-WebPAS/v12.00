.
.---------------------------------------------------------------------------
.   System    :   Patient System (New Standards)     
.   Include   :   CEAWRDKY
.   Routine   :   KPWR1A00 Keyin Ward                
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KPWR1A00  TOPIC     "WWARD "
          MOVE      UNDLN70,WWARD 
          KEYIN     *PCCOL:CVERT,*DV,WWARD:                                   
                    *PCCOL:CVERT,*V2LON,WWARD:                                
                    *PCCOL:CVERT,*DV,WWARD 
.
          ENDSET    WWARD 
          APPEND    SP70,WWARD 
          RESET     WWARD 
.
          MATCH     SP70,WWARD 
          GOTO      KPWR1A90 IF EQUAL
.
          CMATCH    EXITCHAR,WWARD 
          GOTO      KPWR1A95 IF EQUAL
.
          CMATCH    QUEST,WWARD 
          GOTO      KPWR1A10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HPWR1A00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    WWARD 
          APPEND    SP70,WWARD 
          RESET     WWARD 
.
          MATCH     SP70,WWARD 
          GOTO      KPWR1A00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,WWARD                                 
KPWR1A10
          PACK      KEY6,WWARD,WBED                                        
          CALL      RDAWARD1 
          BRANCH    OVRCD,KPWR1A80
          BRANCH    CKEYTYP,KPWR1A75
          CALL      RDWARD1 
KPWR1A70
          MOVE      ZERO,EXIT
          GOTO      KPWR1A99
KPWR1A75
          MOVE      "Ward Already Exist - ",DISPMSG                                                  
          CALL      MESSAGE1
          GOTO      KPWR1A00
KPWR1A80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KPWR1A99,KPWR1A99
          MOVE      "Ward Does Not Exist - ",DISPMSG                                                 
          CALL      MESSAGE1
          GOTO      KPWR1A00
KPWR1A90
          MOVE      ONE,EXIT
          GOTO      KPWR1A99
KPWR1A95
          MOVE      TWO,EXIT
KPWR1A99 TOPIC    PRGID
          RETURN
.
.---------------------------------------------------------------------------
.   System    :   Patient System (New Standards)     
.   Include   :   CEAWRDKY
.   Routine   :   HPWR1A00 Ward                
.   Return    :   WWARD 
.-------------------------------------------------------------------------------
HPWR1A00
          CALL      EPWR1A00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "40",HLEF
            MOVE      "80",HRIG
          ENDIF
HPWR1A04
          CALL      GSCRN000
          BRANCH    EXIT,HPWR1A99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Ward"               
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 5",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "30",STDCOL03
HPWR1A08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,WWARD 
          PACK      KEY6,WBED,WWARD,SP70                                   
          PACK      SAVKEY80,WBED,WWARD,SP70                               
          SETLPTR   SAVKEY80,3                                                  
          CALL      RDSWARD3 
HPWR1A10
          CALL      RDKWARD3 
          BRANCH    OVRCD,HPWR1A15
          PACK      KEY6,WBED,WWARD,SP70                                   
          MATCH     SAVKEY80,KEY6                                               
          GOTO      HPWR1A15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,HPWR1A12
          CALL      HPWR1A60
          BRANCH    OVRCD,HPWR1A10
HPWR1A12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY6,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,WWARD 
          DISPLAY   *PSTDCOL02:STDROW,WBDESC 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HPWR1A10 IF NOT EQUAL
HPWR1A15
          UNPACK    SAVKEY80,WBED,WWARD                                    
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HPWR1A20
          CALL      HSCRI000
          BRANCH    EXIT,HPWR1A30,HPWR1A35,HPWR1A40,HPWR1A45,HPWR1A04:
                              HPWR1A91,HPWR1A50
          GOTO      HPWR1A92
HPWR1A30
          CALL      RDKWARD3 
          BRANCH    OVRCD,HPWR1A85
          PACK      KEY6,WBED,WWARD,SP70                                   
          MATCH     SAVKEY80,KEY6                                               
          GOTO      HPWR1A85 IF NOT EQUAL                                       
          CALL      RDPWARD3 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HPWR1A10
HPWR1A35
          MOVE      ST1,KEY6 
          CALL      RDWARD3 
          CALL      RDPWARD3 
          BRANCH    OVRCD,HPWR1A85
          PACK      KEY6,WBED,WWARD,SP70                                   
          MATCH     SAVKEY80,KEY6                                               
          GOTO      HPWR1A85 IF NOT EQUAL                                       
          MATCH     SP70,WWARD                                                
          GOTO      HPWR1A85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HPWR1A36
          CALL      RDPWARD3 
          BRANCH    OVRCD,HPWR1A37
          PACK      KEY6,WBED,WWARD,SP70                                   
          MATCH     SAVKEY80,KEY6                                               
          GOTO      HPWR1A37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HPWR1A36 IF NOT EQUAL
HPWR1A37
          MOVE      ZERO,XITEMNO
          GOTO      HPWR1A10
HPWR1A40
          MOVE      ST1,KEY6 
          CALL      RDWARD3 
          CALL      RDPWARD3 
          BRANCH    OVRCD,HPWR1A85
          PACK      KEY6,WBED,WWARD,SP70                                   
          MATCH     SAVKEY80,KEY6                                               
          GOTO      HPWR1A85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HPWR1A08
HPWR1A45
          CALL      RDKWARD3 
          BRANCH    OVRCD,HPWR1A85
          PACK      KEY6,WBED,WWARD,SP70                                   
          MATCH     SAVKEY80,KEY6                                               
          GOTO      HPWR1A85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY6,SAVKEY80,Z70                                           
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RDSWARD3 
HPWR1A46
          CALL      RDPWARD3 
          BRANCH    OVRCD,HPWR1A47
          PACK      KEY6,WBED,WWARD,SP70                                   
          MATCH     SAVKEY80,KEY6                                               
          GOTO      HPWR1A47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HPWR1A46 IF NOT EQUAL
HPWR1A47
          MOVE      ZERO,XITEMNO
          GOTO      HPWR1A10
HPWR1A50  COMPARE   ZERO,CSEARCH
          GOTO      HPWR1A55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HPWR1A08
HPWR1A55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HPWR1A08
HPWR1A60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HPWR1A61 IF EQUAL
          MATCH     SCHFLD01,WWARD 
          GOTO      HPWR1A72 IF NOT EQUAL
HPWR1A61
          MATCH     SP70,SCHFLD02
          GOTO      HPWR1A62 IF EQUAL
          MATCH     SCHFLD02,WBDESC 
          GOTO      HPWR1A72 IF NOT EQUAL
HPWR1A62
HPWR1A63
HPWR1A64
HPWR1A65
HPWR1A66
HPWR1A67
HPWR1A68
HPWR1A69
HPWR1A70
          GOTO      HPWR1A75
HPWR1A72  MOVE      ONE,OVRCD
HPWR1A75  RETURN
HPWR1A85
          LOAD      KEY6,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY6,WBED,WWARD                                        
          CALL      RDWARD3 
HPWR1A90
          UNPACK    SAVKEY80,WBED,WWARD                                    
          BEEP
          GOTO      HPWR1A20
HPWR1A91
          MOVE      SP70,KEY6 
          MOVE      SP70,WBDESC 
          MOVE      SP70,DWADMNO 
          MOVE      SP70,WEXTN
          MOVE      ZERO,WBLINE
          MOVE      SP70,WRTYPE
          MOVE      SP70,WEFRBT  
          MOVE      ZERO,WNBEDS
          MOVE      ZERO,WHCSSUB
          MOVE      SP70,WSERV
          MOVE      ZERO,WPLUR
          MOVE      ZERO,WINPUT
          MOVE      ZERO,WOCCBED
          MOVE      SP70,WCLASS
          MOVE      SP70,DWSTBY 
          MOVE      ZERO,WACTIVE
          MOVE      SP70,PTWDHOSN
          MOVE      ZERO,PTWDDNIN
          MOVE      SP70,PTWDIAGE
          MOVE      SP70,PTWDICRE
          MOVE      SP70,PTWDSEX 
          MOVE      SP70,PTWDLOCN
          MOVE      SP70,PTWDGLDG
          MOVE      SP70,PTWDNSTA
          MOVE      SP70,PTWDDOSA
          MOVE      SP70,PTWDSPAR
          GOTO      HPWR1A96
HPWR1A92
          MOVE      SP70,KEY6 
          MOVE      SP70,WWARD 
          LOAD      KEY6,CCITEM,ST1,ST2,ST3,ST4,ST5:                            
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY6,WBED,WWARD                                        
HPWR1A96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HPWR1A99
          RETURN
.
.------------------------------------------------------------
. Clear Bed Field for Ward Only Display
.------------------------------------------------------------
EPWR1A00  MOVE       SP70,WBED
          RETURN
