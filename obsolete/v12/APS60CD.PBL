. Modifications:
.
.V10.02.01  07/04/2011 Mike Laming for Jill CAR 239574
.           Remove CALL to ' IBAPRNT1,"ibaprntf" '
. 27.03.2009 Sandra Barcham               CAR 172763
.            Added FMCOEPWC into standard laser layout
. 30.07.2007 Sandra Barcham              CAR 146314
.            Re-used cheque layout 4 (DVC) for Modbury
. 03.04.2003 Peter Vela                   CAR 19895
.            Changed system date to cheque printing date for all cheque layouts
. 20.05.2002 Raghunandan Surve,HPS -      SRF17025
.            Moved cheque layout for Mercy down by half-a-line !
. 14.05.2002 Raghunandan Surve,HPS -      SRF17025
.            Moved cheque layout for Mercy up by one line
. 14.05.2002 Raghunandan Surve,HPS -      SRF17025
.            Copied over changes for Mercy cheque layout from f.01
. 03.09.2001 Glenn Saunders  srf 10799 - continuation of Dave Matthews.
.            Fix printing for Hutt, which were made in f.01 (and not here !!)   
.            (Find FMCOAPCH = 14)
. 22.08.2001 Glenn Saunders  srf 10799 - continuation of Dave Matthews.
.            Amend printing of cheques for Mercy (Dunedin)                      
.            (Find FMCOAPCH = 23)
. 26.06.2001 Dave Matthews  
.            Amend printing of cheques for Mercy (Dunedin)                      
.            (Find FMCOAPCH = 23)
. 10.04.2001 Dave Matthews  
.            Alter processing for new cheque layout for Hutt Valley NZ          
.            (Find FMCOAPCH = 14)
. 12.12.2000 Charles Handaya
.            Add in new MHD layout for Mercy Hospital Dunedin in Laser printer
. 28.11.2000 Sandra Barcham 
.            Add in BAS Code
. 23.10.2000 Charles Handaya
.            Add in new HWK layout that copied from 0=std 
. 12.10.2000 Charles Handaya
.            Default to Ledger specified in parameter system (FMDEFLED),
.            before creating a Batch.
.            Add a Date printed at Cheque Remittance for Layout 19
.            srf 6645
. 18.09.2000 Charles Handaya
.            Fix CHC layout
. 04.08.2000 Charles Handaya
.            Add in new STH layout
.            srf 647056
. 07.01.2000 Charles Handaya
.            Fix LTR layout 
.            srf 636139
. 09.11.1999 Sandra Barcham
.            Fix LTR layout
. 04.11.1999 Sandra Barcham
.            Fix problems apsbnkaf.txt for MHD
.            srf 645998
. 30.10.1999 Sandra Barcham
.            Print creditors bank if direct debit
.            srf 646058
. 11.07.1999 Sandra Barcham
.            Add in LTR layout
. 01.07.1999 Sandra Barcham
.            Add in LAS layout
. 13.05.1999 Sandra Barcham
.            Add in SVB layout
. 13.04.1998 Sandra Barcham
.            Add in new STV layout
. 29.01.1998 Sandra Barcham
.            Move STD amount right 2 characters
. 07.01.1998 Sandra Barcham
.            Change to new cheque layout for ACC
.            srf 622472 Quote 9012
. 18.11.1997 Sandra Barcham
.            Change to new cheque layout for ACC & WGH
.            srf 622472 Quote 9012 & 622882
. 14.10.1997 Sandra Barcham
.            Change new STD layout for epworth
.            srf 622235
. 11.09.1997 Sandra Barcham
.            Add in new HSP layout
.            srf 621687
.            Check new STD layout against epworth cheques
. 13.08.1997 Sandra Barcham
.            Add in new WWH layout
.            srf 621337
. 12.08.1997 Sandra Barcham
.            Remove *f from cheque for Hut
.            Fix invoice date on HUT layout
.            srf 621071 & 621292
. 28.07.1997 Sandra Barcham
.            Read batch default ledger from first transaction in batch
.            srf 621038
. 11.07.1997 Sandra Barcham
.            Change HUT layout
. 27.05.1997 Sandra Barcham
.            Add in new HUT layout
. 07.04.1997 Sandra Barcham
.            Add in new std layout
.            srf 619570
. 04.11.1996 Sandra Barcham
.            Add in SAR & MAT
.            quotes 8781 & 8783
. 09.10.1996 Sandra Barcham
.            Fix WGH Cheque Layout for STV
.            srf 617368
. 19.08.1996 Sandra Barcham
.            Add Hawkesbury Cheque Layout
.            srf 616354 quote 8717
. 08.08.1996 B.G.Ackland
.            Allow direct debit payments 
.            srf 614788 quote 8691
. 13.06.1996 Sandra Barcham
.            Change Buderim Cheque Layout
.            srf 615591 quote 8682
. 30.05.1996 Sandra Barcham
.            Add Buderim Cheque Layout
.            quote 8682
. 06.03.1996 Sandra Barcham
.            Write user defined ref 1 instead of cheque no to apsbnkaf
.            srf 614110
. 18.10.1995 Sandra Barcham
.            Write bank transfer details apsbnkaf
.            srf 611352
. 12.09.1995 B.G.Ackland
.            Fixed Credit Not Outstanding Problem
.            srf 611052
. 12.09.1995 B.G.Ackland
.            Added Cancelled Cheques in WGH Layout
.            srf 611137
. 24.11.1994 Robert Sumsion
.            Moved PVH up 1 in cheque only part.
. 26.10.1994 Robert Sumsion
.            Changed CHC to print 1,000,000 in words correctly
.            srf 133054
. 19.08.1994 Robert Sumsion
.            Added Cheque print for Pioneer Valley Hospital
.            srf 129566 quote 8060
. 08.07.1994 Robert Sumsion
.            Added Cheque print for Greymouth                  
.            quote 8032
. 15.03.1994 S.Barcham
.            Fix paying of credit notes.
.            srf 120955
. 24.03.1994 S.Barcham
.            Fix WGH cheques printing over 2 pages
.            srf 121309 & 121345
. 13.07.1993 N.Dye
.            Modify Tamara layout
.            srf 123857
. 18.04.1993 Sandra Barcham
.            Added ACC Layout     
.            srf 128720
.-------------------------------------------------------------------
. Update Creditors Payments, Print Cheques and Remittances
.           and create General Ledger batch details.
.-------------------------------------------------------------------
UPDT0000  CALL      CBAT0000              * Check Batch
          BRANCH    EXIT,UPDT9990         * Batch Not Balanced Exit
.
          CLOSE     SCRSBGA1
          CLOSE     SCRPSTA1
          CLOSE     SCRPSTA2
          CLOSE     SCRSLTA1
.
          CALL      INITB000              * Initialise Files & Parameters
.
          CALL      UPINV000              * Update Original Invoices Payment
.
          CALL      UPFMS000              * Update General Ledger Batch
.
          CALL      CLOSE000              * Close Files etc
.
          OPEN      SCRSBGA1,"scrsbgaf"
          OPEN      SCRPSTA1,"scrpstaf"
          OPEN      SCRPSTA2,"scrpstaf"
          OPEN      SCRSLTA1,"scrsltaf"
.
          MOVE      TWO,EXIT              * Restart Screen
          GOTO      UPDT9999
.
UPDT9990  MOVE      THREE,EXIT            * Restore Screen
.
UPDT9999  RETURN
.----------------------------------------------------------
. Close Files Not Required & Update Batch Header with Date
.----------------------------------------------------------
CLOSE000  CLOSE     APSTMPA1,DELETE
          CLOSE     APSGSTA1,DELETE
          PACK      KEY5,APBMBCH
          PACK      APBMUDT,CCC,CYY,CMM,CDD
          REP       " 0",APBMUDT
          CALL      RAAPBM1
          IF        OVRCD=0
            CALL      UPAPBM1
            CALL      UUAPBM1         * Unlock Record
          ENDIF
          RETURN
.----------------------------------------------------------------------
. Create Input Record for G.S.T.
.----------------------------------------------------------------------
MVINP000  MOVE     APIMBCH,APINBCH
          MOVE     APIMCRD,APINCRD
          MOVE     APIMREF,APINREF
          MOVE     APIMDOC,APINDOC
          MOVE     SP70,APINORD
          MOVE     "  1",APINLIN
          MOVE     SP70,APINCAT
          MOVE     ZERO,APINQTY
          MOVE     ZERO,APINUCT
          MOVE     ZERO,APINPAY
          MOVE     SP70,APINSPA
          RETURN
.----------------------------------------------------------------------
. Create Batch for FMS system
.----------------------------------------------------------------------
UPFMS000  CALL      MKBAT000           * Create Batch and Write Initail Sectors
.
          DISPLAY   *P1:24,*EL
          PACK      KEY40,APBMBCH,SP70
          CALL      RSAPIM1
.
UPFMS100  CALL      RKAPIM1            * Read Through Invoices
          BRANCH    OVRCD,UPFMS900
          MATCH     APBMBCH,APIMBCH
          GOTO      UPFMS900 IF NOT EQUAL
          DISPLAY   *P1:24,"Processing FMS Creditor : ",*V2LON,APIMCRD,*HOFF:
                    "  Ref : ",*V2LON,APIMDOC
          MATCH     "~~",APIMCRD
          IF        @EQUAL
            UNPACK    APIMCRD,KEY2,KEY3
            PACK      KEY8,APBMBCH,KEY3
            CALL      RDAPNS1
            MOVE      APNSNA1,APMACN1
          ELSE
            MOVE      APIMCRD,KEY5
            CALL      RDAPMA1
          ENDIF
.
          PACK      KEY51,APIMBCH,APIMCRD,APIMREF,APIMDOC,SP70
          PACK      KEY40,APIMBCH,APIMCRD,APIMREF,APIMDOC
          CALL      RSAPIN1
.
UPFMS110  CALL      RKAPIN1           * Read Through Allocations
          BRANCH    OVRCD,UPFMS100
          PACK      KEY51,APINBCH,APINCRD,APINREF,APINDOC,SP70
          MATCH     KEY40,KEY51
          GOTO      UPFMS100 IF NOT EQUAL
.
          CALL      WRBCH000          * Update Batch Record
          CALL      ALGST000          * Allocate Gst
          GOTO      UPFMS110
.
. Update Batch Header and Write Control Account Records
.----------------------------------------------------------------------
UPFMS900  ADD       ONE,BC0NXTSC
          WEOF      BATFILE,BC0NXTSC
          MOVE      BC1ACCT,BC1KEYT
          CALL      WRBAT1
.
          CALL      CCTR0000           * Update Totals in Batch
          CALL      UPGL0000           * Update Batch Queue
.
UPFMS999  RETURN
.----------------------------------------------------------------------
. Create Batch
.----------------------------------------------------------------------
MKBAT000  MOVE      APBMBCH,BC1BATCH
          MOVE      ZERO,BC0BTCHT
          MOVE      SP2,BC0DIM2
          MOVE      TWO,BC0NXTSC
          MOVE      ZERO,BC0NXTSW
          MOVE      ONE,BC0SUPBC
          MOVE      SP6,BC0DIM6
          MOVE      ZERO,BC0SPLTK
          MOVE      ZERO,BC0SPLTP
          MOVE      ONE,BC0ONE
          MOVE      ZERO,BC0SPSEC
          MOVE      ZERO,BC0DISC
.
          CLEAR     FNAME
          APPEND    "bch",FNAME
          APPEND    BC1BATCH,FNAME
          APPEND    ".txt",FNAME
          RESET     FNAME
          PREP      BATFILE,FNAME
          CALL      WRBAT0
.
          MOVE      FIVE,BC1STAT
          MOVE      "HD",BC1HEAD
          MOVE      BC1BATCH,BCBATCH
          MOVE      ZERO,BC1KEYT
          MOVE      ZERO,BC1ACCT
          MOVE      ZERO,BC1NOTR
.
          UNPACK    APBMDAT,CCENT,CYEAR,CMON,CDAY
          PACK      BC1DATE,CDAY,CMON,CCENT,CYEAR
          REP       " 0" IN BC1DATE
          MOVE      APBMOPR,BC1OPER
          MOVE      APBMLED,BC1LEDG
          MOVE      BC1LEDG,BCLEDG
          MOVE      "PY",BC1TRAN
          UNPACK    APBMADT,CCENT,CYEAR,CMON,CDAY
          PACK      BC1BDATE,CDAY,CMON,CCENT,CYEAR
          REP       " 0" IN BC1BDATE
          MOVE      ZERO,BC1REORG
          MOVE      APBMDIS,BC1DISS
          MOVE      BC1DISS,BCDISS
          MOVE      SP2,BC1PAYT
          MOVE      APBMRES,BC1RESP
          MOVE      BC1RESP,BCRESP
          MOVE      ZERO,BC1REST
          MOVE      ZERO TO BC1UTYPE
.
          CALL      WRBAT1
.
          RETURN
.----------------------------------------------------------------------
. Write Batch Transaction
.----------------------------------------------------------------------
WRBCH000  MOVE      "PY",BCTRAN
          MOVE      APINLED,BCLEDG
          MOVE      APINACC,BCACCTP
          MOVE      APINAMT,BCAMT
          MOVE      APINREF,BCREFER
          MOVE      APINDES,BCTRAND
          MOVE      APINRES,BCRESP
          MOVE      APINDIS,BCDISS
.
          CALL      RDBATS0
          ADD       ONE,BC0NXTSC
          CALL      WRBATS0
          SUB       ONE FROM BC0NXTSC
.
          MOVE      FIVE,BCSTAT
          MOVE      APIMTER,BCPAYT
          MOVE      APIMCRD,BCRED
          UNPACK    APIMIDT,CCENT,CYEAR,CMON,CDAY
          PACK      BCDATEE,CDAY,CMON,CCENT,CYEAR
          REP       " 0" IN BCDATEE
          MOVE      BC1BDATE,BCDATED
          MOVE      "00000000",BCDATCX
          MOVE      ZERO,BCINVT
          MOVE      ZERO,BCDISC
          MOVE      "0",BCCOMX
          MOVE      ZERO,BCCOMXA
          MOVE      SP70,BCCONT
          MOVE      SP70,BCDISCC
.
          PACK      KEY2,APINLED
          CALL      RDFMLA1
          PACK      KEY14,APINLED,APINACC
          CALL      RDFMAM1
          CALL      RFMCOT00
.
          MATCH     "~~",APINCRD
          IF        @EQUAL
            MOVE      APINACC,BCACCT *  Account Code
          ELSE     
            MATCH     SP70,APINREF
            IF        @EQUAL
              MOVE      APINACC,BCACCT *  Account Code
            ELSE
              MATCH     ANSZ,APINPAYG
              IF        @EQUAL
                MOVE      FMLAPAYG,BCACCT
              ELSE
                MOVE      FMCSCRD,BCACCT
              ENDIF
              UNPACK    APINDES,KEY5,KEY15,KEY8,KEY3,KEY1
              MOVE      KEY1,F1
              CLEAR     BCTRAND
              IF        F1=0
                APPEND    "Inv. Batch : ",BCTRAND
              ELSE
                APPEND    "Cr.  Batch : ",BCTRAND
              ENDIF
              APPEND    KEY5,BCTRAND
              APPEND    "  Ord. : ",BCTRAND
              APPEND    KEY8,BCTRAND
              RESET     BCTRAND
            ENDIF
          ENDIF
.         
          MOVE      FMCSBNK,BCCONT
          PACK      KEY14,APINLED,FMCSBNK
          CALL      RDAPTM1
          BRANCH    OVRCD,WRBCH100
.
          ADD       BCAMT,APTMAMT
          CALL      UPAPTM1
          GOTO      WRBCH200
.
WRBCH100  UNPACK    KEY14,APTMLED,APTMACC
          MOVE      BCAMT,APTMAMT
          CALL      WRAPTM1
.
WRBCH200  MOVE      APBMCHQ,BCCHQAC
          MATCH     "DD-",APINDOC
          IF        @EQUAL
            MOVE      APINDOC,BCORD
          ELSE
            UNPACK    APINDOC,KEY7,BCORD 
          ENDIF
          MOVE      APMACN1,BCCDESC
          MOVE      SP3,BCBASC
.
          CALL      WRBATC
          ADD       ONE,BC0NXTSC
          ADD       ONE,BC1NOTR
          ADD       BCAMT,BC1KEYT
          ADD       BCAMT,BC1ACCT
          WEOF      BATFILE,BC0NXTSC
.
WRBCH999  RETURN
.
.******************************************************************************
. Post Control Account Transactions
.******************************************************************************
CCTR0000  MOVE      "00000",BCRED
          UNPACK    APBMDAT,CCENT,CYEAR,CMON,CDAY
          PACK      BCDATEE WITH CDAY,CMON,CCENT,CYEAR
          REP       " 0" IN BCDATEE
          UNPACK    APBMADT,CCENT,CYEAR,CMON,CDAY
          PACK      BCDATED WITH CDAY,CMON,CCENT,CYEAR
          REP       " 0" IN BCDATED
          MOVE      ZERO,BCINVT
          MOVE      ZERO,BCDISC
          MOVE      BC1RESP TO BCRESP
          MOVE      SP70 TO BCTRAND
          MOVE      "PAYMENT ",BCORD
          MOVE      "PAYMENT        ",BCREFER
          MOVE      FMCOPDIS TO BCDISS
.
          MOVE      SP70,KEY14
          CALL      RSAPTM1
CCTR8000  CALL      RKAPTM1
          BRANCH    OVRCD,CCTR9999
          MOVE      APTMAMT,BCAMT
.
          MOVE      "JC" TO BCTRAN
.
          MOVE      APTMLED,BCLEDG
          MOVE      APTMACC,BCACCT
.
          CALL      WBCH0000                * Write Record Back to Batch file
.
          GOTO      CCTR8000                * for General Ledger
.
CCTR9999  MOVE      "PY",BCTRAN
          RETURN
.**********************************************************************
. Add Control Account Transactions to Batch
.**********************************************************************
WBCH0000  MOVE      "5",BCSTAT
          MOVE      SP70,BCDATCX
          MOVE      SP70,BCACCTP
          MOVE      "N",BCCOMX
          MOVE      ZERO,BCCOMXA
          MOVE      SP70,BCCONT
          MOVE      SP70,BCDISCC
          MOVE      SP70,BCCEORD
          MOVE      SP70,BCCELNE
          MOVE      SP70,BCCATA
          MOVE      SP3,BCBASC
          CALL      RDBATS0
          ADD       ONE,BC0NXTSC
          CALL      WRBATS0
          SUB       ONE,BC0NXTSC
          CALL      WRBATC
.
          CALL      RDBAT1
          ADD       ONE,BC1NOTR
          MOVE      "5",BC1STAT
          CALL      WRBAT1
.
          RETURN
.----------------------------------------------------------------------
. Update Control File in General Ledger
.----------------------------------------------------------------------
UPGL0000
          CALL      RDBATS0
          MOVE      BC1BATCH,F5
          MOVE      F5,FMBCBAT
          MOVE      "2",FMBCSTA
          MOVE      BC0NXTSC,FMBCSEC
.
          COMPARE   "3",BC0NXTSC       * check if empty batch
          GOTO      UPGL9500 IF LESS
.
          MOVE      BC1ACCT,FMBCTOT
          MOVE      ZERO,FMBCDIS
          MOVE      BC1OPER,FMBCUID
          MOVE      BC1LEDG,FMBCLED
          MOVE      BC1TRAN,FMBCTRT
          MOVE      BC0SUPBC,FMBCINV
.
          UNPACK    BC1DATE,CDAY,CMON,CCENT,CYEAR
          PACK      FMBCDAT,CCENT,CYEAR,CMON,CDAY
          UNPACK    BC1BDATE,CDAY,CMON,CCENT,CYEAR
          PACK      FMBCPDAT,CCENT,CYEAR,CMON,CDAY
          PACK      FMBCCDAT,CCENT,CYEAR,CMON,CDAY
.
          MOVE      SP70,FMBCSPAR
          PACK      KEY5,APBMBCH
          UNPACK    KEY5,FMBCBAT
          CALL      RAFMBC1
          IF        OVRCD=0
            CALL      UPFMBC1
          ELSE
            CALL      WRFMBC1
          ENDIF
.
          GOTO      UPGL9999
.
UPGL9500  
          CLEAR     DISPMSG
          APPEND    "No Records in Batch - Batch Deleted - ",DISPMSG
          CALL      MESSAGE1
.
          CLOSE     BATFILE
          PREP      BATFILE,FNAME
          CLOSE     BATFILE
.
UPGL9999  RETURN
.**********************************************************************
. Temp file IO routines
.**********************************************************************
RSAPTM1   RESET     KEY14
          READ      APSTMPA1,KEY14;;
          RETURN
.
RAAPTM1   RESET     KEY14
          MOVE      ZERO,OVRCD
          READ      APSTMPA1,KEY14;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
RDAPTM1   RESET     KEY14
          MOVE      ZERO,OVRCD
          READ      APSTMPA1,KEY14;APTMLED,APTMACC,APTMAMT
          GOTO      OVERCOND IF OVER
          RETURN
.
RKAPTM1   MOVE      ZERO,OVRCD
          READKS    APSTMPA1;APTMLED,APTMACC,APTMAMT
          GOTO      OVERCOND IF OVER
          RETURN
.
RPAPTM1   MOVE      ZERO,OVRCD
          READKP    APSTMPA1;APTMLED,APTMACC,APTMAMT
          GOTO      OVERCOND IF OVER
          RETURN
.
UPAPTM1   UPDATE    APSTMPA1;APTMLED,APTMACC,APTMAMT
          RETURN
.
WRAPTM1   RESET     KEY14
          WRITE     APSTMPA1,KEY14;APTMLED,APTMACC,APTMAMT
          RETURN
.
DEAPTM1   RESET     KEY14
          DELETE    APSTMPA1,KEY14
          RETURN
.
RSAPGS1   RESET     KEY14
          READ      APSGSTA1,KEY14;;
          RETURN
.
RDAPGS1   RESET     KEY14
          MOVE      ZERO,OVRCD
          READ      APSGSTA1,KEY14;APGSLED,APGSACC,APGSAMT
          GOTO      OVERCOND IF OVER
          RETURN
.
RKAPGS1   MOVE      ZERO,OVRCD
          READKS    APSGSTA1;APGSLED,APGSACC,APGSAMT
          GOTO      OVERCOND IF OVER
          RETURN
.
UPAPGS1   
          UPDATE    APSGSTA1;APGSLED,APGSACC,APGSAMT
          RETURN
.
WRAPGS1   RESET     KEY14
          WRITE     APSGSTA1,KEY14;APGSLED,APGSACC,APGSAMT
          RETURN
.
DEAPGS1   RESET     KEY14
          DELETE    APSGSTA1,KEY14
          RETURN
.
.-----------------------------------------------
. Check batch totals for balance here.
.-----------------------------------------------
CBAT0000  MOVE      ZERO,BATCHCA
          MOVE      ZERO,EXIT
          PACK      KEY40,APBMBCH,SP70
          CALL      RSAPIM1
CBAT0100
          CALL      RKAPIM1
          BRANCH    OVRCD,CBAT0900
          MATCH     APBMBCH,APIMBCH
          GOTO      CBAT0900 IF NOT EQUAL
          ASSIGN    APIMTOT+APIMGST-APIMDIS+BATCHCA,BATCHCA
          MOVE      ZERO,ALLTOTAL
          PACK      KEY51,APIMBCH,APIMCRD,APIMREF,APIMDOC,SP70
          PACK      KEY40,APIMBCH,APIMCRD,APIMREF,APIMDOC
          CALL      RSAPIN1
CBAT0200
          CALL      RKAPIN1
          BRANCH    OVRCD,CBAT0300
          PACK      KEY51,APINBCH,APINCRD,APINREF,APINDOC,SP70
          MATCH     KEY40,KEY51
          GOTO      CBAT0300 IF NOT EQUAL
          ADD       APINAMT,ALLTOTAL
          GOTO      CBAT0200
CBAT0300                                   * Flag as Updated
          IF        !(APIMTOT-APIMDIS=ALLTOTAL)
            CLEAR      DISPMSG
            APPEND     "Crd/Ref/Bch Unbal : ",DISPMSG
            APPEND     APIMCRD,DISPMSG
            APPEND     SLASH,DISPMSG
            APPEND     APIMDOC,DISPMSG
            APPEND     SLASH,DISPMSG
            APPEND     APIMBCH,DISPMSG
            RESET      DISPMSG
            CALL       MESSAGE1
            MOVE       ONE,EXIT
            GOTO       CBAT9999
          ENDIF
          GOTO      CBAT0100
CBAT0900
          IF        !(BATCHCA=APBMTOT)
            MOVE      "Batch Unbalanced. ",DISPMSG
            CALL       MESSAGE1
            MOVE       ONE,EXIT
          ENDIF
CBAT9999  RETURN
.
.----------------------------------------
. Read parameters & Open Files
.----------------------------------------
INITB000  OPEN      CONTROLF,"controlf"
          READ      CONTROLF,SIXTY6;*62,FMCOPDIS
.
. Create Temp File APSTMPxx
.--------------------------
          PACK      TMPFILE,APSTMPPY,PORT
          REP       " 0",TMPFILE
          PACK      MAKETMP,MAKE,TMPFILE,INDEX
          PACK      KILLTMP,KILL,TMPFILE
.
          CLOSE     APSTMPA1
          EXECUTE   KILLTMP,TASKID
          EXECUTE   MAKETMP,TASKID
          OPEN      APSTMPA1,TMPFILE
.
          PACK      TMPFILE,APSGSTPY,PORT
          REP       " 0",TMPFILE
          PACK      MAKETMP,MAKE,TMPFILE,INDEX
          PACK      KILLTMP,KILL,TMPFILE
.
          CLOSE     APSGSTA1
          EXECUTE   KILLTMP,TASKID
          EXECUTE   MAKETMP,TASKID
          OPEN      APSGSTA1,TMPFILE
.
          RETURN
.----------------------------------------------------------------------
. Write Details to creditors for G.S.T.
.----------------------------------------------------------------------
ALGST000  COMPARE   ZERO,APINGST
          GOTO      ALGST999 IF EQUAL
.
          MOVE      APINLED,KEY2
          CALL      RDFMLA1
          BRANCH    OVRCD,ALGST999
.
          PACK      KEY14,APINLED,APINACC
          CALL      RDFMAM1
          BRANCH    OVRCD,ALGST999
.
          CALL      RFMCOT00        * Determine GST Control Account
.
          MOVE      APINLED,APINLED
          MOVE      FMCSAGST,APINACC
          MOVE      APINGST,APINAMT
          CALL      MVINP000          * Move in Fields
          CALL      WRBCH000          * Update Batch Record
.
ALGST999  RETURN
.----------------------------------------------------------------------
. Update Batch Details
.----------------------------------------------------------------------
UPINV000  DISPLAY   *P1:24,*EL            * Clear Line for Display
          PACK      KEY40,APBMBCH,SP70
          CALL      RSAPIM1               * Main Loop through Invoice
UPINV100  CALL      RKAPIM1               * Header Records for Batch
          BRANCH    OVRCD,UPINV900
          MATCH     APBMBCH,APIMBCH
          GOTO      UPINV900 IF NOT EQUAL
          MATCH     "1",APIMUPD
          GOTO      UPINV100 IF EQUAL     * Already Updated
          PACK      SAVKEY40,APIMBCH,APIMCRD,APIMREF,APIMDOC
.
          MATCH     "~~",APIMCRD          * No Original Invoice Details
          GOTO      UPINV300 IF EQUAL     * for Non Specific Creditors
.
          MATCH     SP70,APIMREF          * No Original Invoice Details
          GOTO      UPINV300 IF EQUAL     * for Blank Invoice Ref.
.
          PACK      KEY40,APIMBCH,APIMCRD,APIMREF,APIMDOC
          PACK      KEY51,APIMBCH,APIMCRD,APIMREF,APIMDOC,SP70
          CALL      RSAPIN1               * Loop Through Allocation Details
.
UPINV200  CALL      RKAPIN1               * Within The Invoice
          BRANCH    OVRCD,UPINV300
          PACK      SAVKEY51,APINBCH,APINCRD,APINREF,APINDOC,APINORD,APINLIN
          MATCH     SAVKEY40,SAVKEY51
          GOTO      UPINV300 IF NOT EQUAL
.
          MATCH     "1",APINUPD
          GOTO      UPINV200 IF EQUAL     * Already Updated
.
.                             Bch Doc   Ord  Lin
          UNPACK    APINDES,KEY5,KEY15,KEY8,KEY3
.
          PACK      KEY40,KEY5,APINCRD,APINREF,KEY15
          CALL      RDAPIM1
          IF        OVRCD=0
            MATCH     "1",APIMTYP
            IF        @EQUAL
              ASSIGN    SEQ*APINAMT,PAYTOTAL
              ASSIGN    SEQ*APINGST,GSTTOTAL
            ELSE
              MOVE      APINAMT,PAYTOTAL
              MOVE      APINGST,GSTTOTAL
            ENDIF
            ASSIGN    APIMPAY+PAYTOTAL+GSTTOTAL,APIMPAY
            IF        APIMTOT+APIMGST-APIMDIS=APIMPAY
              MOVE      ZERO,APIMOUT
            ELSE 
              MOVE      ONE,APIMOUT
            ENDIF
            CALL      UPAPIM1
          ENDIF
.
          PACK      KEY51,KEY5,APINCRD,APINREF,KEY15,KEY8,KEY3
          CALL      RDAPIN1
          IF        OVRCD=0
            ASSIGN    APINPAY+PAYTOTAL+GSTTOTAL,APINPAY
            CALL      UPAPIN1
          ENDIF
.
          MOVE      SAVKEY51,KEY51
          CALL      RDAPIN1
          IF        OVRCD=0
            MOVE      ONE,APINUPD       * Updated     = 1 Yes
            ASSIGN    APINAMT+APINGST,APINPAY
            CALL      UPAPIN1
          ENDIF
          GOTO      UPINV200
.
UPINV300  MOVE      SAVKEY40,KEY40
          CALL      RDAPIM1
          IF        OVRCD=0
            MOVE      ONE,APIMUPD       * Updated     = 1 Yes
            MOVE      ZERO,APIMOUT
            ASSIGN    APIMTOT+APIMGST,APIMPAY
            MOVE      ZERO,APIMDIS
            CALL      UPAPIM1
          ENDIF
          GOTO      UPINV100
.
UPINV900  RETURN
.******************************************************************************
.  Cheque print routines
.******************************************************************************
.**********************************************************************
. Print Proposed Payments
.**********************************************************************
PRNPY000
          MOVE      SP70,KEY52
          CALL      RSAPAP1
          CALL      RKAPAP1                 * see if cheques have been printed
          BRANCH    OVRCD,PRNPY090
.
          MOVE      APAPPOR,TEMPPOR         * Print Order
.
.---- check if cheques have been printed before ----
.
          MOVE      FMBNREF,FRCHQPR         * save cheque number
.
          MOVE      ZERO,FROMCHQ1           * clear first cheque
          MOVE      SP70,KEY52
          MOVE      SP70,KEY58
          PERFORM   TEMPPOR,RSAPAP1,RSAPAP4
PRNPY010  PERFORM   TEMPPOR,RKAPAP1,RKAPAP4 * see if cheques have been printed
          BRANCH    OVRCD,PRNPY090
          TYPE      APAPPYC                 * valid cheque ?
          GOTO      PRNPY010 IF NOT EQUAL
          MOVE      ZERO,F1
          MOVE      APAPGMT,F1
          COMPARE   ZERO,F1                 * Paid By Cheque ?
          GOTO      PRNPY010 IF NOT EQUAL
.
          IF        FROMCHQ1=0
            UNPACK    APAPPYC,KEY7,KEY8
            MOVE      KEY8,FROMCHQ1         * save first cheque
          ENDIF
          UNPACK    APAPPYC,KEY7,KEY8
          MOVE      KEY8,TOCHQ1             * save last cheque
          GOTO      PRNPY010
.
PRNPY090  IF        !FROMCHQ1=0
            UNPACK    FRCHQPR,KEY7,KEY8
            MOVE      KEY8,FROMCHQ3         * save first cheque
            ASSIGN    FROMCHQ3+TOCHQ1-FROMCHQ1,TOCHQ3
.                                           * check if ranges ok
            IF        TOCHQ1>TOCHQ3
              IF        !(FROMCHQ1>TOCHQ3)
                ASSIGN    TOCHQ3+1,FROMCHQ1
              ENDIF
            ELSE
              IF        !(TOCHQ1<FROMCHQ3)
                ASSIGN    FROMCHQ3-1,TOCHQ1
              ENDIF
            ENDIF
.
            IF        !(FROMCHQ1>TOCHQ1)
              MOVE      ZERO,ACCEPT         * do subscreen if cheques found
              MOVE      FROMCHQ1,FROMCHQ2
              MOVE      TOCHQ1,TOCHQ2
              MOVE      ZERO,QUITFLAG
              PACK      TRANDATE,DATERUN,SP70                * I CAR 19895
.             PACK      TRANDATE,CCC,CYY,CMM,CDD,SP70        * D CAR 19895
.             REP       " 0",TRANDATE                        * D CAR 19895
              MOVE      "Printer Error                                ",DIM35
              CALL      SC1AL000            * execute unused cheques screen
              BRANCH    QUITFLAG,PRNPY999   * quit print
            ENDIF
          ENDIF
.
.---- start printing ----
.
          MOVE      SP70,FIRSTCHQ           * print from start
          CALL      PRTCH000
.
PRNPY999  RETURN
.**********************************************************************
. Restart Proposed Payments
.**********************************************************************
RESTA000
          MOVE      SP70,KEY52
          CALL      RSAPAP1
          CALL      RKAPAP1                 * see if cheques have been printed
          BRANCH    OVRCD,RESTA999
.
          MOVE      APAPPOR,TEMPPOR         * Report Order
          MOVE      SP70,DISPMSG
          CALL      MESSAGE2
.
.---- check if cheques have been printed before ----
.
          MOVE      FMBNREF,FRCHQPR         * save cheque number
.
          MOVE      ZERO,FROMCHQ1           * clear first cheque
          MOVE      SP70,KEY52
          MOVE      SP70,KEY58
          PERFORM   TEMPPOR,RSAPAP1,RSAPAP4
RESTA010  PERFORM   TEMPPOR,RKAPAP1,RKAPAP4 * see if cheques have been printed
          BRANCH    OVRCD,RESTA090
          TYPE      APAPPYC                 * valid cheque ?
          GOTO      RESTA010 IF NOT EQUAL
          MOVE      ZERO,F1
          MOVE      APAPGMT,F1
          COMPARE   ZERO,F1                 * Paid By Cheque ?
          GOTO      RESTA010 IF NOT EQUAL
.
          IF        FROMCHQ1=0
            UNPACK    APAPPYC,KEY7,KEY8
            MOVE      KEY8,FROMCHQ1         * save first cheque
          ENDIF
          UNPACK    APAPPYC,KEY7,KEY8
          MOVE      KEY8,TOCHQ1             * save last cheque
          GOTO      RESTA010
.
RESTA090  IF        !FROMCHQ1=0
          ELSE
            DISPLAY   *P1:24,"Cheques have not been printed yet - ",*EL;
            CALL      HITENTER
            GOTO      RESTA950
          ENDIF
.
.---- start printing ----
.
RESTA100  
          DISPLAY   *P1:24,"Enter Last Cheque Printed Successfully : ",*EL;
          MOVE      "43",CCOL
          MOVE      "24",CVERT
          CALL      KCHEQ000
          BRANCH    EXIT,RESTA950,RESTA900
.
          MOVE      FMBNREF,F15             * check if in range
          IF        FROMCHQ1>F15
            CLEAR     DISPMSG
            APPEND    "Cannot be before cheque ",DISPMSG
            APPEND    FROMCHQ1,DISPMSG
            APPEND    " - ",DISPMSG
            CALL      MESSAGE1
            GOTO      RESTA100
          ENDIF
          IF        !(F15<TOCHQ1)
            CLEAR     DISPMSG
            APPEND    "Must be before cheque ",DISPMSG
            APPEND    TOCHQ1,DISPMSG
            APPEND    " - ",DISPMSG
            CALL      MESSAGE1
            GOTO      RESTA100
          ENDIF
.
          MOVE      FMBNREF,F15             * calc where to start from
          ADD       ONE,F15
          MOVE      F15,FIRSTCHQ
.
          MOVE      FRCHQPR,F15
          MOVE      F15,KEY15
          MATCH     FIRSTCHQ,KEY15
          IF        @LESS
            MOVE      "WARNING - Last ok cheque after From Cheque - ",DISPMSG
            CALL      MESSAGE4
            BRANCH    EXIT,RESTA950
          ENDIF
.
          CALL      PRTCH000
.
RESTA900  MOVE      "0",EXIT           * restarted
          GOTO      RESTA999
.
RESTA950  MOVE      "1",EXIT           * could not restart
.
RESTA999  
          CALL      MESSAGE3
          RETURN
.----------------------------------------------------------------------
. PRTCH000 - start printing              Called by PRNPY000 & RESTA000
.----------------------------------------------------------------------
PRTCH000  CALL      INTCH000             * Initialize Fields & Open Print File
.
          UNPACK    DATERUN,CCENT,CYEAR,CMON,CDAY          * I CAR 19895
          CALL      PACDATE                                * Formate Cheque Date
          MOVE      CPCDATE,DDATERUN                       * end I CAR 19895
.
          MOVE      FRCHQPR,F15          * Set up First Cheque
          MOVE      F15,CHEQNUMB         * Keeps track of Cheques Printed
          SUB       ONE,CHEQNUMB
          PACK      KEY52,SP70
          PACK      KEY58,SP70
          PERFORM   TEMPPOR,RSAPAP1,RSAPAP4
PRTCH100  PERFORM   TEMPPOR,RKAPAP1,RKAPAP4      * loop through payments file
          BRANCH    OVRCD,PRTCH900
          IF        0=APAPTPY
            MOVE      Z70,APAPPYC                * update cheque number
            MOVE      DATERUN,APAPPYD            * update accounting date
            PERFORM   TEMPPOR,UPAPAP1,UPAPAP4
            GOTO      PRTCH100
          ENDIF
          MOVE      ZERO,F1
          MOVE      APAPGMT,F1
          COMPARE   ZERO,F1                      * Paid By Cheque ?
          GOTO      PRTCH100 IF NOT EQUAL
.                                                * skip if no payment
.
          MATCH     FIRSTCHQ,APAPPYC             * up to specified start cheque?
          GOTO      PRTCH100 IF LESS
.
          MOVE      APAPPYC,F15                  * NOT SURE ABOUT THESE
          MOVE      F15,F8                       * TWO LINES
.
          MATCH     APAPCRD,LASTCRE              * new creditor ?
          IF        !@EQUAL
            CALL      DBALC000                   * check if payment required
            IF        OVRCD=1
              PACK      KEY52,APAPCRD,Z70         * if so, skip this creditor
              PACK      KEY58,APAPSKY,APAPCRD,Z70 * if so, skip this creditor
              PERFORM   TEMPPOR,RSAPAP1,RSAPAP4
              GOTO      PRTCH100
            ENDIF
          ENDIF
.
          PACK      KEY41,APAPCRD,APAPREF,APAPDOC,APAPBCH,APAPTYP,SP70
          DISPLAY   *P1:24,"Processing : ",*V2LON,KEY41,*EL;
          MATCH     SP70,LASTDOCT                 * print last trans
          IF        !@EQUAL
            MATCH     KEY41,LASTDOCT
            CALL      PLINE000 IF NOT EQUAL
          ENDIF
          PACK      LASTDOCT,KEY41,SP70
.
          MATCH     SP70,LASTORD                 * save first ord of invoice
          IF        @EQUAL
            MOVE      APAPORD,LASTORD
          ENDIF
.
          MATCH     APAPCRD,LASTCRE             * new creditor ?
          IF        !@EQUAL
            MATCH     SP70,LASTCRE
            CALL      CHQEN000 IF NOT EQUAL      * print cheque if required
            MOVE      ZERO,DOLLARS
            MOVE      ZERO,TOTALINV
            MOVE      ZERO,TOTALCRD
.
            PACK      KEY5,APAPCRD,SP70
            CALL      RDAPMA1
            CALL      CHQHD000                   * print remittance header
            MOVE      APAPCRD,LASTCRE
          ENDIF
.
          MATCH     "1",APAPTYP                  * accumulate totals
          IF        @EQUAL
            SUB       APAPTPY,XTOTCRD
            SUB       APAPTPY,TOTCRD
          ELSE
            ADD       APAPTPY,XTOTINVC
            ADD       APAPTPY,TOTINVC
          ENDIF
          ADD       APAPTPY,XACCUM
          ADD       APAPTPY,DOLLARS
.
          GOTO      PRTCH100
.
PRTCH900
          MATCH     SP70,LASTCRE
          IF        !@EQUAL
            MATCH     LASTCRE,LASTDOCT
            CALL      PLINE000 IF EQUAL          * print last transaction
            CALL      CHQEN000                   * print cheque if required
          ENDIF
          CALL      CLSPRINT
.
PRTCH999  RETURN
.**********************************************************************
. Print Transactions
.**********************************************************************
PLINE000  UNPACK    SP70,APIMIDT
          UNPACK    SP70,APIMCM1
          UNPACK    SP70,APIMCM2
          UNPACK    LASTDOCT,APIMCRD,APIMREF,APIMDOC,APIMBCH,APIMTYP
          PACK      KEY40,APIMCRD,APIMREF,APIMDOC,APIMBCH,SP70
          CALL      RDAPIM3
.
          MOVE      CLNO,TESTLINE      * work out how many lines required
.
PLINE010  IF        FMCOAPCH<>9
            MATCH     SP70,APIMCM1       * add on lines for comment (if req)
            IF        !@EQUAL
              ADD       ONE,TESTLINE
            ENDIF
            MATCH     SP70,APIMCM2
            IF        !@EQUAL
              ADD       ONE,TESTLINE
            ENDIF
          ENDIF
.
PLINE020  COMPARE   MAXLINES,TESTLINE
          CALL      CHQNX000 IF NOT LESS      * page full ?
.
          IF        FMCOAPCH<>9
            ADD       ONE,CLNO           * get next line
          ENDIF
.
          UNPACK    APIMIDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
          BRANCH    FMCOAPCH,PLINE100,PLINE110,PLINE120,PLINE130,PLINE140:
                             PLINE150,PLINE160,PLINE170,PLINE180,PLINE190:
                             PLINE200,PLINE210,PLINE220,PLINE230,PLINE240:
                             PLINE250,PLINE260,PLINE270,PLINE280,PLINE290:
                             PLINE300,PLINE310,PLINE320
.
.---- standard cheque layout ----
.
          MATCH     "1",APIMTYP
          IF        @EQUAL
            MOVE      "Credit    ",KEY10
            ADD       XTOTINVC,XTOTCRD
            PRINT     *2,CPDATE,SP2,APIMDOC,LASTORD,SP3,KEY10,*50,XTOTCRD
            MULT      SEQ,XTOTCRD
          ELSE
            MOVE      "Invoice   ",KEY10
            ADD       XTOTCRD,XTOTINVC
            PRINT     *2,CPDATE,SP2,APIMREF,LASTORD,SP3,KEY10,*63,XTOTINVC
          ENDIF
          MATCH     SP70,APIMCM1
          IF        !@EQUAL
            MOVE      APIMCM1,KEY50
            PRINT     *10,KEY50
            ADD       ONE,CLNO
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            MOVE      APIMCM2,KEY50
            PRINT     *10,KEY50
            ADD       ONE,CLNO
          ENDIF
          GOTO      PLINE950
.
.---- HLC cheque layout ----
.
PLINE100
          MATCH     "1",APIMTYP
          IF        @EQUAL
            MOVE      "CR",KEY2
            ADD       XTOTINVC,XTOTCRD
            PRINT     *10,CPDATE,*20,APIMDOC,*36,KEY2,*51,XTOTCRD,*67,XACCUM
            MULT      SEQ,XTOTCRD
          ELSE
            MOVE      "IN",KEY2
            ADD       XTOTCRD,XTOTINVC
            PRINT     *10,CPDATE,*20,APIMREF,*36,KEY2,*41,XTOTINVC,*67,XACCUM
          ENDIF
          MATCH     SP70,APIMCM1
          IF        !@EQUAL
            MOVE      APIMCM1,KEY50
            PRINT     *20,KEY50
            ADD       ONE,CLNO
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            MOVE      APIMCM2,KEY50
            PRINT     *20,KEY50
            ADD       ONE,CLNO
          ENDIF
          GOTO      PLINE950
.
.---- hastings cheque layout ----
.
PLINE110  MATCH     "1",APIMTYP
          IF        @EQUAL
            MOVE      "Credit    ",KEY10
            ADD       XTOTINVC,XTOTCRD
            PRINT     *2,CPDATE,SP2,APIMDOC,LASTORD,SP3,KEY10,*50,XTOTCRD
            MULT      SEQ,XTOTCRD
          ELSE
            MOVE      "Invoice   ",KEY10
            ADD       XTOTCRD,XTOTINVC
            PRINT     *2,CPDATE,SP2,APIMREF,LASTORD,SP3,KEY10,*63,XTOTINVC
          ENDIF
          MATCH     SP70,APIMCM1
          IF        !@EQUAL
            MOVE      APIMCM1,KEY50
            PRINT     *10,KEY50
            ADD       ONE,CLNO
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            MOVE      APIMCM2,KEY50
            PRINT     *10,KEY50
            ADD       ONE,CLNO
          ENDIF
          GOTO      PLINE950
.
.---- West Gippsland ----- 
.
PLINE120  MATCH     "1",APIMTYP
          IF        @EQUAL
            ADD       XTOTINVC,XTOTCRD
            MULT      SEQ,XTOTCRD
            MOVE      APIMDOC,KEY15
          ELSE
            ADD       XTOTCRD,XTOTINVC
            MOVE      APIMREF,KEY15
          ENDIF
.
          BRANCH    PRTSIDE,PLINE123
          PRINT     *3,KEY15,SP1,CPDATE,SP2,XACCUM,SP2;
          SUB       ONE,CLNO
          MOVE      ONE,PRTSIDE
          GOTO      PLINE126
.
PLINE123  PRINT     KEY15,SP1,CPDATE,SP2,XACCUM
          MOVE      ZERO,PRTSIDE
          GOTO      PLINE126
.
PLINE126  MATCH     SP70,APIMCM1
          IF        !@EQUAL
            IF        PRTSIDE=0
              PRINT     *3,APIMCM1
              ADD       ONE,CLNO
            ELSE
              PRINT     " "
              PRINT     *3,APIMCM1
              ADD       TWO,CLNO
              MOVE      ZERO,PRTSIDE
            ENDIF
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            IF        PRTSIDE=0
              PRINT     *3,APIMCM2
              ADD       ONE,CLNO
            ELSE
              PRINT     " "
              PRINT     *3,APIMCM2
              ADD       TWO,CLNO
              MOVE      ZERO,PRTSIDE
            ENDIF
          ENDIF
.
          GOTO      PLINE950
.
.---- MOD ----
.
PLINE130  MATCH     "1",APIMTYP
          IF        @EQUAL
            ADD       XTOTINVC,XTOTCRD
            MULT      SEQ,XTOTCRD
            MOVE      APIMDOC,KEY15
          ELSE
            ADD       XTOTCRD,XTOTINVC
            MOVE      APIMREF,KEY15
          ENDIF
.
          UNPACK    APIMDDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MONTHD FROM F2 OF JAN,FEB,MAR,APR,MAY,JUN:
                                      JUL,AUG,SEP,OCT,NOV,DEC
          REP       " 0",CDAY
          REP       " 0",CYEAR
          PACK      DATED,CDAY,SP1,MONTHD,SP1,CYEAR
.
          BRANCH    PRTSIDE,PLINE133
          PRINT     *3,KEY15,SP1,DATED,SP3,XACCUM,SP2;
          SUB       ONE,CLNO
          MOVE      ONE,PRTSIDE
          GOTO      PLINE136
.
PLINE133  PRINT     KEY15,SP1,DATED,SP2,XACCUM
          MOVE      ZERO,PRTSIDE
.
PLINE136  GOTO      PLINE950
.
.---- TAM cheque layout ----
.
PLINE140  MATCH     "1",APIMTYP
          IF        @EQUAL
            MOVE      "Credit    ",KEY10
            ADD       XTOTINVC,XTOTCRD
            PRINT     *2,CPDATE,SP2,APIMDOC,LASTORD,SP3,KEY10,*50,XTOTCRD
            MULT      SEQ,XTOTCRD
          ELSE
            MOVE      "Invoice   ",KEY10
            ADD       XTOTCRD,XTOTINVC
            PRINT     *2,CPDATE,SP2,APIMREF,LASTORD,SP3,KEY10,*63,XTOTINVC
          ENDIF
          MATCH     SP70,APIMCM1
          IF        !@EQUAL
            MOVE      APIMCM1,KEY50
            PRINT     *10,KEY50
            ADD       ONE,CLNO
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            MOVE      APIMCM2,KEY50
            PRINT     *10,KEY50
            ADD       ONE,CLNO
          ENDIF
          GOTO      PLINE950
.
.---- ACC ----
.
PLINE150  MATCH     "1",APIMTYP
          IF        @EQUAL
            MOVE      "Credit    ",KEY10
            ADD       XTOTINVC,XTOTCRD
            PRINT     *2,CPDATE,SP2,APIMDOC,LASTORD,SP3,KEY10,*50,XTOTCRD
            MULT      SEQ,XTOTCRD
          ELSE
            MOVE      "Invoice   ",KEY10
            ADD       XTOTCRD,XTOTINVC
            PRINT     *2,CPDATE,SP2,APIMREF,LASTORD,SP3,KEY10,*63,XTOTINVC
          ENDIF
          MATCH     SP70,APIMCM1
          IF        !@EQUAL
            MOVE      APIMCM1,KEY50
            PRINT     *12,KEY50
            ADD       ONE,CLNO
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            MOVE      APIMCM2,KEY50
            PRINT     *12,KEY50
            ADD       ONE,CLNO
          ENDIF
          GOTO      PLINE950
.
.---- GreyM ----
.
PLINE160  MOVE      APIMTOT,TEMPGROS
          ADD       APIMGST,TEMPGROS
          MOVE      APIMDIS,TEMPDISC
.
          MATCH     "1",APIMTYP
          IF        @EQUAL
            MOVE      "Credit    ",KEY10
            ADD       XTOTINVC,XTOTCRD
            MOVE      XTOTCRD,TEMPNET
            MULT      SEQ,TEMPGROS
            MULT      SEQ,TEMPNET
            MULT      SEQ,XTOTCRD
          ELSE
            MOVE      "Invoice   ",KEY10
            ADD       XTOTCRD,XTOTINVC
            MOVE      XTOTINVC,TEMPNET
          ENDIF
          PRINT     CPDATE:
                    *10,APIMDOC:
                    *27,TEMPGROS:
                    *43,TEMPDISC:
                    *57,TEMPNET
.
          MATCH     SP70,APIMCM1
          IF        !@EQUAL
            MOVE      APIMCM1,KEY50
            PRINT     *11,KEY50
            ADD       ONE,CLNO
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            MOVE      APIMCM2,KEY50
            PRINT     *11,KEY50
            ADD       ONE,CLNO
          ENDIF
          GOTO      PLINE950
.
.---- PVH cheque layout ----
.
PLINE170
          MATCH     "1",APIMTYP
          IF        @EQUAL
            MOVE      "CR",KEY2
            ADD       XTOTINVC,XTOTCRD
            PRINT     *07,CPDATE,*17,APIMDOC,*31,KEY2,*48,XTOTCRD,*64,XACCUM
            MULT      SEQ,XTOTCRD
          ELSE
            MOVE      "IN",KEY2
            ADD       XTOTCRD,XTOTINVC
            PRINT     *07,CPDATE,*17,APIMREF,*31,KEY2,*38,XTOTINVC,*64,XACCUM
          ENDIF
          MATCH     SP70,APIMCM1
          IF        !@EQUAL
            MOVE      APIMCM1,KEY20
            PRINT     *17,KEY20
            ADD       ONE,CLNO
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            MOVE      APIMCM2,KEY20
            PRINT     *17,KEY20
            ADD       ONE,CLNO
          ENDIF
          GOTO      PLINE950
.
.---- Buderim ----- 
.
PLINE180  MATCH     "1",APIMTYP
          IF        @EQUAL
            ADD       XTOTINVC,XTOTCRD
            MULT      SEQ,XTOTCRD
            MOVE      APIMDOC,KEY15
          ELSE
            ADD       XTOTCRD,XTOTINVC
            MOVE      APIMREF,KEY15
          ENDIF
.
          MOVE      KEY15,KEY10
          BRANCH    PRTSIDE,PLINE183,PLINE185
          PRINT     *3,KEY10,SP2,XACCUM,SP2;
          MOVE      ONE,PRTSIDE
          GOTO      PLINE188
.
PLINE183  PRINT     KEY10,SP3,XACCUM,SP2;
          MOVE      TWO,PRTSIDE
          GOTO      PLINE188
.
PLINE185  PRINT     KEY10,SP3,XACCUM
          MOVE      ZERO,PRTSIDE
          ADD       ONE,CLNO
          GOTO      PLINE188
.
PLINE188  GOTO      PLINE950
.
.---- Hawkesbury cheque layout ----
.
PLINE190  MATCH     "1",APIMTYP
          IF        @EQUAL
            MOVE      "CR",KEY2
            ADD       XTOTINVC,XTOTCRD
            PRINT     *7,CPDATE,*17,APIMDOC,*31,KEY2,*47,XTOTCRD,*64,XACCUM
            ADD       XTOTCRD,TOTALCRD
            MULT      SEQ,XTOTCRD
          ELSE
            MOVE      "IN",KEY2
            ADD       XTOTCRD,XTOTINVC
            PRINT     *7,CPDATE,*17,APIMREF,*31,KEY2,*37,XTOTINVC,*64,XACCUM
            ADD       XTOTINVC,TOTALINV
          ENDIF
          GOTO      PLINE950
.
.---- St Andrews Rockhampton cheque layout ----
.
PLINE200  MATCH     "1",APIMTYP
          IF        @EQUAL
            MOVE      "Credit    ",KEY10
            ADD       XTOTINVC,XTOTCRD
            PRINT     *2,CPDATE,SP2,APIMDOC,LASTORD,SP3,KEY10,*50,XTOTCRD
            MULT      SEQ,XTOTCRD
          ELSE
            MOVE      "Invoice   ",KEY10
            ADD       XTOTCRD,XTOTINVC
            PRINT     *2,CPDATE,SP2,APIMREF,LASTORD,SP3,KEY10,*63,XTOTINVC
          ENDIF
          MATCH     SP70,APIMCM1
          IF        !@EQUAL
            MOVE      APIMCM1,KEY50
            PRINT     *10,KEY50
            ADD       ONE,CLNO
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            MOVE      APIMCM2,KEY50
            PRINT     *10,KEY50
            ADD       ONE,CLNO
          ENDIF
          GOTO      PLINE950
.
.---- Mater cheque layout ----
.
PLINE210  MATCH     "1",APIMTYP
          IF        @EQUAL
            MOVE      "Credit    ",KEY10
            ADD       XTOTINVC,XTOTCRD
            PRINT     *2,CPDATE,SP2,APIMDOC,LASTORD,SP3,KEY10,*50,XTOTCRD
            MULT      SEQ,XTOTCRD
          ELSE
            MOVE      "Invoice   ",KEY10
            ADD       XTOTCRD,XTOTINVC
            PRINT     *2,CPDATE,SP2,APIMREF,LASTORD,SP3,KEY10,*63,XTOTINVC
          ENDIF
          MATCH     SP70,APIMCM1
          IF        !@EQUAL
            MOVE      APIMCM1,KEY50
            PRINT     *10,KEY50
            ADD       ONE,CLNO
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            MOVE      APIMCM2,KEY50
            PRINT     *10,KEY50
            ADD       ONE,CLNO
          ENDIF
          GOTO      PLINE950
.
.---- Standard new cheque layout ----
.
PLINE220  MATCH     "1",APIMTYP
          IF        @EQUAL
            MOVE      "Credit    ",KEY10
            ADD       XTOTINVC,XTOTCRD
            PRINT     *1,CPDATE,SP1,APIMDOC,LASTORD,SP2,KEY10,*47,XTOTCRD
            MULT      SEQ,XTOTCRD
          ELSE
            MOVE      "Invoice   ",KEY10
            ADD       XTOTCRD,XTOTINVC
            PRINT     *1,CPDATE,SP1,APIMREF,LASTORD,SP2,KEY10,*62,XTOTINVC
          ENDIF
          MATCH     SP70,APIMCM1
          IF        !@EQUAL
            MOVE      APIMCM1,KEY50
            PRINT     *11,KEY50
            ADD       ONE,CLNO
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            MOVE      APIMCM2,KEY50
            PRINT     *11,KEY50
            ADD       ONE,CLNO
          ENDIF
          GOTO      PLINE950
.
.---- Hutt ----
.
PLINE230  MOVE      APIMTOT,TEMPGROS
          ADD       APIMGST,TEMPGROS
          MOVE      APIMDIS,TEMPDISC
.
          MATCH     "1",APIMTYP
          IF        @EQUAL
            MOVE      "Credit    ",KEY10
            ADD       XTOTINVC,XTOTCRD
            MOVE      XTOTCRD,TEMPNET
            MULT      SEQ,TEMPGROS
            MULT      SEQ,TEMPNET
            MULT      SEQ,XTOTCRD
          ELSE
            MOVE      "Invoice   ",KEY10
            ADD       XTOTCRD,XTOTINVC
            MOVE      XTOTINVC,TEMPNET
          ENDIF
          PRINT     CPDATE:
                    *12,APIMDOC:
                    *55,TEMPNET
.
          MATCH     SP70,APIMCM1
          IF        !@EQUAL
            MOVE      APIMCM1,KEY50
            PRINT     *13,KEY50
            ADD       ONE,CLNO
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            MOVE      APIMCM2,KEY50
            PRINT     *13,KEY50
            ADD       ONE,CLNO
          ENDIF
          GOTO      PLINE950
.
.---- West Wimmera cheque layout ----
.
PLINE240  MATCH     "1",APIMTYP
          IF        @EQUAL
            MOVE      "Credit    ",KEY10
            ADD       XTOTINVC,XTOTCRD
            PRINT     *1,CPDATE,SP2,APIMDOC,LASTORD,SP3,KEY10,*49,XTOTCRD
            MULT      SEQ,XTOTCRD
          ELSE
            MOVE      "Invoice   ",KEY10
            ADD       XTOTCRD,XTOTINVC
            PRINT     *1,CPDATE,SP2,APIMREF,LASTORD,SP3,KEY10,*62,XTOTINVC
          ENDIF
          MATCH     SP70,APIMCM1
          IF        !@EQUAL
            MOVE      APIMCM1,KEY50
            PRINT     *11,KEY50
            ADD       ONE,CLNO
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            MOVE      APIMCM2,KEY50
            PRINT     *11,KEY50
            ADD       ONE,CLNO
          ENDIF
          GOTO      PLINE950
.
.---- holy spirit cheque layout ----
.
PLINE250  MATCH     "1",APIMTYP
          IF        @EQUAL
            MOVE      "Credit    ",KEY10
            ADD       XTOTINVC,XTOTCRD
            PRINT     *2,CPDATE,SP3,APIMDOC,LASTORD,SP3,KEY10,*53,XTOTCRD
            MULT      SEQ,XTOTCRD
          ELSE
            MOVE      "Invoice   ",KEY10
            ADD       XTOTCRD,XTOTINVC
            PRINT     *2,CPDATE,SP3,APIMREF,LASTORD,SP3,KEY10,*67,XTOTINVC
          ENDIF
          MATCH     SP70,APIMCM1
          IF        !@EQUAL
            MOVE      APIMCM1,KEY50
            PRINT     *13,KEY50
            ADD       ONE,CLNO
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            MOVE      APIMCM2,KEY50
            PRINT     *13,KEY50
            ADD       ONE,CLNO
          ENDIF
          GOTO      PLINE950
.
.---- St Vincents Melbourne ----- 
.
PLINE260  MATCH     "1",APIMTYP
          IF        @EQUAL
            ADD       XTOTINVC,XTOTCRD
            MULT      SEQ,XTOTCRD
            MOVE      APIMDOC,KEY15
          ELSE
            ADD       XTOTCRD,XTOTINVC
            MOVE      APIMREF,KEY15
          ENDIF
.
          BRANCH    PRTSIDE,PLINE263
          PRINT     *3,KEY15,SP1,CPDATE,SP2,XACCUM,SP2;
          SUB       ONE,CLNO
          MOVE      ONE,PRTSIDE
          GOTO      PLINE266
.
PLINE263  PRINT     KEY15,SP1,CPDATE,SP2,XACCUM
          MOVE      ZERO,PRTSIDE
          GOTO      PLINE266
.
PLINE266  MATCH     SP70,APIMCM1
          IF        !@EQUAL
            IF        PRTSIDE=0
              PRINT     *3,APIMCM1
              ADD       ONE,CLNO
            ELSE
              PRINT     " "
              PRINT     *3,APIMCM1
              ADD       TWO,CLNO
              MOVE      ZERO,PRTSIDE
            ENDIF
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            IF        PRTSIDE=0
              PRINT     *3,APIMCM2
              ADD       ONE,CLNO
            ELSE
              PRINT     " "
              PRINT     *3,APIMCM2
              ADD       TWO,CLNO
              MOVE      ZERO,PRTSIDE
            ENDIF
          ENDIF
.
          GOTO      PLINE950
.
.---- SVB cheque layout ----
.
PLINE270  MATCH     "1",APIMTYP
          IF        @EQUAL
            MOVE      "CR",KEY2
            ADD       XTOTINVC,XTOTCRD
            PRINT     *07,CPDATE,*17,APIMDOC,*31,KEY2,*48,XTOTCRD,*64,XACCUM
            MULT      SEQ,XTOTCRD
          ELSE
            MOVE      "IN",KEY2
            ADD       XTOTCRD,XTOTINVC
            PRINT     *07,CPDATE,*17,APIMREF,*31,KEY2,*38,XTOTINVC,*64,XACCUM
          ENDIF
          MATCH     SP70,APIMCM1
          IF        !@EQUAL
            MOVE      APIMCM1,KEY20
            PRINT     *17,KEY20
            ADD       ONE,CLNO
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            MOVE      APIMCM2,KEY20
            PRINT     *17,KEY20
            ADD       ONE,CLNO
          ENDIF
          GOTO      PLINE950
.
.---- Standard Laser cheque layout ----
.
PLINE280  MATCH     "1",APIMTYP
          IF        @EQUAL
            MOVE      "Credit    ",KEY10
            ADD       XTOTINVC,XTOTCRD
            PRINT     *2,CPDATE,SP3,APIMDOC,LASTORD,SP3,KEY10,*53,XTOTCRD
            MULT      SEQ,XTOTCRD
          ELSE
            MOVE      "Invoice   ",KEY10
            ADD       XTOTCRD,XTOTINVC
            PRINT     *2,CPDATE,SP3,APIMREF,LASTORD,SP3,KEY10,*67,XTOTINVC
          ENDIF
          MATCH     SP70,APIMCM1
          IF        !@EQUAL
            MOVE      APIMCM1,KEY50
            PRINT     *13,KEY50
            ADD       ONE,CLNO
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            MOVE      APIMCM2,KEY50
            PRINT     *13,KEY50
            ADD       ONE,CLNO
          ENDIF
          GOTO      PLINE950
.
.---- Latrobe Regional Laser cheque layout ----
.
PLINE290  MATCH     "1",APIMTYP
          IF        @EQUAL
            ADD       XTOTINVC,XTOTCRD
            PRINT     *2,CPCDATE,*14,APIMDOC,*52,XTOTCRD,*69,XACCUM
            ADD       XTOTCRD,TOTALCRD
            MULT      SEQ,XTOTCRD
          ELSE
            ADD       XTOTCRD,XTOTINVC
            PRINT     *2,CPCDATE,*14,APIMREF,*38,XTOTINVC,*69,XACCUM
            ADD       XTOTINVC,TOTALINV
          ENDIF
          GOTO      PLINE950
.
.---- STH cheque layout ----
.
PLINE300  MATCH     "1",APIMTYP
          IF        @EQUAL
            MOVE      "Credit    ",KEY10
            ADD       XTOTINVC,XTOTCRD
            PRINT     *2,CPDATE,SP2,APIMDOC,LASTORD,SP3,KEY10,*50,XTOTCRD
            MULT      SEQ,XTOTCRD
          ELSE
            MOVE      "Invoice   ",KEY10
            ADD       XTOTCRD,XTOTINVC
            PRINT     *2,CPDATE,SP2,APIMREF,LASTORD,SP3,KEY10,*63,XTOTINVC
          ENDIF
          MATCH     SP70,APIMCM1
          IF        !@EQUAL
            MOVE      APIMCM1,KEY50
            PRINT     *10,KEY50
            ADD       ONE,CLNO
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            MOVE      APIMCM2,KEY50
            PRINT     *10,KEY50
            ADD       ONE,CLNO
          ENDIF
          GOTO      PLINE950
.
.---- HWK (Hawkes Bay) cheque layout ----
.
PLINE310  MATCH     "1",APIMTYP
          IF        @EQUAL
            MOVE      "Credit    ",KEY10
            ADD       XTOTINVC,XTOTCRD
            PRINT     *2,CPDATE,SP2,APIMDOC,LASTORD,SP3,KEY10,*50,XTOTCRD
            MULT      SEQ,XTOTCRD
          ELSE
            MOVE      "Invoice   ",KEY10
            ADD       XTOTCRD,XTOTINVC
            PRINT     *2,CPDATE,SP2,APIMREF,LASTORD,SP3,KEY10,*63,XTOTINVC
          ENDIF
          MATCH     SP70,APIMCM1
          IF        !@EQUAL
            MOVE      APIMCM1,KEY50
            PRINT     *10,KEY50
            ADD       ONE,CLNO
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            MOVE      APIMCM2,KEY50
            PRINT     *10,KEY50
            ADD       ONE,CLNO
          ENDIF
          GOTO      PLINE950
.
.---- MHD (Mercy Hospital Dunedin - NZ) cheque layout ----
.
PLINE320  MATCH     "1",APIMTYP
          IF        @EQUAL
            MOVE      "Credit    ",KEY10
            ADD       XTOTINVC,XTOTCRD
            PRINT     *3,CPDATE,SP3,APIMDOC,LASTORD,SP3,KEY10,*54,XTOTCRD
            MULT      SEQ,XTOTCRD
          ELSE
            MOVE      "Invoice   ",KEY10
            ADD       XTOTCRD,XTOTINVC
            PRINT     *3,*SUBSCR,CPDATE,SP3,APIMREF,LASTORD,SP3:
                      KEY10,*68,XTOTINVC,*SUOFF
          ENDIF
          MATCH     SP70,APIMCM1
          IF        !@EQUAL
            MOVE      APIMCM1,KEY50
            PRINT     *10,KEY50
            ADD       ONE,CLNO
          ENDIF
.
          MATCH     SP70,APIMCM2
          IF        !@EQUAL
            MOVE      APIMCM2,KEY50
            PRINT     *10,KEY50
            ADD       ONE,CLNO
          ENDIF
          GOTO      PLINE950
.
PLINE950  MOVE      ZERO,XTOTINVC
          MOVE      ZERO,XTOTCRD
          MOVE      ZERO,XACCUM
          MOVE      SP70,LASTORD
.
PLINE999  RETURN
.----------------------------------------------------------------------
. Alignment Print
.----------------------------------------------------------------------
ALIGN000  CLOSE     SCRSBGA1           * close files to stop "S*O 024"
          CLOSE     SCRPSTA1
.
          CALL      OPNPRINT
.
          CALL      RDFMCO50
          OPEN      SCRSBGA1,"scrsbgaf" * re-open files
          OPEN      SCRPSTA1,"scrpstaf"
.
          BRANCH    FMCOAPCH,ALIGN010,ALIGN020,ALIGN030,ALIGN040,ALIGN050:
                             ALIGN060,ALIGN070,ALIGN080,ALIGN090,ALIGN100:
                             ALIGN110,ALIGN120,ALIGN130,ALIGN140,ALIGN150:
                             ALIGN160,ALIGN170,ALIGN180,ALIGN190,ALIGN200:
                             ALIGN210,ALIGN220,ALIGN230
.
.---- standard cheque layout ----
.
          PRINT     *F,*N,*N,*N:
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"***********************   ****":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*62,"**********.**":
                    *N,*N,*N,*2,"***** ***** ***** ***** ***** ***** 00"
          GOTO      ALIGN900
.
.---- HLC cheque layout ----
.
ALIGN010  PRINT     *F,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,"****************************************":
                    "***************************************":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*64,"********.**":
                    *N,*N,*N:
                    *N,*15," *****  *****  *****  *****  *****  *****   00"
          GOTO      ALIGN900
.
.---- hastings cheque layout ----
.
ALIGN020  PRINT     *F,*65,"********":
                    *N,*65,"********":
                    *N,*65,"*****":
                    *N,*N:
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"***********************   ****":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *5,"******************************":
                    *43,"********",*58,"**********.**",*N,*N,*N,*N:
                    *14,"*****  ","*****",SP2,"*****",SP2,"*****",SP2,"*****":
                    SP2,"*****",SP2,"*****",SP4,"**"
          GOTO      ALIGN900
.
.---- West Gippsland Hospital ----
.
ALIGN030  PRINT     *F,*N,*N,*N,*N:
                    *N,*66,"**/**/**",*N,*N,*N,*N:
                    *6,"*****",SP3,"*****",SP2,"*****",SP3,"*****",SP3,"*****":
                    SP3,"*****",SP2,"**":
                    *N,*60,"**********.**":
                    *N,*N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"***********************   ****":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*3,"**************",SP1,"**/**/**",SP3,"********.**":
                    SP2,"**************",SP2,"**/**/**",SP2,"********.**":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                       *3,"**************",SP1,"**/**/**",SP3,"********.**":
                    SP2,"**************",SP2,"**/**/**",SP2,"********.**":
                    *N,*N,*N,*68,"********.**"
          GOTO      ALIGN900
.
.---- MOD ----
.
ALIGN040  PRINT     *N,*N,*N,*N,*N,*N:
                    *10,"******************************":
                    *4,"XXXXX",*11,"*************************":
                    *N,*N,*3,"INVOICE NO",*19,"DATE",*36,"AMOUNT":
                    *44,"INVOICE NO",*60,"DATE",*76,"AMOUNT":
                    *N:
                    *N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*52,"Total Cheque: ","9999999999.99",*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*69,"99 XXX 99",*N,*N:
                    *9,"*****",SP1,"*****",SP1,"*****",SP1,"*****",SP1,"*****":
                    SP2,"*****",SP1,"*****",SP2,"99",*N,*N:
                    *N,*12,"*************************",*65,"9999999999.99":
                    *N,*12,"*************************":
                    *N,*12,"*************************":
                    *N,*12,"*************************":
                    *N,*N,*N,*N,*N
          GOTO      ALIGN900
.
.---- TAM cheque layout ----
.
ALIGN050  PRINT     *F,*65,"********":
                    *N,*65,"********":
                    *N,*65,"*****":
                    *N,*N,*N,*N,*N,*N,*N:
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"***********************   ****":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *5,"******************************":
                    *43,"********",*58,"**********.**",*N,*N,*N,*N:
                    *14,"*****  ","*****",SP2,"*****",SP2,"*****",SP2,"*****":
                    SP2,"*****",SP2,"*****",SP4,"**"
          GOTO      ALIGN900
.
.---- ACC ----
.
ALIGN060  PRINT     *F,*N,*N,*N,*N,*N,*N:
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"***********************   ****":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*59,"XX/XX/XX":
                    *N,*N,*N,*N,*4,"***** ***** ***** ***** ***** ***** 00":
                    *55,"**********.**"
          GOTO      ALIGN900
.
.---- GreyM ----
.
ALIGN070  PRINT     *F,*N,*N,*N,*N,*N:
                    *N,*06,"******************************":
                    *N,*06,"******************************":
                    *N,*06,"******************************":
                    *N,*06,"******************************":
                    *N,*06,"***********************   ****":
                    *N,*42,"**/**/****":
                    *N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N:
                    *N:
                    *N,*61,"********.**":
                    *N,*N,*N,*64,"**/**/****":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *09,"******************************",*N:
                    *09,"******************************":
                    *60,"*********.**",*N:
                    *11,"***** ***** ***** ***** ***** ***** ****** 00",*N:
                    *04,"***** ***** **** ***** **** **** ***** ***** ***** 00"
          GOTO      ALIGN900
.
.---- PVH ----
.
ALIGN080  PRINT     *F,*N,*N,*N,*N,*N,*N,*N:
                    "****************************************":
                    "***************************************":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*61,"********.**":
                    *N,*N,*N:
                    *N,*13," *****  *****  *****  *****  *****  *****   00"
          GOTO      ALIGN900
.
.---- Buderim ----
.
ALIGN090  PRINT     *N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*4,"**/**/**":
                    *16,"*****",SP1,"*****",SP1,"*****",SP2,"*****",SP1,"*****":
                    SP1,"*****",SP2,"**":
                    *N,*N,*61,"********.**":
                    *N,*14,"******************************":
                    *N,*14,"******************************":
                    *N,*14,"******************************":
                    *N,*14,"******************************":
                    *N,*14,"***********************   ****":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N: 
                    *N,*3,"**********",SP2,"********.**":
                    SP3,"**********",SP3,"********.**":
                    SP3,"**********",SP2,"********.**":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *3,"**********",SP2,"********.**":
                    SP3,"**********",SP3,"********.**":
                    SP3,"**********",SP2,"********.**":
                    *N,*68,"********.**",*N
          GOTO      ALIGN900
.
.---- Hawkesbury cheque layout ----
.
ALIGN100  PRINT     *F,*N,*N,*N,*N,*N:
                    *N,*17,"******************************":
                    *N,*17,"******************************":
                    *N,*17,"******************************":
                    *N,*17,"******************************":
                    *N,*N,*N,*N:
                    *06,"*************************************":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *06,"*************************************":
                    *N,*N,*N,*18,"*****",*27,"*******",*36,"999999999.99":
                    *50,"99999.99",*62,"9999999999.99":
                    *N,*N,*N,*N,*N,*N,*N,*N,*60,"99/99/99",*N,*N:
                    *03,"*************************************",*N:
                    *03,"*************************************",*N,*N:
                    *08,"*************************************":
                    *N,*57,"9999999999.99"
          GOTO      ALIGN900
.
.---- St Andrews Rockhampton cheque layout ----
.
ALIGN110  PRINT     *F,*N,*N,*N,*N:
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"***********************   ****":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*2,"***** ***** ***** ***** ***** **** 00":
                    *59,"**********.**"
          GOTO      ALIGN900
.
.---- Mater cheque layout ----
.
ALIGN120  PRINT     *F,*N,*N,*N,*N:
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"***********************   ****":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*2,"***** ***** ***** ***** ***** **** 00":
                    *57,"**********.**"
          GOTO      ALIGN900
.
.---- Standard New cheque layout ----
.
ALIGN130  PRINT     *F,*N,*N,*N,*N:
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"***********************   ****":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*2,"***** ***** ***** ***** ***** ***** 00":
                    *N,*57,"**********.**"
          GOTO      ALIGN900
.
.---- HUTT ----
.
ALIGN140  PRINT     *N,*N,*N,*06,"******************************":
                    *N,*06,"******************************":
                    *N,*06,"******************************":
                    *N,*06,"******************************":
                    *N,*06,"***********************   ****":
                    *N,*N,"*****",*43,"DD/MM/YY":
                    *N,*48,"Cheque Number ","********":
                    *N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*57,"**********.**":
                    *N,*N,*N,*N,*N:
                    *N,*70,"********":
                    *N,*N,*N,*N,*N,*N,*N:
                    *N,*06,"**********************************":
                    *N,*N,*60,"*********.**":
                    *N,*09,"*ZERO *ZERO *ZERO *ZERO *ZERO *ZERO 00":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N
          GOTO      ALIGN900
.
.---- West Wimmera cheque layout ----
.
ALIGN150  PRINT     *N,*N,*N,*N,*N:
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"***********************   ****":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*4,"*ZERO *ZERO *ZERO *ZERO *ZERO *ZERO 00":
                    *56,"**********.**",*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          GOTO      ALIGN900
.
.---- Holy Spirit cheque layout ----
.
ALIGN160  PRINT     *N,*N,*N,*N:
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"***********************   ****":
                    *N,*65,"99999999",*N,*N,*18,"XXXXX",*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*55,"**********.**",*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*53,"99/99/99",*N,*N,*N:
                    *3,"XXXXX XXXXX XXXXX XXXXX XXXXX  XXXXX 00":
                    *N,*66,"9999999999.99",*N:
                    *N,*8,"******************************":
                    *N,*8,"******************************",*N:
                    *N,*N,*N
   
          GOTO      ALIGN900
.
.---- St Vincents Melbourne ----
.
ALIGN170  PRINT     *F,*N,*N,*N,*N:
                    *N,*N,*N:
                    *7,"**/**/**":
                    *20,"*****",SP2,"*****",SP1,"*****",SP1,"*****":
                    SP2,"*****",SP2,"*****",SP1,"**":
                    *N,*N,*N,*62,"**********.**":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"***********************   ****":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*3,"**************",SP1,"**/**/**",SP3,"********.**":
                    SP2,"**************",SP2,"**/**/**",SP2,"********.**":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                       *3,"**************",SP1,"**/**/**",SP3,"********.**":
                    SP2,"**************",SP2,"**/**/**",SP2,"********.**":
                    *N,*N,*N,*68,"********.**"
          GOTO      ALIGN900
.
.---- SVB ----
.
ALIGN180  PRINT     *F,*N,*N,*N,*N,*N:
                    *N,*6,"****************************************":
                    *N,*6,"****************************************":
                    *N,*6,"****************************************":
                    *N,*6,"****************************************":
                    *N,*N,*N:
                    *7,"99/99/99",*17,"**************",*31,"**":
                       *38,"***************",*62,"***********.**":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *7,"99/99/99",*17,"**************",*31,"**":
                       *38,"***************",*62,"***********.**":
                    *N,*N,*N,*18,"*****",*27,"99999999",*36,"********.**":
                          *61,"********.**":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *2,"*************",*49,"99999999",*61,"99/99/99":
                    *N,*N,*N,*N:
                    *2,"*****  *****  *****  *****  *****  *****   00":
                          *58,"********.**"
          GOTO      ALIGN900
.
.---- Standard Laser cheque layout ----
.
ALIGN190  PRINT     *N,*N,*N,*N: 
                    *N,*10,"******************************": 
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"***********************   ****":
                    *N,*65,"99999999",*N,*N,*18,"XXXXX",*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*55,"**********.**",*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*53,"99/99/99",*N,*N,*N:
                    *3,"XXXXX XXXXX XXXXX XXXXX XXXXX  XXXXX 00":
                    *N,*66,"9999999999.99",*N:
                    *N,*8,"******************************":
                    *N,*8,"******************************",*N:
                    *N,*N,*N
   
          GOTO      ALIGN900
.
.---- Latrobe Regional Laser cheque layout ----
.
ALIGN200  PRINT     *N,*N,*N,*N:                                               
                    *N,*4,"******************************":
                    *N,*4,"******************************":                    
                    *N,*4,"******************************":
                    *N,*4,"******************************":                    
                    *N,*4,"***********************   ****",*52,"99999999":
                    *N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*67,"**********.**",*N:
                    *N,*N,*N,*N,*N,*N,*N,*66,"99/99/9999",*N:
                    *N,*8,"******************************":
                    *N,*8,"******************************":
                    *N,*N,*7,"XXXXX XXXXX XXXXX XXXXX XXXXX XXXXX XXXXX 00":
                    *66,"9999999999.99",*N,*N:
                    *N,*N,*N,*N
   
          GOTO      ALIGN900
.
.---- STH cheque layout ----
.
ALIGN210  PRINT     *F,*N,*N,*N:
                    *N,*10,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*10,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*10,"XXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*10,"XXXXXXXXXXXXXXXXXXXXXXXXX":
                    *N,*10,"XXXXXXXXXXXXXXXXXXXXXXXXX 999999":
                    *N,*63,"99999999":
                    *N,*N,*10,"99999":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N:
                    *N,*62,"*********.**",*N,*N:
                    *N,*66,"99/99/9999":
                    *N,*N,*N,*N,*N,*N,*N,*N:
                    *07,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",*N:
                    *07,"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",*N:
                    *57,"*********.**",*N:
                    *09," XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",*N:
                    " XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
          GOTO      ALIGN900
.
.---- HWK (Hawkes Bay) cheque layout ----
.
ALIGN220  PRINT     *F,*N,*N,*N:
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"******************************":
                    *N,*10,"***********************   ****":
                    *N,*63,"********":
                    *N,*18,"*****":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N:
                    *N,*63,"**/**/****":
                    *N,*N,*N,*N:
                    *N,*18,"*****************************":
                    *N,*18,"*****************************":
                    *N,*N:
                    *N,*62,"**********.**":
                    *N,*4,"***** ***** ***** ***** ***** ***** 00"
          GOTO      ALIGN900
.
.---- MHD (Mercy Hospital Dunedin) cheque layout ----
.
ALIGN230  PRINT     *N,*N,*N:
                    *N,*10:
                    *SUBSCR,"******************************",*SUOFF:
                    *N,*10:
                    *SUBSCR,"******************************",*SUOFF:
                    *N,*10:
                    *SUBSCR,"*************************",*SUOFF:
                    *N,*10:
                    *SUBSCR,"*************************",*SUOFF:
                    *N,*10:
                    *SUBSCR,"************************* ******",*SUOFF:
                    *N,*71,*SUBSCR,"********",*SUOFF:
                    *N,*18,*SUBSCR,"*****",*SUOFF:
                    *N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N:
                    *N,*66,*SUBSCR,"**********.**",*SUOFF:
                    *N,*N:
                    *N,*66,*SUBSCR,"**/**/****",*SUOFF:
                    *N,*N,*N,*N,*N:
                    *N,*09:
                    *SUBSCR,"******************************",*SUOFF:
                    *N,*09:
                    *SUBSCR,"******************************",*SUOFF:
                    *N,*N:
                    *N,*64,*SUBSCR,"*********.**",*SUOFF:
                    *N,*14:
                    *SUBSCR,"***** ***** ***** ***** ***** *****",*SUOFF:
                    *N,*4,*SUBSCR,"**********",*SUOFF:
                    *N 
          GOTO      ALIGN900
.
ALIGN900  DISPLAY   *P1:24,*EL
          CALL      CLSPRINT
          RETURN 
.**********************************************************************
. Print the Remittance Advice
.**********************************************************************
CHQHD000  ADD       ONE,CHEQNUMB
          MOVE      ZERO,CLNO
          BRANCH    FMCOAPCH,CHQHD010,CHQHD020,CHQHD030,CHQHD040,CHQHD050:
                             CHQHD060,CHQHD070,CHQHD080,CHQHD090,CHQHD100:
                             CHQHD110,CHQHD120,CHQHD130,CHQHD140,CHQHD150:
                             CHQHD160,CHQHD170,CHQHD180,CHQHD190,CHQHD200:
                             CHQHD210,CHQHD220,CHQHD230
.
.---- standard cheque layout ----
.
          PRINT     *F,*N,*N,*N:
                    *N,*10,APMACN1:
                    *N,*10,APMACN2:
                    *N,*10,APMACA1:
                    *N,*10,APMACA2:
                    *N,*10,APMACA3," ",APMACPC,*N,*63,CHEQNUMB:
                    *N,*18,APMACRD:
                    *N,*N,*N
          GOTO      CHQHD999
.
.---- HLC cheque layout ----
.
CHQHD010  MOVE      APMACA2,KEY20
          PRINT     *F,*N,*N,*N,*N:
                    *N,*21,APMACN1:
                    *N,*21,APMACN2:
                    *N,*21,APMACA1:
                    *N,*21,KEY20,APMACPC:
                    *N,*N,*N,*N
          GOTO      CHQHD999
.
.---- hastings cheque layout ----
.
CHQHD020  PRINT     *F,*65,CHEQNUMB:
                    *N,*65,DDATERUN:
                    *N,*65,APMACRD:
                    *N,*N:
                    *N,*10,APMACN1:
                    *N,*10,APMACN2:
                    *N,*10,APMACA1:
                    *N,*10,APMACA2:
                    *N,*10,APMACA3," ",APMACPC,*N:
                    *N,*2,"-----------------------------------------------":
                          "-------------------------":
                    *N,*2,"Date      Reference No.  Order      Transaction":
                          "       Credit       Debit":
                    *N,*2,"-----------------------------------------------":
                          "-------------------------"
          GOTO      CHQHD999
.
.---- West Gippsland ----
.
CHQHD030  CALL      CHQSTR00
          MOVE      ZERO,PRTSIDE
          GOTO      CHQHD999
.
.---- MOD ----
.
CHQHD040  PRINT     *N,*N,*N,*N,*N,*N:
                    *4,APMACRD,*11,APMACN1:
                    *N,*N,*3,"INVOICE NO",*19,"DATE",*36,"AMOUNT":
                       *44,"INVOICE NO",*60,"DATE",*76,"AMOUNT":
                    *N
          MOVE      ZERO,PRTSIDE
          GOTO      CHQHD999
.
.---- TAM cheque layout ----
.
CHQHD050  PRINT     *F,*65,CHEQNUMB:
                    *N,*65,DDATERUN:
                    *N,*65,APMACRD:
                    *N,*N,*N,*N,*N,*N,*N:
                    *N,*10,APMACN1:
                    *N,*10,APMACN2:
                    *N,*10,APMACA1:
                    *N,*10,APMACA2:
                    *N,*10,APMACA3," ",APMACPC:
                    *N,*2,"-----------------------------------------------":
                          "-------------------------":
                    *N,*2,"Date      Reference No.  Order      Transaction":
                          "       Credit       Debit":
                    *N,*2,"-----------------------------------------------":
                          "-------------------------"
          GOTO      CHQHD999
.
.---- ACC ----
.
CHQHD060  PRINT     *F,*N,*N,*N,*N,*N:
                    *N,*N,*10,APMACN1
          MATCH     SP70,APMACN2
          IF        !@EQUAL
            PRINT   *10,APMACN2
          ENDIF
          PRINT     *10,APMACA1:
                    *N,*10,APMACA2:
                    *N,*10,APMACA3," ",APMACPC;
          MATCH     SP70,APMACN2
          IF        @EQUAL
            PRINT     *N,*63,CHEQNUMB:
                      *N,*18,APIMCRD:
                      *N,*N
          ELSE
            PRINT     *63,CHEQNUMB:
                      *N,*18,APIMCRD:
                      *N,*N
          ENDIF
          GOTO      CHQHD999
.
.---- GreyM ----
.
CHQHD070  PACK      KEY8,CCC,CYY,CMM,CDD
          REP       " 0",KEY8
          UNPACK    KEY8,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          PRINT     *F,*N,*N,*N,*N,*N:
                    *6,APMACN1
          MATCH     SP30,APMACN2
          IF        @EQUAL
            PRINT   *6,APMACA1:
                    *N,*6,APMACA2:
                    *N,*6,APMACA3,*32,APMACPC:
                    *N,*N,*42,DDATERUN:
                    *N,*N,*N
          ELSE
            PRINT   *6,APMACN2:
                    *N,*6,APMACA1:
                    *N,*6,APMACA2:
                    *N,*6,APMACA3,*32,APMACPC:
                    *N,*42,DDATERUN:
                    *N,*N,*N
          ENDIF
          GOTO      CHQHD999
.
.---- PVH ----
.
CHQHD080  MOVE      APMACA2,KEY20
          PRINT     *F,*N,*N,*N,*N,*N:
                    *N,*06,APMACN1:
                    *N,*06,APMACN2:
                    *N,*06,APMACA1:
                    *N,*06,KEY20,APMACPC:
                    *N,*N
          GOTO      CHQHD999
.
.---- Buderim ----
.
CHQHD090  CALL      CHQSTR00
          MOVE      ZERO,PRTSIDE
          GOTO      CHQHD999
.
.---- Hawkesbury cheque layout ----
.
CHQHD100  MOVE      APMACA3,KEY20
          PRINT     *F,*N,*N,*N,*N,*N:
                    *N,*17,APMACN1:
                    *N,*17,APMACA1:
                    *N,*17,APMACA2:
                    *N,*17,KEY20,APMACPC:
                    *N,*N,*N
          GOTO      CHQHD999
.
.---- St Andrews Rockhampton cheque layout ----
.
CHQHD110  PRINT     *F,*N,*N,*N,*N:
                    *N,*10,APMACN1:
                    *N,*10,APMACN2:
                    *N,*10,APMACA1:
                    *N,*10,APMACA2:
                    *N,*10,APMACA3," ",APMACPC,*63,CHEQNUMB,*N:
                    *N,*18,APMACRD:
                    *N,*N
          GOTO      CHQHD999
.
.---- Mater cheque layout ----
.
CHQHD120  PRINT     *F,*N,*N,*N,*N:
                    *N,*10,APMACN1:
                    *N,*10,APMACN2:
                    *N,*10,APMACA1:
                    *N,*10,APMACA2:
                    *N,*10,APMACA3," ",APMACPC,*63,CHEQNUMB,*N:
                    *N,*18,APMACRD:
                    *N,*N
          GOTO      CHQHD999
.
.---- Standard new cheque layout ----
.
CHQHD130  PRINT     *F,*N,*N,*N,*N:
                    *N,*10,APMACN1:
                    *N,*10,APMACN2:
                    *N,*10,APMACA1:
                    *N,*10,APMACA2:
                    *N,*10,APMACA3," ",APMACPC:
                    *N,*59,CHEQNUMB,*N,*18,APMACRD:
                    *N,*N,*N
          GOTO      CHQHD999
.
.---- Hutt ----
.
CHQHD140  PACK      KEY8,CCC,CYY,CMM,CDD
          REP       " 0",KEY8
          UNPACK    KEY8,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE

          PRINT     *N,*N,*N,*6,APMACN1
          MATCH     SP30,APMACN2
          IF        @EQUAL
            PRINT   *6,APMACA1:
                    *N,*6,APMACA2:
                    *N,*6,APMACA3,*32,APMACPC:
                    *N,*N,*N,APMACRD,*43,DDATERUN:
                    *N,*48,"Cheque Number ",CHEQNUMB,*N,*N
          ELSE
            PRINT   *6,APMACN2:
                    *N,*6,APMACA1:
                    *N,*6,APMACA2:
                    *N,*6,APMACA3,*32,APMACPC:
                    *N,*N,APMACRD,*43,DDATERUN:
                    *N,*48,"Cheque Number ",CHEQNUMB,*N,*N
          ENDIF
          GOTO      CHQHD999
.
.---- West Wimmera cheque layout ----
.
CHQHD150  PRINT     *N,*N,*N,*N,*N:
                    *N,*10,APMACN1:
                    *N,*10,APMACN2:
                    *N,*10,APMACA1:
                    *N,*10,APMACA2:
                    *N,*10,APMACA3," ",APMACPC,*63,CHEQNUMB,*N:
                    *N,*18,APMACRD:
                    *N,*N
          GOTO      CHQHD999
.
.---- Holy Spirit cheque layout ----
.
CHQHD160  PRINT     *N,*N,*N,*N:
                    *N,*10,APMACN1:
                    *N,*10,APMACN2:
                    *N,*10,APMACA1:
                    *N,*10,APMACA2:
                    *N,*10,APMACA3," ",APMACPC,*N,*65,CHEQNUMB:
                    *N,*N,*18,APMACRD:
                    *N,*N
          GOTO      CHQHD999
.
.---- St Vincents Melbourne ----
.
CHQHD170  CALL      CHQSTR00
          MOVE      ZERO,PRTSIDE
          GOTO      CHQHD999
.
.---- SVB ----
.
CHQHD180  MOVE      APMACA2,KEY20
          PRINT     *F,*N,*N,*N,*N,*N:
                    *N,*06,APMACN1:
                    *N,*06,APMACN2:
                    *N,*06,APMACA1:
                    *N,*06,KEY20,APMACPC:
                    *N,*N
          GOTO      CHQHD999
.
.---- Standard Laser cheque layout ----
.
CHQHD190  PRINT     *N,*N,*N,*N:
                    *N,*10,APMACN1:
                    *N,*10,APMACN2:
                    *N,*10,APMACA1,*65,DDATERUN:         * srf 6645
                    *N,*10,APMACA2:
                    *N,*10,APMACA3," ",APMACPC,*N,*65,CHEQNUMB:
                    *N,*N,*18,APMACRD:
                    *N,*N
          GOTO      CHQHD999
.
.---- Lastrobe Regional Laser cheque layout ----
.
CHQHD200  PACK      KEY8,CCC,CYY,CMM,CDD
          REP       " 0",KEY8
          UNPACK    KEY8,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          PRINT     *N,*N,*N,*N:
                    *N,*4,APMACN1:
                    *N,*4,APMACN2:
                    *N,*4,APMACA1:
                    *N,*4,APMACA2:
                    *N,*4,APMACA3," ",APMACPC,*52,CHEQNUMB:
                    *N,*N,*13,APMACRD,*N,*N,*N
          GOTO      CHQHD999
.
.---- STH cheque layout ----
.
CHQHD210  PRINT     *F,*N,*N,*N:
                    *N,*10,APMACN1:
                    *N,*10,APMACN2:
                    *N,*10,APMACA1:
                    *N,*10,APMACA2:
                    *N,*10,APMACA3," ",APMACPC,*N,*63,CHEQNUMB:
                    *N,*N,*10,APMACRD:
                    *N,*N
          GOTO      CHQHD999
.
.---- HWK (Hawkes Bay) cheque layout ----
.
CHQHD220  PRINT     *F,*N,*N,*N:
                    *N,*10,APMACN1:
                    *N,*10,APMACN2:
                    *N,*10,APMACA1:
                    *N,*10,APMACA2:
                    *N,*10,APMACA3," ",APMACPC,*N,*63,CHEQNUMB:
                    *N,*18,APMACRD:
                    *N,*N
          GOTO      CHQHD999
.
.---- MHD (Mercy Hospital Dunedin) cheque layout ----
.
CHQHD230  PRINT     *N,*N,*N:
                    *N,*10,*SUBSCR,APMACN1,*SUOFF:
                    *N,*10,*SUBSCR,APMACN2,*SUOFF:
                    *N,*10,*SUBSCR,APMACA1,*SUOFF:
                    *N,*10,*SUBSCR,APMACA2,*SUOFF:
                    *N,*10,*SUBSCR,APMACA3," ",APMACPC,*SUOFF:
                    *N,*71,*SUBSCR,CHEQNUMB,*SUOFF:
                    *N,*18,*SUBSCR,APMACRD,*SUOFF:
                    *N,*N,*N
          GOTO      CHQHD999
.
CHQHD999  RETURN
.----------------------------------------------------------------------
. Print Cheque Totals
.----------------------------------------------------------------------
CHQEN000  MOVE      "1",SECTOR
          MOVE      DOLLARS,D13
          RESET     D13
.
          IF        FMCOAPCH=20 | FMCOAPCH=4
            MOVE      D13,D4
            MOVE      ZERO,F4
            MOVE      D4,F4
            MOVE      D4,DMILL
            IF        F4<10
              ADD       ONE,F4
              LOAD      DMILL,F4,DSTARS,DONE,DTWO,DTHREE,DFOUR,DFIVE,DSIX:
                                        DSEVEN,DEIGHT,DNINE
            ENDIF
            RESET     D13,5
          ELSE
            MOVE      D13,D5
            MOVE      ZERO,F5
            MOVE      D5,F5
            MOVE      D5,DHUNTH
            IF        F5<10
              ADD       ONE,F5
              LOAD      DHUNTH,F5,DSTARS,DONE,DTWO,DTHREE,DFOUR,DFIVE,DSIX:
                                         DSEVEN,DEIGHT,DNINE
            ENDIF
            RESET     D13,6
          ENDIF
.
CHQEN020  MOVE      SP1,D1
          MOVE      D13,D1
          MATCH     SP1,D1
          GOTO      CHQEN030 IF NOT EQUAL
          MOVE      DSTARS,NUMBER
          GOTO      CHQEN040
.
CHQEN030  MOVE      D1,F2
          ADD       ONE,F2
          LOAD      NUMBER,F2,DZERO,DONE,DTWO,DTHREE,DFOUR,DFIVE,DSIX,DSEVEN:
                    DEIGHT,DNINE
.
CHQEN040  IF        FMCOAPCH=20 | FMCOAPCH=4
            STORE     NUMBER,SECTOR,DHUNTH,DTENTH,DTHOUS,DHUND,DTENS,DUNITS
            BUMP      D13
            ADD       ONE,SECTOR
            COMPARE   SEVEN,SECTOR
            GOTO      CHQEN050 IF EQUAL
          ELSE
            STORE     NUMBER,SECTOR,DTENTH,DTHOUS,DHUND,DTENS,DUNITS
            BUMP      D13
            ADD       ONE,SECTOR
            COMPARE   SIX,SECTOR
            GOTO      CHQEN050 IF EQUAL
          ENDIF
          GOTO      CHQEN020
.
CHQEN050  RESET     D13,12
          RESET     DCENTS
          CMOVE     D13,DCENTS
          RESET     D13,13
          RESET     DCENTS,2
          CMOVE     D13,DCENTS
          RESET     DCENTS
.
          MOVE      DOLLARS,D13
          REP       " *",D13
          MOVE      DOLLARS,FORM8P2
.
CHQEN060  IF        FMCOAPCH=9
            IF        PRTSIDE<>0
              PRINT     " "
              ADD     ONE,CLNO
              MOVE    ZERO,PRTSIDE
            ENDIF
          ENDIF
.
          COMPARE   MAXLINES,CLNO
          GOTO      CHQEN070 IF NOT LESS
          PRINT     " "
          ADD       ONE,CLNO
          GOTO      CHQEN060
.
CHQEN070  BRANCH    FMCOAPCH,CHQEN080,CHQEN090,CHQEN100,CHQEN110,CHQEN120:
                             CHQEN130,CHQEN140,CHQEN150,CHQEN160,CHQEN170:
                             CHQEN180,CHQEN190,CHQEN200,CHQEN210,CHQEN220:
                             CHQEN230,CHQEN240,CHQEN250,CHQEN260,CHQEN270:
                             CHQEN280,CHQEN290,CHQEN300
.
.---- standard cheque layout ----
.
          PRINT     *N,*55,DOLLARS,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*50,DDATERUN,*62,D13,*N,*N,*N:
                    *2,DHUNTH,SP1,DTENTH,SP1,DTHOUS,SP1,DHUND,SP1,DTENS:
                    SP1,DUNITS,SP1,DCENTS,*N,*N,*N,*8,APMACN1,*N,*8,APMACN2
. Epworth
          MATCH     "1",FMCOEPWC
          IF        @EQUAL
            PRINT     *8,APMACA1,*N,*8,APMACA2,*N,*8,APMACA3," ",APMACPC
          ENDIF
          GOTO      CHQEN900
.
.---- HLC cheque layout ----
.
CHQEN080  PRINT     *N,*N,*21,APMACRD,*30,CHEQNUMB,*39,DOLLARS,*64,DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*2,DDATERUN,*13,APMACN1,*52,CHEQNUMB,*64,D13:
                    *N,*N,*N,*N:
                    *16,DHUNTH,SP2,DTENTH,SP2,DTHOUS,SP2,DHUND,SP2,DTENS:
                    SP2,DUNITS,SP3,DCENTS
          GOTO      CHQEN900
.
.---- hastings cheque layout ----
.
CHQEN090  PRINT     *N,*N,*N,*45,"Total : ",DOLLARS,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N:
                    *5,APMACN1,*43,DDATERUN,*58,D13,*N,*N,*N,*N:
                    *14,"*****  ",DHUNTH,SP2,DTENTH,SP2,DTHOUS,SP2,DHUND:
                    SP2,DTENS,SP2,DUNITS,SP4,DCENTS
          GOTO      CHQEN900
.
.---- West Gippsland cheque layout ----
.
CHQEN100  PRINT     *66,D13
          GOTO      CHQEN900
.
.---- MOD cheque layout ----
.
CHQEN110  UNPACK    DATERUN,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MONTHD FROM F2 OF JAN,FEB,MAR,APR,MAY,JUN:
                                       JUL,AUG,SEP,OCT,NOV,DEC
          MOVE      CDD,CDAY
          REP       " 0",CDAY
          MOVE      CYY,CYEAR
          REP       " 0",CYEAR
          PACK      DATEH,CDAY,SP1,MONTHD,SP1,CYEAR
.
          PRINT     *N,*N,*52,"Total Cheque: ",DOLLARS,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*69,DATEH,*N:
                    *9,DMILL,SP1,DHUNTH,SP1,DTENTH,SP1,DTHOUS,SP1,DHUND:
                    SP2,DTENS,SP1,DUNITS,SP2,DCENTS,*N,*N,*N
          MATCH     SP70,APMACN2
          IF        @EQUAL
            PRINT     *12,APMACN1,*65,D13,*N,*12,APMACA1,*N,*12,APMACA2:
                      *N,*12,APMACA3," ",APMACPC,*N,*N,*N,*N,*N
          ELSE
            PRINT     *12,APMACN1,*65,D13,*N,*12,APMACN2,*N,*12,APMACA1:
                      *N,*12,APMACA2,*N,*12,APMACA3," ",APMACPC,*N,*N,*N,*N
          ENDIF
          GOTO      CHQEN900
.
.---- TAM cheque layout ----
.
CHQEN120  PRINT     *N,*N,*N,*45,"Total : ",DOLLARS,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N:
                    *5,APMACN1,*43,DDATERUN,*58,D13,*N,*N,*N,*N:
                    *14,"*****  ",DHUNTH,SP2,DTENTH,SP2,DTHOUS,SP2,DHUND:
                    SP2,DTENS,SP2,DUNITS,SP4,DCENTS
          GOTO      CHQEN900
.
.---- ACC cheque layout ----
.
CHQEN130  PRINT     *N,*N,*N,*48,DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*59,DDATERUN,*N,*N,*N:
                    *N,*4,DHUNTH,SP1,DTENTH,SP1,DTHOUS,SP1,DHUND,SP1,DTENS:
                    SP1,DUNITS,SP1,DCENTS,*55,D13,*N,*N,*N,*8,APMACN1
          MATCH     SP30,APMACN2
          GOTO      CHQEN135 IF EQUAL
.
          PRINT     *8,APMACN2:
                    *N,*8,APMACA1,*N,*8,APMACA2,*N,*8,APMACA3," ",APMACPC
          GOTO      CHQEN900
.
CHQEN135  PRINT     *8,APMACA1,*N,*8,APMACA2,*N,*8,APMACA3," ",APMACPC,*N
          GOTO      CHQEN900
.
.---- GreyM cheque layout ----
.
CHQEN140  CALL      GMNEW000               * Print New Words Format
          GOTO      CHQEN900
.
.---- PVH cheque layout ----
.
CHQEN150  PRINT     *N,*N,*18,APMACRD,*27,CHEQNUMB,*36,DOLLARS,*61,DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    DDATERUN,*10,APMACN1,*49,CHEQNUMB,*61,D13:
                    *N,*N,*N,*N:
                    *13,DHUNTH,SP2,DTENTH,SP3,DTHOUS,SP2,DHUND,SP2,DTENS:
                    SP2,DUNITS,SP2,DCENTS
          GOTO      CHQEN900
.
.---- Buderim cheque layout ----
.
CHQEN160  PRINT     *52,"CHEQUE TOTAL",*67,FORM8P2,*N
          GOTO      CHQEN900
.
.---- Hawkesbury cheque layout ----
.
CHQEN170  CALL      GMNEW000               * Print New Words Format
          GOTO      CHQEN900
.
.---- St Andrews Rockhampton cheque layout ----
.
CHQEN180  PRINT     *N,*55,DOLLARS,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*63,DDATERUN,*N,*N,*N,*N:
                    *2,DHUNTH,SP1,DTENTH,SP1,DTHOUS,SP1,DHUND,SP1,DTENS:
                    SP1,DUNITS,SP1,DCENTS,*59,D13,*N,*N,*N,*13,APMACN1:
                    *N,*13,APMACN2
          GOTO      CHQEN900
.
.---- Mater cheque layout ----
.
CHQEN190  PRINT     *N,*55,DOLLARS,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*54,DDATERUN,*N,*N,*N:
                    *2,DHUNTH,SP1,DTENTH,SP1,DTHOUS,SP1,DHUND,SP1,DTENS:
                    SP1,DUNITS,SP1,DCENTS,*57,D13,*N,*N,*N,*8,APMACN1
          MATCH     SP70,APMACN2
          IF        @EQUAL
            PRINT   *8,APMACA1,*N,*8,APMACA2,*N,*8,APMACA3," ",APMACPC
          ELSE
            PRINT   *8,APMACN2:
                    *N,*8,APMACA1,*N,*8,APMACA2,*N,*8,APMACA3," ",APMACPC
          ENDIF
          GOTO      CHQEN900
.
.
.---- Standard new cheque layout ----
.
CHQEN200  PRINT     *N,*N,*45,DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*50,DDATERUN,*N,*N,*N:
                    *2,DHUNTH,SP1,DTENTH,SP1,DTHOUS,SP1,DHUND,SP1,DTENS:
                    SP1,DUNITS,SP1,DCENTS,*N,*59,D13,*N,*N,*8,APMACN1
          MATCH     SP70,APMACN2
          IF        !@EQUAL
            PRINT     *8,APMACN2
          ENDIF
. Epworth
          MATCH     "1",FMCOEPWC
          IF        @EQUAL
            PRINT     *8,APMACA1,*N,*8,APMACA2,*N,*8,APMACA3," ",APMACPC
          ENDIF
          GOTO      CHQEN900
.
.---- HUTT cheque layout ----
.
CHQEN210  CALL      GMNEW000               * Print New Words Format
          GOTO      CHQEN900
.
.---- West Wimmera cheque layout ----
.
CHQEN220  PRINT     *N,*N,*60,DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*60,DDATERUN,*N,*N,*N,*N,*N:
                    *4,DHUNTH,SP1,DTENTH,SP1,DTHOUS,SP1,DHUND,SP1,DTENS:
                    SP1,DUNITS,SP1,DCENTS,*56,D13,*N,*N,*N,*15,APMACN1:
                    *N,*15,APMACN2,*F;
          GOTO      CHQEN900
.
.---- Holy Spirit cheque layout ----
.
CHQEN230  PRINT     *N,*55,DOLLARS,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*53,DDATERUN,*N,*N,*N:
                    *2,DHUNTH,SP1,DTENTH,SP1,DTHOUS,SP1,DHUND,SP2,DTENS:
                    SP1,DUNITS,SP1,DCENTS,*N,*66,D13,*N:
                    *N,*8,APMACN1,*N,*8,APMACN2,*N:
                    *N,*N,*N,*N
          GOTO      CHQEN900
.
.---- St Vincents Melbourne ----
.
CHQEN240  PRINT     *N,*N,*66,D13
          GOTO      CHQEN900
.
.---- SVB cheque layout ----
.
CHQEN250  PRINT     *N,*N,*18,APMACRD,*27,CHEQNUMB,*36,DOLLARS,*62,DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *2,APMACN1,*49,CHEQNUMB,*61,DDATERUN:
                    *N,*N,*N,*N:
                    *2,DHUNTH,SP2,DTENTH,SP3,DTHOUS,SP2,DHUND,SP2,DTENS:
                    SP2,DUNITS,SP2,DCENTS,*58,D13
          GOTO      CHQEN900
.
.---- Standard Laser cheque layout ----
.
CHQEN260  PRINT     *N,*55,DOLLARS,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*53,DDATERUN,*N,*N,*N:
                    *2,DHUNTH,SP1,DTENTH,SP1,DTHOUS,SP1,DHUND,SP2,DTENS:
                    SP1,DUNITS,SP1,DCENTS,*N,*66,D13,*N
          MATCH     SP70,APMACN2
          IF        @EQUAL
            MATCH     "1",FMCOEPWC
            IF        @EQUAL
              PRINT     *10,APMACN1,*N,*10,APMACA1,*N,*10,APMACA2:
                        *N,*10,APMACA3," ",APMACPC,*N,*N,*N
            ELSE
              PRINT     *10,APMACN1,*N,*10," ",*N,*10," ":
                        *N,*10," ",*N,*N,*N
            ENDIF
          ELSE
            MATCH     "1",FMCOEPWC
            IF        @EQUAL
              PRINT     *10,APMACN1,*N,*10,APMACN2,*N,*10,APMACA1:
                        *N,*10,APMACA2,*N,*10,APMACA3," ",APMACPC,*N,*N
            ELSE
              PRINT     *10,APMACN1,*N,*10,APMACN2,*N,*10," ":
                        *N,*10," ",*N,*10," ",*N,*N
            ENDIF
          ENDIF
          GOTO      CHQEN900
.
.---- Latrobe Regional Laser cheque layout ----
.
CHQEN270  PRINT     *N,*N,*67,DOLLARS,*N:
                    *N,*N,*N,*N,*N,*N,*N,*66,DDATERUN,*N:
                    *N,*8,APMACN1:
                    *N,*8,APMACN2:
                    *N,*N,*7,DMILL,SP1,DHUNTH,SP1,DTENTH,SP1,DTHOUS,SP1,DHUND:
                    SP1,DTENS:
                    SP1,DUNITS,SP1,DCENTS,*66,D13,*N,*N,*N,*N,*N,*N,*N,*N
          GOTO      CHQEN900
.
.---- STH cheque layout ----
.
CHQEN280  CALL      GMNEW000               * Print New Words Format
          GOTO      CHQEN900
.
.---- HWK (Hawkes Bay) cheque layout ----
.
CHQEN290  PRINT     *N,*N,*61,DOLLARS,*N:
                    *N,*N,*N,*N,*63,DDATERUN,*N,*N,*N,*N,*N:
                    *18,APMACN1,*N,*18,APMACN2,*N,*N,*N,*62,D13,*N:
                    *4,DHUNTH,SP1,DTENTH,SP1,DTHOUS,SP1,DHUND,SP1,DTENS:
                    SP1,DUNITS,SP1,DCENTS
          GOTO      CHQEN900
.
.---- MHD (Mercy Hospital Dunedin) cheque layout ----
.
CHQEN300  CALL      GMNEW000               * Print New Words Format
          GOTO      CHQEN900
.
CHQEN900  CALL      UPREC000
          ADD       CANCHQNO,CHEQNUMB  * Increase Cheque No by Can. Cheq. (WGH)
          MOVE      ZERO,CANCHQNO     * Init Count for Cancelled Cheques (WGH)
CHQEN999  RETURN
.----------------------------------------------------------------------
. Print Cheque Continuation
.----------------------------------------------------------------------
CHQNX000  IF        FMCOAPCH=9 |FMCOAPCH=4
            IF        PRTSIDE<>0
              PRINT     " "
            ENDIF
          ENDIF
.
          COMPARE   MAXLINES,CLNO           * fill in any spare lines
          GOTO      CHQNX005 IF NOT LESS
          PRINT     " "
          ADD       ONE,CLNO
          GOTO      CHQNX000
.
CHQNX005  
          ASSIGN    DOLLARS-(XTOTINVC-XTOTCRD),DOLLARS
          BRANCH    FMCOAPCH,CHQNX010,CHQNX020,CHQNX030,CHQNX040,CHQNX050: 
                             CHQNX060,CHQNX070,CHQNX080,CHQNX090,CHQNX100: 
                             CHQNX110,CHQNX120,CHQNX130,CHQNX140,CHQNX150: 
                             CHQNX160,CHQNX170,CHQNX180,CHQNX190,CHQNX200:
                             CHQNX210,CHQNX220,CHQNX230
.
.---- standard cheque layout ----
.
          PRINT     *45,"C/FORWARD : ",DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *67,"*CANCELLED",*N,*N,*N,*3,"***CANCELLED***":
                    *N,*N,*N,*N,*16,"C A N C E L L E D ";
          GOTO      CHQNX900
.
.---- HLC cheque layout ----
.
CHQNX010  PRINT     *N,*N,*50,"C/FORWARD : ",DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*16,"***CANCELLED***",*66,"*CANCELLED":
                    *N,*N,*N,*N,*21,"C A N C E L L E D ";
          GOTO      CHQNX900
.
.---- hastings cheque layout ----
.
CHQNX020  PRINT     *45,"C/FORWARD : ",DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *67,"*CANCELLED",*N,*N,*N,*3,"***CANCELLED***":
                    *N,*N,*N,*N,*16,"C A N C E L L E D ";
          GOTO      CHQNX900
.
.---- West Gippsland cheque layout ----
.
CHQNX030  ADD       ONE,CANCHQNO               * Count Number on Cancelled
.                                              * Cheques to Add
          PRINT     *45,"C/FORWARD : ",DOLLARS
          PRINT     *F,*N,*N,*N,*N:
                    *N,*66,"CANCELLED",*N,*N,*N,*N:
                    *6,"*****",SP3,"*****",SP2,"*****",SP3,"*****",SP3,"*****":
                    SP3,"*****",SP3,"**":
                    *N,*60,"CANCELLED":
                    *N,*N,*6,APMACN1:
                    *N,*6,APMACN2:
                    *N,*6,APMACA1:
                    *N,*6,APMACA2:
                    *N,*6,APMACA3,"  ",APMACPC:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          MOVE      ZERO,CLNO
          GOTO      CHQNX950
.
.---- MOD ----
.
CHQNX040  PRINT     *N,*N,*52,"C/FORWARD   : ",DOLLARS,*N:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*69,DATEH,*N:
                    *9,"***** C A N C E L L E D *****":
                    *N,*N,*N
          MATCH     SP70,APMACN2
          IF        @EQUAL
            PRINT     *12,APMACN1,*65,"**CANCELLED**":
                      *N,*12,APMACA1,*N,*12,APMACA2:
                      *N,*12,APMACA3," ",APMACPC,*N,*N,*N,*N,*N
          ELSE
            PRINT     *12,APMACN1,*65,"**CANCELLED**":
                      *N,*12,APMACN2,*N,*12,APMACA1:
                      *N,*12,APMACA2,*N,*12,APMACA3," ",APMACPC,*N,*N,*N,*N
          ENDIF
          GOTO      CHQNX900
.
.---- TAM cheque layout ----
.
CHQNX050  PRINT     *45,"C/FORWARD : ",DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *67,"*CANCELLED",*N,*N,*N,*3,"***CANCELLED***":
                    *N,*N,*N,*N,*16,"C A N C E L L E D ";
          GOTO      CHQNX900
.
.---- ACC ----
.
CHQNX060  PRINT     *N,*N,*50,"C/FORWARD : ",DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*59,"CANCELLED",*N,*N,*N:
                    *N,*4,"***CANCELLED***",*55,"CANCELLED":
                    *N,*N,*N,*8,"C A N C E L L E D ";
          GOTO      CHQNX900
.
.---- GreyM ----
.
CHQNX070  PRINT     *N,*47,"C/FORWARD : ",*59,DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*13,"***CANCELLED***",*N,*61,"*CANCELLED":
                    *N,*N,*25,"C A N C E L L E D "
          GOTO      CHQNX900
.
.---- PVH cheque layout ----
.
CHQNX080  PRINT     *N,*N,*47,"C/FORWARD : ",DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*13,"***CANCELLED***",*63,"*CANCELLED":
                    *N,*N,*N,*N,*18,"C A N C E L L E D ";
          GOTO      CHQNX900
.
.---- Buderim cheque layout ----
.
CHQNX090  ADD       ONE,CANCHQNO               * Count Number on Cancelled
.                                              * Cheques to Add
          PRINT     *48,"Carried Forward : ",*67,"********.**"
          PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*4,"CANCELLED":
                    *16,"*****",SP1,"*****",SP1,"*****",SP2,"*****",SP1,"*****":
                    SP1,"*****",SP2,"**":
                    *N,*N,*61,"CANCELLED":
                    *N,*12,APMACN1:
                    *N,*12,APMACN2:
                    *N,*12,APMACA1:
                    *N,*12,APMACA2:
                    *N,*12,APMACA3,"  ",APMACPC:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          MOVE      ZERO,CLNO
          GOTO      CHQNX950
.
.---- Hawkesbury cheque layout ----
.
CHQNX100  PRINT     *N,*N,*50,"C/FORWARD : ",DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*3,"***CANCELLED***",*N,*N,*N,*8,"*CANCELLED":
                    *N,*57,"C A N C E L L E D ",*N;
          GOTO      CHQNX900
.
.---- St Andrews Rockhampton cheque layout ----
.
CHQNX110  PRINT     *N,*51,"C/FORWARD:",DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*5,"***CANCELLED***":
                    *61,"*CANCELLED",*N:
                    *N,*N,*16,"C A N C E L L E D ";
          GOTO      CHQNX900
.
.---- Mater cheque layout ----
.
CHQNX120  PRINT     *N,*51,"C/FORWARD:",DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*5,"***CANCELLED***":
                    *N,*55,"*CANCELLED":
                    *N,*16,"C A N C E L L E D ";
          GOTO      CHQNX900
.
.---- Standard new cheque layout ----
.
CHQNX130  PRINT     *N,*N,*45,"C/FORWARD:",DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*5,"***CANCELLED***   ":
                    "***CANCELLED***":
                    *N,*57,"*CANCELLED":
                    *N,*N,*N,*12,"C A N C E L L E D ";
          GOTO      CHQNX900
.
.---- HUTT ----
.
CHQNX140  PRINT     *N,*37,"C/FORWARD : ",*57,DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*N,*N,*N:
                    *N,*10,"***CANCELLED***":
                    *N:
                    *N,*62,"*CANCELLED":
                    *N,*12,"C A N C E L L E D ":
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          GOTO      CHQNX900
.
.---- West Wimmera cheque layout ----
.
CHQNX150  PRINT     *N,*N,*50,"C/FORWARD:",DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*5,"***CANCELLED***":
                    *59,"*CANCELLED",*N:
                    *N,*N,*16,"C A N C E L L E D ",*F;
          GOTO      CHQNX900
.
.---- Holy Spirit cheque layout ----
.
CHQNX160  PRINT     *N,*53,"C/FORWARD : ",DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*3,"****CANCELLED****  ****CANCELLED****":
                    *N,*67,"*CANCELLED",*N,*N,*N,*3,"***CANCELLED***":
                    *N,*N,*N,*N,*N
          GOTO      CHQNX900
.
.---- St Vincents Melbourne ----
.
CHQNX170  ADD       ONE,CANCHQNO               * Count Number on Cancelled
.                                              * Cheques to Add
          PRINT     *N,*N,*45,"C/FORWARD : ",*66,DOLLARS
          PRINT     *F,*N,*N,*N,*N:
                    *N,*N,*N:
                    *6,"CANCELLED":
                    *20,"*****",SP2,"*****",SP1,"*****",SP1,"*****",SP2,"*****":
                    SP2,"*****",SP1,"**":
                    *N,*N,*N,*62,"CANCELLED":
                    *N,*10,APMACN1:
                    *N,*10,APMACN2:
                    *N,*10,APMACA1:
                    *N,*10,APMACA2:
                    *N,*10,APMACA3,"  ",APMACPC:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          MOVE      ZERO,CLNO
          GOTO      CHQNX950
.
.---- SVB cheque layout ----
.
CHQNX180  PRINT     *N,*N,*47,"C/FORWARD :    ",DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*13,"***CANCELLED***":
                    *N,*N,*N,*N,*18,"C A N C E L L E D ",*59,"*CANCELLED";
          GOTO      CHQNX900
.
.---- Standard Laser cheque layout ----
.
CHQNX190  PRINT     *N,*53,"C/FORWARD : ",DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*3,"****CANCELLED****  ****CANCELLED****":
                    *N,*67,"*CANCELLED",*N,*N,*N,*3,"***CANCELLED***":
                    *N,*N,*N,*N,*N
          GOTO      CHQNX900
.
.---- Latrobe Regional Laser cheque layout ----
.
CHQNX200  PRINT     *N,*N,*55,"C/FORWARD : ",DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*8,"***CANCELLED***":
                    *N,*N,*N,*8,"****CANCELLED****     ****CANCELLED****":
                    *65,"***CANCELLED***",*N,*N,*N:
                    *N,*N,*N,*N,*N
          GOTO      CHQNX900
.
.---- STH cheque layout ----
.
..          PRINT     *N,*47,"C/FORWARD : ",*59,DOLLARS:
CHQNX210  PRINT     *N,*59,"CARRIED FORWARD":
                    *N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*N,*N,*10,"***CANCELLED***",*N,*N,*58,"*CANCELLED":
                    *N,*N,*25,"C A N C E L L E D "
          GOTO      CHQNX900
.
.---- HWK (Hawkes Bay) cheque layout ----
.
CHQNX220  PRINT     *N,*45,"C/FORWARD :     ",DOLLARS:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*19,"***CANCELLED***",*N,*N:
                    *N,*N,*64,"*CANCELLED",*N,*16,"C A N C E L L E D ",*N;
          GOTO      CHQNX900
.
.---- MHD (Mercy Hospital Dunedin) cheque layout ----
.
..          PRINT     *N,*47,"C/FORWARD : ",*59,DOLLARS:
CHQNX230  PRINT     *N,*64,*SUBSCR,"CARRIED FORWARD",*SUOFF:
                    *N,*N:
                    *N,*66,*SUBSCR,"**********",*SUOFF:
                    *N,*N,*N,*N,*N:
                    *N,*09,*SUBSCR,"***CANCELLED***",*SUOFF:
                    *N,*N,*N:
                    *N,*64,*SUBSCR,"*CANCELLED",*SUOFF:
                    *N,*13,*SUBSCR,"C A N C E L L E D ",*SUOFF:
                    *N,*N,*N,*N,*N,*N,*N,*N
          GOTO      CHQNX900
.
CHQNX900  CALL      CHQHD000
CHQNX950  ASSIGN    DOLLARS+(XTOTINVC-XTOTCRD),DOLLARS
          RETURN
.----------------------------------------------------------------------
. Print Cheque at Top of Page (West Gippsland,STV & Buderim Only)
.----------------------------------------------------------------------
CHQSTR00  MOVE      TMPMOD,DOLLARS
          MOVE      "1",SECTOR
          MOVE      DOLLARS,D13
          RESET     D13
          MOVE      D13,D5
          MOVE      ZERO,F5
          MOVE      D5,F5
          MOVE      D5,DHUNTH
          IF        F5<10
            ADD       ONE,F5
            LOAD      DHUNTH,F5,DSTARS,DONE,DTWO,DTHREE,DFOUR,DFIVE,DSIX,DSEVEN:
                      DEIGHT,DNINE
          ENDIF
          RESET     D13,6
.
CHQSTR20  MOVE      SP1,D1
          MOVE      D13,D1
          MATCH     SP1,D1
          GOTO      CHQSTR30 IF NOT EQUAL
          MOVE      DSTARS,NUMBER
          GOTO      CHQSTR40
.
CHQSTR30  MOVE      D1,F2
          ADD       ONE,F2
          LOAD      NUMBER,F2,DZERO,DONE,DTWO,DTHREE,DFOUR,DFIVE,DSIX,DSEVEN:
                    DEIGHT,DNINE
.
CHQSTR40  STORE     NUMBER,SECTOR,DTENTH,DTHOUS,DHUND,DTENS,DUNITS
          BUMP      D13
          ADD       "1",SECTOR
          COMPARE   "6",SECTOR
          GOTO      CHQSTR50 IF EQUAL
          GOTO      CHQSTR20
.
CHQSTR50  RESET     D13,12
          RESET     DCENTS
          CMOVE     D13,DCENTS
          RESET     D13,13
          RESET     DCENTS,2
          CMOVE     D13,DCENTS
          RESET     DCENTS
.
          MOVE      DOLLARS,D13
          REP       " *",D13
          MOVE      DOLLARS,DOLLARS1
          MOVE      DOLLARS1,D11
          REP       " *",D11
.
CHQSTR70  COMPARE   NINE,FMCOAPCH
          GOTO      CHQSTR80 IF EQUAL
          COMPARE   THREE,FMCOAPCH
          GOTO      CHQSTR75 IF EQUAL
          COMPARE   TEN7,FMCOAPCH
          GOTO      CHQSTR99 IF NOT EQUAL
.
          PRINT     *F,*N,*N,*N,*N:
                    *N,*N,*N:
                    *7,DDATERUN,*20,DHUNTH,SP2,DTENTH,SP1,DTHOUS,SP1,DHUND:
                    SP2,DTENS,SP2,DUNITS,SP1,DCENTS,*N,*N,*N,*62,D13:
                    *N,*10,APMACN1
          MATCH     SP70,APMACN2
          IF        !(@EQUAL)
            PRINT     *10,APMACN2
          ENDIF
          PRINT     *10,APMACA1:
                    *N,*10,APMACA2:
                    *N,*10,APMACA3,"  ",APMACPC:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          MATCH     SP70,APMACN2
          IF        @EQUAL
            PRINT     " "
          ENDIF
          MOVE      ZERO,DOLLARS
          GOTO      CHQSTR99
.
CHQSTR75  PRINT     *F,*N,*N,*N,*N:
                    *N,*66,DDATERUN,*N,*N,*N,*N:
                    *6,DHUNTH,SP3,DTENTH,SP2,DTHOUS,SP3,DHUND,SP3,DTENS:
                    SP3,DUNITS,SP3,DCENTS:
                    *N,*60,D13:
                    *N,*N,*10,APMACN1
          MATCH     SP70,APMACN2
          IF        !(@EQUAL)
            PRINT     *10,APMACN2
          ENDIF
          PRINT     *10,APMACA1:
                    *N,*10,APMACA2:
                    *N,*10,APMACA3,"  ",APMACPC:
                    *N,*N,*N,*N,*N,*N,*N,*N,*N,*N,*N
          MATCH     SP70,APMACN2
          IF        @EQUAL
            PRINT     " "
          ENDIF
          MOVE      ZERO,DOLLARS
          GOTO      CHQSTR99
.
CHQSTR80  MATCH     "*****",DHUNTH
          IF        !@EQUAL
            REP       "* ",DHUNTH
          ENDIF
          MATCH     "*****",DTENTH
          IF        !@EQUAL
            REP       "* ",DTENTH
          ENDIF
          MATCH     "*****",DTHOUS
          IF        !@EQUAL
            REP       "* ",DTHOUS
          ENDIF
          MATCH     "*****",DHUND
          IF        !@EQUAL
            REP       "* ",DHUND
          ENDIF
          MATCH     "*****",DTENS
          IF        !@EQUAL
            REP       "* ",DTENS
          ENDIF
          MATCH     "*****",DUNITS
          IF        !@EQUAL
            REP       "* ",DUNITS
          ENDIF
.
          PRINT     *N,*N,*N,*N,*N,*N,*N,*N:
                    *N,*4,DDATERUN:
                    *16,DHUNTH,SP1,DTENTH,SP1,DTHOUS,SP2,DHUND,SP1,DTENS:
                    SP1,DUNITS,SP2,DCENTS:
                    *N,*N,*61,D11:
                    *N,*12,APMACN1
          MATCH     SP70,APMACN2
          IF        !(@EQUAL)
            PRINT     *12,APMACN2
          ENDIF
          PRINT     *12,APMACA1:
                    *N,*12,APMACA2:
                    *N,*12,APMACA3,"  ",APMACPC
          MATCH     SP70,APMACN2
          IF        @EQUAL
            PRINT     " "
          ENDIF
          PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    *3,"INVOICE",*20,"AMOUNT",*28,"INVOICE",*45,"AMOUNT":
                    *54,"INVOICE",*72,"AMOUNT",*N
          MOVE      ZERO,DOLLARS

CHQSTR99  RETURN
.-------------------------------------------------------------------------
. Greymouth Print String if <= 999999.99 in amount
.-------------------------------------------------------------------------
GMNEW000  CALL      GMSTR000                 * Get Greymouth string
.
          IF        FMCOAPCH=7
            PACK      DIM12,SP10,SP2
            UNPACK    D13,D1,DIM12
            PRINT     *N,*59,DOLLARS,*N,*N,*N:
                      *64,DDATERUN,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                      *09,APMACN1,*N:
                      *09,APMACN2,*60,DIM12,*N:
                      *12,PRNSTR1,*N,*03,PRNSTR2
          ENDIF
          IF        FMCOAPCH=10
            PACK      DIM12,SP10,SP2
            UNPACK    D13,D1,DIM12
            PRINT     *N,*N,*18,APMACRD,*27,CHEQNUMB,*37,TOTALINV:
                      *47,TOTALCRD,*62,DOLLARS:
                      *N,*N,*N,*N,*N,*N,*N,*N,*60,DDATERUN,*N,*N:
                      *03,APMACN1,*N:
                      *03,APMACN2,*N,*N:
                      *08,PRNSTR1,*N,PRNSTR2:
                      *57,DIM12
          ENDIF
.
.---- Hutt Valley ----
          IF        FMCOAPCH=14
            PACK      DIM12,SP10,SP2
            UNPACK    D13,D1,DIM12
            PRINT     *N,*57,DOLLARS:
                      *N,*N,*N,*N,*N:
                      *N,*70,DDATERUN:
                      *N,*N,*N,*N,*N,*N,*N:
                      *N,*06,APMACN1:
                      *N,*06,APMACN2:              
                      *N,*60,DIM12:
                      *N,*09,PRNSTR1:               
                      *N,*09,PRNSTR2:               
                      *N,*N,*N,*N,*N,*N,*N,*N,*N
          ENDIF
          IF        FMCOAPCH=21
            PACK      DIM12,SP10,SP2
            UNPACK    D13,D1,DIM12
            PRINT     *N,*61,DOLLARS,*N,*N:
                      *N,*66,DDATERUN:
                      *N,*N,*N,*N,*N,*N,*N,*N:
                      *07,APMACN1,*N:
                      *07,APMACN2,*N,*57,DIM12,*N:
                      *09,PRNSTR1,*N,PRNSTR2
          ENDIF
.
.---- Mercy ----       
          IF        FMCOAPCH=23
            PACK      DIM12,SP10,SP2
            UNPACK    D13,D1,DIM12
            PRINT     *N,*66,*SUBSCR,DOLLARS,*N,*N,*SUOFF:
                      *N,*66,*SUBSCR,DDATERUN,*SUOFF:
                      *N,*N,*N,*N,*N,*N:
                      *09,*SUBSCR,APMACN1,*SUOFF,*N:
                      *09,*SUBSCR,APMACN2,*SUOFF,*N:
                      *N,*N,*SUBSCR,*64,DIM12,*SUOFF,*N:
                      *13,*SUBSCR,PRNSTR1,*SUOFF,*N:
                      *4,*SUBSCR,PRNSTR2,*SUOFF:
                      *N,*N,*N,*N,*N,*N,*N
          ENDIF
.
GMNEW999  RETURN
.-------------------------------------------------------------------------
. Get the print strings for Greymouth cheque amount in words
.-------------------------------------------------------------------------
GMSTR000  UNPACK    DOLLARS,GMDIM4,GMDIM9
.
          MATCH     SP4,GMDIM4
          IF        !@EQUAL
            MOVE      GMDIM9,GMFRM6P2
            MOVE      GMFRM6P2,GMDIM9
          ENDIF
.
.-------- i.e       999999.99
          UNPACK    GMDIM9,GMD1A,GMD1B,GMD1C,GMD1D,GMD1E,GMD1F,GMD1G,GMD1H,GMD1I
          MOVE      GMD1A,GMF1A
          MOVE      GMD1B,GMF1B
          MOVE      GMD1C,GMF1C
          MOVE      GMD1D,GMF1D
          MOVE      GMD1E,GMF1E
          MOVE      GMD1F,GMF1F
          MOVE      GMD1H,GMF1H
          MOVE      GMD1I,GMF1I
.
          PACK      GMSTR1,SP70,SP70         * String Line 1
          CLEAR     GMSTR1
.
          MATCH     SP4,GMDIM4
          IF        !@EQUAL
            UNPACK    GMDIM4,KEY3,KEY1
            MATCH     KEY3,SP70
            IF        @EQUAL
              MOVE      KEY1,FORM1
              LOAD      KEY9,FORM1,GMONE,GMTWO,GMTHREE,GMFOUR,GMFIVE:     
                                   GMSIX,GMSEVEN,GMEIGHT,GMNINE
              SQUEEZE   KEY9
              APPEND    KEY9,GMSTR1
            ELSE
              APPEND    GMDIM4,GMSTR1
            ENDIF
            APPEND    " MILLION ",GMSTR1
          ENDIF
.
          MATCH     SP1,GMD1A
          IF        @EQUAL
            GOTO    GMSTR100
          ENDIF
.
          LOAD      KEY9,GMF1A,GMONE,GMTWO,GMTHREE,GMFOUR,GMFIVE:     
                               GMSIX,GMSEVEN,GMEIGHT,GMNINE
          SQUEEZE   KEY9
          APPEND    KEY9,GMSTR1
          APPEND    " HUNDRED",GMSTR1
.
GMSTR100  MATCH     SP1,GMD1B
          GOTO      GMSTR130 IF NOT EQUAL
          MATCH     SP1,GMD1C
          GOTO      GMSTR300 IF EQUAL
.
          MATCH     SP1,GMD1B
          GOTO      GMSTR200 IF EQUAL
.
GMSTR130  COMPARE   ZERO,GMF1B
          GOTO      GMSTR200 IF EQUAL
.
          APPEND    SP1,GMSTR1
          IF        GMF1B=1
            PACK      DIM2,GMF1B,GMF1C
            MOVE      DIM2,FORM2
            SUBTRACT  TEN,FORM2
            MOVE      GMTEN,KEY9
            LOAD      KEY9,FORM2,GMELEVEN,GMTWELVE,GMTHIRTE,GMFOURTE,GMFIFTEE:
                                 GMSIXTEE,GMSEVENT,GMEIGHTE,GMNINETE
            SQUEEZE   KEY9
            APPEND    KEY9,GMSTR1
            GOTO      GMSTR250
          ELSE
            LOAD      KEY9,GMF1B,GMTEN,GMTWENTY,GMTHIRTY,GMFOURTY,GMFIFTY:
                                 GMSIXTY,GMSEVENY,GMEIGHTY,GMNINETY
          ENDIF
          SQUEEZE   KEY9
          APPEND    KEY9,GMSTR1
.
GMSTR200  IF        GMF1C=0
            GOTO      GMSTR250
          ELSE
            LOAD      KEY9,GMF1C,GMONE,GMTWO,GMTHREE,GMFOUR,GMFIVE:     
                                 GMSIX,GMSEVEN,GMEIGHT,GMNINE
          ENDIF
          SQUEEZE   KEY9
          MATCH     SP1,GMD1B
          IF        !@EQUAL
            APPEND    "-",GMSTR1
          ELSE
            APPEND    SP1,GMSTR1
          ENDIF
          APPEND    KEY9,GMSTR1
.
GMSTR250  APPEND    " THOUSAND ",GMSTR1   * Max of 40 after here
.
GMSTR300  MATCH     SP1,GMD1D
          GOTO      GMSTR400 IF EQUAL
.
          IF        GMF1D > 0
            LOAD      KEY9,GMF1D,GMONE,GMTWO,GMTHREE,GMFOUR,GMFIVE:     
                                 GMSIX,GMSEVEN,GMEIGHT,GMNINE
            SQUEEZE   KEY9
            APPEND    KEY9,GMSTR1
            APPEND    " HUNDRED ",GMSTR1
          ENDIF
.
GMSTR400  MOVE      SP9,KEY9
          MATCH     SP1,GMD1E
          GOTO      GMSTR430 IF NOT EQUAL
          MATCH     SP1,GMD1F
          GOTO      GMSTR500 IF EQUAL
.
          MATCH     SP1,GMD1E
          GOTO      GMSTR450 IF EQUAL
.
GMSTR430  COMPARE   ZERO,GMF1E
          IF        @EQUAL
            APPEND    SP1,GMSTR1
            GOTO      GMSTR450
          ENDIF
.
          IF        GMF1E=1
            PACK      DIM2,GMF1E,GMF1F
            MOVE      DIM2,FORM2
            SUB       TEN,FORM2
            MOVE      GMTEN,KEY9
            LOAD      KEY9,FORM2,GMELEVEN,GMTWELVE,GMTHIRTE,GMFOURTE,GMFIFTEE:
                                 GMSIXTEE,GMSEVENT,GMEIGHTE,GMNINETE
            SQUEEZE   KEY9
            APPEND    KEY9,GMSTR1
            APPEND    SP1,GMSTR1
            GOTO      GMSTR500
          ELSE
            LOAD      KEY9,GMF1E,GMTEN,GMTWENTY,GMTHIRTY,GMFOURTY,GMFIFTY:
                                 GMSIXTY,GMSEVENY,GMEIGHTY,GMNINETY
          ENDIF
          SQUEEZE   KEY9
          APPEND    KEY9,GMSTR1
          IF        GMF1F = 0
            APPEND    SP1,GMSTR1
            GOTO      GMSTR500
          ENDIF
          APPEND    "-",GMSTR1
.
GMSTR450  LOAD      KEY9,GMF1F,GMONE,GMTWO,GMTHREE,GMFOUR,GMFIVE:     
                                 GMSIX,GMSEVEN,GMEIGHT,GMNINE
          SQUEEZE   KEY9
          APPEND    KEY9,GMSTR1
          APPEND    SP1,GMSTR1
.
GMSTR500  MATCH     SP1,GMD1F
          IF        !@EQUAL
            APPEND    "DOLLARS",GMSTR1
          ELSE
            MATCH     GMDIM4,SP4
            IF        @EQUAL
              GOTO      GMSTR600
            ELSE
              APPEND    "DOLLARS",GMSTR1
            ENDIF
          ENDIF
.
          PACK      DIM2,GMD1H,GMD1I
          MATCH     "00",DIM2
          IF        @EQUAL
            APPEND    " ONLY",GMSTR1
          ELSE
            APPEND    " AND ",GMSTR1
            APPEND    GMD1H,GMSTR1
            APPEND    GMD1I,GMSTR1
            APPEND    " CENTS",GMSTR1
          ENDIF
          GOTO      GMSTR650
.
GMSTR600  APPEND    GMD1H,GMSTR1
          APPEND    GMD1I,GMSTR1
          APPEND    " CENTS",GMSTR1
.
GMSTR650  PACK      PRNSTR1,SP70
          PACK      PRNSTR2,SP70
          RESET     GMSTR1
          RESET     GMSTR1,GM45
.
          MOVE      GM45,GMFORM3
.
GMSTR660  SUB       ONE,GMFORM3
          RESET     GMSTR1,GMFORM3
          CMATCH    SP1,GMSTR1
          GOTO      GMSTR660 IF NOT EQUAL
.
          MOVE      GMSTR1,PRNSTR2
.
          BUMP      GMSTR1,-1
          LENSET    GMSTR1
          RESET     GMSTR1
          MOVE      GMSTR1,PRNSTR1
.
.
GMSTR999  RETURN
.----------------------------------------------------------------------
. Update cheque audit file
.----------------------------------------------------------------------
OUTPFIL   ASSIGN    APINAMT+APINGST,F12P2
          PACK      KEY51,APAPBCH,APAPCRD,APAPREF,APAPDOC,APAPORD,APAPLIN,SP70
          CALL      RDAPIN1
.
          MOVE      ZERO,APCAAMT
          MOVE      APINDES,APCADES
          PACK      KEY37,APINLED,APAPPYC,APAPCRD,APAPREF,SP70
          UNPACK    KEY37,APCALED,APCACHQ,APCACRD,APCAINV
          CALL      RDAPCA2
.
          ASSIGN    F12P2+APCAAMT,APCAAMT
          CALL      DEAPCA2
          IF        !(APCAAMT=0)
            PACK      APMASKY,SP20
            PACK      KEY5,APCACRD,SP70
            CALL      RDAPMA1
            MOVE      APMASKY,APCASORT
            CALL      WRAPCA2
          ENDIF
.
          RETURN
.
.**********************************************************************
.  UPREC - Save Cheque Number
.**********************************************************************
UPREC000  PACK      SKEY52,APAPCRD,APAPREF,APAPTYP,APAPDOC:
                           APAPORD,APAPLIN,APAPBCH,SP70
.
          MOVE      ZERO,XTOTINVC
          MOVE      ZERO,XTOTCRD
          MOVE      ZERO,XACCUM
          MOVE      ZERO,TOTINVC
          MOVE      ZERO,TOTCRD
.
          PACK      KEY52,LASTCRE,SP70          * position at start of creditor
.
UPREC100  CALL      RSAPAP1                      * loop through payments file
          CALL      RKAPAP1
          BRANCH    OVRCD,UPREC999
          PACK      KEY52,APAPCRD,APAPREF,APAPTYP,APAPDOC:
                          APAPORD,APAPLIN,APAPBCH,SP70
          MATCH     LASTCRE,KEY52
          GOTO      UPREC999 IF NOT EQUAL
.
          MOVE      CHEQNUMB,F15                 * update cheque number
          MOVE      F15,APAPPYC
          MOVE      DATERUN,APAPPYD              * update accounting date
          CALL      UPAPAP1
.
          GOTO      UPREC100
.
UPREC999  MOVE      ZERO,DOLLARS
          MOVE      SKEY52,KEY52
          CALL      RDAPAP1                 * restore original record
.
          RETURN
.--------------------------------------------------------------------------
. Check if Debit Balance Creditor (Returns OVRCD (1=yes), TMPMOD=balance)
.--------------------------------------------------------------------------
DBALC000  PACK      SKEY52,APAPCRD,APAPREF,APAPTYP,APAPDOC:
                           APAPORD,APAPLIN,APAPBCH,SP70
.                                           * save key and init totals
          MOVE      ZERO,TMPPAY
          MOVE      ZERO,TMPMOD
          MOVE      ZERO,INVLINES           * Number of Invoices being Paid
          MOVE      APAPREF,FIRSTINV
          PACK      KEY52,APAPCRD,SP70
          CALL      RSAPAP1
.
DBALC100  CALL      RKAPAP1
          BRANCH    OVRCD,DBALC200
.
          MATCH     APAPCRD,SKEY52
          GOTO      DBALC200 IF NOT EQUAL
.
          MATCH     SP70,APAPPYC            * has cheque been updated before ?
          IF        @EQUAL
            MOVE      Z70,APAPPYC           * update cheque number
          ENDIF
          MOVE      DATERUN,APAPPYD         * update accounting date
          CALL      UPAPAP1
.
          ADD       APAPPAY,TMPPAY
          ADD       APAPGST,TMPPAY
          ADD       APAPTPY,TMPMOD
          ADD       ONE,INVLINES
          GOTO      DBALC100
.
DBALC200  MOVE      SKEY52,KEY52
          CALL      RDAPAP1                 * restore original record
.
          COMPARE   TMPMOD,ZERO
          GOTO      DBALC950 IF NOT LESS
.
DBALC900  MOVE      ZERO,OVRCD
          GOTO      DBALC999
.
DBALC950  MOVE      ONE,OVRCD
.
DBALC999  RETURN
.**********************************************************************
. Create Batch
.**********************************************************************
CRBAT000  CALL      RDFMCO50
          CALL      RDFMCO51
          CALL      RDFMCO52
.
          CALL      DELCA000
          IF        EXIT=2
            MOVE      "ERROR - Cannot Delete Payment Audit File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      CRBAT999
          ENDIF
          CALL      MAKCA000
          IF        EXIT=2
            MOVE      "ERROR - Cannot Create Payment Audit File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      CRBAT999
          ENDIF
          CALL      CKTRN000
          IF        EXIT=1
            MOVE      "ERROR - Blank Payment Reference - ",DISPMSG
            CALL      MESSAGE1
            MOVE      "ERROR - Cheques or Direct Transfer Incomplete - ",DISPMSG
            CALL      MESSAGE1
            GOTO      CRBAT999
          ENDIF
.
          CALL      BTCH0000                * create batch
          CALL      UPDT0000                * update
.
CRBAT999  RETURN
.------------------------------------------------------------
. Check References 
.------------------------------------------------------------
CKTRN000  PACK      KEY52,SP70
          MOVE      ZERO,EXIT
          CALL      RSAPAP1
CKTRN100  CALL      RKAPAP1
          BRANCH    OVRCD,CKTRN999
          COMPARE   ZERO,APAPTPY
          GOTO      CKTRN100 IF EQUAL
          MATCH     SP70,APAPPYC
          GOTO      CKTRN100 IF NOT EQUAL
.
CKTRN200  MOVE      ONE,EXIT     * Blank Reference Found
.
CKTRN999  RETURN
.**********************************************************************
. Get the next batch file and prepare it for entries
.**********************************************************************
BTCH0000  CALL      RDFMCOAU
          MATCH     "00000",FMBAUBAT
          GOTO      BTCH0000 IF EQUAL  * cannot be zero
.
          MOVE      FMBAUBAT,FORM5
          MOVE      FORM5,BATCHNO
          REP       " 0",BATCHNO
          MOVE      BATCHNO,KEY5
.
          CALL      RDAPBM1
          COMPARE   ZERO,OVRCD
          GOTO      BTCH0000 IF EQUAL  * must not exist in creditors
          CALL      RDFMBC1
          COMPARE   ZERO,OVRCD
          GOTO      BTCH0000 IF EQUAL  * must not exist in general ledger
.
          CLEAR     BFILE
          APPEND    "bch",BFILE
          APPEND    BATCHNO,BFILE
          RESET     BFILE
.
          MOVE      ZERO,OVRCD         * batch text file must not exist
          TRAP      OVERCOND IF IO
          OPEN      BATFILE,BFILE
          TRAPCLR   IO
          BRANCH    OVRCD,BTCH3000
.
          CLOSE     BATFILE
          GOTO      BTCH0000
.
. Batch Does Not Exist Create It
.
BTCH3000  MOVE      "5",FIELDNO
          MOVE      FIELDNO,FLDID
          CALL      GETPOSIT
          MOVE      BATCHNO,VAR
          CALL      DISPITEM
.
          PACK      KEY5,BATCHNO,SP70
          UNPACK    KEY5,APBMBCH
.
          PACK      KEY51,APBMBCH,SP70
          CALL      RSAPIN1
          CALL      RKAPIN1
          BRANCH    OVRCD,BTCH3020
.
          MATCH     APINBCH,APBMBCH
          IF        @EQUAL
            MOVE      APINLED,KEY2
            CALL      RDFMLA1
            BRANCH    OVRCD,BTCH3020
            GOTO      BTCH3040
          ENDIF
.
BTCH3020  PACK      KEY2,FMDEFLED,SP70
          CALL      RDFMLA1
          IF        OVRCD=1
            MOVE      SP70,KEY2
            CALL      RSFMLA1
            CALL      RKFMLA1
          ENDIF
.
BTCH3040  MOVE      FMLALEDG,APBMLED
          MOVE      FMDSCODE,APBMDIS
          MOVE      FMRSCODE,APBMRES
          MOVE      "PY",APBMTYP
          MOVE      PASSCODE,APBMOPR
          PACK      APBMDAT,CCC,CYY,CMM,CDAY
          REP       " 0",APBMDAT
          MOVE      DATERUN,APBMADT
          MOVE      SP70,APBMUDT
          MOVE      CHEQACCT,APBMCHQ
          MOVE      SP70,APBMSPA
          MOVE      ZERO,APBMTOT
.
.**********************************************************************
.          Be careful with APBM1 in this loop  !!!!!!!!!!!!!!!!
.**********************************************************************
          PACK      LASTDOCT,SP70
          PACK      LASTCRE,SP70
          PACK      KEY52,SP70
          CALL      RSAPAP1
.
BTCH3100  CALL      RKAPAP1
          BRANCH    OVRCD,BTCH3900
.
          MATCH     APAPCRD,LASTCRE
          IF        !@EQUAL
            MOVE      APAPCRD,LASTCRE
            CALL      DBALD000                   * check if payment required
            IF        OVRCD=1
              PACK      KEY52,APAPCRD,Z70        * if so, skip this creditor
              CALL      RSAPAP1
              GOTO      BTCH3100
            ENDIF
          ENDIF
.
          COMPARE   ZERO,APAPTPY
          GOTO      BTCH3100 IF EQUAL       * skip if zero transaction
.
          DISPLAY   *P1:24,"Creating : ",*V2LON,APAPCRD,APAPREF:
                    APAPTYP,APAPDOC,APAPORD,APAPLIN,APAPBCH,*EL;
.
          PACK      DIM40,APAPBCH,APAPCRD,APAPREF,APAPDOC,SP70
          MATCH     DIM40,LASTDOCT
          IF        !@EQUAL
            PACK      KEY40,APIMBCH,APIMCRD,APIMREF,APIMDOC,SP70
            MATCH     SP70,LASTDOCT          * write last header record
            IF        !@EQUAL
              MOVE      APIMTOT,SAVTOT
              MOVE      APIMGST,SAVGST
              CALL      RDAPIM1
              IF        OVRCD=1
                CALL      WRAPIM1
                PACK      KEY40,APIMDOC,APIMBCH,APIMCRD,APIMREF
                UNPACK    KEY40,APCLDOC,APCLBCH,APCLCRD,APCLREF
                CALL      WRAPCL1
              ELSE
                ADD       SAVTOT,APIMTOT
                ADD       SAVGST,APIMGST
                CALL      UPAPIM1
              ENDIF
            ENDIF
.
            MOVE      DATERUN,APIMIDT
            MOVE      DIM40,LASTDOCT
            MOVE      DIM40,KEY40
            UNPACK    KEY40,APIMBCH,APIMCRD,APIMREF,APIMDOC
            CALL      RDAPIM1
            MOVE      APAPPYB,APIMBCH
            MOVE      APAPPYC,APIMDOC
            MOVE      APAPPAYG,APIMPAYG
            MOVE      "2",APIMTYP
            MOVE      "0",APIMUPD
            MOVE      "1",APIMOUT
            MOVE      DATERUN,APIMDDT
            MOVE      DATERUN,APIMPDT
            PACK      APIMTDT,CCC,CYY,CMM,CDD
            REP       " 0",APIMTDT
            MOVE      ZERO,APIMTOT
            MOVE      ZERO,APIMDIS
            MOVE      ZERO,APIMGST
            MOVE      ZERO,APIMPAY
            MOVE      SP70,APIMCM1
            MOVE      SP70,APIMCM2
            MOVE      SP70,APIMICM
            MOVE      SP70,APIMSPA
          ENDIF
.
          PACK      KEY51,APAPBCH,APAPCRD,APAPREF,APAPDOC,APAPORD,APAPLIN,SP70
          UNPACK    KEY51,APINBCH,APINCRD,APINREF,APINDOC,APINORD,APINLIN
          CALL      RDAPIN1
.
          MOVE      APAPPYB,APINBCH
          MOVE      APAPPYC,APINDOC
          MOVE      APAPPAYG,APINPAYG
          MOVE      "0",APINUPD
          MOVE      APBMDIS,APINDIS
          MOVE      APBMRES,APINRES
          PACK      APINDES,APAPBCH,APAPDOC,APAPORD,APAPLIN,APAPTYP,SP70
          MATCH     "1",APAPTYP
          IF        @EQUAL
            MULT      SEQ,APINPAY
            MOVE      ZERO,PAYLINE
            MOVE      APINLIN,PAYLINE
            ADD       "500",PAYLINE
            MOVE      PAYLINE,APINLIN
          ENDIF
.
          ASSIGN    APAPTPY/(APAPGST+APAPPAY),TEMPAMT * get ratio of amount paid
          ASSIGN    TEMPAMT*APAPGST,APINGST           * to determine GST to pay
          ASSIGN    APAPTPY-APINGST,APINAMT
.
BTCH3500  PACK      KEY51,APINBCH,APINCRD,APINREF,APINDOC,APINORD,APINLIN,SP70
          UNPACK    KEY51,APINBCH,APINCRD,APINREF,APINDOC,APINORD,APINLIN
          CALL      RAAPIN1
          IF        OVRCD=0
            MOVE      ZERO,ORDLIN
            MOVE      APINLIN,ORDLIN
            ADD       ONE,ORDLIN
            MOVE      ORDLIN,APINLIN
            GOTO      BTCH3500
          ENDIF
.
          MOVE      SP3,APINBASC
          CALL      WRAPIN1
.
          ADD       APINGST,APIMGST         * add to header record
          ADD       APINAMT,APIMTOT
.
          ADD       APINGST,APBMTOT         * add to batch header record
          ADD       APINAMT,APBMTOT
.
          CALL      OUTPFIL                 * update cheque audit report
          GOTO      BTCH3100
.
BTCH3900  PACK      KEY40,APIMBCH,APIMCRD,APIMREF,APIMDOC,SP70
          MATCH     SP70,LASTDOCT          * write last header record
          IF        !@EQUAL
            MOVE      APIMTOT,SAVTOT
            MOVE      APIMGST,SAVGST
            CALL      RDAPIM1
            IF        OVRCD=1
              CALL      WRAPIM1
              PACK      KEY40,APIMDOC,APIMBCH,APIMCRD,APIMREF
              UNPACK    KEY40,APCLDOC,APCLBCH,APCLCRD,APCLREF
              CALL      WRAPCL1
            ELSE
              ADD       SAVTOT,APIMTOT
              ADD       SAVGST,APIMGST
              CALL      UPAPIM1
            ENDIF
          ENDIF
.
          CALL      WRAPBM1
.
BTCH9999  RETURN
.
.--------------------------------------------------------------------------
. Check if Debit Balance Creditor (Returns OVRCD (1=yes), TMPMOD=balance)
.--------------------------------------------------------------------------
DBALD000
          PACK      SKEY52,APAPCRD,APAPREF,APAPTYP,APAPDOC:
                           APAPORD,APAPLIN,APAPBCH,SP70
.                                           * save key and init totals
          MOVE      ZERO,TMPPAY
          MOVE      ZERO,TMPMOD
          PACK      KEY52,APAPCRD,SP70
          CALL      RSAPAP1
.
DBALD100  CALL      RKAPAP1
          BRANCH    OVRCD,DBALD200
.
          MATCH     APAPCRD,SKEY52
          GOTO      DBALD200 IF NOT EQUAL
.
          DISPLAY   *P1:24,"Checking : ",*V2LON,APAPCRD,APAPREF:
                    APAPTYP,APAPDOC,APAPORD,APAPLIN,APAPBCH,*EL;
.
          MOVE      BATCHNO,APAPPYB         * update batch number
          CALL      UPAPAP1
.
          ADD       APAPPAY,TMPPAY
          ADD       APAPGST,TMPPAY
          ADD       APAPTPY,TMPMOD
          GOTO      DBALD100
.
DBALD200  MOVE      SKEY52,KEY52
          CALL      RDAPAP1                 * restore original record
.
          COMPARE   TMPMOD,ZERO
          GOTO      DBALD950 IF NOT LESS
.
DBALD900  MOVE      ZERO,OVRCD
          GOTO      DBALD999
.
DBALD950  MOVE      ONE,OVRCD
.
DBALD999  RETURN
.-----------------------------------------------------------------------------
.**********************************************************************
. Print Audit Listing
.**********************************************************************
.
AUDIT000  MOVE      SP70,APAPCHQ
          MOVE      SP70,APAPPYB
          MOVE      SP70,APAPPYC
          MOVE      SP70,APAPPYD
          PACK      KEY52,SP70
          CALL      RSAPAP1
          CALL      RKAPAP1
.
          MATCH     SP70,APAPPYB
          IF        !@EQUAL
            MATCH     SP70,APAPDOF
            IF        @EQUAL
              CALL      CHKCA000
              IF        1=OVRCD
                MOVE      "ERROR - Cant Find Payment Audit File - ",DISPMSG
                CALL      MESSAGE1
                MOVE      TWO,EXIT
              ELSE
                CALL      SPRNT000            * print audit listing
              ENDIF
            ELSE
              BEEP
             MOVE  "Cant Print Payment Audit - Transfer File Created - ",DISPMSG
              CALL      MESSAGE1
              MOVE      TWO,EXIT
            ENDIF
          ELSE
            BEEP
            MOVE      "Cant Print Payment Audit - Batch Not Created - ",DISPMSG
            CALL      MESSAGE1
            MOVE      TWO,EXIT
          ENDIF
.
AUDIT999  RETURN
.**********************************************************************
. SPRNT - Print Payment Audit Report                    Called By AUDIT
.**********************************************************************
SPRNT000
          OPEN      IBACODE1,"ibacodef"
...       OPEN      IBAPRNT1,"ibaprntf"                               *D-239574
.
          CLOSE     SCRSBGA1           * close files to stop "S*O 024"
          CLOSE     SCRPSTA1
.
          CALL      OPNPRINT
.
          OPEN      SCRSBGA1,"scrsbgaf" * re-open files
          OPEN      SCRPSTA1,"scrpstaf"
.
          CALL      PRAUD000           * print routine
.
          IF        CPAGENO>0
            CALL      SELPRINT
            CALL      CLSPRINT
          ELSE
            MOVE      "Nothing to Print !! - ",DISPMSG
            CALL      MESSAGE1
            CALL      CLSPRINT
          ENDIF
          CLOSE     IBACODE1
...       CLOSE     IBAPRNT1                                          *D-239574
.
          MOVE      "Do You Want To Re-Print Report (Y/N) ? ",DISPMSG
          CALL      MESSAGE2
          MOVE      "24",CVERT
          MOVE      "41",CCOL
          CALL      YORN0000
          CALL      MESSAGE3
          BRANCH    FYESNO,SPRNT000
.
          MOVE      "Finished Proposed Payments (Y/N) ? ",DISPMSG
          CALL      MESSAGE2
          MOVE      "24",CVERT
          MOVE      "37",CCOL
          CALL      YORN0000
          CALL      MESSAGE3
          COMPARE   ZERO,FYESNO
          GOTO      SPRNT950 IF EQUAL
.
          CALL      DELAP000            * delete payments files
.
          MOVE      ZERO,EXIT
          GOTO      SPRNT999
.
SPRNT950  MOVE      TWO,EXIT
.
SPRNT999  RETURN
.**********************************************************************
. PRAUD - Print Payment Audit Report                    Called By SPRNT
.**********************************************************************
PRAUD000  CLOCK     TIME,CTIMEIS
          MOVE      ZERO,CPAGENO
          MOVE      "999",CLNO
          MOVE      SP70,LASTCCHQ
          MOVE      ZERO,ALLTOTAL
          MOVE      ZERO,CHQTOTAL
          MOVE      ZERO,DDBTOTAL
          PACK      KEY37,SP70
          PACK      LASTUINV,SP70
.
          PACK      KEY52,SP70
          CALL      RSAPAP1
          CALL      RKAPAP1
.
          MOVE      APAPPOR,TEMPPOR
          PACK      KEY15,APAPCHQ,SP70
          CALL      RDFMCH1
.
.---- print cheque audit report ----
.     and create new bank file
.
          PREP      APSBNKAF,"apsbnkaf"
          PERFORM   TEMPPOR,RSAPCA1,RSAPCA3
.
PRAUD100  PERFORM   TEMPPOR,RKAPCA1,RKAPCA3
          BRANCH    OVRCD,PRAUD500
.
          COMPARE   "55",CLNO
          CALL      HEAA0000 IF NOT LESS
.
          PACK      KEY20,APCACHQ,APCACRD
          MATCH     KEY20,LASTCCHQ
          IF        !@EQUAL
            CALL      CAUD0000           * calc total
            MOVE      SP70,APMACN1
            MOVE      SP70,APMACN2
            PACK      KEY5,APCACRD,SP70
            CALL      RDAPMA1
            MOVE      APMACN1,KEY25
            MATCH     "DD",APCACHQ
            IF        @EQUAL
              IF        FMCHDFRM=3
                PRINT     *N,APCACHQ,*17,APCACRD,SP1,KEY25,SP1,APMABSB:
                          APMABAC,*65,F12P2;
              ELSE
                PRINT     *N,APCACHQ,*17,APCACRD,SP1,KEY25,SP1,APMABSB:
                          SP1,APMABAC,*65,F12P2;
              ENDIF
            ELSE
              PRINT     *N,APCACHQ,*17,APCACRD,SP1,APMACN1,*65,F12P2;
            ENDIF
            PACK      LASTCCHQ,APCACHQ,APCACRD
            ADD       F12P2,ALLTOTAL
            UNPACK    APCACHQ,DIM7,DIM8
            MATCH     SP7,DIM7
            IF        @EQUAL
              ADD       F12P2,CHQTOTAL
            ELSE
              ADD       F12P2,DDBTOTAL
            ENDIF
            ADD       ONE,CLNO
            CALL      WRTBN000
          ENDIF
.
          PACK      KEY35,APCACHQ,APCACRD,APCAINV,SP70
          MATCH     KEY35,LASTUINV
          IF        !@EQUAL
            PRINT     *81,APCAINV,*97,APCADES
            ADD       ONE,CLNO
            MOVE      KEY35,LASTUINV
          ENDIF
          GOTO      PRAUD100
.
PRAUD500  WEOF      APSBNKAF,SEQ
          CLOSE     APSBNKAF
.
          COMPARE   ZERO,CPAGENO
          CALL      ENDA0000 IF NOT EQUAL
.
.---- Print Payments Posting Summary ----
.
          CLOCK     TIME,CTIMEIS
          MOVE      ZERO,CPAGENO
          MOVE      "999",CLNO
          MOVE      SP70,LASTLEDG
          MOVE      ZERO,ALLTOTAL
          PACK      KEY37,SP70
          CALL      RSAPCA2
.
PRAUD600  CALL      RKAPCA2
          BRANCH    OVRCD,PRAUD900
.
          COMPARE   "55",CLNO
          CALL      HEAB0000 IF NOT LESS
.
          MATCH     APCALED,LASTLEDG
          IF        !@EQUAL
            MATCH     SP70,LASTLEDG
            IF        !@EQUAL
              MOVE      SP70,FMLADESC
              PACK      KEY2,LASTLEDG,SP70
              CALL      RDFMLA1
              PRINT     LASTLEDG,SP1,FMLADESC,*65,LEDTOTAL
              ADD       LEDTOTAL,ALLTOTAL
              ADD       ONE,CLNO
            ENDIF
            MOVE      ZERO,LEDTOTAL
            MOVE      APCALED,LASTLEDG
          ENDIF
.
          ADD       APCAAMT,LEDTOTAL
          GOTO      PRAUD600
.
PRAUD900  MATCH     SP70,LASTLEDG
          IF        !@EQUAL
            MOVE      SP70,FMLADESC
            PACK      KEY2,LASTLEDG,SP70
            CALL      RDFMLA1
            PRINT     LASTLEDG,SP1,FMLADESC,*65,LEDTOTAL
            ADD       LEDTOTAL,ALLTOTAL
            ADD       ONE,CLNO
          ENDIF
.
          COMPARE   ZERO,CPAGENO
          CALL      ENDB0000 IF NOT EQUAL
.
PRAUD999  RETURN
.**********************************************************************
. Write to bank transfer file
.**********************************************************************
WRTBN000  MOVE      "127",FORM3
          SFORMAT   GMKEY127,FORM3
          MOVE      F12P2,DIM15
          UNPACK    DIM15,DIM3,APBNAMOT
          SQUEEZE   APBNAMOT
          UNPACK    APMABAC,DIM6,DIM1,DIM2
          MATCH     "-",DIM1
          IF        @EQUAL
            PACK      DIM3,Z0,DIM2
            PACK      DIM9,DIM6,DIM3
            UNPACK    APMABSB,DIM2,DIM1,DIM4
            PACK      APBNACCT,DIM2,DIM4,Z00,DIM9
          ELSE
            UNPACK    APMABAC,DIM7,DIM2
            PACK      DIM3,Z0,DIM2
            PACK      DIM10,DIM7,DIM3
            UNPACK    APMABSB,DIM2,DIM1,DIM4
            PACK      APBNACCT,DIM2,DIM4,Z0,DIM10
          ENDIF
          MOVE      APMAPNM,APBNPNAM
          STRIP     APBNPNAM
          MOVE      APMAUR1,APBNCHEQ
          SQUEEZE   APBNCHEQ
          PACK      GMKEY127,APBNAMOT,COMMA,APBNACCT,COMMA,APBNPNAM,COMMA:
                             COMMA,COMMA,COMMA,APBNCHEQ,COMMA,COMMA,COMMA
          MOVELPTR  GMKEY127,FORM3
          SFORMAT   GMKEY127,FORM3
          PACK      GMKEY127,APBNAMOT,COMMA,APBNACCT,COMMA,APBNPNAM,COMMA:
                             COMMA,COMMA,COMMA,APBNCHEQ,COMMA,COMMA,COMMA
          WRITE     APSBNKAF,SEQ;GMKEY127,DOSCRLF;
          RETURN
.
.**********************************************************************
. Calc total
.**********************************************************************
CAUD0000
          MOVE      ZERO,F12P2
          PACK      KEY37,APCACHQ,APCACRD,APCAINV,APCALED,SP70
          PACK      KEY38,APCACHQ,APCACRD,APCAINV,APCALED,SP70
          PACK      KEY20,APCACHQ,APCACRD,SP70
          CALL      RSAPCA1
          CALL      RPAPCA1
.
CAUD0100
          CALL      RKAPCA1
          BRANCH    OVRCD,CAUD9000
          PACK      KEY37,APCACHQ,APCACRD,APCAINV,APCALED,SP70
          MATCH     KEY20,KEY37
          GOTO      CAUD9000 IF NOT EQUAL
.
          ADD       APCAAMT,F12P2
          GOTO      CAUD0100
.
CAUD9000  MOVE      KEY38,KEY37
          CALL      RDAPCA1
.
CAUD9999  RETURN
.**********************************************************************
.  HEAA - Print Heading                                Called By PRAUD
.**********************************************************************
HEAA0000  CALL      HEAD132
.
          PRINT     "Payment Audit Report"
          CALL      UND132
          PRINT     *1,"Cheque/Ref.",*17,"Creditor",*65,"         Amount":
                    *81,"Invoice Number",*97,"Transaction Description"
          CALL      UND132
          ADD       "2",CLNO
.
HEAA9999  RETURN
.**********************************************************************
.  HEAB - Print Heading                                Called By PRAUD
.**********************************************************************
HEAB0000  CALL      HEAD80
.
          PRINT     "Payments Posting Summary"
          CALL      UND80
          PRINT     *1,"Ledger",*65,"         Amount"
          CALL      UND80
          ADD       "2",CLNO
.
HEAB9999  RETURN
.**********************************************************************
.  ENDA - Print End                                    Called By PRAUD
.**********************************************************************
ENDA0000  CALL      UND132
          PRINT     *10,"Cheque Total",*50,CHQTOTAL
          PRINT     *10,"Direct Debit Total",*50,DDBTOTAL
          PRINT     *10,"Grand Total",*50,ALLTOTAL
          CALL      UND132
          ADD       "3",CLNO
.
ENDA9999  RETURN
.**********************************************************************
.  ENDB - Print End                                    Called By PRAUD
.**********************************************************************
ENDB0000  CALL      UND80
          PRINT     *10,"Total",*65,ALLTOTAL
          CALL      UND80
          ADD       "1",CLNO
.
ENDB9999  RETURN
.------------------------------------------------------------
. Initialization for Cheque Printing
.------------------------------------------------------------
INTCH000  CALL      RDFMCO50
.
          CALL      SETMAX00            * Set Up Max Lines for Cheque Layout
.
          CLOSE     SCRSBGA1            * Close files to stop "S*O 024"
          CLOSE     SCRPSTA1
.
          CALL      OPNPRINT
.
          OPEN      SCRSBGA1,"scrsbgaf" * Re-open files
          OPEN      SCRPSTA1,"scrpstaf"
.
          MOVE      ZERO,XTOTINVC
          MOVE      ZERO,XTOTCRD
          MOVE      ZERO,XACCUM
          MOVE      ZERO,TOTINVC
          MOVE      ZERO,TOTCRD
          MOVE      ZERO,DOLLARS
          MOVE      SP70,LASTCRE
          MOVE      SP70,LASTDOCT
          MOVE      SP70,LASTORD
.
          RETURN
.------------------------------------------------------------
. Set Up Max Lines for Cheq Layout
.------------------------------------------------------------
SETMAX00  MOVE      "24",MAXLINES
          IF        FMCOAPCH=1
            MOVE      "27",MAXLINES
          ENDIF
          IF        FMCOAPCH=2
            MOVE      "24",MAXLINES
          ENDIF
          IF        FMCOAPCH=3
            MOVE      "39",MAXLINES
          ENDIF
          IF        FMCOAPCH=4
            MOVE      "29",MAXLINES
          ENDIF
          IF        FMCOAPCH=5
            MOVE      "20",MAXLINES
          ENDIF
          IF        FMCOAPCH=6
            MOVE      "24",MAXLINES
          ENDIF
          IF        FMCOAPCH=7
            MOVE      "12",MAXLINES
          ENDIF
          IF        FMCOAPCH=8
            MOVE      "27",MAXLINES
          ENDIF
          IF        FMCOAPCH=9
            MOVE      "13",MAXLINES
          ENDIF
          IF        FMCOAPCH=10
            MOVE      "27",MAXLINES
          ENDIF
          IF        FMCOAPCH=11
            MOVE      "24",MAXLINES
          ENDIF
          IF        FMCOAPCH=12
            MOVE      "24",MAXLINES
          ENDIF
          IF        FMCOAPCH=13
            MOVE      "23",MAXLINES
          ENDIF
          IF        FMCOAPCH=14
            MOVE      "24",MAXLINES
          ENDIF
          IF        FMCOAPCH=15
            MOVE      "24",MAXLINES
          ENDIF
          IF        FMCOAPCH=16
            MOVE      "28",MAXLINES
          ENDIF
          IF        FMCOAPCH=17
            MOVE      "37",MAXLINES
          ENDIF
          IF        FMCOAPCH=18
            MOVE      "27",MAXLINES
          ENDIF
          IF        FMCOAPCH=19
            MOVE      "28",MAXLINES
          ENDIF
          IF        FMCOAPCH=20
            MOVE      "27",MAXLINES
          ENDIF
          IF        FMCOAPCH=21
            MOVE      "24",MAXLINES
          ENDIF
          IF        FMCOAPCH=22
            MOVE      "24",MAXLINES
          ENDIF
          IF        FMCOAPCH=23
            MOVE      "28",MAXLINES
          ENDIF
.
          RETURN
.
