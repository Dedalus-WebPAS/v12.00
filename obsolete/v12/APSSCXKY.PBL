EAPSCA00  
          MATCH     SP70,APSCTYP
          IF        @EQUAL
            MOVE      SP70,FMSADESC
            PACK      KEY14,APSCLED,APSCSUB,SP70
            CALL      RDFMSA1
            MOVE      FMSADESC,KEY35
            MOVE      "Subj",KEY4
          ELSE
            MOVE      SP70,FMAMDESC
            PACK      KEY14,APSCLED,APSCSUB,SP70
            CALL      RDFMAM1
            MOVE      FMAMDESC,KEY35
            MOVE      "Acct",KEY4
          ENDIF
          RETURN
.
.---------------------------------------------------------------------------
.   System    :   Accounts Payable System            
.   Include   :   APSSCXKY
.   Routine   :   KAPSCA00 Keyin Charge Code         
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KAPSCA00 TOPIC     "APSCCOD "
          MOVE      UNDLN70,APSCCOD 
          KEYIN     *PCCOL:CVERT,*DV,APSCCOD:                                   
                    *PCCOL:CVERT,*V2LON,APSCCOD:                                
                    *PCCOL:CVERT,*DV,APSCCOD 
.
          ENDSET    APSCCOD 
          APPEND    SP70,APSCCOD 
          RESET     APSCCOD 
.
          MATCH     SP70,APSCCOD 
          GOTO      KAPSCA90 IF EQUAL
.
          CMATCH    EXITCHAR,APSCCOD 
          GOTO      KAPSCA95 IF EQUAL
.
          CMATCH    QUEST,APSCCOD 
          GOTO      KAPSCA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HAPSCA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    APSCCOD 
          APPEND    SP70,APSCCOD 
          RESET     APSCCOD 
.
          MATCH     SP70,APSCCOD 
          GOTO      KAPSCA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,APSCCOD                                 
KAPSCA10
          PACK      KEY26,APSCCOD,SP70
          CALL      RSAPSC1 
          CALL      RKAPSC1 
          BRANCH    OVRCD,KAPSCA80
          MATCH     KEY26,APSCCOD
          GOTO      KAPSCA80 IF NOT EQUAL
          BRANCH    CKEYTYP,KAPSCA75
KAPSCA70
          MOVE      ZERO,EXIT
          GOTO      KAPSCA99
KAPSCA75
          MOVE      "Charge Code Already Exists - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KAPSCA00
KAPSCA80
          UNPACK    KEY26,APSCCOD
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KAPSCA99,KAPSCA99
          MOVE      "Charge Code Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KAPSCA00
KAPSCA90
          MOVE      ONE,EXIT
          GOTO      KAPSCA99
KAPSCA95
          MOVE      TWO,EXIT
KAPSCA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   Accounts Payable System            
.   Include   :   APSSCXKY
.   Routine   :   HAPSCA00 Keyin Charge Code   
.   Return    :           
.-------------------------------------------------------------------------------
HAPSCA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "20",HLEF
            MOVE      "80",HRIG
          ENDIF
HAPSCA04
          CALL      GSCRN000
          BRANCH    EXIT,HAPSCA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Charge Code"        
.
          MOVE      STDCOL01,STDCOL02
          ADD       "14",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Type"               
.
          MOVE      STDCOL02,STDCOL03
          ADD       " 6",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Subjective/Account" 
.
          MOVE      STDCOL03,STDCOL04
          ADD       " 2",STDCOL04
          MOVE      STDCOL04,STDCOL05
          ADD       " 1",STDCOL05
          MOVE      STDCOL05,STDCOL06
          ADD       "14",STDCOL06
          MOVE      STDCOL06,STDCOL07
          ADD       "35",STDCOL07
HAPSCA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,APSCCOD 
          PACK      KEY26,APSCCOD,APSCLED,APSCSUB,SP70                          
.                                                                               
.                                                                               
          CALL      RSAPSC1 
HAPSCA10
          CALL      RKAPSC1 
          BRANCH    OVRCD,HAPSCA15
          PACK      KEY26,APSCCOD,APSCLED,APSCSUB,SP70                          
.                                                                               
.                                                                               
          BRANCH    CSEARCH,HAPSCA12
          CALL      HAPSCA60
          BRANCH    OVRCD,HAPSCA10
HAPSCA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY26,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,APSCCOD 
          CALL      EAPSCA00
          DISPLAY   *PSTDCOL02:STDROW,KEY4    
          DISPLAY   *PSTDCOL03:STDROW,APSCLED 
          DISPLAY   *PSTDCOL04:STDROW,SLASH   
          DISPLAY   *PSTDCOL05:STDROW,APSCSUB 
          DISPLAY   *PSTDCOL06:STDROW,KEY35   
          COMPARE   MAXITEM,XITEMNO
          GOTO      HAPSCA10 IF NOT EQUAL
HAPSCA15
.                                                                               
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HAPSCA20
          CALL      HSCRI000
          BRANCH    EXIT,HAPSCA30,HAPSCA35,HAPSCA40,HAPSCA45,HAPSCA04:
                              HAPSCA91,HAPSCA50
          GOTO      HAPSCA92
HAPSCA30
          CALL      RKAPSC1 
          BRANCH    OVRCD,HAPSCA85
          PACK      KEY26,APSCCOD,APSCLED,APSCSUB,SP70                          
.                                                                               
.                                                                               
          CALL      RPAPSC1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAPSCA10
HAPSCA35
          MOVE      ST1,KEY26
          CALL      RDAPSC1 
          CALL      RPAPSC1 
          BRANCH    OVRCD,HAPSCA85
          PACK      KEY26,APSCCOD,APSCLED,APSCSUB,SP70                          
.                                                                               
.                                                                               
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HAPSCA36
          CALL      RPAPSC1 
          BRANCH    OVRCD,HAPSCA37
          PACK      KEY26,APSCCOD,APSCLED,APSCSUB,SP70                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HAPSCA36 IF NOT EQUAL
HAPSCA37
          MOVE      ZERO,XITEMNO
          GOTO      HAPSCA10
HAPSCA40
          MOVE      ST1,KEY26
          CALL      RDAPSC1 
          CALL      RPAPSC1 
          BRANCH    OVRCD,HAPSCA85
          PACK      KEY26,APSCCOD,APSCLED,APSCSUB,SP70                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAPSCA08
HAPSCA45
          CALL      RKAPSC1 
          BRANCH    OVRCD,HAPSCA85
          PACK      KEY26,APSCCOD,APSCLED,APSCSUB,SP70                          
.                                                                               
.                                                                               
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY26,Z70                                                   
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSAPSC1 
HAPSCA46
          CALL      RPAPSC1 
          BRANCH    OVRCD,HAPSCA47
          PACK      KEY26,APSCCOD,APSCLED,APSCSUB,SP70                          
.                                                                               
.                                                                               
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HAPSCA46 IF NOT EQUAL
HAPSCA47
          MOVE      ZERO,XITEMNO
          GOTO      HAPSCA10
HAPSCA50  COMPARE   ZERO,CSEARCH
          GOTO      HAPSCA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          KEYIN     *PSTDCOL04:STDROW,*V2LON,SCHFLD04
          RESET     SCHFLD04
          KEYIN     *PSTDCOL05:STDROW,*V2LON,SCHFLD05
          RESET     SCHFLD05
          KEYIN     *PSTDCOL06:STDROW,*V2LON,SCHFLD06
          RESET     SCHFLD06
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAPSCA08
HAPSCA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAPSCA08
HAPSCA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HAPSCA61 IF EQUAL
          MATCH     SCHFLD01,APSCCOD 
          GOTO      HAPSCA72 IF NOT EQUAL
HAPSCA61
          CALL      EAPSCA00
          MATCH     SP70,SCHFLD02
          GOTO      HAPSCA62 IF EQUAL
          MATCH     SCHFLD02,KEY4    
          GOTO      HAPSCA72 IF NOT EQUAL
HAPSCA62
          MATCH     SP70,SCHFLD03
          GOTO      HAPSCA63 IF EQUAL
          MATCH     SCHFLD03,APSCLED 
          GOTO      HAPSCA72 IF NOT EQUAL
HAPSCA63
          MATCH     SP70,SCHFLD04
          GOTO      HAPSCA64 IF EQUAL
          MATCH     SCHFLD04,SLASH   
          GOTO      HAPSCA72 IF NOT EQUAL
HAPSCA64
          MATCH     SP70,SCHFLD05
          GOTO      HAPSCA65 IF EQUAL
          MATCH     SCHFLD05,APSCSUB 
          GOTO      HAPSCA72 IF NOT EQUAL
HAPSCA65
          MATCH     SP70,SCHFLD06
          GOTO      HAPSCA66 IF EQUAL
          MATCH     SCHFLD06,KEY35   
          GOTO      HAPSCA72 IF NOT EQUAL
HAPSCA66
HAPSCA67
HAPSCA68
HAPSCA69
HAPSCA70
          GOTO      HAPSCA75
HAPSCA72  MOVE      ONE,OVRCD
HAPSCA75  RETURN
HAPSCA85
          LOAD      KEY26,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY26,APSCCOD,APSCLED,APSCSUB                               
          CALL      RDAPSC1 
HAPSCA90
.                                                                               
          BEEP
          GOTO      HAPSCA20
HAPSCA91
          MOVE      SP70,APSCTYP 
          MOVE      SP70,APSCSPA 
          MOVE      SP70,KEY26
          MOVE      SP70,APSCCOD 
          GOTO      HAPSCA96
HAPSCA92
          MOVE      SP70,KEY26
          MOVE      SP70,APSCCOD 
          LOAD      KEY26,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY26,APSCCOD,APSCLED,APSCSUB                               
HAPSCA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HAPSCA99
          RETURN
