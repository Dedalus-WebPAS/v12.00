.-------------------------------------------------------------------------------
.   System    :   FMS Accounting System  
.                           
.   Program   :   FMSLMAFM 
.                            
.   Routines  :   KLMAAP00 Keyin Ledger No.   - Returns a valid record
.                 ALMAAP00 Accept Ledger No.  - Returns a key NOT on file
.   
.   Return    :   EXIT = 1 null entry EXIT = 2 EXITCHAR entered
.
.   Redisplay :   RLMAAP00 Screen Redisplay Called for Ledger No.  
.-------------------------------------------------------------------------------
.   Mods      :   18.09.90 B.G.Ackland (I.B.A.)
.                          Make Ledger *JR *ZF
.-------------------------------------------------------------------------------
. Normal Code Keyin - Code Must Exist Exit = 1 if Null Entry
.-------------------------------------------------------------------------------
KLMAAP00  MOVE      UNDLN70,FMLALEDG
          KEYIN     *PCCOL:CVERT,*EL,*DV,FMLALEDG:
                    *PCCOL:CVERT,*V2LON,*JR,*ZF,FMLALEDG: 
                    *PCCOL:CVERT,*EL,*DV,FMLALEDG
.
          ENDSET    FMLALEDG
          APPEND    SP70,FMLALEDG
          RESET     FMLALEDG
          REP       " 0",FMLALEDG
          MATCH     "00",FMLALEDG             * System Code Spaces so exit set
          GOTO      KLMAAP90 IF EQUAL
.
          UNPACK    FMLALEDG,D1,ANS
.
          CMATCH    EXITCHAR,ANS              * Exit Selected
          GOTO      KLMAAP95 IF EQUAL
.
          PACK      KEY2,FMLALEDG
          CALL      RDFMLA1                                   
          BRANCH    OVRCD,KLMAAP80
          MOVE      ZERO,EXIT                 * no entry so exit is set
          GOTO      KLMAAP99
.
KLMAAP80  DISPLAY   *P1:24,*EL,*B,"Ledger No. Does Not Exist - ";
          CALL      HITENTER
          GOTO      KLMAAP00
.
KLMAAP90  MOVE      ONE,EXIT                  * null entry so exit is set
          GOTO      KLMAAP99
.
KLMAAP95  MOVE      TWO,EXIT                  * Exit character entered    
.
KLMAAP99  RETURN
.-------------------------------------------------------------------------------
. Accept Code Keyin - Code Must Not Exist 
.-------------------------------------------------------------------------------
ALMAAP00  MOVE      UNDLN70,FMLALEDG
          KEYIN     *PCCOL:CVERT,*EL,*DV,FMLALEDG:
                    *PCCOL:CVERT,*V2LON,*JR,*ZF,FMLALEDG: 
                    *PCCOL:CVERT,*EL,*DV,FMLALEDG
.
          ENDSET    FMLALEDG
          APPEND    SP70,FMLALEDG
          RESET     FMLALEDG
          REP       " 0",FMLALEDG
          MATCH     "00",FMLALEDG             * System Code Spaces so exit set
          GOTO      ALMAAP90 IF EQUAL
.
          UNPACK    FMLALEDG,D1,ANS
.
          CMATCH    EXITCHAR,ANS              * Exit Selected
          GOTO      ALMAAP95 IF EQUAL
.
          TYPE      FMLALEDG
          GOTO      ALMAAP15 IF EQUAL
          DISPLAY   *P1:24,*EL,*B,"Ledger Must Be Numeric - ";
          CALL      HITENTER
          GOTO      ALMAAP00
.
ALMAAP15  PACK      KEY2,FMLALEDG
          MOVE      ZERO,EXIT                 * no entry so exit is set
          CALL      RDFMLA1                                   
          BRANCH    OVRCD,ALMAAP99
.
          DISPLAY   *P1:24,*EL,*B,"Ledger No. Already Exists - ";
          CALL      HITENTER
          GOTO      ALMAAP00
.
ALMAAP90  MOVE      ONE,EXIT                  * null entry so exit is set
          GOTO      ALMAAP99
.
ALMAAP95  MOVE      TWO,EXIT                  * Exit character entered    
.
ALMAAP99  RETURN
.-------------------------------------------------------------------------------
.   System    :   FMS Accounting System  
.                           
.   Program   :   FMSAMAFM 
.                            
.   Routines  :   KAMAAP00 Keyin Account   - Returns a valid record
.                 AAMAAP00 Accept Account  - Returns a key NOT on file
.   
.   Requires  :   FMLALEDG Ledger Number
.                 FMLADESC Ledger Number Description
.                 CACCTIND 0=all acc, 1=posting, 2=total/head, 3=stat, 4=total
.                          5=post/total
.
.   Return    :   EXIT = 1 null entry EXIT = 2 EXITCHAR entered
.
.   Internal  :   HAMAFM00 Help Display for Account  
.                            
.   Redisplay :   RAMAFM00 Screen Redisplay Called for Account  
.-------------------------------------------------------------------------------
.   Mods      :   15/10/1990  Neeriem Dye added indicator 
.                 CACCTIND 0=all acc, 1=posting, 2=total/head, 3=stat, 4=total
.                          5=post/total
.-------------------------------------------------------------------------------
. Normal Code Keyin - Code Must Exist Exit = 1 if Null Entry
.-------------------------------------------------------------------------------
KAMAAP00  MOVE      UNDLN70,FMAMACCT
          KEYIN     *PCCOL:CVERT,*EL,*DV,FMAMACCT:
                    *PCCOL:CVERT,*V2LON,FMAMACCT: 
                    *PCCOL:CVERT,*EL,*DV,FMAMACCT
.
          ENDSET    FMAMACCT
          APPEND    SP70,FMAMACCT
          RESET     FMAMACCT
          MATCH     SP70,FMAMACCT             * System Code Spaces so exit set
          GOTO      KAMAAP90 IF EQUAL
.
          CMATCH    EXITCHAR,FMAMACCT         * Exit Selected
          GOTO      KAMAAP95 IF EQUAL
.
          PACK      KEY14,FMLALEDG,FMAMACCT
          CALL      RDFMAM1                                   
          BRANCH    OVRCD,KAMAAP80            * record exists ?
          CALL      CKIND000                  * check if record has correct ind.
          BRANCH    OVRCD,KAMAAP85
          MOVE      ZERO,EXIT                 * valid entry
          GOTO      KAMAAP99
.
KAMAAP80  DISPLAY   *P1:24,*EL,*B,"Account Does Not Exist - ";
          CALL      HITENTER
          GOTO      KAMAAP00
.
KAMAAP85  DISPLAY   *P1:24,*EL,*B,"Not A Valid Account - ";
          CALL      HITENTER
          GOTO      KAMAAP00
.
KAMAAP90  MOVE      ONE,EXIT                  * null entry so exit is set
          GOTO      KAMAAP99
.
KAMAAP95  MOVE      TWO,EXIT                  * Exit character entered    
.
KAMAAP99  RETURN
.-------------------------------------------------------------------------------
. Accept Code Keyin - Code Must Not Exist 
.-------------------------------------------------------------------------------
AAMAAP00  MOVE      UNDLN70,FMAMACCT
          KEYIN     *PCCOL:CVERT,*EL,*DV,FMAMACCT:
                    *PCCOL:CVERT,*V2LON,FMAMACCT: 
                    *PCCOL:CVERT,*EL,*DV,FMAMACCT
.
          ENDSET    FMAMACCT
          APPEND    SP70,FMAMACCT
          RESET     FMAMACCT
          MATCH     SP70,FMAMACCT             * System Code Spaces so exit set
          GOTO      AAMAAP90 IF EQUAL
.
          CMATCH    EXITCHAR,FMAMACCT         * Exit Selected
          GOTO      AAMAAP95 IF EQUAL
.
          PACK      KEY14,FMLALEDG,FMAMACCT
          MOVE      ZERO,EXIT                 * no entry so exit is set
          CALL      RDFMAM1                                   
          BRANCH    OVRCD,AAMAAP99
.
          DISPLAY   *P1:24,*EL,*B,"Account Already Exists - ";
          CALL      HITENTER
          GOTO      AAMAAP00
.
AAMAAP90  MOVE      ONE,EXIT                  * null entry so exit is set
          GOTO      AAMAAP99
.
AAMAAP95  MOVE      TWO,EXIT                  * Exit character entered    
.
AAMAAP99  RETURN
.**********************************************************************
. CKIND - Check if correct account indicator           Called By ML
.        Requires - CACCTIND (0=all, 1=posting, 2=total/head, 3=stat, 4=total,
.                             5=post/total)
.                   FMAMTYPE (account type of record to be tested)
.        Returns  - OVRCD    (1=invalid record)
.**********************************************************************
CKIND000  BRANCH    CACCTIND,CKIND100,CKIND200,CKIND300,CKIND400,CKIND500
          GOTO      CKIND9000                    * all
.
CKIND100  MATCH     "6",FMAMTYPE
          GOTO      CKIND900 IF LESS             * posting type
          GOTO      CKIND950
.
CKIND200  MATCH     "6",FMAMTYPE
          GOTO      CKIND950 IF LESS             * head/total type
          MATCH     "8",FMAMTYPE
          GOTO      CKIND900 IF LESS
          GOTO      CKIND950
.
CKIND300  MATCH     "9",FMAMTYPE
          GOTO      CKIND900 IF EQUAL            * stat tot type
          MATCH     "8",FMAMTYPE
          GOTO      CKIND900 IF EQUAL
          GOTO      CKIND950
.
CKIND400  MATCH     "6",FMAMTYPE
          GOTO      CKIND900 IF EQUAL            * total type
          GOTO      CKIND950
.
CKIND500  MATCH     "7",FMAMTYPE
          GOTO      CKIND900 IF LESS             * post/total type
          GOTO      CKIND950
.
.
CKIND900  MOVE      ZERO,OVRCD                   * valid record
          GOTO      CKIND999
.
CKIND950  MOVE      ONE,OVRCD                    * invalid record
.
CKIND999  RETURN
.-------------------------------------------------------------------------------
.   System    :   FMS Accounting System  
.                           
.   Program   :   FMSDISFM 
.                            
.   Routines  :   KDISAP00 Keyin Dissection   - Returns a valid record
.                 ADISAP00 Accept Dissection  - Returns a key NOT on file
.   
.   Return    :   EXIT = 1 null entry EXIT = 2 EXITCHAR entered
.
.-------------------------------------------------------------------------------
.   Mods      :    
.-------------------------------------------------------------------------------
. Normal Code Keyin - Code Must Exist Exit = 1 if Null Entry
.-------------------------------------------------------------------------------
KDISAP00  MOVE      UNDLN70,FMDSCODE
          KEYIN     *PCCOL:CVERT,*EL,*DV,FMDSCODE:
                    *PCCOL:CVERT,*V2LON,*JR,FMDSCODE: 
                    *PCCOL:CVERT,*EL,*DV,FMDSCODE
.
          ENDSET    FMDSCODE
          APPEND    SP70,FMDSCODE
          RESET     FMDSCODE
          MATCH     SP70,FMDSCODE             * System Code Spaces so exit set
          GOTO      KDISAP90 IF EQUAL
.
          MATCH     "    \",FMDSCODE         * Exit Selected
          GOTO      KDISAP95 IF EQUAL
.
          TYPE      FMDSCODE
          GOTO      KDISAP00 IF NOT EQUAL
          PACK      KEY5,FMDSCODE
          CALL      RDFMDS1                                   
          BRANCH    OVRCD,KDISAP80
          MOVE      ZERO,EXIT                 * no entry so exit is set
          GOTO      KDISAP99
.
KDISAP80  DISPLAY   *P1:24,*EL,*B,"Dissection Does Not Exist - ";
          CALL      HITENTER
          GOTO      KDISAP00
.
KDISAP90  MOVE      ONE,EXIT                  * null entry so exit is set
          GOTO      KDISAP99
.
KDISAP95  MOVE      TWO,EXIT                  * Exit character entered    
.
KDISAP99  RETURN
.-------------------------------------------------------------------------------
. Accept Code Keyin - Code Must Not Exist 
.-------------------------------------------------------------------------------
ADISAP00  MOVE      UNDLN70,FMDSCODE
          KEYIN     *PCCOL:CVERT,*EL,*DV,FMDSCODE:
                    *PCCOL:CVERT,*V2LON,*JR,*DE,FMDSCODE: 
                    *PCCOL:CVERT,*EL,*DV,FMDSCODE
.
          ENDSET    FMDSCODE
          APPEND    SP70,FMDSCODE
          RESET     FMDSCODE
          MATCH     SP70,FMDSCODE             * System Code Spaces so exit set
          GOTO      ADISAP90 IF EQUAL
.
          CMATCH    EXITCHAR,FMDSCODE         * Exit Selected
          GOTO      ADISAP95 IF EQUAL
.
          PACK      KEY5,FMDSCODE
          MOVE      ZERO,EXIT                 * no entry so exit is set
          CALL      RDFMDS1                                   
          BRANCH    OVRCD,ADISAP99
.
          DISPLAY   *P1:24,*EL,*B,"Dissection Already Exists - ";
          CALL      HITENTER
          GOTO      ADISAP00
.
ADISAP90  MOVE      ONE,EXIT                  * null entry so exit is set
          GOTO      ADISAP99
.
ADISAP95  MOVE      TWO,EXIT                  * Exit character entered    
.
ADISAP99  RETURN
.-------------------------------------------------------------------------------
.   System    :   FMS Accounting System  
.                           
.   Program   :   FMSRESFM 
.                            
.   Routines  :   KRESAP00 Keyin Resp. Code   - Returns a valid record
.                 ARESAP00 Accept Resp. Code  - Returns a key NOT on file
.   
.   Return    :   EXIT = 1 null entry EXIT = 2 EXITCHAR entered
.-------------------------------------------------------------------------------
.   Mods      :    
.-------------------------------------------------------------------------------
. Normal Code Keyin - Code Must Exist Exit = 1 if Null Entry
.-------------------------------------------------------------------------------
KRESAP00  MOVE      UNDLN70,FMRSCODE
          KEYIN     *PCCOL:CVERT,*EL,*DV,FMRSCODE:
                    *PCCOL:CVERT,*V2LON,FMRSCODE: 
                    *PCCOL:CVERT,*EL,*DV,FMRSCODE
.
          ENDSET    FMRSCODE
          APPEND    SP70,FMRSCODE
          RESET     FMRSCODE
          MATCH     SP70,FMRSCODE             * System Code Spaces so exit set
          GOTO      KRESAP90 IF EQUAL
.
          CMATCH    EXITCHAR,FMRSCODE         * Exit Selected
          GOTO      KRESAP95 IF EQUAL
.
          PACK      KEY4,FMRSCODE
          CALL      RDFMRS1                                   
          BRANCH    OVRCD,KRESAP80
          MOVE      ZERO,EXIT                 * no entry so exit is set
          GOTO      KRESAP99
.
KRESAP80  DISPLAY   *P1:24,*EL,*B,"Resp. Code Does Not Exist - ";
          CALL      HITENTER
          GOTO      KRESAP00
.
KRESAP90  MOVE      ONE,EXIT                  * null entry so exit is set
          GOTO      KRESAP99
.
KRESAP95  MOVE      TWO,EXIT                  * Exit character entered    
.
KRESAP99  RETURN
.-------------------------------------------------------------------------------
. Accept Code Keyin - Code Must Not Exist 
.-------------------------------------------------------------------------------
ARESAP00  MOVE      UNDLN70,FMRSCODE
          KEYIN     *PCCOL:CVERT,*EL,*DV,FMRSCODE:
                    *PCCOL:CVERT,*V2LON,FMRSCODE: 
                    *PCCOL:CVERT,*EL,*DV,FMRSCODE
.
          ENDSET    FMRSCODE
          APPEND    SP70,FMRSCODE
          RESET     FMRSCODE
          MATCH     SP70,FMRSCODE             * System Code Spaces so exit set
          GOTO      ARESAP90 IF EQUAL
.
          CMATCH    EXITCHAR,FMRSCODE         * Exit Selected
          GOTO      ARESAP95 IF EQUAL
.
          PACK      KEY4,FMRSCODE
          MOVE      ZERO,EXIT                 * no entry so exit is set
          CALL      RDFMRS1                                   
          BRANCH    OVRCD,ARESAP99
.
          DISPLAY   *P1:24,*EL,*B,"Resp. Code Already Exists - ";
          CALL      HITENTER
          GOTO      ARESAP00
.
ARESAP90  MOVE      ONE,EXIT                  * null entry so exit is set
          GOTO      ARESAP99
.
ARESAP95  MOVE      TWO,EXIT                  * Exit character entered    
.
ARESAP99  RETURN
.-------------------------------------------------------------------------------
.   System    :   FMS Financial System  
.                           
.   Program   :   FMSTDSFM 
.                            
.   Routines  :   KTDSAP00 Keyin Transaction Code   - Returns a valid record
.                 ATDSAP00 Accept Transaction Code  - Returns a key NOT on file
.   
.   Return    :   EXIT = 1 null entry EXIT = 2 EXITCHAR entered
.-------------------------------------------------------------------------------
.   Mods      :    
.-------------------------------------------------------------------------------
. Normal Code Keyin - Code Must Exist Exit = 1 if Null Entry
.-------------------------------------------------------------------------------
KTDSAP00  MOVE      UNDLN70,FMTDCODE
          KEYIN     *PCCOL:CVERT,*EL,*DV,FMTDCODE:
                    *PCCOL:CVERT,*V2LON,FMTDCODE: 
                    *PCCOL:CVERT,*EL,*DV,FMTDCODE
.
          ENDSET    FMTDCODE
          APPEND    SP70,FMTDCODE
          RESET     FMTDCODE
          MATCH     SP70,FMTDCODE             * System Code Spaces so exit set
          GOTO      KTDSAP90 IF EQUAL
.
          CMATCH    EXITCHAR,FMTDCODE         * Exit Selected
          GOTO      KTDSAP95 IF EQUAL
.
          PACK      KEY4,FMTDCODE
          CALL      RDFMTD1                                   
          BRANCH    OVRCD,KTDSAP80
          MOVE      ZERO,EXIT                 * no entry so exit is set
          GOTO      KTDSAP99
.
KTDSAP80  DISPLAY   *P1:24,*EL,*B,"Transaction Code Does Not Exist - ";
          CALL      HITENTER
          GOTO      KTDSAP00
.
KTDSAP90  MOVE      ONE,EXIT                  * null entry so exit is set
          GOTO      KTDSAP99
.
KTDSAP95  MOVE      TWO,EXIT                  * Exit character entered    
.
KTDSAP99  RETURN
.-------------------------------------------------------------------------------
. Accept Code Keyin - Code Must Not Exist 
.-------------------------------------------------------------------------------
ATDSAP00  MOVE      UNDLN70,FMTDCODE
          KEYIN     *PCCOL:CVERT,*EL,*DV,FMTDCODE:
                    *PCCOL:CVERT,*V2LON,FMTDCODE: 
                    *PCCOL:CVERT,*V2LON,*DV,FMTDCODE
.
          ENDSET    FMTDCODE
          APPEND    SP70,FMTDCODE
          RESET     FMTDCODE
          MATCH     SP70,FMTDCODE             * System Code Spaces so exit set
          GOTO      ATDSAP90 IF EQUAL
.
          CMATCH    EXITCHAR,FMTDCODE         * Exit Selected
          GOTO      ATDSAP95 IF EQUAL
.
          PACK      KEY4,FMTDCODE
          MOVE      ZERO,EXIT                 * no entry so exit is set
          CALL      RDFMTD1                                   
          BRANCH    OVRCD,ATDSAP99
.
          DISPLAY   *P1:24,*EL,*B,"Transaction Code Already Exists - ";
          CALL      HITENTER
          GOTO      ATDSAP00
.
ATDSAP90  MOVE      ONE,EXIT                  * null entry so exit is set
          GOTO      ATDSAP99
.
ATDSAP95  MOVE      TWO,EXIT                  * Exit character entered    
.
ATDSAP99  RETURN
.
.
RLMCFM00  RETURN
.
          INC       APSPPDIO/INC
          INC       FMSLMCIO/INC
          INC       FMSLMCKY
