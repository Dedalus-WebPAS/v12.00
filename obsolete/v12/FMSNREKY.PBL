.---------------------------------------------------------------------------
.   System    :   Financial Management System
.   Include   :   FMSNREKY
.   Routine   :   HFMNEA00 Total Subjective
.   Return    :   FMNBTCOD
.-------------------------------------------------------------------------------
HFMNEA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "30",HLEF
            MOVE      "80",HRIG
          ENDIF
HFMNEA04
          CALL      GSCRN000
          BRANCH    EXIT,HFMNEA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Total Subjective"
.
          MOVE      STDCOL01,STDCOL02
          ADD       "14",STDCOL02
          MOVE      STDCOL02,STDCOL03
          ADD       "42",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Level"
.
          MOVE      STDCOL03,STDCOL04
          ADD       " 7",STDCOL04
          DISPLAY   *PSTDCOL04:STDROW,*V2LON,*ULON,"Print Code"
.
          MOVE      STDCOL04,STDCOL05
          ADD       "12",STDCOL05
HFMNEA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,FMNETCOD
          PACK      KEY15,FMNECODE,FMNETCOD,SP70
          PACK      SAVKEY80,FMNECODE,FMNETCOD,SP70
          SETLPTR   SAVKEY80,3
          CALL      RSFMNE1
HFMNEA10
          CALL      RKFMNE1
          BRANCH    OVRCD,HFMNEA15
          PACK      KEY15,FMNECODE,FMNETCOD,SP70
          MATCH     SAVKEY80,KEY15
          GOTO      HFMNEA15 IF NOT EQUAL
          BRANCH    CSEARCH,HFMNEA12
          CALL      HFMNEA60
          BRANCH    OVRCD,HFMNEA10
HFMNEA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY15,XITEMNO,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,FMNETCOD
          DISPLAY   *PSTDCOL02:STDROW,FMNEDESC
          DISPLAY   *PSTDCOL03:STDROW,FMNETLEV
          DISPLAY   *PSTDCOL04:STDROW,FMNEPRTC
          COMPARE   MAXITEM,XITEMNO
          GOTO      HFMNEA10 IF NOT EQUAL
HFMNEA15
          UNPACK    SAVKEY80,FMNECODE,FMNETCOD
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HFMNEA20
          CALL      HSCRI000
          BRANCH    EXIT,HFMNEA30,HFMNEA35,HFMNEA40,HFMNEA45,HFMNEA04:
                              HFMNEA91,HFMNEA50
          GOTO      HFMNEA92
HFMNEA30
          CALL      RKFMNE1
          BRANCH    OVRCD,HFMNEA85
          PACK      KEY15,FMNECODE,FMNETCOD,SP70
          MATCH     SAVKEY80,KEY15
          GOTO      HFMNEA85 IF NOT EQUAL
          CALL      RPFMNE1
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMNEA10
HFMNEA35
          MOVE      ST1,KEY15
          CALL      RDFMNE1
          CALL      RPFMNE1
          BRANCH    OVRCD,HFMNEA85
          PACK      KEY15,FMNECODE,FMNETCOD,SP70
          MATCH     SAVKEY80,KEY15
          GOTO      HFMNEA85 IF NOT EQUAL
          MATCH     SP70,FMNETCOD
          GOTO      HFMNEA85 IF EQUAL
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HFMNEA36
          CALL      RPFMNE1
          BRANCH    OVRCD,HFMNEA37
          PACK      KEY15,FMNECODE,FMNETCOD,SP70
          MATCH     SAVKEY80,KEY15
          GOTO      HFMNEA37 IF NOT EQUAL
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HFMNEA36 IF NOT EQUAL
HFMNEA37
          MOVE      ZERO,XITEMNO
          GOTO      HFMNEA10
HFMNEA40
          MOVE      ST1,KEY15
          CALL      RDFMNE1
          CALL      RPFMNE1
          BRANCH    OVRCD,HFMNEA85
          PACK      KEY15,FMNECODE,FMNETCOD,SP70
          MATCH     SAVKEY80,KEY15
          GOTO      HFMNEA85 IF NOT EQUAL
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMNEA08
HFMNEA45
          CALL      RKFMNE1
          BRANCH    OVRCD,HFMNEA85
          PACK      KEY15,FMNECODE,FMNETCOD,SP70
          MATCH     SAVKEY80,KEY15
          GOTO      HFMNEA85 IF NOT EQUAL
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY15,SAVKEY80,Z70
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSFMNE1
HFMNEA46
          CALL      RPFMNE1
          BRANCH    OVRCD,HFMNEA47
          PACK      KEY15,FMNECODE,FMNETCOD,SP70
          MATCH     SAVKEY80,KEY15
          GOTO      HFMNEA47 IF NOT EQUAL
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HFMNEA46 IF NOT EQUAL
HFMNEA47
          MOVE      ZERO,XITEMNO
          GOTO      HFMNEA10
HFMNEA50  COMPARE   ZERO,CSEARCH
          GOTO      HFMNEA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          KEYIN     *PSTDCOL04:STDROW,*V2LON,SCHFLD04
          RESET     SCHFLD04
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMNEA08
HFMNEA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HFMNEA08
HFMNEA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HFMNEA61 IF EQUAL
          MATCH     SCHFLD01,FMNETCOD
          GOTO      HFMNEA72 IF NOT EQUAL
HFMNEA61
          MATCH     SP70,SCHFLD02
          GOTO      HFMNEA62 IF EQUAL
          MATCH     SCHFLD02,FMNEDESC
          GOTO      HFMNEA72 IF NOT EQUAL
HFMNEA62
          MATCH     SP70,SCHFLD03
          GOTO      HFMNEA63 IF EQUAL
          MATCH     SCHFLD03,FMNETLEV
          GOTO      HFMNEA72 IF NOT EQUAL
HFMNEA63
          MATCH     SP70,SCHFLD04
          GOTO      HFMNEA64 IF EQUAL
          MATCH     SCHFLD04,FMNEPRTC
          GOTO      HFMNEA72 IF NOT EQUAL
HFMNEA64
HFMNEA65
HFMNEA66
HFMNEA67
HFMNEA68
HFMNEA69
HFMNEA70
          GOTO      HFMNEA75
HFMNEA72  MOVE      ONE,OVRCD
HFMNEA75  RETURN
HFMNEA85
          LOAD      KEY15,XITEMNO,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY15,FMNECODE,FMNETCOD
          CALL      RDFMNE1
HFMNEA90
          UNPACK    SAVKEY80,FMNECODE,FMNETCOD
          BEEP
          GOTO      HFMNEA20
HFMNEA91
          MOVE      SP70,FMNETLEV
          MOVE      SP70,FMNEDESC
          MOVE      SP70,FMNEPRTC
          MOVE      SP70,FMNESPAR
          MOVE      SP70,KEY15
          MOVE      SP70,FMNETCOD
          GOTO      HFMNEA96
HFMNEA92
          MOVE      SP70,KEY15
          MOVE      SP70,FMNETCOD
          LOAD      KEY15,CCITEM,ST1,ST2,ST3,ST4,ST5:
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY15,FMNECODE,FMNETCOD
HFMNEA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HFMNEA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Financial Management System
.   Include   :   FMSNREKY
.   Routine   :   KFMNEA00 Keyin Total Subjective
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KFMNEA00
          MOVE      FMSUUD3A,CSTRLEN          * set up string length
          CALL      GSTR0000                  * get code
          PACK      FMNETCOD,CSTRING,SP70
.
          ENDSET    FMNETCOD
          APPEND    SP70,FMNETCOD
          RESET     FMNETCOD
.
          MATCH     SP70,FMNETCOD
          GOTO      KFMNEA90 IF EQUAL
.
          CMATCH    EXITCHAR,FMNETCOD
          GOTO      KFMNEA95 IF EQUAL
.
          CMATCH    QUEST,FMNETCOD
          GOTO      KFMNEA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HFMNEA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    FMNETCOD
          APPEND    SP70,FMNETCOD
          RESET     FMNETCOD
.
          MATCH     SP70,FMNETCOD
          GOTO      KFMNEA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,FMNETCOD
KFMNEA10
          PACK      KEY15,FMNECODE,FMNETCOD
          CALL      RAFMNE1
          BRANCH    OVRCD,KFMNEA80
          BRANCH    CKEYTYP,KFMNEA75
          CALL      RDFMNE1
KFMNEA70
          MOVE      ZERO,EXIT
          GOTO      KFMNEA99
KFMNEA75
          MOVE      "Total Subjective Already Exists - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KFMNEA00
KFMNEA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KFMNEA99,KFMNEA99
          MOVE      "Total Subjective Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KFMNEA00
KFMNEA90
          MOVE      ONE,EXIT
          GOTO      KFMNEA99
KFMNEA95
          MOVE      TWO,EXIT
KFMNEA99
          RETURN
