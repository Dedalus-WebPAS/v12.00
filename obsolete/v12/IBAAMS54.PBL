.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.00.03  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
. VF.00.02  20.12.1999 Charles Handaya
.           Fix Y2K of Audit Files Date (CCYYMMDD)
. VF.00.01  02.09.1999 Sandra Barcham
.           Add in Creditor Keyword Search
.           srf 631485
.-------------------------------------------------------
ASSTDESC  DIM       20
DEPTDESC  DIM       17
DESCDESC  DIM       21
FTOTALO   DIM       19
GRANDTOT  FORM      14.2
TOTORIG   FORM      14.2
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBAAMS54
.   Function      :   Departmental Asset Listing              
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       AMSCODFD/INC
          INC       AMSGILFD/INC
          INC       AMSINSFD/INC
          INC       AMSLEAFD/INC
          INC       AMSLOCFD/INC
          INC       AMSMASFD/INC
          INC       AMSREGFD/INC
          INC       AMSREPDF    
          INC       APSMASFD/INC
          INC       APSMXRFD/INC
.=========================
.Local Variable Definition
.-------------------------
FROMREG   DIM      45 * Scr 00 Fld     1
TOREG     DIM      45 * Scr 00 Fld     2
FROMTYP   DIM      45 * Scr 00 Fld     3
TOTYP     DIM      45 * Scr 00 Fld     4
FROMDPT   DIM      45 * Scr 00 Fld     5
TODPT     DIM      45 * Scr 00 Fld     6
FROMAQD   DIM      10 * Scr 00 Fld    17
TOAQD     DIM      10 * Scr 00 Fld    18
FROMASS   DIM      45 * Scr 00 Fld    31
TOASS     DIM      45 * Scr 00 Fld    32
INCDISP   FORM      1 * Scr 00 Fld    33
MINCOST   FORM     12.2 * Scr 00 Fld    43
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBAAMS54"
PRGNAM    INIT      "Departmental Asset Listing              "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "    3",AUDTSECT
          MOVE      " 12",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening amsaudin";
            OPEN      AMSAUDIN,"amsaudin"
          ENDIF
          MOVE      "    3",AUDTSECT
          MOVE      " 11",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening amsaudle";
            OPEN      AMSAUDLE,"amsaudle"
          ENDIF
          MOVE      "    3",AUDTSECT
          MOVE      " 10",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening amsaudma";
            OPEN      AMSAUDMA,"amsaudma"
          ENDIF
          DISPLAY   *P56:24,"Opening amscodaf";
          OPEN      AMSCODA1,"amscodaf"
          DISPLAY   *P56:24,"Opening amscodaf";
          OPEN      AMSCODA2,"amscodaf"
          DISPLAY   *P56:24,"Opening amsgilaf";
          OPEN      AMSGILA1,"amsgilaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA1,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA2,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA3,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA4,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA1,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA2,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA3,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA4,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA5,"amsleaaf"
          DISPLAY   *P56:24,"Opening amslocaf";
          OPEN      AMSLOCA1,"amslocaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA1,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA2,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA3,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA4,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA5,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA6,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA7,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA8,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsregaf";
          OPEN      AMSREGA1,"amsregaf"
          MOVE      "   51",AUDTSECT
          MOVE      " 48",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening apsaudma";
            OPEN      APSAUDMA,"apsaudma"
          ENDIF
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA1,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA2,"apsmxraf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Asset Master Report Options        
          ENDIF
          RETURN
.--------------------------------
. Screen - Asset Master Report Options        
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   50",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      DEFPAR00
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Asset Master Report Options        
.-------------------------------------------------------
CF00L000
          MOVE      SP70,FROMREG 
          MOVE      SP70,FROMTYP 
          MOVE      SP70,FROMDPT 
          MOVE      SP70,FROMAQD 
          MOVE      SP70,FROMASS 
          MOVE      ZERO,INCDISP 
          MOVE      ZERO,MINCOST 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Asset Master Report Options        
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Asset Master Report Options        
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Asset Master Report Options        
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Asset Master Report Options        
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Asset Master Report Options        
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L101,PS00L102,PS00L103,PS00L104:
                            PS00L105,PS00L106,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L107,PS00L108,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L109,PS00L110:
                            PS00L111,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L112,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999
          GOTO     PS00L999
.
PS00L101
          MOVE      FROMREG,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      TOREG,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      FROMTYP,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      TOTYP,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      FROMDPT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      TODPT,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      FROMAQD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      TOAQD,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      FROMASS,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      TOASS,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCDISP,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      MINCOST,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Asset Master Report Options        
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L101,SF00L006,SF00L102,SF00L006:
                            SF00L103,SF00L006,SF00L006,SF00L006:
                           SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L104,SF00L006,SF00L006,SF00L006:
                           SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L006,SF00L006,SF00L105,SF00L006:
                            SF00L106,SF00L006,SF00L006,SF00L006:
                           SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L006,SF00L006,SF00L107,SF00L006:
                           SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L006,SF00L006,SF00L108,SF00L109:
                            SF00L110
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L101,SF00L020,SF00L102,SF00L020:
                            SF00L103,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L104,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L105,SF00L020:
                            SF00L106,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L107,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOREG   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RREG0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L101
            ENDIF
            BRANCH    EXIT,SF00L101,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMREG,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOREG,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L102
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOTYP   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RTYP0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L102
            ENDIF
            BRANCH    EXIT,SF00L102,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMTYP,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOTYP,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L103
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TODPT   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RDPT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L103
            ENDIF
            BRANCH    EXIT,SF00L103,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMDPT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TODPT,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L104
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOAQD   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RAQD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L104
            ENDIF
            BRANCH    EXIT,SF00L104,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMAQD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOAQD,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L105
.
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOASS   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RASS0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L105
            ENDIF
            BRANCH    EXIT,SF00L105,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMASS,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOASS,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L106
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,INCDISP 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCDISP,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L107
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,MINCOST 
          IF        SCPSMAN=1
            COMPARE   ZERO,MINCOST 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L107
            ENDIF
          ENDIF
          MOVE      MINCOST,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L108
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L109
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L110
          CALL      REPT0000
          MOVE      ZERO,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.@@@@@ Function Restart Point @@@@@
.---------------------------------------------
. Default Report Range Values
.---------------------------------------------
DEFPAR00  MOVE     SP70,STRREG
          MOVE     "~~~",ENDREG
          MOVE     SP70,STRASS
          MOVE     "~~~~~~~~~~~~",ENDASS
.
          MOVE     SP70,STRTYP
          MOVE     "~~~",ENDTYP
          MOVE     SP70,STRDPT
          MOVE     "~~~",ENDDPT
.
          MOVE     SP70,STRAQD
          MOVE     "99999999",ENDAQD
.
          MOVE     "Start ",FROMREG
          MOVE     "Finish",TOREG
          MOVE     "Start ",FROMASS
          MOVE     "Finish",TOASS
          MOVE     "Start ",FROMTYP
          MOVE     "Finish",TOTYP
          MOVE     "Start ",FROMDPT
          MOVE     "Finish",TODPT
          MOVE     "Start ",FROMAQD
          MOVE     "Finish",TOAQD
          MOVE     ZERO,MINCOST
          RETURN
SETUP000  MOVE      AMCDCOD,AMLOBLD
SETUP999  RETURN
DATECURR  MOVE      CDD,CDAY
          MOVE      CMM,CMON
          MOVE      CYY,CYEAR
          MOVE      CCC,CCENT
          REP       " 0",CCENT
          REP       " 0",CYEAR
          REP       " 0",CMON
          REP       " 0",CDAY
          RETURN
RREG0000   MOVE     "    1",FLDID
           CALL     GETPOSIT
           CALL     KAMREA00
           BRANCH   EXIT,RREG0100,RREG0999
           MOVE     AMREREG,STRREG
           PACK     FROMREG,AMREREG,SP1,AMREDES
           GOTO     RREG0140
RREG0100   MOVE     "Start             ",FROMREG
           MOVE     SP70,STRREG
.
RREG0140   MOVE     FROMREG,VAR
           CALL     DISPITEM
.
RREG0150   MOVE     "    2",FLDID
           CALL     GETPOSIT
           CALL     KAMREA00
           BRANCH   EXIT,RREG0200,RREG0999
           MOVE     AMREREG,ENDREG
           PACK     TOREG,AMREREG,SP1,AMREDES
           MATCH    STRREG,ENDREG
           GOTO     RREG0999 IF EQUAL
           GOTO     RREG0999 IF NOT LESS
           BEEP
           MOVE     "To Register Must Be > From Register - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RREG0000
.
RREG0200   MOVE     "Finish             ",TOREG
           MOVE     "~~",ENDREG
.
RREG0999   MOVE     "    1",FLDID
           CALL     GETPOSIT
           RETURN
RTYP0000   MOVE     "    3",FLDID
           CALL     GETPOSIT
           MOVE     "AT",AMCDCAT
           CALL     KAMCDA00
           BRANCH   EXIT,RTYP0100,RTYP0999
           MOVE     AMCDCOD,STRTYP
           PACK     FROMTYP,AMCDCOD,SP1,AMCDDES
           GOTO     RTYP0140
.
RTYP0100   MOVE     "Start             ",FROMTYP
           MOVE     SP70,STRTYP
.
RTYP0140   MOVE     FROMTYP,VAR
           CALL     DISPITEM
.
RTYP0150   MOVE     "    4",FLDID
           CALL     GETPOSIT
           MOVE     "AT",AMCDCAT
           CALL     KAMCDA00
           BRANCH   EXIT,RTYP0200,RTYP0999
           MOVE     AMCDCOD,ENDTYP
           PACK     TOTYP,AMCDCOD,SP1,AMCDDES
           MATCH    STRTYP,ENDTYP
           GOTO     RTYP0999 IF EQUAL
           GOTO     RTYP0999 IF NOT LESS
           BEEP
           MOVE     "To Asset Type Must Be > From Asset Type - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RTYP0000
.
RTYP0200   MOVE     "Finish             ",TOTYP
           MOVE     "~~",ENDTYP
.
RTYP0999   MOVE     "    3",FLDID
           CALL     GETPOSIT
           RETURN
RDPT0000   MOVE     "    5",FLDID
           CALL     GETPOSIT
           MOVE     "DP",AMCDCAT
           CALL     KAMCDA00
           BRANCH   EXIT,RDPT0100,RDPT0999
           MOVE     AMCDCOD,STRDPT
           PACK     FROMDPT,AMCDCOD,SP1,AMCDDES
           GOTO     RDPT0140
.
RDPT0100   MOVE     "Start             ",FROMDPT
           MOVE     SP70,STRDPT
.
RDPT0140   MOVE     FROMDPT,VAR
           CALL     DISPITEM
.
RDPT0150   MOVE     "    6",FLDID
           CALL     GETPOSIT
           MOVE     "DP",AMCDCAT
           CALL     KAMCDA00
           BRANCH   EXIT,RDPT0200,RDPT0999
           MOVE     AMCDCOD,ENDDPT
           PACK     TODPT,AMCDCOD,SP1,AMCDDES
           MATCH    STRDPT,ENDDPT
           GOTO     RDPT0999 IF EQUAL
           GOTO     RDPT0999 IF NOT LESS
           BEEP
           MOVE     "To Department Must Be > From Department - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RDPT0000
.
RDPT0200   MOVE     "Finish             ",TODPT
           MOVE     "~~",ENDDPT
.
RDPT0999   MOVE     "    5",FLDID
           CALL     GETPOSIT
           RETURN
RAQD0000   MOVE     "   17",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RAQD0100
           MATCH    SP2,CDAY
           GOTO     RAQD0100 IF EQUAL
           PACK     STRAQD,CCENT,CYEAR,CMON,CDAY
           REP      " 0",STRAQD
           CALL     PACDATE
           MOVE     CPCDATE,FROMAQD
           GOTO     RAQD0140
RAQD0100   MOVE     "Start             ",FROMAQD
           MOVE     SP70,STRAQD
.
RAQD0140   MOVE     FROMAQD,VAR
           CALL     DISPITEM
.
RAQD0150   MOVE     "   18",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RAQD0200
           MATCH    SP2,CDAY
           GOTO     RAQD0200 IF EQUAL
           PACK     ENDAQD,CCENT,CYEAR,CMON,CDAY
           REP      " 0",ENDAQD
           CALL     PACDATE
           MOVE     CPCDATE,TOAQD
           MATCH    STRAQD,ENDAQD
           GOTO     RAQD0999 IF EQUAL
           GOTO     RAQD0999 IF NOT LESS
           BEEP
           MOVE     "To Date Must Be > From Date - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RAQD0000
.
RAQD0200   MOVE     "Finish             ",TOAQD
           MOVE     "99999999",ENDAQD
.
RAQD0999   MOVE     "   17",FLDID
           CALL     GETPOSIT
           RETURN

RASS0000   MOVE     "   31",FLDID
           CALL     GETPOSIT
           MATCH    STRREG,ENDREG
           GOTO     RASS0900 IF NOT EQUAL
.
           MOVE     STRREG,AMMAREG
           CALL     KAMMAA00
           BRANCH   EXIT,RASS0100,RASS0999
           MOVE     AMMAASS,STRASS
           PACK     FROMASS,AMMAASS,SP1,AMMADES
           GOTO     RASS0140
.
RASS0100   MOVE     "Start             ",FROMASS
           MOVE     SP70,STRASS
.
RASS0140   MOVE     FROMASS,VAR
           CALL     DISPITEM
.
RASS0150   MOVE     "   32",FLDID
           CALL     GETPOSIT
           MOVE     STRREG,AMMAREG
           CALL     KAMMAA00
           BRANCH   EXIT,RASS0200,RASS0999
           MOVE     AMMAASS,ENDASS
           PACK     TOASS,AMMAASS,SP1,AMMADES
           MATCH    STRASS,ENDASS
           GOTO     RASS0999 IF EQUAL
           GOTO     RASS0999 IF NOT LESS
           BEEP
           MOVE     "To Asset Must Be > From Asset - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RASS0000
RASS0200   MOVE     "Finish             ",TOASS
           MOVE     "~~~~~~~~~~~~",ENDASS
           GOTO     RASS0999
.
RASS0900   MOVE     "Finish             ",TOASS
           MOVE     "~~~~~~~~~~~~",ENDASS
           MOVE     "Start             ",FROMASS
           MOVE     SP70,STRASS
           GOTO     RASS0999
.
RASS0999   MOVE     "   31",FLDID
           CALL     GETPOSIT
           RETURN
.-------------------------------------------------------------------------------
. Print Report
.--------------
. Report Sequences  Department
.-------------------------------------------------------------------------------
REPT0000  DISPLAY   *P1:24,*EL,"Printing Report : ";
          MOVE      ZERO,CPAGENO          * reset page no.
          CLOCK     TIME,CTIMEIS          * get current time
          MOVE      "99",CLNO             * init last line number
          MOVE      ZERO,TOTORIG
          MOVE      ZERO,GRANDTOT
.
REPT1000  PACK      KEY17,STRDPT,SP70
          CALL      RSAMMA3
          MOVE      SP70,LASTPRT
.
REPT1100  CALL      RKAMMA3
          BRANCH    OVRCD,REPT9000
          MATCH     AMMADPT,ENDDPT
          GOTO      REPT9000 IF LESS
.
          IF        AMMACST<MINCOST
            GOTO      REPT1100
          ENDIF
.
          CALL      RANGE000
          BRANCH    EXIT,REPT1100
.
          MATCH     AMMADPT,LASTPRT
          IF        !@EQUAL
            CALL      TOTOR000
            MOVE      "99",CLNO        * Page Break on Change of Department
            MOVE      "DP",AMCDCAT
            MOVE      AMMADPT,LASTPRT
            PACK      KEY5,AMCDCAT,LASTPRT
            CALL      RDAMCD1
            PACK      TOTDES01,AMCDCOD,SP1,AMCDDES
            MOVE      ONE,TOTALPRT
          ENDIF
          DISPLAY   *P20:24,*V2LON,AMMAREG,"/",AMMAASS
.
          CALL      PLINE000      * Print Asset Details
.
          GOTO      REPT1100
.
REPT9000  IF        CLNO = 99
            CALL      HEAD0000 IF EQUAL
          ELSE
            CALL      TOTOR000
            CALL      GRDOR000
          ENDIF
.
          CALL      UND132
          PRINT     *45,"*** End of Report ***"
.
REPT9999  RETURN
.------------------------------------------------------------
. Print Asset Line
.------------------------------------------------------------
PLINE000  COMPARE  "55",CLNO
          CALL     HEAD0000 IF NOT LESS
          ADD      ONE,CLNO
.
          CALL     GETASS00
          MOVE     TYPDESC,ASSTDESC
          MOVE     DPTDESC,DEPTDESC
          MOVE     AMMADES,DESCDESC
.
          UNPACK   AMMAAQD,CCENT,CYEAR,CMON,CDAY
          CALL     PACDATE
          MOVE     CPCDATE,DATEAQD
.
          UNPACK   AMMADDT,CCENT,CYEAR,CMON,CDAY
          CALL     PACDATE
          MOVE     CPCDATE,DATEDDT
.
          MOVE     "999,999,999.99",FTOTAL1
          FEDIT    AMMACST,FTOTAL1
.
          ADD      AMMACST,TOTORIG
          PRINT    *001,AMMAREG,"/",AMMAASS:
                   *017,AMMADES:
                   *053,ASSTDESC:
                   *079,DATEAQD:
                   *095,DATEDDT:
                   *119,FTOTAL1
          RETURN
.------------------------------------------------------------
. Page Heading
.------------------------------------------------------------
HEAD0000  CALL     HEAD132
          IF       CPAGENO<=1
            CALL     SELC0000            * Only on page 1
          ENDIF
          PRINT    *001,"Department : ",TOTDES01
          CALL     UND132
          PRINT    *001,"Register/Asset":
                   *017,"Description":
                   *053,"Asset Type":
                   *079,"Acq. Date":
                   *095,"Disp. Date":
                   *118,"  Original Cost"
.
          CALL     UND132
          ADD      "4",CLNO
          RETURN
.------------------------------------------------------------
. Report Selections
.------------------------------------------------------------
SELC0000  ADD       ONE,CLNO
          PACK      KEY4,STRREG,ENDREG
          MATCH     "  ~~",KEY4
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Register          From : ",FROMREG," to ",TOREG
          ENDIF
.
          PACK      KEY24,STRASS,ENDASS
          MATCH     "            ~~~~~~~~~~~~",KEY24
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Asset Code        From : ",FROMASS," to ",TOASS
          ENDIF
.
          PACK      KEY6,STRTYP,ENDTYP
          MATCH     "   ~~~",KEY6
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Asset Type        From : ",FROMTYP," to ",TOTYP
          ENDIF
.
          PACK      KEY6,STRDPT,ENDDPT
          MATCH     "   ~~~",KEY6
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Department        From : ",FROMDPT," to ",TODPT
          ENDIF
.
          PACK      KEY16,STRAQD,ENDAQD
          MATCH     "        99999999",KEY16
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Acquisition Date  From : ",FROMAQD," to ",TOAQD
          ENDIF
.
          IF         INCDISP=0
            PRINT      "Don't Print Disposed Assets";
          ELSE
            PRINT      "Print Disposed Assets";
          ENDIF
.
          PRINT     *40,"Minimum Original Cost : ",MINCOST
.
          RETURN
.------------------------------------------------------------
. Check Asset in Selection Range
.------------------------------------------------------------
RANGE000  MOVE      ZERO,EXIT
          BRANCH    INCDISP,RANGE010
          MATCH     SP70,AMMADDT
          GOTO      RANGE900 IF NOT EQUAL
. Register
RANGE010  MATCH     STRREG,AMMAREG
          GOTO      RANGE900 IF LESS
          MATCH     AMMAREG,ENDREG
          GOTO      RANGE900 IF LESS
. Asset Code
          MATCH     STRASS,AMMAASS
          GOTO      RANGE900 IF LESS
          MATCH     AMMAASS,ENDASS
          GOTO      RANGE900 IF LESS
. Asset Type
          MATCH     STRTYP,AMMATYP
          GOTO      RANGE900 IF LESS
          MATCH     AMMATYP,ENDTYP
          GOTO      RANGE900 IF LESS
. Department
          MATCH     STRDPT,AMMADPT
          GOTO      RANGE900 IF LESS
          MATCH     AMMADPT,ENDDPT
          GOTO      RANGE900 IF LESS
. Source of Funds
          MATCH     STRSOF,AMMASOF
          GOTO      RANGE900 IF LESS
          MATCH     AMMASOF,ENDSOF
          GOTO      RANGE900 IF LESS
. Disposal Type
          MATCH     STRDTY,AMMADTY
          GOTO      RANGE900 IF LESS
          MATCH     AMMADTY,ENDDTY
          GOTO      RANGE900 IF LESS
. Building
          MATCH     STRBLD,AMMABLD
          GOTO      RANGE900 IF LESS
          MATCH     AMMABLD,ENDBLD
          GOTO      RANGE900 IF LESS
. Location
          MATCH     STRLOC,AMMALOC
          GOTO      RANGE900 IF LESS
          MATCH     AMMALOC,ENDLOC
          GOTO      RANGE900 IF LESS
. Disposal Date
          MATCH     STRDDT,AMMADDT
          GOTO      RANGE900 IF LESS
          MATCH     AMMADDT,ENDDDT
          GOTO      RANGE900 IF LESS
. Acquisition Date
          MATCH     STRAQD,AMMAAQD
          GOTO      RANGE900 IF LESS
          MATCH     AMMAAQD,ENDAQD
          GOTO      RANGE900 IF LESS
. Replacement Date
          MATCH     STRRDT,AMMARDT
          GOTO      RANGE900 IF LESS
          MATCH     AMMARDT,ENDRDT
          GOTO      RANGE900 IF LESS
.
          PACK      KEY14,AMMAREG,AMMAASS
          CALL      RDAMLE1
          BRANCH    OVRCD,RANGE100      * No Leasing Details so Ignore
.
. Lease Start Date
          MATCH     STRLSD,AMLEDAT
          GOTO      RANGE900 IF LESS
          MATCH     AMLEDAT,ENDLSD
          GOTO      RANGE900 IF LESS
. Lease End Date
          MATCH     STRLED,AMLEEDT
          GOTO      RANGE900 IF LESS
          MATCH     AMLEEDT,ENDLED
          GOTO      RANGE900 IF LESS
. Lease Company
          MATCH     STRLCM,AMLECOM
          GOTO      RANGE900 IF LESS
          MATCH     AMLECOM,ENDLCM
          GOTO      RANGE900 IF LESS
.
RANGE100  PACK      KEY14,AMMAREG,AMMAASS
          CALL      RDAMIN1
          BRANCH    OVRCD,RANGE999
. Insurance Company
          MATCH     STRICM,AMINCOM
          GOTO      RANGE900 IF LESS
          MATCH     AMINCOM,ENDICM
          GOTO      RANGE900 IF LESS
. Insurance Renewal Date
          MATCH     STRIRD,AMINDAT
          GOTO      RANGE900 IF LESS
          MATCH     AMINDAT,ENDIRD
          GOTO      RANGE900 IF LESS
.
          GOTO      RANGE999
RANGE900  MOVE      ONE,EXIT
RANGE999  RETURN
.
.------------------------------------------------------------
. Get Descriptions for Codes
.------------------------------------------------------------
GETASS00  MOVE      SP70,DPTDESC
          MATCH     SP70,AMMADPT
          IF        !@EQUAL
            MOVE      "DP",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMADPT
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,DPTDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,TYPDESC
          MATCH     SP70,AMMATYP
          IF        !@EQUAL
            MOVE      "AT",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMATYP
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,TYPDESC
            ENDIF
          ENDIF
.
GETASS99  RETURN
.
TOTOR000  IF       CPAGENO<1
            GOTO     TOTOR999            * Only on page 1
          ENDIF
.
          MOVE     "99,999,999,999.99",FTOTALO
          FEDIT    TOTORIG,FTOTALO
          PRINT    *116,"-----------------":
                   *N,*76,DEPTDESC," Total Original Cost : ",FTOTALO
          ADD      TOTORIG,GRANDTOT
          MOVE     ZERO,TOTORIG
.
TOTOR999  RETURN
.
GRDOR000  IF       CPAGENO<1
            GOTO     GRDOR999            * Only on page 1
          ENDIF
.
          MOVE     "99,999,999,999.99",FTOTALO
          FEDIT    GRANDTOT,FTOTALO
          PRINT    *116,"-----------------":
                   *N,*88,"Grand Total Original Cost : ",FTOTALO
          MOVE     ZERO,GRANDTOT
.
GRDOR999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       AMSCODIO/INC
          INC       AMSCODKY    
          INC       AMSGILIO/INC
          INC       AMSINSIO/INC
          INC       AMSLEAIO/INC
          INC       AMSLOCIO/INC
          INC       AMSLOCKY    
          INC       AMSMASIO/INC
          INC       AMSMASKY    
          INC       AMSREGIO/INC
          INC       AMSREGKY    
          INC       APSCKIKY    
          INC       APSMASIO/INC
          INC       APSMASKY    
          INC       APSMXRIO/INC
.
          INC       STDGENCD
.
