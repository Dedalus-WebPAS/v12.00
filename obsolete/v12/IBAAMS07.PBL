.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.00.03  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
. VF.00.02  09.11.1999  Charles Handaya
.           Fix Y2K of Audit Files Date (CCYYMMDD)
. VF.00.01  02.11.1999 Sandra Barcham
.           Change record locked message to use X
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBAAMS07
.   Function      :   Asset Deletion                          
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       AMSACMFD/INC
          INC       AMSCODFD/INC
          INC       AMSDEPFD/INC
          INC       AMSDPHFD/INC
          INC       AMSGILFD/INC
          INC       AMSINSFD/INC
          INC       AMSLEAFD/INC
          INC       AMSLOCFD/INC
          INC       AMSLOHFD/INC
          INC       AMSMASFD/INC
          INC       AMSREGFD/INC
          INC       APSMASFD/INC
.=========================
.Local Variable Definition
.-------------------------
ADTDESC   DIM      35 * Scr 00 Fld    18
ACCOPEN   FORM     12.2 * Scr 00 Fld    19
TDTDESC   DIM      35 * Scr 00 Fld    21
TAXOPEN   FORM     12.2 * Scr 00 Fld    22
.
.Word Processor File * Scr 00 Fld    57
.
NAMAMAC1  INIT      "Wamac1"
FILAMAC1  DIM       8
.
TYPDESC   DIM      35 * Scr 00 Fld    59
DPTDESC   DIM      35 * Scr 00 Fld    60
BLDDESC   DIM      35 * Scr 00 Fld    61
SOFDESC   DIM      35 * Scr 00 Fld    63
UC1DESC   DIM      35 * Scr 00 Fld    64
UC2DESC   DIM      35 * Scr 00 Fld    65
UC3DESC   DIM      35 * Scr 00 Fld    66
UC4DESC   DIM      35 * Scr 00 Fld    67
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBAAMS07"
PRGNAM    INIT      "Asset Deletion                          "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAMAC1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening amsacmaf";
          OPEN      AMSACMA1,"amsacmaf"
          MOVE      "    3",AUDTSECT
          MOVE      " 12",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening amsaudin";
            OPEN      AMSAUDIN,"amsaudin"
          ENDIF
          MOVE      "    3",AUDTSECT
          MOVE      " 11",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening amsaudle";
            OPEN      AMSAUDLE,"amsaudle"
          ENDIF
          MOVE      "    3",AUDTSECT
          MOVE      " 10",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening amsaudma";
            OPEN      AMSAUDMA,"amsaudma"
          ENDIF
          DISPLAY   *P56:24,"Opening amscodaf";
          OPEN      AMSCODA1,"amscodaf"
          DISPLAY   *P56:24,"Opening amscodaf";
          OPEN      AMSCODA2,"amscodaf"
          DISPLAY   *P56:24,"Opening amsdepaf";
          OPEN      AMSDEPA1,"amsdepaf"
          DISPLAY   *P56:24,"Opening amsdphaf";
          OPEN      AMSDPHA1,"amsdphaf"
          DISPLAY   *P56:24,"Opening amsgilaf";
          OPEN      AMSGILA1,"amsgilaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA1,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA2,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA3,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA4,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA1,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA2,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA3,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA4,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA5,"amsleaaf"
          DISPLAY   *P56:24,"Opening amslocaf";
          OPEN      AMSLOCA1,"amslocaf"
          DISPLAY   *P56:24,"Opening amslohaf";
          OPEN      AMSLOHA1,"amslohaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA1,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA2,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA3,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA4,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA5,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA6,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA7,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA8,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsregaf";
          OPEN      AMSREGA1,"amsregaf"
          MOVE      "   51",AUDTSECT
          MOVE      " 48",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening apsaudma";
            OPEN      APSAUDMA,"apsaudma"
          ENDIF
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
.--------------------------------------------------------
. Initialise Wp Filename for Asset Comments                     
.--------------------------------------------------------
          PACK      FILAMAC1,NAMAMAC1,PORT
          REP       " 0",FILAMAC1
          DISPLAY   *P56:24,"Create & Open ",FILAMAC1;
          PREP      TEMPWORD,FILAMAC1
.
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Asset Deletion                     
          ENDIF
          RETURN
.--------------------------------
. Screen - Asset Deletion                     
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   69",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Asset Deletion                     
.-------------------------------------------------------
CF00L000
          MOVE      SP70,AMMAREG 
          MOVE      SP70,AMMAASS 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Asset Deletion                     
.--------------------------------------------------------
KY00L000
.
KY00L110
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMREDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KAMREA00
          MOVE      AMREREG,AMMAREG
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      AMMAREG,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMREDES,VAR      
            CALL      DISPITEM
          ENDIF
.
KY00L120
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,AMMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EASST000
          BRANCH    EXIT,KY00L110,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      AMMAASS,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      AMMADES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Asset Deletion                     
.---------------------------------------------------------
WP00L000
          PREP     TEMPWORD,FILAMAC1
          PACK     KEY17,AMMAREG,AMMAASS,SP70
          MOVE     KEY17,SAVKEY80
          SETLPTR  SAVKEY80,14
          CALL      RDAMAC1 
          IF        OVRCD=0
            CALL      RPAMAC1 
          ENDIF
WP00L100
          CALL     RKAMAC1 
          BRANCH   OVRCD,WP00L105
          PACK     KEY17,AMACREG,AMACASS,AMACLIN
          MATCH    SAVKEY80,KEY17   
          GOTO     WP00L105 IF NOT EQUAL
          PACK     VAR,AMACCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     AMACCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP00L100
WP00L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Asset Deletion                     
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Asset Deletion                     
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Asset Deletion                     
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L101,PS00L102:
                            PS00L103,PS00L104,PS00L105,PS00L106:
                            PS00L107,PS00L108,PS00L109,PS00L110:
                            PS00L111,PS00L112,PS00L113,PS00L999:
                           PS00L114,PS00L115,PS00L116,PS00L117:
                            PS00L118,PS00L119,PS00L120,PS00L121:
                            PS00L122,PS00L123,PS00L124,PS00L125:
                            PS00L126,PS00L127,PS00L128,PS00L129:
                            PS00L130,PS00L131,PS00L132,PS00L133:
                            PS00L134,PS00L135,PS00L136,PS00L137:
                            PS00L138,PS00L139,PS00L140,PS00L141:
                            PS00L142,PS00L143,PS00L144,PS00L145:
                            PS00L146,PS00L147,PS00L148,PS00L149:
                            PS00L150,PS00L151,PS00L152,PS00L153:
                            PS00L154,PS00L155,PS00L156,PS00L157:
                            PS00L158,PS00L159,PS00L160,PS00L161:
                            PS00L162,PS00L163,PS00L164,PS00L165:
                            PS00L999,PS00L999,PS00L999
          GOTO     PS00L999
.
PS00L101
          MOVE      AMMADES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      AMREDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      AMMADPT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      AMMABLD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      AMMALOC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      AMMALCM,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMASEC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMALEA,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAREN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      AMMAPRI,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          UNPACK    AMMARDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      AMMAAAD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      AMMATAD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      AMMAADT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      ADTDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      ACCOPEN,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          MOVE      AMMATDT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      TDTDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      TAXOPEN,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE      AMMAGIC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          UNPACK    AMMAAQD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      AMMASOF,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          UNPACK    AMMADDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          MOVE      AMMAAQO,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          MOVE      AMMAAQI,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L126
          MOVE      AMMASER,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L127
          MOVE      AMMACST,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L128
          MOVE      AMMAMANC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L129
          MOVE      AMMAMANN,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L130
          MOVE      AMMAMANP,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L131
          MOVE      AMMASUPC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L132
          MOVE      AMMASUPN,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L133
          MOVE      AMMASUPP,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L134
          MOVE      AMMAUA1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L135
          MOVE      AMMAUA2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L136
          MOVE      AMMAUA3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L137
          MOVE      AMMARVR,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L138
          MOVE      AMMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L139
          MOVE      AMMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L140
          MOVE      AMMAUR3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L141
          MOVE      AMMAUR4,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L142
          UNPACK    AMMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L143
          UNPACK    AMMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L144
          UNPACK    AMMAUD3,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L145
          UNPACK    AMMAUD4,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L146
          MOVE      AMMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L147
          MOVE      AMMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L148
          MOVE      AMMAUC3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L149
          MOVE      AMMAUC4,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L150
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L151
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L152
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L153
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      AMMAUY4,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L154
          MOVE     FILAMAC1,WORDNAME
          CALL     DISPWORD
          GOTO     PS00L999
.
PS00L155
          MOVE      AMMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L156
          MOVE      TYPDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L157
          MOVE      DPTDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L158
          MOVE      BLDDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L159
          MOVE      AMLODES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L160
          MOVE      SOFDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L161
          MOVE      UC1DESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L162
          MOVE      UC2DESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L163
          MOVE      UC3DESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L164
          MOVE      UC4DESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L165
          MOVE      AMGIDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Asset Deletion                     
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L101,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L102,SF00L103
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L101,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "10",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "10",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAMAC1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAMAC1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF00L001
.
SF00L102
          CALL      CANC0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF00L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF00L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF00L999
          ENDIF
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   69",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF00L000
          ENDIF
          GOTO      SF00L001
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.@@@@@ Function Restart Point @@@@@
.-------------------------------------------------------------
. File : /users/bga/std/auditkey
.
. Audit & Locking Standard Routine to Enter Key Field
.
. where   14 = Key Length
.         AM = System 2 Character Code
.         MA = File 2 Character Code
.-------------------------------------------------------------
EASST000
          CALL      KAMMAA00                * Call Standard Keyin Routine with ?
          BRANCH    EXIT,EASST999,EASST999  * Exit 1 Null Entry 2 Exitchar
          COMPARE   ONE,OVRCD               * New Record so no Lock
          GOTO      EASST999 IF EQUAL       * Return
.
EASST100  PACK      KEY14,AMMAREG,AMMAASS   * Setup Key to File
          CALL      RLAMMA1                 * Read and Lock Record
          BRANCH    OVRCD,EASST999,EASST200 * OVRCD=1 Not on File 2 Locked
.
          CALL      GASST000                * Get Description Details
.
          ASSIGN    AMMACST+AMMARVT-AMMATAD,TAXOPEN
          ASSIGN    AMMACST+AMMARVT-AMMAAAD,ACCOPEN
.
          MOVE      ZERO,EXIT               * Setup Exit Field
          MOVE      ZERO,OVRCD              * Setup Ovrcd Field
          GOTO      EASST999
.
EASST200  MOVE      SP70,DISPMSG            * Clear Line 24 Message Display
          CALL      MESSAGE2                * Clear Line 24 and Save
          KEYIN     *P1:24,*EL,"Record Locked - (":
                    *V2LON,"R",*HOFF,")etry or e(":
                    *V2LON,"X",*HOFF,")it ? ",ANS
          CALL      MESSAGE3                * Restore Line 24
          REP       UPPLOW,ANS              * Convert to Upper Case
          MATCH     ANSR,ANS                * Re-try
          GOTO      EASST100 IF EQUAL       * Return to locking
          MATCH     ANSX,ANS                * Exit
          GOTO      EASST000 IF EQUAL       * Must be a valid response
          MATCH     ANSE,ANS                * Exit
          GOTO      EASST200 IF NOT EQUAL   * Must be a valid response
          GOTO      EASST000                * Return to Keyin
.
EASST999  RETURN                            * End of Routine
.
GASST000
          MOVE      SP70,DPTDESC
          MATCH     SP70,AMMADPT
          IF        !@EQUAL
            MOVE      "DP",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMADPT
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,DPTDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,BLDDESC
          MATCH     SP70,AMMABLD
          IF        !@EQUAL
            MOVE      "BL",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMABLD
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,BLDDESC
            ENDIF
            PACK      KEY9,AMMABLD,AMMALOC
            CALL      RDAMLO1
          ENDIF
.
          MATCH     SP70,AMMASUPC
          IF        !@EQUAL
            MOVE      AMMASUPC,KEY5
            CALL      RDAPMA1
            IF        OVRCD=0
              MOVE      APMASN1,AMMASUPN
            ENDIF
          ENDIF
.
          MATCH     SP70,AMMAMANC
          IF        !@EQUAL
            MOVE      AMMAMANC,KEY5
            CALL      RDAPMA1
            IF        OVRCD=0
              MOVE      APMASN1,AMMAMANN
            ENDIF
          ENDIF
.
          MATCH     SP70,AMMAGIC
          IF        !@EQUAL
            MOVE      AMMAGIC,KEY5
            CALL      RDAMGI1
          ENDIF
.
          MOVE      SP70,SOFDESC
          MATCH     SP70,AMMASOF
          IF        !@EQUAL
            MOVE      "SF",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMASOF
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,SOFDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC1DESC
          MATCH     SP70,AMMAUC1
          IF        !@EQUAL
            MOVE      "A1",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC1
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC1DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC2DESC
          MATCH     SP70,AMMAUC2
          IF        !@EQUAL
            MOVE      "A2",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC2
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC2DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC3DESC
          MATCH     SP70,AMMAUC3
          IF        !@EQUAL
            MOVE      "A3",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC3
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC3DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,UC4DESC
          MATCH     SP70,AMMAUC4
          IF        !@EQUAL
            MOVE      "A4",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMAUC4
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,UC4DESC
            ENDIF
          ENDIF
.
          MOVE      SP70,TYPDESC
          MATCH     SP70,AMMATYP
          IF        !@EQUAL
            MOVE      "AT",AMCDCAT
            PACK      KEY5,AMCDCAT,AMMATYP
            CALL      RDAMCD1
            IF        OVRCD=0
              MOVE      AMCDDES,TYPDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,ADTDESC
          MATCH     SP70,AMMAADT
          IF        !@EQUAL
            PACK      KEY4,AMMAADT
            CALL      RDAMDE1
            IF        OVRCD=0
              MOVE      AMDEDES,ADTDESC
            ENDIF
          ENDIF
.
          MOVE      SP70,TDTDESC
          MATCH     SP70,AMMATDT
          IF        !@EQUAL
            PACK      KEY4,AMMATDT
            CALL      RDAMDE1
            IF        OVRCD=0
              MOVE      AMDEDES,TDTDESC
            ENDIF
          ENDIF
.
          RETURN
.--------------------------------------------------
. Cancel Deletion Unlock Record
.--------------------------------------------------
CANC0000  PACK    KEY14,AMMAREG,AMMAASS
          CALL    UUAMMA1
          RETURN
DELT0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DELT1000,DELT9000,DELT9100
.
DELT1000  PACK     KEY14,AMMAREG,AMMAASS  * Setup Key to File
          CALL     RAAMMA1             * Read Record
          IF       OVRCD=0
            MOVE     FOUR,AUDTTYPE     * Delete Audit Type
            CALL     WAAMMA00          * Write Delete Audit
            CALL     DEAMMA1           * Delete Record
          ENDIF
.
          PACK     KEY14,AMMAREG,AMMAASS
          CALL     RDAMLE1
          IF       OVRCD=0
            MOVE     ZERO,ACCEPT
            MOVE     FOUR,AUDTTYPE     * Type 4 Delete Audit
            CALL     WAAMLE00          * Write Before Audit
            CALL     DEAMLE1           * Delete Record
          ENDIF
.
          PACK     KEY14,AMMAREG,AMMAASS
          CALL     RDAMIN1
          IF       OVRCD=0
            MOVE     ZERO,ACCEPT
            MOVE     FOUR,AUDTTYPE     * Type 4 Delete Audit
            CALL     WAAMIN00          * Write Before Audit
            CALL     DEAMIN1           * Delete Record
          ENDIF
.
. Delete Any Notes
.-----------------
          PACK      KEY17,AMMAREG,AMMAASS,SP70
          CALL      RSAMAC1
DELT1100  CALL      RKAMAC1
          BRANCH    OVRCD,DELT1200
          MATCH     AMMAREG,AMACREG
          GOTO      DELT1200 IF NOT EQUAL
          MATCH     AMMAASS,AMACASS
          GOTO      DELT1200 IF NOT EQUAL
          PACK      KEY17,AMACREG,AMACASS,AMACLIN
          CALL      DEAMAC1
          GOTO      DELT1100
DELT1200
.
. Delete Any Location History
.----------------------------
          PACK      KEY22,AMMAREG,AMMAASS,SP70
          CALL      RSAMLH1
DELT1300  CALL      RKAMLH1
          BRANCH    OVRCD,DELT1400
          MATCH     AMMAREG,AMLHREG
          GOTO      DELT1400 IF NOT EQUAL
          MATCH     AMMAASS,AMLHASS
          GOTO      DELT1400 IF NOT EQUAL
          PACK      KEY22,AMLHREG,AMLHASS,AMLHDAT
          CALL      DEAMLH1
          GOTO      DELT1300
DELT1400
.
. Delete Any Department History
.------------------------------
          PACK      KEY22,AMMAREG,AMMAASS,SP70
          CALL      RSAMDH1
DELT1500  CALL      RKAMDH1
          BRANCH    OVRCD,DELT1600
          MATCH     AMMAREG,AMDHREG
          GOTO      DELT1600 IF NOT EQUAL
          MATCH     AMMAASS,AMDHASS
          GOTO      DELT1600 IF NOT EQUAL
          PACK      KEY22,AMDHREG,AMDHASS,AMDHDAT
          CALL      DEAMDH1
          GOTO      DELT1500
DELT1600
.
          MOVE     TWO,EXIT            * Restart Screen
          GOTO     DELT9999
DELT9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DELT9999
DELT9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DELT9999
DELT9999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       AMSACMIO/INC
          INC       AMSCODIO/INC
          INC       AMSDEPIO/INC
          INC       AMSDPHIO/INC
          INC       AMSGILIO/INC
          INC       AMSINSIO/INC
          INC       AMSLEAIO/INC
          INC       AMSLOCIO/INC
          INC       AMSLOHIO/INC
          INC       AMSMASIO/INC
          INC       AMSMASKY    
          INC       AMSREGIO/INC
          INC       AMSREGKY    
          INC       APSMASIO/INC
.
          INC       STDGENCD
.
