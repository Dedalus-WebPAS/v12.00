.-----------------------------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-----------------------------------------------------------------------------
. VF.09.01  28.02.2002  Glenn Saunders   srf 15126
.           Re-compile for changes in DEBDKIKY
.-----------------------------------------------------------------------------
. VF.01.00  06.03.2000 Charles Handaya
.           Add in Sortkey
.           Change to Standard Export File  srf 638148
.-----------------------------------------------------------------------------
EXPORTFL  FILE      ASCII, FIXED=400     * Export File (Adjust Length to Suit)
EXPORTFN  DIM       8                    * Export File Name
TABDELM   EQU       0x09                 * Tab Delimiter
.
CFDBSQLA  DIM       20        77  Enquiries SQL Form A
CFDBSQLB  DIM       20        97  Enquiries SQL Form B
ENDDEB    DIM       8
ENDDEP    DIM       8
ENDPTY    DIM       8
FALLDEP   FORM      1
FALLPTY   FORM      1
G30       FORM      12.2
G60       FORM      12.2
G90       FORM      12.2
GCUR      FORM      12.2
GOUT      FORM      12.2
INVTOTAL  FORM      12.2
LASTDEB   DIM       8
NEXTDEB   DIM       8
QUOTE     INIT      "#""
STRDEB    DIM       8
STRDEP    DIM       8
STRPTY    DIM       8
T30       DIM       13
T60       DIM       13
T90       DIM       13
TCUR      DIM       13
TOUT      DIM       13
Z40       INIT      "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
.-----------------------------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBADEB65
.   Function      :   Debtors Mail Merge File Export          
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       DEBCODFD/INC
          INC       DEBDBTFD/INC
          INC       DEBDEPFD/INC
          INC       DEBDKIFD/INC
          INC       DEBFDTFD/INC
          INC       DEBFTHFD/INC
          INC       DEBITMFD/INC
          INC       DEBOUTDF    
          INC       DEBPTYFD/INC
.=========================
.Local Variable Definition
.-------------------------
FROMDEB   DIM      40 * Scr 00 Fld     4
TODEB     DIM      40 * Scr 00 Fld     5
FROMDEP   DIM      40 * Scr 00 Fld     6
TODEP     DIM      40 * Scr 00 Fld     7
FROMPTY   DIM      40 * Scr 00 Fld     8
TOPTY     DIM      40 * Scr 00 Fld     9
REPTSEQ   FORM      1 * Scr 00 Fld    10
SEQDESC   DIM      30 * Scr 00 Fld    11
REPTTYP   FORM      1 * Scr 00 Fld    12
TYPDESC   DIM      30 * Scr 00 Fld    13
ZEROOUT   FORM      1 * Scr 00 Fld    15
MINOUT    FORM     12.2 * Scr 00 Fld    16
INCHEAD   FORM      1 * Scr 00 Fld    17
EXPORTYN  FORM      1 * Scr 00 Fld    18
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBADEB65"
PRGNAM    INIT      "Debtors Mail Merge File Export          "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   81",AUDTSECT
          MOVE      "  9",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudcd";
            OPEN      DEBAUDCD,"debaudcd"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 10",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debauddb";
            OPEN      DEBAUDDB,"debauddb"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 11",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudde";
            OPEN      DEBAUDDE,"debaudde"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 12",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudit";
            OPEN      DEBAUDIT,"debaudit"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 13",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudpt";
            OPEN      DEBAUDPT,"debaudpt"
          ENDIF
          DISPLAY   *P56:24,"Opening debcodaf";
          OPEN      DEBCODA1,"debcodaf"
          DISPLAY   *P56:24,"Opening debcodaf";
          OPEN      DEBCODA2,"debcodaf"
          DISPLAY   *P56:24,"Opening debdbtaf";
          OPEN      DEBDBTA1,"debdbtaf"
          DISPLAY   *P56:24,"Opening debdbtaf";
          OPEN      DEBDBTA2,"debdbtaf"
          DISPLAY   *P56:24,"Opening debdbtaf";
          OPEN      DEBDBTA3,"debdbtaf"
          DISPLAY   *P56:24,"Opening debdbtaf";
          OPEN      DEBDBTA4,"debdbtaf"
          DISPLAY   *P56:24,"Opening debdepaf";
          OPEN      DEBDEPA1,"debdepaf"
          DISPLAY   *P56:24,"Opening debdepaf";
          OPEN      DEBDEPA2,"debdepaf"
          DISPLAY   *P56:24,"Opening debdkiaf";
          OPEN      DEBDKIA1,"debdkiaf"
          DISPLAY   *P56:24,"Opening debdkiaf";
          OPEN      DEBDKIA2,"debdkiaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA1,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA2,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA3,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA4,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA5,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA6,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA7,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA8,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA1,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA2,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA3,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA4,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA5,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA6,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA7,"debfthaf"
          DISPLAY   *P56:24,"Opening debitmaf";
          OPEN      DEBITMA1,"debitmaf"
          DISPLAY   *P56:24,"Opening debitmaf";
          OPEN      DEBITMA2,"debitmaf"
          DISPLAY   *P56:24,"Opening debitmaf";
          OPEN      DEBITMA3,"debitmaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA1,"debptyaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA2,"debptyaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA3,"debptyaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Debtors Trial Balance Report       
          ENDIF
          RETURN
.--------------------------------
. Screen - Debtors Trial Balance Report       
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      DEFPAR00
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Debtors Trial Balance Report       
.-------------------------------------------------------
CF00L000
          MOVE      SP70,FROMDEB 
          MOVE      SP70,TODEB   
          MOVE      SP70,FROMDEP 
          MOVE      SP70,TODEP   
          MOVE      SP70,FROMPTY 
          MOVE      SP70,TOPTY   
          MOVE      ZERO,REPTSEQ 
          MOVE      SP70,SEQDESC 
          MOVE      ZERO,REPTTYP 
          MOVE      SP70,TYPDESC 
          MOVE      SP70,ASATDATE
          MOVE      ZERO,ZEROOUT 
          MOVE      ZERO,MINOUT  
          MOVE      ZERO,INCHEAD 
          MOVE      ZERO,EXPORTYN
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Debtors Trial Balance Report       
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Debtors Trial Balance Report       
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Debtors Trial Balance Report       
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Debtors Trial Balance Report       
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Debtors Trial Balance Report       
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L101:
                            PS00L102,PS00L103,PS00L104,PS00L105:
                            PS00L106,PS00L107,PS00L108,PS00L109:
                            PS00L110,PS00L111,PS00L112,PS00L113:
                            PS00L114,PS00L115
          GOTO     PS00L999
.
PS00L101
          MOVE      FROMDEB,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      TODEB,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      FROMDEP,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      TODEP,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      FROMPTY,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      TOPTY,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      REPTSEQ,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      SEQDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      REPTTYP,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      TYPDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          UNPACK    ASATDATE,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      ZEROOUT,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      MINOUT,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCHEAD,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      EXPORTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Debtors Trial Balance Report       
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L006,SF00L104,SF00L006,SF00L105:
                            SF00L006,SF00L106,SF00L006,SF00L107:
                            SF00L006,SF00L108,SF00L109,SF00L110:
                            SF00L111,SF00L112
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L103:
                            SF00L020,SF00L104,SF00L020,SF00L105:
                            SF00L020,SF00L106,SF00L020,SF00L107:
                            SF00L020,SF00L108,SF00L109,SF00L110:
                            SF00L111,SF00L112
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      REPT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF00L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF00L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF00L999
          ENDIF
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF00L000
          ENDIF
          GOTO      SF00L001
.
SF00L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TODEB   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RDEB0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L103
            ENDIF
            BRANCH    EXIT,SF00L103,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMDEB,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TODEB,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L104
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TODEP   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RDEP0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L104
            ENDIF
            BRANCH    EXIT,SF00L104,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMDEP,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TODEP,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L105
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOPTY   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RPTY0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L105
            ENDIF
            BRANCH    EXIT,SF00L105,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMPTY,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOPTY,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L106
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SEQDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KRSEQ000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L106
            ENDIF
            BRANCH    EXIT,SF00L106,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      REPTSEQ,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SEQDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L107
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TYPDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KRTYP000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L107
            ENDIF
            BRANCH    EXIT,SF00L107,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      REPTTYP,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TYPDESC,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L108
          CALL      DEFDATE1
          CALL     SELECTED
          CALL      KEYDATE
          PACK      ASATDATE,CCENT,CYEAR,CMON,CDAY          
          UNPACK    ASATDATE,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L109
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,ZEROOUT 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      ZEROOUT,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L110
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,MINOUT  
          IF        SCPSMAN=1
            COMPARE   ZERO,MINOUT  
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L110
            ENDIF
          ENDIF
          MOVE      MINOUT,VAR       
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L111
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,INCHEAD 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCHEAD,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L112
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,EXPORTYN
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      EXPORTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.@@@@@ Function Restart Point @@@@@
.---------------------------------------
. Setup Defaults for Invoice Generation
.---------------------------------------
DEFPAR00  MOVE      "Start    ",FROMDEB
          MOVE      "Start    ",FROMDEP
          MOVE      "Start    ",FROMPTY
          MOVE      "Finish   ",TODEB
          MOVE      "Finish   ",TODEP
          MOVE      "Finish   ",TOPTY
          MOVE      SP70,STRDEB
          MOVE      SP70,STRDEP
          MOVE      SP70,STRPTY
          MOVE      Z70,ENDDEB
          MOVE      Z70,ENDDEP
          MOVE      Z70,ENDPTY
          PACK      ASATDATE,CCC,CYY,CMM,CDD
          REP       " 0",ASATDATE
          MOVE      ONE,REPTSEQ
          MOVE      ONE,REPTTYP
          MOVE      ZERO,ZEROOUT
          MOVE      ZERO,MINOUT
          MOVE      ONE,INCHEAD
          CALL      GRSEQ000
          CALL      GRTYP000
          RETURN
.
DEFDATE1  MOVE     CCC,CCENT
          MOVE     CYY,CYEAR
          MOVE     CMM,CMON
          MOVE     CDD,CDAY
          REP      " 0",CCENT
          REP      " 0",CYEAR
          REP      " 0",CMON
          REP      " 0",CDAY
          RETURN
.-----------------------------
. Print Trial Balance Report
.-----------------------------
REPT0000  MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
          MOVE      "99",CLNO
.
          CALL      SETOUT00        * Set up Dates for Ageing
          CALL      CHKRAN00        * Check Ranges
          CALL      MAKEXP00        * Create Export File
.
          BRANCH    REPTSEQ,REPT1000,REPT2000,REPT3000
.
. Report By Debtors Code
.
REPT1000  PACK      KEY8,STRDEB,SP70
          CALL      RDDBDB1
          IF        OVRCD=0
            CALL      RPDBDB1
          ENDIF
REPT1100  CALL      RKDBDB1
          BRANCH    OVRCD,REPT9000
          MATCH     DBDBDEB,ENDDEB
          GOTO      REPT9000 IF LESS
.
          CALL      PLIN0000
          GOTO      REPT1100
.
. Report By Debtors Name
.
REPT2000  PACK      KEY43,SP70
          CALL      RDDBDB2
          IF        OVRCD=0
            CALL      RPDBDB2
          ENDIF
REPT2100  CALL      RKDBDB2
          BRANCH    OVRCD,REPT9000
          MATCH     STRDEB,DBDBDEB    * Debtors Range
          GOTO      REPT2100 IF LESS
          MATCH     DBDBDEB,ENDDEB
          GOTO      REPT2100 IF LESS
.
          CALL      PLIN0000
          GOTO      REPT2100
.
. Report By Sortkey
.
REPT3000  PACK      KEY33,SP70
          CALL      RDDBDB3
          IF        OVRCD=0
            CALL      RPDBDB3
          ENDIF
REPT3100  CALL      RKDBDB3
          BRANCH    OVRCD,REPT9000
          MATCH     STRDEB,DBDBDEB    * Debtors Range
          GOTO      REPT3100 IF LESS
          MATCH     DBDBDEB,ENDDEB
          GOTO      REPT3100 IF LESS
.
          CALL      PLIN0000
          GOTO      REPT3100
.
REPT9000  CALL      PEND0000
          CALL      TRAN0000
          MOVE      ZERO,EXIT
          GOTO      REPT9999
REPT9100  MOVE      FOUR,EXIT
          GOTO      REPT9999
.
REPT9999  RETURN
.--------------------------------------------------------
. Print Debtor Details
.--------------------------------------------------------
PLIN0000  CALL      CALOUT00
          BRANCH    ZEROOUT,PLIN1000
          COMPARE   ZERO,TOTALOUT
          GOTO      PLIN9000 IF EQUAL
.
PLIN1000  BRANCH    REPTTYP,PLIN2000,PLIN1100,PLIN1200,PLIN1300
PLIN1100  COMPARE   ZERO,BALTOT30
          GOTO      PLIN2000 IF NOT EQUAL
PLIN1200  COMPARE   ZERO,BALTOT60
          GOTO      PLIN2000 IF NOT EQUAL
PLIN1300  COMPARE   ZERO,BALTOT90
          GOTO      PLIN2000 IF NOT EQUAL
          GOTO      PLIN9000
.
PLIN2000  COMPARE   ZERO,MINOUT
          GOTO      PLIN3000 IF EQUAL
          IF        MINOUT>TOTALOUT
            GOTO      PLIN9000
          ENDIF
.
PLIN3000  MOVE      "99,999,999.99",TOUT
          MOVE      "99,999,999.99",TCUR
          MOVE      "99,999,999.99",T30
          MOVE      "99,999,999.99",T60
          MOVE      "99,999,999.99",T90
          FEDIT     TOTALOUT,TOUT
          FEDIT     CURRENT,TCUR
          FEDIT     BALTOT30,T30
          FEDIT     BALTOT60,T60
          FEDIT     BALTOT90,T90
.
          COMPARE   "55",CLNO
          CALL      PHED0000 IF NOT LESS
.
          CALL      WRTEXP00          * Write Export Line
.
          PRINT     DBDBDEB,SP1,DBDBNA1,SP1,DBDBPH1,TOUT,TCUR,T30,T60,T90
          ADD       ONE,CLNO
.
          ADD       TOTALOUT,GOUT
          ADD       CURRENT,GCUR
          ADD       BALTOT30,G30
          ADD       BALTOT60,G60
          ADD       BALTOT90,G90
.
PLIN9000  RETURN
.------------------------------------------------------------
. Print End of Report
.------------------------------------------------------------
PEND0000  COMPARE   ZERO,CPAGENO
          CALL      PHED0000 IF EQUAL
          MOVE      "99,999,999.99",TOUT
          MOVE      "99,999,999.99",TCUR
          MOVE      "99,999,999.99",T30
          MOVE      "99,999,999.99",T60
          MOVE      "99,999,999.99",T90
          FEDIT     GOUT,TOUT
          FEDIT     GCUR,TCUR
          FEDIT     G30,T30
          FEDIT     G60,T60
          FEDIT     G90,T90
          CALL      UND132
          PRINT     "Total   ",SP1,SP30,SP5,SP1,SP20,TOUT,TCUR,T30,T60,T90
          CALL      UND132
          PRINT     *50,"*** End of Report ***"
          RETURN
.
.----------------------------------------------------------------------
. PHED0000 - Print Page Heading
.----------------------------------------------------------------------
PHED0000  CALL      HEAD132
          DISPLAY   *P1:24,*EL,"Printing Page ... ",CPAGENO
          UNPACK    ASATDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          PRINT     "Debtor Code From : ",FROMDEB," to ",TODEB:
                    "As At Date : ",CPCDATE
          PRINT     "Department From  : ",FROMDEP," to ",TODEP:
                    "Outstand. >: ",MINOUT
          PRINT     "Prod. Type From  : ",FROMPTY," to ",TOPTY
          PRINT     "Report Sequence  : ",SEQDESC:
                    "   Report Type      : ",TYPDESC
          CALL      UND132
          PRINT     "Debtor                                       Telephone":
                    "                   Total      Current      30 Days    ":
                    "  60 Days      90 Days"
          CALL      UND132
          ADD       THREE,CLNO
          RETURN
.----------------------------------------------------------------------
. CALOUT00 - Calculate Outstanding Balance as at a set date
.----------------------------------------------------------------------
CALOUT00  MOVE      ZERO,TOTALOUT
          MOVE      ZERO,CURRENT
          MOVE      ZERO,BALTOT30
          MOVE      ZERO,BALTOT60
          MOVE      ZERO,BALTOT90
.
          PACK      KEY52,DBDBDEB,ASATDATE,SP70
          CALL      RSDBFD2            * Process all transactions paid after
CALOUT10  CALL      RKDBFD2            * the as at date.
          BRANCH    OVRCD,CALOUT95
          MATCH     DBFDDEB,DBDBDEB
          GOTO      CALOUT95 IF NOT EQUAL
          MATCH     "1",DBFDDTY        * Process Invoices Only
          GOTO      CALOUT10 IF NOT EQUAL
          MATCH     DBFDIDAT,ASATDATE  * Ignore Invoices Dated After
          GOTO      CALOUT10 IF LESS   * as at Date
.
          CALL      RANGE000           * Check Department/Product Type Range
          BRANCH    EXIT,CALOUT10
.
          MATCH     ASAT90,DBFDIDAT    * Over 90 days
          GOTO      CALOUT90 IF LESS
          MATCH     ASAT60,DBFDIDAT    * Over 60 days
          GOTO      CALOUT60 IF LESS
          MATCH     ASAT30,DBFDIDAT    * Over 30 days
          GOTO      CALOUT30 IF LESS
.
          ASSIGN    CURRENT+DBFDTAX+DBFDTOT-DBFDPAID,CURRENT
          GOTO      CALOUT10
CALOUT30  ASSIGN    BALTOT30+DBFDTAX+DBFDTOT-DBFDPAID,BALTOT30
          GOTO      CALOUT10
CALOUT60  ASSIGN    BALTOT60+DBFDTAX+DBFDTOT-DBFDPAID,BALTOT60
          GOTO      CALOUT10
CALOUT90  ASSIGN    BALTOT90+DBFDTAX+DBFDTOT-DBFDPAID,BALTOT90
          GOTO      CALOUT10
.
CALOUT95  ASSIGN    CURRENT+BALTOT30+BALTOT60+BALTOT90,TOTALOUT
.
          RETURN
.--------------------------------------------------------
. Check Ranges
.--------------------------------------------------------
RANGE000  BRANCH    FALLPTY,RANGE100
          PACK      KEY8,DBFDITM
          CALL      RDDBIT1
          BRANCH    OVRCD,RANGE810
.
          MATCH     STRPTY,DBITPTY    * Product Type Range
          GOTO      RANGE900 IF LESS
          MATCH     DBITPTY,ENDPTY
          GOTO      RANGE900 IF LESS
.
RANGE100  BRANCH    FALLDEP,RANGE200
          IF        FALLPTY=1
            PACK      KEY8,DBFDITM
            CALL      RDDBIT1
            BRANCH    OVRCD,RANGE810
          ENDIF
          PACK      KEY8,DBITPTY
          CALL      RDDBPT1
          BRANCH    OVRCD,RANGE820
.
          MATCH     STRDEP,DBPTDEP    * Department Range
          GOTO      RANGE900 IF LESS
          MATCH     DBPTDEP,ENDDEP
          GOTO      RANGE900 IF LESS
.
RANGE200  MOVE      ZERO,EXIT
          GOTO      RANGE999
.
RANGE810  CLEAR     DISPMSG
          APPEND    "ERROR : Sales Item Not On File - ",DISPMSG
          APPEND    KEY8,DISPMSG
          APPEND    " - ",DISPMSG
          RESET     DISPMSG
          BEEP
          CALL      MESSAGE1
          GOTO      RANGE900
.
RANGE820  CLEAR     DISPMSG
          APPEND    "ERROR : Product Type Not On File - ",DISPMSG
          APPEND    KEY8,DISPMSG
          APPEND    " - ",DISPMSG
          RESET     DISPMSG
          BEEP
          CALL      MESSAGE1
          GOTO      RANGE900
.
RANGE900  MOVE      ONE,EXIT
.
RANGE999  RETURN
.--------------------------------------------------
. Check Ranges and set "ALL" flag for each range
.--------------------------------------------------
CHKRAN00  MOVE      ZERO,FALLDEP
          MOVE      ZERO,FALLPTY
.
          MATCH     SP70,STRDEP
          IF        @EQUAL
            MATCH     Z70,ENDDEP
            IF        @EQUAL
              MOVE      ONE,FALLDEP
            ENDIF
          ENDIF
.
          MATCH     SP70,STRPTY
          IF        @EQUAL
            MATCH     Z70,ENDPTY
            IF        @EQUAL
              MOVE      ONE,FALLPTY
            ENDIF
          ENDIF
          RETURN
.------------------------------------------------------------
. File       : casetran
.
. Functions  : This file contains standard routines for
.              creating and transfering TAB delimited
.              export files to a PC using the unix script
.              keatran.
.
. Routines   : MAKEXP00  - Create the Export File and Headings
.              WRTEXP00  - Write Export details Record to File
.              TRAN0000  - Transfer file to PC using script keatran
.
. Note       : The Variable EXPORTYN is used to determine if a
.              export file is to be created. 0=No, 1=Yes.
.
. Variables to be Declared
. ------------------------
. EXPORTFL  FILE      ASCII, FIXED=400     * Export File (Adjust Length to Suit)
. EXPORTFN  DIM       8                    * Export File Name
. TABDELM   EQU       0x09                 * Tab Delimiter
.------------------------------------------------------------
. Create Export File
.------------------------------------------------------------
MAKEXP00  COMPARE   ONE,EXPORTYN
          GOTO      MAKEXP99 IF NOT EQUAL
          MOVE      "EXPORT",KEY6
          PACK      EXPORTFN,KEY6,PORT
          REP       " 0",EXPORTFN
          PREP      EXPORTFL,EXPORTFN
.
          WRITE     EXPORTFL,SEQ;"Debtor Code",TABDELM:
                                 "Name 1",TABDELM:
                                 "Name 2",TABDELM:
                                 "Address 1",TABDELM:
                                 "Address 2",TABDELM:
                                 "Address 3",TABDELM:
                                 "Address 4",TABDELM:
                                 "Post Code",TABDELM:
                                 "Phone BH",TABDELM:
                                 "Phone AH",TABDELM:
                                 "Fax",TABDELM:
                                 "Contact",TABDELM:
                                 "Total Outstanding",TABDELM:
                                 "Current Outstanding",TABDELM:
                                 "Over 30 Days",TABDELM:
                                 "Over 60 Days",TABDELM:
                                 "Over 90 Days"
.
MAKEXP99  RETURN
.------------------------------------------------------------
. Write to Export File
.------------------------------------------------------------
WRTEXP00  COMPARE   ONE,EXPORTYN
          GOTO      WRTEXP99 IF NOT EQUAL
.
          WRITE     EXPORTFL,SEQ;DBDBDEB,TABDELM:
                                 DBDBNA1,TABDELM:
                                 DBDBNA2,TABDELM:
                                 DBDBAD1,TABDELM:
                                 DBDBAD2,TABDELM:
                                 DBDBAD3,TABDELM:
                                 DBDBAD4,TABDELM:
                                 DBDBPC,TABDELM:
                                 DBDBPH1,TABDELM:
                                 DBDBPH2,TABDELM:
                                 DBDBPH3,TABDELM:
                                 DBDBCON,TABDELM:
                                 TOTALOUT,TABDELM:
                                 CURRENT,TABDELM:
                                 BALTOT30,TABDELM:
                                 BALTOT60,TABDELM:
                                 BALTOT90
.
WRTEXP99  RETURN
.------------------------------------------------------------
. Execute Transfer Script eg softerm
.------------------------------------------------------------
TRAN0000  COMPARE   ONE,EXPORTYN
          GOTO      TRAN9999 IF NOT EQUAL
          MOVE      YES,DEFYESNO
          CLOSE     EXPORTFL
          DISPLAY   *P1:24,*EL,"Execute Transfer Now (":
                               *V2LON,"Y",*HOFF,"/":
                               *V2LON,"N",*HOFF,") ? "
          MOVE      "24",CVERT
          MOVE      "30",CCOL
          CALL      YORN0000
          COMPARE   ZERO,FYESNO
          GOTO      TRAN9999 IF EQUAL   *  No Transfer
.
          MOVE      ZERO,HLEF
          CALL      GETSCR00
.
          CLEAR     KEY80
          APPEND    "keatran ",KEY80
          APPEND    EXPORTFN,KEY80
          APPEND    ".txt",KEY80
          RESET     KEY80
          EXECUTE   KEY80,TASKID
.
          CALL      PUTSCR00
.
          DISPLAY   *P1:24,*EL,"Transfer Completed Ok (":
                               *V2LON,"Y",*HOFF,"/":
                               *V2LON,"N",*HOFF,") ? "
          MOVE      "24",CVERT
          MOVE      "31",CCOL
          CALL      YORN0000
          COMPARE   ZERO,FYESNO
          GOTO      TRAN0000 IF EQUAL   *  Not ok
.
          PREP      EXPORTFL,EXPORTFN
          CLOSE     EXPORTFL
.
TRAN9999  RETURN
.
.--------------------------------------------------
. Enter Debtors Range
.--------------------------------------------------
RDEB0000   MOVE     "    4",FLDID
           CALL     GETPOSIT
           CALL     KDBDBA00
           BRANCH   EXIT,RDEB0100,RDEB0999
           MOVE     DBDBDEB,STRDEB
           PACK     FROMDEB,DBDBDEB,SP1,DBDBNA1
           GOTO     RDEB0140
RDEB0100   MOVE     "Start             ",FROMDEB
           MOVE     SP70,STRDEB
.
RDEB0140   MOVE     FROMDEB,VAR
           CALL     DISPITEM
.
RDEB0150   MOVE     "    5",FLDID
           CALL     GETPOSIT
           CALL     KDBDBA00
           BRANCH   EXIT,RDEB0200,RDEB0999
           MOVE     DBDBDEB,ENDDEB
           PACK     TODEB,DBDBDEB,SP1,DBDBNA1
           MATCH    STRDEB,ENDDEB
           GOTO     RDEB0999 IF EQUAL
           GOTO     RDEB0999 IF NOT LESS
           BEEP
           MOVE     "To Debtor Must Be > From Debtor - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RDEB0000
.
RDEB0200   MOVE     "Finish             ",TODEB
           MOVE     Z70,ENDDEB
.
RDEB0999   MOVE     "    4",FLDID
           CALL     GETPOSIT
           RETURN
.--------------------------------------------------
. Enter Department Range
.--------------------------------------------------
RDEP0000   MOVE     "    6",FLDID
           CALL     GETPOSIT
           CALL     KDBDEA00
           BRANCH   EXIT,RDEP0100,RDEP0999
           MOVE     DBDEDEP,STRDEP
           PACK     FROMDEP,DBDEDEP,SP1,DBDEDES
           GOTO     RDEP0140
RDEP0100   MOVE     "Start             ",FROMDEP
           MOVE     SP70,STRDEP
.
RDEP0140   MOVE     FROMDEP,VAR
           CALL     DISPITEM
.
RDEP0150   MOVE     "    7",FLDID
           CALL     GETPOSIT
           CALL     KDBDEA00
           BRANCH   EXIT,RDEP0200,RDEP0999
           MOVE     DBDEDEP,ENDDEP
           PACK     TODEP,DBDEDEP,SP1,DBDEDES
           MATCH    STRDEP,ENDDEP
           GOTO     RDEP0999 IF EQUAL
           GOTO     RDEP0999 IF NOT LESS
           BEEP
           MOVE     "To Department Must Be > From Department - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RDEP0000
.
RDEP0200   MOVE     "Finish             ",TODEP
           MOVE     Z70,ENDDEP
.
RDEP0999   MOVE     "    6",FLDID
           CALL     GETPOSIT
           RETURN
.--------------------------------------------------
. Enter PTYartment Range
.--------------------------------------------------
RPTY0000   MOVE     "    8",FLDID
           CALL     GETPOSIT
           CALL     KDBPTA00
           BRANCH   EXIT,RPTY0100,RPTY0999
           MOVE     DBPTPTY,STRPTY
           PACK     FROMPTY,DBPTPTY,SP1,DBPTDES
           GOTO     RPTY0140
RPTY0100   MOVE     "Start             ",FROMPTY
           MOVE     SP70,STRPTY
.
RPTY0140   MOVE     FROMPTY,VAR
           CALL     DISPITEM
.
RPTY0150   MOVE     "    9",FLDID
           CALL     GETPOSIT
           CALL     KDBPTA00
           BRANCH   EXIT,RPTY0200,RPTY0999
           MOVE     DBPTPTY,ENDPTY
           PACK     TOPTY,DBPTPTY,SP1,DBPTDES
           MATCH    STRPTY,ENDPTY
           GOTO     RPTY0999 IF EQUAL
           GOTO     RPTY0999 IF NOT LESS
           BEEP
           MOVE     "To Product Type Must Be > From Product Type - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RPTY0000
.
RPTY0200   MOVE     "Finish             ",TOPTY
           MOVE     Z70,ENDPTY
.
RPTY0999   MOVE     "    8",FLDID
           CALL     GETPOSIT
           RETURN
.------------------------------------------------------------
. Input Report Layout
.------------------------------------------------------------
KRSEQ000   CALL      DRSEQ000
           MOVE      ONE,REPTSEQ
.
KRSEQ001   KEYIN     *PCCOL:CVERT,*V2LON,*RV,REPTSEQ
           BRANCH    REPTSEQ,KRSEQ010,KRSEQ010,KRSEQ010
           BEEP
           GOTO      KRSEQ001
.
KRSEQ010   CALL      GRSEQ000
KRSEQ999   CALL      PUTSCR00
           RETURN
.
DRSEQ000  MOVE      "17",HTOP
          MOVE      "55",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P60:18,*V2LON,*ULON,"Report Sequence",*HOFF:
                    *P57:19,*V2LON,"1. ",*HOFF,"Debtor Code":
                    *P57:20,*V2LON,"2. ",*HOFF,"Debtor Name":
                    *P57:21,*V2LON,"3. ",*HOFF,"Sortkey    "
          RETURN
.
GRSEQ000  BRANCH    REPTSEQ,GRSEQ010,GRSEQ020,GRSEQ030
.
GRSEQ010  MOVE      "Debtor Code",SEQDESC
          GOTO      GRSEQ999
.
GRSEQ020  MOVE      "Debtor Name",SEQDESC
          GOTO      GRSEQ999
.
GRSEQ030  MOVE      "Sortkey    ",SEQDESC
          GOTO      GRSEQ999
.
GRSEQ999  RETURN
.------------------------------------------------------------
. Input Report Layout
.------------------------------------------------------------
KRTYP000   CALL      DRTYP000
           MOVE      ONE,REPTTYP
.
KRTYP001   KEYIN     *PCCOL:CVERT,*V2LON,*RV,REPTTYP
           BRANCH    REPTTYP,KRTYP010,KRTYP010,KRTYP010,KRTYP010
           BEEP
           GOTO      KRTYP001
.
KRTYP010   CALL      GRTYP000
KRTYP999   CALL      PUTSCR00
           RETURN
.
DRTYP000  MOVE      "17",HTOP
          MOVE      "55",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P60:18,*V2LON,*ULON,"Report Type",*HOFF:
                    *P57:19,*V2LON,"1. ",*HOFF,"All Debtors":
                    *P57:20,*V2LON,"2. ",*HOFF,"Over 30 Days ":
                    *P57:21,*V2LON,"3. ",*HOFF,"Over 60 Days ":
                    *P57:22,*V2LON,"4. ",*HOFF,"Over 90 Days "
          RETURN
.
GRTYP000   BRANCH    REPTTYP,GRTYP010,GRTYP020,GRTYP030,GRTYP040
.
GRTYP010   MOVE      "All Debtors",TYPDESC
           GOTO      GRTYP999
.
GRTYP020   MOVE      "Over 30 Days",TYPDESC
           GOTO      GRTYP999
.
GRTYP030   MOVE      "Over 60 Days",TYPDESC
           GOTO      GRTYP999
.
GRTYP040   MOVE      "Over 90 Days",TYPDESC
           GOTO      GRTYP999
.
GRTYP999   RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       DEBCODIO/INC
          INC       DEBDBTIO/INC
          INC       DEBDBTKY    
          INC       DEBDEPIO/INC
          INC       DEBDEPKY    
          INC       DEBDKIIO/INC
          INC       DEBDKIKY    
          INC       DEBDKIPR    
          INC       DEBFDTIO/INC
          INC       DEBFTHIO/INC
          INC       DEBITMIO/INC
          INC       DEBOUTCD    
          INC       DEBPTYIO/INC
          INC       DEBPTYKY    
.
          INC       STDGENCD
.
