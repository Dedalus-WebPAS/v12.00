.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
.V10.04.01  15/04/2014 Ebon Clements CAR 299449
.           Recompiled for IBAPRINT 6 character printers
.V10.02.01  07/04/2011 Mike Laming for Jill CAR 239574
.           Remove CALL to ' IBAPRNT1,"ibaprntf" '
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-----------------------------------------------------------------------------
. VF.09.01  28.02.2002  Glenn Saunders   srf 15126
.           Re-compile for changes in DEBDKIKY
.-------------------------------------------------------
. VF.01.03  30.10.2000 Sandra Barcham
.           Recompiled for IBACODIO & IBAPRNIO
. VF.01.02  12.10.2000 Sandra Barcham
.           Removed IBABATFD & IBABATIO as not required
. VF.01.01  07.09.2000 Charles Handaya
.           Fix User Interface
. VF.01.00  24.08.2000 Charles Handaya
.           Special Request Re-Print Statement for Epworth
.           Quote 9840
.-------------------------------------------------------
DEBTCODE  DIM       8
F7P2A     FORM      7.2
F7P2B     FORM      7.2
F9P2A     FORM      9.2
FINDREC   FORM      1
STATHEAD  FORM      1
STATNUMB  DIM       10
TOTPREVO  FORM      12.2
TOTCURR1  FORM      12.2
TOTCURR2  FORM      12.2
TOTCURRI  FORM      12.2
Z40       INIT      "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBADEB34
.   Function      :   Reprint Statement                       
.   Generated  On :   07/04/2011
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       DEBCODFD/INC
          INC       DEBCONFD/INC
          INC       DEBDBTFD/INC
          INC       DEBDEPFD/INC
          INC       DEBDKIFD/INC
          INC       DEBFDTFD/INC
          INC       DEBFNOFD/INC
          INC       DEBFSDFD/INC
          INC       DEBFSHFD/INC
          INC       DEBFTHFD/INC
          INC       DEBINVDF    
          INC       DEBITMFD/INC
          INC       DEBOUTDF    
          INC       DEBPTYFD/INC
          INC       DEBTERFD/INC
          INC       DEBTSPFD/INC
          INC       IBAPRNFD/INC
          INC       IBATMDFD/INC
          INC       IBATMHFD/INC
.=========================
.Local Variable Definition
.-------------------------
FSTANUMB  FORM     10 * Scr 01 Fld     3
.
.    Multi Item Key Fields Scr 03 Fld     3
.-------------------------------------------------------
DBSH2NAM  INIT      "DBSH2"
DBSH2END  FORM      1   * End Display
DBSH2SNO  FORM      5   * Number of Items on the Screen
DBSH2MKY  DIM       127 * Match Key 
DBSH2EKY  DIM       127 * End Key
DBSH2SKY  DIM       127 * Start Key
DBSH2IDX  INIT      " 132 UC1-5"
DBSH2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
DBSH2FNM  DIM       8  * Filename
DBSH2CNT  FORM      3  * Number of Items on Screen
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBADEB34"
PRGNAM    INIT      "Reprint Statement                       "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SELPRT00
          CALL      SC00L000
          CLOSE     DBSH2FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   81",AUDTSECT
          MOVE      "  9",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudcd";
            OPEN      DEBAUDCD,"debaudcd"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 10",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debauddb";
            OPEN      DEBAUDDB,"debauddb"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 11",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudde";
            OPEN      DEBAUDDE,"debaudde"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 12",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudit";
            OPEN      DEBAUDIT,"debaudit"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 13",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudpt";
            OPEN      DEBAUDPT,"debaudpt"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 15",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudte";
            OPEN      DEBAUDTE,"debaudte"
          ENDIF
          DISPLAY   *P56:24,"Opening debcodaf";
          OPEN      DEBCODA1,"debcodaf"
          DISPLAY   *P56:24,"Opening debcodaf";
          OPEN      DEBCODA2,"debcodaf"
          DISPLAY   *P56:24,"Opening debdbtaf";
          OPEN      DEBDBTA1,"debdbtaf"
          DISPLAY   *P56:24,"Opening debdbtaf";
          OPEN      DEBDBTA2,"debdbtaf"
          DISPLAY   *P56:24,"Opening debdbtaf";
          OPEN      DEBDBTA3,"debdbtaf"
          DISPLAY   *P56:24,"Opening debdbtaf";
          OPEN      DEBDBTA4,"debdbtaf"
          DISPLAY   *P56:24,"Opening debdepaf";
          OPEN      DEBDEPA1,"debdepaf"
          DISPLAY   *P56:24,"Opening debdepaf";
          OPEN      DEBDEPA2,"debdepaf"
          DISPLAY   *P56:24,"Opening debdkiaf";
          OPEN      DEBDKIA1,"debdkiaf"
          DISPLAY   *P56:24,"Opening debdkiaf";
          OPEN      DEBDKIA2,"debdkiaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA1,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA2,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA3,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA4,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA5,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA6,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA7,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfdtaf";
          OPEN      DEBFDTA8,"debfdtaf"
          DISPLAY   *P56:24,"Opening debfnoaf";
          OPEN      DEBFNOA1,"debfnoaf"
          DISPLAY   *P56:24,"Opening debfsdaf";
          OPEN      DEBFSDA1,"debfsdaf"
          DISPLAY   *P56:24,"Opening debfshaf";
          OPEN      DEBFSHA1,"debfshaf"
          DISPLAY   *P56:24,"Opening debfshaf";
          OPEN      DEBFSHA2,"debfshaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA1,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA2,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA3,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA4,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA5,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA6,"debfthaf"
          DISPLAY   *P56:24,"Opening debfthaf";
          OPEN      DEBFTHA7,"debfthaf"
          DISPLAY   *P56:24,"Opening debitmaf";
          OPEN      DEBITMA1,"debitmaf"
          DISPLAY   *P56:24,"Opening debitmaf";
          OPEN      DEBITMA2,"debitmaf"
          DISPLAY   *P56:24,"Opening debitmaf";
          OPEN      DEBITMA3,"debitmaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA1,"debptyaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA2,"debptyaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA3,"debptyaf"
          DISPLAY   *P56:24,"Opening debteraf";
          OPEN      DEBTERA1,"debteraf"
          DISPLAY   *P56:24,"Opening  ibatmdaf           ";
          OPEN      IBATDET1,"ibatmdaf"          
          DISPLAY   *P56:24,"Opening ibatmhaf";
          OPEN      IBATMHA1,"ibatmhaf"
          DISPLAY   *P56:24,"Opening ibatmhaf";
          OPEN      IBATMHA2,"ibatmhaf"
.--------------------------------------------------------
. Initialise Batch Screen Statement No.                      
.--------------------------------------------------------
          MOVE     ZERO,DBSH2SNO
          MOVE     "03    3",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,DBSH2SNO
            ENDIF
          ENDIF
          PACK      DBSH2FNM,ANST,DBSH2NAM,PORT
          REP       " 0",DBSH2FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      DBSH2FL1,DBSH2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     DBSH2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,DBSH2FNM,DBSH2IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",DBSH2FNM;
          EXECUTE   KEY80,TASKID
          OPEN      DBSH2FL1,DBSH2FNM
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Options                            
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * By Statement No.                   
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * List of Statement                  
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Detail Debtor/Statement            
          ENDIF
          RETURN
.--------------------------------
. Screen - Options                            
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Options                            
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Options                            
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Options                            
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Options                            
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Options                            
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Options                            
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Options                            
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.--------------------------------
. Screen - By Statement No.                   
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
          CALL      MVACCEPT
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : By Statement No.                   
.-------------------------------------------------------
CF01L000
          MOVE      ZERO,FSTANUMB
          MOVE      SP70,DBSHDEBC
          MOVE      SP70,DBSHDSTA
          MOVE      ZERO,DBSHTOTA
          MOVE      SP70,DBDBNA1 
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for By Statement No.                   
.--------------------------------------------------------
KY01L000
.
KY01L110
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DBSHDEBC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ESTA0000
          BRANCH    EXIT,KY01L900,KY01L900
          MOVE      ZERO,ACCEPT
          MOVE      FSTANUMB,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DBSHDEBC,VAR     
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : By Statement No.                   
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : By Statement No.                   
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : By Statement No.                   
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : By Statement No.                   
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L101,PS01L102,PS01L103:
                            PS01L104
          GOTO     PS01L999
.
PS01L101
          MOVE      DBSHDEBC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          UNPACK    DBSHDSTA,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      DBSHTOTA,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      DBDBNA1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : By Statement No.                   
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L006,SF01L102:
                            SF01L103,SF01L006,SF01L006,SF01L006:
                            SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      PRNT0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L103
          MOVE      ONE,EXIT
          GOTO      SF01L999
SF01L990  MOVE      FOUR,EXIT * Exit Char Exit
SF01L999  RETURN
.--------------------------------
. Screen - List of Statement                  
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
          CALL      MVACCEPT
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : List of Statement                  
.-------------------------------------------------------
CF03L000
          MOVE      SP70,DBSHSTAT
          MOVE      SP70,DBSHDSTA
          MOVE      ZERO,DBSHTOTA
          MOVE      SP70,DBDBDEB 
          MOVE      SP70,DBDBNA1 
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for List of Statement                  
.--------------------------------------------------------
KY03L000
.
KY03L110
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DBDBNA1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EDEB0000
          BRANCH    EXIT,KY03L900,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      DBDBDEB,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DBDBNA1,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : List of Statement                  
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : List of Statement                  
.---------------------------------------------------------
LM03L000
.---------------------------------------------------------
. Load for :     3 Statement No.                      
.---------------------------------------------------------
          UNPACK    SP70,DBSHDEBC,DBSHSTAT
          PACK      KEY18,DEBTCODE,SP70
          MOVE      KEY18,DBSH2EKY
          STRIP     DBSH2SKY
          SETLPTR   DBSH2EKY,8
          MOVE      DBSH2EKY,DBSH2SKY
          CALL      RDDBSH2 
          IF        OVRCD=0
            CALL      RPDBSH2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP03L000
          MOVE     ZERO,DBSH2CNT
          MOVE     ZERO,DBSH2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP03L600
          MATCH    PRGID,SCPSPID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP03L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP03L010,DP03L010,DP03L101,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L102,DP03L103,DP03L010:
                            DP03L010
          GOTO      DP03L010
.
DP03L101
          PACK      DBSH2MKY,SP70,SP70
          CALL      UPTDBSH2
          IF        DBSH2END=0
            CALL      RPDBSH2 
            IF        OVRCD=0
              PACK      DBSH2MKY,DBSHDEBC,DBSHSTAT                                                              
              MATCH     DBSH2EKY,DBSH2MKY
              IF        @EQUAL
                MOVE      ZERO,DBSH2END
                ADD       ONE,DBSH2CNT
                CALL      UPTDBSH2
                MOVE      DBSHSTAT,VAR     
                CALL      DISPITEM
              ELSE
                MOVE      ONE,DBSH2END
              ENDIF
            ELSE
              MOVE      ONE,DBSH2END
            ENDIF
          ENDIF
          IF        DBSH2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L102
          IF        DBSH2END=0
            UNPACK    DBSHDSTA,CCENT,CYEAR,CMON,CDAY          
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L103
          IF        DBSH2END=0
            MOVE      DBSHTOTA,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
DP03L600
          MATCH    "DBSH2",NAMSSFFI
          GOTO     DP03L605 IF NOT EQUAL
          GOTO     DP03L999
DP03L605
DP03L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP03L000
.
          MATCH    "DBSH2",NAMSSFFI
          GOTO     FP03L105 IF NOT EQUAL
          PACK     KEY18,DBSH2SKY,Z70
          CALL     RDDBSH2  * Start
          IF       OVRCD=0
            CALL     RPDBSH2  * Start
          ENDIF
          CALL     DP03L000
          GOTO     FP03L999
FP03L105
FP03L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP03L000
.
          MATCH    "DBSH2",NAMSSFFI
          GOTO     LP03L105 IF NOT EQUAL
          PACK     KEY18,DBSH2SKY,SP70
          CALL     RSDBSH2  * End
          IF       OVRCD=1
            CALL     RKDBSH2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<DBSH2SNO
            CALL     RKDBSH2 
            IF       OVRCD=1
              MOVE     DBSH2SNO,SECTOR
            ENDIF
            PACK     DBSH2MKY,DBSHDEBC,DBSHSTAT                                                              
            MATCH    DBSH2EKY,DBSH2MKY
            IF       !@EQUAL
              MOVE     DBSH2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     LP03L999
LP03L105
LP03L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP03L000
.
          MATCH    "DBSH2",NAMSSFFI
          GOTO     PP03L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP03L105
          CALL      RFTDBSH2
          BRANCH   OVRCD,PP03L115
          MOVE      DBSH2MKY,KEY18 
          CALL      RSDBSH2 
PP03L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=DBSH2SNO
            CALL     RKDBSH2 
            IF       OVRCD=1
              MOVE     DBSH2SNO,SECTOR
            ENDIF
            PACK     DBSH2MKY,DBSHDEBC,DBSHSTAT                                                              
            MATCH    DBSH2EKY,DBSH2MKY
            IF       !@EQUAL
              MOVE     DBSH2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     PP03L999
PP03L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<DBSH2SNO
            CALL     RPDBSH2 
            IF       OVRCD=1
              MOVE     DBSH2SNO,SECTOR
            ENDIF
            PACK     DBSH2MKY,DBSHDEBC,DBSHSTAT                                                              
            MATCH    DBSH2EKY,DBSH2MKY
            IF       !@EQUAL
              MOVE     DBSH2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP03L999
PP03L120
PP03L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP03L000
          MATCH    "DBSH2",NAMSSFFI
          GOTO     NP03L115 IF NOT EQUAL
NP03L105
          CALL     RPDBSH2 
          BRANCH   OVRCD,NP03L110
          PACK     DBSH2MKY,DBSHDEBC,DBSHSTAT                                                              
          MATCH    DBSH2EKY,DBSH2MKY
          GOTO     NP03L110 IF NOT EQUAL
          CALL     RKDBSH2 
          CALL     DP03L000
          GOTO     NP03L999
NP03L110
          CALL     RKDBSH2 
          BEEP
          GOTO     NP03L999
NP03L115
NP03L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT03L000
CT03L105
CT03L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : List of Statement                  
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     3 Statement No.                      
.---------------------------------------------------------
UPTDBSH2
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      DBSH2FL1,KEY5;ANS
          IF        @OVER
            WRITE     DBSH2FL1,KEY5;SCPSROW,SCPSCOL,DBSH2MKY
          ELSE
            UPDATE    DBSH2FL1;SCPSROW,SCPSCOL,DBSH2MKY
          ENDIF
          RETURN
RDTDBSH2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      DBSH2FL1,KEY5;SCPSROW,SCPSCOL,DBSH2MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTDBSH2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      DBSH2FL1,KEY5;;
          READKS    DBSH2FL1;SCPSROW,SCPSCOL,DBSH2MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,DBSH2MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : List of Statement                  
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
          MOVE      "DBSH2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP03L000
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : List of Statement                  
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L101
          GOTO     PS03L999
.
PS03L101
          MOVE      DBDBNA1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : List of Statement                  
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L103:
                            SF03L104,SF03L006,SF03L006,SF03L105:
                            SF03L106,SF03L006,SF03L006,SF03L006:
                            SF03L006
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L102,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          MOVE      "DBSH2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L102
          CALL      SELECTED
          BRANCH    EXIT,SF03L001
          COMPARE   ONE,ACCEPT
          GOTO      SF03L001 IF EQUAL
          CALL      RDTDBSH2
          IF        OVRCD=1
            BEEP
            GOTO      SF03L001
          ENDIF
          MATCH     SP70,DBSH2MKY
          IF        @EQUAL
            BEEP
            GOTO      SF03L001
          ENDIF
          MOVE      DBSH2MKY,KEY18 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELI0000
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTDBSH2
          IF        OVRCD=1
            CALL      FP03L000
          ELSE
            MOVE      DBSH2MKY,KEY18 
            CALL      RSDBSH2 
            CALL      RKDBSH2 
            CALL      DP03L000
          ENDIF
          GOTO     SF03L001
.
SF03L103
          MOVE      "DBSH2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NP03L000
          GOTO     SF03L001
.
SF03L104
          MOVE      "DBSH2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PP03L000
          GOTO     SF03L001
.
SF03L105
          MOVE      "DBSH2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L106
          MOVE      "DBSH2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LP03L000
          GOTO     SF03L001
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Detail Debtor/Statement            
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC04L200
          CALL      CF04L000 * Clear Fields
          CALL      DDEB0000
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Detail Debtor/Statement            
.-------------------------------------------------------
CF04L000
          MOVE      SP70,DBSHSTAT
          MOVE      SP70,DBSHDSTA
          MOVE      ZERO,DBSHTOTA
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Detail Debtor/Statement            
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Detail Debtor/Statement            
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Detail Debtor/Statement            
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Detail Debtor/Statement            
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Detail Debtor/Statement            
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L999,PS04L101:
                            PS04L102,PS04L103
          GOTO     PS04L999
.
PS04L101
          MOVE      DBSHSTAT,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          UNPACK    DBSHDSTA,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      DBSHTOTA,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Detail Debtor/Statement            
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L102,SF04L006:
                            SF04L006,SF04L006
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L102
          CALL      PRNT0000
          MOVE      ZERO,EXIT
          GOTO      SF04L999
SF04L990  MOVE      FOUR,EXIT * Exit Char Exit
SF04L999  RETURN
.@@@@@ Function Restart Point @@@@@
.**********************************************************************
. SELPRT00 - select printer routine
. Requires IBACODFD/INC IBAPRNFD/INC
.          IBAIOCOD/INC IBAIOPRN/INC IBAPRINT
.  Note : already includes IBAPASFD & IBAPASIO
.**********************************************************************
SELPRT00  OPEN      IBACODE1,"ibacodef"     * open files
...       OPEN      IBAPRNT1,"ibaprntf"                               *D-239574
          MOVE      SP70,SPLFILE
          CALL      SELPRINT
.
          READ      CONTROLF,EIGHTY7;*86,CFDBSTHD,CFDBSTTL
.
SELPRT99  RETURN
.
DEFDATE1  MOVE     CCC,CCENT
          MOVE     CYY,CYEAR
          MOVE     CMM,CMON
          MOVE     CDD,CDAY
          REP      " 0",CCENT
          REP      " 0",CYEAR
          REP      " 0",CMON
          REP      " 0",CDAY
          RETURN
.----------------------------------------
. Move one to accept to for insert mode
.----------------------------------------
MVACCEPT  MOVE      ONE,ACCEPT
          RETURN
.---------------------------------------------------------
. Enter Statement No.
.---------------------------------------------------------
ESTA0000  MOVE      ZERO,FSTANUMB
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,*JR,FSTANUMB:
                    *PCCOL:CVERT
          COMPARE   ZERO,FSTANUMB
          GOTO      ESTA9900 IF EQUAL
.
          MOVE      FSTANUMB,STATNUMB
          PACK      KEY10,STATNUMB,SP70
          CALL      RDDBSH1
          BRANCH    OVRCD,ESTA9000
.
          PACK      KEY8,DBSHDEBC,SP70
          CALL      RDDBDB1
          GOTO      ESTA9999
.
ESTA9000  PACK      DISPMSG,SP70,SP70
          MOVE      "Statement Number does not exist. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      ESTA0000
.
ESTA9900  MOVE      ONE,EXIT
          GOTO      ESTA9999
.
ESTA9999  RETURN
.
.---------------------------------------------------------------------------
. Reprint Statement
.---------------------------------------------------------------------------
PRNT0000  MOVE      SP70,DBDBDEB
          MOVE      ZERO,TOTPREVO
.
          PACK      KEY10,DBSHSTAT,SP70
          CALL      RDDBSH1
          BRANCH    OVRCD,PRNT9999
.
          CALL      OPNPRINT
          MOVE      TWENTY9,MAXCLNO
          MOVE      TWENTY9,CLNO
.
          PACK      KEY8,DBSHDEBC,SP70
          CALL      RDDBDB1
          BRANCH    OVRCD,PRNT0100
.
          CALL      FORAD000             * Format Name & Address Lines
.
          UNPACK    DBSHDSTA,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,DATOFSTA
.
          MOVE      DBSHSTAT,STATNUMB
          MOVE      ZERO,STATHEAD
          CALL      STHED000
.
          PACK      KEY23,DBSHSTAT,SP70
          CALL      RSDBSD1
PRNT0100  CALL      RKDBSD1
          BRANCH    OVRCD,PRNT2000
.
          MATCH     DBSHSTAT,DBSDSTAT
          GOTO      PRNT2000 IF NOT EQUAL
.
          MATCH     DBSHDEBC,DBSDDEBC
          GOTO      PRNT2000 IF NOT EQUAL
.
          COMPARE   MAXCLNO,CLNO
          CALL      STCFW000 IF NOT LESS
.
          MATCH     "0",DBSDTYPE            * outstanding ?
          GOTO      PRNT1000 IF NOT EQUAL   * no
.
          MOVE      DBSDTOTA,F9P2A
          PRINT     *1,DBSDDESC,*70,F9P2A
          ADD       DBSDTOTA,TOTPREVO
          ADD       ONE,CLNO
.
          GOTO      PRNT0100
.
PRNT1000  COMPARE   ONE,STATHEAD
          GOTO      PRNT1100 IF EQUAL
.
          IF        TOTPREVO=0
            PRINT     *12,"--- No Details ---"
          ELSE
            MOVE      TOTPREVO,F9P2A
            PRINT     *14,"Total Previous Charges Outstanding",*70,F9P2A
          ENDIF
          MOVE      ONE,STATHEAD
          ADD       ONE,CLNO
.
          COMPARE   MAXCLNO,CLNO
          IF        !@LESS
            CALL      STCFW000
          ELSE
            PRINT     *12,"Charges for Current Month":
                      *54,"Amount",*67,"GST",*77,"Total"
            ADD       ONE,CLNO
          ENDIF
.
          COMPARE   MAXCLNO,CLNO
          CALL      STCFW000 IF NOT LESS
.
          MOVE      ZERO,FINDREC
          MOVE      ZERO,TOTCURR1
          MOVE      ZERO,TOTCURR2
          MOVE      ZERO,TOTCURRI
.
PRNT1100  MOVE      DBSDAMNT,F7P2A
          MOVE      DBSDGST,F7P2B
          MOVE      DBSDTOTA,F9P2A
          PRINT     *1,DBSDDESC,*50,F7P2A,F7P2B,F9P2A
          ADD       DBSDAMNT,TOTCURR1
          ADD       DBSDGST,TOTCURR2
          ADD       DBSDTOTA,TOTCURRI
.
          MOVE      ONE,FINDREC
          ADD       ONE,CLNO
.
          GOTO      PRNT0100
.
PRNT2000  COMPARE   MAXCLNO,CLNO
          CALL      STCFW000 IF NOT LESS
.
          COMPARE   ONE,STATHEAD
          GOTO      PRNT2100 IF EQUAL
.
          IF        TOTPREVO=0
            PRINT     *12,"--- No Details ---"
          ELSE
            MOVE      TOTPREVO,F9P2A
            PRINT     *14,"Total Previous Charges Outstanding",*70,F9P2A
          ENDIF
          MOVE      ONE,STATHEAD
          ADD       ONE,CLNO
.
PRNT2100  IF        FINDREC=0
            PRINT     *12,"Charges for Current Month":
                      *54,"Amount",*67,"GST",*77,"Total"
            ADD       ONE,CLNO
            COMPARE   MAXCLNO,CLNO
            CALL      STCFW000 IF NOT LESS
.
            PRINT     *12,"--- No Details ---"
          ELSE
            MOVE      TOTCURR1,F7P2A
            MOVE      TOTCURR2,F7P2B
            MOVE      TOTCURRI,F9P2A
            PRINT     *14,"Total Current Invoice",*50,F7P2A,F7P2B,F9P2A
          ENDIF
          ADD       ONE,CLNO
.
          ASSIGN    TOTCURRI+TOTPREVIO,TOTALOUT
          COMPARE   DBSHTOTA,TOTALOUT
          GOTO      PRNT2900 IF NOT EQUAL
.
PRNT2150  COMPARE   MAXCLNO,CLNO
          GOTO      PRNT2200 IF NOT LESS
          PRINT     *N;
          ADD       ONE,CLNO
          GOTO      PRNT2150
.
PRNT2200  CALL      STEND000
          GOTO      PRNT9900
.
PRNT2900  PACK      DISPMSG,SP70,SP70
          MOVE      "Total Amount Header Not Balance with Details. -  ",DISPMSG
          CALL      MESSAGE1
          GOTO      PRNT2150
.
PRNT9900  CALL      CLSPRINT
.
PRNT9999  RETURN
.
. 21 rows for Header
.
STHED000  MOVE      ZERO,CLNO
.
          PRINT     *N,*N,*N,*N,*N,*N,*N,*N,*N,*N:
                    NADLINE1,*68,"REPRINT",*N:
                    NADLINE2,*N:
                    NADLINE3,*N:
                    NADLINE4,*N:
                    NADLINE5,*N,*68,STATNUMB,*N:
                    DBDBDEB,*20,DBDBUR2,*N,*68,DATOFSTA,*N,*N,*N
.
          IF        STATHEAD=0
            PRINT     *12,"Outstanding Amounts Billed Previously"
          ELSE
            PRINT     *12,"Charges for Current Month":
                      *54,"Amount",*67,"GST",*77,"Total"
          ENDIF
          ADD       ONE,CLNO
.
STHED999  RETURN
.
. Carried Forward
. (print 16 rows)
.
STCFW000  PRINT     *N,*N,*N,*N,*N,*N,*N,*N:
                    *71,"CARRIED FWD":
                    *N,*N,*N,*N:
                    *N,*N,*N
.
          CALL      STHED000
.
STCFW999  RETURN
.
. End of Statement
.
STEND000  MOVE      "9,999,999.99",PRTOTBAL
          FEDIT     TOTALOUT,PRTOTBAL
.
          PRINT     *N,*N,*N,*N,*N,*1:
                    *N,*1,*N,*N:
                    *1,DATOFSTA,*15,NADLINE1,*66,PRTOTBAL:
                    *N,*N:
                    *N,*N,*N,*17,DBDBDEB,*32,STATNUMB:
                    *N
.
STEND999  RETURN
.
.---------------------------------------------------------
. Select Item - Statement No.
.---------------------------------------------------------
SELI0000  CALL      RDDBSH2
          IF        OVRCD=1
            MOVE      "Invalid Selection - ",DISPMSG
            BEEP
            CALL      MESSAGE1
          ELSE
            CALL      SC04L000
          ENDIF
          MOVE      ONE,EXIT
.
SELI9999  RETURN
.
.---------------------------------------------------------
. Enter Debtor Code
.---------------------------------------------------------
EDEB0000  PACK      DBDBDEB,SP70,SP70
          MOVE      ZERO,CKEYTYP            * Record must exist on file
          CALL      KDBDBA00                * Call Standard Keyin Routine with ?
          BRANCH    EXIT,EDEB9999,EDEB9999  * EXIT 1 Null Entry 2 EXITchar
.
          MOVE      DBDBDEB,DEBTCODE
.
          GOTO      EDEB9999
.
..EDEB1900  CLEAR     DISPMSG
..          APPEND    "No Statement for Debtor ",DISPMSG
..          APPEND    DBDBDEB,DISPMSG
..          APPEND    ". - ",DISPMSG
..          CALL      MESSAGE1
..          GOTO      EDEB0000
.
EDEB9999  RETURN                            * End of Routine
.
.--------------------------------------------------
. Display Debtor Detail
.--------------------------------------------------
DDEB0000   CALL     RDDBSH2
.
DDEB9999   RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       DEBCODIO/INC
          INC       DEBDBTIO/INC
          INC       DEBDBTKY    
          INC       DEBDEPIO/INC
          INC       DEBDKIIO/INC
          INC       DEBDKIKY    
          INC       DEBDKIPR    
          INC       DEBFADCD    
          INC       DEBFDTIO/INC
          INC       DEBFNOIO/INC
          INC       DEBFSDIO/INC
          INC       DEBFSHIO/INC
          INC       DEBFTHIO/INC
          INC       DEBITMIO/INC
          INC       DEBOUTCD    
          INC       DEBPTYIO/INC
          INC       DEBTSPIO/INC
          INC       IBAPRINT    
          INC       IBAPRNIO/INC
          INC       IBATMDIO/INC
          INC       IBATMHIO/INC
.
          INC       STDGENCD
.
