.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.00.02  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
. VF.00.01  02.09.1999 Sandra Barcham
.           Add in Creditor Keyword Search
.           srf 631485
.-------------------------------------------------------
F12P2     FORM      12.2
F12P4     FORM      12.4
LASTISC   INIT      " "
SAPODLED  DIM       2
SAPODACC  DIM       12
SAPCIDAT  DIM       8
SAPODAMT  FORM      12.2
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBAAPS19
.   Function      :   Inventory Order Interface Maintenance   
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSCIOFD/INC
          INC       APSISLFD/INC
          INC       APSMASFD/INC
          INC       APSMXRFD/INC
          INC       APSORDFD/INC
          INC       FMSAMADF    
          INC       FMSAMAFD/INC
          INC       FMSCONFD/INC
          INC       FMSCSAFD/INC
          INC       FMSDISFD/INC
          INC       FMSFPSFD/INC
          INC       FMSLMAFD/INC
          INC       FMSLMCDF    
          INC       FMSLMCFD/INC
          INC       FMSRESFD/INC
          INC       FMSTUPFD/INC
          INC       IBAGEDFD/INC
          INC       IBAGSTFD/INC
          INC       SINCONFD/INC
.=========================
.Local Variable Definition
.-------------------------
ORDITEM   DIM       6 * Scr 02 Fld     7
WHOLEQTY  FORM     12 * Scr 02 Fld    15
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBAAPS19"
PRGNAM    INIT      "Inventory Order Interface Maintenance   "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC02L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apscioaf";
          OPEN      APSCIOA1,"apscioaf"
          DISPLAY   *P56:24,"Opening apscioaf";
          OPEN      APSCIOA2,"apscioaf"
          DISPLAY   *P56:24,"Opening apsislaf";
          OPEN      APSISLA1,"apsislaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA1,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA2,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsordaf";
          OPEN      APSORDA1,"apsordaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA1,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA2,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA3,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmsamaaf";
          OPEN      FMSAMAA4,"fmsamaaf"
          DISPLAY   *P56:24,"Opening fmscsaaf";
          OPEN      FMSCSAA1,"fmscsaaf"
          DISPLAY   *P56:24,"Opening fmsdisaf";
          OPEN      FMSDISA1,"fmsdisaf"
          DISPLAY   *P56:24,"Opening fmslmaaf";
          OPEN      FMSLMAA1,"fmslmaaf"
          DISPLAY   *P56:24,"Opening fmslmcaf";
          OPEN      FMSLMCA1,"fmslmcaf"
          DISPLAY   *P56:24,"Opening fmsresaf";
          OPEN      FMSRESA1,"fmsresaf"
          DISPLAY   *P56:24,"Opening  fmstupaf           ";
          OPEN      FMSTUPA1,"fmstupaf"          
          DISPLAY   *P56:24,"Opening ibagedaf";
          OPEN      IBAGEDA1,"ibagedaf"
          DISPLAY   *P56:24,"Opening ibagstaf";
          OPEN      IBAGSTA1,"ibagstaf"
          DISPLAY   *P56:24,"Opening ibagstaf";
          OPEN      IBAGSTA2,"ibagstaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Order Maintenance                  
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Enter Order Details                
          ENDIF
          RETURN
.--------------------------------
. Screen - Order Maintenance                  
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Order Maintenance                  
.-------------------------------------------------------
CF00L000  COMPARE   ZERO,ACCEPT
              GOTO      CF00L999 IF EQUAL
          MOVE      SP70,APCIISC 
          MOVE      SP70,APCIORD 
          MOVE      SP70,APCICRD 
          MOVE      SP70,APCIDAT 
          MOVE      SP70,APMASN1 
          MOVE      SP70,APISDES 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Order Maintenance                  
.--------------------------------------------------------
KY00L000
.
KY00L110
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APISDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KAPISA00
          MOVE      APISISC,APCIISC
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      APCIISC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APISDES,VAR      
            CALL      DISPITEM
          ENDIF
.
KY00L120
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      KAPCI000
          BRANCH    EXIT,KY00L110,KY00L900
          MOVE      OVRCD,ACCEPT
          MOVE      APCIORD,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Order Maintenance                  
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Order Maintenance                  
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Order Maintenance                  
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Order Maintenance                  
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L101,PS00L102:
                            PS00L103,PS00L104,PS00L999,PS00L999:
                            PS00L999,PS00L999
          GOTO     PS00L999
.
PS00L101
          MOVE      APCICRD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          UNPACK    APCIDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          CALL      RAPMA000
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      APISDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Order Maintenance                  
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L101,SF00L102:
                            SF00L006,SF00L006,SF00L006,SF00L103:
                            SF00L104,SF00L105
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L101,SF00L102:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL      RAPMA000
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASN1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPMAA00
          MOVE      APMACRD,APCICRD
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L101
            ENDIF
            BRANCH    EXIT,SF00L101,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      APCICRD,VAR      
          CALL      DISPITEM
          CALL      RAPMA000
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASN1,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L102
          CALL     SELECTED
          CALL      KEYDATE
          PACK      APCIDAT,CCENT,CYEAR,CMON,CDAY           
          UNPACK    APCIDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L103
          CALL      WAPCI000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          CALL      DAPCI000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Enter Order Details                
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Enter Order Details                
.-------------------------------------------------------
CF02L000  COMPARE   ZERO,ACCEPT
              GOTO      CF02L999 IF EQUAL
          MOVE      SP70,APODISC 
          MOVE      SP70,APCIORD 
          MOVE      SP70,ORDITEM 
          MOVE      SP70,APODLED 
          MOVE      SP70,APODACC 
          MOVE      SP70,APODDIS 
          MOVE      SP70,APODRES 
          MOVE      SP70,APODDES 
          MOVE      ZERO,APODAMT 
          MOVE      ZERO,APODUCT 
          MOVE      ZERO,WHOLEQTY
          MOVE      SP70,FMLADESC
          MOVE      SP70,FMAMDESC
          MOVE      SP70,FMDSDESC
          MOVE      SP70,FMRSDESC
          MOVE      ZERO,APODUGS 
          MOVE      ZERO,APODGSTA
          MOVE      SP70,APODGST 
          MOVE      SP70,IBGSDESC
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Enter Order Details                
.--------------------------------------------------------
KY02L000
.
KY02L110
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KAPISA00
          MOVE      APISISC,APODISC
          BRANCH    EXIT,KY02L900,KY02L900
          MOVE      ZERO,ACCEPT
          CALL      MOVESYST
          MOVE      APODISC,VAR      
          CALL      DISPITEM
.
KY02L120
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KAPCI000
          BRANCH    EXIT,KY02L110,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      APCIORD,VAR      
          CALL      DISPITEM
.
KY02L130
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APODGST 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,IBGSDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      EORDI000
          BRANCH    EXIT,KY02L120,KY02L900
          MOVE      OVRCD,ACCEPT
          CALL      READ0000
          MOVE      ORDITEM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APODGST,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      IBGSDESC,VAR     
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Enter Order Details                
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Enter Order Details                
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Enter Order Details                
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Enter Order Details                
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L101:
                            PS02L102,PS02L103,PS02L104,PS02L105:
                            PS02L106,PS02L107,PS02L108,PS02L109:
                            PS02L110,PS02L111,PS02L112,PS02L113:
                            PS02L114,PS02L115,PS02L116
          GOTO     PS02L999
.
PS02L101
          MOVE      APODLED,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      APODACC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      APODDIS,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      APODRES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      APODDES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      APODAMT,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      APODUCT,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      WHOLEQTY,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          MOVE      FMLADESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          MOVE      FMAMDESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          MOVE      FMDSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L112
          MOVE      FMRSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L113
          MOVE      APODUGS,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L114
          MOVE      APODGSTA,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L115
          MOVE      APODGST,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L116
          MOVE      IBGSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Enter Order Details                
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102,SF02L103:
                            SF02L006,SF02L006,SF02L006,SF02L104:
                            SF02L105,SF02L106,SF02L107,SF02L006:
                            SF02L006,SF02L108,SF02L109,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L104:
                            SF02L105,SF02L106,SF02L107,SF02L020:
                            SF02L020,SF02L108,SF02L109,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L102
          CALL      WAPOD000
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L103
          CALL      DAPOD000
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L104
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FMLADESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KFMLAA00
          MOVE      FMLALEDG,APODLED
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L104
            ENDIF
            BRANCH    EXIT,SF02L104,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      APODLED,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMLADESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L105
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FMAMDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL      MFMLAAM0
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KFMAMA00
          MOVE      FMAMACCT,APODACC
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L105
            ENDIF
            BRANCH    EXIT,SF02L105,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      APODACC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMAMDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L106
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FMDSDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KFMDSA00
          MOVE      FMDSCODE,APODDIS
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L106
            ENDIF
            BRANCH    EXIT,SF02L106,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      APODDIS,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMDSDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L107
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FMRSDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KFMRSA00
          MOVE      FMRSCODE,APODRES
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L107
            ENDIF
            BRANCH    EXIT,SF02L107,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      APODRES,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMRSDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L108
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APODAMT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APODUGS 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APODGSTA
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L108
            ENDIF
            BRANCH    EXIT,SF02L108,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      APODUCT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APODAMT,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APODUGS,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APODGSTA,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L109
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ERECQ000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L109
            ENDIF
            BRANCH    EXIT,SF02L109,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      WHOLEQTY,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.@@@@@ Function Restart Point @@@@@
.----------------------------------------------------------------------
. Read Supplier
.----------------------------------------------------------------------
RAPMA000
          PACK     KEY5,APCICRD
          CALL     RDAPMA1
          RETURN
.
.----------------------------------------------------------------------
. Keyin APCI
.----------------------------------------------------------------------
KAPCI000  CALL      KAPCIA00                     * keyin APCI
          BRANCH    EXIT,KAPCI910,KAPCI950
.
          PACK      SAPCIDAT,APCIDAT,SP70
.
KAPCI900  MOVE      ZERO,EXIT
          GOTO      KAPCI999
.
KAPCI910  MOVE      ONE,EXIT
          MOVE      SP70,LASTISC
          GOTO      KAPCI999
.
KAPCI950  MOVE      TWO,EXIT
          MOVE      SP70,LASTISC
.
KAPCI999  RETURN
.----------------------------------------------------------------------
. Save Order Number
.----------------------------------------------------------------------
WAPCI000  PACK     KEY8,APCIISC,APCIORD,SP70
          CALL     RAAPCI1
          IF       OVRCD=0
            CALL     UPAPCI1
          ELSE
            CALL     WRAPCI1
          ENDIF
.
          MATCH     SAPCIDAT,APCIDAT   * has date changed
          GOTO      WAPCI999 IF EQUAL
.
          PACK      KEY14,APCIISC,APCIORD,SP70
          CALL      RSAPOD1
.
WAPCI100  CALL      RKAPOD1
          BRANCH    OVRCD,WAPCI999
          PACK      KEY8,APODISC,APODORD,SP70
          MATCH     KEY8,KEY14
          GOTO      WAPCI999 IF NOT EQUAL
.
          CALL      UFMFP000
.
          MOVE      SAPCIDAT,APCIDAT
          ASSIGN    APODAMT*SEQ,APODAMT
          CALL      UFMFP000
.
          GOTO      WAPCI100
.
WAPCI999  RETURN
.----------------------------------------------------------------------
. Delete Order Number
.----------------------------------------------------------------------
DAPCI000  PACK     KEY8,APCIISC,APCIORD
          CALL     RAAPCI1
          IF       OVRCD=0
            CALL     DEAPCI1
          ENDIF
          RETURN
.
MOVESYST   MOVE     APISISC,APCIISC
           MOVE     APISISC,APODISC
           RETURN
READ0000   MOVE     APODLED,KEY2
           CALL     RDFMLA1
           IF       OVRCD=1
             MOVE     "Invalid",FMLADESC
           ENDIF
           PACK     KEY14,APODLED,APODACC
           CALL     RDFMAM1
           IF       OVRCD=1
             MOVE     "Invalid",FMAMDESC
           ENDIF
           MOVE     APODDIS,KEY5
           CALL     RDFMDS1
           IF       OVRCD=1
             MOVE     "Invalid",FMDSDESC
           ENDIF
           MOVE     APODRES,KEY4
           CALL     RDFMRS1
           IF       OVRCD=1
             MOVE     "Invalid",FMRSDESC
           ENDIF
           MOVE     APODGST,KEY6
           CALL     RDIBGS1
           IF       OVRCD=1
             MOVE     SP70,IBGSDESC
           ENDIF
           MOVE     APODQTY,WHOLEQTY
           RETURN
MFMLAAM0   MOVE     FMLALEDG,FMAMLEDG
           RETURN
WAPOD000  PACK     KEY14,APODISC,APODORD,APODCAT
           CALL     RAAPOD1
           IF       OVRCD=0
             CALL     UPAPOD1
           ELSE
             CALL     WRAPOD1
           ENDIF
.
           CALL     UFMFP000           * update period summary file
.
           MOVE     SAPODLED,APODLED   * subtract old data
           MOVE     SAPODACC,APODACC
           MOVE     SAPCIDAT,APCIDAT
           ASSIGN   SAPODAMT*SEQ,APODAMT
           CALL     UFMFP000           * update period summary file
.
           RETURN
.----------------------------------------------------------------------
. Update period summary file
.----------------------------------------------------------------------
UFMFP000  PACK      KEY2,APODLED,SP70
          CALL      RDFMLA1
          BRANCH    OVRCD,UFMFP999
.
          PACK      KEY14,APODLED,APODACC,SP70
          CALL      RDFMAM1
          BRANCH    OVRCD,UFMFP999
.
          PACK      WORKDATE,APCIDAT,SP70
          CALL      CFYR0000
          BRANCH    EXIT,UFMFP999
.
          MOVE      "fmsp",KEY4
          PACK      KEY8,KEY4,CURYEAR,SP70
          REP       " 0",CURYEAR
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      FMSFPSA1,KEY8
          TRAPCLR   IO
          BRANCH    OVRCD,UFMFP999
.
          PACK      KEY14,APODLED,APODACC,SP70
          UNPACK    KEY14,FMFPCULD,FMFPCUAC
          CALL      RDFMFP1
          IF        OVRCD=0
            ASSIGN    APODAMT+FMFPCOM,FMFPCOM
            MOVE      FMFPCOM,FMFPCOMD
            ASSIGN    FMFPCOM/1000,F12P2
            MOVE      F12P2,FMFPCOMT
            CALL      UPFMFP1
          ELSE
            MOVE      ZERO,FMFPCBF
            MOVE      ZERO,FMFPC01
            MOVE      ZERO,FMFPC02
            MOVE      ZERO,FMFPC03
            MOVE      ZERO,FMFPC04
            MOVE      ZERO,FMFPC05
            MOVE      ZERO,FMFPC06
            MOVE      ZERO,FMFPC07
            MOVE      ZERO,FMFPC08
            MOVE      ZERO,FMFPC09
            MOVE      ZERO,FMFPC10
            MOVE      ZERO,FMFPC11
            MOVE      ZERO,FMFPC12
            MOVE      ZERO,FMFPC13
.
            MOVE      ZERO,FMFPABF
            MOVE      ZERO,FMFPA01
            MOVE      ZERO,FMFPA02
            MOVE      ZERO,FMFPA03
            MOVE      ZERO,FMFPA04
            MOVE      ZERO,FMFPA05
            MOVE      ZERO,FMFPA06
            MOVE      ZERO,FMFPA07
            MOVE      ZERO,FMFPA08
            MOVE      ZERO,FMFPA09
            MOVE      ZERO,FMFPA10
            MOVE      ZERO,FMFPA11
            MOVE      ZERO,FMFPA12
            MOVE      ZERO,FMFPA13
.
            MOVE      ZERO,FMFPCBFD
            MOVE      ZERO,FMFPC01D
            MOVE      ZERO,FMFPC02D
            MOVE      ZERO,FMFPC03D
            MOVE      ZERO,FMFPC04D
            MOVE      ZERO,FMFPC05D
            MOVE      ZERO,FMFPC06D
            MOVE      ZERO,FMFPC07D
            MOVE      ZERO,FMFPC08D
            MOVE      ZERO,FMFPC09D
            MOVE      ZERO,FMFPC10D
            MOVE      ZERO,FMFPC11D
            MOVE      ZERO,FMFPC12D
            MOVE      ZERO,FMFPC13D
.
            MOVE      ZERO,FMFPABFD
            MOVE      ZERO,FMFPA01D
            MOVE      ZERO,FMFPA02D
            MOVE      ZERO,FMFPA03D
            MOVE      ZERO,FMFPA04D
            MOVE      ZERO,FMFPA05D
            MOVE      ZERO,FMFPA06D
            MOVE      ZERO,FMFPA07D
            MOVE      ZERO,FMFPA08D
            MOVE      ZERO,FMFPA09D
            MOVE      ZERO,FMFPA10D
            MOVE      ZERO,FMFPA11D
            MOVE      ZERO,FMFPA12D
            MOVE      ZERO,FMFPA13D
.
            MOVE      ZERO,FMFPCBFT
            MOVE      ZERO,FMFPC01T
            MOVE      ZERO,FMFPC02T
            MOVE      ZERO,FMFPC03T
            MOVE      ZERO,FMFPC04T
            MOVE      ZERO,FMFPC05T
            MOVE      ZERO,FMFPC06T
            MOVE      ZERO,FMFPC07T
            MOVE      ZERO,FMFPC08T
            MOVE      ZERO,FMFPC09T
            MOVE      ZERO,FMFPC10T
            MOVE      ZERO,FMFPC11T
            MOVE      ZERO,FMFPC12T
            MOVE      ZERO,FMFPC13T
.
            MOVE      ZERO,FMFPABFT
            MOVE      ZERO,FMFPA01T
            MOVE      ZERO,FMFPA02T
            MOVE      ZERO,FMFPA03T
            MOVE      ZERO,FMFPA04T
            MOVE      ZERO,FMFPA05T
            MOVE      ZERO,FMFPA06T
            MOVE      ZERO,FMFPA07T
            MOVE      ZERO,FMFPA08T
            MOVE      ZERO,FMFPA09T
            MOVE      ZERO,FMFPA10T
            MOVE      ZERO,FMFPA11T
            MOVE      ZERO,FMFPA12T
            MOVE      ZERO,FMFPA13T
.
            PACK      FMFPSPAR,SP70,SP70
            ASSIGN    APODAMT,FMFPCOM
            MOVE      FMFPCOM,FMFPCOMD
            ASSIGN    FMFPCOM/1000,F12P2
            MOVE      F12P2,FMFPCOMT
            CALL      WRFMFP1
          ENDIF
.
          COMPARE   ONE,FMCOCALC
          GOTO      UFMFP999 IF NOT EQUAL
.
          PACK      KEY20,PORT,CURYEAR,APODLED,APODACC,SP70
          CALL      RDFMTU1            * record exists ?
          COMPARE   ZERO,OVRCD
          GOTO      UFMFP999 IF EQUAL
.
          UNPACK    KEY20,FMTUPORT,FMTUSPEC,FMTUTLED,FMTUTACC
          MOVE      FMAMCLEV,FMTULEV
          MOVE      ZERO,FMTUACT
          MOVE      ZERO,FMTUBUD
          MOVE      SP70,FMTUSPAR
          CALL      WRFMTU1            * Flag For Total Account Update
.
UFMFP999  RETURN
DAPOD000  PACK      KEY14,APODISC,APODORD,APODCAT
          CALL      RDAPOD1
          IF        OVRCD=0
            CALL      DEAPOD1
            MULT      SEQ,APODAMT
            CALL      UFMFP000
          ENDIF
.
          PACK      KEY8,APODISC,APODORD,SP70
          PACK      KEY14,KEY8,SP70
          UNPACK    SP70,APODISC,APODORD
          CALL      RSAPOD1
          CALL      RKAPOD1
          PACK      KEY14,APODISC,APODORD,APODCAT,SP70
          MATCH     KEY14,KEY8
          IF        !@EQUAL
            CALL      DEAPCI1
          ENDIF
.
          RETURN
EORDI000  CLOSE     CONTROLF                     * open control file
          CLEAR     KEY80
          APPEND    APISDIR,KEY80
          APPEND    "controlf.txt",KEY80
          RESET     KEY80
          SQUEEZE   KEY80
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CONTROLF,KEY80               * inventory controlf exists ?
          TRAPCLR   IO
          IF        OVRCD=1
            OPEN      CONTROLF,"controlf"
            READ      CONTROLF,SIXTY3;*85,INCOSTYP
          ELSE
            READ      CONTROLF,SIXTY3;*85,INCOSTYP
            CLOSE     CONTROLF
            OPEN      CONTROLF,"controlf"
          ENDIF
.
          PACK      APODISC,APCIISC,SP70
          PACK      APODORD,APCIORD,SP70
          BRANCH    INCOSTYP,EORDI500
.
          CALL      KAPODA00
          MOVE      APODCAT,ORDITEM
          GOTO      EORDI900
.
EORDI500  CALL      EAPODB00
          UNPACK    APODCAT,KEY3,KEY2
          PACK      ORDITEM,KEY3,SLASH,KEY2
.
EORDI900  MOVE      APODLED,SAPODLED        * save old data
          MOVE      APODACC,SAPODACC
          MOVE      APODAMT,SAPODAMT
          LOAD      SAPODAMT,EXIT,ZERO,ZERO
          MOVE      EXIT,ACCEPT
.
EORDI999  RETURN
.
EAPODB00 TOPIC     "APODCAT "
          MOVE      UNDLN70,KEY3
          KEYIN     *PCCOL:CVERT,*DV,KEY3:
                    *PCCOL:CVERT,*V2LON,*JR,KEY3
.
          ENDSET    KEY3
          APPEND    SP70,KEY3
          RESET     KEY3
.
          MATCH     SP70,KEY3
          GOTO      EAPODB90 IF EQUAL
.
          ENDSET    KEY3
          CMATCH    EXITCHAR,KEY3
          GOTO      EAPODB95 IF EQUAL
.
          CMATCH    QUEST,KEY3
          GOTO      EAPODB10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HAPODA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    APODCAT
          APPEND    SP70,APODCAT
          RESET     APODCAT
.
          MATCH     SP70,APODCAT
          GOTO      EAPODB00 IF EQUAL
          UNPACK    APODCAT,KEY3,KEY2
          DISPLAY   *PCCOL:CVERT,*V2LON,KEY3,"/",KEY2
          GOTO      EAPODB60
.
EAPODB10  MOVE      UNDLN70,KEY2
          RESET     KEY3
          KEYIN     *PCCOL:CVERT,*V2LON,*DV,KEY3,"/",*DV,KEY2:
                    *PCCOL:CVERT,*DV,KEY3,"/",*JR,KEY2:
                    *PCCOL:CVERT,*DV,KEY3,"/",*DV,KEY2
          ENDSET    KEY2
          APPEND    SP70,KEY2
          RESET     KEY2
.
          MATCH     SP70,KEY2
          GOTO      EAPODB00 IF EQUAL
.
          ENDSET    KEY2
          CMATCH    EXITCHAR,KEY2
          GOTO      EAPODB95 IF EQUAL
.
          CMATCH    QUEST,KEY2
          GOTO      EAPODB60 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HAPODA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    APODCAT
          APPEND    SP70,APODCAT
          RESET     APODCAT
.
          MATCH     SP70,APODCAT
          GOTO      EAPODB10 IF EQUAL
.
          UNPACK    APODCAT,KEY3,KEY2
          DISPLAY   *PCCOL:CVERT,*V2LON,KEY3,"/",KEY2
.
EAPODB60  RESET     KEY2
          PACK      APODCAT,KEY3,KEY2,SP70
          PACK      KEY14,APODISC,APODORD,APODCAT,SP70
          CALL      RAAPOD1
          BRANCH    OVRCD,EAPODB80
          BRANCH    CKEYTYP,EAPODB75
          CALL      RDAPOD1
.
EAPODB70  MOVE      ZERO,EXIT
          GOTO      EAPODB99
.
EAPODB75  MOVE      "Item Already Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      EAPODB00
.
EAPODB80  MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,EAPODB99,EAPODB99
          MOVE      "Item Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      EAPODB00
.
EAPODB90  MOVE      ONE,EXIT
          GOTO      EAPODB99
.
EAPODB95  MOVE      TWO,EXIT
.
EAPODB99  TOPIC    PRGID
          RETURN
ECOST000  MOVE     APODUCT,F12P4
          KEYIN    *PCCOL:CVERT,*EL,*V2LON,*RV,F12P4
          MOVE     F12P4,APODUCT
          IF       F12P4<0
            BEEP
            GOTO     ECOST000
          ENDIF
.
          CALL      CALTAX00
          MOVE      ZERO,F12P4
          ASSIGN    APODUGS*APODQTY,F12P4
          MOVE      F12P4,APODGSTA
          MOVE      ZERO,F12P4
          ASSIGN    APODUCT*APODQTY,F12P4
          MOVE      F12P4,APODAMT
.
ECOST999  RETURN
.
CALTAX00  COMPARE   ZERO,APODUCT
          GOTO      CALTAX90 IF EQUAL
.
          MATCH     SP6,APODGST
          GOTO      CALTAX90 IF EQUAL
.
          PACK      KEY8,CCC,CYY,CMM,CDD,SP70
          REP       " 0",KEY8
.
          PACK      KEY14,APODGST,KEY8,SP70
          CALL      RDIBGE1
          COMPARE   ZERO,OVRCD
          GOTO      CALTAX10 IF EQUAL
.
          CALL      RPIBGE1
          BRANCH    OVRCD,CALTAX90
.
          MATCH     APODGST,IBGECODE
          GOTO      CALTAX90 IF NOT EQUAL
.
CALTAX10  ASSIGN    (APODUCT-(APODUCT/(ONE+(IBGEAMNT/HUNDRED)))),APODUGS
          GOTO      CALTAX99
.
CALTAX90  MOVE      ZERO,APODUGS
.
CALTAX99  RETURN
ERECQ000  MOVE       SP70,VAR
          CALL       DISPITEM
          MOVE       APODQTY,WHOLEQTY
          KEYIN      *PCCOL:CVERT,*V2LON,*MASK,*RV,WHOLEQTY
          COMPARE    ZERO,WHOLEQTY
          GOTO       ERECQ100 IF NOT LESS
.
          BEEP
          MOVE       "Quantity must not be Negative - ",DISPMSG
          CALL       MESSAGE1
          GOTO       ERECQ000
.
ERECQ100  MOVE       WHOLEQTY,APODQTY
.
          CALL      CALTAX00
          MOVE      ZERO,F12P4
          ASSIGN    APODUGS*APODQTY,F12P4
          MOVE      F12P4,APODGSTA
          MOVE      ZERO,F12P4
          ASSIGN    APODUCT*APODQTY,F12P4
          MOVE      F12P4,APODAMT
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     APODAMT,VAR
            CALL     DISPITEM
          ENDIF
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     APODUGS,VAR
            CALL     DISPITEM
          ENDIF
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     APODGSTA,VAR
            CALL     DISPITEM
          ENDIF
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          MOVE      ZERO,EXIT
.
ERECQ999  RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSCIOIO/INC
          INC       APSCIOKY    
          INC       APSCKIKY    
          INC       APSISLIO/INC
          INC       APSISLKY    
          INC       APSMASIO/INC
          INC       APSMASKY    
          INC       APSMXRIO/INC
          INC       APSORDIO/INC
          INC       APSORDKY    
          INC       FMSAMAIO/INC
          INC       FMSAMAKY    
          INC       FMSCONIO/INC
          INC       FMSCSAIO/INC
          INC       FMSDISIO/INC
          INC       FMSDISKY    
          INC       FMSFPSIO/INC
          INC       FMSLMAIO/INC
          INC       FMSLMAKY    
          INC       FMSLMCIO/INC
          INC       FMSLMCKY    
          INC       FMSRESIO/INC
          INC       FMSRESKY    
          INC       FMSTUPIO/INC
          INC       IBAGEDIO/INC
          INC       IBAGSTIO/INC
.
          INC       STDGENCD
.
