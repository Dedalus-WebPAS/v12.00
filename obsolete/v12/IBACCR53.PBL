.---------------------------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  04.07.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from r5.09
.---------------------------------------------------------------------------
. V5.09.01  08/08/2001  Davin
.           Recompiled for change to CCSEPSFD
.---------------------------------------------------------------------------
. V5.04.02  28.07.1996 B.G.Ackland
.           New Fields for Southern Health
. V5.04.01  11.02.1996 B.G.Ackland
.           Extend Episode file.
. V6.00.07  16.12.1993 B.G.Ackland
.           Change Day Cases
. V6.00.06  01.11.1993 B.G.Ackland
.           Change "Procedure" to Patient Service
. V6.00.05  13.07.1993 B.G.Ackland
.           Extend Episode file.
.---------------------------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACCR53
.   Function      :   Casemix Extract Resource Usage Enquiries
.   Generated  On :   04/07/2002
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CCR57TMP    
          INC       CCSCEAFD/INC
          INC       CCSCEBFD/INC
          INC       CCSCECFD/INC
          INC       CCSCEDFD/INC
          INC       CCSCEEFD/INC
          INC       CCSCEFFD/INC
          INC       CCSCEGFD/INC
          INC       CCSCMAFD/INC
          INC       CCSDPTFD/INC
          INC       CCSEPSFD/INC
          INC       CCSHCDFD/INC
          INC       CCSMSCFD/INC
          INC       CCSMTSFD/INC
          INC       CCSPDPFD/INC
          INC       CCSSTYFD/INC
          INC       CCSUPDFD/INC
          INC       CCSXHDFD/INC
          INC       GPHHISDF    
          INC       GPHSTDDF    
.=========================
.Local Variable Definition
.-------------------------
FROMDD    DIM      10 * Scr 00 Fld    15
TODD      DIM      10 * Scr 00 Fld    16
FROMAD    DIM      10 * Scr 00 Fld    17
TOAD      DIM      10 * Scr 00 Fld    18
VISITDES  DIM      15 * Scr 00 Fld    19
FROMCMOD  DIM      35 * Scr 00 Fld    21
TOCMOD    DIM      35 * Scr 00 Fld    22
CLV1DES   DIM      35 * Scr 00 Fld    23
CLV2DES   DIM      35 * Scr 00 Fld    24
CLV3DES   DIM      35 * Scr 00 Fld    25
DAYCDESC  DIM      25 * Scr 00 Fld    29
.
.    Multi Item Key Fields Scr 00 Fld    31
.-------------------------------------------------------
CCXH1NAM  INIT      "CCXH1"
CCXH1END  FORM      1   * End Display
CCXH1SNO  FORM      5   * Number of Items on the Screen
CCXH1MKY  DIM       127 * Match Key 
CCXH1EKY  DIM       127 * End Key
CCXH1SKY  DIM       127 * Start Key
CCXH1IDX  INIT      " 132 UC1-5"
CCXH1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCXH1FNM  DIM       8  * Filename
CCXH1CNT  FORM      3  * Number of Items on Screen
LEV1DESC  DIM      40 * Scr 00 Fld    31
FRCXBAR   FORM     12.2 * Scr 00 Fld    45
FRCSDEV   FORM     12.2 * Scr 00 Fld    46
FRCRANG   FORM     12.2 * Scr 00 Fld    47
TOCXBAR   FORM     12.2 * Scr 00 Fld    48
TOCSDEV   FORM     12.2 * Scr 00 Fld    49
TOCRANG   FORM     12.2 * Scr 00 Fld    50
LOSXBAR   FORM     12.2 * Scr 00 Fld    51
LOSSDEV   FORM     12.2 * Scr 00 Fld    52
LOSRANG   FORM     12.2 * Scr 00 Fld    53
HISTTYPE  FORM      1 * Scr 01 Fld    33
.
.    Multi Item Key Fields Scr DA Fld     5
.-------------------------------------------------------
CCEF1NAM  INIT      "CCEF1"
CCEF1END  FORM      1   * End Display
CCEF1SNO  FORM      5   * Number of Items on the Screen
CCEF1MKY  DIM       127 * Match Key 
CCEF1EKY  DIM       127 * End Key
CCEF1SKY  DIM       127 * Start Key
CCEF1IDX  INIT      " 132 UC1-5"
CCEF1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCEF1FNM  DIM       8  * Filename
CCEF1CNT  FORM      3  * Number of Items on Screen
AVGPRO1   FORM     12.2 * Scr DA Fld    12
AVGEPS1   FORM     12.2 * Scr DA Fld    13
AVGLOS1   FORM     12.2 * Scr DA Fld    14
AVGPRO2   FORM     12.2 * Scr DA Fld    15
AVGEPS2   FORM     12.2 * Scr DA Fld    16
AVGLOS2   FORM     12.2 * Scr DA Fld    17
AVGPRO    FORM     12.2 * Scr DA Fld    18
TOTPER1   FORM     12.2 * Scr DA Fld    19
TOTPER2   FORM     12.2 * Scr DA Fld    20
.
.    Multi Item Key Fields Scr E1 Fld     3
.-------------------------------------------------------
CCEC2NAM  INIT      "CCEC2"
CCEC2END  FORM      1   * End Display
CCEC2SNO  FORM      5   * Number of Items on the Screen
CCEC2MKY  DIM       127 * Match Key 
CCEC2EKY  DIM       127 * End Key
CCEC2SKY  DIM       127 * Start Key
CCEC2IDX  INIT      " 132 UC1-5"
CCEC2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCEC2FNM  DIM       8  * Filename
CCEC2CNT  FORM      3  * Number of Items on Screen
DESC01    DIM      35 * Scr ES Fld    61
DESC02    DIM      35 * Scr ES Fld    62
DESC03    DIM      35 * Scr ES Fld    63
.
.    Multi Item Key Fields Scr ES Fld    70
.-------------------------------------------------------
CCUP2NAM  INIT      "CCUP2"
CCUP2END  FORM      1   * End Display
CCUP2SNO  FORM      5   * Number of Items on the Screen
CCUP2MKY  DIM       127 * Match Key 
CCUP2EKY  DIM       127 * End Key
CCUP2SKY  DIM       127 * Start Key
CCUP2IDX  INIT      " 132 UC1-5"
CCUP2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCUP2FNM  DIM       8  * Filename
CCUP2CNT  FORM      3  * Number of Items on Screen
COST1AMT  FORM     12.2 * Scr ES Fld    85
COST2AMT  FORM     12.2 * Scr ES Fld    86
GRAPHLEV  FORM      1 * Scr GO Fld     3
GPHLTO    FORM      1 * Scr GO Fld     5
GPHLAV    FORM      1 * Scr GO Fld     6
GPHLMN    FORM      1 * Scr GO Fld     7
GPHLMX    FORM      1 * Scr GO Fld     8
GPHFTO    FORM      1 * Scr GO Fld     9
GPHFAV    FORM      1 * Scr GO Fld    10
GPHFMN    FORM      1 * Scr GO Fld    11
GPHFMX    FORM      1 * Scr GO Fld    12
GPHTTO    FORM      1 * Scr GO Fld    13
GPHTAV    FORM      1 * Scr GO Fld    14
GPHTMN    FORM      1 * Scr GO Fld    15
GPHTMX    FORM      1 * Scr GO Fld    16
GPHEPS    FORM      1 * Scr GO Fld    17
.
.    Multi Item Key Fields Scr PA Fld     4
.-------------------------------------------------------
CCEG1NAM  INIT      "CCEG1"
CCEG1END  FORM      1   * End Display
CCEG1SNO  FORM      5   * Number of Items on the Screen
CCEG1MKY  DIM       127 * Match Key 
CCEG1EKY  DIM       127 * End Key
CCEG1SKY  DIM       127 * Start Key
CCEG1IDX  INIT      " 132 UC1-5"
CCEG1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCEG1FNM  DIM       8  * Filename
CCEG1CNT  FORM      3  * Number of Items on Screen
PAVGPRO1  FORM     12.2 * Scr PA Fld    14
PAVGEPS1  FORM     12.2 * Scr PA Fld    15
PAVGLOS1  FORM     12.2 * Scr PA Fld    16
PAVGPRO2  FORM     12.2 * Scr PA Fld    17
PAVGEPS2  FORM     12.2 * Scr PA Fld    18
PAVGLOS2  FORM     12.2 * Scr PA Fld    19
PAVGPRO   FORM     12.2 * Scr PA Fld    20
PTOTPER1  FORM     12.2 * Scr PA Fld    21
PTOTPER2  FORM     12.2 * Scr PA Fld    22
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACCR53"
PRGNAM    INIT      "Casemix Extract Resource Usage Enquiries"
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CLOSE     CCXH1FL1,DELETE
.
          CLOSE     CCEF1FL1,DELETE
.
          CLOSE     CCEC2FL1,DELETE
.
          CLOSE     CCEG1FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   64",AUDTSECT
          MOVE      " 37",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ccsaudep";
            OPEN      CCSAUDEP,"ccsaudep"
          ENDIF
          DISPLAY   *P56:24,"Opening ccsceaaf";
          OPEN      CCSCEAA1,"ccsceaaf"
          DISPLAY   *P56:24,"Opening ccscmaaf";
          OPEN      CCSCMAA1,"ccscmaaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA1,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA2,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA3,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA4,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA1,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA2,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA3,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA4,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA5,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccshcdaf";
          OPEN      CCSHCDA1,"ccshcdaf"
          DISPLAY   *P56:24,"Opening ccshcdaf";
          OPEN      CCSHCDA2,"ccshcdaf"
          DISPLAY   *P56:24,"Opening ccsmscaf";
          OPEN      CCSMSCA1,"ccsmscaf"
          DISPLAY   *P56:24,"Opening ccsmtsaf";
          OPEN      CCSMTSA1,"ccsmtsaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA1,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA2,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA3,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA4,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccsstyaf";
          OPEN      CCSSTYA1,"ccsstyaf"
          DISPLAY   *P56:24,"Opening ccsupdaf";
          OPEN      CCSUPDA1,"ccsupdaf"
          DISPLAY   *P56:24,"Opening ccsupdaf";
          OPEN      CCSUPDA2,"ccsupdaf"
          DISPLAY   *P56:24,"Opening ccsupdaf";
          OPEN      CCSUPDA3,"ccsupdaf"
          DISPLAY   *P56:24,"Opening ccsupdaf";
          OPEN      CCSUPDA4,"ccsupdaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA1,"ccsxhdaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA2,"ccsxhdaf"
.--------------------------------------------------------
. Initialise Batch Screen Level 1 Code & Key                 
.--------------------------------------------------------
          MOVE     ZERO,CCXH1SNO
          MOVE     "00   31",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCXH1SNO
            ENDIF
          ENDIF
          PACK      CCXH1FNM,ANST,CCXH1NAM,PORT
          REP       " 0",CCXH1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCXH1FL1,CCXH1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CCXH1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CCXH1FNM,CCXH1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",CCXH1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      CCXH1FL1,CCXH1FNM
.--------------------------------------------------------
. Initialise Batch Screen Department                         
.--------------------------------------------------------
          MOVE     ZERO,CCEF1SNO
          MOVE     "DA    5",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCEF1SNO
            ENDIF
          ENDIF
          PACK      CCEF1FNM,ANST,CCEF1NAM,PORT
          REP       " 0",CCEF1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCEF1FL1,CCEF1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CCEF1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CCEF1FNM,CCEF1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",CCEF1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      CCEF1FL1,CCEF1FNM
.--------------------------------------------------------
. Initialise Batch Screen Episode                            
.--------------------------------------------------------
          MOVE     ZERO,CCEC2SNO
          MOVE     "E1    3",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCEC2SNO
            ENDIF
          ENDIF
          PACK      CCEC2FNM,ANST,CCEC2NAM,PORT
          REP       " 0",CCEC2FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCEC2FL1,CCEC2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CCEC2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CCEC2FNM,CCEC2IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",CCEC2FNM;
          EXECUTE   KEY80,TASKID
          OPEN      CCEC2FL1,CCEC2FNM
.--------------------------------------------------------
. Initialise Batch Screen Date of Service                    
.--------------------------------------------------------
          MOVE     ZERO,CCUP2SNO
          MOVE     "ES   70",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCUP2SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Patient Service Line Key           
.--------------------------------------------------------
          MOVE     ZERO,CCEG1SNO
          MOVE     "PA    4",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCEG1SNO
            ENDIF
          ENDIF
          PACK      CCEG1FNM,ANST,CCEG1NAM,PORT
          REP       " 0",CCEG1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCEG1FL1,CCEG1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CCEG1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CCEG1FNM,CCEG1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",CCEG1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      CCEG1FL1,CCEG1FNM
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Casemix Level 1 Summary            
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Casemix Level 1 Detail             
          ENDIF
          MATCH     "DA",SCRID
          IF         @EQUAL
            CALL       PSDAL000   * Department Analysis                
          ENDIF
          MATCH     "E1",SCRID
          IF         @EQUAL
            CALL       PSE1L000   * Episodes at Level 1                
          ENDIF
          MATCH     "ED",SCRID
          IF         @EQUAL
            CALL       PSEDL000   * Epiosde Details                    
          ENDIF
          MATCH     "ES",SCRID
          IF         @EQUAL
            CALL       PSESL000   * Episode Summary                    
          ENDIF
          MATCH     "GO",SCRID
          IF         @EQUAL
            CALL       PSGOL000   * Graph Options                      
          ENDIF
          MATCH     "PA",SCRID
          IF         @EQUAL
            CALL       PSPAL000   * Patient Service Analysis           
          ENDIF
          MATCH     "PB",SCRID
          IF         @EQUAL
            CALL       PSPBL000   * Patient Service Details            
          ENDIF
          MATCH     "PD",SCRID
          IF         @EQUAL
            CALL       PSPDL000   * Patient Service Detail Display     
          ENDIF
          MATCH     "SD",SCRID
          IF         @EQUAL
            CALL       PSSDL000   * Select Department Details          
          ENDIF
          RETURN
.--------------------------------
. Screen - Casemix Level 1 Summary            
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Casemix Level 1 Summary            
.-------------------------------------------------------
CF00L000
          MOVE      SP70,CCEAEID 
          MOVE      SP70,CCEADES 
          MOVE      SP70,CCEAINC 
          MOVE      SP70,CCEAVIS 
          MOVE      SP70,CCEADAY 
          MOVE      SP70,CCEALV1 
          MOVE      SP70,CCEALV2 
          MOVE      SP70,CCEALV3 
          MOVE      SP70,CCEAFCM 
          MOVE      SP70,CCEAFYR 
          MOVE      SP70,CCEATCM 
          MOVE      SP70,CCEATYR 
          MOVE      SP70,FROMDD  
          MOVE      SP70,TODD    
          MOVE      SP70,FROMAD  
          MOVE      SP70,TOAD    
          MOVE      SP70,VISITDES
          MOVE      SP70,CCHCDES 
          MOVE      SP70,FROMCMOD
          MOVE      SP70,TOCMOD  
          MOVE      SP70,CLV1DES 
          MOVE      SP70,CLV2DES 
          MOVE      SP70,CLV3DES 
          MOVE      SP70,CCEAHCD 
          MOVE      SP70,DAYCDESC
          MOVE      SP70,LEV1DESC
          MOVE      ZERO,CCEBNEP 
          MOVE      ZERO,CCEBFTC 
          MOVE      ZERO,CCEBFMN 
          MOVE      ZERO,CCEBFMX 
          MOVE      ZERO,CCEBFSV 
          MOVE      ZERO,CCEBTTC 
          MOVE      ZERO,CCEBTMN 
          MOVE      ZERO,CCEBTMX 
          MOVE      ZERO,CCEBTSV 
          MOVE      ZERO,CCEBLTO 
          MOVE      ZERO,CCEBLMN 
          MOVE      ZERO,CCEBLMX 
          MOVE      ZERO,CCEBLSV 
          MOVE      ZERO,FRCXBAR 
          MOVE      ZERO,FRCSDEV 
          MOVE      ZERO,FRCRANG 
          MOVE      ZERO,TOCXBAR 
          MOVE      ZERO,TOCSDEV 
          MOVE      ZERO,TOCRANG 
          MOVE      ZERO,LOSXBAR 
          MOVE      ZERO,LOSSDEV 
          MOVE      ZERO,LOSRANG 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Casemix Level 1 Summary            
.--------------------------------------------------------
KY00L000
.
KY00L110
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEAINC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEAVIS 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEADAY 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEALV1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEALV2 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEALV3 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEAFCM 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEAFYR 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEATCM 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEATYR 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROMDD  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TODD    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROMAD  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOAD    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,VISITDES
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCHCDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROMCMOD
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCMOD  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CLV1DES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CLV2DES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CLV3DES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEAHCD 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DAYCDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EEID0000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      CCEAEID,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEADES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      CCEAINC,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEAVIS,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEADAY,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEALV1,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEALV2,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEALV3,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEAFCM,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEAFYR,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEATCM,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEATYR,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROMDD,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TODD,VAR         
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROMAD,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOAD,VAR         
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VISITDES,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCHCDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROMCMOD,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCMOD,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CLV1DES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CLV2DES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CLV3DES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEAHCD,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DAYCDESC,VAR     
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Casemix Level 1 Summary            
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Casemix Level 1 Summary            
.---------------------------------------------------------
LM00L000
.---------------------------------------------------------
. Load for :    31 Level 1 Code & Key                 
.---------------------------------------------------------
          PACK      KEY13,CCEALV1,SP70
          MOVE      KEY13,CCXH1EKY
          MOVE      CCXH1EKY,CCXH1SKY
          STRIP     CCXH1SKY
          SETLPTR   CCXH1EKY,3
          CALL      RDCCXH1 
          IF        OVRCD=0
            CALL      RPCCXH1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP00L000
          MOVE     ZERO,CCXH1CNT
          MOVE     ZERO,CCXH1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP00L600
          MATCH    PRGID,SCPSPID
          GOTO     DP00L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP00L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP00L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L101,DP00L102:
                            DP00L103,DP00L104,DP00L105,DP00L106:
                            DP00L107,DP00L108,DP00L109,DP00L110:
                            DP00L111,DP00L112,DP00L113,DP00L114:
                            DP00L115,DP00L116,DP00L117,DP00L118:
                            DP00L119,DP00L120,DP00L121,DP00L122:
                            DP00L123,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010
          GOTO      DP00L010
.
DP00L101
          PACK      CCXH1MKY,SP70,SP70
          CALL      UPTCCXH1
          IF        CCXH1END=0
            CALL      RKCCXH1 
            IF        OVRCD=0
              PACK      CCXH1MKY,CCXHSTY,CCXHKEY                                                                
              MATCH     CCXH1EKY,CCXH1MKY
              IF        @EQUAL
                MOVE      ZERO,CCXH1END
                ADD       ONE,CCXH1CNT
                CALL      UPTCCXH1
          CALL      LV1DET00
                MOVE      LEV1DESC,VAR     
                CALL      DISPITEM
              ELSE
                MOVE      ONE,CCXH1END
              ENDIF
            ELSE
              MOVE      ONE,CCXH1END
            ENDIF
          ENDIF
          IF        CCXH1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L102
          IF        CCXH1END=0
            MOVE      CCEBNEP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L103
          IF        CCXH1END=0
            MOVE      CCEBFTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L104
          IF        CCXH1END=0
            MOVE      CCEBFMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L105
          IF        CCXH1END=0
            MOVE      CCEBFMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L106
          IF        CCXH1END=0
            MOVE      CCEBFSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L107
          IF        CCXH1END=0
            MOVE      CCEBTTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L108
          IF        CCXH1END=0
            MOVE      CCEBTMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L109
          IF        CCXH1END=0
            MOVE      CCEBTMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L110
          IF        CCXH1END=0
            MOVE      CCEBTSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L111
          IF        CCXH1END=0
            MOVE      CCEBLTO,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L112
          IF        CCXH1END=0
            MOVE      CCEBLMN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L113
          IF        CCXH1END=0
            MOVE      CCEBLMX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L114
          IF        CCXH1END=0
            MOVE      CCEBLSV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L115
          IF        CCXH1END=0
            MOVE      FRCXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L116
          IF        CCXH1END=0
            MOVE      FRCSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L117
          IF        CCXH1END=0
            MOVE      FRCRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L118
          IF        CCXH1END=0
            MOVE      TOCXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L119
          IF        CCXH1END=0
            MOVE      TOCSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L120
          IF        CCXH1END=0
            MOVE      TOCRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L121
          IF        CCXH1END=0
            MOVE      LOSXBAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L122
          IF        CCXH1END=0
            MOVE      LOSSDEV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L123
          IF        CCXH1END=0
            MOVE      LOSRANG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
DP00L600
          MATCH    "CCXH1",NAMSSFFI
          GOTO     DP00L605 IF NOT EQUAL
          GOTO     DP00L999
DP00L605
DP00L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP00L000
.
          MATCH    "CCXH1",NAMSSFFI
          GOTO     FP00L105 IF NOT EQUAL
          PACK     KEY13,CCXH1SKY,SP70
          CALL     RDCCXH1  * Start
          IF       OVRCD=0
            CALL     RPCCXH1  * Start
          ENDIF
          CALL     DP00L000
          GOTO     FP00L999
FP00L105
FP00L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP00L000
.
          MATCH    "CCXH1",NAMSSFFI
          GOTO     LP00L105 IF NOT EQUAL
          PACK     KEY13,CCXH1SKY,Z70
          CALL     RSCCXH1  * End
          IF       OVRCD=1
            CALL     RPCCXH1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCXH1SNO
            CALL     RPCCXH1 
            IF       OVRCD=1
              MOVE     CCXH1SNO,SECTOR
            ENDIF
            PACK     CCXH1MKY,CCXHSTY,CCXHKEY                                                                
            MATCH    CCXH1EKY,CCXH1MKY
            IF       !@EQUAL
              MOVE     CCXH1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP00L000
          GOTO     LP00L999
LP00L105
LP00L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP00L000
.
          MATCH    "CCXH1",NAMSSFFI
          GOTO     PP00L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP00L105
          CALL      RFTCCXH1
          BRANCH   OVRCD,PP00L115
          MOVE      CCXH1MKY,KEY13 
          CALL      RSCCXH1 
PP00L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCXH1SNO
            CALL     RPCCXH1 
            IF       OVRCD=1
              MOVE     CCXH1SNO,SECTOR
            ENDIF
            PACK     CCXH1MKY,CCXHSTY,CCXHKEY                                                                
            MATCH    CCXH1EKY,CCXH1MKY
            IF       !@EQUAL
              MOVE     CCXH1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP00L000
          GOTO     PP00L999
PP00L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCXH1SNO
            CALL     RKCCXH1 
            IF       OVRCD=1
              MOVE     CCXH1SNO,SECTOR
            ENDIF
            PACK     CCXH1MKY,CCXHSTY,CCXHKEY                                                                
            MATCH    CCXH1EKY,CCXH1MKY
            IF       !@EQUAL
              MOVE     CCXH1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP00L999
PP00L120
PP00L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP00L000
          MATCH    "CCXH1",NAMSSFFI
          GOTO     NP00L115 IF NOT EQUAL
NP00L105
          CALL     RKCCXH1 
          BRANCH   OVRCD,NP00L110
          PACK     CCXH1MKY,CCXHSTY,CCXHKEY                                                                
          MATCH    CCXH1EKY,CCXH1MKY
          GOTO     NP00L110 IF NOT EQUAL
          CALL     RPCCXH1 
          CALL     DP00L000
          GOTO     NP00L999
NP00L110
          CALL     RPCCXH1 
          BEEP
          GOTO     NP00L999
NP00L115
NP00L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT00L000
CT00L105
CT00L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Casemix Level 1 Summary            
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    31 Level 1 Code & Key                 
.---------------------------------------------------------
UPTCCXH1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCXH1FL1,KEY5;ANS
          IF        @OVER
            WRITE     CCXH1FL1,KEY5;SCPSROW,SCPSCOL,CCXH1MKY
          ELSE
            UPDATE    CCXH1FL1;SCPSROW,SCPSCOL,CCXH1MKY
          ENDIF
          RETURN
RDTCCXH1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCXH1FL1,KEY5;SCPSROW,SCPSCOL,CCXH1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTCCXH1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      CCXH1FL1,KEY5;;
          READKS    CCXH1FL1;SCPSROW,SCPSCOL,CCXH1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,CCXH1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Casemix Level 1 Summary            
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
          MOVE      "CCXH1",NAMSSFFI
          MOVE      "   31",ITMSSFFI
          CALL      FP00L000
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Casemix Level 1 Summary            
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L101:
                            PS00L102,PS00L103,PS00L104,PS00L105:
                            PS00L106,PS00L107,PS00L108,PS00L109:
                            PS00L110,PS00L111,PS00L112,PS00L113:
                            PS00L114,PS00L115,PS00L116,PS00L117:
                            PS00L118,PS00L119,PS00L120,PS00L121:
                            PS00L122,PS00L123,PS00L999,PS00L999:
                            PS00L124,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999
          GOTO     PS00L999
.
PS00L101
          MOVE      CCEADES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEAINC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      CCEAVIS,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      CCEADAY,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      CCEALV1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      CCEALV2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      CCEALV3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      CCEAFCM,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      CCEAFYR,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      CCEATCM,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      CCEATYR,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      FROMDD,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      TODD,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      FROMAD,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      TOAD,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      VISITDES,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          MOVE      CCHCDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      FROMCMOD,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      TOCMOD,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE      CLV1DES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          MOVE      CLV2DES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      CLV3DES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          MOVE      CCEAHCD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          MOVE      DAYCDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Casemix Level 1 Summary            
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L102,SF00L103:
                            SF00L006,SF00L006,SF00L104,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L105,SF00L106,SF00L107:
                            SF00L108,SF00L109
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L104,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          MOVE      "CCXH1",NAMSSFFI
          MOVE      "   31",ITMSSFFI
          CALL      FP00L000
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPH1LV00
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L104
          CALL      SELECTED
          BRANCH    EXIT,SF00L001
          COMPARE   ONE,ACCEPT
          GOTO      SF00L001 IF EQUAL
          CALL      RDTCCXH1
          IF        OVRCD=1
            BEEP
            GOTO      SF00L001
          ENDIF
          MATCH     SP70,CCXH1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF00L001
          ENDIF
          MOVE      CCXH1MKY,KEY13 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SEL1LV00
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCXH1
          IF        OVRCD=1
            CALL      FP00L000
          ELSE
            MOVE      CCXH1MKY,KEY13 
            CALL      RSCCXH1 
            CALL      RPCCXH1 
            CALL      DP00L000
          ENDIF
          GOTO     SF00L001
.
SF00L105
          MOVE      "CCXH1",NAMSSFFI
          MOVE      "   31",ITMSSFFI
          CALL      NP00L000
          GOTO     SF00L001
.
SF00L106
          MOVE      "CCXH1",NAMSSFFI
          MOVE      "   31",ITMSSFFI
          CALL      PP00L000
          GOTO     SF00L001
.
SF00L107
          MOVE      "CCXH1",NAMSSFFI
          MOVE      "   31",ITMSSFFI
          CALL      FP00L000
          GOTO     SF00L001
.
SF00L108
          MOVE      "CCXH1",NAMSSFFI
          MOVE      "   31",ITMSSFFI
          CALL      LP00L000
          GOTO     SF00L001
.
SF00L109
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SELCM000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF00L000
          GOTO      SF00L001
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.--------------------------------
. Screen - Casemix Level 1 Detail             
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 3",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Casemix Level 1 Detail             
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Casemix Level 1 Detail             
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Casemix Level 1 Detail             
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Casemix Level 1 Detail             
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Casemix Level 1 Detail             
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Casemix Level 1 Detail             
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L101,PS01L102:
                            PS01L103,PS01L104,PS01L105,PS01L106:
                            PS01L107,PS01L108,PS01L109,PS01L110:
                            PS01L111,PS01L112,PS01L113,PS01L114:
                            PS01L115,PS01L116,PS01L117,PS01L118:
                            PS01L119,PS01L120,PS01L121,PS01L122:
                            PS01L123,PS01L124,PS01L125,PS01L126:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L127,PS01L999,PS01L999
          GOTO     PS01L999
.
PS01L101
          MOVE      CLV1DES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      CCXHKEY,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      CCXHDES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      CCEBNEP,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      CCEBFTC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      CCEBFMN,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      CCEBFMX,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      CCEBFSV,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      CCEBTTC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      CCEBTMN,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      CCEBTMX,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          MOVE      CCEBTSV,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          MOVE      CCEBLTO,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          MOVE      CCEBLMN,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          MOVE      CCEBLMX,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L116
          MOVE      CCEBLSV,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L117
          MOVE      FRCXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L118
          MOVE      FRCSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L119
          MOVE      FRCRANG,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L120
          MOVE      TOCXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L121
          MOVE      TOCSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L122
          MOVE      TOCRANG,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L123
          MOVE      LOSXBAR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L124
          MOVE      LOSSDEV,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L125
          MOVE      LOSRANG,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L126
          MOVE      CCEAHCD,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L127
          MOVE      HISTTYPE,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Casemix Level 1 Detail             
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L102,SF01L103,SF01L104,SF01L105:
                            SF01L006,SF01L106,SF01L107
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCDAL000
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF01L000
          GOTO      SF01L001
.
SF01L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCXHDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      KY01LV00
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCXHDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF01L000
          GOTO      SF01L001
.
SF01L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCE1L000
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF01L000
          GOTO      SF01L001
.
SF01L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      H1DP0000
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF01L001
.
SF01L106
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L107
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCPAL000
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF01L000
          GOTO      SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Department Analysis                
.--------------------------------
SCDAL000
SCDAL100
          MOVE      "DA",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "11",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCDAL200
          CALL      CFDAL000 * Clear Fields
SCDAL300
          CALL      KYDAL000 * Enter Key Fields
          BRANCH    EXIT,SCDAL999,SCDAL999
SCDAL400
          CALL      WPDAL000 * Load any WP Details
SCDAL500
          CALL      LMDAL000 * Load any Batch Details
SCDAL600
          CALL      DFDAL000 * Display Fields
SCDAL700
          CALL      SFDAL000 * Select Fields
          BRANCH    EXIT,SCDAL100,SCDAL100,SCDAL200
SCDAL800
SCDAL900
SCDAL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Department Analysis                
.-------------------------------------------------------
CFDAL000
CFDAL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Department Analysis                
.--------------------------------------------------------
KYDAL000
          MOVE      ZERO,EXIT
          GOTO      KYDAL999
.
KYDAL900  MOVE      ONE,EXIT
KYDAL999  RETURN
.---------------------------------------------------------
. Load WP files for : Department Analysis                
.---------------------------------------------------------
WPDAL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Department Analysis                
.---------------------------------------------------------
LMDAL000
.---------------------------------------------------------
. Load for :     5 Department                         
.---------------------------------------------------------
          PACK      KEY20,CCEBLV1,SP70
          MOVE      KEY20,CCEF1EKY
          MOVE      CCEF1EKY,CCEF1SKY
          STRIP     CCEF1SKY
          SETLPTR   CCEF1EKY,10
          CALL      RDCCEF1 
          IF        OVRCD=0
            CALL      RPCCEF1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPDAL000
          MOVE     ZERO,CCEF1CNT
          MOVE     ZERO,CCEF1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPDAL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPDAL600
          MATCH    PRGID,SCPSPID
          GOTO     DPDAL600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPDAL600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPDAL010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPDAL010,DPDAL010,DPDAL010,DPDAL010:
                           DPDAL101,DPDAL102,DPDAL103,DPDAL104:
                            DPDAL105,DPDAL106,DPDAL107,DPDAL108:
                            DPDAL109,DPDAL110,DPDAL111,DPDAL112:
                            DPDAL113,DPDAL114,DPDAL115,DPDAL116:
                            DPDAL010,DPDAL010,DPDAL010,DPDAL010
          GOTO      DPDAL010
.
DPDAL101
          PACK      CCEF1MKY,SP70,SP70
          CALL      UPTCCEF1
          IF        CCEF1END=0
            CALL      RKCCEF1 
            IF        OVRCD=0
              PACK      CCEF1MKY,CCEFLV1,CCEFHCD,CCEFDPT                                                        
              MATCH     CCEF1EKY,CCEF1MKY
              IF        @EQUAL
                MOVE      ZERO,CCEF1END
                ADD       ONE,CCEF1CNT
                CALL      UPTCCEF1
          CALL      GETDPT00
                MOVE      CCEFDPT,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,CCEF1END
              ENDIF
            ELSE
              MOVE      ONE,CCEF1END
            ENDIF
          ENDIF
          IF        CCEF1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL102
          IF        CCEF1END=0
            MOVE      CCEFHCD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL103
          IF        CCEF1END=0
            MOVE      CCEFQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL104
          IF        CCEF1END=0
            MOVE      CCEFFTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL105
          IF        CCEF1END=0
            MOVE      CCEFTTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL106
          IF        CCEF1END=0
            MOVE      CCHCDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL107
          IF        CCEF1END=0
            MOVE      CCDPDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL108
          IF        CCEF1END=0
            MOVE      AVGPRO1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL109
          IF        CCEF1END=0
            MOVE      AVGEPS1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL110
          IF        CCEF1END=0
            MOVE      AVGLOS1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL111
          IF        CCEF1END=0
            MOVE      AVGPRO2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL112
          IF        CCEF1END=0
            MOVE      AVGEPS2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL113
          IF        CCEF1END=0
            MOVE      AVGLOS2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL114
          IF        CCEF1END=0
            MOVE      AVGPRO,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL115
          IF        CCEF1END=0
            MOVE      TOTPER1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL116
          IF        CCEF1END=0
            MOVE      TOTPER2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
DPDAL600
          MATCH    "CCEF1",NAMSSFFI
          GOTO     DPDAL605 IF NOT EQUAL
          GOTO     DPDAL999
DPDAL605
DPDAL999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPDAL000
.
          MATCH    "CCEF1",NAMSSFFI
          GOTO     FPDAL105 IF NOT EQUAL
          PACK     KEY20,CCEF1SKY,SP70
          CALL     RDCCEF1  * Start
          IF       OVRCD=0
            CALL     RPCCEF1  * Start
          ENDIF
          CALL     DPDAL000
          GOTO     FPDAL999
FPDAL105
FPDAL999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPDAL000
.
          MATCH    "CCEF1",NAMSSFFI
          GOTO     LPDAL105 IF NOT EQUAL
          PACK     KEY20,CCEF1SKY,Z70
          CALL     RSCCEF1  * End
          IF       OVRCD=1
            CALL     RPCCEF1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEF1SNO
            CALL     RPCCEF1 
            IF       OVRCD=1
              MOVE     CCEF1SNO,SECTOR
            ENDIF
            PACK     CCEF1MKY,CCEFLV1,CCEFHCD,CCEFDPT                                                        
            MATCH    CCEF1EKY,CCEF1MKY
            IF       !@EQUAL
              MOVE     CCEF1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPDAL000
          GOTO     LPDAL999
LPDAL105
LPDAL999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPDAL000
.
          MATCH    "CCEF1",NAMSSFFI
          GOTO     PPDAL120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPDAL105
          CALL      RFTCCEF1
          BRANCH   OVRCD,PPDAL115
          MOVE      CCEF1MKY,KEY20 
          CALL      RSCCEF1 
PPDAL110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCEF1SNO
            CALL     RPCCEF1 
            IF       OVRCD=1
              MOVE     CCEF1SNO,SECTOR
            ENDIF
            PACK     CCEF1MKY,CCEFLV1,CCEFHCD,CCEFDPT                                                        
            MATCH    CCEF1EKY,CCEF1MKY
            IF       !@EQUAL
              MOVE     CCEF1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPDAL000
          GOTO     PPDAL999
PPDAL115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEF1SNO
            CALL     RKCCEF1 
            IF       OVRCD=1
              MOVE     CCEF1SNO,SECTOR
            ENDIF
            PACK     CCEF1MKY,CCEFLV1,CCEFHCD,CCEFDPT                                                        
            MATCH    CCEF1EKY,CCEF1MKY
            IF       !@EQUAL
              MOVE     CCEF1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPDAL999
PPDAL120
PPDAL999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPDAL000
          MATCH    "CCEF1",NAMSSFFI
          GOTO     NPDAL115 IF NOT EQUAL
NPDAL105
          CALL     RKCCEF1 
          BRANCH   OVRCD,NPDAL110
          PACK     CCEF1MKY,CCEFLV1,CCEFHCD,CCEFDPT                                                        
          MATCH    CCEF1EKY,CCEF1MKY
          GOTO     NPDAL110 IF NOT EQUAL
          CALL     RPCCEF1 
          CALL     DPDAL000
          GOTO     NPDAL999
NPDAL110
          CALL     RPCCEF1 
          BEEP
          GOTO     NPDAL999
NPDAL115
NPDAL999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTDAL000
CTDAL105
CTDAL999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Department Analysis                
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     5 Department                         
.---------------------------------------------------------
UPTCCEF1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCEF1FL1,KEY5;ANS
          IF        @OVER
            WRITE     CCEF1FL1,KEY5;SCPSROW,SCPSCOL,CCEF1MKY
          ELSE
            UPDATE    CCEF1FL1;SCPSROW,SCPSCOL,CCEF1MKY
          ENDIF
          RETURN
RDTCCEF1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCEF1FL1,KEY5;SCPSROW,SCPSCOL,CCEF1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTCCEF1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      CCEF1FL1,KEY5;;
          READKS    CCEF1FL1;SCPSROW,SCPSCOL,CCEF1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,CCEF1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Department Analysis                
.---------------------------------------------------------
DFDAL000
          BRANCH   ACCEPT,DFDAL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFDAL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFDAL900
          MATCH    PRGID,SCPSPID
          GOTO     DFDAL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFDAL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFDAL010 IF NOT EQUAL
.
          CALL     PSDAL000 * Display Field
          GOTO     DFDAL010
DFDAL900
          MOVE      "CCEF1",NAMSSFFI
          MOVE      "    5",ITMSSFFI
          CALL      FPDAL000
DFDAL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Department Analysis                
.---------------------------------------------------------
PSDAL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSDAL999,PSDAL999,PSDAL999,PSDAL999:
                           PSDAL999,PSDAL999,PSDAL999,PSDAL999:
                            PSDAL999,PSDAL999,PSDAL999,PSDAL999:
                            PSDAL999,PSDAL999,PSDAL999,PSDAL999:
                            PSDAL999,PSDAL999,PSDAL999,PSDAL999:
                            PSDAL999,PSDAL999,PSDAL999,PSDAL999
          GOTO     PSDAL999
PSDAL999
          RETURN
.---------------------------------------------------------
. Selections for : Department Analysis                
.---------------------------------------------------------
SFDAL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFDAL001  BRANCH   ACCEPT,SFDAL020
.
SFDAL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFDAL006,SFDAL101,SFDAL102,SFDAL006:
                           SFDAL103,SFDAL006,SFDAL006,SFDAL006:
                            SFDAL006,SFDAL006,SFDAL006,SFDAL006:
                            SFDAL006,SFDAL006,SFDAL006,SFDAL006:
                            SFDAL006,SFDAL006,SFDAL006,SFDAL006:
                            SFDAL104,SFDAL105,SFDAL106,SFDAL107
SFDAL006  BEEP
          GOTO     SFDAL005
SFDAL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFDAL090
          MATCH    PRGID,SCSLPID
          GOTO     SFDAL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFDAL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFDAL020,SFDAL020,SFDAL020,SFDAL020:
                           SFDAL103,SFDAL020,SFDAL020,SFDAL020:
                            SFDAL020,SFDAL020,SFDAL020,SFDAL020:
                            SFDAL020,SFDAL020,SFDAL020,SFDAL020:
                            SFDAL020,SFDAL020,SFDAL020,SFDAL020:
                            SFDAL020,SFDAL020,SFDAL020,SFDAL020
          GOTO     SFDAL020
SFDAL090  MOVE     ZERO,ACCEPT
          MOVE      "CCEF1",NAMSSFFI
          MOVE      "    5",ITMSSFFI
          CALL      FPDAL000
          GOTO     SFDAL001
.
SFDAL101
          MOVE      ZERO,EXIT
          GOTO      SFDAL999
.
SFDAL102
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFDAL999
.
SFDAL103
          CALL      SELECTED
          BRANCH    EXIT,SFDAL001
          COMPARE   ONE,ACCEPT
          GOTO      SFDAL001 IF EQUAL
          CALL      RDTCCEF1
          IF        OVRCD=1
            BEEP
            GOTO      SFDAL001
          ENDIF
          MATCH     SP70,CCEF1MKY
          IF        @EQUAL
            BEEP
            GOTO      SFDAL001
          ENDIF
          MOVE      CCEF1MKY,KEY20 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELDPT00
          MOVE      "DA",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCEF1
          IF        OVRCD=1
            CALL      FPDAL000
          ELSE
            MOVE      CCEF1MKY,KEY20 
            CALL      RSCCEF1 
            CALL      RPCCEF1 
            CALL      DPDAL000
          ENDIF
          GOTO     SFDAL001
.
SFDAL104
          MOVE      "CCEF1",NAMSSFFI
          MOVE      "    5",ITMSSFFI
          CALL      NPDAL000
          GOTO     SFDAL001
.
SFDAL105
          MOVE      "CCEF1",NAMSSFFI
          MOVE      "    5",ITMSSFFI
          CALL      PPDAL000
          GOTO     SFDAL001
.
SFDAL106
          MOVE      "CCEF1",NAMSSFFI
          MOVE      "    5",ITMSSFFI
          CALL      FPDAL000
          GOTO     SFDAL001
.
SFDAL107
          MOVE      "CCEF1",NAMSSFFI
          MOVE      "    5",ITMSSFFI
          CALL      LPDAL000
          GOTO     SFDAL001
SFDAL990  MOVE      ONE,EXIT * Exit Char Restart
SFDAL999  RETURN
.--------------------------------
. Screen - Episodes at Level 1                
.--------------------------------
SCE1L000
SCE1L100
          MOVE      "E1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "11",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCE1L200
          CALL      CFE1L000 * Clear Fields
SCE1L300
          CALL      KYE1L000 * Enter Key Fields
          BRANCH    EXIT,SCE1L999,SCE1L999
SCE1L400
          CALL      WPE1L000 * Load any WP Details
SCE1L500
          CALL      LME1L000 * Load any Batch Details
SCE1L600
          CALL      DFE1L000 * Display Fields
SCE1L700
          CALL      SFE1L000 * Select Fields
          BRANCH    EXIT,SCE1L100,SCE1L100,SCE1L200
SCE1L800
SCE1L900
SCE1L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Episodes at Level 1                
.-------------------------------------------------------
CFE1L000
CFE1L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Episodes at Level 1                
.--------------------------------------------------------
KYE1L000
          MOVE      ZERO,EXIT
          GOTO      KYE1L999
.
KYE1L900  MOVE      ONE,EXIT
KYE1L999  RETURN
.---------------------------------------------------------
. Load WP files for : Episodes at Level 1                
.---------------------------------------------------------
WPE1L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Episodes at Level 1                
.---------------------------------------------------------
LME1L000
.---------------------------------------------------------
. Load for :     3 Episode                            
.---------------------------------------------------------
          PACK      KEY48,CCEBLV1,SP70
          MOVE      KEY48,CCEC2EKY
          MOVE      CCEC2EKY,CCEC2SKY
          STRIP     CCEC2SKY
          SETLPTR   CCEC2EKY,10
          CALL      RDCCEC2 
          IF        OVRCD=0
            CALL      RPCCEC2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPE1L000
          MOVE     ZERO,CCEC2CNT
          MOVE     ZERO,CCEC2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPE1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPE1L600
          MATCH    PRGID,SCPSPID
          GOTO     DPE1L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPE1L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPE1L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPE1L010,DPE1L010,DPE1L101,DPE1L102:
                            DPE1L103,DPE1L104,DPE1L105,DPE1L106:
                            DPE1L107,DPE1L108,DPE1L010,DPE1L010:
                            DPE1L010,DPE1L010,DPE1L109,DPE1L110:
                            DPE1L111,DPE1L112,DPE1L113,DPE1L010
          GOTO      DPE1L010
.
DPE1L101
          PACK      CCEC2MKY,SP70,SP70
          CALL      UPTCCEC2
          IF        CCEC2END=0
            CALL      RKCCEC2 
            IF        OVRCD=0
              PACK      CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
              MATCH     CCEC2EKY,CCEC2MKY
              IF        @EQUAL
                MOVE      ZERO,CCEC2END
                ADD       ONE,CCEC2CNT
                CALL      UPTCCEC2
          CALL      GETEPS00
                MOVE      CCECEPS,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,CCEC2END
              ENDIF
            ELSE
              MOVE      ONE,CCEC2END
            ENDIF
          ENDIF
          IF        CCEC2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L102
          IF        CCEC2END=0
            MOVE      CCECHCD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L103
          IF        CCEC2END=0
            MOVE      CCECLV1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L104
          IF        CCEC2END=0
            MOVE      CCECLV2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L105
          IF        CCEC2END=0
            MOVE      CCECLV3,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L106
          IF        CCEC2END=0
            MOVE      CCECFTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L107
          IF        CCEC2END=0
            MOVE      CCECTTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L108
          IF        CCEC2END=0
            MOVE      CCECLOS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L109
          IF        CCEC2END=0
            MOVE      CCEPSUR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L110
          IF        CCEC2END=0
            MOVE      CCEPGIV,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L111
          IF        CCEC2END=0
            MOVE      CCEPSEX,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L112
          IF        CCEC2END=0
            MOVE      CCEPURN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
.
DPE1L113
          IF        CCEC2END=0
            MOVE      CCEPAGEY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPE1L010
DPE1L600
          MATCH    "CCEC2",NAMSSFFI
          GOTO     DPE1L605 IF NOT EQUAL
          GOTO     DPE1L999
DPE1L605
DPE1L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPE1L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     FPE1L105 IF NOT EQUAL
          PACK     KEY48,CCEC2SKY,SP70
          CALL     RDCCEC2  * Start
          IF       OVRCD=0
            CALL     RPCCEC2  * Start
          ENDIF
          CALL     DPE1L000
          GOTO     FPE1L999
FPE1L105
FPE1L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPE1L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     LPE1L105 IF NOT EQUAL
          PACK     KEY48,CCEC2SKY,Z70
          CALL     RSCCEC2  * End
          IF       OVRCD=1
            CALL     RPCCEC2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEC2SNO
            CALL     RPCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPE1L000
          GOTO     LPE1L999
LPE1L105
LPE1L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPE1L000
.
          MATCH    "CCEC2",NAMSSFFI
          GOTO     PPE1L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPE1L105
          CALL      RFTCCEC2
          BRANCH   OVRCD,PPE1L115
          MOVE      CCEC2MKY,KEY48 
          CALL      RSCCEC2 
PPE1L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCEC2SNO
            CALL     RPCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPE1L000
          GOTO     PPE1L999
PPE1L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEC2SNO
            CALL     RKCCEC2 
            IF       OVRCD=1
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
            MATCH    CCEC2EKY,CCEC2MKY
            IF       !@EQUAL
              MOVE     CCEC2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPE1L999
PPE1L120
PPE1L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPE1L000
          MATCH    "CCEC2",NAMSSFFI
          GOTO     NPE1L115 IF NOT EQUAL
NPE1L105
          CALL     RKCCEC2 
          BRANCH   OVRCD,NPE1L110
          PACK     CCEC2MKY,CCECLV1,CCECLV2,CCECLV3,CCECHCD,CCECEPS                                        
          MATCH    CCEC2EKY,CCEC2MKY
          GOTO     NPE1L110 IF NOT EQUAL
          CALL     RPCCEC2 
          CALL     DPE1L000
          GOTO     NPE1L999
NPE1L110
          CALL     RPCCEC2 
          BEEP
          GOTO     NPE1L999
NPE1L115
NPE1L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTE1L000
CTE1L105
CTE1L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Episodes at Level 1                
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     3 Episode                            
.---------------------------------------------------------
UPTCCEC2
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCEC2FL1,KEY5;ANS
          IF        @OVER
            WRITE     CCEC2FL1,KEY5;SCPSROW,SCPSCOL,CCEC2MKY
          ELSE
            UPDATE    CCEC2FL1;SCPSROW,SCPSCOL,CCEC2MKY
          ENDIF
          RETURN
RDTCCEC2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCEC2FL1,KEY5;SCPSROW,SCPSCOL,CCEC2MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTCCEC2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      CCEC2FL1,KEY5;;
          READKS    CCEC2FL1;SCPSROW,SCPSCOL,CCEC2MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,CCEC2MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Episodes at Level 1                
.---------------------------------------------------------
DFE1L000
          BRANCH   ACCEPT,DFE1L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFE1L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFE1L900
          MATCH    PRGID,SCPSPID
          GOTO     DFE1L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFE1L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFE1L010 IF NOT EQUAL
.
          CALL     PSE1L000 * Display Field
          GOTO     DFE1L010
DFE1L900
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE1L000
DFE1L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Episodes at Level 1                
.---------------------------------------------------------
PSE1L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSE1L999,PSE1L999,PSE1L999,PSE1L999:
                            PSE1L999,PSE1L999,PSE1L999,PSE1L999:
                            PSE1L999,PSE1L999,PSE1L999,PSE1L999:
                            PSE1L999,PSE1L999,PSE1L999,PSE1L999:
                            PSE1L999,PSE1L999,PSE1L999,PSE1L999
          GOTO     PSE1L999
PSE1L999
          RETURN
.---------------------------------------------------------
. Selections for : Episodes at Level 1                
.---------------------------------------------------------
SFE1L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFE1L001  BRANCH   ACCEPT,SFE1L020
.
SFE1L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFE1L006,SFE1L101,SFE1L102,SFE1L006:
                            SFE1L006,SFE1L006,SFE1L006,SFE1L006:
                            SFE1L006,SFE1L006,SFE1L103,SFE1L104:
                            SFE1L105,SFE1L106,SFE1L006,SFE1L006:
                            SFE1L006,SFE1L006,SFE1L006,SFE1L107
SFE1L006  BEEP
          GOTO     SFE1L005
SFE1L020  CALL     RKSCSL1
          BRANCH   OVRCD,SFE1L090
          MATCH    PRGID,SCSLPID
          GOTO     SFE1L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFE1L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFE1L020,SFE1L020,SFE1L102,SFE1L020:
                            SFE1L020,SFE1L020,SFE1L020,SFE1L020:
                            SFE1L020,SFE1L020,SFE1L020,SFE1L020:
                            SFE1L020,SFE1L020,SFE1L020,SFE1L020:
                            SFE1L020,SFE1L020,SFE1L020,SFE1L020
          GOTO     SFE1L020
SFE1L090  MOVE     ZERO,ACCEPT
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE1L000
          GOTO     SFE1L001
.
SFE1L101
          MOVE      ZERO,EXIT
          GOTO      SFE1L999
.
SFE1L102
          CALL      SELECTED
          BRANCH    EXIT,SFE1L001
          COMPARE   ONE,ACCEPT
          GOTO      SFE1L001 IF EQUAL
          CALL      RDTCCEC2
          IF        OVRCD=1
            BEEP
            GOTO      SFE1L001
          ENDIF
          MATCH     SP70,CCEC2MKY
          IF        @EQUAL
            BEEP
            GOTO      SFE1L001
          ENDIF
          MOVE      CCEC2MKY,KEY48 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELEPS00
          MOVE      "E1",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCEC2
          IF        OVRCD=1
            CALL      FPE1L000
          ELSE
            MOVE      CCEC2MKY,KEY48 
            CALL      RSCCEC2 
            CALL      RPCCEC2 
            CALL      DPE1L000
          ENDIF
          GOTO     SFE1L001
.
SFE1L103
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NPE1L000
          GOTO     SFE1L001
.
SFE1L104
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PPE1L000
          GOTO     SFE1L001
.
SFE1L105
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPE1L000
          GOTO     SFE1L001
.
SFE1L106
          MOVE      "CCEC2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LPE1L000
          GOTO     SFE1L001
.
SFE1L107
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFE1L999
SFE1L990  MOVE      ONE,EXIT * Exit Char Restart
SFE1L999  RETURN
.--------------------------------
. Screen - Epiosde Details                    
.--------------------------------
SCEDL000
SCEDL100
          MOVE      "ED",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 3",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCEDL200
          CALL      CFEDL000 * Clear Fields
SCEDL300
          CALL      KYEDL000 * Enter Key Fields
          BRANCH    EXIT,SCEDL999,SCEDL999
SCEDL400
          CALL      WPEDL000 * Load any WP Details
SCEDL500
          CALL      LMEDL000 * Load any Batch Details
SCEDL600
          CALL      DFEDL000 * Display Fields
SCEDL700
          CALL      SFEDL000 * Select Fields
          BRANCH    EXIT,SCEDL100,SCEDL100,SCEDL200
SCEDL800
SCEDL900
SCEDL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Epiosde Details                    
.-------------------------------------------------------
CFEDL000
CFEDL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Epiosde Details                    
.--------------------------------------------------------
KYEDL000
          MOVE      ZERO,EXIT
          GOTO      KYEDL999
.
KYEDL900  MOVE      ONE,EXIT
KYEDL999  RETURN
.---------------------------------------------------------
. Load WP files for : Epiosde Details                    
.---------------------------------------------------------
WPEDL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Epiosde Details                    
.---------------------------------------------------------
LMEDL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Epiosde Details                    
.---------------------------------------------------------
DFEDL000
          BRANCH   ACCEPT,DFEDL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFEDL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFEDL900
          MATCH    PRGID,SCPSPID
          GOTO     DFEDL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFEDL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFEDL010 IF NOT EQUAL
.
          CALL     PSEDL000 * Display Field
          GOTO     DFEDL010
DFEDL900
DFEDL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Epiosde Details                    
.---------------------------------------------------------
PSEDL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSEDL999,PSEDL999,PSEDL999,PSEDL999:
                           PSEDL999,PSEDL101,PSEDL102,PSEDL103:
                            PSEDL104,PSEDL105,PSEDL106,PSEDL107:
                            PSEDL108,PSEDL109,PSEDL110,PSEDL111:
                            PSEDL112,PSEDL113,PSEDL114,PSEDL115:
                            PSEDL116,PSEDL117,PSEDL118,PSEDL119:
                            PSEDL120,PSEDL121,PSEDL122,PSEDL123:
                            PSEDL124,PSEDL125,PSEDL126,PSEDL127:
                            PSEDL128,PSEDL129,PSEDL130,PSEDL131:
                            PSEDL132,PSEDL133,PSEDL134,PSEDL135:
                            PSEDL136,PSEDL137,PSEDL138,PSEDL139:
                            PSEDL140,PSEDL141,PSEDL142,PSEDL143:
                            PSEDL144,PSEDL145,PSEDL146,PSEDL147:
                            PSEDL148,PSEDL149,PSEDL150,PSEDL151:
                            PSEDL152,PSEDL153,PSEDL154,PSEDL155:
                            PSEDL156,PSEDL157,PSEDL158
          GOTO     PSEDL999
.
PSEDL101
          MOVE      CCEPHCD,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL102
          MOVE      CCEPEPS,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPCOM,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL104
          MOVE      CCEPURN,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL105
          UNPACK    CCEPSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL106
          UNPACK    CCEPLTD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL107
          MOVE      CCEPLOS,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPINPT,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPDAY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL110
          MOVE      CCEPVIST,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL111
          MOVE      CCEPSEX,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL112
          UNPACK    CCEPDOB,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL113
          MOVE      CCEPAGEY,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL114
          MOVE      CCEPAGEM,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL115
          MOVE      CCEPAGED,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL116
          MOVE      CCEPCOB,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL117
          MOVE      CCEPREL,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL118
          UNPACK    CCEPDDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL119
          MOVE      CCEPDSTA,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL120
          MOVE      CCEPDDES,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL121
          MOVE      CCEPDMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL122
          MOVE      CCEPDDPT,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL123
          MOVE      CCEPDSER,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL124
          MOVE      CCEPMDCC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL125
          MOVE      CCEPDRGC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL126
          UNPACK    CCEPADAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL127
          MOVE      CCEPAWAR,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL128
          MOVE      CCEPASRC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL129
          MOVE      CCEPACLS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL130
          MOVE      CCEPACAR,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL131
          MOVE      CCEPADPT,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL132
          MOVE      CCEPASER,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL133
          MOVE      CCEPARDC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL134
          MOVE      CCEPATDC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL135
          MOVE      CCEPAADC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL136
          MOVE      CCEPDADC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL137
          MOVE      CCEPAHFD,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL138
          MOVE      CCEPAHTB,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL139
          MOVE      CCEPAMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL140
          MOVE      CCEPOPCL,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL141
          MOVE      CCEPPDIA,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL142
          MOVE      CCEPSDIA,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL143
          MOVE      CCEPPOPP,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL144
          MOVE      CCEPSOPP,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL145
          MOVE      CCEPDWAR,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL146
          MOVE      CCEPSUR,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL147
          MOVE      CCEPGIV,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL148
          MOVE      CCEPPMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL149
          MOVE      CCEPSMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL150
          MOVE      CCEPMU1,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL151
          MOVE      CCEPMU2,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL152
          MOVE      CCEPMU3,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL153
          MOVE      CCEPMU4,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL154
          MOVE      CCEPMU5,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL155
          MOVE      CCEPMU6,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL156
          MOVE      CCEPMU7,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL157
          MOVE      CCEPPCD,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL158
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPEXC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
PSEDL999
          RETURN
.---------------------------------------------------------
. Selections for : Epiosde Details                    
.---------------------------------------------------------
SFEDL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFEDL001  BRANCH   ACCEPT,SFEDL020
.
SFEDL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFEDL006,SFEDL101,SFEDL102,SFEDL006:
                           SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006
SFEDL006  BEEP
          GOTO     SFEDL005
SFEDL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFEDL090
          MATCH    PRGID,SCSLPID
          GOTO     SFEDL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFEDL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                           SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020
          GOTO     SFEDL020
SFEDL090  MOVE     ZERO,ACCEPT
          GOTO     SFEDL001
.
SFEDL101
          MOVE      ZERO,EXIT
          GOTO      SFEDL999
.
SFEDL102
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFEDL999
SFEDL990  MOVE      ONE,EXIT * Exit Char Restart
SFEDL999  RETURN
.--------------------------------
. Screen - Episode Summary                    
.--------------------------------
SCESL000
SCESL100
          MOVE      "ES",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCESL200
          CALL      CFESL000 * Clear Fields
SCESL300
          CALL      KYESL000 * Enter Key Fields
          BRANCH    EXIT,SCESL999,SCESL999
SCESL400
          CALL      WPESL000 * Load any WP Details
SCESL500
          CALL      LMESL000 * Load any Batch Details
SCESL600
          CALL      DFESL000 * Display Fields
SCESL700
          CALL      SFESL000 * Select Fields
          BRANCH    EXIT,SCESL100,SCESL100,SCESL200
SCESL800
SCESL900
SCESL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Episode Summary                    
.-------------------------------------------------------
CFESL000
CFESL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Episode Summary                    
.--------------------------------------------------------
KYESL000
          MOVE      ZERO,EXIT
          GOTO      KYESL999
.
KYESL900  MOVE      ONE,EXIT
KYESL999  RETURN
.---------------------------------------------------------
. Load WP files for : Episode Summary                    
.---------------------------------------------------------
WPESL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Episode Summary                    
.---------------------------------------------------------
LMESL000
.---------------------------------------------------------
. Load for :    70 Date of Service                    
.---------------------------------------------------------
          PACK      KEY31,CCECHCD,CCECEPS,SP70
          MOVE      KEY31,CCUP2EKY
          MOVE      CCUP2EKY,CCUP2SKY
          STRIP     CCUP2SKY
          SETLPTR   CCUP2EKY,18
          CALL      RDCCUP2 
          IF        OVRCD=0
            CALL      RPCCUP2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPESL000
          MOVE     ZERO,CCUP2CNT
          MOVE     ZERO,CCUP2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPESL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPESL600
          MATCH    PRGID,SCPSPID
          GOTO     DPESL600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPESL600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPESL010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                            DPESL010,DPESL010,DPESL010,DPESL010:
                           DPESL010,DPESL010,DPESL010,DPESL010:
                           DPESL010,DPESL101,DPESL102,DPESL103:
                            DPESL104,DPESL105,DPESL106,DPESL107:
                            DPESL108,DPESL109,DPESL110,DPESL111:
                            DPESL112,DPESL113,DPESL114,DPESL115:
                            DPESL116,DPESL117,DPESL010,DPESL010:
                            DPESL010,DPESL010
          GOTO      DPESL010
.
DPESL101
          IF        CCUP2END=0
            CALL      RPCCUP2 
            IF        OVRCD=0
              PACK      CCUP2MKY,CCUPHCD,CCUPENC,CCUPDAT,CCUPTIM                                                
              MATCH     CCUP2EKY,CCUP2MKY
              IF        @EQUAL
                MOVE      ZERO,CCUP2END
                ADD       ONE,CCUP2CNT
          CALL      PCDDET00
                UNPACK    CCUPDAT,CCENT,CYEAR,CMON,CDAY           
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
              ELSE
                MOVE      ONE,CCUP2END
              ENDIF
            ELSE
              MOVE      ONE,CCUP2END
            ENDIF
          ENDIF
          IF        CCUP2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL102
          IF        CCUP2END=0
            MOVE      CCUPRUN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL103
          IF        CCUP2END=0
            MOVE      CCUPREC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL104
          IF        CCUP2END=0
            MOVE      CCUPDPT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL105
          IF        CCUP2END=0
            MOVE      CCUPPCD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL106
          IF        CCUP2END=0
            MOVE      CCUPURN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL107
          IF        CCUP2END=0
            MOVE      CCPDDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL108
          IF        CCUP2END=0
            MOVE      CCUPTIM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL109
          IF        CCUP2END=0
            MOVE      CCUPQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL110
          IF        CCUP2END=0
            MOVE      CCUPCHG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL111
          IF        CCUP2END=0
            MOVE      CCUPCL1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL112
          IF        CCUP2END=0
            MOVE      CCUPCL2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL113
          IF        CCUP2END=0
            MOVE      CCUPCL3,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL114
          IF        CCUP2END=0
            MOVE      CCUPCL4,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL115
          IF        CCUP2END=0
            MOVE      CCUPCL5,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL116
          IF        CCUP2END=0
            MOVE      COST1AMT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
.
DPESL117
          IF        CCUP2END=0
            MOVE      COST2AMT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPESL010
DPESL600
          MATCH    "CCUP2",NAMSSFFI
          GOTO     DPESL605 IF NOT EQUAL
          GOTO     DPESL999
DPESL605
DPESL999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPESL000
.
          MATCH    "CCUP2",NAMSSFFI
          GOTO     FPESL105 IF NOT EQUAL
          PACK     KEY31,CCUP2SKY,Z70
          CALL     RDCCUP2  * Start
          IF       OVRCD=0
            CALL     RPCCUP2  * Start
          ENDIF
          CALL     DPESL000
          GOTO     FPESL999
FPESL105
FPESL999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPESL000
.
          MATCH    "CCUP2",NAMSSFFI
          GOTO     LPESL105 IF NOT EQUAL
          PACK     KEY31,CCUP2SKY,SP70
          CALL     RSCCUP2  * End
          IF       OVRCD=1
            CALL     RKCCUP2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCUP2SNO
            CALL     RKCCUP2 
            IF       OVRCD=1
              MOVE     CCUP2SNO,SECTOR
            ENDIF
            PACK     CCUP2MKY,CCUPHCD,CCUPENC,CCUPDAT,CCUPTIM                                                
            MATCH    CCUP2EKY,CCUP2MKY
            IF       !@EQUAL
              MOVE     CCUP2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPESL000
          GOTO     LPESL999
LPESL105
LPESL999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPESL000
.
          MATCH    "CCUP2",NAMSSFFI
          GOTO     PPESL120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPESL105
          COMPARE  SECTOR,CCUP2SNO
          GOTO     PPESL110 IF EQUAL
          CALL     RKCCUP2 
          BRANCH   OVRCD,PPESL115
          PACK     CCUP2MKY,CCUPHCD,CCUPENC,CCUPDAT,CCUPTIM                                                
          MATCH    CCUP2EKY,CCUP2MKY
          GOTO     PPESL115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PPESL105
PPESL110
          MOVE     ZERO,SECTOR
          IF       CCUP2CNT=CCUP2SNO
            SUB      ONE,CCUP2CNT
          ENDIF
          WHILE    SECTOR<=CCUP2CNT
            CALL     RKCCUP2 
            IF       OVRCD=1
              MOVE     CCUP2SNO,SECTOR
            ENDIF
            PACK     CCUP2MKY,CCUPHCD,CCUPENC,CCUPDAT,CCUPTIM                                                
            MATCH    CCUP2EKY,CCUP2MKY
            IF       !@EQUAL
              MOVE     CCUP2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPESL000
          GOTO     PPESL999
PPESL115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCUP2SNO
            CALL     RPCCUP2 
            IF       OVRCD=1
              MOVE     CCUP2SNO,SECTOR
            ENDIF
            PACK     CCUP2MKY,CCUPHCD,CCUPENC,CCUPDAT,CCUPTIM                                                
            MATCH    CCUP2EKY,CCUP2MKY
            IF       !@EQUAL
              MOVE     CCUP2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPESL999
PPESL120
PPESL999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPESL000
          MATCH    "CCUP2",NAMSSFFI
          GOTO     NPESL115 IF NOT EQUAL
NPESL105
          CALL     RPCCUP2 
          BRANCH   OVRCD,NPESL110
          PACK     CCUP2MKY,CCUPHCD,CCUPENC,CCUPDAT,CCUPTIM                                                
          MATCH    CCUP2EKY,CCUP2MKY
          GOTO     NPESL110 IF NOT EQUAL
          CALL     RKCCUP2 
          CALL     DPESL000
          GOTO     NPESL999
NPESL110
          CALL     RKCCUP2 
          BEEP
          GOTO     NPESL999
NPESL115
NPESL999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTESL000
CTESL105
CTESL999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Episode Summary                    
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Episode Summary                    
.---------------------------------------------------------
DFESL000
          BRANCH   ACCEPT,DFESL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFESL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFESL900
          MATCH    PRGID,SCPSPID
          GOTO     DFESL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFESL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFESL010 IF NOT EQUAL
.
          CALL     PSESL000 * Display Field
          GOTO     DFESL010
DFESL900
          MOVE      "CCUP2",NAMSSFFI
          MOVE      "   70",ITMSSFFI
          CALL      FPESL000
DFESL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Episode Summary                    
.---------------------------------------------------------
PSESL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSESL999,PSESL999,PSESL999,PSESL999:
                            PSESL101,PSESL102,PSESL103,PSESL104:
                            PSESL105,PSESL106,PSESL107,PSESL108:
                            PSESL109,PSESL110,PSESL111,PSESL112:
                            PSESL113,PSESL114,PSESL115,PSESL116:
                            PSESL117,PSESL118,PSESL119,PSESL120:
                            PSESL121,PSESL122,PSESL123,PSESL124:
                            PSESL125,PSESL126,PSESL127,PSESL128:
                            PSESL129,PSESL130,PSESL131,PSESL132:
                            PSESL133,PSESL134,PSESL135,PSESL136:
                            PSESL137,PSESL138,PSESL139,PSESL140:
                            PSESL141,PSESL142,PSESL143,PSESL144:
                            PSESL145,PSESL146,PSESL147,PSESL148:
                            PSESL149,PSESL150,PSESL151,PSESL152:
                            PSESL153,PSESL154,PSESL155,PSESL156:
                            PSESL157,PSESL158,PSESL159,PSESL999:
                           PSESL999,PSESL999,PSESL999,PSESL999:
                           PSESL999,PSESL999,PSESL999,PSESL999:
                            PSESL999,PSESL999,PSESL999,PSESL999:
                            PSESL999,PSESL999,PSESL999,PSESL999:
                            PSESL999,PSESL999,PSESL999,PSESL999:
                            PSESL999,PSESL999,PSESL999,PSESL999:
                            PSESL999,PSESL999
          GOTO     PSESL999
.
PSESL101
          MOVE      CLV1DES,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL102
          MOVE      CLV2DES,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL103
          MOVE      CLV3DES,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL104
          MOVE      CCECHCD,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL105
          MOVE      CCECEPS,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL106
          MOVE      CCECLV1,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL107
          MOVE      CCECLV2,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL108
          MOVE      CCECLV3,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL109
          MOVE      CCECFTC,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL110
          MOVE      CCECTTC,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL111
          MOVE      CCECLOS,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL112
          MOVE      CCEPSUR,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL113
          MOVE      CCEPGIV,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPCOM,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL115
          MOVE      CCEPURN,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL116
          UNPACK    CCEPSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL117
          UNPACK    CCEPLTD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL118
          MOVE      CCEPLOS,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPINPT,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL120
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPDAY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL121
          MOVE      CCEPVIST,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL122
          MOVE      CCEPSEX,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL123
          UNPACK    CCEPDOB,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL124
          MOVE      CCEPAGEY,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL125
          MOVE      CCEPAGEM,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL126
          MOVE      CCEPAGED,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL127
          MOVE      CCEPCOB,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL128
          MOVE      CCEPREL,VAR      
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL129
          UNPACK    CCEPDDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL130
          MOVE      CCEPDWAR,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL131
          MOVE      CCEPDSTA,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL132
          MOVE      CCEPDDES,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL133
          MOVE      CCEPDMBS,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL134
          MOVE      CCEPDDPT,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL135
          MOVE      CCEPDSER,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL136
          MOVE      CCEPMDCC,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL137
          MOVE      CCEPDRGC,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL138
          UNPACK    CCEPADAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL139
          MOVE      CCEPAWAR,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL140
          MOVE      CCEPASRC,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL141
          MOVE      CCEPACLS,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL142
          MOVE      CCEPACAR,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL143
          MOVE      CCEPADPT,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL144
          MOVE      CCEPASER,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL145
          MOVE      CCEPARDC,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL146
          MOVE      CCEPATDC,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL147
          MOVE      CCEPAADC,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL148
          MOVE      CCEPDADC,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL149
          MOVE      CCEPAHFD,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL150
          MOVE      CCEPAHTB,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL151
          MOVE      CCEPAMBS,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL152
          MOVE      CCEPOPCL,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL153
          MOVE      CCEPPDIA,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL154
          MOVE      CCEPSDIA,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL155
          MOVE      CCEPPOPP,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL156
          MOVE      CCEPSOPP,VAR     
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL157
          MOVE      DESC01,VAR       
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL158
          MOVE      DESC02,VAR       
          CALL      DISPITEM
          GOTO     PSESL999
.
PSESL159
          MOVE      DESC03,VAR       
          CALL      DISPITEM
          GOTO     PSESL999
PSESL999
          RETURN
.---------------------------------------------------------
. Selections for : Episode Summary                    
.---------------------------------------------------------
SFESL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFESL001  BRANCH   ACCEPT,SFESL020
.
SFESL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFESL006,SFESL101,SFESL102,SFESL103:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                           SFESL006,SFESL006,SFESL006,SFESL006:
                           SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL006,SFESL006:
                            SFESL006,SFESL006,SFESL104,SFESL105:
                            SFESL106,SFESL107
SFESL006  BEEP
          GOTO     SFESL005
SFESL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFESL090
          MATCH    PRGID,SCSLPID
          GOTO     SFESL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFESL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                           SFESL020,SFESL020,SFESL020,SFESL020:
                           SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020,SFESL020,SFESL020:
                            SFESL020,SFESL020
          GOTO     SFESL020
SFESL090  MOVE     ZERO,ACCEPT
          MOVE      "CCUP2",NAMSSFFI
          MOVE      "   70",ITMSSFFI
          CALL      FPESL000
          GOTO     SFESL001
.
SFESL101
          MOVE      ZERO,EXIT
          GOTO      SFESL999
.
SFESL102
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFESL999
.
SFESL103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCEDL000
          MOVE      "ES",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SFESL001
.
SFESL104
          MOVE      "CCUP2",NAMSSFFI
          MOVE      "   70",ITMSSFFI
          CALL      NPESL000
          GOTO     SFESL001
.
SFESL105
          MOVE      "CCUP2",NAMSSFFI
          MOVE      "   70",ITMSSFFI
          CALL      PPESL000
          GOTO     SFESL001
.
SFESL106
          MOVE      "CCUP2",NAMSSFFI
          MOVE      "   70",ITMSSFFI
          CALL      FPESL000
          GOTO     SFESL001
.
SFESL107
          MOVE      "CCUP2",NAMSSFFI
          MOVE      "   70",ITMSSFFI
          CALL      LPESL000
          GOTO     SFESL001
SFESL990  MOVE      ONE,EXIT * Exit Char Restart
SFESL999  RETURN
.--------------------------------
. Screen - Graph Options                      
.--------------------------------
SCGOL000
SCGOL100
          MOVE      "GO",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 40",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCGOL200
          CALL      CFGOL000 * Clear Fields
SCGOL300
          CALL      KYGOL000 * Enter Key Fields
          BRANCH    EXIT,SCGOL999,SCGOL999
SCGOL400
          CALL      WPGOL000 * Load any WP Details
SCGOL500
          CALL      LMGOL000 * Load any Batch Details
SCGOL600
          CALL      DFGOL000 * Display Fields
SCGOL700
          CALL      SFGOL000 * Select Fields
          BRANCH    EXIT,SCGOL100,SCGOL100,SCGOL200
SCGOL800
SCGOL900
SCGOL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Graph Options                      
.-------------------------------------------------------
CFGOL000
CFGOL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Graph Options                      
.--------------------------------------------------------
KYGOL000
          MOVE      ZERO,EXIT
          GOTO      KYGOL999
.
KYGOL900  MOVE      ONE,EXIT
KYGOL999  RETURN
.---------------------------------------------------------
. Load WP files for : Graph Options                      
.---------------------------------------------------------
WPGOL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Graph Options                      
.---------------------------------------------------------
LMGOL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Graph Options                      
.---------------------------------------------------------
DFGOL000
          BRANCH   ACCEPT,DFGOL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFGOL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFGOL900
          MATCH    PRGID,SCPSPID
          GOTO     DFGOL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFGOL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFGOL010 IF NOT EQUAL
.
          CALL     PSGOL000 * Display Field
          GOTO     DFGOL010
DFGOL900
DFGOL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Graph Options                      
.---------------------------------------------------------
PSGOL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSGOL999,PSGOL999,PSGOL101,PSGOL999:
                            PSGOL102,PSGOL103,PSGOL104,PSGOL105:
                            PSGOL106,PSGOL107,PSGOL108,PSGOL109:
                            PSGOL110,PSGOL111,PSGOL112,PSGOL113:
                            PSGOL114,PSGOL999
          GOTO     PSGOL999
.
PSGOL101
          MOVE      GRAPHLEV,VAR     
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLTO,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLAV,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL104
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLMN,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLMX,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFTO,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFAV,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFMN,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFMX,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHTTO,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHTAV,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL112
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHTMN,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL113
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHTMX,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
.
PSGOL114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHEPS,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSGOL999
PSGOL999
          RETURN
.---------------------------------------------------------
. Selections for : Graph Options                      
.---------------------------------------------------------
SFGOL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFGOL001  BRANCH   ACCEPT,SFGOL020
.
SFGOL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFGOL006,SFGOL101,SFGOL006,SFGOL102:
                            SFGOL103,SFGOL104,SFGOL105,SFGOL106:
                            SFGOL107,SFGOL108,SFGOL109,SFGOL110:
                            SFGOL111,SFGOL112,SFGOL113,SFGOL114:
                            SFGOL115,SFGOL116
SFGOL006  BEEP
          GOTO     SFGOL005
SFGOL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFGOL090
          MATCH    PRGID,SCSLPID
          GOTO     SFGOL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFGOL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFGOL020,SFGOL020,SFGOL020,SFGOL020:
                            SFGOL103,SFGOL104,SFGOL105,SFGOL106:
                            SFGOL107,SFGOL108,SFGOL109,SFGOL110:
                            SFGOL111,SFGOL112,SFGOL113,SFGOL114:
                            SFGOL115,SFGOL020
          GOTO     SFGOL020
SFGOL090  MOVE     ZERO,ACCEPT
          GOTO     SFGOL001
.
SFGOL101
          MOVE      ZERO,EXIT
          GOTO      SFGOL999
.
SFGOL102
          CALL      GRAPH000
          GOTO      SFGOL001
.
SFGOL103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHLTO00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL103
            ENDIF
            BRANCH    EXIT,SFGOL103,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLTO,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHLAV00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL104
            ENDIF
            BRANCH    EXIT,SFGOL104,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLAV,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHLMN00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL105
            ENDIF
            BRANCH    EXIT,SFGOL105,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLMN,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL106
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHLMX00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL106
            ENDIF
            BRANCH    EXIT,SFGOL106,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHLMX,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL107
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHFTO00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL107
            ENDIF
            BRANCH    EXIT,SFGOL107,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFTO,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL108
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHFAV00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL108
            ENDIF
            BRANCH    EXIT,SFGOL108,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFAV,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL109
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHFMN00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL109
            ENDIF
            BRANCH    EXIT,SFGOL109,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFMN,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL110
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHFMX00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL110
            ENDIF
            BRANCH    EXIT,SFGOL110,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHFMX,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL111
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHTTO00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL111
            ENDIF
            BRANCH    EXIT,SFGOL111,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHTTO,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL112
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHTAV00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL112
            ENDIF
            BRANCH    EXIT,SFGOL112,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHTAV,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL113
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHTMN00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL113
            ENDIF
            BRANCH    EXIT,SFGOL113,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHTMN,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL114
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHTMX00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL114
            ENDIF
            BRANCH    EXIT,SFGOL114,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHTMX,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL115
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHEPS00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFGOL115
            ENDIF
            BRANCH    EXIT,SFGOL115,SFGOL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFGOL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHEPS,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFGOL001
.
SFGOL116
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFGOL999
SFGOL990  MOVE      ONE,EXIT * Exit Char Restart
SFGOL999  RETURN
.--------------------------------
. Screen - Patient Service Analysis           
.--------------------------------
SCPAL000
SCPAL100
          MOVE      "PA",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "11",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCPAL200
          CALL      CFPAL000 * Clear Fields
SCPAL300
          CALL      KYPAL000 * Enter Key Fields
          BRANCH    EXIT,SCPAL999,SCPAL999
SCPAL400
          CALL      WPPAL000 * Load any WP Details
SCPAL500
          CALL      LMPAL000 * Load any Batch Details
SCPAL600
          CALL      DFPAL000 * Display Fields
SCPAL700
          CALL      SFPAL000 * Select Fields
          BRANCH    EXIT,SCPAL100,SCPAL100,SCPAL200
SCPAL800
SCPAL900
SCPAL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Patient Service Analysis           
.-------------------------------------------------------
CFPAL000
CFPAL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Patient Service Analysis           
.--------------------------------------------------------
KYPAL000
          MOVE      ZERO,EXIT
          GOTO      KYPAL999
.
KYPAL900  MOVE      ONE,EXIT
KYPAL999  RETURN
.---------------------------------------------------------
. Load WP files for : Patient Service Analysis           
.---------------------------------------------------------
WPPAL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Patient Service Analysis           
.---------------------------------------------------------
LMPAL000
.---------------------------------------------------------
. Load for :     4 Patient Service Line Key           
.---------------------------------------------------------
          PACK      KEY28,CCEBLV1,SP70
          MOVE      KEY28,CCEG1EKY
          MOVE      CCEG1EKY,CCEG1SKY
          STRIP     CCEG1SKY
          SETLPTR   CCEG1EKY,10
          CALL      RDCCEG1 
          IF        OVRCD=0
            CALL      RPCCEG1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPPAL000
          MOVE     ZERO,CCEG1CNT
          MOVE     ZERO,CCEG1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPPAL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPPAL600
          MATCH    PRGID,SCPSPID
          GOTO     DPPAL600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPPAL600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPPAL010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPPAL010,DPPAL010,DPPAL010,DPPAL101:
                            DPPAL102,DPPAL103,DPPAL104,DPPAL105:
                            DPPAL106,DPPAL107,DPPAL108,DPPAL109:
                            DPPAL110,DPPAL111,DPPAL112,DPPAL113:
                            DPPAL114,DPPAL115,DPPAL116,DPPAL117:
                            DPPAL118,DPPAL119,DPPAL010,DPPAL010:
                           DPPAL010,DPPAL010,DPPAL010,DPPAL010:
                           DPPAL010,DPPAL010,DPPAL010,DPPAL010:
                            DPPAL010,DPPAL010
          GOTO      DPPAL010
.
DPPAL101
          PACK      CCEG1MKY,SP70,SP70
          CALL      UPTCCEG1
          IF        CCEG1END=0
            CALL      RPCCEG1 
            IF        OVRCD=0
              PACK      CCEG1MKY,CCEGLV1,CCEGHCD,CCEGDPT,CCEGPCD                                                
              MATCH     CCEG1EKY,CCEG1MKY
              IF        @EQUAL
                MOVE      ZERO,CCEG1END
                ADD       ONE,CCEG1CNT
                CALL      UPTCCEG1
                MOVE      CCEGPCD,VAR      
                CALL      DISPITEM
          CALL      PCDGET00
              ELSE
                MOVE      ONE,CCEG1END
              ENDIF
            ELSE
              MOVE      ONE,CCEG1END
            ENDIF
          ENDIF
          IF        CCEG1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPAL010
.
DPPAL102
          IF        CCEG1END=0
            MOVE      CCPDPCD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPAL010
.
DPPAL103
          IF        CCEG1END=0
            MOVE      CCPDDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPAL010
.
DPPAL104
          IF        CCEG1END=0
            MOVE      CCPDSTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPAL010
.
DPPAL105
          IF        CCEG1END=0
            MOVE      CCPDRVI,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPAL010
.
DPPAL106
          IF        CCEG1END=0
            MOVE      CCPDSEQ,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPAL010
.
DPPAL107
          IF        CCEG1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      CCPDSUS,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPAL010
.
DPPAL108
          IF        CCEG1END=0
            MOVE      CCEGQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPAL010
.
DPPAL109
          IF        CCEG1END=0
            MOVE      CCEGFTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPAL010
.
DPPAL110
          IF        CCEG1END=0
            MOVE      CCEGTTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPAL010
.
DPPAL111
          IF        CCEG1END=0
            MOVE      PAVGPRO1,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPAL010
.
DPPAL112
          IF        CCEG1END=0
            MOVE      PAVGEPS1,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPAL010
.
DPPAL113
          IF        CCEG1END=0
            MOVE      PAVGLOS1,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPAL010
.
DPPAL114
          IF        CCEG1END=0
            MOVE      PAVGPRO2,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPAL010
.
DPPAL115
          IF        CCEG1END=0
            MOVE      PAVGEPS2,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPAL010
.
DPPAL116
          IF        CCEG1END=0
            MOVE      PAVGLOS2,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPAL010
.
DPPAL117
          IF        CCEG1END=0
            MOVE      PAVGPRO,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPAL010
.
DPPAL118
          IF        CCEG1END=0
            MOVE      PTOTPER1,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPAL010
.
DPPAL119
          IF        CCEG1END=0
            MOVE      PTOTPER2,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPAL010
DPPAL600
          MATCH    "CCEG1",NAMSSFFI
          GOTO     DPPAL605 IF NOT EQUAL
          GOTO     DPPAL999
DPPAL605
DPPAL999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPPAL000
.
          MATCH    "CCEG1",NAMSSFFI
          GOTO     FPPAL105 IF NOT EQUAL
          PACK     KEY28,CCEG1SKY,Z70
          CALL     RDCCEG1  * Start
          IF       OVRCD=0
            CALL     RPCCEG1  * Start
          ENDIF
          CALL     DPPAL000
          GOTO     FPPAL999
FPPAL105
FPPAL999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPPAL000
.
          MATCH    "CCEG1",NAMSSFFI
          GOTO     LPPAL105 IF NOT EQUAL
          PACK     KEY28,CCEG1SKY,SP70
          CALL     RSCCEG1  * End
          IF       OVRCD=1
            CALL     RKCCEG1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEG1SNO
            CALL     RKCCEG1 
            IF       OVRCD=1
              MOVE     CCEG1SNO,SECTOR
            ENDIF
            PACK     CCEG1MKY,CCEGLV1,CCEGHCD,CCEGDPT,CCEGPCD                                                
            MATCH    CCEG1EKY,CCEG1MKY
            IF       !@EQUAL
              MOVE     CCEG1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPPAL000
          GOTO     LPPAL999
LPPAL105
LPPAL999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPPAL000
.
          MATCH    "CCEG1",NAMSSFFI
          GOTO     PPPAL120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPPAL105
          CALL      RFTCCEG1
          BRANCH   OVRCD,PPPAL115
          MOVE      CCEG1MKY,KEY28 
          CALL      RSCCEG1 
PPPAL110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCEG1SNO
            CALL     RKCCEG1 
            IF       OVRCD=1
              MOVE     CCEG1SNO,SECTOR
            ENDIF
            PACK     CCEG1MKY,CCEGLV1,CCEGHCD,CCEGDPT,CCEGPCD                                                
            MATCH    CCEG1EKY,CCEG1MKY
            IF       !@EQUAL
              MOVE     CCEG1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPPAL000
          GOTO     PPPAL999
PPPAL115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEG1SNO
            CALL     RPCCEG1 
            IF       OVRCD=1
              MOVE     CCEG1SNO,SECTOR
            ENDIF
            PACK     CCEG1MKY,CCEGLV1,CCEGHCD,CCEGDPT,CCEGPCD                                                
            MATCH    CCEG1EKY,CCEG1MKY
            IF       !@EQUAL
              MOVE     CCEG1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPPAL999
PPPAL120
PPPAL999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPPAL000
          MATCH    "CCEG1",NAMSSFFI
          GOTO     NPPAL115 IF NOT EQUAL
NPPAL105
          CALL     RPCCEG1 
          BRANCH   OVRCD,NPPAL110
          PACK     CCEG1MKY,CCEGLV1,CCEGHCD,CCEGDPT,CCEGPCD                                                
          MATCH    CCEG1EKY,CCEG1MKY
          GOTO     NPPAL110 IF NOT EQUAL
          CALL     RKCCEG1 
          CALL     DPPAL000
          GOTO     NPPAL999
NPPAL110
          CALL     RKCCEG1 
          BEEP
          GOTO     NPPAL999
NPPAL115
NPPAL999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTPAL000
CTPAL105
CTPAL999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Patient Service Analysis           
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     4 Patient Service Line Key           
.---------------------------------------------------------
UPTCCEG1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCEG1FL1,KEY5;ANS
          IF        @OVER
            WRITE     CCEG1FL1,KEY5;SCPSROW,SCPSCOL,CCEG1MKY
          ELSE
            UPDATE    CCEG1FL1;SCPSROW,SCPSCOL,CCEG1MKY
          ENDIF
          RETURN
RDTCCEG1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCEG1FL1,KEY5;SCPSROW,SCPSCOL,CCEG1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTCCEG1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      CCEG1FL1,KEY5;;
          READKS    CCEG1FL1;SCPSROW,SCPSCOL,CCEG1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,CCEG1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Patient Service Analysis           
.---------------------------------------------------------
DFPAL000
          BRANCH   ACCEPT,DFPAL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFPAL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFPAL900
          MATCH    PRGID,SCPSPID
          GOTO     DFPAL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFPAL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFPAL010 IF NOT EQUAL
.
          CALL     PSPAL000 * Display Field
          GOTO     DFPAL010
DFPAL900
          MOVE      "CCEG1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FPPAL000
DFPAL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Patient Service Analysis           
.---------------------------------------------------------
PSPAL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSPAL999,PSPAL999,PSPAL999,PSPAL999:
                            PSPAL999,PSPAL999,PSPAL999,PSPAL999:
                            PSPAL999,PSPAL999,PSPAL999,PSPAL999:
                            PSPAL999,PSPAL999,PSPAL999,PSPAL999:
                            PSPAL999,PSPAL999,PSPAL999,PSPAL999:
                            PSPAL999,PSPAL999,PSPAL999,PSPAL999:
                           PSPAL999,PSPAL999,PSPAL999,PSPAL999:
                           PSPAL999,PSPAL999,PSPAL999,PSPAL999:
                            PSPAL999,PSPAL999
          GOTO     PSPAL999
PSPAL999
          RETURN
.---------------------------------------------------------
. Selections for : Patient Service Analysis           
.---------------------------------------------------------
SFPAL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFPAL001  BRANCH   ACCEPT,SFPAL020
.
SFPAL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPAL006,SFPAL101,SFPAL102,SFPAL103:
                            SFPAL006,SFPAL006,SFPAL006,SFPAL006:
                            SFPAL006,SFPAL006,SFPAL006,SFPAL006:
                            SFPAL006,SFPAL006,SFPAL006,SFPAL006:
                            SFPAL006,SFPAL006,SFPAL006,SFPAL006:
                            SFPAL006,SFPAL006,SFPAL006,SFPAL006:
                           SFPAL006,SFPAL006,SFPAL006,SFPAL006:
                           SFPAL006,SFPAL006,SFPAL104,SFPAL105:
                            SFPAL106,SFPAL107
SFPAL006  BEEP
          GOTO     SFPAL005
SFPAL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFPAL090
          MATCH    PRGID,SCSLPID
          GOTO     SFPAL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFPAL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPAL020,SFPAL020,SFPAL020,SFPAL103:
                            SFPAL020,SFPAL020,SFPAL020,SFPAL020:
                            SFPAL020,SFPAL020,SFPAL020,SFPAL020:
                            SFPAL020,SFPAL020,SFPAL020,SFPAL020:
                            SFPAL020,SFPAL020,SFPAL020,SFPAL020:
                            SFPAL020,SFPAL020,SFPAL020,SFPAL020:
                           SFPAL020,SFPAL020,SFPAL020,SFPAL020:
                           SFPAL020,SFPAL020,SFPAL020,SFPAL020:
                            SFPAL020,SFPAL020
          GOTO     SFPAL020
SFPAL090  MOVE     ZERO,ACCEPT
          MOVE      "CCEG1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FPPAL000
          GOTO     SFPAL001
.
SFPAL101
          MOVE      ZERO,EXIT
          GOTO      SFPAL999
.
SFPAL102
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFPAL999
.
SFPAL103
          CALL      SELECTED
          BRANCH    EXIT,SFPAL001
          COMPARE   ONE,ACCEPT
          GOTO      SFPAL001 IF EQUAL
          CALL      RDTCCEG1
          IF        OVRCD=1
            BEEP
            GOTO      SFPAL001
          ENDIF
          MATCH     SP70,CCEG1MKY
          IF        @EQUAL
            BEEP
            GOTO      SFPAL001
          ENDIF
          MOVE      CCEG1MKY,KEY28 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      PCDSEL00
          MOVE      "PA",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCEG1
          IF        OVRCD=1
            CALL      FPPAL000
          ELSE
            MOVE      CCEG1MKY,KEY28 
            CALL      RSCCEG1 
            CALL      RKCCEG1 
            CALL      DPPAL000
          ENDIF
          GOTO     SFPAL001
.
SFPAL104
          MOVE      "CCEG1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      NPPAL000
          GOTO     SFPAL001
.
SFPAL105
          MOVE      "CCEG1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      PPPAL000
          GOTO     SFPAL001
.
SFPAL106
          MOVE      "CCEG1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      FPPAL000
          GOTO     SFPAL001
.
SFPAL107
          MOVE      "CCEG1",NAMSSFFI
          MOVE      "    4",ITMSSFFI
          CALL      LPPAL000
          GOTO     SFPAL001
SFPAL990  MOVE      ONE,EXIT * Exit Char Restart
SFPAL999  RETURN
.--------------------------------
. Screen - Patient Service Details            
.--------------------------------
SCPBL000
SCPBL100
          MOVE      "PB",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "11",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCPBL200
          CALL      CFPBL000 * Clear Fields
SCPBL300
          CALL      KYPBL000 * Enter Key Fields
          BRANCH    EXIT,SCPBL999,SCPBL999
SCPBL400
          CALL      WPPBL000 * Load any WP Details
SCPBL500
          CALL      LMPBL000 * Load any Batch Details
SCPBL600
          CALL      DFPBL000 * Display Fields
SCPBL700
          CALL      SFPBL000 * Select Fields
          BRANCH    EXIT,SCPBL100,SCPBL100,SCPBL200
SCPBL800
SCPBL900
SCPBL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Patient Service Details            
.-------------------------------------------------------
CFPBL000
CFPBL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Patient Service Details            
.--------------------------------------------------------
KYPBL000
          MOVE      ZERO,EXIT
          GOTO      KYPBL999
.
KYPBL900  MOVE      ONE,EXIT
KYPBL999  RETURN
.---------------------------------------------------------
. Load WP files for : Patient Service Details            
.---------------------------------------------------------
WPPBL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Patient Service Details            
.---------------------------------------------------------
LMPBL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Patient Service Details            
.---------------------------------------------------------
DFPBL000
          BRANCH   ACCEPT,DFPBL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFPBL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFPBL900
          MATCH    PRGID,SCPSPID
          GOTO     DFPBL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFPBL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFPBL010 IF NOT EQUAL
.
          CALL     PSPBL000 * Display Field
          GOTO     DFPBL010
DFPBL900
DFPBL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Patient Service Details            
.---------------------------------------------------------
PSPBL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSPBL999,PSPBL999,PSPBL999,PSPBL101:
                            PSPBL102,PSPBL103,PSPBL104,PSPBL105:
                            PSPBL106,PSPBL107,PSPBL108,PSPBL109:
                            PSPBL110,PSPBL111,PSPBL112,PSPBL113:
                            PSPBL114,PSPBL115,PSPBL116,PSPBL117:
                            PSPBL118,PSPBL119,PSPBL120,PSPBL121
          GOTO     PSPBL999
.
PSPBL101
          MOVE      CCPDDES,VAR      
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL102
          MOVE      CCPDSTC,VAR      
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL103
          MOVE      CCPDRVI,VAR      
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL104
          MOVE      CCPDPCD,VAR      
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCPDSUS,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL106
          MOVE      CCEGQTY,VAR      
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL107
          MOVE      CCEGFTC,VAR      
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL108
          MOVE      CCEGTTC,VAR      
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL109
          MOVE      PAVGPRO1,VAR     
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL110
          MOVE      PAVGEPS1,VAR     
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL111
          MOVE      PAVGLOS1,VAR     
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL112
          MOVE      PAVGPRO2,VAR     
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL113
          MOVE      PAVGEPS2,VAR     
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL114
          MOVE      PAVGLOS2,VAR     
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL115
          MOVE      PAVGPRO,VAR      
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL116
          MOVE      PTOTPER1,VAR     
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL117
          MOVE      PTOTPER2,VAR     
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL118
          MOVE      CCHCHCD,VAR      
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL119
          MOVE      CCHCDES,VAR      
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL120
          MOVE      CCDPDPT,VAR      
          CALL      DISPITEM
          GOTO     PSPBL999
.
PSPBL121
          MOVE      CCDPDES,VAR      
          CALL      DISPITEM
          GOTO     PSPBL999
PSPBL999
          RETURN
.---------------------------------------------------------
. Selections for : Patient Service Details            
.---------------------------------------------------------
SFPBL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFPBL001  BRANCH   ACCEPT,SFPBL020
.
SFPBL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPBL006,SFPBL101,SFPBL102,SFPBL006:
                            SFPBL006,SFPBL006,SFPBL006,SFPBL006:
                            SFPBL006,SFPBL006,SFPBL006,SFPBL006:
                            SFPBL006,SFPBL006,SFPBL006,SFPBL006:
                            SFPBL006,SFPBL006,SFPBL006,SFPBL006:
                            SFPBL006,SFPBL006,SFPBL006,SFPBL006
SFPBL006  BEEP
          GOTO     SFPBL005
SFPBL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFPBL090
          MATCH    PRGID,SCSLPID
          GOTO     SFPBL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFPBL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPBL020,SFPBL020,SFPBL020,SFPBL020:
                            SFPBL020,SFPBL020,SFPBL020,SFPBL020:
                            SFPBL020,SFPBL020,SFPBL020,SFPBL020:
                            SFPBL020,SFPBL020,SFPBL020,SFPBL020:
                            SFPBL020,SFPBL020,SFPBL020,SFPBL020:
                            SFPBL020,SFPBL020,SFPBL020,SFPBL020
          GOTO     SFPBL020
SFPBL090  MOVE     ZERO,ACCEPT
          GOTO     SFPBL001
.
SFPBL101
          MOVE      ZERO,EXIT
          GOTO      SFPBL999
.
SFPBL102
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFPBL999
SFPBL990  MOVE      ONE,EXIT * Exit Char Restart
SFPBL999  RETURN
.--------------------------------
. Screen - Patient Service Detail Display     
.--------------------------------
SCPDL000
SCPDL100
          MOVE      "PD",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "13",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCPDL200
          CALL      CFPDL000 * Clear Fields
SCPDL300
          CALL      KYPDL000 * Enter Key Fields
          BRANCH    EXIT,SCPDL999,SCPDL999
SCPDL400
          CALL      WPPDL000 * Load any WP Details
SCPDL500
          CALL      LMPDL000 * Load any Batch Details
SCPDL600
          CALL      DFPDL000 * Display Fields
SCPDL700
          CALL      SFPDL000 * Select Fields
          BRANCH    EXIT,SCPDL100,SCPDL100,SCPDL200
SCPDL800
SCPDL900
SCPDL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Patient Service Detail Display     
.-------------------------------------------------------
CFPDL000
CFPDL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Patient Service Detail Display     
.--------------------------------------------------------
KYPDL000
          MOVE      ZERO,EXIT
          GOTO      KYPDL999
.
KYPDL900  MOVE      ONE,EXIT
KYPDL999  RETURN
.---------------------------------------------------------
. Load WP files for : Patient Service Detail Display     
.---------------------------------------------------------
WPPDL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Patient Service Detail Display     
.---------------------------------------------------------
LMPDL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Patient Service Detail Display     
.---------------------------------------------------------
DFPDL000
          BRANCH   ACCEPT,DFPDL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFPDL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFPDL900
          MATCH    PRGID,SCPSPID
          GOTO     DFPDL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFPDL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFPDL010 IF NOT EQUAL
.
          CALL     PSPDL000 * Display Field
          GOTO     DFPDL010
DFPDL900
DFPDL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Patient Service Detail Display     
.---------------------------------------------------------
PSPDL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSPDL999,PSPDL999,PSPDL999,PSPDL101:
                            PSPDL102,PSPDL103,PSPDL104,PSPDL105:
                            PSPDL106,PSPDL107,PSPDL108,PSPDL109:
                            PSPDL110,PSPDL111,PSPDL112,PSPDL113:
                            PSPDL114,PSPDL115,PSPDL116,PSPDL117
          GOTO     PSPDL999
.
PSPDL101
          MOVE      CCPDDES,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL102
          MOVE      CCPDSTC,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL103
          MOVE      CCPDRVI,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL104
          MOVE      CCPDPCD,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCPDSUS,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL106
          MOVE      CCEGQTY,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL107
          MOVE      CCEGFTC,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL108
          MOVE      CCEGTTC,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL109
          MOVE      PAVGPRO1,VAR     
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL110
          MOVE      PAVGEPS1,VAR     
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL111
          MOVE      PAVGLOS1,VAR     
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL112
          MOVE      PAVGPRO2,VAR     
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL113
          MOVE      PAVGEPS2,VAR     
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL114
          MOVE      PAVGLOS2,VAR     
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL115
          MOVE      PAVGPRO,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL116
          MOVE      PTOTPER1,VAR     
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL117
          MOVE      PTOTPER2,VAR     
          CALL      DISPITEM
          GOTO     PSPDL999
PSPDL999
          RETURN
.---------------------------------------------------------
. Selections for : Patient Service Detail Display     
.---------------------------------------------------------
SFPDL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFPDL001  BRANCH   ACCEPT,SFPDL020
.
SFPDL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPDL006,SFPDL101,SFPDL102,SFPDL006:
                            SFPDL006,SFPDL006,SFPDL006,SFPDL006:
                            SFPDL006,SFPDL006,SFPDL006,SFPDL006:
                            SFPDL006,SFPDL006,SFPDL006,SFPDL006:
                            SFPDL006,SFPDL006,SFPDL006,SFPDL006
SFPDL006  BEEP
          GOTO     SFPDL005
SFPDL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFPDL090
          MATCH    PRGID,SCSLPID
          GOTO     SFPDL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFPDL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPDL020,SFPDL020,SFPDL020,SFPDL020:
                            SFPDL020,SFPDL020,SFPDL020,SFPDL020:
                            SFPDL020,SFPDL020,SFPDL020,SFPDL020:
                            SFPDL020,SFPDL020,SFPDL020,SFPDL020:
                            SFPDL020,SFPDL020,SFPDL020,SFPDL020
          GOTO     SFPDL020
SFPDL090  MOVE     ZERO,ACCEPT
          GOTO     SFPDL001
.
SFPDL101
          MOVE      ZERO,EXIT
          GOTO      SFPDL999
.
SFPDL102
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFPDL999
SFPDL990  MOVE      ONE,EXIT * Exit Char Restart
SFPDL999  RETURN
.--------------------------------
. Screen - Select Department Details          
.--------------------------------
SCSDL000
SCSDL100
          MOVE      "SD",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCSDL200
          CALL      CFSDL000 * Clear Fields
SCSDL300
          CALL      KYSDL000 * Enter Key Fields
          BRANCH    EXIT,SCSDL999,SCSDL999
SCSDL400
          CALL      WPSDL000 * Load any WP Details
SCSDL500
          CALL      LMSDL000 * Load any Batch Details
SCSDL600
          CALL      DFSDL000 * Display Fields
SCSDL700
          CALL      SFSDL000 * Select Fields
          BRANCH    EXIT,SCSDL100,SCSDL100,SCSDL200
SCSDL800
SCSDL900
SCSDL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Select Department Details          
.-------------------------------------------------------
CFSDL000
CFSDL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Select Department Details          
.--------------------------------------------------------
KYSDL000
          MOVE      ZERO,EXIT
          GOTO      KYSDL999
.
KYSDL900  MOVE      ONE,EXIT
KYSDL999  RETURN
.---------------------------------------------------------
. Load WP files for : Select Department Details          
.---------------------------------------------------------
WPSDL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Select Department Details          
.---------------------------------------------------------
LMSDL000
.---------------------------------------------------------
. Load for :    20 Patient Service Line Key           
.---------------------------------------------------------
          PACK      KEY28,CCEFLV1,CCEFHCD,CCEFDPT,SP70
          MOVE      KEY28,CCEG1EKY
          MOVE      CCEG1EKY,CCEG1SKY
          STRIP     CCEG1SKY
          SETLPTR   CCEG1EKY,20
          CALL      RDCCEG1 
          IF        OVRCD=0
            CALL      RPCCEG1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPSDL000
          MOVE     ZERO,CCEG1CNT
          MOVE     ZERO,CCEG1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPSDL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPSDL600
          MATCH    PRGID,SCPSPID
          GOTO     DPSDL600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPSDL600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPSDL010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPSDL010,DPSDL010,DPSDL010,DPSDL010:
                            DPSDL010,DPSDL010,DPSDL010,DPSDL010:
                            DPSDL010,DPSDL010,DPSDL010,DPSDL010:
                            DPSDL010,DPSDL010,DPSDL010,DPSDL010:
                            DPSDL010,DPSDL010,DPSDL010,DPSDL101:
                            DPSDL102,DPSDL103,DPSDL104,DPSDL105:
                            DPSDL106,DPSDL107,DPSDL108,DPSDL109:
                            DPSDL110,DPSDL111,DPSDL112,DPSDL113:
                            DPSDL114,DPSDL115,DPSDL116,DPSDL117:
                            DPSDL118,DPSDL119,DPSDL010,DPSDL010:
                           DPSDL010,DPSDL010,DPSDL010,DPSDL010
          GOTO      DPSDL010
.
DPSDL101
          PACK      CCEG1MKY,SP70,SP70
          CALL      UPTCCEG1
          IF        CCEG1END=0
            CALL      RKCCEG1 
            IF        OVRCD=0
              PACK      CCEG1MKY,CCEGLV1,CCEGHCD,CCEGDPT,CCEGPCD                                                
              MATCH     CCEG1EKY,CCEG1MKY
              IF        @EQUAL
                MOVE      ZERO,CCEG1END
                ADD       ONE,CCEG1CNT
                CALL      UPTCCEG1
                MOVE      CCEGPCD,VAR      
                CALL      DISPITEM
          CALL      GETPCD00
              ELSE
                MOVE      ONE,CCEG1END
              ENDIF
            ELSE
              MOVE      ONE,CCEG1END
            ENDIF
          ENDIF
          IF        CCEG1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPSDL010
.
DPSDL102
          IF        CCEG1END=0
            MOVE      CCPDPCD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPSDL010
.
DPSDL103
          IF        CCEG1END=0
            MOVE      CCPDDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPSDL010
.
DPSDL104
          IF        CCEG1END=0
            MOVE      CCPDSTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPSDL010
.
DPSDL105
          IF        CCEG1END=0
            MOVE      CCPDRVI,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPSDL010
.
DPSDL106
          IF        CCEG1END=0
            MOVE      CCPDSEQ,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPSDL010
.
DPSDL107
          IF        CCEG1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      CCPDSUS,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPSDL010
.
DPSDL108
          IF        CCEG1END=0
            MOVE      CCEGQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPSDL010
.
DPSDL109
          IF        CCEG1END=0
            MOVE      CCEGFTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPSDL010
.
DPSDL110
          IF        CCEG1END=0
            MOVE      CCEGTTC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPSDL010
.
DPSDL111
          IF        CCEG1END=0
            MOVE      PAVGPRO1,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPSDL010
.
DPSDL112
          IF        CCEG1END=0
            MOVE      PAVGEPS1,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPSDL010
.
DPSDL113
          IF        CCEG1END=0
            MOVE      PAVGLOS1,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPSDL010
.
DPSDL114
          IF        CCEG1END=0
            MOVE      PAVGPRO2,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPSDL010
.
DPSDL115
          IF        CCEG1END=0
            MOVE      PAVGEPS2,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPSDL010
.
DPSDL116
          IF        CCEG1END=0
            MOVE      PAVGLOS2,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPSDL010
.
DPSDL117
          IF        CCEG1END=0
            MOVE      PAVGPRO,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPSDL010
.
DPSDL118
          IF        CCEG1END=0
            MOVE      PTOTPER1,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPSDL010
.
DPSDL119
          IF        CCEG1END=0
            MOVE      PTOTPER2,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPSDL010
DPSDL600
          MATCH    "CCEG1",NAMSSFFI
          GOTO     DPSDL605 IF NOT EQUAL
          GOTO     DPSDL999
DPSDL605
DPSDL999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPSDL000
.
          MATCH    "CCEG1",NAMSSFFI
          GOTO     FPSDL105 IF NOT EQUAL
          PACK     KEY28,CCEG1SKY,SP70
          CALL     RDCCEG1  * Start
          IF       OVRCD=0
            CALL     RPCCEG1  * Start
          ENDIF
          CALL     DPSDL000
          GOTO     FPSDL999
FPSDL105
FPSDL999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPSDL000
.
          MATCH    "CCEG1",NAMSSFFI
          GOTO     LPSDL105 IF NOT EQUAL
          PACK     KEY28,CCEG1SKY,Z70
          CALL     RSCCEG1  * End
          IF       OVRCD=1
            CALL     RPCCEG1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEG1SNO
            CALL     RPCCEG1 
            IF       OVRCD=1
              MOVE     CCEG1SNO,SECTOR
            ENDIF
            PACK     CCEG1MKY,CCEGLV1,CCEGHCD,CCEGDPT,CCEGPCD                                                
            MATCH    CCEG1EKY,CCEG1MKY
            IF       !@EQUAL
              MOVE     CCEG1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPSDL000
          GOTO     LPSDL999
LPSDL105
LPSDL999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPSDL000
.
          MATCH    "CCEG1",NAMSSFFI
          GOTO     PPSDL120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPSDL105
          CALL      RFTCCEG1
          BRANCH   OVRCD,PPSDL115
          MOVE      CCEG1MKY,KEY28 
          CALL      RSCCEG1 
PPSDL110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCEG1SNO
            CALL     RPCCEG1 
            IF       OVRCD=1
              MOVE     CCEG1SNO,SECTOR
            ENDIF
            PACK     CCEG1MKY,CCEGLV1,CCEGHCD,CCEGDPT,CCEGPCD                                                
            MATCH    CCEG1EKY,CCEG1MKY
            IF       !@EQUAL
              MOVE     CCEG1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPSDL000
          GOTO     PPSDL999
PPSDL115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCEG1SNO
            CALL     RKCCEG1 
            IF       OVRCD=1
              MOVE     CCEG1SNO,SECTOR
            ENDIF
            PACK     CCEG1MKY,CCEGLV1,CCEGHCD,CCEGDPT,CCEGPCD                                                
            MATCH    CCEG1EKY,CCEG1MKY
            IF       !@EQUAL
              MOVE     CCEG1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPSDL999
PPSDL120
PPSDL999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPSDL000
          MATCH    "CCEG1",NAMSSFFI
          GOTO     NPSDL115 IF NOT EQUAL
NPSDL105
          CALL     RKCCEG1 
          BRANCH   OVRCD,NPSDL110
          PACK     CCEG1MKY,CCEGLV1,CCEGHCD,CCEGDPT,CCEGPCD                                                
          MATCH    CCEG1EKY,CCEG1MKY
          GOTO     NPSDL110 IF NOT EQUAL
          CALL     RPCCEG1 
          CALL     DPSDL000
          GOTO     NPSDL999
NPSDL110
          CALL     RPCCEG1 
          BEEP
          GOTO     NPSDL999
NPSDL115
NPSDL999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTSDL000
CTSDL105
CTSDL999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Select Department Details          
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Select Department Details          
.---------------------------------------------------------
DFSDL000
          BRANCH   ACCEPT,DFSDL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFSDL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFSDL900
          MATCH    PRGID,SCPSPID
          GOTO     DFSDL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFSDL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFSDL010 IF NOT EQUAL
.
          CALL     PSSDL000 * Display Field
          GOTO     DFSDL010
DFSDL900
          MOVE      "CCEG1",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      FPSDL000
DFSDL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Select Department Details          
.---------------------------------------------------------
PSSDL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSSDL999,PSSDL999,PSSDL999,PSSDL101:
                            PSSDL102,PSSDL103,PSSDL104,PSSDL105:
                            PSSDL106,PSSDL107,PSSDL108,PSSDL109:
                            PSSDL110,PSSDL111,PSSDL112,PSSDL113:
                            PSSDL114,PSSDL115,PSSDL116,PSSDL999:
                            PSSDL999,PSSDL999,PSSDL999,PSSDL999:
                            PSSDL999,PSSDL999,PSSDL999,PSSDL999:
                            PSSDL999,PSSDL999,PSSDL999,PSSDL999:
                            PSSDL999,PSSDL999,PSSDL999,PSSDL999:
                            PSSDL999,PSSDL999,PSSDL999,PSSDL999:
                           PSSDL999,PSSDL999,PSSDL999,PSSDL999
          GOTO     PSSDL999
.
PSSDL101
          MOVE      CCEFLV1,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL102
          MOVE      CCEFHCD,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL103
          MOVE      CCEFDPT,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL104
          MOVE      CCEFQTY,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL105
          MOVE      CCEFFTC,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL106
          MOVE      CCEFTTC,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL107
          MOVE      CCDPDES,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL108
          MOVE      AVGPRO1,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL109
          MOVE      AVGEPS1,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL110
          MOVE      AVGLOS1,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL111
          MOVE      AVGPRO2,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL112
          MOVE      AVGEPS2,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL113
          MOVE      AVGLOS2,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL114
          MOVE      AVGPRO,VAR       
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL115
          MOVE      TOTPER1,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL116
          MOVE      TOTPER2,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
PSSDL999
          RETURN
.---------------------------------------------------------
. Selections for : Select Department Details          
.---------------------------------------------------------
SFSDL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFSDL001  BRANCH   ACCEPT,SFSDL020
.
SFSDL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFSDL006,SFSDL101,SFSDL102,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL103:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                           SFSDL104,SFSDL105,SFSDL106,SFSDL107
SFSDL006  BEEP
          GOTO     SFSDL005
SFSDL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFSDL090
          MATCH    PRGID,SCSLPID
          GOTO     SFSDL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFSDL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL103:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                           SFSDL020,SFSDL020,SFSDL020,SFSDL020
          GOTO     SFSDL020
SFSDL090  MOVE     ZERO,ACCEPT
          MOVE      "CCEG1",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      FPSDL000
          GOTO     SFSDL001
.
SFSDL101
          MOVE      ZERO,EXIT
          GOTO      SFSDL999
.
SFSDL102
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFSDL999
.
SFSDL103
          CALL      SELECTED
          BRANCH    EXIT,SFSDL001
          COMPARE   ONE,ACCEPT
          GOTO      SFSDL001 IF EQUAL
          CALL      RDTCCEG1
          IF        OVRCD=1
            BEEP
            GOTO      SFSDL001
          ENDIF
          MATCH     SP70,CCEG1MKY
          IF        @EQUAL
            BEEP
            GOTO      SFSDL001
          ENDIF
          MOVE      CCEG1MKY,KEY28 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELPCD00
          MOVE      "SD",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCEG1
          IF        OVRCD=1
            CALL      FPSDL000
          ELSE
            MOVE      CCEG1MKY,KEY28 
            CALL      RSCCEG1 
            CALL      RPCCEG1 
            CALL      DPSDL000
          ENDIF
          GOTO     SFSDL001
.
SFSDL104
          MOVE      "CCEG1",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      NPSDL000
          GOTO     SFSDL001
.
SFSDL105
          MOVE      "CCEG1",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      PPSDL000
          GOTO     SFSDL001
.
SFSDL106
          MOVE      "CCEG1",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      FPSDL000
          GOTO     SFSDL001
.
SFSDL107
          MOVE      "CCEG1",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      LPSDL000
          GOTO     SFSDL001
SFSDL990  MOVE      ONE,EXIT * Exit Char Restart
SFSDL999  RETURN
.@@@@@ Function Restart Point @@@@@
.--------------------------------------------------
. Get Details for Level 1
.--------------------------------------------------
LV1DET00  SFORMAT   VAR,CCSTLEN
          MOVE      CCXHKEY,VAR
          PACK      LEV1DESC,VAR,SP1,CCXHDES
          SFORMAT   VAR,127
.
          PACK      KEY10,CCXHKEY,SP70
          CALL      RDCCEB1
          BRANCH    OVRCD,LV1DET90
.
          MOVE      CCEBFSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,FRCSDEV
          ASSIGN    CCEBFTC/CCEBNEP,FRCXBAR
          ASSIGN    CCEBFMX-CCEBFMN,FRCRANG
.
          MOVE      CCEBTSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,TOCSDEV
          ASSIGN    CCEBTTC/CCEBNEP,TOCXBAR
          ASSIGN    CCEBTMX-CCEBTMN,TOCRANG
.
          MOVE      CCEBLSV,CCVARIAN
          CALL      CALSD000
          MOVE      CCSTDDEV,LOSSDEV
          ASSIGN    CCEBLTO/CCEBNEP,LOSXBAR
          ASSIGN    CCEBLMX-CCEBLMN,LOSRANG
          GOTO      LV1DET99
.
LV1DET90  MOVE      ZERO,CCEBNEP
          MOVE      ZERO,CCEBFTC
          MOVE      ZERO,CCEBFMX
          MOVE      ZERO,CCEBFMN
          MOVE      ZERO,CCEBFSV
          MOVE      ZERO,FRCSDEV
          MOVE      ZERO,FRCXBAR
          MOVE      ZERO,FRCRANG
.
          MOVE      ZERO,CCEBTTC
          MOVE      ZERO,CCEBTMX
          MOVE      ZERO,CCEBTMN
          MOVE      ZERO,CCEBTSV
          MOVE      ZERO,TOCSDEV
          MOVE      ZERO,TOCXBAR
          MOVE      ZERO,TOCRANG
.
          MOVE      ZERO,CCEBLTO
          MOVE      ZERO,CCEBLMX
          MOVE      ZERO,CCEBLMN
          MOVE      ZERO,CCEBLSV
          MOVE      ZERO,LOSSDEV
          MOVE      ZERO,LOSXBAR
          MOVE      ZERO,LOSRANG
.
LV1DET99  RETURN
.------------------------------------------------------------
. Routine to Calculate Standard Deviation (CCSTDDEV)
.          given the Statistical Variance (CCVARIAN)
.------------------------------------------------------------
CALSD000  MOVE      ZERO,CCSTDDEV
          COMPARE   ZERO,CCVARIAN
          GOTO      CALSD999 IF EQUAL
          GOTO      CALSD999 IF LESS
          COMPARE   "999999999999.9999",CCVARIAN  * Out of Bounds
          GOTO      CALSD999 IF EQUAL
.
          MOVE      "10000",CCFACTOR
.
CALSD100  ADD       CCFACTOR,CCSTDDEV
          ASSIGN    (CCSTDDEV*CCSTDDEV),CCTSTVAR
          COMPARE   CCVARIAN,CCTSTVAR
          GOTO      CALSD999 IF EQUAL           * have the root
          GOTO      CALSD100 IF LESS
.
          SUB       CCFACTOR,CCSTDDEV
.
          DIV       "10",CCFACTOR
          COMPARE   ".00001",CCFACTOR
          GOTO      CALSD100 IF NOT EQUAL
.
CALSD999  RETURN
.----------------------------------------------------------------------
. Enter Casemix Extract ID
.----------------------------------------------------------------------
EEID0000  MOVE      ZERO,CKEYTYP
          CALL      CCSCOPCL         * Close Files
          CALL      KCCEAA00
          BRANCH    EXIT,EEID9999,EEID9999
          MATCH     "1",CCEARUA
          IF        !(@EQUAL)
            BEEP
            MOVE      "Resource Usage Analysis Not Calculated - ",DISPMSG
            CALL      MESSAGE1
            GOTO      EEID0000
          ENDIF
          CALL      GETCME00
          CALL      CCSCOPOP         * Open Files
EEID9999  RETURN
.======================================================================
. Determine Display Values for a Valid Casemix Extract Code
.======================================================================
GETCME00  MATCH     SP70,CCEAFDD
          IF        @EQUAL
            MOVE      "Start     ",FROMDD
          ELSE
            UNPACK    CCEAFDD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,FROMDD
          ENDIF
.
          MATCH     "99999999",CCEATDD
          IF        @EQUAL
            MOVE      "Finish    ",TODD
          ELSE
            UNPACK    CCEATDD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,TODD
          ENDIF
.
          MATCH     SP70,CCEAFAD
          IF        @EQUAL
            MOVE      "Start     ",FROMAD
          ELSE
            UNPACK    CCEAFAD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,FROMAD
          ENDIF
.
          MATCH     "99999999",CCEATAD
          IF        @EQUAL
            MOVE      "Finish    ",TOAD
          ELSE
            UNPACK    CCEATAD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,TOAD
          ENDIF
.
          MOVE     CCEAVIS,F1
          BRANCH   F1,GETCME10,GETCME20,GETCME30
          MOVE     "All        ",VISITDES
          GOTO     GETCME40
GETCME10  MOVE     "A & E      ",VISITDES
          GOTO     GETCME40
GETCME20  MOVE     "Outpatients ",VISITDES
          GOTO     GETCME40
GETCME30  MOVE     "Inpatients",VISITDES
          GOTO     GETCME40
.
GETCME40  MOVE     SP70,CLV1DES
          MOVE     SP70,CLV2DES
          MOVE     SP70,CLV3DES
.
          MATCH    SP70,CCEALV2
          IF       !@EQUAL
            MOVE     CCEALV2,KEY3
            CALL     RDCCST1
            MOVE     CCSTDES,CLV2DES
          ENDIF
.
          MATCH    SP70,CCEALV3
          IF       !@EQUAL
            MOVE     CCEALV3,KEY3
            CALL     RDCCST1
            MOVE     CCSTDES,CLV3DES
          ENDIF
.
          MOVE     CCEALV1,KEY3
          CALL     RDCCST1
          MOVE     CCSTDES,CLV1DES
.
          MATCH    SP70,CCEAFCM
          IF       @EQUAL
            MOVE     "Actual Costs",FROMCMOD
          ELSE
            MOVE     CCEAFCM,KEY4
            CALL     RDCCMA1
            MOVE     CCMADES,FROMCMOD
          ENDIF
.
          MATCH    SP70,CCEATCM
          IF       @EQUAL
            MOVE     "Actual Costs",TOCMOD
          ELSE
            MOVE     CCEATCM,KEY4
            CALL     RDCCMA1
            MOVE     CCMADES,TOCMOD
          ENDIF
.
          MOVE     CCEAHCD,KEY2
          CALL     RDCCHC1
.
          MOVE       CCEADAY,F1
          IF         F1=0
            MOVE       "Exclude Day Cases",DAYCDESC
          ELSE
            IF         F1=2
              MOVE       "Day Cases Only",DAYCDESC
            ELSE
              MOVE       "Include Day Cases",DAYCDESC
            ENDIF
          ENDIF
.
          RETURN
.--------------------------------------------------------------------
. Graph Level 1 Casemix Analysis
.--------------------------------------------------------------------
GPH1LV00  MOVE     ONE,GRAPHLEV
.
          MOVE     ZERO,ACCEPT
          CALL     SCGOL000
.
          RETURN
SEL1LV00  CALL     RDCCXH1
          BRANCH   OVRCD,SEL1LV99
          CALL     LV1DET00
.
          CALL     SC01L000
.
SEL1LV99  RETURN
.---------------------------------------------------------------------------
. Select Code
.-------------------------------------------------------------------------------
SELCM000  TOPIC     "CCXHKEY "
          DISPLAY   *P1:24,*EL,"Enter Code : "
          MOVE      "14",CCOL
          MOVE      "24",CVERT
.
          MOVE      CCEALV1,CCXHSTY
          MOVE      CCEALV1,KEY3
          CALL      RDCCST1
          SFORMAT   VAR,CCSTLEN
          MATCH     "1",CCSTJR
          IF        @EQUAL
            KEYIN     *PCCOL:CVERT,*V2LON,*JR,VAR
          ELSE
            KEYIN     *PCCOL:CVERT,*V2LON,VAR
          ENDIF
.
          MATCH     "1",CCSTZF
          IF        @EQUAL
            REP       " 0",VAR
          ENDIF
.
          DISPLAY     *PCCOL:CVERT,*V2LON,VAR
.
          ENDSET    VAR
          APPEND    SP70,VAR
          RESET     VAR
.
          MATCH     SP70,VAR
          GOTO      SELCM090 IF EQUAL
.
          MATCH     "1",CCSTJR
          IF        @EQUAL
            ENDSET    VAR
          ENDIF
          CMATCH    EXITCHAR,VAR
          GOTO      SELCM095 IF EQUAL
.
          CMATCH    QUEST,VAR
          GOTO      SELCM010 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCXHA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCXHKEY
          APPEND    SP70,CCXHKEY
          RESET     CCXHKEY
.
          MATCH     SP70,CCXHKEY
          GOTO      SELCM000 IF EQUAL
          MOVE      CCXHKEY,VAR
.
          DISPLAY   *PCCOL:CVERT,*V2LON,VAR
SELCM010
          RESET     VAR
          MATCH     "1",CCSTDE
          IF        @EQUAL
            TYPE      VAR
            GOTO      SELCM015 IF EQUAL
            BEEP
            GOTO      SELCM000
          ENDIF
SELCM015
          MOVE      VAR,CCXHKEY
          MOVE      VAR,CCEBLV1
          PACK      KEY13,CCXHSTY,VAR
          CALL      RACCXH1
          BRANCH    OVRCD,SELCM080
          CALL      RDCCXH1
          MOVE      ZERO,EXIT
          CALL      LV1DET00   * Calculate Details
          CALL      SEL1LV00   * Calculate Details
.
          GOTO      SELCM099
.
SELCM080  MOVE      ZERO,EXIT
          MOVE      "Code Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      SELCM000
.
SELCM085  MOVE      SP70,CCXHKEY
          MOVE      ZERO,EXIT
          GOTO      SELCM099
.
SELCM090  MOVE      SP70,CCXHKEY
          MOVE      ONE,EXIT
          GOTO      SELCM099
.
SELCM095  MOVE      TWO,EXIT
.
SELCM099  SFORMAT   VAR,127
          TOPIC     PRGID
          RETURN
.---------------------------------------------------------------------------
. Enter Casemix Code Level 1
.-------------------------------------------------------------------------------
KY01LV00  TOPIC     "CCXHKEY "
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          MOVE      CCEALV1,CCXHSTY
          MOVE      CCEALV1,KEY3
          CALL      RDCCST1
          SFORMAT   VAR,CCSTLEN
          MATCH     "1",CCSTJR
          IF        @EQUAL
            KEYIN     *PCCOL:CVERT,*V2LON,*JR,VAR
          ELSE
            KEYIN     *PCCOL:CVERT,*V2LON,VAR
          ENDIF
.
          MATCH     "1",CCSTZF
          IF        @EQUAL
            REP       " 0",VAR
          ENDIF
.
          DISPLAY     *PCCOL:CVERT,*V2LON,VAR
.
          ENDSET    VAR
          APPEND    SP70,VAR
          RESET     VAR
.
          MATCH     SP70,VAR
          GOTO      KY01LV90 IF EQUAL
.
          MATCH     "1",CCSTJR
          IF        @EQUAL
            ENDSET    VAR
          ENDIF
          CMATCH    EXITCHAR,VAR
          GOTO      KY01LV95 IF EQUAL
.
          CMATCH    QUEST,VAR
          GOTO      KY01LV10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCXHA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCXHKEY
          APPEND    SP70,CCXHKEY
          RESET     CCXHKEY
.
          MATCH     SP70,CCXHKEY
          GOTO      KY01LV00 IF EQUAL
          MOVE      CCXHKEY,VAR
.
          DISPLAY   *PCCOL:CVERT,*V2LON,VAR
KY01LV10
          RESET     VAR
          MATCH     "1",CCSTDE
          IF        @EQUAL
            TYPE      VAR
            GOTO      KY01LV15 IF EQUAL
            BEEP
            GOTO      KY01LV00
          ENDIF
KY01LV15
          MOVE      VAR,CCXHKEY
          MOVE      VAR,CCEBLV1
          PACK      KEY13,CCXHSTY,VAR
          CALL      RACCXH1
          BRANCH    OVRCD,KY01LV80
          CALL      RDCCXH1
          MOVE      ZERO,EXIT
          CALL      LV1DET00   * Calculate Details
          GOTO      KY01LV99
.
KY01LV80  MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KY01LV99,KY01LV99
          MOVE      "Code Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KY01LV00
.
KY01LV85  MOVE      SP70,CCXHKEY
          MOVE      ZERO,EXIT
          GOTO      KY01LV99
.
KY01LV90  MOVE      SP70,CCXHKEY
          MOVE      ONE,EXIT
          GOTO      KY01LV99
.
KY01LV95  MOVE      TWO,EXIT
.
KY01LV99  SFORMAT   VAR,127
          TOPIC     PRGID
          RETURN
.----------------------------------------------------------------------
. Calculate Values for Histogram
.----------------------------------
. GPHISVAL FORM  5[15]   Histogram Values 1 to 15
. GPHISOVR FORM  5       Histogram Value > 15
. GPHISUND FORM  5       Histogram Value < 1
. GPHISRHD DIM   12      Range Heading
. GPHISCHD DIM   12      Count Heading
. GPHISHED DIM   50      General Heading
. GPHISTOT FORM  5       Total
. GPHISMIN FORM  10      Minimum   Eg Start at 1000
. GPHISRAN FORM  10      Range     Increment by 1000
. GPHISMAX FORM  5       Maximum
. GPHISSCL FORM  5       Scale
. GPHISCNT FORM  2       Scale
.----------------------------------------------------------------------
H1DP0000  ASSIGN    CCEBLMN,GPHISMIN
          IF        GPHISMIN=0
            MOVE      "1",GPHISMIN
          ENDIF
          MOVE      "1",HISTTYPE
          MOVE      "1",GPHISRAN
H1DP0100  IF        HISTTYPE=1
            MOVE      "L.O.S.",GPHISRHD
          ELSE
            MOVE      "Cost",GPHISRHD
          ENDIF
          MOVE      "Episodes",GPHISCHD
          SFORMAT   VAR,CCSTLEN
          MOVE      CCXHKEY,VAR
          PACK      GPHISHED,VAR,SP1,CCXHDES
          SFORMAT   VAR,127
.
          MOVE      ZERO,GPHISCNT
          REPEAT
            ADD       ONE,GPHISCNT
            MOVE      ZERO,GPHISVAL[GPHISCNT]
          UNTIL     (GPHISCNT=15)
          MOVE      ZERO,GPHISOVR
          MOVE      ZERO,GPHISUND
.
          PACK      KEY48,CCEBLV1,SP70
          CALL      RSCCEC2
H1DP1000  CALL      RKCCEC2
          BRANCH    OVRCD,H1DP9000
          MATCH     CCEBLV1,CCECLV1
          GOTO      H1DP9000 IF NOT EQUAL
.
          LOAD      F12P2,HISTTYPE,CCECLOS,CCECFTC,CCECTTC
          ASSIGN    (F12P2-GPHISMIN)/GPHISRAN,F12P2
          MOVE      F12P2,GPHISCNT
          ADD       ONE,GPHISCNT
          IF        GPHISCNT<1
            ADD       ONE,GPHISUND
            GOTO      H1DP1000
          ENDIF
          IF        GPHISCNT>15
            ADD       ONE,GPHISOVR
            GOTO      H1DP1000
          ENDIF
.
          ADD       ONE,GPHISVAL[GPHISCNT]
          GOTO      H1DP1000
.
H1DP9000  CALL      GPHISDIS
          KEYIN     *P1:24,*EL,*V2LON,"S",*HOFF,"cale, ":
                               *V2LON,"T",*HOFF,"ype, Hit <":
                               *V2LON,"Enter",*HOFF,"> to Exit : ",ANS
          ENDSET    ANS
          APPEND    SP70,ANS
          RESET     ANS
          REP       UPPLOW,ANS
          MATCH     ANST,ANS
          GOTO      H1DP9100 IF EQUAL
          MATCH     ANSS,ANS
          GOTO      H1DP9200 IF EQUAL
          MATCH     SP70,ANS
          GOTO      H1DP9999 IF EQUAL
          BEEP
          GOTO      H1DP9000
.
H1DP9100  KEYIN     *P1:24,*EL,"Type :  ":
                    *V2LON,"1.",*HOFF," Length of Stay, ":
                    *V2LON,"2.",*HOFF," Cost 1, ":
                    *V2LON,"3.",*HOFF," Cost 2.  Enter Type : ",*V2LON,HISTTYPE
          BRANCH    HISTTYPE,H1DP9200,H1DP9200,H1DP9200
          BEEP
          GOTO      H1DP9100
.
H1DP9200  KEYIN     *P1:24,*EL,"Minimum Value : ",*V2LON,GPHISMIN,*HOFF:
                               "    Step : ",*V2LON,GPHISRAN,*HOFF:
                               "  Ok (",*V2LON,"Y",*HOFF,"/":
                                        *V2LON,"N",*HOFF,") ? ",*V2LON,ANS
          REP       UPPLOW,ANS
          MATCH     ANSY,ANS
          GOTO      H1DP0100 IF EQUAL
          GOTO      H1DP9200
.
H1DP9999  RETURN
.
.------------------------------------------------------------
. This will restart a program from any point with out the
. need to clear variables and stacks.
.------------------------------------------------------------
RESTARTP  CHAIN    PRGID
.
.----------------------------------------------------------------------
. Enter Code Range
.----------------------------------------------------------------------
GETDPT00  PACK      KEY2,CCEFHCD
          CALL      RDCCHC1
.
          PACK      KEY10,CCEFHCD,CCEFDPT
          CALL      RDCCDP1
.
          ASSIGN    CCEFQTY/CCEBNEP,AVGPRO
.
          ASSIGN    CCEFFTC/CCEBNEP,AVGEPS1
          ASSIGN    CCEFTTC/CCEBNEP,AVGEPS2
          ASSIGN    CCEFFTC/CCEBLTO,AVGLOS1
          ASSIGN    CCEFTTC/CCEBLTO,AVGLOS2
          ASSIGN    CCEFFTC/CCEFQTY,AVGPRO1
          ASSIGN    CCEFTTC/CCEFQTY,AVGPRO2
.
          ASSIGN    (CCEFFTC/CCEBFTC)*100.0,TOTPER1
          ASSIGN    (CCEFTTC/CCEBTTC)*100.0,TOTPER2
.
          RETURN
.----------------------------------------------------------------------
. Enter Code Range
.----------------------------------------------------------------------
SELDPT00  CALL      RDCCEF1
.
          PACK      KEY2,CCEFHCD
          CALL      RDCCHC1
          PACK      KEY10,CCEFHCD,CCEFDPT
          CALL      RDCCDP1
.
          ASSIGN    CCEFQTY/CCEBNEP,AVGPRO
.
          ASSIGN    CCEFFTC/CCEBNEP,AVGEPS1
          ASSIGN    CCEFTTC/CCEBNEP,AVGEPS2
          ASSIGN    CCEFFTC/CCEBLTO,AVGLOS1
          ASSIGN    CCEFTTC/CCEBLTO,AVGLOS2
          ASSIGN    CCEFFTC/CCEFQTY,AVGPRO1
          ASSIGN    CCEFTTC/CCEFQTY,AVGPRO2
.
          ASSIGN    (CCEFFTC/CCEBFTC)*100.0,TOTPER1
          ASSIGN    (CCEFTTC/CCEBTTC)*100.0,TOTPER2
.
          CALL      SCSDL000
.
          RETURN
GETEPS00  PACK     KEY18,CCECHCD,CCECEPS
          CALL     RDCCEP1
          RETURN
SELEPS00  CALL     RDCCEC2
          BRANCH   OVRCD,SELEPS99
          PACK     KEY18,CCEAHCD,CCECEPS
          CALL     RDCCEP1
          BRANCH   OVRCD,SELEPS99
          MOVE     CCXHDES,KEY35
          MOVE     SP70,DESC01
          MOVE     SP70,DESC02
          MOVE     SP70,DESC03
.
          PACK     KEY13,CCEALV1,CCECLV1
          CALL     RDCCXH1
          IF       OVRCD=0
            MOVE     CCXHDES,DESC01
          ENDIF
.
          PACK     KEY13,CCEALV2,CCECLV2
          CALL     RDCCXH1
          IF       OVRCD=0
            MOVE     CCXHDES,DESC02
          ENDIF
.
          PACK     KEY13,CCEALV3,CCECLV3
          CALL     RDCCXH1
          IF       OVRCD=0
            MOVE     CCXHDES,DESC03
          ENDIF
.
          MOVE     KEY35,CCXHDES
.
. Display Episode Details Screen
.
          CALL     SCESL000
.
SELEPS99  RETURN
.------------------------------------------------------------
. Get Item Details
.------------------------------------------------------------
PCDDET00  PACK      KEY10,CCUPHCD,CCUPDPT
          CALL      RDCCDP1
.
          PACK      KEY18,CCUPHCD,CCUPDPT,CCUPPCD
          CALL      RDCCPD1
.
          PACK      KEY18,CCUPHCD,CCUPDPT,CCUPPCD
          CALL      RDCCPD1
.
          CALL      CALFR000
.
          CALL      CALTO000
.
          RETURN
.------------------------------------------------------------
. Calculate "From" Comparision Costs
.------------------------------------------------------------
CALFR000  PACK      KEY18,CCEAFYR,CCEAFCM,CCUPHCD,CCUPPCD
          CALL      RDCCMS1
          IF        OVRCD=1
            PACK      KEY26,CCEAFYR,CCEAFCM,CCUPHCD,CCUPDPT,CCUPPCD
            CALL      RDCCMT1
            IF        OVRCD=1
              MOVE      ZERO,CCMSUCT
              MOVE      ZERO,CCMSFIX
              MOVE      ZERO,CCMSFUC
            ELSE
              MOVE      CCMTUCT,CCMSUCT
              MOVE      CCMTFIX,CCMSFIX
              MOVE      CCMTFUC,CCMSFUC
            ENDIF
          ENDIF
          IF        CCMSFIX=1
            ASSIGN    CCUPQTY*CCMSFUC,COST1AMT
          ELSE
            ASSIGN    CCUPQTY*CCMSUCT,COST1AMT
          ENDIF
          RETURN
.------------------------------------------------------------
. Calculate "To" Comparision Costs
.------------------------------------------------------------
CALTO000  PACK      KEY18,CCEATYR,CCEATCM,CCUPHCD,CCUPPCD
          CALL      RDCCMS1
          IF        OVRCD=1
            PACK      KEY26,CCEAFYR,CCEAFCM,CCUPHCD,CCUPDPT,CCUPPCD
            CALL      RDCCMT1
            IF        OVRCD=1
              MOVE      ZERO,CCMSUCT
              MOVE      ZERO,CCMSFIX
              MOVE      ZERO,CCMSFUC
            ELSE
              MOVE      CCMTUCT,CCMSUCT
              MOVE      CCMTFIX,CCMSFIX
              MOVE      CCMTFUC,CCMSFUC
            ENDIF
          ENDIF
          IF        CCMSFIX=1
            ASSIGN    CCUPQTY*CCMSFUC,COST2AMT
          ELSE
            ASSIGN    CCUPQTY*CCMSUCT,COST2AMT
          ENDIF
          RETURN
.--------------------------------------------------------------------
. Graph Level 1 Casemix Analysis
.--------------------------------------------------------------------
GRAPH000  CALL    OPNGRAPH
.
          MOVE    "10",GPHNOCOX
          MOVE    "30",GPHNOCOY
          MOVE    ZERO,GPHNTYP
          MOVE    ONE,SECTOR
.
          IF      GPHEPS=1
            MOVE    "No. of Episodes",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
.
          IF      GPHLTO=1
            MOVE    "Total LOS",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHLAV=1
            MOVE    "Avg. LOS",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHLMN=1
            MOVE    "Min. LOS",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHLMX=1
            MOVE    "Max. LOS",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
.
          IF      GPHFTO=1
            MOVE    "Total Cost 1",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHFAV=1
            MOVE    "Avg. Cost 1",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHFMN=1
            MOVE    "Min. Cost 1",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHFMX=1
            MOVE    "Max. Cost 1",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
.
          IF      GPHTTO=1
            MOVE    "Total Cost 2",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHTAV=1
            MOVE    "Avg. Cost 2",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHTMN=1
            MOVE    "Min. Cost 2",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHTMX=1
            MOVE    "Max. Cost 2",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
.
          IF      GPHNTYP=GPHNOCOY
            ADD     ONE,GPHNOCOX
            ADD     ONE,GPHNOCOY
          ENDIF
          IF      GPHNTYP>GPHNOCOY
            MOVE    GPHNTYP,GPHNOCOX
            MOVE    GPHNTYP,GPHNOCOY
            ADD     ONE,GPHNOCOX
            ADD     ONE,GPHNOCOY
          ENDIF
.
          MOVE      ZERO,CCPERCNT
          DISPLAY   *P70:2,*BLINKON," Loading "
.
          CALL     L1GPH000
          CLEAR    GPHNAME
          APPEND   "Casemix Extract Level 1 - ",GPHNAME
          STRIP    CLV1DES
          APPEND   CLV1DES,GPHNAME
          RESET    GPHNAME
.
GRAPH800  MOVE    ZERO,HLEF
          HLINE   *G37,2,70,80
          CALL    GETSCR00
.
          MOVE    ONE,GPHTYPE
          CALL    DISGRAPH
          CALL    CLSGRAPH
.
          CALL    PUTSCR00
.
          RETURN
.
GRAPHWRT  ADD     ONE,F3
          MOVE    F3,SCGPITM
          MOVE     F12P2,SCGPVAL
          PACK    KEY6,SCGPPER,SCGPITM
          CALL    RASCGP1
          IF      OVRCD=0
            CALL    UPSCGP1
          ELSE
            CALL    WRSCGP1
          ENDIF
          RETURN
.--------------------------------------------------------
. Graph Casemix Level 1
.--------------------------------------------------------
L1GPH000  MOVE      ZERO,SECTOR
          PACK      KEY10,SP70
          CALL      RSCCEB1
L1GPH100  CALL      RKCCEB1
          BRANCH    OVRCD,L1GPH200
          ADD       ONE,SECTOR
          COMPARE   "100",SECTOR
          GOTO      L1GPH200 IF EQUAL
.
          PACK      KEY13,CCEALV1,CCEBLV1
          CALL      RDCCXH1
          IF        OVRCD=1
            MOVE      SP70,CCXHDES
          ENDIF
.
          ADD       ONE,CCPERCNT
          MOVE      CCPERCNT,SCGPPER
          SFORMAT   VAR,CCSTLEN
          MOVE      CCEBLV1,VAR
          PACK      SCGPDES,VAR,SP1,CCXHDES     * mmm yy
          SFORMAT   VAR,127
          MOVE      ONE,F3
.
          IF      GPHEPS=1
            MOVE     CCEBNEP,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHLTO=1
            MOVE     CCEBLTO,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLAV=1
            ASSIGN   CCEBLTO/CCEBNEP,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLMN=1
            MOVE     CCEBLMN,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHLMX=1
            MOVE     CCEBLMX,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHFTO=1
            MOVE     CCEBFTC,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFAV=1
            ASSIGN   CCEBFTC/CCEBNEP,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFMN=1
            MOVE     CCEBFMN,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHFMX=1
            MOVE     CCEBFMX,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          IF      GPHTTO=1
            MOVE     CCEBTTC,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHTAV=1
            ASSIGN   CCEBTTC/CCEBNEP,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHTMN=1
            MOVE     CCEBTMN,F12P2
            CALL     GRAPHWRT
          ENDIF
          IF      GPHTMX=1
            MOVE     CCEBTMX,F12P2
            CALL     GRAPHWRT
          ENDIF
.
          GOTO    L1GPH100
.
L1GPH200
          RETURN
.
GPHEPS00  IF      GPHEPS=0
            MOVE    ONE,GPHEPS
          ELSE
            MOVE    ZERO,GPHEPS
          ENDIF
          RETURN
.
GPHLTO00  IF      GPHLTO=0
            MOVE    ONE,GPHLTO
          ELSE
            MOVE    ZERO,GPHLTO
          ENDIF
          RETURN
.
GPHLAV00  IF      GPHLAV=0
            MOVE    ONE,GPHLAV
          ELSE
            MOVE    ZERO,GPHLAV
          ENDIF
          RETURN
.
GPHLMX00  IF      GPHLMX=0
            MOVE    ONE,GPHLMX
          ELSE
            MOVE    ZERO,GPHLMX
          ENDIF
          RETURN
.
GPHLMN00  IF      GPHLMN=0
            MOVE    ONE,GPHLMN
          ELSE
            MOVE    ZERO,GPHLMN
          ENDIF
          RETURN
.
GPHFTO00  IF      GPHFTO=0
            MOVE    ONE,GPHFTO
          ELSE
            MOVE    ZERO,GPHFTO
          ENDIF
          RETURN
.
GPHFAV00  IF      GPHFAV=0
            MOVE    ONE,GPHFAV
          ELSE
            MOVE    ZERO,GPHFAV
          ENDIF
          RETURN
.
GPHFMX00  IF      GPHFMX=0
            MOVE    ONE,GPHFMX
          ELSE
            MOVE    ZERO,GPHFMX
          ENDIF
          RETURN
.
GPHFMN00  IF      GPHFMN=0
            MOVE    ONE,GPHFMN
          ELSE
            MOVE    ZERO,GPHFMN
          ENDIF
          RETURN
.
GPHTTO00  IF      GPHTTO=0
            MOVE    ONE,GPHTTO
          ELSE
            MOVE    ZERO,GPHTTO
          ENDIF
          RETURN
.
GPHTAV00  IF      GPHTAV=0
            MOVE    ONE,GPHTAV
          ELSE
            MOVE    ZERO,GPHTAV
          ENDIF
          RETURN
.
GPHTMX00  IF      GPHTMX=0
            MOVE    ONE,GPHTMX
          ELSE
            MOVE    ZERO,GPHTMX
          ENDIF
          RETURN
.
GPHTMN00  IF      GPHTMN=0
            MOVE    ONE,GPHTMN
          ELSE
            MOVE    ZERO,GPHTMN
          ENDIF
          RETURN
.----------------------------------------------------------------------
. Enter Code Range
.----------------------------------------------------------------------
PCDGET00
          PACK      KEY18,CCEGHCD,CCEGDPT,CCEGPCD
          CALL      RDCCPD1
.
          ASSIGN    CCEGQTY/CCEBNEP,PAVGPRO
.
          ASSIGN    CCEGFTC/CCEBNEP,PAVGEPS1
          ASSIGN    CCEGTTC/CCEBNEP,PAVGEPS2
          ASSIGN    CCEGFTC/CCEBLTO,PAVGLOS1
          ASSIGN    CCEGTTC/CCEBLTO,PAVGLOS2
          ASSIGN    CCEGFTC/CCEGQTY,PAVGPRO1
          ASSIGN    CCEGTTC/CCEGQTY,PAVGPRO2
.
          ASSIGN    (CCEGFTC/CCEBFTC)*100.0,PTOTPER1
          ASSIGN    (CCEGTTC/CCEBTTC)*100.0,PTOTPER2
.
          RETURN
PCDSEL00  CALL      RDCCEG1
.
          PACK      KEY2,CCEGHCD
          CALL      RDCCHC1
          PACK      KEY10,CCEGHCD,CCEGDPT
          CALL      RDCCDP1
          PACK      KEY18,CCEGHCD,CCEGDPT,CCEGPCD
          CALL      RDCCPD1
.
          ASSIGN    CCEGQTY/CCEBNEP,PAVGPRO
.
          ASSIGN    CCEGFTC/CCEBNEP,PAVGEPS1
          ASSIGN    CCEGTTC/CCEBNEP,PAVGEPS2
          ASSIGN    CCEGFTC/CCEBLTO,PAVGLOS1
          ASSIGN    CCEGTTC/CCEBLTO,PAVGLOS2
          ASSIGN    CCEGFTC/CCEGQTY,PAVGPRO1
          ASSIGN    CCEGTTC/CCEGQTY,PAVGPRO2
.
          ASSIGN    (CCEGFTC/CCEBFTC)*100.0,PTOTPER1
          ASSIGN    (CCEGTTC/CCEBTTC)*100.0,PTOTPER2
.
          CALL      SCPBL000
.
          RETURN
GETPCD00
          PACK      KEY18,CCEGHCD,CCEGDPT,CCEGPCD
          CALL      RDCCPD1
.
          ASSIGN    CCEGQTY/CCEBNEP,PAVGPRO
.
          ASSIGN    CCEGFTC/CCEBNEP,PAVGEPS1
          ASSIGN    CCEGTTC/CCEBNEP,PAVGEPS2
          ASSIGN    CCEGFTC/CCEBLTO,PAVGLOS1
          ASSIGN    CCEGTTC/CCEBLTO,PAVGLOS2
          ASSIGN    CCEGFTC/CCEGQTY,PAVGPRO1
          ASSIGN    CCEGTTC/CCEGQTY,PAVGPRO2
.
          ASSIGN    (CCEGFTC/CCEFFTC)*100.0,PTOTPER1
          ASSIGN    (CCEGTTC/CCEFTTC)*100.0,PTOTPER2
.
          RETURN
.----------------------------------------------------------------------
. Enter Code Range
.----------------------------------------------------------------------
SELPCD00  CALL      RDCCEG1
.
          PACK      KEY2,CCEGHCD
          CALL      RDCCHC1
          PACK      KEY10,CCEGHCD,CCEGDPT
          CALL      RDCCDP1
          PACK      KEY18,CCEGHCD,CCEGDPT,CCEGPCD
          CALL      RDCCPD1
.
          ASSIGN    CCEGQTY/CCEBNEP,PAVGPRO
.
          ASSIGN    CCEGFTC/CCEBNEP,PAVGEPS1
          ASSIGN    CCEGTTC/CCEBNEP,PAVGEPS2
          ASSIGN    CCEGFTC/CCEBLTO,PAVGLOS1
          ASSIGN    CCEGTTC/CCEBLTO,PAVGLOS2
          ASSIGN    CCEGFTC/CCEGQTY,PAVGPRO1
          ASSIGN    CCEGTTC/CCEGQTY,PAVGPRO2
.
          ASSIGN    (CCEGFTC/CCEFFTC)*100.0,PTOTPER1
          ASSIGN    (CCEGTTC/CCEFTTC)*100.0,PTOTPER2
.
          CALL      SCPDL000
.
          RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CCSCEAIO/INC
          INC       CCSCEAKY    
          INC       CCSCEBIO/INC
          INC       CCSCECIO/INC
          INC       CCSCEDIO/INC
          INC       CCSCEEIO/INC
          INC       CCSCEFIO/INC
          INC       CCSCEGIO/INC
          INC       CCSCMAIO/INC
          INC       CCSCOPCD    
          INC       CCSDPTIO/INC
          INC       CCSEPSIO/INC
          INC       CCSHCDIO/INC
          INC       CCSMSCIO/INC
          INC       CCSMTSIO/INC
          INC       CCSPDPIO/INC
          INC       CCSSTYIO/INC
          INC       CCSUPDIO/INC
          INC       CCSXHDIO/INC
          INC       CCSXHDKY    
          INC       GPHHISCD    
          INC       GPHSTDCD    
.
          INC       STDGENCD
.
