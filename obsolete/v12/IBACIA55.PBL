.-------------------------------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.01  09.07.2002  Glenn Saunders
.           Recompile for changes in includes shared with Southland, but with
.           previously different formats - now merged.  Includes effected :-
.           CCSCEAFD, CCSCONFD, CCSEPSFD, CCSHCDFD, CCSHLCFD, CCSIADFD
.-------------------------------------------------------
. V9.02.00  14.06.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.           Remove PSN prefixed PAS cloned includes
.-------------------------------------------------------
. VF.09.01  18.12.2001 Glenn Saunders  srf:14575
.           Recompile for changes in CCSG58CD
. VF.09.B01 22.11.2000 Sandra Barcham
.           Allow for changed ccsepsaf
.-------------------------------------------------------
. V6.06.02  15.12.1999 Charles Handaya
.           Fixed DRG Codes
. V6.06.01  30.07.1999 B.G.Ackland
.           Fix Range and Analysis Measure Delete
.-------------------------------------------------------
. V6.04.01  04.08.1996 B.G.Ackland
.           Fix File Delete for Oracle
.-------------------------------------------------------
. V6.03.02  30.10.1995 B.G.Ackland
.           Phase 1 WGH Changes
. V6.03.00  02.10.1995 B.G.Ackland
.           Release 6.03
.-------------------------------------------------------
. V6.01.04  14.07.1995 B.G.Ackland
.           Added Casemix Type 58 & 59 for Theatre Band
. V6.01.03  20.06.1995 B.G.Ackland
.           Added Casemix Type 56 & 57 for Day of Adm & Dis
. V6.01.02  28.12.1994 B.G.Ackland
.           Remove Payment Model Analysis & Admission Date Range
. V6.01.00  30.12.1993 B.G.Ackland
.           New Patient Service Costing Analysis
.-------------------------------------------------------------------------------
. V6.00.02  15.12.1993 B.G.Ackland
.           Day Case Only Option
. V6.00.01  08.11.1993 B.G.Ackland
.           Fix Casemix Type 15 to CCEPASER Not CCEPDSER
.           Use Include CCSGETCD. Fix File Delete.
.-------------------------------------------------------------------------------
BEDCALC   FORM      1
COMMAND   DIM       80
EXCOMPS   FORM      1
EXTRSUMM  FORM      1
F12P4     FORM      12.4
FILENAME  DIM       8
FLAGCEAS  FORM      1
NUMBER    FORM      2
PATMBSOP  FORM      1
PDIA01    DIM       9
POPP01    DIM       9
SDIA01    DIM       9
SOPP01    DIM       9
THEBAND   DIM       10
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACIA55
.   Function      :   Casemix Extract Generation              
.   Generated  On :   09/07/2002
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CCSAGEFD/INC
          INC       CCSCEAFD/INC
          INC       CCSCEBFD/INC
          INC       CCSCECFD/INC
          INC       CCSCEDFD/INC
          INC       CCSCEEFD/INC
          INC       CCSCEFFD/INC
          INC       CCSCEGFD/INC
          INC       CCSCEXFD/INC
          INC       CCSCONFD/INC
          INC       CCSDRGFD/INC
          INC       CCSEPSFD/INC
          INC       CCSEYAFD/INC
          INC       CCSHCDFD/INC
          INC       CCSIADFD/INC
          INC       CCSSTYFD/INC
          INC       CCSXHDFD/INC
          INC       CEAPMDFD/INC
          INC       CEAPPMFD/INC
          INC       PATITMFD/INC
.=========================
.Local Variable Definition
.-------------------------
FROMDD    DIM      10 * Scr 00 Fld    18
TODD      DIM      10 * Scr 00 Fld    19
FROMAD    DIM      10 * Scr 00 Fld    20
TOAD      DIM      10 * Scr 00 Fld    21
VISITDES  DIM      15 * Scr 00 Fld    22
INCMDES   DIM      35 * Scr 00 Fld    25
CSTMDES   DIM      35 * Scr 00 Fld    26
TOTALEPS  FORM      6 * Scr 00 Fld    27
TOTALEXT  FORM      6 * Scr 00 Fld    28
EXTRBRAN  FORM      3 * Scr 00 Fld    29
CLV1DES   DIM      35 * Scr 00 Fld    30
CLV2DES   DIM      35 * Scr 00 Fld    31
CLV3DES   DIM      35 * Scr 00 Fld    32
COST1AMT  FORM     12.2 * Scr 00 Fld    33
COST2AMT  FORM     12.2 * Scr 00 Fld    34
EPISODE   FORM      1 * Scr 00 Fld    35
EXSTR     DIM      10 * Scr 00 Fld    37
EXEND     DIM      10 * Scr 00 Fld    38
AGERANGE  DIM       3 * Scr 00 Fld    39
DAYCDESC  DIM      25 * Scr 00 Fld    40
ITHEDESC  DIM      10 * Scr 00 Fld    42
CTHEDESC  DIM      10 * Scr 00 Fld    44
CASPAYTP  DIM       1 * Scr 00 Fld    45
DESC01    DIM      35 * Scr 01 Fld     5
FROM01    DIM      35 * Scr 01 Fld     6
TO01      DIM      35 * Scr 01 Fld     7
DESC02    DIM      35 * Scr 01 Fld     8
FROM02    DIM      35 * Scr 01 Fld     9
TO02      DIM      35 * Scr 01 Fld    10
DESC03    DIM      35 * Scr 01 Fld    11
FROM03    DIM      35 * Scr 01 Fld    12
TO03      DIM      35 * Scr 01 Fld    13
DESC04    DIM      35 * Scr 01 Fld    14
FROM04    DIM      35 * Scr 01 Fld    15
TO04      DIM      35 * Scr 01 Fld    16
DESC05    DIM      35 * Scr 01 Fld    17
FROM05    DIM      35 * Scr 01 Fld    18
TO05      DIM      35 * Scr 01 Fld    19
DESC06    DIM      35 * Scr 01 Fld    20
FROM06    DIM      35 * Scr 01 Fld    21
TO06      DIM      35 * Scr 01 Fld    22
DESC07    DIM      35 * Scr 01 Fld    23
FROM07    DIM      35 * Scr 01 Fld    24
TO07      DIM      35 * Scr 01 Fld    25
DESC08    DIM      35 * Scr 01 Fld    26
FROM08    DIM      35 * Scr 01 Fld    27
TO08      DIM      35 * Scr 01 Fld    28
DESC09    DIM      35 * Scr 01 Fld    29
FROM09    DIM      35 * Scr 01 Fld    30
TO09      DIM      35 * Scr 01 Fld    31
DESC10    DIM      35 * Scr 01 Fld    32
FROM10    DIM      35 * Scr 01 Fld    33
TO10      DIM      35 * Scr 01 Fld    34
DESC11    DIM      35 * Scr 01 Fld    35
FROM11    DIM      35 * Scr 01 Fld    36
TO11      DIM      35 * Scr 01 Fld    37
DESC12    DIM      35 * Scr 01 Fld    38
FROM12    DIM      35 * Scr 01 Fld    39
TO12      DIM      35 * Scr 01 Fld    40
DESC13    DIM      35 * Scr 01 Fld    41
FROM13    DIM      35 * Scr 01 Fld    42
TO13      DIM      35 * Scr 01 Fld    43
DESC14X   DIM      35 * Scr 01 Fld    44
FROM14    DIM      35 * Scr 01 Fld    45
TO14      DIM      35 * Scr 01 Fld    46
EXRANGE   FORM      1 * Scr 01 Fld    50
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACIA55"
PRGNAM    INIT      "Casemix Extract Generation              "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      GETCON00
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening ccsageaf";
          OPEN      CCSAGEA1,"ccsageaf"
          DISPLAY   *P56:24,"Opening ccsageaf";
          OPEN      CCSAGEA2,"ccsageaf"
          MOVE      "   64",AUDTSECT
          MOVE      " 38",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ccsaudia";
            OPEN      CCSAUDIA,"ccsaudia"
          ENDIF
          DISPLAY   *P56:24,"Opening ccsceaaf";
          OPEN      CCSCEAA1,"ccsceaaf"
          DISPLAY   *P56:24,"Opening ccscexaf";
          OPEN      CCSCEXA1,"ccscexaf"
          DISPLAY   *P56:24,"Opening ccsdrgaf";
          OPEN      CCSDRGA1,"ccsdrgaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA1,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA2,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA3,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA4,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA5,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccseyaaf";
          OPEN      CCSEYAA1,"ccseyaaf"
          DISPLAY   *P56:24,"Opening ccshcdaf";
          OPEN      CCSHCDA1,"ccshcdaf"
          DISPLAY   *P56:24,"Opening ccshcdaf";
          OPEN      CCSHCDA2,"ccshcdaf"
          DISPLAY   *P56:24,"Opening ccsiadaf";
          OPEN      CCSIADA1,"ccsiadaf"
          DISPLAY   *P56:24,"Opening ccsstyaf";
          OPEN      CCSSTYA1,"ccsstyaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA1,"ccsxhdaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA2,"ccsxhdaf"
          DISPLAY   *P56:24,"Opening ceapmdaf";
          OPEN      CEAPMDA1,"ceapmdaf"
          DISPLAY   *P56:24,"Opening ceappmaf";
          OPEN      CEAPPMA1,"ceappmaf"
          DISPLAY   *P56:24,"Opening  patitemn           ";
          OPEN      PATITEM1,"patitemn"          
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Options                            
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Range Options for Casemix Analysis 
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Analysis Measures                  
          ENDIF
          RETURN
.--------------------------------
. Screen - Options                            
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Options                            
.-------------------------------------------------------
CF00L000
          MOVE      SP70,CCEAEID 
          MOVE      SP70,CCEADES 
          MOVE      SP70,CCEAINC 
          MOVE      SP70,CCEAVIS 
          MOVE      SP70,CCEADAY 
          MOVE      SP70,CCEALV1 
          MOVE      SP70,CCEALV2 
          MOVE      SP70,CCEALV3 
          MOVE      SP70,CCEAUST 
          MOVE      SP70,CCEAIMOD
          MOVE      SP70,CCEACMOD
          MOVE      SP70,FROMDD  
          MOVE      SP70,FROMAD  
          MOVE      SP70,CCEAITHE
          MOVE      SP70,CCEACTHE
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Options                            
.--------------------------------------------------------
KY00L000
.
KY00L110
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      EEID0000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      OVRCD,ACCEPT
          MOVE      CCEAEID,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Options                            
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Options                            
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Options                            
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Options                            
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L101,PS00L102,PS00L103:
                            PS00L104,PS00L105,PS00L106,PS00L107:
                            PS00L108,PS00L109,PS00L999,PS00L110:
                            PS00L111,PS00L112,PS00L113,PS00L114:
                            PS00L115,PS00L116,PS00L999,PS00L117:
                            PS00L118,PS00L119,PS00L120,PS00L121:
                            PS00L122,PS00L123,PS00L124,PS00L125:
                            PS00L126,PS00L127,PS00L128,PS00L999:
                           PS00L129,PS00L130,PS00L131,PS00L132:
                            PS00L133,PS00L134,PS00L135,PS00L136:
                            PS00L137
          GOTO     PS00L999
.
PS00L101
          MOVE      CCEADES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      CCEAHCD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEAINC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      CCEAVIS,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      CCEADAY,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      CCEALV1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      CCEALV2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      CCEALV3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEAUST,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      CCEAIMOD,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      CCEACMOD,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      FROMDD,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      TODD,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      FROMAD,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      TOAD,VAR         
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      VISITDES,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          MOVE      CCHCDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      INCMDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      CSTMDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE      TOTALEPS,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          MOVE      TOTALEXT,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      EXTRBRAN,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          MOVE      CLV1DES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          MOVE      CLV2DES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          MOVE      CLV3DES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L126
          MOVE      COST1AMT,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L127
          MOVE      COST2AMT,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L128
          MOVE      EPISODE,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L129
          MOVE      EXSTR,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L130
          MOVE      EXEND,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L131
          MOVE      AGERANGE,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L132
          MOVE      DAYCDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L133
          MOVE      CCEAITHE,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L134
          MOVE      ITHEDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L135
          MOVE      CCEACTHE,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L136
          MOVE      CTHEDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L137
          MOVE      CASPAYTP,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Options                            
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L006,SF00L104,SF00L006,SF00L105:
                            SF00L106,SF00L107,SF00L108,SF00L109:
                            SF00L110,SF00L111,SF00L112,SF00L113:
                            SF00L114,SF00L115,SF00L006,SF00L116:
                            SF00L006,SF00L006,SF00L117,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L118,SF00L006,SF00L119,SF00L006:
                            SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L104,SF00L020,SF00L105:
                            SF00L106,SF00L107,SF00L108,SF00L109:
                            SF00L110,SF00L111,SF00L020,SF00L113:
                            SF00L114,SF00L115,SF00L020,SF00L116:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L118,SF00L020,SF00L119,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      DELT0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      POST0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL     SELECTED
          STRIP     CCEADES 
          SFORMAT   VAR,SCPSLEN
          MOVE      CCEADES,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CCEADES 
          SFORMAT   VAR,127
          ENDSET    CCEADES 
          APPEND    SP70,CCEADES 
          RESET     CCEADES 
          CMATCH    EXITCHAR,CCEADES 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CCEADES 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L104
            ENDIF
          ENDIF
          MOVE      CCEADES,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L105
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CCEAINC 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEAINC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L106
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,VISITDES
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EVIS0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L106
            ENDIF
            BRANCH    EXIT,SF00L106,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CCEAVIS,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      VISITDES,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L107
.
.
          MOVE      "   40",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DAYCDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL      DEFAULTN
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EDAYC000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L107
            ENDIF
            BRANCH    EXIT,SF00L107,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CCEADAY,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   40",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DAYCDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L108
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CLV1DES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECLV1000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L108
            ENDIF
            BRANCH    EXIT,SF00L108,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CCEALV1,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CLV1DES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L109
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEALV3 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CLV2DES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECLV2000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L109
            ENDIF
            BRANCH    EXIT,SF00L109,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CCEALV2,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEALV3,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CLV2DES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L110
.
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CLV3DES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECLV3000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L110
            ENDIF
            BRANCH    EXIT,SF00L110,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CCEALV3,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CLV3DES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L111
          CALL      DEFAULTY
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CCEAUST 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEAUST,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L112
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC02L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L113
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,INCMDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EINCM000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L113
            ENDIF
            BRANCH    EXIT,SF00L113,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CCEAIMOD,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      INCMDES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L114
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CSTMDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECSTM000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L114
            ENDIF
            BRANCH    EXIT,SF00L114,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CCEACMOD,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CSTMDES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L115
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TODD    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RDDAT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L115
            ENDIF
            BRANCH    EXIT,SF00L115,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMDD,VAR       
          CALL      DISPITEM
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TODD,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L116
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOAD    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RADAT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L116
            ENDIF
            BRANCH    EXIT,SF00L116,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMAD,VAR       
          CALL      DISPITEM
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOAD,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L117
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC01L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L118
.
.
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,ITHEDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KITHE000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L118
            ENDIF
            BRANCH    EXIT,SF00L118,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CCEAITHE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ITHEDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L119
.
.
          MOVE      "   44",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CTHEDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCTHE000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L119
            ENDIF
            BRANCH    EXIT,SF00L119,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      CCEACTHE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   44",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CTHEDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Range Options for Casemix Analysis 
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC01L200
          CALL      CF01L000 * Clear Fields
          CALL      GETEXT00
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Range Options for Casemix Analysis 
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Range Options for Casemix Analysis 
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Range Options for Casemix Analysis 
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Range Options for Casemix Analysis 
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Range Options for Casemix Analysis 
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Range Options for Casemix Analysis 
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L101,PS01L102,PS01L103,PS01L104:
                            PS01L105,PS01L106,PS01L107,PS01L108:
                            PS01L109,PS01L110,PS01L111,PS01L112:
                            PS01L113,PS01L114,PS01L115,PS01L116:
                            PS01L117,PS01L118,PS01L119,PS01L120:
                            PS01L121,PS01L122,PS01L123,PS01L124:
                            PS01L125,PS01L126,PS01L127,PS01L128:
                            PS01L129,PS01L130,PS01L131,PS01L132:
                            PS01L133,PS01L134,PS01L135,PS01L136:
                            PS01L137,PS01L138,PS01L139,PS01L140:
                            PS01L141,PS01L142,PS01L999,PS01L999:
                           PS01L999,PS01L143
          GOTO     PS01L999
.
PS01L101
          MOVE      DESC01,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      FROM01,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      TO01,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      DESC02,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      FROM02,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      TO02,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      DESC03,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      FROM03,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      TO03,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      DESC04,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      FROM04,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          MOVE      TO04,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          MOVE      DESC05,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          MOVE      FROM05,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          MOVE      TO05,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L116
          MOVE      DESC06,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L117
          MOVE      FROM06,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L118
          MOVE      TO06,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L119
          MOVE      DESC07,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L120
          MOVE      FROM07,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L121
          MOVE      TO07,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L122
          MOVE      DESC08,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L123
          MOVE      FROM08,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L124
          MOVE      TO08,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L125
          MOVE      DESC09,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L126
          MOVE      FROM09,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L127
          MOVE      TO09,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L128
          MOVE      DESC10,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L129
          MOVE      FROM10,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L130
          MOVE      TO10,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L131
          MOVE      DESC11,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L132
          MOVE      FROM11,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L133
          MOVE      TO11,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L134
          MOVE      DESC12,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L135
          MOVE      FROM12,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L136
          MOVE      TO12,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L137
          MOVE      DESC13,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L138
          MOVE      FROM13,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L139
          MOVE      TO13,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L140
          MOVE      DESC14X,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L141
          MOVE      FROM14,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L142
          MOVE      TO14,VAR         
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L143
          MOVE      EXRANGE,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Range Options for Casemix Analysis 
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L104,SF01L006,SF01L006,SF01L105:
                            SF01L006,SF01L006,SF01L106,SF01L006:
                            SF01L006,SF01L107,SF01L006,SF01L006:
                            SF01L108,SF01L006,SF01L006,SF01L109:
                            SF01L006,SF01L006,SF01L110,SF01L006:
                            SF01L006,SF01L111,SF01L006,SF01L006:
                            SF01L112,SF01L006,SF01L006,SF01L113:
                            SF01L006,SF01L006,SF01L114,SF01L006:
                            SF01L006,SF01L115,SF01L006,SF01L006:
                            SF01L116,SF01L006,SF01L006,SF01L117:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L104,SF01L020,SF01L020,SF01L105:
                            SF01L020,SF01L020,SF01L106,SF01L020:
                            SF01L020,SF01L107,SF01L020,SF01L020:
                            SF01L108,SF01L020,SF01L020,SF01L109:
                            SF01L020,SF01L020,SF01L110,SF01L020:
                            SF01L020,SF01L111,SF01L020,SF01L020:
                            SF01L112,SF01L020,SF01L020,SF01L113:
                            SF01L020,SF01L020,SF01L114,SF01L020:
                            SF01L020,SF01L115,SF01L020,SF01L020:
                            SF01L116,SF01L020,SF01L020,SF01L117:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      DEL10000
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L103
          CALL      POS10000
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L104
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROM01  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TO01    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      R01KY000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L104
            ENDIF
            BRANCH    EXIT,SF01L104,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      DESC01,VAR       
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROM01,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TO01,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L105
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROM02  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TO02    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      R02KY000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L105
            ENDIF
            BRANCH    EXIT,SF01L105,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      DESC02,VAR       
          CALL      DISPITEM
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROM02,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TO02,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L106
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROM03  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TO03    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      R03KY000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L106
            ENDIF
            BRANCH    EXIT,SF01L106,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      DESC03,VAR       
          CALL      DISPITEM
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROM03,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TO03,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L107
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROM04  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TO04    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      R04KY000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L107
            ENDIF
            BRANCH    EXIT,SF01L107,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      DESC04,VAR       
          CALL      DISPITEM
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROM04,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TO04,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L108
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROM05  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TO05    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      R05KY000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L108
            ENDIF
            BRANCH    EXIT,SF01L108,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      DESC05,VAR       
          CALL      DISPITEM
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROM05,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TO05,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L109
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROM06  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TO06    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      R06KY000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L109
            ENDIF
            BRANCH    EXIT,SF01L109,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      DESC06,VAR       
          CALL      DISPITEM
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROM06,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TO06,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L110
.
.
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROM07  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TO07    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      R07KY000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L110
            ENDIF
            BRANCH    EXIT,SF01L110,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      DESC07,VAR       
          CALL      DISPITEM
.
.
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROM07,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TO07,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L111
.
.
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROM08  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TO08    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      R08KY000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L111
            ENDIF
            BRANCH    EXIT,SF01L111,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      DESC08,VAR       
          CALL      DISPITEM
.
.
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROM08,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TO08,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L112
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROM09  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TO09    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      R09KY000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L112
            ENDIF
            BRANCH    EXIT,SF01L112,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      DESC09,VAR       
          CALL      DISPITEM
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROM09,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TO09,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L113
.
.
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROM10  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TO10    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      R10KY000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L113
            ENDIF
            BRANCH    EXIT,SF01L113,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      DESC10,VAR       
          CALL      DISPITEM
.
.
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROM10,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TO10,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L114
.
.
          MOVE      "   36",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROM11  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   37",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TO11    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      R11KY000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L114
            ENDIF
            BRANCH    EXIT,SF01L114,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      DESC11,VAR       
          CALL      DISPITEM
.
.
          MOVE      "   36",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROM11,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   37",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TO11,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L115
.
.
          MOVE      "   39",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROM12  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   40",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TO12    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      R12KY000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L115
            ENDIF
            BRANCH    EXIT,SF01L115,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      DESC12,VAR       
          CALL      DISPITEM
.
.
          MOVE      "   39",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROM12,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   40",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TO12,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L116
.
.
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROM13  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   43",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TO13    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      R13KY000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L116
            ENDIF
            BRANCH    EXIT,SF01L116,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      DESC13,VAR       
          CALL      DISPITEM
.
.
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROM13,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   43",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TO13,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L117
.
.
          MOVE      "   45",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROM14  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   46",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TO14    
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      R14KY000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L117
            ENDIF
            BRANCH    EXIT,SF01L117,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      DESC14X,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   45",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROM14,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   46",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TO14,VAR         
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Analysis Measures                  
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   72",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC02L200
          CALL      CF02L000 * Clear Fields
          CALL      GETMEA00
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Analysis Measures                  
.-------------------------------------------------------
CF02L000
          MOVE      ZERO,CCEYBA1 
          MOVE      ZERO,CCEYBA2 
          MOVE      ZERO,CCEYBA3 
          MOVE      ZERO,CCEYBAO 
          MOVE      ZERO,CCEYITH 
          MOVE      ZERO,CCEYIA1 
          MOVE      ZERO,CCEYIA2 
          MOVE      ZERO,CCEYIA3 
          MOVE      ZERO,CCEYIAO 
          MOVE      ZERO,CCEYIM1 
          MOVE      ZERO,CCEYIM2 
          MOVE      ZERO,CCEYIM3 
          MOVE      ZERO,CCEYIMO 
          MOVE      ZERO,CCEYETH1
          MOVE      ZERO,CCEYEA11
          MOVE      ZERO,CCEYEA21
          MOVE      ZERO,CCEYEA31
          MOVE      ZERO,CCEYEAO1
          MOVE      ZERO,CCEYEM11
          MOVE      ZERO,CCEYEM21
          MOVE      ZERO,CCEYEM31
          MOVE      ZERO,CCEYEMO1
          MOVE      ZERO,CCEYETH2
          MOVE      ZERO,CCEYEA12
          MOVE      ZERO,CCEYEA22
          MOVE      ZERO,CCEYEA32
          MOVE      ZERO,CCEYEAO2
          MOVE      ZERO,CCEYEM12
          MOVE      ZERO,CCEYEM22
          MOVE      ZERO,CCEYEM32
          MOVE      ZERO,CCEYEMO2
          MOVE      ZERO,CCEYETH3
          MOVE      ZERO,CCEYEA13
          MOVE      ZERO,CCEYEA23
          MOVE      ZERO,CCEYEA33
          MOVE      ZERO,CCEYEAO3
          MOVE      ZERO,CCEYEM13
          MOVE      ZERO,CCEYEM23
          MOVE      ZERO,CCEYEM33
          MOVE      ZERO,CCEYEMO3
          MOVE      ZERO,CCEYETH4
          MOVE      ZERO,CCEYEA14
          MOVE      ZERO,CCEYEA24
          MOVE      ZERO,CCEYEA34
          MOVE      ZERO,CCEYEAO4
          MOVE      ZERO,CCEYEM14
          MOVE      ZERO,CCEYEM24
          MOVE      ZERO,CCEYEM34
          MOVE      ZERO,CCEYEMO4
          MOVE      ZERO,CCEYETH5
          MOVE      ZERO,CCEYEA15
          MOVE      ZERO,CCEYEA25
          MOVE      ZERO,CCEYEA35
          MOVE      ZERO,CCEYEAO5
          MOVE      ZERO,CCEYEM15
          MOVE      ZERO,CCEYEM25
          MOVE      ZERO,CCEYEM35
          MOVE      ZERO,CCEYEMO5
          MOVE      SP70,CCCOCD1 
          MOVE      SP70,CCCOCD2 
          MOVE      SP70,CCCOCD3 
          MOVE      SP70,CCCOCD4 
          MOVE      SP70,CCCOCD5 
          MOVE      SP70,CCCOIA1 
          MOVE      SP70,CCCOIA2 
          MOVE      SP70,CCCOIA3 
          MOVE      SP70,CCCOIM1 
          MOVE      SP70,CCCOIM2 
          MOVE      SP70,CCCOIM3 
          MOVE      SP70,CCCOIA1 
          MOVE      SP70,CCCOIA2 
          MOVE      SP70,CCCOIA3 
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Analysis Measures                  
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Analysis Measures                  
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Analysis Measures                  
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Analysis Measures                  
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Analysis Measures                  
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L101,PS02L102,PS02L103,PS02L104:
                            PS02L105,PS02L106,PS02L107,PS02L108:
                            PS02L109,PS02L110,PS02L111,PS02L112:
                            PS02L113,PS02L114,PS02L115,PS02L116:
                            PS02L117,PS02L118,PS02L119,PS02L120:
                            PS02L121,PS02L122,PS02L123,PS02L124:
                            PS02L125,PS02L126,PS02L127,PS02L128:
                            PS02L129,PS02L130,PS02L131,PS02L132:
                            PS02L133,PS02L134,PS02L135,PS02L136:
                            PS02L137,PS02L138,PS02L139,PS02L140:
                            PS02L141,PS02L142,PS02L143,PS02L144:
                            PS02L145,PS02L146,PS02L147,PS02L148:
                            PS02L149,PS02L150,PS02L151,PS02L152:
                            PS02L153,PS02L154,PS02L155,PS02L156:
                            PS02L157,PS02L158,PS02L159,PS02L160:
                            PS02L161,PS02L162,PS02L163,PS02L164:
                            PS02L165,PS02L166,PS02L167,PS02L168:
                            PS02L169,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L170:
                            PS02L171,PS02L172
          GOTO     PS02L999
.
PS02L101
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYBA1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYBA2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYBA3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYBAO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYITH,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIA1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIA2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIA3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIAO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIM1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIM2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L112
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIM3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L113
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIMO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYETH1,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA11,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L116
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA21,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L117
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA31,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L118
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEAO1,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM11,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L120
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM21,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L121
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM31,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L122
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEMO1,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L123
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYETH2,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L124
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA12,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L125
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA22,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L126
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA32,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L127
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEAO2,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L128
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM12,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L129
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM22,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L130
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM32,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEMO2,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L132
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYETH3,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L133
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA13,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L134
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA23,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L135
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA33,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L136
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEAO3,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L137
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM13,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L138
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM23,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L139
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM33,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L140
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEMO3,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L141
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYETH4,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L142
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA14,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L143
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA24,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L144
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA34,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L145
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEAO4,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L146
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM14,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L147
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM24,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L148
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM34,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L149
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEMO4,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L150
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYETH5,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L151
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA15,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L152
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA25,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L153
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA35,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L154
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEAO5,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L155
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM15,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L156
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM25,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L157
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM35,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L158
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEMO5,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L159
          MOVE      CCCOCD1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L160
          MOVE      CCCOCD2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L161
          MOVE      CCCOCD3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L162
          MOVE      CCCOCD4,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L163
          MOVE      CCCOCD5,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L164
          MOVE      CCCOIA1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L165
          MOVE      CCCOIA2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L166
          MOVE      CCCOIA3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L167
          MOVE      CCCOIM1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L168
          MOVE      CCCOIM2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L169
          MOVE      CCCOIM3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L170
          MOVE      CCCOIA1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L171
          MOVE      CCCOIA2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L172
          MOVE      CCCOIA3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Analysis Measures                  
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L101,SF02L102,SF02L103,SF02L104:
                            SF02L105,SF02L106,SF02L107,SF02L108:
                            SF02L109,SF02L110,SF02L111,SF02L112:
                            SF02L113,SF02L114,SF02L115,SF02L116:
                            SF02L117,SF02L118,SF02L119,SF02L120:
                            SF02L121,SF02L122,SF02L123,SF02L124:
                            SF02L125,SF02L126,SF02L127,SF02L128:
                            SF02L129,SF02L130,SF02L131,SF02L132:
                            SF02L133,SF02L134,SF02L135,SF02L136:
                            SF02L137,SF02L138,SF02L139,SF02L140:
                            SF02L141,SF02L142,SF02L143,SF02L144:
                            SF02L145,SF02L146,SF02L147,SF02L148:
                            SF02L149,SF02L150,SF02L151,SF02L152:
                            SF02L153,SF02L154,SF02L155,SF02L156:
                            SF02L157,SF02L158,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L159,SF02L160,SF02L006:
                            SF02L161,SF02L162,SF02L163,SF02L006:
                            SF02L006,SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L101,SF02L102,SF02L103,SF02L104:
                            SF02L105,SF02L106,SF02L107,SF02L108:
                            SF02L109,SF02L110,SF02L111,SF02L112:
                            SF02L113,SF02L114,SF02L115,SF02L116:
                            SF02L117,SF02L118,SF02L119,SF02L120:
                            SF02L121,SF02L122,SF02L123,SF02L124:
                            SF02L125,SF02L126,SF02L127,SF02L128:
                            SF02L129,SF02L130,SF02L131,SF02L132:
                            SF02L133,SF02L134,SF02L135,SF02L136:
                            SF02L137,SF02L138,SF02L139,SF02L140:
                            SF02L141,SF02L142,SF02L143,SF02L144:
                            SF02L145,SF02L146,SF02L147,SF02L148:
                            SF02L149,SF02L150,SF02L151,SF02L152:
                            SF02L153,SF02L154,SF02L155,SF02L156:
                            SF02L157,SF02L158,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L101
            ENDIF
            BRANCH    EXIT,SF02L101,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYBA1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L102
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L102
            ENDIF
            BRANCH    EXIT,SF02L102,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYBA2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L103
            ENDIF
            BRANCH    EXIT,SF02L103,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYBA3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L104
            ENDIF
            BRANCH    EXIT,SF02L104,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYBAO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L105
            ENDIF
            BRANCH    EXIT,SF02L105,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYITH,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L106
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L106
            ENDIF
            BRANCH    EXIT,SF02L106,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIA1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L107
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L107
            ENDIF
            BRANCH    EXIT,SF02L107,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIA2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L108
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L108
            ENDIF
            BRANCH    EXIT,SF02L108,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIA3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L109
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L109
            ENDIF
            BRANCH    EXIT,SF02L109,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIAO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L110
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L110
            ENDIF
            BRANCH    EXIT,SF02L110,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIM1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L111
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L111
            ENDIF
            BRANCH    EXIT,SF02L111,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIM2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L112
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L112
            ENDIF
            BRANCH    EXIT,SF02L112,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIM3,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L113
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L113
            ENDIF
            BRANCH    EXIT,SF02L113,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYIMO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L114
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L114
            ENDIF
            BRANCH    EXIT,SF02L114,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYETH1,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L115
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L115
            ENDIF
            BRANCH    EXIT,SF02L115,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA11,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L116
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L116
            ENDIF
            BRANCH    EXIT,SF02L116,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA21,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L117
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L117
            ENDIF
            BRANCH    EXIT,SF02L117,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA31,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L118
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L118
            ENDIF
            BRANCH    EXIT,SF02L118,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEAO1,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L119
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L119
            ENDIF
            BRANCH    EXIT,SF02L119,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM11,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L120
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L120
            ENDIF
            BRANCH    EXIT,SF02L120,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM21,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L121
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L121
            ENDIF
            BRANCH    EXIT,SF02L121,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM31,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L122
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L122
            ENDIF
            BRANCH    EXIT,SF02L122,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEMO1,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L123
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L123
            ENDIF
            BRANCH    EXIT,SF02L123,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYETH2,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L124
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L124
            ENDIF
            BRANCH    EXIT,SF02L124,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA12,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L125
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L125
            ENDIF
            BRANCH    EXIT,SF02L125,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA22,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L126
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L126
            ENDIF
            BRANCH    EXIT,SF02L126,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA32,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L127
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L127
            ENDIF
            BRANCH    EXIT,SF02L127,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEAO2,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L128
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L128
            ENDIF
            BRANCH    EXIT,SF02L128,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM12,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L129
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L129
            ENDIF
            BRANCH    EXIT,SF02L129,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM22,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L130
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L130
            ENDIF
            BRANCH    EXIT,SF02L130,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM32,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L131
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L131
            ENDIF
            BRANCH    EXIT,SF02L131,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEMO2,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L132
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L132
            ENDIF
            BRANCH    EXIT,SF02L132,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYETH3,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L133
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L133
            ENDIF
            BRANCH    EXIT,SF02L133,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA13,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L134
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L134
            ENDIF
            BRANCH    EXIT,SF02L134,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA23,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L135
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L135
            ENDIF
            BRANCH    EXIT,SF02L135,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA33,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L136
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L136
            ENDIF
            BRANCH    EXIT,SF02L136,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEAO3,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L137
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L137
            ENDIF
            BRANCH    EXIT,SF02L137,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM13,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L138
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L138
            ENDIF
            BRANCH    EXIT,SF02L138,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM23,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L139
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L139
            ENDIF
            BRANCH    EXIT,SF02L139,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM33,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L140
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L140
            ENDIF
            BRANCH    EXIT,SF02L140,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEMO3,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L141
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L141
            ENDIF
            BRANCH    EXIT,SF02L141,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYETH4,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L142
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L142
            ENDIF
            BRANCH    EXIT,SF02L142,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA14,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L143
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L143
            ENDIF
            BRANCH    EXIT,SF02L143,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA24,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L144
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L144
            ENDIF
            BRANCH    EXIT,SF02L144,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA34,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L145
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L145
            ENDIF
            BRANCH    EXIT,SF02L145,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEAO4,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L146
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L146
            ENDIF
            BRANCH    EXIT,SF02L146,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM14,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L147
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L147
            ENDIF
            BRANCH    EXIT,SF02L147,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM24,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L148
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L148
            ENDIF
            BRANCH    EXIT,SF02L148,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM34,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L149
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L149
            ENDIF
            BRANCH    EXIT,SF02L149,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEMO4,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L150
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L150
            ENDIF
            BRANCH    EXIT,SF02L150,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYETH5,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L151
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L151
            ENDIF
            BRANCH    EXIT,SF02L151,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA15,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L152
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L152
            ENDIF
            BRANCH    EXIT,SF02L152,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA25,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L153
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L153
            ENDIF
            BRANCH    EXIT,SF02L153,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEA35,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L154
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L154
            ENDIF
            BRANCH    EXIT,SF02L154,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEAO5,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L155
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L155
            ENDIF
            BRANCH    EXIT,SF02L155,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM15,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L156
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L156
            ENDIF
            BRANCH    EXIT,SF02L156,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM25,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L157
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L157
            ENDIF
            BRANCH    EXIT,SF02L157,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEM35,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L158
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      TOGFLD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L158
            ENDIF
            BRANCH    EXIT,SF02L158,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEYEMO5,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L159
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      CLROW000
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   72",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF02L000
          GOTO      SF02L001
.
SF02L160
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      CLCOL000
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   72",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF02L000
          GOTO      SF02L001
.
SF02L161
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L162
          CALL      POSY0000
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L163
          CALL      DELY0000
          MOVE      ZERO,EXIT
          GOTO      SF02L999
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.@@@@@ Function Restart Point @@@@@
.---------------------------------------------------------------------
. Read Control File
.----------------------------------------------------------------------
GETCON00  READ      CONTROLF,SIXTY4;*177,CCCOSOPR:
                                    *183,CCCOTH1,CCCOTH2,CCCOTH3,CCCOTH4:
                                         CCCOTF1,CCCOTF2,CCCOTF3,CCCOTF4:
                                         CCCOTT1,CCCOTT2,CCCOTT3,CCCOTT4
          RETURN
.
DEFAULTN    MOVE     ANSN,DEFYESNO
            RETURN
DEFAULTY    MOVE     ANSY,DEFYESNO
            RETURN
DELT0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DELT1000,DELT9000,DELT9100
.
DELT1000  PACK     KEY4,CCEAEID
          CALL     RDCCEA1             * Read Record
          IF       OVRCD=0
            CALL     DECCEA1           * Delete Record
            CALL     CCSCOPOP          * Open Files Then Delete Files
            CLOSE    CCSCEBA1,DELETE
            CLOSE    CCSCECA1
            CLOSE    CCSCECA2,DELETE
            CLOSE    CCSCEDA1,DELETE
            CLOSE    CCSCEEA1,DELETE
            CLOSE    CCSCEFA1
            CLOSE    CCSCEFA2,DELETE
            CLOSE    CCSCEGA1
            CLOSE    CCSCEGA2,DELETE
          ENDIF
.
          MOVE     TWO,EXIT            * Restart Screen
          GOTO     DELT9999
DELT9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DELT9999
DELT9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DELT9999
DELT9999  RETURN
.---------------------------------------------------------------------------
. Post Casemix Extract Details and Perofrm Extract
.---------------------------------------------------------------------------
POST0000  MOVE     "1 ",CCEAHCD
          MOVE     SP70,CCEAFCM
          MOVE     SP70,CCEAFYR
          MOVE     SP70,CCEATCM
          MOVE     SP70,CCEATYR
          MOVE     SP70,CCEARUA
          MOVE     SP70,CCEASPA
.
          MOVE     CCEAIMOD,KEY1
          CALL     RDCEPP1
.
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     PATITEM1,"patitemn"                                 * V90200
          TRAPCLR  IO
          MOVE     OVRCD,PATMBSOP
.
          MATCH    "0",CCEAUST
          IF       !@EQUAL
            MOVE     ONE,CCEAUST
          ENDIF
.
          PACK     KEY4,CCEAEID
          CALL     RACCEA1             * Read Record
          IF       OVRCD=0
            CALL     UPCCEA1           * Update Record
          ELSE
            CALL     WRCCEA1           * Write Record
          ENDIF
.
          PACK     KEY4,CCEAEID
          CALL     RDCCEX1             * Read Record
          MOVE     OVRCD,EXRANGE       * 1 = no more ranges
.
          PACK     KEY4,CCEAEID
          CALL     RDCCEY1             * Read Record
          MOVE     OVRCD,EXCOMPS       * 1 = No Components Specified
.
          MOVE     ZERO,BEDCALC
          IF       EXCOMPS=0
            IF       (CCEYBA1+CCEYBA2+CCEYBA3+CCEYBAO=4)
              MOVE     ZERO,BEDCALC    * No LOS Calc Required
            ELSE
              MOVE     ONE,BEDCALC     * LOS Calculation Required
            ENDIF
          ENDIF
.
. Create and Open Files
.---------------------------------------------------------------------------
          CALL     CREAT000            * Create Files
          BRANCH   EXIT,POST9999
.
. Extract Episodes to the ccec file
.---------------------------------------------------------------------------
          CALL     EXTR0000            * Create Extract
.
. Calculate Statistical Variances
.---------------------------------------------------------------------------
          MATCH    "0",CCEAUST
          GOTO     POST9999 IF EQUAL   * Update Stats Y or N 0=N
.
          CALL     STAT0000
.
POST9999  RETURN
.---------------------------------------------------------------------------
. Create and Open Files
.---------------------------------------------------------------------------
CREAT000  DISPLAY  *P1:24,*EL,"Creating Extract Files : "
          MOVE     "cceb",KEY4
          PACK     FILENAME,KEY4,CCEAEID
          DISPLAY  *P26:24,*EL,FILENAME
          REP      " 0",FILENAME
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     CCSCEBA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=0
            CLOSE    CCSCEBA1,DELETE
          ENDIF
          PACK     COMMAND,SGENISB,FILENAME,CCEBIDX
          EXECUTE  COMMAND,TASKID
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     CCSCEBA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=1
            BEEP
            MOVE     "Unable to Create Casemix Extract Files - ",DISPMSG
            CALL     MESSAGE1
            GOTO     CREAT900
          ENDIF
.
          MOVE     "ccec",KEY4
          PACK     FILENAME,KEY4,CCEAEID
          DISPLAY  *P26:24,*EL,FILENAME
          REP      " 0",FILENAME
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     CCSCECA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=0
            CLOSE    CCSCECA2
            CLOSE    CCSCECA1,DELETE
          ENDIF
          PACK     COMMAND,SGENISB,FILENAME,CCECIDX
          EXECUTE  COMMAND,TASKID
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     CCSCECA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=1
            BEEP
            MOVE     "Unable to Create Casemix Extract Files - ",DISPMSG
            CALL     MESSAGE1
            GOTO     CREAT900
          ENDIF
          OPEN     CCSCECA2,FILENAME
.
          MOVE     "cced",KEY4
          PACK     FILENAME,KEY4,CCEAEID
          DISPLAY  *P26:24,*EL,FILENAME
          REP      " 0",FILENAME
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     CCSCEDA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=0
            CLOSE    CCSCEDA1,DELETE
          ENDIF
          PACK     COMMAND,SGENISB,FILENAME,CCEDIDX
          EXECUTE  COMMAND,TASKID
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     CCSCEDA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=1
            BEEP
            MOVE     "Unable to Create Casemix Extract Files - ",DISPMSG
            CALL     MESSAGE1
            GOTO     CREAT900
          ENDIF
.
          MOVE     "ccee",KEY4
          PACK     FILENAME,KEY4,CCEAEID
          DISPLAY  *P26:24,*EL,FILENAME
          REP      " 0",FILENAME
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     CCSCEEA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=0
            CLOSE    CCSCEEA1,DELETE
          ENDIF
          PACK     COMMAND,SGENISB,FILENAME,CCEEIDX
          EXECUTE  COMMAND,TASKID
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     CCSCEEA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=1
            BEEP
            MOVE     "Unable to Create Casemix Extract Files - ",DISPMSG
            CALL     MESSAGE1
            GOTO     CREAT900
          ENDIF
.
          MOVE     "ccef",KEY4
          PACK     FILENAME,KEY4,CCEAEID
          DISPLAY  *P26:24,*EL,FILENAME
          REP      " 0",FILENAME
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     CCSCEFA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=0
            CLOSE    CCSCEFA2
            CLOSE    CCSCEFA1,DELETE
          ENDIF
          PACK     COMMAND,SGENISB,FILENAME,CCEFIDX
          EXECUTE  COMMAND,TASKID
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     CCSCEFA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=1
            BEEP
            MOVE     "Unable to Create Casemix Extract Files - ",DISPMSG
            CALL     MESSAGE1
            GOTO     CREAT900
          ENDIF
.
          MOVE     "cceg",KEY4
          PACK     FILENAME,KEY4,CCEAEID
          DISPLAY  *P26:24,*EL,FILENAME
          REP      " 0",FILENAME
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     CCSCEGA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=0
            CLOSE    CCSCEGA2
            CLOSE    CCSCEGA1,DELETE
          ENDIF
          PACK     COMMAND,SGENISB,FILENAME,CCEGIDX
          EXECUTE  COMMAND,TASKID
          MOVE     ZERO,OVRCD
          TRAP     OVERCOND IF IO
          OPEN     CCSCEGA1,FILENAME
          TRAPCLR  IO
          IF       OVRCD=1
            BEEP
            MOVE     "Unable to Create Casemix Extract Files - ",DISPMSG
            CALL     MESSAGE1
            GOTO     CREAT900
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      CREAT999
.
CREAT900  MOVE      ONE,EXIT
.
CREAT999  RETURN
.======================================================================
. Extract Casemix Analysis
.======================================================================
EXTR0000  PACK      KEY18,SP70
          DISPLAY   *P1:24,*EL,"Scanning Episodes : "
          MOVE      ZERO,TOTALEPS
          MOVE      ZERO,TOTALEXT
          PACK      KEY26,CCEAFDD,SP70
          CALL      RSCCEP4
EXTR1000  CALL      RKCCEP4
          BRANCH    OVRCD,EXTR9000
          MATCH     CCEPDDAT,CCEATDD
          GOTO      EXTR9000 IF LESS
.
          ADD       ONE,TOTALEPS
          IF        (TOTALEPS%500=0)
            DISPLAY   *P21:24,*V2LON,TOTALEPS
          ENDIF
.
          CALL      RANGE000     * Check Range Options
          BRANCH    EXIT,EXTR1000
.
          MOVE      SP70,CCECLV1
          MOVE      SP70,CCECLV2
          MOVE      SP70,CCECLV3
          MOVE      CCEALV1,EXTRBRAN
          CALL      GETCD000     * Get Extract Code Level 1
          MOVE      KEY10,CCECLV1
          MATCH     SP70,CCECLV1
          IF        @EQUAL
            MOVE      Z70,CCECLV1
          ENDIF
.
          MATCH     SP70,CCEALV2
          IF        !@EQUAL
            MOVE      CCEALV2,EXTRBRAN
            CALL      GETCD000     * Get Extract Code Level 2
            MOVE      KEY10,CCECLV2
            MATCH     SP70,CCECLV2
            IF        @EQUAL
              MOVE      Z70,CCECLV2
            ENDIF
          ENDIF
.
          MATCH     SP70,CCEALV3
          IF        !@EQUAL
            MOVE      CCEALV3,EXTRBRAN
            CALL      GETCD000     * Get Extract Code Level 3
            MOVE      KEY10,CCECLV3
            MATCH     SP70,CCECLV3
            IF        @EQUAL
              MOVE      Z70,CCECLV3
            ENDIF
          ENDIF
.
          MOVE      CCEPHCD,CCECHCD
          MOVE      CCEPEPS,CCECEPS
          MOVE      CCEPEXC,CCECEXC
          PACK      KEY18,CCECHCD,CCECEPS
          CALL      RDCCIA1            * Income Analysis File
          IF        OVRCD=0
            MOVE      ZERO,CCECTTC
            CALL      CALEPS00
          ELSE
            MOVE      ZERO,CCECFTC
            MOVE      ZERO,CCECTTC
          ENDIF
.
          MOVE      CCEPLOS,CCECLOS
          IF        BEDCALC=1
            MOVE      ZERO,CCECLOS
            ASSIGN    ((CCEPLOS-CCIABA1-CCIABA2-CCIABA3)*CCEYBAO),CCECLOS
            ASSIGN    CCECLOS+(CCIABA1*CCEYBA1),CCECLOS
            ASSIGN    CCECLOS+(CCIABA2*CCEYBA2),CCECLOS
            ASSIGN    CCECLOS+(CCIABA3*CCEYBA3),CCECLOS
          ENDIF
.
          PACK      KEY18,CCECHCD,CCECEPS
          CALL      RACCEC1
          IF        OVRCD=0
            CALL      UPCCEC1
          ELSE
            CALL      WRCCEC1
          ENDIF
          CALL      UPLEV000
          GOTO      EXTR1000
.
EXTR9000  RETURN
.--------------------------------------------------
. Calculate Episode Income/Costs
.--------------------------------------------------
CALEPS00  MOVE      ZERO,CCECFTC
          MOVE      ZERO,CCECTTC
.
          MATCH     SP70,CCEAIMOD        * Use Payment Model Calculation
          GOTO      CALEPS10 IF NOT EQUAL
          MATCH     SP70,CCEAITHE        * Use Theatre Time
          GOTO      CALEPS30 IF NOT EQUAL
.
          BRANCH    EXCOMPS,CALEPS20     * Simple Calculation (All)
.
. Partial Components Specified
.-----------------------------
          ASSIGN    CCECFTC+(CCIAITH*CCEYITH)+(CCIAIA1*CCEYIA1),CCECFTC
          ASSIGN    CCECFTC+(CCIAIA2*CCEYIA2)+(CCIAIA3*CCEYIA3),CCECFTC
          ASSIGN    CCECFTC+(CCIAIAO*CCEYIAO)+(CCIAIM1*CCEYIM1),CCECFTC
          ASSIGN    CCECFTC+(CCIAIM2*CCEYIM2)+(CCIAIM3*CCEYIM3),CCECFTC
          ASSIGN    CCECFTC+(CCIAIMO*CCEYIMO),CCECFTC
          GOTO      CALEPS99
.
. Payment Model Calculation
.---------------------------
CALEPS10  IF      CEPPUTH=1
            MOVE    CCIAITH,CCECFTC               * Keep Theatre Component
          ELSE
            IF      PATMBSOP=0
              PACK    KEY9,CCEPPMBS
              CALL    RDITEM1                                          * V90200
              IF      OVRCD=0
                SQUEEZE  IBAND1                                        * V90200
                MOVE     IBAND1,F2                                     * V90200
                LOAD     CCECFTC,F2,CEPPB01,CEPPB02,CEPPB03,CEPPB04,CEPPB05:
                                    CEPPB06,CEPPB07,CEPPB08,CEPPB09,CEPPB10:
                                    CEPPB11,CEPPB12,CEPPB13,CEPPB14,CEPPB15
              ENDIF
            ENDIF
          ENDIF
.
. Add Charge per ICU Day Assume Accom. Component 1
.
          ASSIGN  (CEPPICU*CCIABA1)+CCECFTC,CCECFTC
.
. Add Charge per day & per case from drg
.
          PACK    KEY5,CCEAIMOD,CCEPDRGC
          CALL    RDCEPM1
          IF      OVRCD=0
            IF      CEPPINCI=1
              ASSIGN  (CEPMPDAY*CCIALOS)+CEPMPCAS+CCECFTC,CCECFTC
            ELSE
              ASSIGN  (CEPMPDAY*(CCIALOS-CCIABA1))+CEPMPCAS+CCECFTC,CCECFTC
            ENDIF
          ENDIF
          GOTO    CALEPS99
.
. No Component Measures Specified (ALL)
.---------------------------------
CALEPS20  ASSIGN  CCECFTC+CCIAITH+CCIAIA1+CCIAIA2+CCIAIA3+CCIAIAO,CCECFTC
          ASSIGN  CCECFTC+CCIAIM1+CCIAIM2+CCIAIM3+CCIAIMO,CCECFTC
          GOTO    CALEPS99
.
. Theatre Time Replacing Income
.---------------------------------
CALEPS30  MOVE      CCEAITHE,F1
          LOAD      CCECFTC,F1,CCIATT1,CCIATT2,CCIATT3,CCIATT4
.
CALEPS99  RETURN
.-------------------------------------------------------------------------------
. Update Levels
.-------------------------------------------------------------------------------
UPLEV000  MATCH     "1",CCECEXC         * Excluded from Summary
          GOTO      UPLEV999 IF EQUAL
.
          CALL      UPDEB000
.
          MATCH     SP70,CCEALV2
          GOTO      UPLEV999 IF EQUAL
          CALL      UPDED000
.
          MATCH     SP70,CCEALV3
          GOTO      UPLEV999 IF EQUAL
          CALL      UPDEE000
.
UPLEV999  RETURN
.-------------------------------------------
. Check for Range Option - EXIT 0=In Range
.-------------------------------------------
RANGE000  MATCH     CCEAHCD,CCEPHCD
          GOTO      RANGE900 IF NOT EQUAL
.
          MATCH     SP70,CCEPADAT   * Admission Date Range
          GOTO      RANGE010 IF EQUAL
.
          MATCH     CCEAFAD,CCEPADAT   * Admission Date Range
          GOTO      RANGE900 IF LESS
          MATCH     CCEPADAT,CCEATAD
          GOTO      RANGE900 IF LESS
.
RANGE010  MATCH     "0",CCEAVIS       * Include Visits 0=All
          IF        !(@EQUAL)
            MOVE      CCEPVIST,ANS
            MATCH     CCEAVIS,ANS
            GOTO      RANGE900 IF NOT EQUAL
          ENDIF
.
          MATCH     "0",CCEADAY       * Day Cases 0=Exclude
          IF        @EQUAL
            MATCH     "1",CCEPDAY      * Day Case 0=NO
            GOTO      RANGE900 IF EQUAL
          ENDIF
          MATCH     "2",CCEADAY       * Day Cases 2=Only
          IF        @EQUAL
            MATCH     "1",CCEPDAY      * Day Case 0=NO
            GOTO      RANGE900 IF NOT EQUAL
          ENDIF
.
          MATCH     "0",CCEAINC       * Include Incompleted 0=No
          IF        @EQUAL
            MATCH     "0",CCEPCOM     * Complete 0=NO
            GOTO      RANGE900 IF EQUAL
          ENDIF
.
          BRANCH    EXRANGE,RANGE800
          MOVE      ZERO,F2
RANGE700  ADD       ONE,F2
          COMPARE   "15",F2
          GOTO      RANGE800 IF EQUAL
          LOAD      KEY3,F2,CCEXR01,CCEXR02,CCEXR03,CCEXR04,CCEXR05:
                            CCEXR06,CCEXR07,CCEXR08,CCEXR09,CCEXR10:
                            CCEXR11,CCEXR12,CCEXR13,CCEXR14
          MATCH     SP70,KEY3
          GOTO      RANGE700 IF EQUAL
.
          MOVE      KEY3,EXTRBRAN
          CALL      GETCD000     * Get Extract Code
.
          LOAD      EXSTR,F2,CCEXF01,CCEXF02,CCEXF03,CCEXF04,CCEXF05:
                                   CCEXF06,CCEXF07,CCEXF08,CCEXF09,CCEXF10:
                                   CCEXF11,CCEXF12,CCEXF13,CCEXF14
          LOAD      EXEND,F2,CCEXT01,CCEXT02,CCEXT03,CCEXT04,CCEXT05:
                                   CCEXT06,CCEXT07,CCEXT08,CCEXT09,CCEXT10:
                                   CCEXT11,CCEXT12,CCEXT13,CCEXT14
.
          MATCH     EXSTR,KEY10   * Range
          GOTO      RANGE900 IF LESS
          MATCH     KEY10,EXEND
          GOTO      RANGE900 IF LESS
          GOTO      RANGE700
.
RANGE800  MOVE      ZERO,EXIT
          GOTO      RANGE999
RANGE900  MOVE      ONE,EXIT
RANGE999  RETURN
.--------------------------------------------------
. Calculate Summary Costs
.--------------------------------------------------
SUMM0000  DISPLAY   *P1:24,*EL,"Casemix Extract Level Summary : "
          PACK      KEY18,SP70
          MOVE      ZERO,SECTOR
          CALL      RSCCEC1
SUMM1000  CALL      RKCCEC1
          BRANCH    OVRCD,SUMM9000
          ADD       ONE,SECTOR
          IF        (SECTOR%100=0)
            DISPLAY   *P33:24,*V2LON,SECTOR
          ENDIF
.
          MATCH     "1",CCECEXC         * Excluded from Summary
          GOTO      SUMM1000 IF EQUAL
.
          CALL      UPDEB000
.
          MATCH     SP70,CCEALV2
          GOTO      SUMM1000 IF EQUAL
          CALL      UPDED000
.
          MATCH     SP70,CCEALV3
          GOTO      SUMM1000 IF EQUAL
          CALL      UPDEE000
          GOTO      SUMM1000
SUMM9000
SUMM9999  RETURN
.------------------------------------------------------------
. Update Casemix Level 1
.------------------------------------------------------------
UPDEB000  PACK      KEY10,CCECLV1
          CALL      RDCCEB1
          IF        OVRCD=1
            CALL      CLREB000
            MOVE      CCECLV1,CCEBLV1
            CALL      WRCCEB1
            CALL      RDCCEB1
          ENDIF
          ADD       ONE,CCEBNEP    * Increase Number of Episodes
          ADD       CCECFTC,CCEBFTC
          ADD       CCECTTC,CCEBTTC
          ADD       CCECLOS,CCEBLTO
          CALL      UPCCEB1
          RETURN
.------------------------------------------------------------
. Update Casemix Level 2
.------------------------------------------------------------
UPDED000  PACK      KEY20,CCECLV1,CCECLV2,SP70
          MATCH     SP70,KEY20
          GOTO      UPDED999 IF EQUAL
          CALL      RDCCED1
          IF        OVRCD=1
            CALL      CLRED000
            UNPACK    KEY20,CCEDLV1,CCEDLV2
            CALL      WRCCED1
            CALL      RDCCED1
          ENDIF
          ADD       ONE,CCEDNEP    * Increase Number of Episodes
          ADD       CCECFTC,CCEDFTC
          ADD       CCECTTC,CCEDTTC
          ADD       CCECLOS,CCEDLTO
          CALL      UPCCED1
UPDED999  RETURN
.------------------------------------------------------------
. Update Casemix Level 3
.------------------------------------------------------------
UPDEE000  PACK      KEY30,CCECLV1,CCECLV2,CCECLV3,SP70
          MATCH     SP70,KEY30
          GOTO      UPDEE999 IF EQUAL
          CALL      RDCCEE1
          IF        OVRCD=1
            CALL      CLREE000
            UNPACK    KEY30,CCEELV1,CCEELV2,CCEELV3
            CALL      WRCCEE1
            CALL      RDCCEE1
          ENDIF
          ADD       ONE,CCEENEP    * Increase Number of Episodes
          ADD       CCECFTC,CCEEFTC
          ADD       CCECTTC,CCEETTC
          ADD       CCECLOS,CCEELTO
          CALL      UPCCEE1
.
UPDEE999  RETURN
.------------------------------------------------------------
. Clear Summary File Details
.------------------------------------------------------------
CLREB000  MOVE      ZERO,CCEBNEP
          MOVE      ZERO,CCEBFTC
          MOVE      "999999999999",CCEBFMN
          MOVE      ZERO,CCEBFMX
          MOVE      ZERO,CCEBFSV
          MOVE      ZERO,CCEBTTC
          MOVE      "999999999999",CCEBTMN
          MOVE      ZERO,CCEBTMX
          MOVE      ZERO,CCEBTSV
          MOVE      "999999999999",CCEBLMN
          MOVE      ZERO,CCEBLMX
          MOVE      ZERO,CCEBLSV
          MOVE      ZERO,CCEBLTO
          RETURN
.
CLRED000  MOVE      ZERO,CCEDNEP
          MOVE      ZERO,CCEDFTC
          MOVE      "999999999999",CCEDFMN
          MOVE      ZERO,CCEDFMX
          MOVE      ZERO,CCEDFSV
          MOVE      ZERO,CCEDTTC
          MOVE      "999999999999",CCEDTMN
          MOVE      ZERO,CCEDTMX
          MOVE      ZERO,CCEDTSV
          MOVE      "999999999999",CCEDLMN
          MOVE      ZERO,CCEDLMX
          MOVE      ZERO,CCEDLSV
          MOVE      ZERO,CCEDLTO
          RETURN
.
CLREE000  MOVE      ZERO,CCEENEP
          MOVE      ZERO,CCEEFTC
          MOVE      "999999999999",CCEEFMN
          MOVE      ZERO,CCEEFMX
          MOVE      ZERO,CCEEFSV
          MOVE      ZERO,CCEETTC
          MOVE      "999999999999",CCEETMN
          MOVE      ZERO,CCEETMX
          MOVE      ZERO,CCEETSV
          MOVE      "999999999999",CCEELMN
          MOVE      ZERO,CCEELMX
          MOVE      ZERO,CCEELSV
          MOVE      ZERO,CCEELTO
          RETURN
.------------------------------------------------------------
. Calculate Statistics
.------------------------------------------------------------
STAT0000  PACK      KEY10,SP70
          DISPLAY   *P1:24,*EL,"Calculating Statistics : "
          MOVE      ZERO,TOTALEXT
.
          CALL      STEB0000  * Level 1 Min , Max  & Variance Calculation
          CALL      STED0000  * Level 2 Min , Max  & Variance Calculation
          CALL      STEE0000  * Level 3 Min , Max  & Variance Calculation
.
STAT9999  RETURN
.------------------------------------------------------------
. Update Variance Casemix Level 1
.------------------------------------------------------------
STEB0000  PACK      KEY10,SP70
          CALL      RDCCEB1
          IF        OVRCD=0
            CALL      RPCCEB1
          ENDIF
.
STEB1000  CALL      RKCCEB1
          BRANCH    OVRCD,STEB9999
.
          ADD       ONE,TOTALEXT
          IF        (TOTALEXT%100=0)
            DISPLAY   *P26:24,*V2LON,TOTALEXT,"/1"
          ENDIF
.
          MOVE      "999999999999",CCEBFMN
          MOVE      ZERO,CCEBFMX
          MOVE      ZERO,CCEBFSV
          MOVE      "999999999999",CCEBTMN
          MOVE      ZERO,CCEBTMX
          MOVE      ZERO,CCEBTSV
          MOVE      "999999999999",CCEBLMN
          MOVE      ZERO,CCEBLMX
          MOVE      ZERO,CCEBLSV
.
          PACK      KEY48,CCEBLV1,SP70
          CALL      RSCCEC2
STEB1100  CALL      RKCCEC2
          BRANCH    OVRCD,STEB1900
          MATCH     CCEBLV1,CCECLV1
          GOTO      STEB1900 IF NOT EQUAL
.
          MATCH     "1",CCECEXC  * Excluded
          GOTO      STEB1100 IF EQUAL
.
          CALL      CHKEB000
.
          ASSIGN    CCECFTC-(CCEBFTC/CCEBNEP),F12P4
          ASSIGN    CCEBFSV+(F12P4*F12P4),CCEBFSV
.
          ASSIGN    CCECTTC-(CCEBTTC/CCEBNEP),F12P4
          ASSIGN    CCEBTSV+(F12P4*F12P4),CCEBTSV
.
          ASSIGN    CCECLOS-(CCEBLTO/CCEBNEP),F12P4
          ASSIGN    CCEBLSV+(F12P4*F12P4),CCEBLSV
.
          GOTO      STEB1100
.
STEB1900  IF        CCEBNEP>1
            ASSIGN    CCEBFSV/(CCEBNEP-1),CCEBFSV
            ASSIGN    CCEBTSV/(CCEBNEP-1),CCEBTSV
            ASSIGN    CCEBLSV/(CCEBNEP-1),CCEBLSV
          ENDIF
          CALL      UPCCEB1
          GOTO      STEB1000
.
STEB9999  RETURN
.
.------------------------------------------------------------
. Update Variance Casemix Level 2
.------------------------------------------------------------
STED0000  PACK      KEY20,SP70
          CALL      RDCCED1
          IF        OVRCD=0
            CALL      RPCCED1
          ENDIF
STED1000  CALL      RKCCED1
          BRANCH    OVRCD,STED9999
.
          ADD       ONE,TOTALEXT
          IF        (TOTALEXT%100=0)
            DISPLAY   *P26:24,*V2LON,TOTALEXT,"/2"
          ENDIF
.
          MOVE      "999999999999",CCEDFMN
          MOVE      ZERO,CCEDFMX
          MOVE      ZERO,CCEDFSV
          MOVE      "999999999999",CCEDTMN
          MOVE      ZERO,CCEDTMX
          MOVE      ZERO,CCEDTSV
          MOVE      "999999999999",CCEDLMN
          MOVE      ZERO,CCEDLMX
          MOVE      ZERO,CCEDLSV
.
          PACK      KEY48,CCEDLV1,CCEDLV2,SP70
          PACK      KEY20,CCEDLV1,CCEDLV2,SP70
          CALL      RSCCEC2
STED1100  CALL      RKCCEC2
          BRANCH    OVRCD,STED1900
          PACK      KEY48,CCECLV1,CCECLV2,SP70
          MATCH     KEY20,KEY48
          GOTO      STED1900 IF NOT EQUAL
.
          MATCH     "1",CCECEXC  * Excluded
          GOTO      STED1100 IF EQUAL
.
          CALL      CHKED000
.
          ASSIGN    CCECFTC-(CCEDFTC/CCEDNEP),F12P4
          ASSIGN    CCEDFSV+(F12P4*F12P4),CCEDFSV
.
          ASSIGN    CCECTTC-(CCEDTTC/CCEDNEP),F12P4
          ASSIGN    CCEDTSV+(F12P4*F12P4),CCEDTSV
.
          ASSIGN    CCECLOS-(CCEDLTO/CCEDNEP),F12P4
          ASSIGN    CCEDLSV+(F12P4*F12P4),CCEDLSV
.
          GOTO      STED1100
.
STED1900  IF        CCEDNEP>1
            ASSIGN    CCEDFSV/(CCEDNEP-1),CCEDFSV
            ASSIGN    CCEDTSV/(CCEDNEP-1),CCEDTSV
            ASSIGN    CCEDLSV/(CCEDNEP-1),CCEDLSV
          ENDIF
          CALL      UPCCED1
          GOTO      STED1000
.
STED9999  RETURN
.
.------------------------------------------------------------
. Update Variance Casemix Level 3
.------------------------------------------------------------
STEE0000  PACK      KEY30,SP70
          CALL      RDCCEE1
          IF        OVRCD=0
            CALL      RPCCEE1
          ENDIF
.
STEE1000  CALL      RKCCEE1
          BRANCH    OVRCD,STEE9999
.
          ADD       ONE,TOTALEXT
          IF        (TOTALEXT%100=0)
            DISPLAY   *P26:24,*V2LON,TOTALEXT,"/3"
          ENDIF
.
          MOVE      "999999999999",CCEEFMN
          MOVE      ZERO,CCEEFMX
          MOVE      ZERO,CCEEFSV
          MOVE      "999999999999",CCEETMN
          MOVE      ZERO,CCEETMX
          MOVE      ZERO,CCEETSV
          MOVE      "999999999999",CCEELMN
          MOVE      ZERO,CCEELMX
          MOVE      ZERO,CCEELSV
.
          PACK      KEY48,CCEELV1,CCEELV2,CCEELV3,SP70
          PACK      KEY30,CCEELV1,CCEELV2,CCEELV3,SP70
          CALL      RSCCEC2
STEE1100  CALL      RKCCEC2
          BRANCH    OVRCD,STEE1900
          PACK      KEY48,CCECLV1,CCECLV2,CCECLV3,SP70
          MATCH     KEY30,KEY48
          GOTO      STEE1900 IF NOT EQUAL
.
          MATCH     "1",CCECEXC  * Excluded
          GOTO      STEE1100 IF EQUAL
.
          CALL      CHKEE000
.
          ASSIGN    CCECFTC-(CCEEFTC/CCEENEP),F12P4
          ASSIGN    CCEEFSV+(F12P4*F12P4),CCEEFSV
.
          ASSIGN    CCECTTC-(CCEETTC/CCEENEP),F12P4
          ASSIGN    CCEETSV+(F12P4*F12P4),CCEETSV
.
          ASSIGN    CCECLOS-(CCEELTO/CCEENEP),F12P4
          ASSIGN    CCEELSV+(F12P4*F12P4),CCEELSV
.
          GOTO      STEE1100
.
STEE1900  IF        CCEENEP>1
            ASSIGN    CCEEFSV/(CCEENEP-1),CCEEFSV
            ASSIGN    CCEETSV/(CCEENEP-1),CCEETSV
            ASSIGN    CCEELSV/(CCEENEP-1),CCEELSV
          ENDIF
          CALL      UPCCEE1
          GOTO      STEE1000
.
STEE9999  RETURN
.------------------------------------------------------------
. Check Level 1 Min & Max
.------------------------------------------------------------
CHKEB000  IF        CCECFTC>CCEBFMX
            MOVE      CCECFTC,CCEBFMX
          ENDIF
          IF        CCECFTC<CCEBFMN
            MOVE      CCECFTC,CCEBFMN
          ENDIF
.
          IF        CCECTTC>CCEBTMX
            MOVE      CCECTTC,CCEBTMX
          ENDIF
          IF        CCECTTC<CCEBTMN
            MOVE      CCECTTC,CCEBTMN
          ENDIF
.
          IF        CCECLOS>CCEBLMX
            MOVE      CCECLOS,CCEBLMX
          ENDIF
          IF        CCECLOS<CCEBLMN
            MOVE      CCECLOS,CCEBLMN
          ENDIF
          RETURN
.------------------------------------------------------------
. Check Min & Max for Level 2
.------------------------------------------------------------
CHKED000  IF        CCECFTC>CCEDFMX
            MOVE      CCECFTC,CCEDFMX
          ENDIF
          IF        CCECFTC<CCEDFMN
            MOVE      CCECFTC,CCEDFMN
          ENDIF
.
          IF        CCECTTC>CCEDTMX
            MOVE      CCECTTC,CCEDTMX
          ENDIF
          IF        CCECTTC<CCEDTMN
            MOVE      CCECTTC,CCEDTMN
          ENDIF
.
          IF        CCECLOS>CCEDLMX
            MOVE      CCECLOS,CCEDLMX
          ENDIF
          IF        CCECLOS<CCEDLMN
            MOVE      CCECLOS,CCEDLMN
          ENDIF
          RETURN
.------------------------------------------------------------
. Check Level 3 Min & Max
.------------------------------------------------------------
CHKEE000  IF        CCECFTC>CCEEFMX
            MOVE      CCECFTC,CCEEFMX
          ENDIF
          IF        CCECFTC<CCEEFMN
            MOVE      CCECFTC,CCEEFMN
          ENDIF
.
          IF        CCECTTC>CCEETMX
            MOVE      CCECTTC,CCEETMX
          ENDIF
          IF        CCECTTC<CCEETMN
            MOVE      CCECTTC,CCEETMN
          ENDIF
.
          IF        CCECLOS>CCEELMX
            MOVE      CCECLOS,CCEELMX
          ENDIF
          IF        CCECLOS<CCEELMN
            MOVE      CCECLOS,CCEELMN
          ENDIF
          RETURN
.
.---------------------------------------------------------------------
. Enter Casemix Extract ID
.----------------------------------------------------------------------
EEID0000  MOVE      TWO,CKEYTYP
          CALL      KCCEAA00
          BRANCH    EXIT,EEID9999,EEID9999
          IF        OVRCD=1
            REP       UPPLOW,CCEAEID
            PACK      KEY4,CCEAEID
            CALL      RDCCEA1
            IF        OVRCD=1
              CALL      CLRREC00
              MOVE      ONE,OVRCD
            ENDIF
          ENDIF
          IF        OVRCD=0
            CALL      GETCME00
            MOVE      ZERO,OVRCD
          ELSE
            MOVE     "        ",CCEAFAD  * Setup Defaults for Insert
            MOVE     "99999999",CCEATAD  * of New Extract
            MOVE     "        ",CCEAFDD
            MOVE     "99999999",CCEATDD
          ENDIF
EEID9999  RETURN
.
CLRREC00  PACK      KEY4,CCEAEID
          CALL      RDCCEX1
          IF        OVRCD=0
            CALL      DECCEX1
          ENDIF
          CALL      RDCCEY1
          IF        OVRCD=0
            CALL      DECCEY1
          ENDIF
          RETURN
.======================================================================
. Determine Display Values for a Valid Casemix Extract Code
.======================================================================
GETCME00  MOVE      SP70,ITHEDESC
          MOVE      SP70,CTHEDESC
          MATCH     SP70,CCEAITHE
          IF        !@EQUAL
            MOVE      CCEAITHE,F1
            LOAD      ITHEDESC,F1,CCCOTH1,CCCOTH2,CCCOTH3,CCCOTH4
          ENDIF
.
          MATCH     SP70,CCEACTHE
          IF        !@EQUAL
            MOVE      CCEACTHE,F1
            LOAD      CTHEDESC,F1,CCCOTH1,CCCOTH2,CCCOTH3,CCCOTH4
          ENDIF
.
          MATCH     SP70,CCEAFDD
          IF        @EQUAL
            MOVE      "Start     ",FROMDD
          ELSE
            UNPACK    CCEAFDD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,FROMDD
          ENDIF
.
          MATCH     "99999999",CCEATDD
          IF        @EQUAL
            MOVE      "Finish    ",TODD
          ELSE
            UNPACK    CCEATDD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,TODD
          ENDIF
.
          MATCH     SP70,CCEAFAD
          IF        @EQUAL
            MOVE      "Start     ",FROMAD
          ELSE
            UNPACK    CCEAFAD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,FROMAD
          ENDIF
.
          MATCH     "99999999",CCEATAD
          IF        @EQUAL
            MOVE      "Finish    ",TOAD
          ELSE
            UNPACK    CCEATAD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPCDATE,TOAD
          ENDIF
.
          MOVE     CCEAVIS,F1
          BRANCH   F1,GETCME10,GETCME20,GETCME30
          MOVE     "All        ",VISITDES
          GOTO     GETCME40
GETCME10  MOVE     "A & E      ",VISITDES
          GOTO     GETCME40
GETCME20  MOVE     "Outpatients ",VISITDES
          GOTO     GETCME40
GETCME30  MOVE     "Inpatients",VISITDES
          GOTO     GETCME40
.
GETCME40
          MOVE     SP70,CLV1DES
          MOVE     SP70,CLV2DES
          MOVE     SP70,CLV3DES
          MOVE     CCEALV1,KEY3
          CALL     RDCCST1
          IF       OVRCD=0
            MOVE     CCSTDES,CLV1DES
          ENDIF
.
          MOVE     CCEALV2,KEY3
          CALL     RDCCST1
          IF       OVRCD=0
            MOVE     CCSTDES,CLV2DES
          ENDIF
.
          MOVE     CCEALV3,KEY3
          CALL     RDCCST1
          IF       OVRCD=0
            MOVE     CCSTDES,CLV3DES
          ENDIF
.
          MATCH    "0",CCEAUST
          IF       !@EQUAL
            MOVE     ONE,CCEAUST
          ENDIF
.
          MOVE       CCEADAY,F1
          IF         F1=0
            MOVE       "Exclude Day Cases",DAYCDESC
          ELSE
            IF         F1=2
              MOVE       "Day Cases Only",DAYCDESC
            ELSE
              MOVE       "Include Day Cases",DAYCDESC
            ENDIF
          ENDIF
.
          MOVE       SP70,CSTMDES
          MOVE       SP70,INCMDES
          MOVE       CCEAIMOD,KEY1
          CALL       RDCEPP1
          IF         OVRCD=0
            MOVE       CEPPDES,INCMDES
          ENDIF
          MOVE       CCEACMOD,KEY1
          CALL       RDCEPP1
          IF         OVRCD=0
            MOVE       CEPPDES,CSTMDES
          ENDIF
.
          RETURN
.----------------------------------------------------------------------
. Enter Casemix Visit Type
.----------------------------------------------------------------------
EVIS0000  MOVE     SP70,DISPMSG
          CALL     MESSAGE2
          DISPLAY  *P1:24,*EL,"Visit Types : ":
                          *V2LON,"0",*HOFF,". All, ":
                          *V2LON,"1",*HOFF,". A & E, ":
                          *V2LON,"2",*HOFF,". Outpatients, ":
                          *V2LON,"3",*HOFF,". Inpatients"
.
EVIS1000  KEYIN    *PCCOL:CVERT,*V2LON,*RV,F1
          IF       F1>3
            BEEP
            GOTO     EVIS1000
          ENDIF
          MOVE     F1,CCEAVIS
          CALL     MESSAGE3
          BRANCH   F1,EVIS0010,EVIS0020,EVIS0030
          MOVE     "All        ",VISITDES
          GOTO     EVIS9999
EVIS0010  MOVE     "A & E      ",VISITDES
          GOTO     EVIS9999
EVIS0020  MOVE     "Outpatients ",VISITDES
          GOTO     EVIS9999
EVIS0030  MOVE     "Inpatients",VISITDES
          GOTO     EVIS9999
.
EVIS9999  RETURN
.------------------------------------------------------------
. Enter Day Case Indicator
.------------------------------------------------------------
EDAYC000  CALL       MESSAGE2
          DISPLAY    *P1:24,*EL,"Days Cases : ":
                     *V2LON,"0.",*HOFF," Exclude, ":
                     *V2LON,"1.",*HOFF," Include, ":
                     *V2LON,"2.",*HOFF," Day Cases Only"
          MOVE       ONE,F1
EDAYC010  KEYIN      *PCCOL:CVERT,*V2LON,*RV,F1
          MOVE       F1,CCEADAY
          COMPARE    ZERO,F1
          GOTO       EDAYC100 IF EQUAL
          BRANCH     F1,EDAYC110,EDAYC120
          BEEP
          GOTO       EDAYC010
EDAYC100  MOVE       "Exclude Day Cases",DAYCDESC
          GOTO       EDAYC999
EDAYC110  MOVE       "Include Day Cases",DAYCDESC
          GOTO       EDAYC999
EDAYC120  MOVE       "Day Cases Only",DAYCDESC
          GOTO       EDAYC999
EDAYC999  CALL       MESSAGE3
          RETURN
.----------------------------------------
. Enter Casemix Level 1
.----------------------------------------
ECLV1000  MOVE     ZERO,CKEYTYP
          CALL     KCCSTA00
          BRANCH   EXIT,ECLV1100,ECLV1999
          MOVE     CCSTSTY,CCEALV1
          MOVE     CCSTDES,CLV1DES
          GOTO     ECLV1999
.
ECLV1100  BEEP
          MOVE     "Level 1 Casemix Type Required - ",DISPMSG
          CALL     MESSAGE1
          GOTO     ECLV1000
.
ECLV1999  RETURN
.----------------------------------------
. Enter Casemix Level 2
.----------------------------------------
ECLV2000  MOVE     ZERO,CKEYTYP
          CALL     KCCSTA00
          BRANCH   EXIT,ECLV2100,ECLV2999
          MOVE     CCSTSTY,CCEALV2
          MOVE     CCSTDES,CLV2DES
          GOTO     ECLV2999
.
ECLV2100  MOVE     ZERO,EXIT
          MOVE     SP70,CCEALV2
          MOVE     SP70,CLV2DES
.
ECLV2999  RETURN
.----------------------------------------
. Enter Casemix Level 3
.----------------------------------------
ECLV3000  MOVE     ZERO,CKEYTYP
          CALL     KCCSTA00
          BRANCH   EXIT,ECLV3100,ECLV3999
          MOVE     CCSTSTY,CCEALV3
          MOVE     CCSTDES,CLV3DES
          GOTO     ECLV3999
.
ECLV3100  MOVE     ZERO,EXIT
          MOVE     SP70,CCEALV3
          MOVE     SP70,CLV3DES
.
ECLV3999  RETURN
.---------------------------------------------------------------------
. Enter Income Model Replacement
.----------------------------------------------------------------------
EINCM000  MOVE      ZERO,CKEYTYP
          MOVE      SP70,INCMDES
          MOVE      SP70,CCEAIMOD
          CALL      KCEPPA00
          BRANCH    EXIT,EINCM999,EINCM999
          MOVE      CEPPIND,CCEAIMOD
          MOVE      CEPPDES,INCMDES
EINCM999  RETURN
.---------------------------------------------------------------------
. Enter Income Model Replacement
.----------------------------------------------------------------------
ECSTM000  MOVE      ZERO,CKEYTYP
          MOVE      SP70,CSTMDES
          MOVE      SP70,CCEACMOD
          CALL      KCEPPA00
          BRANCH    EXIT,ECSTM999,ECSTM999
          MOVE      CEPPIND,CCEACMOD
          MOVE      CEPPDES,CSTMDES
ECSTM999  RETURN
RDDAT000   MOVE     "   18",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RDDAT100
           MATCH    SP2,CDAY
           GOTO     RDDAT100 IF EQUAL
           PACK     CCEAFDD,CCENT,CYEAR,CMON,CDAY
           REP      " 0",CCEAFDD
           CALL     PACDATE
           MOVE     CPCDATE,FROMDD
           GOTO     RDDAT140
RDDAT100   MOVE     "Start             ",FROMDD
           MOVE     SP70,CCEAFDD
.
RDDAT140   MOVE     FROMDD,VAR
           CALL     DISPITEM
.
RDDAT150   MOVE     "   19",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RDDAT200
           MATCH    SP2,CDAY
           GOTO     RDDAT200 IF EQUAL
           PACK     CCEATDD,CCENT,CYEAR,CMON,CDAY
           REP      " 0",CCEATDD
           CALL     PACDATE
           MOVE     CPCDATE,TODD
           MATCH    CCEAFDD,CCEATDD
           GOTO     RDDAT999 IF EQUAL
           GOTO     RDDAT999 IF NOT LESS
           BEEP
           MOVE     "To Date Must Be > From Date - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RDDAT000
.
RDDAT200   MOVE     "Finish             ",TODD
           MOVE     "99999999",CCEATDD
.
RDDAT999   MOVE     "   18",FLDID
           CALL     GETPOSIT
           RETURN
RADAT000   MOVE     "   20",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RADAT100
           MATCH    SP2,CDAY
           GOTO     RADAT100 IF EQUAL
           PACK     CCEAFAD,CCENT,CYEAR,CMON,CDAY
           REP      " 0",CCEAFAD
           CALL     PACDATE
           MOVE     CPCDATE,FROMAD
           GOTO     RADAT140
RADAT100   MOVE     "Start             ",FROMAD
           MOVE     SP70,CCEAFAD
.
RADAT140   MOVE     FROMAD,VAR
           CALL     DISPITEM
.
RADAT150   MOVE     "   21",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RADAT200
           MATCH    SP2,CDAY
           GOTO     RADAT200 IF EQUAL
           PACK     CCEATAD,CCENT,CYEAR,CMON,CDAY
           REP      " 0",CCEATAD
           CALL     PACDATE
           MOVE     CPCDATE,TOAD
           MATCH    CCEAFAD,CCEATAD
           GOTO     RADAT999 IF EQUAL
           GOTO     RADAT999 IF NOT LESS
           BEEP
           MOVE     "To Date Must Be > From Date - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RADAT000
.
RADAT200   MOVE     "Finish             ",TOAD
           MOVE     "99999999",CCEATAD
.
RADAT999   MOVE     "   20",FLDID
           CALL     GETPOSIT
           RETURN
.----------------------------------------
. Income Replaced With
.----------------------------------------
KITHE000  MATCH     SP70,CCEAIMOD
          GOTO      KITHE900 IF NOT EQUAL
          MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          DISPLAY   *P1:24,*EL,"Op. Times : ":
                    *V2LON,"1. ",*HOFF,CCCOTH1,", ":
                    *V2LON,"2. ",*HOFF,CCCOTH2,", ":
                    *V2LON,"3. ",*HOFF,CCCOTH3,", ":
                    *V2LON,"4. ",*HOFF,CCCOTH4
KITHE010  MOVE      SP70,CCEAITHE
          MOVE      SP70,ITHEDESC
          MOVE      ZERO,F1
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,F1
          COMPARE   ZERO,F1
          GOTO      KITHE800 IF EQUAL
          MOVE      F1,CCEAITHE
          BRANCH    F1,KITHE100,KITHE100,KITHE100,KITHE100
          BEEP
          GOTO      KITHE010
.
KITHE100  LOAD      ITHEDESC,F1,CCCOTH1,CCCOTH2,CCCOTH3,CCCOTH4
KITHE800  CALL      MESSAGE3
          GOTO      KITHE999
.
KITHE900  COMPARE   ONE,ACCEPT
          GOTO      KITHE999 IF EQUAL
          MOVE      "Income is Replaced by a Model - ",DISPMSG
          BEEP
          CALL      MESSAGE1
KITHE999  RETURN
.----------------------------------------
. Cost Replaced With
.----------------------------------------
KCTHE000  MATCH     SP70,CCEACMOD
          GOTO      KCTHE900 IF NOT EQUAL
          MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          DISPLAY   *P1:24,*EL,"Op. Times : ":
                    *V2LON,"1. ",*HOFF,CCCOTH1,", ":
                    *V2LON,"2. ",*HOFF,CCCOTH2,", ":
                    *V2LON,"3. ",*HOFF,CCCOTH3,", ":
                    *V2LON,"4. ",*HOFF,CCCOTH4
KCTHE010  MOVE      SP70,CCEACTHE
          MOVE      SP70,CTHEDESC
          MOVE      ZERO,F1
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,F1
          COMPARE   ZERO,F1
          GOTO      KCTHE800 IF EQUAL
          MOVE      F1,CCEACTHE
          BRANCH    F1,KCTHE100,KCTHE100,KCTHE100,KCTHE100
          BEEP
          GOTO      KCTHE010
.
KCTHE100  LOAD      CTHEDESC,F1,CCCOTH1,CCCOTH2,CCCOTH3,CCCOTH4
KCTHE800  CALL      MESSAGE3
          GOTO      KCTHE999
.
KCTHE900  COMPARE   ONE,ACCEPT
          GOTO      KCTHE999 IF EQUAL
          MOVE      "Cost is Replaced by a Model - ",DISPMSG
          BEEP
          CALL      MESSAGE1
KCTHE999  RETURN
.---------------------------------------------------------------------------
. Read any Range Details
.---------------------------------------------------------------------------
GETEXT00  PACK     KEY4,CCEAEID
          CALL     CLREXT00          * Clear Record
          CALL     RDCCEX1             * Read Record
          IF       OVRCD=0
            CALL     SETEXT00          * Setup Names
          ENDIF
          RETURN
.
SETEXT00  MOVE      ZERO,SECTOR
          REPEAT
            ADD       ONE,SECTOR
            LOAD      KEY3,SECTOR,CCEXR01,CCEXR02,CCEXR03,CCEXR04,CCEXR05:
                                  CCEXR06,CCEXR07,CCEXR08,CCEXR09,CCEXR10:
                                  CCEXR11,CCEXR12,CCEXR13,CCEXR14
            MATCH     SP70,KEY3
            IF        !@EQUAL
              CALL      RDCCST1
              STORE     CCSTDES,SECTOR,DESC01,DESC02,DESC03,DESC04,DESC05:
                                       DESC06,DESC07,DESC08,DESC09,DESC10:
                                       DESC11,DESC12,DESC13,DESC14
.
              LOAD      KEY10,SECTOR,CCEXF01,CCEXF02,CCEXF03,CCEXF04,CCEXF05:
                                     CCEXF06,CCEXF07,CCEXF08,CCEXF09,CCEXF10:
                                     CCEXF11,CCEXF12,CCEXF13,CCEXF14
              SFORMAT   VAR,CCSTLEN
              MATCH     SP70,KEY10
              IF        @EQUAL
                MOVE      "Start                        ",KEY35
              ELSE
                PACK      KEY13,CCSTSTY,KEY10
                CALL      RDCCXH1
                MOVE      KEY10,VAR
                PACK      KEY35,VAR,SP1,CCXHDES
              ENDIF
              STORE     KEY35,SECTOR,FROM01,FROM02,FROM03,FROM04,FROM05:
                                    FROM06,FROM07,FROM08,FROM09,FROM10:
                                    FROM11,FROM12,FROM13,FROM14
.
              LOAD      KEY10,SECTOR,CCEXT01,CCEXT02,CCEXT03,CCEXT04,CCEXT05:
                                     CCEXT06,CCEXT07,CCEXT08,CCEXT09,CCEXT10:
                                     CCEXT11,CCEXT12,CCEXT13,CCEXT14
              SFORMAT   VAR,CCSTLEN
              MATCH     Z70,KEY10
              IF        @EQUAL
                MOVE      "Finish                       ",KEY35
              ELSE
                PACK      KEY13,CCSTSTY,KEY10
                CALL      RDCCXH1
                MOVE      KEY10,VAR
                PACK      KEY35,VAR,SP1,CCXHDES
              ENDIF
              STORE     KEY35,SECTOR,TO01,TO02,TO03,TO04,TO05:
                                    TO06,TO07,TO08,TO09,TO10:
                                    TO11,TO12,TO13,TO14
              SFORMAT   VAR,127
            ENDIF
         UNTIL      SECTOR=14
         RETURN
.
CLREXT00  MOVE      SP70,CCEXR01
          MOVE      SP70,CCEXF01
          MOVE      SP70,CCEXT01
          MOVE      SP70,CCEXR02
          MOVE      SP70,CCEXF02
          MOVE      SP70,CCEXT02
          MOVE      SP70,CCEXR03
          MOVE      SP70,CCEXF03
          MOVE      SP70,CCEXT03
          MOVE      SP70,CCEXR04
          MOVE      SP70,CCEXF04
          MOVE      SP70,CCEXT04
          MOVE      SP70,CCEXR05
          MOVE      SP70,CCEXF05
          MOVE      SP70,CCEXT05
          MOVE      SP70,CCEXR06
          MOVE      SP70,CCEXF06
          MOVE      SP70,CCEXT06
          MOVE      SP70,CCEXR07
          MOVE      SP70,CCEXF07
          MOVE      SP70,CCEXT07
          MOVE      SP70,CCEXR08
          MOVE      SP70,CCEXF08
          MOVE      SP70,CCEXT08
          MOVE      SP70,CCEXR09
          MOVE      SP70,CCEXF09
          MOVE      SP70,CCEXT09
          MOVE      SP70,CCEXR10
          MOVE      SP70,CCEXF10
          MOVE      SP70,CCEXT10
          MOVE      SP70,CCEXR11
          MOVE      SP70,CCEXF11
          MOVE      SP70,CCEXT11
          MOVE      SP70,CCEXR12
          MOVE      SP70,CCEXF12
          MOVE      SP70,CCEXT12
          MOVE      SP70,CCEXR13
          MOVE      SP70,CCEXF13
          MOVE      SP70,CCEXT13
          MOVE      SP70,CCEXR14
          MOVE      SP70,CCEXF14
          MOVE      SP70,CCEXT14
          MOVE      SP70,DESC01
          MOVE      SP70,DESC02
          MOVE      SP70,DESC03
          MOVE      SP70,DESC04
          MOVE      SP70,DESC05
          MOVE      SP70,DESC06
          MOVE      SP70,DESC07
          MOVE      SP70,DESC08
          MOVE      SP70,DESC09
          MOVE      SP70,DESC10
          MOVE      SP70,DESC11
          MOVE      SP70,DESC12
          MOVE      SP70,DESC13
          MOVE      SP70,DESC14
          MOVE      SP70,FROM01
          MOVE      SP70,FROM02
          MOVE      SP70,FROM03
          MOVE      SP70,FROM04
          MOVE      SP70,FROM05
          MOVE      SP70,FROM06
          MOVE      SP70,FROM07
          MOVE      SP70,FROM08
          MOVE      SP70,FROM09
          MOVE      SP70,FROM10
          MOVE      SP70,FROM11
          MOVE      SP70,FROM12
          MOVE      SP70,FROM13
          MOVE      SP70,FROM14
          MOVE      SP70,TO01
          MOVE      SP70,TO02
          MOVE      SP70,TO03
          MOVE      SP70,TO04
          MOVE      SP70,TO05
          MOVE      SP70,TO06
          MOVE      SP70,TO07
          MOVE      SP70,TO08
          MOVE      SP70,TO09
          MOVE      SP70,TO10
          MOVE      SP70,TO11
          MOVE      SP70,TO12
          MOVE      SP70,TO13
          MOVE      SP70,TO14
          RETURN
.---------------------------------------------------------------------------
. Delete Ranges
.---------------------------------------------------------------------------
DEL10000  PACK     KEY4,CCEAEID
          CALL     RDCCEX1             * Read Record
          IF       OVRCD=0
            CALL     DECCEX1           * Setup Names
          ENDIF
          RETURN
.
.---------------------------------------------------------------------------
. Delete Ranges
.---------------------------------------------------------------------------
POS10000  PACK     KEY4,CCEAEID
          MOVE     KEY4,CCEXEID
          CALL     RACCEX1             * Read Record
          IF       OVRCD=0
            CALL     UPCCEX1
          ELSE
            CALL     WRCCEX1
          ENDIF
          RETURN
.
.---------------------------------------------------------------------------
. Enter Range 01
.---------------------------------------------------------------------------
R01KY000   ASSIGN   FOUR+01,SECTOR
           MOVE     SECTOR,FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
.
           MOVE     ZERO,CKEYTYP
           MOVE     SP70,DESC01
           MOVE     SP70,FROM01
           MOVE     SP70,TO01
           MOVE     SP70,CCEXR01
           MOVE     SP70,CCEXF01
           MOVE     SP70,CCEXT01
           CALL     KCCSTA00
           BRANCH   EXIT,R01KY999,R01KY999
           MOVE     CCSTDES,DESC01
           MOVE     CCSTSTY,CCEXR01
           MOVE     CCSTSTY,CCXHSTY
.
           MOVE     DESC01,VAR
           CALL     DISPITEM
.
R01KY010   ASSIGN   FIVE+01,SECTOR
           MOVE     SECTOR,FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R01KY100,R01KY999
.
           MOVE     CCXHKEY,CCEXF01
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     FROM01,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           GOTO     R01KY140
.
R01KY100   MOVE     "Start             ",FROM01
           MOVE     SP70,CCEXF01
.
R01KY140   MOVE     FROM01,VAR
           CALL     DISPITEM
.
R01KY150   ASSIGN   SIX+01,SECTOR
           MOVE     SECTOR,FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R01KY200,R01KY999
.
           MOVE     CCXHKEY,CCEXT01
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     TO01,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           MATCH    CCEXF01,CCEXT01
           GOTO     R01KY999 IF EQUAL
           GOTO     R01KY999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code  - ",DISPMSG
           CALL     MESSAGE1
           GOTO     R01KY010
.
R01KY200   MOVE     "Finish             ",TO01
           MOVE     Z70,CCEXT01
.
R01KY999   ASSIGN   FOUR+01,SECTOR
           MOVE     SECTOR,FLDID
           CALL     GETPOSIT
           RETURN
.---------------------------------------------------------------------------
. Enter Casemix Code
.-------------------------------------------------------------------------------
EXHD0000  TOPIC     "CCXHKEY "
          MOVE      CCSTSTY,CCXHSTY
          SFORMAT   VAR,CCSTLEN
          MATCH     "1",CCSTJR
          IF        @EQUAL
            KEYIN     *PCCOL:CVERT,*MASK,*V2LON,*JR,VAR
          ELSE
            KEYIN     *PCCOL:CVERT,*MASK,*V2LON,VAR
          ENDIF
.
          MATCH     "1",CCSTZF
          IF        @EQUAL
            REP       " 0",VAR
          ENDIF
.
          DISPLAY     *PCCOL:CVERT,*V2LON,VAR
.
          ENDSET    VAR
          APPEND    SP70,VAR
          RESET     VAR
.
          MATCH     SP70,VAR
          GOTO      EXHD0090 IF EQUAL
.
          MATCH     "1",CCSTJR
          IF        @EQUAL
            ENDSET    VAR
          ENDIF
          CMATCH    EXITCHAR,VAR
          GOTO      EXHD0095 IF EQUAL
.
          CMATCH    QUEST,VAR
          GOTO      EXHD0010 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCXHA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCXHKEY
          APPEND    SP70,CCXHKEY
          RESET     CCXHKEY
.
          MATCH     SP70,CCXHKEY
          GOTO      EXHD0000 IF EQUAL
          MOVE      CCXHKEY,VAR
.
          DISPLAY   *PCCOL:CVERT,*V2LON,VAR
EXHD0010
          RESET     VAR
          MATCH     "1",CCSTDE
          IF        @EQUAL
            TYPE      VAR
            GOTO      EXHD0015 IF EQUAL
            BEEP
            GOTO      EXHD0000
          ENDIF
EXHD0015
          MOVE      VAR,CCXHKEY
          PACK      KEY13,CCXHSTY,VAR
          CALL      RACCXH1
          BRANCH    OVRCD,EXHD0080
          CALL      RDCCXH1
          MOVE      ZERO,EXIT
          GOTO      EXHD0099
.
EXHD0080  MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,EXHD0099,EXHD0099
          MOVE      "Code Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          MOVE      SP70,CCXHDES
          MOVE      ZERO,EXIT
          GOTO      EXHD0099
.
EXHD0085  MOVE      SP70,CCXHKEY
          MOVE      ZERO,EXIT
          GOTO      EXHD0099
.
EXHD0090  MOVE      SP70,CCXHKEY
          MOVE      ONE,EXIT
          GOTO      EXHD0099
.
EXHD0095  MOVE      TWO,EXIT
.
EXHD0099  SFORMAT   VAR,127
          TOPIC     PRGID
          RETURN
.
.---------------------------------------------------------------------------
. Enter Range 02
.---------------------------------------------------------------------------
R02KY000   MOVE     "8",SECTOR
           MOVE     SECTOR,FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
.
           MOVE     ZERO,CKEYTYP
           MOVE     SP70,DESC02
           MOVE     SP70,FROM02
           MOVE     SP70,TO02
           MOVE     SP70,CCEXR02
           MOVE     SP70,CCEXF02
           MOVE     SP70,CCEXT02
           CALL     KCCSTA00
           BRANCH   EXIT,R02KY999,R02KY999
           MOVE     CCSTDES,DESC02
           MOVE     CCSTSTY,CCEXR02
           MOVE     CCSTSTY,CCXHSTY
.
           MOVE     DESC02,VAR
           CALL     DISPITEM
.
R02KY010   MOVE     "9",SECTOR
           MOVE     SECTOR,FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R02KY100,R02KY999
.
           MOVE     CCXHKEY,CCEXF02
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     FROM02,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           GOTO     R02KY140
.
R02KY100   MOVE     "Start             ",FROM02
           MOVE     SP70,CCEXF02
.
R02KY140   MOVE     FROM02,VAR
           CALL     DISPITEM
.
R02KY150   MOVE     "10",SECTOR
           MOVE     SECTOR,FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R02KY200,R02KY999
.
           MOVE     CCXHKEY,CCEXT02
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     TO02,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           MATCH    CCEXF02,CCEXT02
           GOTO     R02KY999 IF EQUAL
           GOTO     R02KY999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code  - ",DISPMSG
           CALL     MESSAGE1
           GOTO     R02KY010
.
R02KY200   MOVE     "Finish             ",TO02
           MOVE     Z70,CCEXT02
.
R02KY999   MOVE     "8",SECTOR
           MOVE     SECTOR,FLDID
           CALL     GETPOSIT
           RETURN
.

.---------------------------------------------------------------------------
. Enter Range 03
.---------------------------------------------------------------------------
R03KY000   MOVE     "   11",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
.
           MOVE     ZERO,CKEYTYP
           MOVE     SP70,DESC03
           MOVE     SP70,FROM03
           MOVE     SP70,TO03
           MOVE     SP70,CCEXR03
           MOVE     SP70,CCEXF03
           MOVE     SP70,CCEXT03
           CALL     KCCSTA00
           BRANCH   EXIT,R03KY999,R03KY999
           MOVE     CCSTDES,DESC03
           MOVE     CCSTSTY,CCEXR03
           MOVE     CCSTSTY,CCXHSTY
.
           MOVE     DESC03,VAR
           CALL     DISPITEM
.
R03KY010   MOVE     "   12",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R03KY100,R03KY999
.
           MOVE     CCXHKEY,CCEXF03
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     FROM03,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           GOTO     R03KY140
.
R03KY100   MOVE     "Start             ",FROM03
           MOVE     SP70,CCEXF03
.
R03KY140   MOVE     FROM03,VAR
           CALL     DISPITEM
.
R03KY150   MOVE     "   13",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R03KY200,R03KY999
.
           MOVE     CCXHKEY,CCEXT03
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     TO03,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           MATCH    CCEXF03,CCEXT03
           GOTO     R03KY999 IF EQUAL
           GOTO     R03KY999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code  - ",DISPMSG
           CALL     MESSAGE1
           GOTO     R03KY010
.
R03KY200   MOVE     "Finish             ",TO03
           MOVE     Z70,CCEXT03
.
R03KY999   MOVE     "   11",FLDID
           CALL     GETPOSIT
           RETURN
.
.---------------------------------------------------------------------------
. Enter Range 04
.---------------------------------------------------------------------------
R04KY000   MOVE     "   14",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
.
           MOVE     ZERO,CKEYTYP
           MOVE     SP70,DESC04
           MOVE     SP70,FROM04
           MOVE     SP70,TO04
           MOVE     SP70,CCEXR04
           MOVE     SP70,CCEXF04
           MOVE     SP70,CCEXT04
           CALL     KCCSTA00
           BRANCH   EXIT,R04KY999,R04KY999
           MOVE     CCSTDES,DESC04
           MOVE     CCSTSTY,CCEXR04
           MOVE     CCSTSTY,CCXHSTY
.
           MOVE     DESC04,VAR
           CALL     DISPITEM
.
R04KY010   ASSIGN   FIVE+04,SECTOR
           MOVE     "   15",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R04KY100,R04KY999
.
           MOVE     CCXHKEY,CCEXF04
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     FROM04,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           GOTO     R04KY140
.
R04KY100   MOVE     "Start             ",FROM04
           MOVE     SP70,CCEXF04
.
R04KY140   MOVE     FROM04,VAR
           CALL     DISPITEM
.
R04KY150   ASSIGN   SIX+04,SECTOR
           MOVE     "   16",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R04KY200,R04KY999
.
           MOVE     CCXHKEY,CCEXT04
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     TO04,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           MATCH    CCEXF04,CCEXT04
           GOTO     R04KY999 IF EQUAL
           GOTO     R04KY999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code  - ",DISPMSG
           CALL     MESSAGE1
           GOTO     R04KY010
.
R04KY200   MOVE     "Finish             ",TO04
           MOVE     Z70,CCEXT04
.
R04KY999   ASSIGN   FOUR+04,SECTOR
           MOVE     "   14",FLDID
           CALL     GETPOSIT
           RETURN
.
.---------------------------------------------------------------------------
. Enter Range 05
.---------------------------------------------------------------------------
R05KY000   ASSIGN   FOUR+05,SECTOR
           MOVE     "   17",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
.
           MOVE     ZERO,CKEYTYP
           MOVE     SP70,DESC05
           MOVE     SP70,FROM05
           MOVE     SP70,TO05
           MOVE     SP70,CCEXR05
           MOVE     SP70,CCEXF05
           MOVE     SP70,CCEXT05
           CALL     KCCSTA00
           BRANCH   EXIT,R05KY999,R05KY999
           MOVE     CCSTDES,DESC05
           MOVE     CCSTSTY,CCEXR05
           MOVE     CCSTSTY,CCXHSTY
.
           MOVE     DESC05,VAR
           CALL     DISPITEM
.
R05KY010   ASSIGN   FIVE+05,SECTOR
           MOVE     "   18",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R05KY100,R05KY999
.
           MOVE     CCXHKEY,CCEXF05
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     FROM05,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           GOTO     R05KY140
.
R05KY100   MOVE     "Start             ",FROM05
           MOVE     SP70,CCEXF05
.
R05KY140   MOVE     FROM05,VAR
           CALL     DISPITEM
.
R05KY150   ASSIGN   SIX+05,SECTOR
           MOVE     "   19",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R05KY200,R05KY999
.
           MOVE     CCXHKEY,CCEXT05
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     TO05,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           MATCH    CCEXF05,CCEXT05
           GOTO     R05KY999 IF EQUAL
           GOTO     R05KY999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code  - ",DISPMSG
           CALL     MESSAGE1
           GOTO     R05KY010
.
R05KY200   MOVE     "Finish             ",TO05
           MOVE     Z70,CCEXT05
.
R05KY999   ASSIGN   FOUR+05,SECTOR
           MOVE     "   17",FLDID
           CALL     GETPOSIT
           RETURN
.
.---------------------------------------------------------------------------
. Enter Range 06
.---------------------------------------------------------------------------
R06KY000   ASSIGN   FOUR+06,SECTOR
           MOVE     "   20",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
.
           MOVE     ZERO,CKEYTYP
           MOVE     SP70,DESC06
           MOVE     SP70,FROM06
           MOVE     SP70,TO06
           MOVE     SP70,CCEXR06
           MOVE     SP70,CCEXF06
           MOVE     SP70,CCEXT06
           CALL     KCCSTA00
           BRANCH   EXIT,R06KY999,R06KY999
           MOVE     CCSTDES,DESC06
           MOVE     CCSTSTY,CCEXR06
           MOVE     CCSTSTY,CCXHSTY
.
           MOVE     DESC06,VAR
           CALL     DISPITEM
.
R06KY010   ASSIGN   FIVE+06,SECTOR
           MOVE     "   21",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R06KY100,R06KY999
.
           MOVE     CCXHKEY,CCEXF06
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     FROM06,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           GOTO     R06KY140
.
R06KY100   MOVE     "Start             ",FROM06
           MOVE     SP70,CCEXF06
.
R06KY140   MOVE     FROM06,VAR
           CALL     DISPITEM
.
R06KY150   ASSIGN   SIX+06,SECTOR
           MOVE     "   22",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R06KY200,R06KY999
.
           MOVE     CCXHKEY,CCEXT06
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     TO06,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           MATCH    CCEXF06,CCEXT06
           GOTO     R06KY999 IF EQUAL
           GOTO     R06KY999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code  - ",DISPMSG
           CALL     MESSAGE1
           GOTO     R06KY010
.
R06KY200   MOVE     "Finish             ",TO06
           MOVE     Z70,CCEXT06
.
R06KY999   ASSIGN   FOUR+06,SECTOR
           MOVE     "   20",FLDID
           CALL     GETPOSIT
           RETURN
.
.---------------------------------------------------------------------------
. Enter Range 07
.---------------------------------------------------------------------------
R07KY000   ASSIGN   FOUR+07,SECTOR
           MOVE     "   23",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
.
           MOVE     ZERO,CKEYTYP
           MOVE     SP70,DESC07
           MOVE     SP70,FROM07
           MOVE     SP70,TO07
           MOVE     SP70,CCEXR07
           MOVE     SP70,CCEXF07
           MOVE     SP70,CCEXT07
           CALL     KCCSTA00
           BRANCH   EXIT,R07KY999,R07KY999
           MOVE     CCSTDES,DESC07
           MOVE     CCSTSTY,CCEXR07
           MOVE     CCSTSTY,CCXHSTY
.
           MOVE     DESC07,VAR
           CALL     DISPITEM
.
R07KY010   ASSIGN   FIVE+07,SECTOR
           MOVE     "   24",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R07KY100,R07KY999
.
           MOVE     CCXHKEY,CCEXF07
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     FROM07,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           GOTO     R07KY140
.
R07KY100   MOVE     "Start             ",FROM07
           MOVE     SP70,CCEXF07
.
R07KY140   MOVE     FROM07,VAR
           CALL     DISPITEM
.
R07KY150   ASSIGN   SIX+07,SECTOR
           MOVE     "   25",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R07KY200,R07KY999
.
           MOVE     CCXHKEY,CCEXT07
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     TO07,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           MATCH    CCEXF07,CCEXT07
           GOTO     R07KY999 IF EQUAL
           GOTO     R07KY999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code  - ",DISPMSG
           CALL     MESSAGE1
           GOTO     R07KY010
.
R07KY200   MOVE     "Finish             ",TO07
           MOVE     Z70,CCEXT07
.
R07KY999   ASSIGN   FOUR+07,SECTOR
           MOVE     "   23",FLDID
           CALL     GETPOSIT
           RETURN
.
.---------------------------------------------------------------------------
. Enter Range 08
.---------------------------------------------------------------------------
R08KY000   ASSIGN   FOUR+08,SECTOR
           MOVE     "   26",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
.
           MOVE     ZERO,CKEYTYP
           MOVE     SP70,DESC08
           MOVE     SP70,FROM08
           MOVE     SP70,TO08
           MOVE     SP70,CCEXR08
           MOVE     SP70,CCEXF08
           MOVE     SP70,CCEXT08
           CALL     KCCSTA00
           BRANCH   EXIT,R08KY999,R08KY999
           MOVE     CCSTDES,DESC08
           MOVE     CCSTSTY,CCEXR08
           MOVE     CCSTSTY,CCXHSTY
.
           MOVE     DESC08,VAR
           CALL     DISPITEM
.
R08KY010   ASSIGN   FIVE+08,SECTOR
           MOVE     "   27",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R08KY100,R08KY999
.
           MOVE     CCXHKEY,CCEXF08
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     FROM08,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           GOTO     R08KY140
.
R08KY100   MOVE     "Start             ",FROM08
           MOVE     SP70,CCEXF08
.
R08KY140   MOVE     FROM08,VAR
           CALL     DISPITEM
.
R08KY150   ASSIGN   SIX+08,SECTOR
           MOVE     "   28",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R08KY200,R08KY999
.
           MOVE     CCXHKEY,CCEXT08
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     TO08,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           MATCH    CCEXF08,CCEXT08
           GOTO     R08KY999 IF EQUAL
           GOTO     R08KY999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code  - ",DISPMSG
           CALL     MESSAGE1
           GOTO     R08KY010
.
R08KY200   MOVE     "Finish             ",TO08
           MOVE     Z70,CCEXT08
.
R08KY999   ASSIGN   FOUR+08,SECTOR
           MOVE     "   26",FLDID
           CALL     GETPOSIT
           RETURN
.
.---------------------------------------------------------------------------
. Enter Range 09
.---------------------------------------------------------------------------
R09KY000   ASSIGN   FOUR+09,SECTOR
           MOVE     "   29",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
.
           MOVE     ZERO,CKEYTYP
           MOVE     SP70,DESC09
           MOVE     SP70,FROM09
           MOVE     SP70,TO09
           MOVE     SP70,CCEXR09
           MOVE     SP70,CCEXF09
           MOVE     SP70,CCEXT09
           CALL     KCCSTA00
           BRANCH   EXIT,R09KY999,R09KY999
           MOVE     CCSTDES,DESC09
           MOVE     CCSTSTY,CCEXR09
           MOVE     CCSTSTY,CCXHSTY
.
           MOVE     DESC09,VAR
           CALL     DISPITEM
.
R09KY010   ASSIGN   FIVE+09,SECTOR
           MOVE     "   30",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R09KY100,R09KY999
.
           MOVE     CCXHKEY,CCEXF09
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     FROM09,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           GOTO     R09KY140
.
R09KY100   MOVE     "Start             ",FROM09
           MOVE     SP70,CCEXF09
.
R09KY140   MOVE     FROM09,VAR
           CALL     DISPITEM
.
R09KY150   ASSIGN   SIX+09,SECTOR
           MOVE     "   31",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R09KY200,R09KY999
.
           MOVE     CCXHKEY,CCEXT09
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     TO09,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           MATCH    CCEXF09,CCEXT09
           GOTO     R09KY999 IF EQUAL
           GOTO     R09KY999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code  - ",DISPMSG
           CALL     MESSAGE1
           GOTO     R09KY010
.
R09KY200   MOVE     "Finish             ",TO09
           MOVE     Z70,CCEXT09
.
R09KY999   ASSIGN   FOUR+09,SECTOR
           MOVE     "   29",FLDID
           CALL     GETPOSIT
           RETURN
.
.---------------------------------------------------------------------------
. Enter Range 10
.---------------------------------------------------------------------------
R10KY000   ASSIGN   FOUR+10,SECTOR
           MOVE     "   32",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
.
           MOVE     ZERO,CKEYTYP
           MOVE     SP70,DESC10
           MOVE     SP70,FROM10
           MOVE     SP70,TO10
           MOVE     SP70,CCEXR10
           MOVE     SP70,CCEXF10
           MOVE     SP70,CCEXT10
           CALL     KCCSTA00
           BRANCH   EXIT,R10KY999,R10KY999
           MOVE     CCSTDES,DESC10
           MOVE     CCSTSTY,CCEXR10
           MOVE     CCSTSTY,CCXHSTY
.
           MOVE     DESC10,VAR
           CALL     DISPITEM
.
R10KY010   ASSIGN   FIVE+10,SECTOR
           MOVE     "   33",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R10KY100,R10KY999
.
           MOVE     CCXHKEY,CCEXF10
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     FROM10,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           GOTO     R10KY140
.
R10KY100   MOVE     "Start             ",FROM10
           MOVE     SP70,CCEXF10
.
R10KY140   MOVE     FROM10,VAR
           CALL     DISPITEM
.
R10KY150   ASSIGN   SIX+10,SECTOR
           MOVE     "   34",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R10KY200,R10KY999
.
           MOVE     CCXHKEY,CCEXT10
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     TO10,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           MATCH    CCEXF10,CCEXT10
           GOTO     R10KY999 IF EQUAL
           GOTO     R10KY999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code  - ",DISPMSG
           CALL     MESSAGE1
           GOTO     R10KY010
.
R10KY200   MOVE     "Finish             ",TO10
           MOVE     Z70,CCEXT10
.
R10KY999   ASSIGN   FOUR+10,SECTOR
           MOVE     "   32",FLDID
           CALL     GETPOSIT
           RETURN
.
.---------------------------------------------------------------------------
. Enter Range 11
.---------------------------------------------------------------------------
R11KY000   ASSIGN   FOUR+11,SECTOR
           MOVE     "   35",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
.
           MOVE     ZERO,CKEYTYP
           MOVE     SP70,DESC11
           MOVE     SP70,FROM11
           MOVE     SP70,TO11
           MOVE     SP70,CCEXR11
           MOVE     SP70,CCEXF11
           MOVE     SP70,CCEXT11
           CALL     KCCSTA00
           BRANCH   EXIT,R11KY999,R11KY999
           MOVE     CCSTDES,DESC11
           MOVE     CCSTSTY,CCEXR11
           MOVE     CCSTSTY,CCXHSTY
.
           MOVE     DESC11,VAR
           CALL     DISPITEM
.
R11KY010   ASSIGN   FIVE+11,SECTOR
           MOVE     "   36",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R11KY100,R11KY999
.
           MOVE     CCXHKEY,CCEXF11
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     FROM11,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           GOTO     R11KY140
.
R11KY100   MOVE     "Start             ",FROM11
           MOVE     SP70,CCEXF11
.
R11KY140   MOVE     FROM11,VAR
           CALL     DISPITEM
.
R11KY150   ASSIGN   SIX+11,SECTOR
           MOVE     "   37",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R11KY200,R11KY999
.
           MOVE     CCXHKEY,CCEXT11
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     TO11,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           MATCH    CCEXF11,CCEXT11
           GOTO     R11KY999 IF EQUAL
           GOTO     R11KY999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code  - ",DISPMSG
           CALL     MESSAGE1
           GOTO     R11KY010
.
R11KY200   MOVE     "Finish             ",TO11
           MOVE     Z70,CCEXT11
.
R11KY999   ASSIGN   FOUR+11,SECTOR
           MOVE     "   35",FLDID
           CALL     GETPOSIT
           RETURN
.
.---------------------------------------------------------------------------
. Enter Range 12
.---------------------------------------------------------------------------
R12KY000   ASSIGN   FOUR+12,SECTOR
           MOVE     "   38",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
.
           MOVE     ZERO,CKEYTYP
           MOVE     SP70,DESC12
           MOVE     SP70,FROM12
           MOVE     SP70,TO12
           MOVE     SP70,CCEXR12
           MOVE     SP70,CCEXF12
           MOVE     SP70,CCEXT12
           CALL     KCCSTA00
           BRANCH   EXIT,R12KY999,R12KY999
           MOVE     CCSTDES,DESC12
           MOVE     CCSTSTY,CCEXR12
           MOVE     CCSTSTY,CCXHSTY
.
           MOVE     DESC12,VAR
           CALL     DISPITEM
.
R12KY010   ASSIGN   FIVE+12,SECTOR
           MOVE     "   39",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R12KY100,R12KY999
.
           MOVE     CCXHKEY,CCEXF12
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     FROM12,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           GOTO     R12KY140
.
R12KY100   MOVE     "Start             ",FROM12
           MOVE     SP70,CCEXF12
.
R12KY140   MOVE     FROM12,VAR
           CALL     DISPITEM
.
R12KY150   ASSIGN   SIX+12,SECTOR
           MOVE     "   40",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R12KY200,R12KY999
.
           MOVE     CCXHKEY,CCEXT12
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     TO12,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           MATCH    CCEXF12,CCEXT12
           GOTO     R12KY999 IF EQUAL
           GOTO     R12KY999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code  - ",DISPMSG
           CALL     MESSAGE1
           GOTO     R12KY010
.
R12KY200   MOVE     "Finish             ",TO12
           MOVE     Z70,CCEXT12
.
R12KY999   ASSIGN   FOUR+12,SECTOR
           MOVE     "   38",FLDID
           CALL     GETPOSIT
           RETURN
.
.---------------------------------------------------------------------------
. Enter Range 13
.---------------------------------------------------------------------------
R13KY000   ASSIGN   FOUR+13,SECTOR
           MOVE     "   41",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
.
           MOVE     ZERO,CKEYTYP
           MOVE     SP70,DESC13
           MOVE     SP70,FROM13
           MOVE     SP70,TO13
           MOVE     SP70,CCEXR13
           MOVE     SP70,CCEXF13
           MOVE     SP70,CCEXT13
           CALL     KCCSTA00
           BRANCH   EXIT,R13KY999,R13KY999
           MOVE     CCSTDES,DESC13
           MOVE     CCSTSTY,CCEXR13
           MOVE     CCSTSTY,CCXHSTY
.
           MOVE     DESC13,VAR
           CALL     DISPITEM
.
R13KY010   ASSIGN   FIVE+13,SECTOR
           MOVE     "   42",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R13KY100,R13KY999
.
           MOVE     CCXHKEY,CCEXF13
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     FROM13,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           GOTO     R13KY140
.
R13KY100   MOVE     "Start             ",FROM13
           MOVE     SP70,CCEXF13
.
R13KY140   MOVE     FROM13,VAR
           CALL     DISPITEM
.
R13KY150   ASSIGN   SIX+13,SECTOR
           MOVE     "   43",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R13KY200,R13KY999
.
           MOVE     CCXHKEY,CCEXT13
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     TO13,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           MATCH    CCEXF13,CCEXT13
           GOTO     R13KY999 IF EQUAL
           GOTO     R13KY999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code  - ",DISPMSG
           CALL     MESSAGE1
           GOTO     R13KY010
.
R13KY200   MOVE     "Finish             ",TO13
           MOVE     Z70,CCEXT13
.
R13KY999   ASSIGN   FOUR+13,SECTOR
           MOVE     "   41",FLDID
           CALL     GETPOSIT
           RETURN
.
.---------------------------------------------------------------------------
. Enter Range 14
.---------------------------------------------------------------------------
R14KY000   ASSIGN   FOUR+14,SECTOR
           MOVE     "   44",FLDID
           CALL     GETPOSIT
           MOVE     SP70,VAR
           CALL     DISPITEM
.
           MOVE     ZERO,CKEYTYP
           MOVE     SP70,DESC14
           MOVE     SP70,FROM14
           MOVE     SP70,TO14
           MOVE     SP70,CCEXR14
           MOVE     SP70,CCEXF14
           MOVE     SP70,CCEXT14
           CALL     KCCSTA00
           BRANCH   EXIT,R14KY999,R14KY999
           MOVE     CCSTDES,DESC14
           MOVE     CCSTSTY,CCEXR14
           MOVE     CCSTSTY,CCXHSTY
.
           MOVE     DESC14,VAR
           CALL     DISPITEM
.
R14KY010   ASSIGN   FIVE+14,SECTOR
           MOVE     "   45",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R14KY100,R14KY999
.
           MOVE     CCXHKEY,CCEXF14
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     FROM14,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           GOTO     R14KY140
.
R14KY100   MOVE     "Start             ",FROM14
           MOVE     SP70,CCEXF14
.
R14KY140   MOVE     FROM14,VAR
           CALL     DISPITEM
.
R14KY150   ASSIGN   SIX+14,SECTOR
           MOVE     "   46",FLDID
           CALL     GETPOSIT
           CALL     EXHD0000
           BRANCH   EXIT,R14KY200,R14KY999
.
           MOVE     CCXHKEY,CCEXT14
           SFORMAT  VAR,CCSTLEN
           MOVE     CCXHKEY,VAR
           PACK     TO14,VAR,SP1,CCXHDES
           SFORMAT  VAR,127
.
           MATCH    CCEXF14,CCEXT14
           GOTO     R14KY999 IF EQUAL
           GOTO     R14KY999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code  - ",DISPMSG
           CALL     MESSAGE1
           GOTO     R14KY010
.
R14KY200   MOVE     "Finish             ",TO14
           MOVE     Z70,CCEXT14
.
R14KY999   ASSIGN   FOUR+14,SECTOR
           MOVE     "   44",FLDID
           CALL     GETPOSIT
           RETURN
.
.---------------------------------------------------------------------------
. Read any Range Details
.---------------------------------------------------------------------------
GETMEA00
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          PACK     KEY4,CCEAEID
          CALL     CLRMEA00          * Clear Record
          CALL     RDCCEY1           * Read Record
          RETURN
.
CLRMEA00  MOVE     CCEAEID,CCEYEID * Include All As Default
          MOVE     ONE,CCEYBA1
          MOVE     ONE,CCEYBA2
          MOVE     ONE,CCEYBA3
          MOVE     ONE,CCEYBAO
          MOVE     ONE,CCEYITH
          MOVE     ONE,CCEYIA1
          MOVE     ONE,CCEYIA2
          MOVE     ONE,CCEYIA3
          MOVE     ONE,CCEYIAO
          MOVE     ONE,CCEYIM1
          MOVE     ONE,CCEYIM2
          MOVE     ONE,CCEYIM3
          MOVE     ONE,CCEYIMO
          MOVE     ONE,CCEYETH1
          MOVE     ONE,CCEYEA11
          MOVE     ONE,CCEYEA21
          MOVE     ONE,CCEYEA31
          MOVE     ONE,CCEYEAO1
          MOVE     ONE,CCEYEM11
          MOVE     ONE,CCEYEM21
          MOVE     ONE,CCEYEM31
          MOVE     ONE,CCEYEMO1
          MOVE     ONE,CCEYETH2
          MOVE     ONE,CCEYEA12
          MOVE     ONE,CCEYEA22
          MOVE     ONE,CCEYEA32
          MOVE     ONE,CCEYEAO2
          MOVE     ONE,CCEYEM12
          MOVE     ONE,CCEYEM22
          MOVE     ONE,CCEYEM32
          MOVE     ONE,CCEYEMO2
          MOVE     ONE,CCEYETH3
          MOVE     ONE,CCEYEA13
          MOVE     ONE,CCEYEA23
          MOVE     ONE,CCEYEA33
          MOVE     ONE,CCEYEAO3
          MOVE     ONE,CCEYEM13
          MOVE     ONE,CCEYEM23
          MOVE     ONE,CCEYEM33
          MOVE     ONE,CCEYEMO3
          MOVE     ONE,CCEYETH4
          MOVE     ONE,CCEYEA14
          MOVE     ONE,CCEYEA24
          MOVE     ONE,CCEYEA34
          MOVE     ONE,CCEYEAO4
          MOVE     ONE,CCEYEM14
          MOVE     ONE,CCEYEM24
          MOVE     ONE,CCEYEM34
          MOVE     ONE,CCEYEMO4
          MOVE     ONE,CCEYETH5
          MOVE     ONE,CCEYEA15
          MOVE     ONE,CCEYEA25
          MOVE     ONE,CCEYEA35
          MOVE     ONE,CCEYEAO5
          MOVE     ONE,CCEYEM15
          MOVE     ONE,CCEYEM25
          MOVE     ONE,CCEYEM35
          MOVE     ONE,CCEYEMO5
          MOVE     SP70,CCEYSPA
          RETURN
.---------------------------------------------------------------------------
. Toggle a Row of Switches
.---------------------------------------------------------------------------
TOGFLD00  LOAD      F1,FIELDNO,CCEYBA1,CCEYBA2,CCEYBA3,CCEYBAO:
                               CCEYITH,CCEYIA1,CCEYIA2,CCEYIA3,CCEYIAO:
                               CCEYIM1,CCEYIM2,CCEYIM3,CCEYIMO:
                               CCEYETH1,CCEYEA11,CCEYEA21,CCEYEA31,CCEYEAO1:
                               CCEYEM11,CCEYEM21,CCEYEM31,CCEYEMO1:
                               CCEYETH2,CCEYEA12,CCEYEA22,CCEYEA32,CCEYEAO2:
                               CCEYEM12,CCEYEM22,CCEYEM32,CCEYEMO2:
                               CCEYETH3,CCEYEA13,CCEYEA23,CCEYEA33,CCEYEAO3:
                               CCEYEM13,CCEYEM23,CCEYEM33,CCEYEMO3:
                               CCEYETH4,CCEYEA14,CCEYEA24,CCEYEA34,CCEYEAO4:
                               CCEYEM14,CCEYEM24,CCEYEM34,CCEYEMO4:
                               CCEYETH5,CCEYEA15,CCEYEA25,CCEYEA35,CCEYEAO5:
                               CCEYEM15,CCEYEM25,CCEYEM35,CCEYEMO5
.
          IF        F1=0
            MOVE      ONE,F1
          ELSE
            MOVE      ZERO,F1
          ENDIF
.
          STORE     F1,FIELDNO,CCEYBA1,CCEYBA2,CCEYBA3,CCEYBAO:
                               CCEYITH,CCEYIA1,CCEYIA2,CCEYIA3,CCEYIAO:
                               CCEYIM1,CCEYIM2,CCEYIM3,CCEYIMO:
                               CCEYETH1,CCEYEA11,CCEYEA21,CCEYEA31,CCEYEAO1:
                               CCEYEM11,CCEYEM21,CCEYEM31,CCEYEMO1:
                               CCEYETH2,CCEYEA12,CCEYEA22,CCEYEA32,CCEYEAO2:
                               CCEYEM12,CCEYEM22,CCEYEM32,CCEYEMO2:
                               CCEYETH3,CCEYEA13,CCEYEA23,CCEYEA33,CCEYEAO3:
                               CCEYEM13,CCEYEM23,CCEYEM33,CCEYEMO3:
                               CCEYETH4,CCEYEA14,CCEYEA24,CCEYEA34,CCEYEAO4:
                               CCEYEM14,CCEYEM24,CCEYEM34,CCEYEMO4:
                               CCEYETH5,CCEYEA15,CCEYEA25,CCEYEA35,CCEYEAO5:
                               CCEYEM15,CCEYEM25,CCEYEM35,CCEYEMO5
          RETURN
.---------------------------------------------------------------------------
. Toggle a Row of Switches
.---------------------------------------------------------------------------
CLROW000  MOVE      SCSLSEL,F3
          IF        (F3<1)|(F3>9)
            GOTO      CLROW999
          ENDIF
.
          MOVE      ZERO,SECTOR
CLROW100  ADD       ONE,SECTOR
          ASSIGN    (SECTOR-1)*9+F3,NUMBER
          LOAD      F1,NUMBER,CCEYITH,CCEYIA1,CCEYIA2,CCEYIA3,CCEYIAO:
                              CCEYIM1,CCEYIM2,CCEYIM3,CCEYIMO:
                              CCEYETH1,CCEYEA11,CCEYEA21,CCEYEA31,CCEYEAO1:
                              CCEYEM11,CCEYEM21,CCEYEM31,CCEYEMO1:
                              CCEYETH2,CCEYEA12,CCEYEA22,CCEYEA32,CCEYEAO2:
                              CCEYEM12,CCEYEM22,CCEYEM32,CCEYEMO2:
                              CCEYETH3,CCEYEA13,CCEYEA23,CCEYEA33,CCEYEAO3:
                              CCEYEM13,CCEYEM23,CCEYEM33,CCEYEMO3:
                              CCEYETH4,CCEYEA14,CCEYEA24,CCEYEA34,CCEYEAO4:
                              CCEYEM14,CCEYEM24,CCEYEM34,CCEYEMO4:
                              CCEYETH5,CCEYEA15,CCEYEA25,CCEYEA35,CCEYEAO5:
                              CCEYEM15,CCEYEM25,CCEYEM35,CCEYEMO5
.
          IF        F1=0
            MOVE      ONE,F1
          ELSE
            MOVE      ZERO,F1
          ENDIF
.
          STORE     F1,NUMBER,CCEYITH,CCEYIA1,CCEYIA2,CCEYIA3,CCEYIAO:
                              CCEYIM1,CCEYIM2,CCEYIM3,CCEYIMO:
                              CCEYETH1,CCEYEA11,CCEYEA21,CCEYEA31,CCEYEAO1:
                              CCEYEM11,CCEYEM21,CCEYEM31,CCEYEMO1:
                              CCEYETH2,CCEYEA12,CCEYEA22,CCEYEA32,CCEYEAO2:
                              CCEYEM12,CCEYEM22,CCEYEM32,CCEYEMO2:
                              CCEYETH3,CCEYEA13,CCEYEA23,CCEYEA33,CCEYEAO3:
                              CCEYEM13,CCEYEM23,CCEYEM33,CCEYEMO3:
                              CCEYETH4,CCEYEA14,CCEYEA24,CCEYEA34,CCEYEAO4:
                              CCEYEM14,CCEYEM24,CCEYEM34,CCEYEMO4:
                              CCEYETH5,CCEYEA15,CCEYEA25,CCEYEA35,CCEYEAO5:
                              CCEYEM15,CCEYEM25,CCEYEM35,CCEYEMO5
          COMPARE   SIX,SECTOR
          GOTO      CLROW100 IF NOT EQUAL
.
CLROW999  RETURN
.---------------------------------------------------------------------------
. Toggle a Row of Switches
.---------------------------------------------------------------------------
CLCOL000  MOVE      SCSLSEL,KEY3
          SQUEEZE   KEY3
          REP       "A1B2C3D4E5F6",KEY3
          MOVE      KEY3,F1
          MOVE      F1,F3
          IF        (F3<1)|(F3>6)
            GOTO      CLCOL999
          ENDIF
.
          MOVE      ZERO,SECTOR
CLCOL100  ADD       ONE,SECTOR
          ASSIGN    (F3-1)*9+SECTOR,NUMBER
          LOAD      F1,NUMBER,CCEYITH,CCEYIA1,CCEYIA2,CCEYIA3,CCEYIAO:
                              CCEYIM1,CCEYIM2,CCEYIM3,CCEYIMO:
                              CCEYETH1,CCEYEA11,CCEYEA21,CCEYEA31,CCEYEAO1:
                              CCEYEM11,CCEYEM21,CCEYEM31,CCEYEMO1:
                              CCEYETH2,CCEYEA12,CCEYEA22,CCEYEA32,CCEYEAO2:
                              CCEYEM12,CCEYEM22,CCEYEM32,CCEYEMO2:
                              CCEYETH3,CCEYEA13,CCEYEA23,CCEYEA33,CCEYEAO3:
                              CCEYEM13,CCEYEM23,CCEYEM33,CCEYEMO3:
                              CCEYETH4,CCEYEA14,CCEYEA24,CCEYEA34,CCEYEAO4:
                              CCEYEM14,CCEYEM24,CCEYEM34,CCEYEMO4:
                              CCEYETH5,CCEYEA15,CCEYEA25,CCEYEA35,CCEYEAO5:
                              CCEYEM15,CCEYEM25,CCEYEM35,CCEYEMO5
.
          IF        F1=0
            MOVE      ONE,F1
          ELSE
            MOVE      ZERO,F1
          ENDIF
.
          STORE     F1,NUMBER,CCEYITH,CCEYIA1,CCEYIA2,CCEYIA3,CCEYIAO:
                              CCEYIM1,CCEYIM2,CCEYIM3,CCEYIMO:
                              CCEYETH1,CCEYEA11,CCEYEA21,CCEYEA31,CCEYEAO1:
                              CCEYEM11,CCEYEM21,CCEYEM31,CCEYEMO1:
                              CCEYETH2,CCEYEA12,CCEYEA22,CCEYEA32,CCEYEAO2:
                              CCEYEM12,CCEYEM22,CCEYEM32,CCEYEMO2:
                              CCEYETH3,CCEYEA13,CCEYEA23,CCEYEA33,CCEYEAO3:
                              CCEYEM13,CCEYEM23,CCEYEM33,CCEYEMO3:
                              CCEYETH4,CCEYEA14,CCEYEA24,CCEYEA34,CCEYEAO4:
                              CCEYEM14,CCEYEM24,CCEYEM34,CCEYEMO4:
                              CCEYETH5,CCEYEA15,CCEYEA25,CCEYEA35,CCEYEAO5:
                              CCEYEM15,CCEYEM25,CCEYEM35,CCEYEMO5
          COMPARE   NINE,SECTOR
          GOTO      CLCOL100 IF NOT EQUAL
.
CLCOL999  RETURN
POSY0000  MOVE      CCEAEID,CCEYEID
          MOVE      CCEYEID,KEY4
          CALL      RACCEY1
          IF        OVRCD=0
            CALL      UPCCEY1
          ELSE
            CALL      WRCCEY1
          ENDIF
          RETURN
.------------------------------------------------------------
. Delete Component Measure Specification
.------------------------------------------------------------
DELY0000  MOVE      CCEAEID,CCEYEID
          MOVE      CCEYEID,KEY4
          CALL      RACCEY1
          IF        OVRCD=0
            CALL      DECCEY1
          ENDIF
          RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CCSAGEIO/INC
          INC       CCSCEAIO/INC
          INC       CCSCEAKY    
          INC       CCSCEBIO/INC
          INC       CCSCECIO/INC
          INC       CCSCEDIO/INC
          INC       CCSCEEIO/INC
          INC       CCSCEFIO/INC
          INC       CCSCEGIO/INC
          INC       CCSCEXIO/INC
          INC       CCSCONIO/INC
          INC       CCSCOPCD    
          INC       CCSDRGIO/INC
          INC       CCSEPSIO/INC
          INC       CCSEYAIO/INC
          INC       CCSG58CD    
          INC       CCSHCDIO/INC
          INC       CCSIADIO/INC
          INC       CCSSTYIO/INC
          INC       CCSSTYKY    
          INC       CCSXHDIO/INC
          INC       CCSXHDKY    
          INC       CEAPMDIO/INC
          INC       CEAPPMIO/INC
          INC       CEAPPMKY    
          INC       PATITMIO/INC
.
          INC       STDGENCD
.
