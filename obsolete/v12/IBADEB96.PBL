.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
LASTDEP   DIM       8
LASTDES   DIM       35
LASTCAT   DIM       4
LASTUID   DIM       4
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBADEB96
.   Function      :   Table Listings                          
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       DEBADJFD/INC
          INC       DEBCODFD/INC
          INC       DEBDEPFD/INC
          INC       DEBPTYFD/INC
          INC       DEBSECFD/INC
          INC       DEBTERFD/INC
          INC       IBAPASFD/INC
.=========================
.Local Variable Definition
.-------------------------
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBADEB96"
PRGNAM    INIT      "Table Listings                          "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening debadjaf";
          OPEN      DEBADJA1,"debadjaf"
          MOVE      "   81",AUDTSECT
          MOVE      "  9",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudcd";
            OPEN      DEBAUDCD,"debaudcd"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 11",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudde";
            OPEN      DEBAUDDE,"debaudde"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 13",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudpt";
            OPEN      DEBAUDPT,"debaudpt"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 14",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudse";
            OPEN      DEBAUDSE,"debaudse"
          ENDIF
          MOVE      "   81",AUDTSECT
          MOVE      " 15",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening debaudte";
            OPEN      DEBAUDTE,"debaudte"
          ENDIF
          DISPLAY   *P56:24,"Opening debcodaf";
          OPEN      DEBCODA1,"debcodaf"
          DISPLAY   *P56:24,"Opening debcodaf";
          OPEN      DEBCODA2,"debcodaf"
          DISPLAY   *P56:24,"Opening debdepaf";
          OPEN      DEBDEPA1,"debdepaf"
          DISPLAY   *P56:24,"Opening debdepaf";
          OPEN      DEBDEPA2,"debdepaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA1,"debptyaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA2,"debptyaf"
          DISPLAY   *P56:24,"Opening debptyaf";
          OPEN      DEBPTYA3,"debptyaf"
          DISPLAY   *P56:24,"Opening debsecaf";
          OPEN      DEBSECA1,"debsecaf"
          DISPLAY   *P56:24,"Opening debsecaf";
          OPEN      DEBSECA2,"debsecaf"
          DISPLAY   *P56:24,"Opening debteraf";
          OPEN      DEBTERA1,"debteraf"
          DISPLAY   *P56:24,"Opening  ihapassf           ";
          OPEN      IHAPASS1,"ihapassf"          
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Table Listing Menu                 
          ENDIF
          RETURN
.--------------------------------
. Screen - Table Listing Menu                 
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Table Listing Menu                 
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Table Listing Menu                 
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Table Listing Menu                 
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Table Listing Menu                 
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Table Listing Menu                 
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Table Listing Menu                 
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Table Listing Menu                 
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L006,SF00L102:
                            SF00L103,SF00L104,SF00L105,SF00L106:
                            SF00L107,SF00L108
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      REPA0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      REPB0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      REPC0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          CALL      REPD0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L106
          CALL      REPE0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L107
          CALL      REPF0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L108
          CALL      REPG0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------
. Debtors Code Table Listing
.------------------------------------------------------------
REPA0000  MOVE      "Print Codes Table Listing. ",DISPMSG
          CALL      MESSAGE4
          BRANCH    EXIT,REPA9999
.
          DISPLAY   *P1:24,"Printing Page ...."
          CLOCK     TIME,CTIMEIS
          MOVE      ZERO,CPAGENO
          MOVE      "999",CLNO
          MOVE      SP70,LASTCAT
          PACK      KEY7,SP70
          CALL      RSDBCD1
REPA1000  CALL      RKDBCD1
          BRANCH    OVRCD,REPA9000
          MATCH     DBCDCAT,LASTCAT
          CALL      HEDA0000 IF NOT EQUAL
.
          COMPARE   "55",CLNO
          CALL      HEDA0000 IF NOT LESS
          MATCH     SP70,DBCDCOD
          GOTO      REPA1000 IF EQUAL
.
          MOVE      NO,YESNO
          LOAD      YESNO,DBCDACT,YES
          PRINT     "| ",DBCDCOD,"  | ",DBCDDES," |  ",YESNO,"   | ",*80,"|"
          ADD       "1",CLNO
          GOTO      REPA1000
.
REPA9000  CALL      UND80
          PRINT     *30,"***** End of Report *****"
REPA9999  RETURN

HEDA0000  CALL      HEAD80
          DISPLAY   *P30:24,CPAGENO
          MOVE      DBCDCAT,LASTCAT
          MOVE      DBCDDES,LASTDES
          PRINT     "Category : ",LASTCAT,SP1,LASTDES
          CALL      UND80
          PRINT     "| Code | Description                         | Active |":
                    *80,"|"
          CALL      UND80
          ADD       "4",CLNO
          RETURN
.
.------------------------------------------------------------
. Debtors Code Table Listing
.------------------------------------------------------------
REPB0000  MOVE      "Print Terms Table Listing. ",DISPMSG
          CALL      MESSAGE4
          BRANCH    EXIT,REPB9999
.
          DISPLAY   *P1:24,"Printing Page ...."
          CLOCK     TIME,CTIMEIS
          MOVE      ZERO,CPAGENO
          MOVE      "999",CLNO
          MOVE      SP70,LASTCAT
          PACK      KEY7,SP70
          CALL      RSDBTE1
REPB1000  CALL      RKDBTE1
          BRANCH    OVRCD,REPB9000
          COMPARE   "55",CLNO
          CALL      HEDB0000 IF NOT LESS
.
          MOVE      NO,YESNO
          LOAD      YESNO,DBTEACT,YES
          PRINT     "| ",DBTETER,"  | ",DBTEDES," |  ",YESNO,"   | ",*80,"|"
          ADD       "1",CLNO
          GOTO      REPB1000
.
REPB9000  CALL      UND80
          PRINT     *30,"***** End of Report *****"
REPB9999  RETURN

HEDB0000  CALL      HEAD80
          DISPLAY   *P30:24,CPAGENO
          PRINT     *30,"Terms Table Listing"
          CALL      UND80
          PRINT     "| Code | Description                         |":
                    " Active |":
                    *80,"|"
          CALL      UND80
          ADD       "4",CLNO
          RETURN
.
.------------------------------------------------------------
. Debtors Department Table Listing
.------------------------------------------------------------
REPC0000  MOVE      "Print Department Table Listing. ",DISPMSG
          CALL      MESSAGE4
          BRANCH    EXIT,REPC9999
.
          DISPLAY   *P1:24,"Printing Page ...."
          CLOCK     TIME,CTIMEIS
          MOVE      ZERO,CPAGENO
          MOVE      "999",CLNO
          MOVE      SP70,LASTCAT
          PACK      KEY7,SP70
          CALL      RSDBDE1
REPC1000  CALL      RKDBDE1
          BRANCH    OVRCD,REPC9000
          COMPARE   "55",CLNO
          CALL      HEDC0000 IF NOT LESS
.
          MOVE      NO,YESNO
          LOAD      YESNO,DBDEACT,YES
          PRINT     "| ",DBDEDEP," | ",DBDEDES," |  ",YESNO,"   | ",*80,"|"
          ADD       "1",CLNO
          GOTO      REPC1000
.
REPC9000  CALL      UND80
          PRINT     *30,"***** End of Report *****"
REPC9999  RETURN

HEDC0000  CALL      HEAD80
          DISPLAY   *P30:24,CPAGENO
          PRINT     *30,"Department Table Listing"
          CALL      UND80
          PRINT     "|   Code   | Description                         |":
                    " Active |":
                    *80,"|"
          CALL      UND80
          ADD       "4",CLNO
          RETURN
.
.------------------------------------------------------------
. Debtors Product Type Table Listing by Code
.------------------------------------------------------------
REPD0000  MOVE      "Print Product Type Table by Code. ",DISPMSG
          CALL      MESSAGE4
          BRANCH    EXIT,REPD9999
.
          DISPLAY   *P1:24,"Printing Page ...."
          CLOCK     TIME,CTIMEIS
          MOVE      ZERO,CPAGENO
          MOVE      "999",CLNO
          MOVE      SP70,LASTCAT
          PACK      KEY7,SP70
          CALL      RSDBPT1
REPD1000  CALL      RKDBPT1
          BRANCH    OVRCD,REPD9000
          COMPARE   "55",CLNO
          CALL      HEDD0000 IF NOT LESS
.
          MOVE      DBPTDEP,KEY8
          CALL      RDDBDE1
.
          MOVE      NO,YESNO
          LOAD      YESNO,DBPTACT,YES
          PRINT     "|   ",DBPTPTY,"   | ",DBPTDES," |  ",YESNO,"   | ":
                    DBPTDEP,SP1,DBDEDES," | ":
                    *132,"|"
          ADD       "1",CLNO
          GOTO      REPD1000
.
REPD9000  CALL      UND132
          PRINT     *30,"***** End of Report *****"
REPD9999  RETURN
.
HEDD0000  CALL      HEAD132
          DISPLAY   *P30:24,CPAGENO
          PRINT     *40,"Product Type Table Listing by Code"
          CALL      UND132
          PRINT     "| Product Type | Description                         |":
                    " Active | Dept.                                        |":
                    *132,"|"
          CALL      UND132
          ADD       "4",CLNO
          RETURN
.
.------------------------------------------------------------
. Debtors Product Types Table Listing by Department
.------------------------------------------------------------
REPE0000  MOVE      "Print Product Type Table by Department. ",DISPMSG
          CALL      MESSAGE4
          BRANCH    EXIT,REPE9999
.
          DISPLAY   *P1:24,"Printing Page ...."
          CLOCK     TIME,CTIMEIS
          MOVE      ZERO,CPAGENO
          MOVE      "999",CLNO
          MOVE      SP70,LASTDEP
          PACK      KEY16,SP70
          CALL      RSDBPT2
REPE1000  CALL      RKDBPT2
          BRANCH    OVRCD,REPE9000
          MATCH     DBPTDEP,LASTDEP
          CALL      HEDE0000 IF NOT EQUAL
.
          COMPARE   "55",CLNO
          CALL      HEDE0000 IF NOT LESS
.
          MOVE      NO,YESNO
          LOAD      YESNO,DBPTACT,YES
          PRINT     "|   ",DBPTPTY,"   | ",DBPTDES," |  ",YESNO,"   | ",*80,"|"
          ADD       "1",CLNO
          GOTO      REPE1000
.
REPE9000  CALL      UND80
          PRINT     *30,"***** End of Report *****"
REPE9999  RETURN
.
HEDE0000  CALL      HEAD80
          DISPLAY   *P30:24,CPAGENO
          MOVE      DBPTDEP,LASTDEP
          MOVE      LASTDEP,KEY8
          CALL      RDDBDE1
          PRINT     "Department : ",LASTDEP,SP1,DBDEDES
          CALL      UND80
          PRINT     "| Product Type | Description                         |":
                    " Active |":
                    *80,"|"
          CALL      UND80
          ADD       "4",CLNO
          RETURN
.
.------------------------------------------------------------
. Debtors Security Table Listing by Code
.------------------------------------------------------------
REPF0000  MOVE      "Print Security Table by Code. ",DISPMSG
          CALL      MESSAGE4
          BRANCH    EXIT,REPF9999
.
          DISPLAY   *P1:24,"Printing Page ...."
          CLOCK     TIME,CTIMEIS
          MOVE      ZERO,CPAGENO
          MOVE      "999",CLNO
          MOVE      SP70,LASTUID
          PACK      KEY12,SP70
          CALL      RSDBSE1
REPF1000  CALL      RKDBSE1
          BRANCH    OVRCD,REPF9000
          COMPARE   "55",CLNO
          CALL      HEDF0000 IF NOT LESS
.
          MOVE      DBSEDEP,KEY8
          CALL      RDDBDE1
.
          MOVE      DBSEUSR,KEY4
          CALL      RDPASS1
.
          MATCH     LASTUID,DBSEUSR
          IF        @EQUAL
            PRINT     "|  ",SP4,"   | ",SP20,SP10,SP5," |  ":
                      DBSEDEP,"  | ",DBDEDES," | ":
                      *132,"|"
          ELSE
            MOVE      DBSEUSR,LASTUID
            CALL      UND132
            PRINT     "|  ",DBSEUSR,"   | ",SECUSER," |  ":
                      DBSEDEP,"  | ",DBDEDES," | ":
                      *132,"|"
          ENDIF
          ADD       "1",CLNO
          GOTO      REPF1000
.
REPF9000  CALL      UND132
          PRINT     *30,"***** End of Report *****"
REPF9999  RETURN
.
HEDF0000  CALL      HEAD132
          DISPLAY   *P30:24,CPAGENO
          PRINT     *40,"Security Table Listing by Code"
          CALL      UND132
          PRINT     "| User ID | Name                                |":
                    " Department | Description                         |":
                    *132,"|"
          ADD       "4",CLNO
          RETURN
.
.------------------------------------------------------------
. Debtors Security Table Listing by Department
.------------------------------------------------------------
REPG0000  MOVE      "Print Security Table by Department. ",DISPMSG
          CALL      MESSAGE4
          BRANCH    EXIT,REPG9999
.
          DISPLAY   *P1:24,"Printing Page ...."
          CLOCK     TIME,CTIMEIS
          MOVE      ZERO,CPAGENO
          MOVE      "999",CLNO
          MOVE      SP70,LASTDEP
          PACK      KEY12,SP70
          CALL      RSDBSE2
REPG1000  CALL      RKDBSE2
          BRANCH    OVRCD,REPG9000
          COMPARE   "55",CLNO
          CALL      HEDG0000 IF NOT LESS
.
          MOVE      DBSEDEP,KEY8
          CALL      RDDBDE1
.
          MOVE      DBSEUSR,KEY4
          CALL      RDPASS1
.
          MATCH     LASTDEP,DBSEDEP
          IF        @EQUAL
            PRINT     "|  ",SP8,"   | ",SP20,SP10,SP5," |  ":
                      DBSEUSR,"   | ",SECUSER," | ":
                      *132,"|"
          ELSE
            MOVE      DBSEDEP,LASTDEP
            CALL      UND132
            PRINT     "|  ",DBSEDEP,"   | ",DBDEDES," |  ":
                      DBSEUSR,"   | ",SECUSER," |  ":
                      *132,"|"
          ENDIF
          ADD       "1",CLNO
          GOTO      REPG1000
.
REPG9000  CALL      UND132
          PRINT     *30,"***** End of Report *****"
REPG9999  RETURN
.
HEDG0000  CALL      HEAD132
          DISPLAY   *P30:24,CPAGENO
          PRINT     *40,"Security Table Listing by Department"
          CALL      UND132
          PRINT     "| Department | Description                         |":
                    " User ID | Name                                |":
                    *132,"|"
          ADD       "4",CLNO
          RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       DEBADJIO/INC
          INC       DEBCODIO/INC
          INC       DEBDEPIO/INC
          INC       DEBPTYIO/INC
          INC       DEBSECIO/INC
          INC       DEBTERIO/INC
          INC       IBAPASIO/INC
.
          INC       STDGENCD
.
