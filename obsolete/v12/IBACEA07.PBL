.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  03.06.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. V6.06.01  15.12.1999 Charles Handaya
.           Fixed DRG Codes
.-------------------------------------------------------
. V6.03.00  02.10.1995 B.G.Ackland
.           Release 6.03
.-------------------------------------------------------
F12P2     FORM      12.2
LOADFILE  FILE      ASCII, FIXED=200
PF801     DIM       8   * Print Field
PF802     DIM       8   * Print Field
PF803     DIM       8   * Print Field
PF804     DIM       8   * Print Field
PF805     DIM       8   * Print Field
PF806     DIM       8   * Print Field
PF807     DIM       8   * Print Field
PF808     DIM       8   * Print Field
PF809     DIM       8   * Print Field
PF810     DIM       8   * Print Field
PF811     DIM       8   * Print Field
PF10      DIM       10  * Print Field
PF1201    DIM       12  * Print Field
PF1202    DIM       12  * Print Field
PF1203    DIM       12  * Print Field
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACEA07
.   Function      :   Payment Model Maintenance               
.   Generated  On :   03/06/2002
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CCSDRGFD/INC
          INC       CEAPCDFD/INC
          INC       CEAPMDFD/INC
          INC       CEAPPMFD/INC
.=========================
.Local Variable Definition
.-------------------------
LOADNAME  DIM      30 * Scr 06 Fld     4
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACEA07"
PRGNAM    INIT      "Payment Model Maintenance               "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening ccsdrgaf";
          OPEN      CCSDRGA1,"ccsdrgaf"
          DISPLAY   *P56:24,"Opening ceapcdaf";
          OPEN      CEAPCDA1,"ceapcdaf"
          DISPLAY   *P56:24,"Opening ceapmdaf";
          OPEN      CEAPMDA1,"ceapmdaf"
          DISPLAY   *P56:24,"Opening ceappmaf";
          OPEN      CEAPPMA1,"ceappmaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Options                            
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Theatre Fee Maintenance            
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Per Day/Per Deim Split             
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * DRG Fee Maintenance                
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * DRG Cost Base Maintenance          
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * Build Fees                         
          ENDIF
          MATCH     "06",SCRID
          IF         @EQUAL
            CALL       PS06L000   * Load DRG Fees Table                
          ENDIF
          MATCH     "MA",SCRID
          IF         @EQUAL
            CALL       PSMAL000   * Model Master Screen                
          ENDIF
          RETURN
.--------------------------------
. Screen - Options                            
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Options                            
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Options                            
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Options                            
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Options                            
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Options                            
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Options                            
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Options                            
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105,SF00L106,SF00L107:
                            SF00L108,SF00L109
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC05L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L106
          CALL      SC04L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L107
          CALL      COSREP00
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L108
          CALL      SC06L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L109
          CALL      SCMAL000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Theatre Fee Maintenance            
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Theatre Fee Maintenance            
.-------------------------------------------------------
CF01L000
          MOVE      SP70,CEPPIND 
          MOVE      SP70,CEPPDES 
          MOVE      ZERO,CEPPICU 
          MOVE      ZERO,CEPPB01 
          MOVE      ZERO,CEPPB02 
          MOVE      ZERO,CEPPB03 
          MOVE      ZERO,CEPPB04 
          MOVE      ZERO,CEPPB05 
          MOVE      ZERO,CEPPB06 
          MOVE      ZERO,CEPPB07 
          MOVE      ZERO,CEPPB08 
          MOVE      ZERO,CEPPB09 
          MOVE      ZERO,CEPPB10 
          MOVE      ZERO,CEPPB11 
          MOVE      ZERO,CEPPB12 
          MOVE      ZERO,CEPPB13 
          MOVE      ZERO,CEPPB14 
          MOVE      ZERO,CEPPB15 
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Theatre Fee Maintenance            
.--------------------------------------------------------
KY01L000
.
KY01L110
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CEPPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCEPPA00
          BRANCH    EXIT,KY01L900,KY01L900
          MOVE      ZERO,ACCEPT
          MOVE      CEPPIND,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CEPPDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Theatre Fee Maintenance            
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Theatre Fee Maintenance            
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Theatre Fee Maintenance            
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Theatre Fee Maintenance            
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L101,PS01L102,PS01L103,PS01L104:
                            PS01L105,PS01L106,PS01L107,PS01L108:
                            PS01L109,PS01L110,PS01L111,PS01L112:
                            PS01L113,PS01L114,PS01L115,PS01L116:
                            PS01L117
          GOTO     PS01L999
.
PS01L101
          MOVE      CEPPDES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      CEPPICU,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      CEPPB01,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      CEPPB02,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      CEPPB03,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      CEPPB04,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      CEPPB05,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      CEPPB06,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      CEPPB07,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      CEPPB08,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      CEPPB09,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          MOVE      CEPPB10,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          MOVE      CEPPB11,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          MOVE      CEPPB12,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          MOVE      CEPPB13,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L116
          MOVE      CEPPB14,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L117
          MOVE      CEPPB15,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Theatre Fee Maintenance            
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L006:
                            SF01L006,SF01L103,SF01L104,SF01L105:
                            SF01L106,SF01L107,SF01L108,SF01L109:
                            SF01L110,SF01L111,SF01L112,SF01L113:
                            SF01L114,SF01L115,SF01L116,SF01L117:
                            SF01L118
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L103,SF01L104,SF01L105:
                            SF01L106,SF01L107,SF01L108,SF01L109:
                            SF01L110,SF01L111,SF01L112,SF01L113:
                            SF01L114,SF01L115,SF01L116,SF01L117:
                            SF01L118
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      POST0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L103
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPICU 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPICU 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L103
            ENDIF
          ENDIF
          MOVE      CEPPICU,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L104
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPB01 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPB01 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L104
            ENDIF
          ENDIF
          MOVE      CEPPB01,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L105
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPB02 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPB02 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L105
            ENDIF
          ENDIF
          MOVE      CEPPB02,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L106
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPB03 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPB03 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L106
            ENDIF
          ENDIF
          MOVE      CEPPB03,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L107
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPB04 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPB04 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L107
            ENDIF
          ENDIF
          MOVE      CEPPB04,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L108
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPB05 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPB05 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L108
            ENDIF
          ENDIF
          MOVE      CEPPB05,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L109
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPB06 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPB06 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L109
            ENDIF
          ENDIF
          MOVE      CEPPB06,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L110
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPB07 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPB07 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L110
            ENDIF
          ENDIF
          MOVE      CEPPB07,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L111
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPB08 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPB08 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L111
            ENDIF
          ENDIF
          MOVE      CEPPB08,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L112
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPB09 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPB09 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L112
            ENDIF
          ENDIF
          MOVE      CEPPB09,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L113
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPB10 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPB10 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L113
            ENDIF
          ENDIF
          MOVE      CEPPB10,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L114
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPB11 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPB11 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L114
            ENDIF
          ENDIF
          MOVE      CEPPB11,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L115
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPB12 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPB12 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L115
            ENDIF
          ENDIF
          MOVE      CEPPB12,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L116
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPB13 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPB13 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L116
            ENDIF
          ENDIF
          MOVE      CEPPB13,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L117
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPB14 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPB14 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L117
            ENDIF
          ENDIF
          MOVE      CEPPB14,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L118
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPB15 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPB15 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L118
            ENDIF
          ENDIF
          MOVE      CEPPB15,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Per Day/Per Deim Split             
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Per Day/Per Deim Split             
.-------------------------------------------------------
CF02L000
          MOVE      SP70,CEPPIND 
          MOVE      ZERO,CEPPNURF
          MOVE      ZERO,CEPPTHEF
          MOVE      ZERO,CEPPPHAF
          MOVE      ZERO,CEPPICUF
          MOVE      ZERO,CEPPALLF
          MOVE      ZERO,CEPPMSSF
          MOVE      ZERO,CEPPTAXF
          MOVE      ZERO,CEPPOVHF
          MOVE      ZERO,CEPPCATF
          MOVE      ZERO,CEPPDEPF
          MOVE      ZERO,CEPPOTHF
          MOVE      ZERO,CEPPNURV
          MOVE      ZERO,CEPPTHEV
          MOVE      ZERO,CEPPPHAV
          MOVE      ZERO,CEPPICUV
          MOVE      ZERO,CEPPALLV
          MOVE      ZERO,CEPPMSSV
          MOVE      ZERO,CEPPTAXV
          MOVE      ZERO,CEPPOVHV
          MOVE      ZERO,CEPPCATV
          MOVE      ZERO,CEPPDEPV
          MOVE      ZERO,CEPPOTHV
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Per Day/Per Deim Split             
.--------------------------------------------------------
KY02L000
.
KY02L110
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CEPPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCEPPA00
          BRANCH    EXIT,KY02L900,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      CEPPIND,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CEPPDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Per Day/Per Deim Split             
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Per Day/Per Deim Split             
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Per Day/Per Deim Split             
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Per Day/Per Deim Split             
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L101,PS02L102,PS02L103,PS02L104:
                            PS02L105,PS02L106,PS02L107,PS02L108:
                            PS02L109,PS02L110,PS02L111,PS02L112:
                            PS02L113,PS02L114,PS02L115,PS02L116:
                            PS02L117,PS02L118,PS02L119,PS02L120:
                            PS02L121,PS02L122,PS02L123
          GOTO     PS02L999
.
PS02L101
          MOVE      CEPPDES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      CEPPNURF,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      CEPPTHEF,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      CEPPPHAF,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      CEPPICUF,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      CEPPALLF,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      CEPPMSSF,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      CEPPTAXF,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          MOVE      CEPPOVHF,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          MOVE      CEPPCATF,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          MOVE      CEPPDEPF,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L112
          MOVE      CEPPOTHF,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L113
          MOVE      CEPPNURV,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L114
          MOVE      CEPPTHEV,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L115
          MOVE      CEPPPHAV,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L116
          MOVE      CEPPICUV,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L117
          MOVE      CEPPALLV,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L118
          MOVE      CEPPMSSV,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L119
          MOVE      CEPPTAXV,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L120
          MOVE      CEPPOVHV,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L121
          MOVE      CEPPCATV,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L122
          MOVE      CEPPDEPV,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L123
          MOVE      CEPPOTHV,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Per Day/Per Deim Split             
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102,SF02L006:
                            SF02L006,SF02L103,SF02L104,SF02L105:
                            SF02L106,SF02L107,SF02L108,SF02L109:
                            SF02L110,SF02L111,SF02L112,SF02L113:
                            SF02L114,SF02L115,SF02L116,SF02L117:
                            SF02L118,SF02L119,SF02L120,SF02L121:
                            SF02L122,SF02L123,SF02L124
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L103,SF02L104,SF02L105:
                            SF02L106,SF02L107,SF02L108,SF02L109:
                            SF02L110,SF02L111,SF02L112,SF02L113:
                            SF02L114,SF02L115,SF02L116,SF02L117:
                            SF02L118,SF02L119,SF02L120,SF02L121:
                            SF02L122,SF02L123,SF02L124
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L102
          CALL      POST0000
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L103
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPNURF
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPNURF
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L103
            ENDIF
          ENDIF
          MOVE      CEPPNURF,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L104
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPTHEF
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPTHEF
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L104
            ENDIF
          ENDIF
          MOVE      CEPPTHEF,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L105
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPPHAF
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPPHAF
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L105
            ENDIF
          ENDIF
          MOVE      CEPPPHAF,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L106
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPICUF
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPICUF
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L106
            ENDIF
          ENDIF
          MOVE      CEPPICUF,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L107
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPALLF
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPALLF
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L107
            ENDIF
          ENDIF
          MOVE      CEPPALLF,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L108
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPMSSF
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPMSSF
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L108
            ENDIF
          ENDIF
          MOVE      CEPPMSSF,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L109
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPTAXF
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPTAXF
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L109
            ENDIF
          ENDIF
          MOVE      CEPPTAXF,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L110
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPOVHF
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPOVHF
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L110
            ENDIF
          ENDIF
          MOVE      CEPPOVHF,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L111
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPCATF
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPCATF
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L111
            ENDIF
          ENDIF
          MOVE      CEPPCATF,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L112
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPDEPF
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPDEPF
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L112
            ENDIF
          ENDIF
          MOVE      CEPPDEPF,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L113
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPOTHF
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPOTHF
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L113
            ENDIF
          ENDIF
          MOVE      CEPPOTHF,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L114
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPNURV
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPNURV
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L114
            ENDIF
          ENDIF
          MOVE      CEPPNURV,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L115
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPTHEV
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPTHEV
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L115
            ENDIF
          ENDIF
          MOVE      CEPPTHEV,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L116
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPPHAV
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPPHAV
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L116
            ENDIF
          ENDIF
          MOVE      CEPPPHAV,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L117
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPICUV
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPICUV
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L117
            ENDIF
          ENDIF
          MOVE      CEPPICUV,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L118
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPALLV
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPALLV
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L118
            ENDIF
          ENDIF
          MOVE      CEPPALLV,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L119
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPMSSV
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPMSSV
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L119
            ENDIF
          ENDIF
          MOVE      CEPPMSSV,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L120
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPTAXV
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPTAXV
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L120
            ENDIF
          ENDIF
          MOVE      CEPPTAXV,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L121
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPOVHV
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPOVHV
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L121
            ENDIF
          ENDIF
          MOVE      CEPPOVHV,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L122
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPCATV
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPCATV
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L122
            ENDIF
          ENDIF
          MOVE      CEPPCATV,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L123
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPDEPV
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPDEPV
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L123
            ENDIF
          ENDIF
          MOVE      CEPPDEPV,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L124
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPOTHV
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPOTHV
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L124
            ENDIF
          ENDIF
          MOVE      CEPPOTHV,VAR     
          CALL      DISPITEM
          GOTO     SF02L001
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - DRG Fee Maintenance                
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : DRG Fee Maintenance                
.-------------------------------------------------------
CF03L000
          MOVE      SP70,CEPMMOD 
          MOVE      SP70,CEPMDRGC
          MOVE      ZERO,CEPMPCAS
          MOVE      ZERO,CEPMPDAY
          MOVE      SP70,CEPPDES 
          MOVE      SP70,CCDGDES 
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for DRG Fee Maintenance                
.--------------------------------------------------------
KY03L000
.
KY03L110
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CEPPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCEPPA00
          MOVE      CEPPIND,CEPMMOD
          BRANCH    EXIT,KY03L900,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      CEPMMOD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CEPPDES,VAR      
            CALL      DISPITEM
          ENDIF
.
KY03L120
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCDGDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EDRG0000
          BRANCH    EXIT,KY03L110,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      CEPMDRGC,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCDGDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : DRG Fee Maintenance                
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : DRG Fee Maintenance                
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : DRG Fee Maintenance                
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : DRG Fee Maintenance                
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L101,PS03L102,PS03L103:
                            PS03L104
          GOTO     PS03L999
.
PS03L101
          MOVE      CEPMPCAS,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      CEPMPDAY,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      CEPPDES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      CCDGDES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : DRG Fee Maintenance                
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L006:
                            SF03L006,SF03L103,SF03L104,SF03L006:
                            SF03L006
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L103,SF03L104,SF03L020:
                            SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L102
          CALL      POSA0000
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L103
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPMPCAS
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPMPCAS
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L103
            ENDIF
          ENDIF
          MOVE      CEPMPCAS,VAR     
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L104
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPMPDAY
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPMPDAY
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L104
            ENDIF
          ENDIF
          MOVE      CEPMPDAY,VAR     
          CALL      DISPITEM
          GOTO     SF03L001
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - DRG Cost Base Maintenance          
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : DRG Cost Base Maintenance          
.-------------------------------------------------------
CF04L000
          MOVE      SP70,CEPCDRGC
          MOVE      ZERO,CEPCNUR 
          MOVE      ZERO,CEPCTHE 
          MOVE      ZERO,CEPCPHA 
          MOVE      ZERO,CEPCICU 
          MOVE      ZERO,CEPCALL 
          MOVE      ZERO,CEPCMSS 
          MOVE      ZERO,CEPCTAX 
          MOVE      ZERO,CEPCOVH 
          MOVE      ZERO,CEPCCAT 
          MOVE      ZERO,CEPCDEP 
          MOVE      ZERO,CEPCOTH 
          MOVE      ZERO,CEPCALOS
          MOVE      ZERO,CEPCNWG 
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for DRG Cost Base Maintenance          
.--------------------------------------------------------
KY04L000
.
KY04L110
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCDGDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EDRGB000
          BRANCH    EXIT,KY04L900,KY04L900
          MOVE      ZERO,ACCEPT
          MOVE      CEPCDRGC,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCDGDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : DRG Cost Base Maintenance          
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : DRG Cost Base Maintenance          
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : DRG Cost Base Maintenance          
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : DRG Cost Base Maintenance          
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L101,PS04L102,PS04L103,PS04L104:
                            PS04L105,PS04L106,PS04L107,PS04L108:
                            PS04L109,PS04L110,PS04L111,PS04L112:
                            PS04L113,PS04L114
          GOTO     PS04L999
.
PS04L101
          MOVE      CEPCNUR,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      CEPCTHE,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      CEPCPHA,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L104
          MOVE      CEPCICU,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L105
          MOVE      CEPCALL,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L106
          MOVE      CEPCMSS,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L107
          MOVE      CEPCTAX,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L108
          MOVE      CEPCOVH,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L109
          MOVE      CEPCCAT,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L110
          MOVE      CEPCDEP,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L111
          MOVE      CEPCOTH,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L112
          MOVE      CCDGDES,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L113
          MOVE      CEPCALOS,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L114
          MOVE      CEPCNWG,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : DRG Cost Base Maintenance          
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L102,SF04L006:
                            SF04L103,SF04L104,SF04L105,SF04L106:
                            SF04L107,SF04L108,SF04L109,SF04L110:
                            SF04L111,SF04L112,SF04L113,SF04L006:
                            SF04L114,SF04L115
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L103,SF04L104,SF04L105,SF04L106:
                            SF04L107,SF04L108,SF04L109,SF04L110:
                            SF04L111,SF04L112,SF04L113,SF04L020:
                            SF04L114,SF04L115
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
          MOVE      ONE,EXIT
          GOTO      SF04L999
.
SF04L102
          CALL      POSB0000
          MOVE      ONE,EXIT
          GOTO      SF04L999
.
SF04L103
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPCNUR 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPCNUR 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L103
            ENDIF
          ENDIF
          MOVE      CEPCNUR,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L104
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPCTHE 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPCTHE 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L104
            ENDIF
          ENDIF
          MOVE      CEPCTHE,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L105
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPCPHA 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPCPHA 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L105
            ENDIF
          ENDIF
          MOVE      CEPCPHA,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L106
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPCICU 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPCICU 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L106
            ENDIF
          ENDIF
          MOVE      CEPCICU,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L107
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPCALL 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPCALL 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L107
            ENDIF
          ENDIF
          MOVE      CEPCALL,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L108
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPCMSS 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPCMSS 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L108
            ENDIF
          ENDIF
          MOVE      CEPCMSS,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L109
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPCTAX 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPCTAX 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L109
            ENDIF
          ENDIF
          MOVE      CEPCTAX,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L110
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPCOVH 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPCOVH 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L110
            ENDIF
          ENDIF
          MOVE      CEPCOVH,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L111
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPCCAT 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPCCAT 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L111
            ENDIF
          ENDIF
          MOVE      CEPCCAT,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L112
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPCDEP 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPCDEP 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L112
            ENDIF
          ENDIF
          MOVE      CEPCDEP,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L113
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPCOTH 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPCOTH 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L113
            ENDIF
          ENDIF
          MOVE      CEPCOTH,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L114
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPCALOS
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPCALOS
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L114
            ENDIF
          ENDIF
          MOVE      CEPCALOS,VAR     
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L115
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPCNWG 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPCNWG 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L115
            ENDIF
          ENDIF
          MOVE      CEPCNWG,VAR      
          CALL      DISPITEM
          GOTO     SF04L001
SF04L990  MOVE      ONE,EXIT * Exit Char Restart
SF04L999  RETURN
.--------------------------------
. Screen - Build Fees                         
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC05L200
          CALL      CF05L000 * Clear Fields
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Build Fees                         
.-------------------------------------------------------
CF05L000
          MOVE      SP70,CEPPIND 
          MOVE      SP70,CEPPDES 
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Build Fees                         
.--------------------------------------------------------
KY05L000
.
KY05L110
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CEPPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCEPPA00
          BRANCH    EXIT,KY05L900,KY05L900
          MOVE      ZERO,ACCEPT
          MOVE      CEPPIND,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CEPPDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : Build Fees                         
.---------------------------------------------------------
WP05L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Build Fees                         
.---------------------------------------------------------
LM05L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Build Fees                         
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Build Fees                         
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L999,PS05L999,PS05L999,PS05L999:
                            PS05L101,PS05L999
          GOTO     PS05L999
.
PS05L101
          MOVE      CEPPDES,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : Build Fees                         
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L006,SF05L101,SF05L102,SF05L006:
                            SF05L006,SF05L103
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          GOTO     SF05L001
.
SF05L101
          MOVE      ONE,EXIT
          GOTO      SF05L999
.
SF05L102
          CALL      BDRG0000
          MOVE      ONE,EXIT
          GOTO      SF05L999
.
SF05L103
          CALL      FEEREP00
          MOVE      ZERO,EXIT
          GOTO      SF05L999
SF05L990  MOVE      ONE,EXIT * Exit Char Restart
SF05L999  RETURN
.--------------------------------
. Screen - Load DRG Fees Table                
.--------------------------------
SC06L000
SC06L100
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC06L200
          CALL      CF06L000 * Clear Fields
          CALL      MVACCEPT
SC06L300
          CALL      KY06L000 * Enter Key Fields
          BRANCH    EXIT,SC06L999,SC06L999
SC06L400
          CALL      WP06L000 * Load any WP Details
SC06L500
          CALL      LM06L000 * Load any Batch Details
SC06L600
          CALL      DF06L000 * Display Fields
SC06L700
          CALL      SF06L000 * Select Fields
          BRANCH    EXIT,SC06L100,SC06L100,SC06L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC06L800
SC06L900
SC06L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Load DRG Fees Table                
.-------------------------------------------------------
CF06L000
          MOVE      SP70,LOADNAME
CF06L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Load DRG Fees Table                
.--------------------------------------------------------
KY06L000
          MOVE      ZERO,EXIT
          GOTO      KY06L999
.
KY06L900  MOVE      ONE,EXIT
KY06L999  RETURN
.---------------------------------------------------------
. Load WP files for : Load DRG Fees Table                
.---------------------------------------------------------
WP06L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Load DRG Fees Table                
.---------------------------------------------------------
LM06L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Load DRG Fees Table                
.---------------------------------------------------------
DF06L000
          BRANCH   ACCEPT,DF06L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF06L900
          MATCH    PRGID,SCPSPID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF06L010 IF NOT EQUAL
.
          CALL     PS06L000 * Display Field
          GOTO     DF06L010
DF06L900
DF06L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Load DRG Fees Table                
.---------------------------------------------------------
PS06L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS06L999,PS06L999,PS06L999,PS06L101
          GOTO     PS06L999
.
PS06L101
          MOVE      LOADNAME,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
PS06L999
          RETURN
.---------------------------------------------------------
. Selections for : Load DRG Fees Table                
.---------------------------------------------------------
SF06L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF06L001  BRANCH   ACCEPT,SF06L020
.
SF06L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L006,SF06L101,SF06L102,SF06L103
SF06L006  BEEP
          GOTO     SF06L005
SF06L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF06L090
          MATCH    PRGID,SCSLPID
          GOTO     SF06L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF06L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L020,SF06L020,SF06L020,SF06L103
          GOTO     SF06L020
SF06L090  MOVE     ZERO,ACCEPT
          GOTO     SF06L001
.
SF06L101
          MOVE      ZERO,EXIT
          GOTO      SF06L999
.
SF06L102
          CALL      LOAD0000
          MOVE      ZERO,EXIT
          GOTO      SF06L999
.
SF06L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KFILE000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF06L103
            ENDIF
            BRANCH    EXIT,SF06L103,SF06L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF06L990 IF EQUAL
          ENDIF
          MOVE      LOADNAME,VAR     
          CALL      DISPITEM
          GOTO     SF06L001
SF06L990  MOVE      FOUR,EXIT * Exit Char Exit
SF06L999  RETURN
.--------------------------------
. Screen - Model Master Screen                
.--------------------------------
SCMAL000
SCMAL100
          MOVE      "MA",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCMAL200
          CALL      CFMAL000 * Clear Fields
SCMAL300
          CALL      KYMAL000 * Enter Key Fields
          BRANCH    EXIT,SCMAL999,SCMAL999
SCMAL400
          CALL      WPMAL000 * Load any WP Details
SCMAL500
          CALL      LMMAL000 * Load any Batch Details
SCMAL600
          CALL      DFMAL000 * Display Fields
SCMAL700
          CALL      SFMAL000 * Select Fields
          BRANCH    EXIT,SCMAL100,SCMAL100,SCMAL200
SCMAL800
SCMAL900
SCMAL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Model Master Screen                
.-------------------------------------------------------
CFMAL000
          MOVE      SP70,CEPPIND 
          MOVE      SP70,CEPPDES 
          MOVE      ZERO,CEPPPRO 
          MOVE      ZERO,CEPPINCI
          MOVE      ZERO,CEPPUTH 
CFMAL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Model Master Screen                
.--------------------------------------------------------
KYMAL000
.
KYMAL110
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      KCEPPA00
          BRANCH    EXIT,KYMAL900,KYMAL900
          MOVE      OVRCD,ACCEPT
          MOVE      CEPPIND,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KYMAL999
.
KYMAL900  MOVE      ONE,EXIT
KYMAL999  RETURN
.---------------------------------------------------------
. Load WP files for : Model Master Screen                
.---------------------------------------------------------
WPMAL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Model Master Screen                
.---------------------------------------------------------
LMMAL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Model Master Screen                
.---------------------------------------------------------
DFMAL000
          BRANCH   ACCEPT,DFMAL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFMAL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFMAL900
          MATCH    PRGID,SCPSPID
          GOTO     DFMAL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFMAL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFMAL010 IF NOT EQUAL
.
          CALL     PSMAL000 * Display Field
          GOTO     DFMAL010
DFMAL900
DFMAL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Model Master Screen                
.---------------------------------------------------------
PSMAL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSMAL999,PSMAL999,PSMAL999,PSMAL999:
                            PSMAL999,PSMAL101,PSMAL102,PSMAL103:
                            PSMAL104
          GOTO     PSMAL999
.
PSMAL101
          MOVE      CEPPDES,VAR      
          CALL      DISPITEM
          GOTO     PSMAL999
.
PSMAL102
          MOVE      CEPPPRO,VAR      
          CALL      DISPITEM
          GOTO     PSMAL999
.
PSMAL103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CEPPINCI,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSMAL999
.
PSMAL104
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CEPPUTH,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSMAL999
PSMAL999
          RETURN
.---------------------------------------------------------
. Selections for : Model Master Screen                
.---------------------------------------------------------
SFMAL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFMAL001  BRANCH   ACCEPT,SFMAL020
.
SFMAL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFMAL006,SFMAL101,SFMAL102,SFMAL103:
                            SFMAL006,SFMAL104,SFMAL105,SFMAL106:
                            SFMAL107
SFMAL006  BEEP
          GOTO     SFMAL005
SFMAL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFMAL090
          MATCH    PRGID,SCSLPID
          GOTO     SFMAL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFMAL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFMAL020,SFMAL020,SFMAL020,SFMAL020:
                            SFMAL020,SFMAL104,SFMAL105,SFMAL106:
                            SFMAL107
          GOTO     SFMAL020
SFMAL090  MOVE     ZERO,ACCEPT
          GOTO     SFMAL001
.
SFMAL101
          MOVE      ONE,EXIT
          GOTO      SFMAL999
.
SFMAL102
          CALL      POST0000
          MOVE      ONE,EXIT
          GOTO      SFMAL999
.
SFMAL103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SFMAL999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SFMAL001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SFMAL999
          ENDIF
          MOVE      "MA",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DFMAL000
          ENDIF
          GOTO      SFMAL001
.
SFMAL104
          CALL     SELECTED
          STRIP     CEPPDES 
          SFORMAT   VAR,SCPSLEN
          MOVE      CEPPDES,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,CEPPDES 
          SFORMAT   VAR,127
          ENDSET    CEPPDES 
          APPEND    SP70,CEPPDES 
          RESET     CEPPDES 
          CMATCH    EXITCHAR,CEPPDES 
          GOTO      SFMAL990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,CEPPDES 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFMAL104
            ENDIF
          ENDIF
          MOVE      CEPPDES,VAR      
          CALL      DISPITEM
          GOTO     SFMAL001
.
SFMAL105
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEPPPRO 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEPPPRO 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFMAL105
            ENDIF
          ENDIF
          MOVE      CEPPPRO,VAR      
          CALL      DISPITEM
          GOTO     SFMAL001
.
SFMAL106
          CALL      DEFAULTY
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CEPPINCI
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CEPPINCI,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFMAL001
.
SFMAL107
          CALL      DEFAULTY
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,CEPPUTH 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CEPPUTH,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFMAL001
SFMAL990  MOVE      ONE,EXIT * Exit Char Restart
SFMAL999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------
. DRG Cost Report
.------------------------------------------------------------
COSREP00  MOVE      "99",CLNO
          DISPLAY   *P1:24,*EL,"Printing Report :"
          CLOCK     TIME,CTIMEIS
          MOVE      ZERO,CPAGENO
          PACK      KEY3,SP70
          CALL      RSCEPC1
COSREP10  CALL      RKCEPC1
          BRANCH    OVRCD,COSREP90
          MOVE      CEPCDRGC,KEY4
          CALL      RDCCDG1
          IF        OVRCD=1
            MOVE      "Invalid",CCDGDES
          ENDIF
          COMPARE   "55",CLNO
          CALL      COSHED00 IF NOT LESS
          ADD       "2",CLNO
          MOVE      "9999,999",PF801
          MOVE      "9999,999",PF802
          MOVE      "9999,999",PF803
          MOVE      "9999,999",PF804
          MOVE      "9999,999",PF805
          MOVE      "9999,999",PF806
          MOVE      "9999,999",PF807
          MOVE      "9999,999",PF808
          MOVE      "9999,999",PF809
          MOVE      "9999,999",PF810
          MOVE      "9999,999",PF811
          MOVE      "9,999,999",PF10
          MOVE      CEPCNUR,F10
          FEDIT     F10,PF801
          MOVE      CEPCTHE,F10
          FEDIT     F10,PF802
          MOVE      CEPCPHA,F10
          FEDIT     F10,PF803
          MOVE      CEPCICU,F10
          FEDIT     F10,PF804
          MOVE      CEPCALL,F10
          FEDIT     F10,PF805
          MOVE      CEPCMSS,F10
          FEDIT     F10,PF806
          MOVE      CEPCTAX,F10
          FEDIT     F10,PF807
          MOVE      CEPCOVH,F10
          FEDIT     F10,PF808
          MOVE      CEPCCAT,F10
          FEDIT     F10,PF809
          MOVE      CEPCDEP,F10
          FEDIT     F10,PF810
          MOVE      CEPCOTH,F10
          FEDIT     F10,PF811
          ASSIGN    CEPCNUR+CEPCTHE+CEPCPHA+CEPCICU+CEPCALL+CEPCMSS+CEPCTAX,F10
          ASSIGN    F10+CEPCOVH+CEPCCAT+CEPCDEP+CEPCOTH,F10
          FEDIT     F10,PF10
          PRINT     CEPCDRGC,SP1,CCDGDES
          PRINT     *11,CEPCALOS,SP1,CEPCNWG:
                    *36,PF801,PF802,PF803,PF804,PF805,PF806,PF807,PF808:
                        PF809,PF810,PF811,PF10
          GOTO      COSREP10
COSREP90  CALL      UND132
          PRINT     *45,"*** End of Report ***"
          RETURN
.
COSHED00  CALL      HEAD132
          DISPLAY   *P1:24,"Printing Report : ",CPAGENO
          CALL      UND132
          PRINT     "Diagnosis Related Group                  "
          PRINT     "             Av. LOS  Nat.Cst Wt   Nursing":
                    " Theatre   Drugs     ICU  Allied   M & S  ":
                    " Taxes     O/H   Cater   Dep'n   Other     Total"
          CALL      UND132
          RETURN
.
.-------------------------------------------------------------
. Save Details of Model
.-------------------------------------------------------------
POST0000  PACK     KEY1,CEPPIND       * Setup Key
          CALL     RACEPP1            * Check for record on file
          IF       OVRCD=0
            CALL     UPCEPP1          * Update Changes
          ELSE
            MOVE     ZERO,CEPPNURF
            MOVE     ZERO,CEPPTHEF
            MOVE     ZERO,CEPPPHAF
            MOVE     ZERO,CEPPICUF
            MOVE     ONE,CEPPALLF
            MOVE     ONE,CEPPMSSF
            MOVE     ONE,CEPPTAXF
            MOVE     ONE,CEPPOVHF
            MOVE     ZERO,CEPPCATF
            MOVE     ONE,CEPPDEPF
            MOVE     ONE,CEPPOTHF
            MOVE     ONE,CEPPNURV
            MOVE     ZERO,CEPPTHEV
            MOVE     ZERO,CEPPPHAV
            MOVE     ZERO,CEPPICUV
            MOVE     ZERO,CEPPALLV
            MOVE     ZERO,CEPPMSSV
            MOVE     ZERO,CEPPTAXV
            MOVE     ZERO,CEPPOVHV
            MOVE     ONE,CEPPCATV
            MOVE     ZERO,CEPPDEPV
            MOVE     ZERO,CEPPOTHV
            MOVE     "1500.00",CEPPICU
            MOVE     ZERO,CEPPB01
            MOVE     ZERO,CEPPB02
            MOVE     ZERO,CEPPB03
            MOVE     ZERO,CEPPB04
            MOVE     ZERO,CEPPB05
            MOVE     ZERO,CEPPB06
            MOVE     ZERO,CEPPB07
            MOVE     ZERO,CEPPB08
            MOVE     ZERO,CEPPB09
            MOVE     ZERO,CEPPB10
            MOVE     ZERO,CEPPB11
            MOVE     ZERO,CEPPB12
            MOVE     ZERO,CEPPB13
            MOVE     ZERO,CEPPB14
            MOVE     ZERO,CEPPB15
            CALL     WRCEPP1          * Write New Record
          ENDIF
          RETURN                      * Return to program.
.-------------------------------------------------------------
. Save Fee Details
.-------------------------------------------------------------
POSA0000  PACK     KEY5,CEPMMOD,CEPMDRGC      * Setup Key
          CALL     RACEPM1            * Check for record on file
          IF       OVRCD=0
            CALL     UPCEPM1          * Update Changes
          ELSE
            CALL     WRCEPM1          * Write New Record
          ENDIF
          RETURN                      * Return to program.
.
.-------------------------------------------------------------
. ENter DRG
.-------------------------------------------------------------
EDRG0000  MOVE     ZERO,CKEYTYP
          CALL     KCCDGA00
          BRANCH   EXIT,EDRG9999,EDRG9999
          MOVE     CCDGDRGC,CEPMDRGC
          PACK     KEY5,CEPMMOD,CEPMDRGC
          CALL     RDCEPM1
          IF       OVRCD=1
            MOVE     ZERO,OVRCD
            MOVE     ZERO,CEPMPCAS
            MOVE     ZERO,CEPMPDAY
            MOVE     SP70,CEPMSPA
            UNPACK   KEY5,CEPMMOD,CEPMDRGC
          ENDIF
EDRG9999  RETURN                      * Return to program.
.
.-------------------------------------------------------------
. Save Costing Details
.-------------------------------------------------------------
POSB0000  PACK     KEY4,CEPCDRGC
          CALL     RACEPC1
          IF       OVRCD=0
            CALL     UPCEPC1
          ELSE
            CALL     WRCEPC1
          ENDIF
          RETURN
.
.-------------------------------------------------------------
. Enter DRG
.-------------------------------------------------------------
EDRGB000  MOVE      ZERO,CKEYTYP
          CALL      KCCDGA00
          BRANCH    EXIT,EDRGB999,EDRGB999
          MOVE      CCDGDRGC,CEPCDRGC
          MOVE      CCDGDRGC,KEY4
          CALL      RDCEPC1
          IF        OVRCD=1
            MOVE      ZERO,CEPCNUR
            MOVE      ZERO,CEPCTHE
            MOVE      ZERO,CEPCPHA
            MOVE      ZERO,CEPCICU
            MOVE      ZERO,CEPCALL
            MOVE      ZERO,CEPCMSS
            MOVE      ZERO,CEPCTAX
            MOVE      ZERO,CEPCOVH
            MOVE      ZERO,CEPCCAT
            MOVE      ZERO,CEPCDEP
            MOVE      ZERO,CEPCOTH
          ENDIF
EDRGB999  RETURN
.------------------------------------------------------------
. Build DRG Fees Table
.------------------------------------------------------------
BDRG0000  PACK     KEY1,CEPPIND
          CALL     RDCEPP1
          BRANCH   OVRCD,BDRG9999
.
. Scan Cost Table and Post to Fee Table
.
          MOVE     ZERO,SECTOR
          PACK     KEY3,SP70
          CALL     RSCEPC1
BDRG1000  CALL     RKCEPC1
          BRANCH   OVRCD,BDRG1900
          ADD      ONE,SECTOR
          IF       SECTOR%100=0
            DISPLAY   *P1:24,*EL,"Records Processed : ",SECTOR
          ENDIF
.
          MOVE     ZERO,CEPMPCAS
          MOVE     ZERO,CEPMPDAY
.
          ASSIGN   (CEPCNUR*CEPPNURF)+CEPMPCAS,CEPMPCAS
          ASSIGN   (CEPCTHE*CEPPTHEF)+CEPMPCAS,CEPMPCAS
          ASSIGN   (CEPCPHA*CEPPPHAF)+CEPMPCAS,CEPMPCAS
          ASSIGN   (CEPCICU*CEPPICUF)+CEPMPCAS,CEPMPCAS
          ASSIGN   (CEPCALL*CEPPALLF)+CEPMPCAS,CEPMPCAS
          ASSIGN   (CEPCMSS*CEPPMSSF)+CEPMPCAS,CEPMPCAS
          ASSIGN   (CEPCTAX*CEPPTAXF)+CEPMPCAS,CEPMPCAS
          ASSIGN   (CEPCOVH*CEPPOVHF)+CEPMPCAS,CEPMPCAS
          ASSIGN   (CEPCCAT*CEPPCATF)+CEPMPCAS,CEPMPCAS
          ASSIGN   (CEPCDEP*CEPPDEPF)+CEPMPCAS,CEPMPCAS
          ASSIGN   (CEPCOTH*CEPPOTHF)+CEPMPCAS,CEPMPCAS
.
          ASSIGN   (CEPCNUR*CEPPNURV)+CEPMPDAY,CEPMPDAY
          ASSIGN   (CEPCTHE*CEPPTHEV)+CEPMPDAY,CEPMPDAY
          ASSIGN   (CEPCPHA*CEPPPHAV)+CEPMPDAY,CEPMPDAY
          ASSIGN   (CEPCICU*CEPPICUV)+CEPMPDAY,CEPMPDAY
          ASSIGN   (CEPCALL*CEPPALLV)+CEPMPDAY,CEPMPDAY
          ASSIGN   (CEPCMSS*CEPPMSSV)+CEPMPDAY,CEPMPDAY
          ASSIGN   (CEPCTAX*CEPPTAXV)+CEPMPDAY,CEPMPDAY
          ASSIGN   (CEPCOVH*CEPPOVHV)+CEPMPDAY,CEPMPDAY
          ASSIGN   (CEPCCAT*CEPPCATV)+CEPMPDAY,CEPMPDAY
          ASSIGN   (CEPCDEP*CEPPDEPV)+CEPMPDAY,CEPMPDAY
          ASSIGN   (CEPCOTH*CEPPOTHV)+CEPMPDAY,CEPMPDAY
.
          ASSIGN   CEPMPDAY/CEPCALOS,CEPMPDAY
          ASSIGN   CEPMPDAY+(CEPMPDAY*(CEPPPRO/100.0)),CEPMPDAY
          ASSIGN   CEPMPCAS+(CEPMPCAS*(CEPPPRO/100.0)),CEPMPCAS
          PACK     KEY5,CEPPIND,CEPCDRGC,SP70
          UNPACK   KEY5,CEPMMOD,CEPMDRGC
          CALL     RACEPM1
          IF       OVRCD=0
            CALL     UPCEPM1
          ELSE
            CALL     WRCEPM1
          ENDIF
          GOTO     BDRG1000
BDRG1900
          MOVE     "Processing Complete - ",DISPMSG
          BEEP
          CALL     MESSAGE1
BDRG9999
          RETURN
.
.------------------------------------------------------------
. DRG Cost Report
.------------------------------------------------------------
FEEREP00  MOVE      "99",CLNO
          DISPLAY   *P1:24,*EL,"Printing Report : ",CPAGENO
          CLOCK     TIME,CTIMEIS
          MOVE      ZERO,CPAGENO
          PACK      KEY4,CEPPIND,SP70
          CALL      RSCEPM1
FEEREP10  CALL      RKCEPM1
          BRANCH    OVRCD,FEEREP90
          MATCH     CEPMMOD,CEPPIND
          GOTO      FEEREP90 IF NOT EQUAL
          MOVE      CEPMDRGC,KEY4
          CALL      RDCCDG1
          IF        OVRCD=1
            MOVE      "Invalid",CCDGDES
          ENDIF
          CALL      RDCEPC1
          IF        OVRCD=1
            MOVE      "0",CEPCALOS
          ENDIF
          COMPARE   "55",CLNO
          CALL      FEEHED00 IF NOT LESS
          ADD       "1",CLNO
          MOVE      "9,999,999.99",PF1201
          MOVE      "9,999,999.99",PF1202
          MOVE      "9,999,999.99",PF1203
          FEDIT     CEPMPDAY,PF1201
          FEDIT     CEPMPCAS,PF1202
          ASSIGN    (CEPMPDAY*CEPCALOS)+CEPMPCAS,F12P2
          FEDIT     F12P2,PF1203
.
          PRINT     CEPMDRGC,SP1,CCDGDES,SP1,PF1201,SP1,PF1202,SP5,CEPCALOS:
                    SP7,PF1203
          GOTO      FEEREP10
.
FEEREP90  CALL      UND132
          PRINT     *45,"*** End of Report ***"
          RETURN
.
FEEHED00  CALL      HEAD132
          DISPLAY   *P1:24,"Printing Report : ",CPAGENO
          CALL      UND132
          PRINT     "Diagnosis Related Group                      ":
                    "                Payment per Diem     per Case":
                    "  Nat. Av. LOS   Average per Case"
          CALL      UND132
          RETURN
.
.----------------------------------------
. Move one to accept to for insert mode
.----------------------------------------
MVACCEPT  MOVE      ONE,ACCEPT
          RETURN
.------------------------------------------------------------
. Load Fixed Length ASCII File
.------------------------------------------------------------
LOAD0000  OPEN      LOADFILE,LOADNAME
          CALL      VERI0000          * Verify Format of File
          BRANCH    EXIT,LOAD9999
.
          CALL      CLRPC000          * Clear File
.
          DISPLAY   *P1:24,*EL,"Load in Progress : "
          MOVE      ZERO,SECTOR
          OPEN      LOADFILE,LOADNAME
.
LOAD1000  ADD       ONE,SECTOR
          READ      LOADFILE,SEQ;CEPCDRGC,CEPCNUR,CEPCTHE,CEPCPHA,CEPCICU:
                        CEPCALL,CEPCMSS,CEPCTAX,CEPCOVH,CEPCCAT,CEPCDEP:
                        CEPCOTH,CEPCALOS,CEPCNWG
          GOTO      LOAD1900 IF OVER
.
          IF       (SECTOR%100=0)
            DISPLAY  *P36:24,*V2LON,SECTOR
          ENDIF
.
          MOVE      CEPCDRGC,KEY4
          CALL      RACEPC1
          IF        OVRCD=0
            CALL      UPCEPC1
          ELSE
            CALL      WRCEPC1
          ENDIF
          GOTO      LOAD1000
.
LOAD1900
.
LOAD9999  RETURN
.------------------------------------------------------------
. Verify Contents of File
.------------------------------------------------------------
VERI0000  DISPLAY   *P1:24,*EL,"Verify in Progress : "
          MOVE      ZERO,SECTOR
          MOVE      ZERO,OVRCD
.
VERI1000  ADD       ONE,SECTOR
          IF       (SECTOR%100=0)
            DISPLAY  *P36:24,*V2LON,SECTOR
          ENDIF
          TRAP      OVERCOND IF FORMAT
          READ      LOADFILE,SEQ;CEPCDRGC,CEPCNUR,CEPCTHE,CEPCPHA,CEPCICU:
                        CEPCALL,CEPCMSS,CEPCTAX,CEPCOVH,CEPCCAT,CEPCDEP:
                        CEPCOTH,CEPCALOS,CEPCNWG
          BRANCH    OVRCD,VERI9000
          GOTO      VERI9900 IF OVER
          TRAPCLR   FORMAT
.
          GOTO      VERI1000
.
VERI9000  CLEAR     DISPMSG
          APPEND    "Format Error at Record ",DISPMSG
          APPEND    SECTOR,DISPMSG
          APPEND    " Load Aborted - ",DISPMSG
          RESET     DISPMSG
          BEEP
          CALL      MESSAGE1
          MOVE      ONE,EXIT
          GOTO      VERI9999
.
VERI9900  MOVE      ZERO,EXIT
          GOTO      VERI9999
.
VERI9999  RETURN
.
. Clear PC File
.
CLRPC000  MOVE      SP70,KEY3
          DISPLAY   *P1:24,*EL,"Clearing Details   : "
          CALL      RSCEPC1
          MOVE      ZERO,SECTOR
.
CLRPC100  CALL      RKCEPC1
          BRANCH    OVRCD,CLRPC999
          ADD       ONE,SECTOR
          IF       (SECTOR%100=0)
            DISPLAY  *P36:24,*V2LON,SECTOR
          ENDIF
          MOVE      CEPCDRGC,KEY4
          CALL      RDCEPC1
          IF        OVRCD=0
            CALL      DECEPC1
            CALL      RSCEPC1
          ENDIF
          GOTO      CLRPC100
CLRPC999  RETURN
.------------------------------------------------------------
. Enter File to Load
.------------------------------------------------------------
KFILE000  STRIP     LOADNAME
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,LOADNAME
          ENDSET    LOADNAME
          APPEND    SP70,LOADNAME
          RESET     LOADNAME
          CMATCH    EXITCHAR,LOADNAME
          GOTO      KFILE900 IF EQUAL
          MATCH     SP70,LOADNAME
          GOTO      KFILE900 IF EQUAL
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      LOADFILE,LOADNAME
          TRAPCLR   IO
          IF        OVRCD=1
            BEEP
            MOVE    "File Not Found - ",DISPMSG
            CALL    MESSAGE1
            GOTO    KFILE0000
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KFILE999
KFILE900  MOVE      TWO,EXIT
KFILE999  RETURN
DEFAULTY    MOVE     ANSY,DEFYESNO
            RETURN
.-------------------------------------------------------------
. Delete Payment Model
.-------------------------------------------------------------
DELT0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DELT1000,DELT9000,DELT9100
.
DELT1000  PACK     KEY1,CEPPIND        * Setup Key to File
          CALL     RACEPP1             * Read Record
          IF       OVRCD=0
            CALL     DECEPP1           * Delete Record
          ENDIF
.
          PACK     KEY4,CEPPIND,SP70
          CALL     RSCEPM1
DELT1100  CALL     RKCEPM1             * Delete Related Details
          BRANCH   OVRCD,DELT1900
          MATCH    CEPMMOD,CEPPIND
          GOTO     DELT1900 IF NOT EQUAL
          PACK     KEY5,CEPMMOD,CEPMDRGC
          CALL     DECEPM1
          GOTO     DELT1100
.
DELT1900  MOVE     TWO,EXIT            * Restart Screen
          GOTO     DELT9999
DELT9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DELT9999
DELT9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DELT9999
DELT9999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CCSDRGIO/INC
          INC       CCSDRGKY    
          INC       CEAPCDIO/INC
          INC       CEAPMDIO/INC
          INC       CEAPPMIO/INC
          INC       CEAPPMKY    
.
          INC       STDGENCD
.
