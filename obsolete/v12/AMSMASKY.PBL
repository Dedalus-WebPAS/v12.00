.---------------------------------------------------------------------------
.   System    :   Asset Management System            
.   Include   :   AMSMASKY
.   Routine   :   KAMMAA00 Keyin Asset               
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KAMMAA00 TOPIC     "AMMAASS "
          MOVE      UNDLN70,AMMAASS 
          KEYIN     *PCCOL:CVERT,*DV,AMMAASS:                                   
                    *PCCOL:CVERT,*V2LON,AMMAASS:                                
                    *PCCOL:CVERT,*DV,AMMAASS 
.
          ENDSET    AMMAASS 
          APPEND    SP70,AMMAASS 
          RESET     AMMAASS 
.
          MATCH     SP70,AMMAASS 
          GOTO      KAMMAA90 IF EQUAL
.
          CMATCH    EXITCHAR,AMMAASS 
          GOTO      KAMMAA95 IF EQUAL
.
          CMATCH    QUEST,AMMAASS 
          GOTO      KAMMAA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HAMMAA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    AMMAASS 
          APPEND    SP70,AMMAASS 
          RESET     AMMAASS 
.
          MATCH     SP70,AMMAASS 
          GOTO      KAMMAA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,AMMAASS                                 
KAMMAA10
          PACK      KEY14,AMMAREG,AMMAASS                                       
          CALL      RAAMMA1 
          BRANCH    OVRCD,KAMMAA80
          BRANCH    CKEYTYP,KAMMAA75
          CALL      RDAMMA1 
KAMMAA70
          MOVE      ZERO,EXIT
          GOTO      KAMMAA99
KAMMAA75
          MOVE      "Asset Already Exist - ",DISPMSG                                                 
          CALL      MESSAGE1
          GOTO      KAMMAA00
KAMMAA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KAMMAA99,KAMMAA99
          MOVE      "Asset Does Not Exist - ",DISPMSG                                                
          CALL      MESSAGE1
          GOTO      KAMMAA00
KAMMAA90
          MOVE      ONE,EXIT
          GOTO      KAMMAA99
KAMMAA95
          MOVE      TWO,EXIT
KAMMAA99 TOPIC    PRGID
          RETURN
.---------------------------------------------------------------------------
.   System    :   Asset Management System            
.   Include   :   AMSMASKY
.   Routine   :   HAMMAA00 Asset               
.   Return    :           
.-------------------------------------------------------------------------------
HAMMAA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "01",HLEF
            MOVE      "80",HRIG
          ENDIF
HAMMAA04
          CALL      GSCRN000
          BRANCH    EXIT,HAMMAA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Asset"              
.
          MOVE      STDCOL01,STDCOL02
          ADD       "13",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Description"        
.
          MOVE      STDCOL02,STDCOL03
          ADD       "36",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Dept."              
.
          MOVE      STDCOL03,STDCOL04
          ADD       " 6",STDCOL04
          DISPLAY   *PSTDCOL04:STDROW,*V2LON,*ULON,"Bld."               
.
          MOVE      STDCOL04,STDCOL05
          ADD       " 5",STDCOL05
          DISPLAY   *PSTDCOL05:STDROW,*V2LON,*ULON,"Location"           
.
          MOVE      STDCOL05,STDCOL06
          ADD       " 8",STDCOL06
HAMMAA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,AMMAASS 
          PACK      KEY14,AMMAREG,AMMAASS,SP70                                  
          PACK      SAVKEY80,AMMAREG,AMMAASS,SP70                               
          SETLPTR   SAVKEY80,2                                                  
          CALL      RSAMMA1 
HAMMAA10
          CALL      RKAMMA1 
          BRANCH    OVRCD,HAMMAA15
          PACK      KEY14,AMMAREG,AMMAASS,SP70                                  
          MATCH     SAVKEY80,KEY14                                              
          GOTO      HAMMAA15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,HAMMAA12
          CALL      HAMMAA60
          BRANCH    OVRCD,HAMMAA10
HAMMAA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY14,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,AMMAASS 
          DISPLAY   *PSTDCOL02:STDROW,AMMADES 
          DISPLAY   *PSTDCOL03:STDROW,AMMADPT 
          DISPLAY   *PSTDCOL04:STDROW,AMMABLD 
          DISPLAY   *PSTDCOL05:STDROW,AMMALOC 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HAMMAA10 IF NOT EQUAL
HAMMAA15
          UNPACK    SAVKEY80,AMMAREG,AMMAASS                                    
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HAMMAA20
          CALL      HSCRI000
          BRANCH    EXIT,HAMMAA30,HAMMAA35,HAMMAA40,HAMMAA45,HAMMAA04:
                              HAMMAA91,HAMMAA50
          GOTO      HAMMAA92
HAMMAA30
          CALL      RKAMMA1 
          BRANCH    OVRCD,HAMMAA85
          PACK      KEY14,AMMAREG,AMMAASS,SP70                                  
          MATCH     SAVKEY80,KEY14                                              
          GOTO      HAMMAA85 IF NOT EQUAL                                       
          CALL      RPAMMA1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAMMAA10
HAMMAA35
          MOVE      ST1,KEY14
          CALL      RDAMMA1 
          CALL      RPAMMA1 
          BRANCH    OVRCD,HAMMAA85
          PACK      KEY14,AMMAREG,AMMAASS,SP70                                  
          MATCH     SAVKEY80,KEY14                                              
          GOTO      HAMMAA85 IF NOT EQUAL                                       
          MATCH     SP70,AMMAASS                                                
          GOTO      HAMMAA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HAMMAA36
          CALL      RPAMMA1 
          BRANCH    OVRCD,HAMMAA37
          PACK      KEY14,AMMAREG,AMMAASS,SP70                                  
          MATCH     SAVKEY80,KEY14                                              
          GOTO      HAMMAA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HAMMAA36 IF NOT EQUAL
HAMMAA37
          MOVE      ZERO,XITEMNO
          GOTO      HAMMAA10
HAMMAA40
          MOVE      ST1,KEY14
          CALL      RDAMMA1 
          CALL      RPAMMA1 
          BRANCH    OVRCD,HAMMAA85
          PACK      KEY14,AMMAREG,AMMAASS,SP70                                  
          MATCH     SAVKEY80,KEY14                                              
          GOTO      HAMMAA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAMMAA08
HAMMAA45
          CALL      RKAMMA1 
          BRANCH    OVRCD,HAMMAA85
          PACK      KEY14,AMMAREG,AMMAASS,SP70                                  
          MATCH     SAVKEY80,KEY14                                              
          GOTO      HAMMAA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY14,SAVKEY80,Z70                                          
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSAMMA1 
HAMMAA46
          CALL      RPAMMA1 
          BRANCH    OVRCD,HAMMAA47
          PACK      KEY14,AMMAREG,AMMAASS,SP70                                  
          MATCH     SAVKEY80,KEY14                                              
          GOTO      HAMMAA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HAMMAA46 IF NOT EQUAL
HAMMAA47
          MOVE      ZERO,XITEMNO
          GOTO      HAMMAA10
HAMMAA50  COMPARE   ZERO,CSEARCH
          GOTO      HAMMAA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          KEYIN     *PSTDCOL04:STDROW,*V2LON,SCHFLD04
          RESET     SCHFLD04
          KEYIN     *PSTDCOL05:STDROW,*V2LON,SCHFLD05
          RESET     SCHFLD05
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAMMAA08
HAMMAA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HAMMAA08
HAMMAA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HAMMAA61 IF EQUAL
          MATCH     SCHFLD01,AMMAASS 
          GOTO      HAMMAA72 IF NOT EQUAL
HAMMAA61
          MATCH     SP70,SCHFLD02
          GOTO      HAMMAA62 IF EQUAL
          MATCH     SCHFLD02,AMMADES 
          GOTO      HAMMAA72 IF NOT EQUAL
HAMMAA62
          MATCH     SP70,SCHFLD03
          GOTO      HAMMAA63 IF EQUAL
          MATCH     SCHFLD03,AMMADPT 
          GOTO      HAMMAA72 IF NOT EQUAL
HAMMAA63
          MATCH     SP70,SCHFLD04
          GOTO      HAMMAA64 IF EQUAL
          MATCH     SCHFLD04,AMMABLD 
          GOTO      HAMMAA72 IF NOT EQUAL
HAMMAA64
          MATCH     SP70,SCHFLD05
          GOTO      HAMMAA65 IF EQUAL
          MATCH     SCHFLD05,AMMALOC 
          GOTO      HAMMAA72 IF NOT EQUAL
HAMMAA65
HAMMAA66
HAMMAA67
HAMMAA68
HAMMAA69
HAMMAA70
          GOTO      HAMMAA75
HAMMAA72  MOVE      ONE,OVRCD
HAMMAA75  RETURN
HAMMAA85
          LOAD      KEY14,XITEMNO,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY14,AMMAREG,AMMAASS                                       
          CALL      RDAMMA1 
HAMMAA90
          UNPACK    SAVKEY80,AMMAREG,AMMAASS                                    
          BEEP
          GOTO      HAMMAA20
HAMMAA91
          MOVE      SP70,AMMADES 
          MOVE      SP70,AMMATYP 
          MOVE      SP70,AMMADPT 
          MOVE      SP70,AMMABLD 
          MOVE      SP70,AMMALOC 
          MOVE      SP70,AMMALCM 
          MOVE      SP70,AMMASDT 
          MOVE      SP70,AMMAVDT 
          MOVE      ZERO,AMMARVT 
          MOVE      ZERO,AMMASEC 
          MOVE      ZERO,AMMALEA 
          MOVE      ZERO,AMMAREN 
          MOVE      ZERO,AMMAPRI 
          MOVE      SP70,AMMARDT 
          MOVE      SP70,AMMAAYR 
          MOVE      SP70,AMMAAPR 
          MOVE      SP70,AMMAADT 
          MOVE      SP70,AMMATDT 
          MOVE      ZERO,AMMATAD 
          MOVE      ZERO,AMMAAAD 
          MOVE      SP70,AMMAGIC 
          MOVE      SP70,AMMAAQD 
          MOVE      SP70,AMMASOF 
          MOVE      SP70,AMMADDT 
          MOVE      SP70,AMMADTY 
          MOVE      ZERO,AMMADVA 
          MOVE      SP70,AMMAAQO 
          MOVE      SP70,AMMAAQI 
          MOVE      SP70,AMMASER 
          MOVE      ZERO,AMMACST 
          MOVE      SP70,AMMAMANC
          MOVE      SP70,AMMAMANN
          MOVE      SP70,AMMAMANP
          MOVE      SP70,AMMASUPC
          MOVE      SP70,AMMASUPN
          MOVE      SP70,AMMASUPP
          MOVE      ZERO,AMMARVR 
          MOVE      ZERO,AMMAUA1 
          MOVE      ZERO,AMMAUA2 
          MOVE      ZERO,AMMAUA3 
          MOVE      SP70,AMMAUR1 
          MOVE      SP70,AMMAUR2 
          MOVE      SP70,AMMAUR3 
          MOVE      SP70,AMMAUR4 
          MOVE      SP70,AMMAUD1 
          MOVE      SP70,AMMAUD2 
          MOVE      SP70,AMMAUD3 
          MOVE      SP70,AMMAUD4 
          MOVE      SP70,AMMAUC1 
          MOVE      SP70,AMMAUC2 
          MOVE      SP70,AMMAUC3 
          MOVE      SP70,AMMAUC4 
          MOVE      SP70,AMMAUY1 
          MOVE      SP70,AMMAUY2 
          MOVE      SP70,AMMAUY3 
          MOVE      SP70,AMMAUY4 
          MOVE      SP70,AMMADYR 
          MOVE      SP70,AMMADPR 
          MOVE      SP70,AMMADRF 
          MOVE      SP70,KEY14
          MOVE      SP70,AMMAASS 
          GOTO      HAMMAA96
HAMMAA92
          MOVE      SP70,KEY14
          MOVE      SP70,AMMAASS 
          LOAD      KEY14,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY14,AMMAREG,AMMAASS                                       
HAMMAA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HAMMAA99
          RETURN
