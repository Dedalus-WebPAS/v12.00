+
.*****************************************************************************
.* System   : Menu Generation                                                *
.* Program  : UMENSKEL                                                       *
.* Desc     : SKELETON PROGRAM FOR USE IN THE GENERATION OF USER MENUS       *
.* %Z%%M%, Version: %I% %E%                                                  *
.*****************************************************************************
.* Date     : 21/04/89 V5.00                                                 *
.* Author   : Darren Jones                                                   *
.* Comments :                                                                *
.* ---------:--------------------------------------------------------------- *
.* Modified : 20/02/90 V5.01                                                 *
.* Author   : Paul Blackmore                                                 *
.* Comments : Add UNIX commands option                                       *
.*          : Changed name from MENUSKEL to UMENSKEL                         *
.* ---------:--------------------------------------------------------------- *
.* Modified : 31/05/90 V5.02                                                 *
.* Author   : Paul Blackmore                                                 *
.* Comments : Now used in conjunction with new menu generator 'gensub'       *
.*          : Complete rewrite of generated source code.                     *
.* ---------:--------------------------------------------------------------- *
.* Modified : 15/08/90 V5.03                                                 *
.* Author   : Paul Blackmore                                                 *
.* Comments : New routine called PFRQ000 to allow payroll program defaults   *
.* ---------:--------------------------------------------------------------- *
.* Modified : 20/08/91 V6.00                                                 *
.* Author   : Steve O'Gorman                                                 *
.* Comments : Modified to Handle the New Common                              *
.* ---------:--------------------------------------------------------------- *
.* Modified : 19/02/91 V6.01                                                 *
.* Author   : Jeni Tan                                                       *
.* Comments : New routine called PATSTYR to check for start of year          *
.* ---------:--------------------------------------------------------------- *
.* Modified : 19/06/91 V6.02                                                 *
.* Author   : Jeni Tan                                                       *
.* Comments : Not allowed to have a blank site code                          *
.* ---------:--------------------------------------------------------------- *
.* Modified : 14/10/1998 V6.03                                               *
.* Author   : Steve Armstrong                                                *
.* Comments : Mods to clear screen after returning from UNIXSHEL.            *
.*            Also changed CSTRTYR from DIM6 to DIM8                         *
.* ---------:--------------------------------------------------------------- *
.* Modified : 30/12/1999 V6.04                                               *
.* Author   : Steve Armstrong                                                *
.* Comments : Removed use of PATSTYR                                         *
.* ---------:--------------------------------------------------------------- *
.* Modified : 05/04/2011 V10.02.01                                           *
.* Author   : Jill Parkinson CAR 239574                                      *
.* Comments : Removed open of ibaprntf                                       *
.* ---------:--------------------------------------------------------------- *
.* Modified : 15/04/2014 V10.04.01                                           *
.* Author   : Ebon Clements  CAR 299449                                      *
.* Comments : Recompiled for IBAPRINT 6 character printers                   *
.*****************************************************************************
.
          INC       STD001FD
.
          INC       IBAIMNFD/INC
          INC       IBAPORFD/INC       **** PORT SCANNING
          INC       IBAPRNFD/INC
          INC       IBASECFD/INC
          INC       IBASYSFD/INC       **** TRACKS USERS ON SYSTEM
.
          INC       OUTCONFD/INC
          INC       OUTSITFD/INC      *** SITE ID TO COMMON/INC IDDD
.
+
.******************************************************************************
.*                           Miscellaneous Variables                          *
.******************************************************************************
ACTION    FORM      2           
ACTION2   FORM      2
ANSWER    DIM       2          
.
CHOSTYP   FORM      1    
CNT       FORM      1
CONAME    DIM       35
CSTRTYR   DIM       8
CHGSTYR   FORM      1
.
DIM3      DIM       3
DIM4      DIM       4
DIM6      DIM       6
DIM8      DIM       8
.
EXECSTR   DIM       80
.
FNAMEM    DIM       12
FORM2A    FORM      2
FORM5     FORM      5
FORM5A    FORM      5
.
NOPASSWD  FORM      1
PASSCHK   DIM       8
PASSTAB   FORM      3
PASSWD    DIM       8
PORTNAME  DIM       11
PROGRAM   DIM       8
PROGNAME  DIM       8
UNIXNAME  DIM       38
.
SPNAME    DIM       8
SPOOLFLG  FORM      1
.
TMPMESG   FILE      ASCII, FIXED=10
.
BOXSIZE   FORM      2
VERT      FORM      2
MMENUOPT  FORM      2
.
G$000000  INIT      "Supply & Inventory System"
G$000002  INIT      "Exit"
G$000003  INIT      "Maintenance"
G$000004  INIT      "Enquiries"
G$000005  INIT      "Transaction Processing"
G$000006  INIT      "Purchase Requisition"
G$000007  INIT      "General Reporting"
G$000008  INIT      "End of Month/Year Reporting"
G$000009  INIT      "Optional Selections"
G$010000  INIT      "Supply & Inventory Maintenance"
G$010002  INIT      "Masterfiles"
G$010003  INIT      "Exit"
G$010004  INIT      "Codes"
G$010005  INIT      "Commodity Groups"
G$010006  INIT      "Product Groups"
G$010007  INIT      "Cost Centres"
G$010008  INIT      "Warehouses"
G$010009  INIT      "Factors"
G$010010  INIT      "Catalogs"
G$010011  INIT      "Catalog Supplier Replacement"
G$010012  INIT      "Imprests"
G$010013  INIT      "Originators"
G$010014  INIT      "Suppliers"
G$010015  INIT      "Contracts"
G$010016  INIT      "Period Setup"
G$010017  INIT      "Service Codes"
G$010103  INIT      "Cost Centre Security Allocation"
G$010104  INIT      "Warehouse Security Allocation"
G$010105  INIT      "Ledger Translation Table"
G$010107  INIT      "Budgets"
G$010108  INIT      "Commodity Groups"
G$010109  INIT      "Product Groups"
G$010110  INIT      "Suppliers"
G$010111  INIT      "Cost Centres"
G$020000  INIT      "Supply & Inventory Enquiries"
G$020002  INIT      "Exit"
G$020003  INIT      "Warehouses"
G$020004  INIT      "Commodity Groups"
G$020005  INIT      "Product Groups"
G$020006  INIT      "Suppliers"
G$020007  INIT      "Cost Centres"
G$020008  INIT      "Catalog"
G$020009  INIT      "Purchase Orders"
G$020010  INIT      "Requisitions/Returns"
G$020011  INIT      "Non-Stock P.O Enq. by Req. Code"
G$020012  INIT      "Not in Catalog P/O Enquiry"
G$030000  INIT      "Supply & Inventory Processing"
G$030001  INIT      "Requisitions"
G$030002  INIT      "Exit"
G$030003  INIT      "Input Internal Requisitions"
G$030004  INIT      "Input Return Of Stock"
G$030005  INIT      "Stock Transfers"
G$030006  INIT      "Backorder Maintenance"
G$030008  INIT      "Imprest"
G$030009  INIT      "Print Worksheets"
G$030010  INIT      "Imprest Download"
G$030011  INIT      "Input Counted Worksheets"
G$030012  INIT      "Generate N/S P/O from Imprest"
G$030014  INIT      "Picking Sheets"
G$030015  INIT      "Print Picking Sheets"
G$030016  INIT      "Input Picking Sheets Variance"
G$030101  INIT      "Purchase Orders"
G$030102  INIT      "Input/Change Purchase Orders"
G$030103  INIT      "Create/Print S.R.O."
G$030104  INIT      "Modify/Process S.R.O."
G$030105  INIT      "Print Outstanding P/O"
G$030106  INIT      "Print P/O"
G$030107  INIT      "Print Receivals"
G$030108  INIT      "Process Receivals"
G$030109  INIT      "Confirmation Orders Report"
G$030110  INIT      "SOS Interface"
G$030112  INIT      "Stocktake"
G$040001  INIT      "Stocktake"
G$040003  INIT      "Exit"
G$040004  INIT      "Print Worksheets"
G$040005  INIT      "Input Stocktake Worksheets"
G$040006  INIT      "Print Final Discrepancy Report"
G$040007  INIT      "Stock Check Extract Report"
G$040008  INIT      "Input Imprest Stocktake"
G$040009  INIT      "Imprest Master Listing"
G$040010  INIT      "Stocktake Discrepancy Report"
G$040011  INIT      "Spooling Functions"
G$050000  INIT      "Purchase Requisition"
G$050002  INIT      "Exit"
G$050003  INIT      "P/R Entry"
G$050004  INIT      "P/R Cancellation"
G$050005  INIT      "P/R Stock Processing"
G$050006  INIT      "P/R Order Processing"
G$050007  INIT      "P/R Reporting"
G$050008  INIT      "P/R Report/Purge"
G$060000  INIT      "Supply & Inventory Reporting"
G$060001  INIT      "Catalog Reports"
G$060002  INIT      "Exit"
G$060003  INIT      "Catalog Listings"
G$060004  INIT      "Print Shelf Labels"
G$060005  INIT      "Suspended Stock Report"
G$060006  INIT      "Item History Report"
G$060007  INIT      "Stock Expiry Report"
G$060008  INIT      "Supplier Fill Rate Report"
G$060009  INIT      "Stock Transfer Report"
G$060010  INIT      "General Reports"
G$060011  INIT      "Backorder By Cost Centre Report"
G$060012  INIT      "Backorder By Catalog Report"
G$060013  INIT      "Disposal Review Report"
G$060014  INIT      "Cost Variation Report"
G$060015  INIT      "Print Cost Centre Labels"
G$060016  INIT      "Barcode Labels"
G$060017  INIT      "I.C.L Generation"
G$060018  INIT      "A-B-C Generation"
G$060101  INIT      "Master Listings"
G$060102  INIT      "Codes"
G$060103  INIT      "Warehouses"
G$060104  INIT      "Commodity Groups"
G$060105  INIT      "Product Groups"
G$060106  INIT      "Suppliers"
G$060107  INIT      "Cost Centres"
G$060108  INIT      "Imprests"
G$060109  INIT      "Factors"
G$060110  INIT      "Originators"
G$060113  INIT      "Analysis Reports"
G$060114  INIT      "Commodity Analysis"
G$060115  INIT      "Product Group Analysis"
G$060116  INIT      "Catalog Analysis"
G$060118  INIT      "Spooling Functions"
G$070000  INIT      "Supply & Inventory"
G$070002  INIT      "End of Month"
G$070003  INIT      "Exit "
G$070004  INIT      "Stock Ledger Report"
G$070005  INIT      "Stock Usage Report"
G$070006  INIT      "Cost Centre Stock Usage Report"
G$070007  INIT      "Committed Expenditure Report"
G$070008  INIT      "Committed P/O Expenditure Report"
G$070009  INIT      "O/Standing P/O by Cost Centre"
G$070010  INIT      "P/O Received by Cost Centre"
G$070011  INIT      "Catalog/Cost Centre Usage Reports"
G$070012  INIT      "Purchases by Cost Centre Report"
G$070013  INIT      "Supplier Key Performance Indic."
G$070014  INIT      "Imprest ABC Analysis"
G$070015  INIT      "Departmental Workload Report"
G$070103  INIT      "Ledger Translation Table Listing"
G$070104  INIT      "Transmit Ledger Data"
G$070107  INIT      "End of Year"
G$070109  INIT      "Stock Ledger Report"
G$070110  INIT      "Stock Usage Report"
G$070111  INIT      "Cost Centre Stock Usage Report"
G$070112  INIT      "Imprest Usage Report"
G$070113  INIT      "Shortages & Surplus Reports"
G$070114  INIT      "Stocktake Discrepancy Report"
G$070116  INIT      "Spooling Functions"
G$080000  INIT      "Catalog/Cost Centre Usage Reports"
G$080003  INIT      "Exit"
G$080004  INIT      "Usage Report Totals Only"
G$080005  INIT      "Usage Report Cost Centre Totals"
G$090000  INIT      "Optional Selections"
G$090001  INIT      ""
G$090002  INIT      "Exit"
G$090003  INIT      "System Parameter Maintenance"
G$090004  INIT      "Abort Stocktake"
G$090005  INIT      "Purge Options"
G$090006  INIT      "Transaction Audit Print"
G$090007  INIT      "Reverse Receivals"
G$090008  INIT      "Delete a Catalog"
G$090009  INIT      "Purchase Order Flag Clear"
G$090010  INIT      "Requisition Correction"
G$090011  INIT      "Delete a Catalog - No Checking"
PRGID     INIT      "UMENIBSN"
PRGNAM    INIT      "IBA Supply & Inventory Menu's menu"
VERSION   INIT      "V12.00.00"
+
.**************************************************************************
.*                             MAINLINE                                   *
.*                         controlling logic                              *
.**************************************************************************
          CALL      INIT0000                   * initialization
          CALL      HEAD0000
ML0000    BRANCH    PERIOD:
                    D0020000,D0030000,D0040000,D0050000,D0060000:
                    D0070000,D0080000,D0090000,D0100000
          GOTO      D0010000                   * display main menu
ML9999    CHAIN     SPNAME
+
.**************************************************************************
.*                            INIT0000                                    *
.*                         initialization                                 *
.**************************************************************************
INIT0000  OPEN      CONTROLF,"controlf"
          OPEN      IBACODE1,"ibacodef"
          OPEN      IBAPORT1,"ibaportf"
          OPEN      IBASECU1,"ibasecuf"
          OPEN      IBASECU2,"ibasecuf"
          OPEN      IBASECU2,"ibasecuf"
          OPEN      OUTSITA1,"outsitaf"
.
          READ      CONTROLF,ZERO;*13,CSECCNT
          READ      CONTROLF,TWO;*149,USERFLAG,*154,SPNAME
          READ      CONTROLF,TEN3;*245,CHOSTYP
.
.         userflag = 0 full system tracking
.         userflag = 1 no tracking
.
          BRANCH    USERFLAG,INIT1000
.
          OPEN      IBASYSA1,"ibasysaf"    * system tracking file
          OPEN      IBASYSA2,"ibasysaf"    * system tracking file
          OPEN      IBASYSA3,"ibasysaf"    * system tracking file
          OPEN      IBASYSA4,"ibasysaf"    * system tracking file
.
          CALL      UPSYSA1                * end of last program
.
INIT1000  MOVE      PRGID,IBAPPROG
          CALL      WRPORT1                * in out menu
.
          CALL      IBACLOCK
INIT9999  RETURN
+
.*************************************************************************
.*                          HEAD0000                                     *
.*                display screen heading line 1 & 2                      *
.*************************************************************************
HEAD0000  READ      CONTROLF,TWO;*4,CONAME
          MOVE      CONAME,CNAME
.
          STRIP     CNAME
          MOVELPTR  CNAME,CCOL
          DIV       TWO,CCOL
          MULT      SEQ,CCOL                                     Date : 12/12/12
          ADD       "40",CCOL
          DISPLAY   *ES,*HON,SP30,SP30,SP10,SP10:
                    *P1:1,PRGID,"/",VERSION,*PCCOL:1,CNAME:
                    *P64:1,"Date : ",CDATE
          HLINE     *G37,2,1,80
          DISPLAY   *P65:2," Port : ",PORT,SP1
HEAD9999  RETURN
+
.*************************************************************************
.*                              BOX10000                                 *
.*                       Draw a box for 1 column menu                    *
.*************************************************************************
BOX10000  DISPLAY   *P1:3,*EF
          ASSIGN    4+BOXSIZE,FORM2
          BOX       16,21,3,61,FORM2
BOX19999  RETURN
.
.*************************************************************************
.*                              BOX20000                                 *
.*                       Draw a box for 2 column menu                    *
.*************************************************************************
BOX20000  DISPLAY   *P1:3,*EF
          ASSIGN    4+BOXSIZE,FORM2
          BOX       16,1,3,80,FORM2
BOX29999  RETURN
.
.*************************************************************************
.*                              BOX30000                                 *
.*                       Draw a box for 1 column menu                    *
.*************************************************************************
BOX30000  DISPLAY   *P1:3,*EF
          ASSIGN    4+BOXSIZE,FORM2
          BOX       1,21,3,61,FORM2
BOX39999  RETURN
.
.*************************************************************************
.*                              BOX40000                                 *
.*                       Draw a box for 2 column menu                    *
.*************************************************************************[
BOX40000  DISPLAY   *P1:3,*EF
          ASSIGN    4+BOXSIZE,FORM2
          BOX       1,1,3,80,FORM2
BOX49999  RETURN
.
+
.*************************************************************************
.*                              MENU0000                                 *
.*                        menu generation procedure                      *
.*************************************************************************
+
D0010000  MOVE      "12",BOXSIZE
          CALL      BOX10000
          MOVE      "0",PERIOD
          MOVE      SP6,IDDD
          DISPLAY   *P28:04,*V2LON,*ULON,G$000000,*HOFF:
                    *P24:06,*V2LON," 0",*HOFF,". ",G$000002:
                    *P24:07,*V2LON," 1",*HOFF,". ",G$000003:
                    *P24:08,*V2LON," 2",*HOFF,". ",G$000004:
                    *P24:09,*V2LON," 3",*HOFF,". ",G$000005:
                    *P24:10,*V2LON," 4",*HOFF,". ",G$000006:
                    *P24:11,*V2LON," 5",*HOFF,". ",G$000007:
                    *P24:12,*V2LON," 6",*HOFF,". ",G$000008:
                    *P24:13,*V2LON," 7",*HOFF,". ",G$000009
.
S0010000  CALL      SEL0000
S0010010  BRANCH    MMENUOPT,ML9999,S0010020,S0010030,S0010040:
                           S0010050,S0010060,S0010070,S0010080
          BEEP
          GOTO      S0010000
.
S0010020
          GOTO      D0020000
.
S0010030
          GOTO      D0030000
.
S0010040
          GOTO      D0040000
.
S0010050
          GOTO      D0060000
.
S0010060
          GOTO      D0070000
.
S0010070
          GOTO      D0080000
.
S0010080
          GOTO      D0100000
.
+
D0020000  MOVE      "20",BOXSIZE
          CALL      BOX20000
          MOVE      "1",PERIOD
          MOVE      SP6,IDDD
          DISPLAY   *P25:04,*V2LON,*ULON,G$010000,*HOFF:
                    *P09:06,*V2LON,*ULON,G$010002,*HOFF:
                    *P05:07,*V2LON," 0",*HOFF,". ",G$010003:
                    *P05:08,*V2LON," 1",*HOFF,". ",G$010004:
                    *P05:09,*V2LON," 2",*HOFF,". ",G$010005:
                    *P05:10,*V2LON," 3",*HOFF,". ",G$010006:
                    *P05:11,*V2LON," 4",*HOFF,". ",G$010007:
                    *P05:12,*V2LON," 5",*HOFF,". ",G$010008:
                    *P05:13,*V2LON," 6",*HOFF,". ",G$010009:
                    *P05:14,*V2LON," 7",*HOFF,". ",G$010010:
                    *P05:15,*V2LON," 8",*HOFF,". ",G$010011:
                    *P05:16,*V2LON," 9",*HOFF,". ",G$010012:
                    *P05:17,*V2LON,"10",*HOFF,". ",G$010013:
                    *P05:18,*V2LON,"11",*HOFF,". ",G$010014:
                    *P05:19,*V2LON,"12",*HOFF,". ",G$010015:
                    *P05:20,*V2LON,"13",*HOFF,". ",G$010016:
                    *P05:21,*V2LON,"14",*HOFF,". ",G$010017:
                    *P44:07,*V2LON,"15",*HOFF,". ",G$010103:
                    *P44:08,*V2LON,"16",*HOFF,". ",G$010104:
                    *P44:09,*V2LON,"17",*HOFF,". ",G$010105:
                    *P48:11,*V2LON,*ULON,G$010107,*HOFF:
                    *P44:12,*V2LON,"18",*HOFF,". ",G$010108:
                    *P44:13,*V2LON,"19",*HOFF,". ",G$010109:
                    *P44:14,*V2LON,"20",*HOFF,". ",G$010110:
                    *P44:15,*V2LON,"21",*HOFF,". ",G$010111
.
S0020000  CALL      SEL0000
S0020010  BRANCH    MMENUOPT,D0010000,S0020020,S0020030,S0020040:
                           S0020050,S0020060,S0020070,S0020080,S0020090:
                           S0020100,S0020110,S0020120,S0020130,S0020140:
                           S0020150,S0020160,S0020170,S0020180,S0020190:
                           S0020200,S0020210,S0020220
          BEEP
          GOTO      S0020000
.
S0020020
          MOVE      "IBASIN01",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020030
          MOVE      "IBASIN06",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020040
          MOVE      "IBASIN05",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020050
          MOVE      "IBASIN04",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020060
          MOVE      "IBASIN03",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020070
          MOVE      "IBASIN08",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020080
          MOVE      "IBASIN02",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020090
          MOVE      "IBASUB92",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020100
          MOVE      "IBASIN07",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020110
          MOVE      "IBASIN10",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020120
          MOVE      "IBASIN09",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020130
          MOVE      "IBASUB06",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020140
          MOVE      "IBASIN11",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020150
          MOVE      "IBASIN51",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020160
          MOVE      "IBASUB13",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020170
          MOVE      "IBASUB08",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020180
          MOVE      "IBASUB90",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020190
          MOVE      "IBASUB01",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020200
          MOVE      "IBASUB02",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020210
          MOVE      "IBASUB03",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
S0020220
          MOVE      "IBASUB07",PROGNAME
          CALL      PROG0000
          GOTO      D0020000
.
+
D0030000  MOVE      "15",BOXSIZE
          CALL      BOX10000
          MOVE      "2",PERIOD
          MOVE      SP6,IDDD
          DISPLAY   *P27:04,*V2LON,*ULON,G$020000,*HOFF:
                    *P24:06,*V2LON," 0",*HOFF,". ",G$020002:
                    *P24:07,*V2LON," 1",*HOFF,". ",G$020003:
                    *P24:08,*V2LON," 2",*HOFF,". ",G$020004:
                    *P24:09,*V2LON," 3",*HOFF,". ",G$020005:
                    *P24:10,*V2LON," 4",*HOFF,". ",G$020006:
                    *P24:11,*V2LON," 5",*HOFF,". ",G$020007:
                    *P24:12,*V2LON," 6",*HOFF,". ",G$020008:
                    *P24:13,*V2LON," 7",*HOFF,". ",G$020009:
                    *P24:14,*V2LON," 8",*HOFF,". ",G$020010:
                    *P24:15,*V2LON," 9",*HOFF,". ",G$020011:
                    *P24:16,*V2LON,"10",*HOFF,". ",G$020012
.
S0030000  CALL      SEL0000
S0030010  BRANCH    MMENUOPT,D0010000,S0030020,S0030030,S0030040:
                           S0030050,S0030060,S0030070,S0030080,S0030090:
                           S0030100,S0030110
          BEEP
          GOTO      S0030000
.
S0030020
          MOVE      "IBASIN13",PROGNAME
          CALL      PROG0000
          GOTO      D0030000
.
S0030030
          MOVE      "IBASIN16",PROGNAME
          CALL      PROG0000
          GOTO      D0030000
.
S0030040
          MOVE      "IBASIN15",PROGNAME
          CALL      PROG0000
          GOTO      D0030000
.
S0030050
          MOVE      "IBASIN19",PROGNAME
          CALL      PROG0000
          GOTO      D0030000
.
S0030060
          MOVE      "IBASIN14",PROGNAME
          CALL      PROG0000
          GOTO      D0030000
.
S0030070
          MOVE      "IBASIN12",PROGNAME
          CALL      PROG0000
          GOTO      D0030000
.
S0030080
          MOVE      "IBASIN21",PROGNAME
          CALL      PROG0000
          GOTO      D0030000
.
S0030090
          MOVE      "IBASIN22",PROGNAME
          CALL      PROG0000
          GOTO      D0030000
.
S0030100
          MOVE      "IBASIN23",PROGNAME
          CALL      PROG0000
          GOTO      D0030000
.
S0030110
          MOVE      "IBASIN24",PROGNAME
          CALL      PROG0000
          GOTO      D0030000
.
+
D0040000  MOVE      "20",BOXSIZE
          CALL      BOX20000
          MOVE      "3",PERIOD
          MOVE      SP6,IDDD
          DISPLAY   *P26:04,*V2LON,*ULON,G$030000,*HOFF:
                    *P09:05,*V2LON,*ULON,G$030001,*HOFF:
                    *P05:06,*V2LON," 0",*HOFF,". ",G$030002:
                    *P05:07,*V2LON," 1",*HOFF,". ",G$030003:
                    *P05:08,*V2LON," 2",*HOFF,". ",G$030004:
                    *P05:09,*V2LON," 3",*HOFF,". ",G$030005:
                    *P05:10,*V2LON," 4",*HOFF,". ",G$030006:
                    *P09:12,*V2LON,*ULON,G$030008,*HOFF:
                    *P05:13,*V2LON," 5",*HOFF,". ",G$030009:
                    *P05:14,*V2LON," 6",*HOFF,". ",G$030010:
                    *P05:15,*V2LON," 7",*HOFF,". ",G$030011:
                    *P05:16,*V2LON," 8",*HOFF,". ",G$030012:
                    *P09:18,*V2LON,*ULON,G$030014,*HOFF:
                    *P05:19,*V2LON," 9",*HOFF,". ",G$030015:
                    *P05:20,*V2LON,"10",*HOFF,". ",G$030016:
                    *P47:05,*V2LON,*ULON,G$030101,*HOFF:
                    *P43:06,*V2LON,"11",*HOFF,". ",G$030102:
                    *P43:07,*V2LON,"12",*HOFF,". ",G$030103:
                    *P43:08,*V2LON,"13",*HOFF,". ",G$030104:
                    *P43:09,*V2LON,"14",*HOFF,". ",G$030105:
                    *P43:10,*V2LON,"15",*HOFF,". ",G$030106:
                    *P43:11,*V2LON,"16",*HOFF,". ",G$030107:
                    *P43:12,*V2LON,"17",*HOFF,". ",G$030108:
                    *P43:13,*V2LON,"18",*HOFF,". ",G$030109:
                    *P43:14,*V2LON,"19",*HOFF,". ",G$030110:
                    *P43:16,*V2LON,"20",*HOFF,". ",*V2LON,G$030112,*HOFF
.
S0040000  CALL      SEL0000
S0040010  BRANCH    MMENUOPT,D0010000,S0040020,S0040030,S0040040:
                           S0040050,S0040060,S0040070,S0040080,S0040090:
                           S0040100,S0040110,S0040120,S0040130,S0040140:
                           S0040150,S0040160,S0040170,S0040180,S0040190:
                           S0040200,S0040210
          BEEP
          GOTO      S0040000
.
S0040020
          MOVE      "IBASIN31",PROGNAME
          CALL      PROG0000
          GOTO      D0040000
.
S0040030
          MOVE      "IBASIN34",PROGNAME
          CALL      PROG0000
          GOTO      D0040000
.
S0040040
          MOVE      "IBASIN44",PROGNAME
          CALL      PROG0000
          GOTO      D0040000
.
S0040050
          MOVE      "IBASIN33",PROGNAME
          CALL      PROG0000
          GOTO      D0040000
.
S0040060
          MOVE      "IBASIN40",PROGNAME
          CALL      PROG0000
          GOTO      D0040000
.
S0040070
          MOVE      "IBASIN63",PROGNAME
          CALL      PROG0000
          GOTO      D0040000
.
S0040080
          MOVE      "IBASIN41",PROGNAME
          CALL      PROG0000
          GOTO      D0040000
.
S0040090
          MOVE      "IBASIN48",PROGNAME
          CALL      PROG0000
          GOTO      D0040000
.
S0040100
          MOVE      "IBASIN43",PROGNAME
          CALL      PROG0000
          GOTO      D0040000
.
S0040110
          MOVE      "IBASIN32",PROGNAME
          CALL      PROG0000
          GOTO      D0040000
.
S0040120
          MOVE      "IBASIN50",PROGNAME
          CALL      PROG0000
          GOTO      D0040000
.
S0040130
          MOVE      "IBASIN52",PROGNAME
          CALL      PROG0000
          GOTO      D0040000
.
S0040140
          MOVE      "IBASIN53",PROGNAME
          CALL      PROG0000
          GOTO      D0040000
.
S0040150
          MOVE      "IBASIN54",PROGNAME
          CALL      PROG0000
          GOTO      D0040000
.
S0040160
          MOVE      "IBASIN59",PROGNAME
          CALL      PROG0000
          GOTO      D0040000
.
S0040170
          MOVE      "IBASIN56",PROGNAME
          CALL      PROG0000
          GOTO      D0040000
.
S0040180
          MOVE      "IBASIN57",PROGNAME
          CALL      PROG0000
          GOTO      D0040000
.
S0040190
          MOVE      "IBASIN49",PROGNAME
          CALL      PROG0000
          GOTO      D0040000
.
S0040200
          MOVE      "IBASUB40",PROGNAME
          CALL      PROG0000
          GOTO      D0040000
.
S0040210
          GOTO      D0050000
.
+
D0050000  MOVE      "16",BOXSIZE
          CALL      BOX10000
          MOVE      "4",PERIOD
          MOVE      SP6,IDDD
          DISPLAY   *P36:05,*V2LON,*ULON,G$040001,*HOFF:
                    *P22:07,*V2LON," 0",*HOFF,".  ",G$040003:
                    *P22:08,*V2LON," 1",*HOFF,".  ",G$040004:
                    *P22:09,*V2LON," 2",*HOFF,".  ",G$040005:
                    *P22:10,*V2LON," 3",*HOFF,".  ",G$040006:
                    *P22:11,*V2LON," 4",*HOFF,".  ",G$040007:
                    *P22:12,*V2LON," 5",*HOFF,".  ",G$040008:
                    *P22:13,*V2LON," 6",*HOFF,".  ",G$040009:
                    *P22:14,*V2LON," 7",*HOFF,".  ",G$040010:
                    *P22:15,*V2LON," 8",*HOFF,".  ",G$040011
.
S0050000  CALL      SEL0000
S0050010  BRANCH    MMENUOPT,D0040000,S0050020,S0050030,S0050040:
                           S0050050,S0050060,S0050070,S0050080,S0050090
          BEEP
          GOTO      S0050000
.
S0050020
          MOVE      "IBASIN36",PROGNAME
          CALL      PROG0000
          GOTO      D0050000
.
S0050030
          MOVE      "IBASIN37",PROGNAME
          CALL      PROG0000
          GOTO      D0050000
.
S0050040
          MOVE      "IBASIN38",PROGNAME
          CALL      PROG0000
          GOTO      D0050000
.
S0050050
          MOVE      "IBASIN60",PROGNAME
          CALL      PROG0000
          GOTO      D0050000
.
S0050060
          MOVE      "IBASIN42",PROGNAME
          CALL      PROG0000
          GOTO      D0050000
.
S0050070
          MOVE      "IBASIN77",PROGNAME
          CALL      PROG0000
          GOTO      D0050000
.
S0050080
          MOVE      "IBASIN81",PROGNAME
          CALL      PROG0000
          GOTO      D0050000
.
S0050090
          MOVE      "IBASPOOL",PROGNAME
          CALL      PROG0000
          GOTO      D0050000
.
+
D0060000  MOVE      "12",BOXSIZE
          CALL      BOX10000
          MOVE      "5",PERIOD
          MOVE      SP6,IDDD
          DISPLAY   *P31:04,*V2LON,*ULON,G$050000,*HOFF:
                    *P25:06,*V2LON," 0",*HOFF,". ",G$050002:
                    *P25:07,*V2LON," 1",*HOFF,". ",G$050003:
                    *P25:08,*V2LON," 2",*HOFF,". ",G$050004:
                    *P25:09,*V2LON," 3",*HOFF,". ",G$050005:
                    *P25:10,*V2LON," 4",*HOFF,". ",G$050006:
                    *P25:11,*V2LON," 5",*HOFF,". ",G$050007:
                    *P25:12,*V2LON," 6",*HOFF,". ",G$050008
.
S0060000  CALL      SEL0000
S0060010  BRANCH    MMENUOPT,D0010000,S0060020,S0060030,S0060040:
                           S0060050,S0060060,S0060070
          BEEP
          GOTO      S0060000
.
S0060020
          MOVE      "IBASUB14",PROGNAME
          CALL      PROG0000
          GOTO      D0060000
.
S0060030
          MOVE      "IBASUB15",PROGNAME
          CALL      PROG0000
          GOTO      D0060000
.
S0060040
          MOVE      "IBASUB17",PROGNAME
          CALL      PROG0000
          GOTO      D0060000
.
S0060050
          MOVE      "IBASUB18",PROGNAME
          CALL      PROG0000
          GOTO      D0060000
.
S0060060
          MOVE      "IBASUB19",PROGNAME
          CALL      PROG0000
          GOTO      D0060000
.
S0060070
          MOVE      "IBASUB16",PROGNAME
          CALL      PROG0000
          GOTO      D0060000
.
+
D0070000  MOVE      "20",BOXSIZE
          CALL      BOX20000
          MOVE      "6",PERIOD
          MOVE      SP6,IDDD
          DISPLAY   *P26:04,*V2LON,*ULON,G$060000,*HOFF:
                    *P09:05,*V2LON,*ULON,G$060001,*HOFF:
                    *P05:06,*V2LON," 0",*HOFF,". ",G$060002:
                    *P05:07,*V2LON," 1",*HOFF,". ",G$060003:
                    *P05:08,*V2LON," 2",*HOFF,". ",G$060004:
                    *P05:09,*V2LON," 3",*HOFF,". ",G$060005:
                    *P05:10,*V2LON," 4",*HOFF,". ",G$060006:
                    *P05:11,*V2LON," 5",*HOFF,". ",G$060007:
                    *P05:12,*V2LON," 6",*HOFF,". ",G$060008:
                    *P05:13,*V2LON," 7",*HOFF,". ",G$060009:
                    *P09:14,*V2LON,*ULON,G$060010,*HOFF:
                    *P05:15,*V2LON," 8",*HOFF,". ",G$060011:
                    *P05:16,*V2LON," 9",*HOFF,". ",G$060012:
                    *P05:17,*V2LON,"10",*HOFF,". ",G$060013:
                    *P05:18,*V2LON,"11",*HOFF,". ",G$060014:
                    *P05:19,*V2LON,"12",*HOFF,". ",G$060015:
                    *P05:20,*V2LON,"13",*HOFF,". ",G$060016:
                    *P05:21,*V2LON,"14",*HOFF,". ",G$060017:
                    *P05:22,*V2LON,"15",*HOFF,". ",G$060018:
                    *P47:05,*V2LON,*ULON,G$060101,*HOFF:
                    *P43:06,*V2LON,"16",*HOFF,". ",G$060102:
                    *P43:07,*V2LON,"17",*HOFF,". ",G$060103:
                    *P43:08,*V2LON,"18",*HOFF,". ",G$060104:
                    *P43:09,*V2LON,"19",*HOFF,". ",G$060105:
                    *P43:10,*V2LON,"20",*HOFF,". ",G$060106:
                    *P43:11,*V2LON,"21",*HOFF,". ",G$060107:
                    *P43:12,*V2LON,"22",*HOFF,". ",G$060108:
                    *P43:13,*V2LON,"23",*HOFF,". ",G$060109:
                    *P43:14,*V2LON,"24",*HOFF,". ",G$060110:
                    *P47:17,*V2LON,*ULON,G$060113,*HOFF:
                    *P43:18,*V2LON,"25",*HOFF,". ",G$060114:
                    *P43:19,*V2LON,"26",*HOFF,". ",G$060115:
                    *P43:20,*V2LON,"27",*HOFF,". ",G$060116:
                    *P43:22,*V2LON,"28",*HOFF,". ",G$060118
.
S0070000  CALL      SEL0000
S0070010  BRANCH    MMENUOPT,D0010000,S0070020,S0070030,S0070040:
                           S0070050,S0070060,S0070070,S0070080,S0070090:
                           S0070100,S0070110,S0070120,S0070130,S0070140:
                           S0070150,S0070160,S0070170,S0070180,S0070190:
                           S0070200,S0070210,S0070220,S0070230,S0070240:
                           S0070250,S0070260,S0070270,S0070280,S0070290
          BEEP
          GOTO      S0070000
.
S0070020
          MOVE      "IBASIN80",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070030
          MOVE      "IBASIN82",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070040
          MOVE      "IBASIN83",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070050
          MOVE      "IBASIN85",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070060
          MOVE      "IBASIN84",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070070
          MOVE      "IBASIN87",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070080
          MOVE      "IBASUB28",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070090
          MOVE      "IBASIN90",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070100
          MOVE      "IBASIN91",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070110
          MOVE      "IBASIN92",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070120
          MOVE      "IBASIN94",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070130
          MOVE      "IBASIN95",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070140
          MOVE      "IBASIN62",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070150
          MOVE      "IBASUB38",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070160
          MOVE      "IBASUB39",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070170
          MOVE      "IBASIN71",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070180
          MOVE      "IBASIN73",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070190
          MOVE      "IBASIN76",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070200
          MOVE      "IBASIN75",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070210
          MOVE      "IBAAPS61",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070220
          MOVE      "IBASIN74",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070230
          MOVE      "IBASIN77",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070240
          MOVE      "IBASIN78",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070250
          MOVE      "IBASIN72",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070260
          MOVE      "IBASUB11",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070270
          MOVE      "IBASUB10",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070280
          MOVE      "IBASUB12",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
S0070290
          MOVE      "IBASPOOL",PROGNAME
          CALL      PROG0000
          GOTO      D0070000
.
+
D0080000  MOVE      "20",BOXSIZE
          CALL      BOX20000
          MOVE      "7",PERIOD
          MOVE      SP6,IDDD
          DISPLAY   *P31:04,*V2LON,*ULON,G$070000,*HOFF:
                    *P08:06,*V2LON,*ULON,G$070002,*HOFF:
                    *P03:07,*V2LON," 0",*HOFF,". ",G$070003:
                    *P03:08,*V2LON," 1",*HOFF,". ",G$070004:
                    *P03:09,*V2LON," 2",*HOFF,". ",G$070005:
                    *P03:10,*V2LON," 3",*HOFF,". ",G$070006:
                    *P03:11,*V2LON," 4",*HOFF,". ",G$070007:
                    *P03:12,*V2LON," 5",*HOFF,". ",G$070008:
                    *P03:13,*V2LON," 6",*HOFF,". ",G$070009:
                    *P03:14,*V2LON," 7",*HOFF,". ",G$070010:
                    *P03:15,*V2LON," 8",*HOFF,". ",G$070011:
                    *P03:16,*V2LON," 9",*HOFF,". ",G$070012:
                    *P03:17,*V2LON,"10",*HOFF,". ",G$070013:
                    *P03:18,*V2LON,"11",*HOFF,". ",G$070014:
                    *P03:19,*V2LON,"12",*HOFF,". ",G$070015:
                    *P43:07,*V2LON,"13",*HOFF,". ",G$070103:
                    *P43:08,*V2LON,"14",*HOFF,". ",G$070104:
                    *P47:11,*V2LON,*ULON,G$070107,*HOFF:
                    *P43:13,*V2LON,"15",*HOFF,". ",G$070109:
                    *P43:14,*V2LON,"16",*HOFF,". ",G$070110:
                    *P43:15,*V2LON,"17",*HOFF,". ",G$070111:
                    *P43:16,*V2LON,"18",*HOFF,". ",G$070112:
                    *P43:17,*V2LON,"19",*HOFF,". ",G$070113:
                    *P43:18,*V2LON,"20",*HOFF,". ",G$070114:
                    *P43:20,*V2LON,"21",*HOFF,". ",G$070116
.
S0080000  CALL      SEL0000
S0080010  BRANCH    MMENUOPT,D0010000,S0080020,S0080030,S0080040:
                           S0080050,S0080060,S0080070,S0080080,S0080090:
                           S0080100,S0080110,S0080120,S0080130,S0080140:
                           S0080150,S0080160,S0080170,S0080180,S0080190:
                           S0080200,S0080210,S0080220
          BEEP
          GOTO      S0080000
.
S0080020
          MOVE      "IBASUB32",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
S0080030
          MOVE      "IBASUB31",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
S0080040
          MOVE      "IBASUB22",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
S0080050
          MOVE      "IBASUB36",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
S0080060
          MOVE      "IBASUB37",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
S0080070
          MOVE      "IBASUB24",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
S0080080
          MOVE      "IBASUB30",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
S0080090
          GOTO      D0090000
.
S0080100
          MOVE      "IBASIN88",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
S0080110
          MOVE      "IBASUB04",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
S0080120
          MOVE      "IBASUB41",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
S0080130
          MOVE      "IBASUB33",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
S0080140
          MOVE      "IBASUB43",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
S0080150
          MOVE      "IBASUB27",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
S0080160
          MOVE      "IBASUB32",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
S0080170
          MOVE      "IBASUB31",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
S0080180
          MOVE      "IBASUB22",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
S0080190
          MOVE      "IBASUB25",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
S0080200
          MOVE      "IBASUB23",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
S0080210
          MOVE      "IBASIN81",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
S0080220
          MOVE      "IBASPOOL",PROGNAME
          CALL      PROG0000
          GOTO      D0080000
.
+
D0090000  MOVE      "9",BOXSIZE
          CALL      BOX10000
          MOVE      "8",PERIOD
          MOVE      SP6,IDDD
          DISPLAY   *P24:04,*V2LON,*ULON,G$080000,*HOFF:
                    *P22:07,*V2LON," 0",*HOFF," = ",G$080003:
                    *P22:08,*V2LON," 1",*HOFF," = ",G$080004:
                    *P22:09,*V2LON," 2",*HOFF," = ",G$080005
.
S0090000  CALL      SEL0000
S0090010  BRANCH    MMENUOPT,D0080000,S0090020,S0090030
          BEEP
          GOTO      S0090000
.
S0090020
          MOVE      "IBASUB34",PROGNAME
          CALL      PROG0000
          GOTO      D0090000
.
S0090030
          MOVE      "IBASUB50",PROGNAME
          CALL      PROG0000
          GOTO      D0090000
.
+
D0100000  MOVE      "14",BOXSIZE
          CALL      BOX10000
          MOVE      "9",PERIOD
          MOVE      SP6,IDDD
          DISPLAY   *P31:04,*V2LON,*ULON,G$090000,*HOFF:
                    *P22:05,G$090001:
                    *P25:06,*V2LON," 0",*HOFF,". ",G$090002:
                    *P25:07,*V2LON," 1",*HOFF,". ",G$090003:
                    *P25:08,*V2LON," 2",*HOFF,". ",G$090004:
                    *P25:09,*V2LON," 3",*HOFF,". ",G$090005:
                    *P25:10,*V2LON," 4",*HOFF,". ",G$090006:
                    *P25:11,*V2LON," 5",*HOFF,". ",G$090007:
                    *P25:12,*V2LON," 6",*HOFF,". ",G$090008:
                    *P25:13,*V2LON," 7",*HOFF,". ",G$090009:
                    *P25:14,*V2LON," 8",*HOFF,". ",G$090010:
                    *P25:15,*V2LON," 9",*HOFF,". ",G$090011
.
S0100000  CALL      SEL0000
S0100010  BRANCH    MMENUOPT,D0010000,S0100020,S0100030,S0100040:
                           S0100050,S0100060,S0100070,S0100080,S0100090:
                           S0100100
          BEEP
          GOTO      S0100000
.
S0100020
          MOVE      "IBASIN98",PROGNAME
          CALL      PROG0000
          GOTO      D0100000
.
S0100030
          MOVE      "IBASIN39",PROGNAME
          CALL      PROG0000
          GOTO      D0100000
.
S0100040
          MOVE      "IBASIN65",PROGNAME
          CALL      PROG0000
          GOTO      D0100000
.
S0100050
          MOVE      "IBASIN96",PROGNAME
          CALL      PROG0000
          GOTO      D0100000
.
S0100060
          MOVE      "IBASIN68",PROGNAME
          CALL      PROG0000
          GOTO      D0100000
.
S0100070
          MOVE      "IBASUB35",PROGNAME
          CALL      PROG0000
          GOTO      D0100000
.
S0100080
          MOVE      "IBASIN58",PROGNAME
          CALL      PROG0000
          GOTO      D0100000
.
S0100090
          MOVE      "IBASIN35",PROGNAME
          CALL      PROG0000
          GOTO      D0100000
.
S0100100
          MOVE      "IBASUB96",PROGNAME
          CALL      PROG0000
          GOTO      D0100000
.
+
.*************************************************************************
.*                              SEL0000                                  *
.*                        Selection procedure                            *
.*************************************************************************
SEL0000  CALL       CHKMS000                * Check for a User Message
.
         MOVE       BOXSIZE TO CVERT
         ADD        THREE TO CVERT
         MOVE       "47" TO CCOL
         DISPLAY    *P31:CVERT," Please select:   "
         CALL       MENUKEY
         ADD        ONE,CMENUOPT
         MOVE       CMENUOPT,MMENUOPT
SEL9999  RETURN
+
.*************************************************************************
.*                             UNIX0000                                  *
.*                      Execute a UNIX Command                           *
.*************************************************************************
.
UNIX0000  DISPLAY   *ES
          EXECUTE   UNIXNAME,TASKID
          KEYIN     *P1:24,*N,*EL,"Press <ENTER> to return to menu:":
                    *P34:24,ANS
          EXECUTE   "clear",TASKID
UNIX9999  RETURN
.
.*************************************************************************
.*                              PROG0000                                 *
.*                check program for payroll, not allowed here            *
.*************************************************************************
.
PROG0000  GOTO      CHECKPW
.
+
.***********************************************************************
.*                               NOCLEAR                               *
.*                      inadequate security clearance                  *
.***********************************************************************
NOCLEAR DISPLAY    *P1:3,*EF,*P15:6,*B,*V2LON:
                   "*** Clearance Level Inadequate ***"
.
        KEYIN      *P1:24,*EL,"Hit ",*V2LON,"<RETURN>",*HOFF:
                              " to continue ",*EOFF,ANS;
        RETURN
.
+*************************************************************************
.*                              PFRQ0000                                 *
.*                        Keyin pay frequency                            *
.*************************************************************************
.
PFRQ0000  DISPLAY   *P21:18,"****************************************":
                    *P21:19,"*                                      *":
                    *P21:20,"*                                      *":
                    *P21:21,"*                                      *":
                    *P21:22,"*                                      *":
                    *P21:23,"*                                      *":
                    *P21:24,"****************************************"
PFRQ0020  KEYIN     *P26:20,"Enter pay frequency : ",*V2LON,*DV,UNDLN1,*HOFF:
                    *P24:22,"1=Weekly  2=Fortnightly  3=Monthly":
                    *P48:20,*V2LON,CPBS,*P48:20,*DV,CPBS;
          COMPARE   ZERO,CPBS
          GOTO      PFRQ9000 IF EQUAL
          BRANCH    CPBS,PFRQ9990,PFRQ9990,PFRQ9990
          GOTO      PFRQ0020
.
PFRQ9000  MOVE      ONE TO EXIT
          GOTO      PFRQ9999
PFRQ9990  MOVE      ZERO TO EXIT
PFRQ9999  RETURN
.
+*************************************************************************
.*                              SITEPASS                                 *
.*               Keyin site & password for OUT, MAM & RAD                *
.*************************************************************************
.
SITE0000  MOVE      ZERO,NOPASSWD
          MATCH     SP6,OSTSITE
          GOTO      SITE0010 IF EQUAL
          ENDSET    OSTSITE
          APPEND    SP6,OSTSITE
          RESET     OSTSITE
          MOVE      ONE,NOPASSWD
          GOTO      SITE0020
.
SITE0010  DISPLAY   *P21:18,"****************************************":
                    *P21:19,"*                                      *":
                    *P21:20,"*                                      *":
                    *P21:21,"*                                      *":
                    *P21:22,"*                                      *":
                    *P21:23,"*                                      *":
                    *P21:24,"****************************************"
          KEYIN     *P26:20,"Enter Site Code     : ",*V2LON,*DV,UNDLN6,*HOFF:
                    *P48:20,*V2LON,OSTSITE,*P48:20,*DV,OSTSITE;
          ENDSET    OSTSITE
          APPEND    SP6,OSTSITE
          RESET     OSTSITE
          MATCH     SP6,OSTSITE
          GOTO      SITE9100 IF EQUAL
.
SITE0020  MOVE      OSTSITE,KEY6
          CALL      RDSITA1
          BRANCH    OVRCD OF SITE9000
.
          MATCH     SP8,OSTPASS
          GOTO      SITE8000 IF EQUAL
          BRANCH    NOPASSWD,SITE8000
.
          KEYIN     *P26:22,*EOFF,"Enter Site Password  : ",PASSCHK;
          ENDSET    PASSCHK
          APPEND    SP8,PASSCHK
          RESET     PASSCHK
          MATCH     PASSCHK,OSTPASS
          GOTO      SITE9000 IF NOT EQUAL
.
SITE8000  MOVE      OSTSITE,IDDD               ***** COMMON
          MOVE      OSTFILE,UID                ***** COMMON SITE FILE PREFIX
          PACK      CONAME WITH OSTDESC,SP20
          MOVE      CONAME,CNAME
          GOTO      SITE9990
.
SITE9000  BEEP
SITE9100  MOVE      ONE TO EXIT
          GOTO      SITE9999
SITE9990  MOVE      ZERO TO EXIT
SITE9999  RETURN
+
          INC       IBAPRINT
          INC       IBAMNCOM
          INC       IBAWDINC
          INC       CHEKMESS
.
          INC       IBAIMNIO/INC
          INC       OUTSITIO/INC
          INC       IBAPRNIO/INC
          INC       IBAPORIO/INC       **** PORT SCANNING
          INC       IBASECIO/INC       
          INC       IBASYSIO/INC       *** IO FOR SYSTEM AUDIT
.
          INC       STD001IO
