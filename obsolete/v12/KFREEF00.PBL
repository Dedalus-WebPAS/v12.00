.
.***************************************************************************
.*  KFREEF00  :  Keyin a Free Format field                                 *
.*  Para's    :  KEYFIELD      default value                               *
.***************************************************************************
KFREEF00  MOVE      KEYFIELD,DIM80          * move to temp var
          SFORMAT   KEYFIELD,SCPSLEN        * format to desired length
          MOVE      DIM80,KEYFIELD          * move temp var to work var
.
          COMPARE   ONE,YESDFLTS
          GOTO      KFREEF10 IF NOT EQUAL   * no defaults
.
. keyin with defaults
.
          MATCH     SP70,KEYFIELD
          GOTO      KFREEF10 IF EQUAL       * no value so display underlines
.
          KEYIN     *PCCOL:CVERT,*DV,KEYFIELD:
                    *PCCOL:CVERT,*V2LON,*RV,KEYFIELD:
                    *PCCOL:CVERT,*DV,KEYFIELD;
          GOTO      KFREEF50
.
. keyin with no default
.
KFREEF10  PACK      KEYFIELD,SP70,SP70
          KEYIN     *PCCOL:CVERT,*V2LON,KEYFIELD:
                    *PCCOL:CVERT,*DV,KEYFIELD;
.
KFREEF50  ENDSET    KEYFIELD
          APPEND    SP70,KEYFIELD
          APPEND    SP70,KEYFIELD
          RESET     KEYFIELD
.
          MOVE      ZERO,EXIT
          MATCH     SP70,KEYFIELD
          GOTO      KFREEF99 IF NOT EQUAL
.
          MOVE      ONE,EXIT                * exit if nothing entered for title
          BRANCH    KYNTITL,KFREEF99        * keyining the title
          BRANCH    SCPSMAN,KFREEF00        * field is mandatory
          MOVE      ZERO,EXIT
.
KFREEF99  RETURN
+
