.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.00.03  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
. VF.00.02  20.12.1999 Charles Handaya
.           Fix Y2K of Audit Files Date (CCYYMMDD)
. VF.00.01  02.09.1999 Sandra Barcham
.           Add in Creditor Keyword Search
.           srf 631485
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBAAMS44
.   Function      :   Asset Insurance Report                  
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       AMSCODFD/INC
          INC       AMSINSFD/INC
          INC       AMSLEAFD/INC
          INC       AMSLOCFD/INC
          INC       AMSMASFD/INC
          INC       AMSREGFD/INC
          INC       AMSREPDF    
          INC       APSMASFD/INC
          INC       APSMXRFD/INC
.=========================
.Local Variable Definition
.-------------------------
FROMREG   DIM      45 * Scr 00 Fld     1
TOREG     DIM      45 * Scr 00 Fld     2
FROMTYP   DIM      45 * Scr 00 Fld     3
TOTYP     DIM      45 * Scr 00 Fld     4
FROMDPT   DIM      45 * Scr 00 Fld     5
TODPT     DIM      45 * Scr 00 Fld     6
FROMSOF   DIM      45 * Scr 00 Fld     7
TOSOF     DIM      45 * Scr 00 Fld     8
FROMDTY   DIM      45 * Scr 00 Fld     9
TODTY     DIM      45 * Scr 00 Fld    10
FROMBLD   DIM      45 * Scr 00 Fld    11
TOBLD     DIM      45 * Scr 00 Fld    12
FROMLOC   DIM      45 * Scr 00 Fld    13
TOLOC     DIM      45 * Scr 00 Fld    14
FROMDDT   DIM      10 * Scr 00 Fld    15
TODDT     DIM      10 * Scr 00 Fld    16
FROMAQD   DIM      10 * Scr 00 Fld    17
TOAQD     DIM      10 * Scr 00 Fld    18
FROMRDT   DIM      10 * Scr 00 Fld    19
TORDT     DIM      10 * Scr 00 Fld    20
FROMLSD   DIM      10 * Scr 00 Fld    21
TOLSD     DIM      10 * Scr 00 Fld    22
FROMLED   DIM      10 * Scr 00 Fld    23
TOLED     DIM      10 * Scr 00 Fld    24
FROMIRD   DIM      10 * Scr 00 Fld    25
TOIRD     DIM      10 * Scr 00 Fld    26
FROMLCM   DIM      45 * Scr 00 Fld    27
TOLCM     DIM      45 * Scr 00 Fld    28
FROMICM   DIM      45 * Scr 00 Fld    29
TOICM     DIM      45 * Scr 00 Fld    30
FROMASS   DIM      45 * Scr 00 Fld    31
TOASS     DIM      45 * Scr 00 Fld    32
REPTSEQ   FORM      2 * Scr 00 Fld    40
RSEQDESC  DIM      35 * Scr 00 Fld    41
ASATDATE  DIM       8 * Scr 00 Fld    42
FROMUC1   DIM      45 * Scr 00 Fld    43
TOUC1     DIM      45 * Scr 00 Fld    44
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBAAMS44"
PRGNAM    INIT      "Asset Insurance Report                  "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "    3",AUDTSECT
          MOVE      " 12",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening amsaudin";
            OPEN      AMSAUDIN,"amsaudin"
          ENDIF
          MOVE      "    3",AUDTSECT
          MOVE      " 11",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening amsaudle";
            OPEN      AMSAUDLE,"amsaudle"
          ENDIF
          MOVE      "    3",AUDTSECT
          MOVE      " 10",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening amsaudma";
            OPEN      AMSAUDMA,"amsaudma"
          ENDIF
          DISPLAY   *P56:24,"Opening amscodaf";
          OPEN      AMSCODA1,"amscodaf"
          DISPLAY   *P56:24,"Opening amscodaf";
          OPEN      AMSCODA2,"amscodaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA1,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA2,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA3,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsinsaf";
          OPEN      AMSINSA4,"amsinsaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA1,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA2,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA3,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA4,"amsleaaf"
          DISPLAY   *P56:24,"Opening amsleaaf";
          OPEN      AMSLEAA5,"amsleaaf"
          DISPLAY   *P56:24,"Opening amslocaf";
          OPEN      AMSLOCA1,"amslocaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA1,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA2,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA3,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA4,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA5,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA6,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA7,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsmasaf";
          OPEN      AMSMASA8,"amsmasaf"
          DISPLAY   *P56:24,"Opening amsregaf";
          OPEN      AMSREGA1,"amsregaf"
          MOVE      "   51",AUDTSECT
          MOVE      " 48",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening apsaudma";
            OPEN      APSAUDMA,"apsaudma"
          ENDIF
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA1,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA2,"apsmxraf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Assets Insurance Report Options    
          ENDIF
          RETURN
.--------------------------------
. Screen - Assets Insurance Report Options    
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   50",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      DEFPAR00
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Assets Insurance Report Options    
.-------------------------------------------------------
CF00L000
          MOVE      SP70,FROMREG 
          MOVE      SP70,FROMTYP 
          MOVE      SP70,FROMDPT 
          MOVE      SP70,FROMSOF 
          MOVE      SP70,FROMDTY 
          MOVE      SP70,FROMBLD 
          MOVE      SP70,FROMLOC 
          MOVE      SP70,FROMDDT 
          MOVE      SP70,FROMAQD 
          MOVE      SP70,FROMRDT 
          MOVE      SP70,FROMLSD 
          MOVE      SP70,FROMLED 
          MOVE      SP70,FROMIRD 
          MOVE      SP70,FROMLCM 
          MOVE      SP70,FROMICM 
          MOVE      SP70,FROMASS 
          MOVE      ZERO,REPTSEQ 
          MOVE      SP70,ASATDATE
          MOVE      SP70,FROMUC1 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Assets Insurance Report Options    
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Assets Insurance Report Options    
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Assets Insurance Report Options    
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Assets Insurance Report Options    
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Assets Insurance Report Options    
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L101,PS00L102,PS00L103,PS00L104:
                            PS00L105,PS00L106,PS00L107,PS00L108:
                            PS00L109,PS00L110,PS00L111,PS00L112:
                            PS00L113,PS00L114,PS00L115,PS00L116:
                            PS00L117,PS00L118,PS00L119,PS00L120:
                            PS00L121,PS00L122,PS00L123,PS00L124:
                            PS00L125,PS00L126,PS00L127,PS00L128:
                            PS00L129,PS00L130,PS00L131,PS00L132:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L133:
                            PS00L134,PS00L135,PS00L136,PS00L137:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999
          GOTO     PS00L999
.
PS00L101
          MOVE      FROMREG,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      TOREG,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      FROMTYP,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      TOTYP,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      FROMDPT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      TODPT,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      FROMSOF,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      TOSOF,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      FROMDTY,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      TODTY,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      FROMBLD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      TOBLD,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      FROMLOC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      TOLOC,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      FROMDDT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      TODDT,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          MOVE      FROMAQD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      TOAQD,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      FROMRDT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE      TORDT,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          MOVE      FROMLSD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      TOLSD,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          MOVE      FROMLED,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          MOVE      TOLED,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          MOVE      FROMIRD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L126
          MOVE      TOIRD,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L127
          MOVE      FROMLCM,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L128
          MOVE      TOLCM,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L129
          MOVE      FROMICM,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L130
          MOVE      TOICM,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L131
          MOVE      FROMASS,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L132
          MOVE      TOASS,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L133
          MOVE      REPTSEQ,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L134
          MOVE      RSEQDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L135
          UNPACK    ASATDATE,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L136
          MOVE      FROMUC1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L137
          MOVE      TOUC1,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Assets Insurance Report Options    
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L101,SF00L006,SF00L102,SF00L006:
                            SF00L103,SF00L006,SF00L104,SF00L006:
                            SF00L105,SF00L006,SF00L106,SF00L006:
                            SF00L107,SF00L006,SF00L108,SF00L006:
                            SF00L109,SF00L006,SF00L110,SF00L006:
                            SF00L111,SF00L006,SF00L112,SF00L006:
                            SF00L113,SF00L006,SF00L114,SF00L006:
                            SF00L115,SF00L006,SF00L116,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L006,SF00L006,SF00L006,SF00L117:
                            SF00L006,SF00L118,SF00L119,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L006,SF00L006,SF00L120,SF00L121:
                            SF00L122
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L101,SF00L020,SF00L102,SF00L020:
                            SF00L103,SF00L020,SF00L104,SF00L020:
                            SF00L105,SF00L020,SF00L106,SF00L020:
                            SF00L107,SF00L020,SF00L108,SF00L020:
                            SF00L109,SF00L020,SF00L110,SF00L020:
                            SF00L111,SF00L020,SF00L112,SF00L020:
                            SF00L113,SF00L020,SF00L114,SF00L020:
                            SF00L115,SF00L020,SF00L116,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L117:
                            SF00L020,SF00L118,SF00L119,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOREG   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RREG0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L101
            ENDIF
            BRANCH    EXIT,SF00L101,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMREG,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOREG,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L102
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOTYP   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RTYP0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L102
            ENDIF
            BRANCH    EXIT,SF00L102,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMTYP,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOTYP,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L103
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TODPT   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RDPT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L103
            ENDIF
            BRANCH    EXIT,SF00L103,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMDPT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TODPT,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L104
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOSOF   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RSOF0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L104
            ENDIF
            BRANCH    EXIT,SF00L104,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMSOF,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOSOF,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L105
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TODTY   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RDTY0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L105
            ENDIF
            BRANCH    EXIT,SF00L105,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMDTY,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TODTY,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L106
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOBLD   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RBLD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L106
            ENDIF
            BRANCH    EXIT,SF00L106,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMBLD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOBLD,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L107
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOLOC   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RLOC0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L107
            ENDIF
            BRANCH    EXIT,SF00L107,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMLOC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOLOC,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L108
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TODDT   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RDDT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L108
            ENDIF
            BRANCH    EXIT,SF00L108,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMDDT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TODDT,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L109
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOAQD   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RAQD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L109
            ENDIF
            BRANCH    EXIT,SF00L109,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMAQD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOAQD,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L110
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TORDT   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RRDT0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L110
            ENDIF
            BRANCH    EXIT,SF00L110,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMRDT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TORDT,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L111
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOLSD   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RLSD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L111
            ENDIF
            BRANCH    EXIT,SF00L111,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMLSD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOLSD,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L112
.
.
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOLED   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RLED0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L112
            ENDIF
            BRANCH    EXIT,SF00L112,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMLED,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOLED,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L113
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOIRD   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RIRD0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L113
            ENDIF
            BRANCH    EXIT,SF00L113,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMIRD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOIRD,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L114
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOLCM   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RLCM0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L114
            ENDIF
            BRANCH    EXIT,SF00L114,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMLCM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOLCM,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L115
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOICM   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RICM0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L115
            ENDIF
            BRANCH    EXIT,SF00L115,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMICM,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOICM,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L116
.
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOASS   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RASS0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L116
            ENDIF
            BRANCH    EXIT,SF00L116,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMASS,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOASS,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L117
.
.
          MOVE      "   41",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,RSEQDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KRSEQ000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L117
            ENDIF
            BRANCH    EXIT,SF00L117,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      REPTSEQ,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   41",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      RSEQDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L118
          CALL      DATECURR
          CALL     SELECTED
          CALL      KEYDATE
          PACK      ASATDATE,CCENT,CYEAR,CMON,CDAY          
          UNPACK    ASATDATE,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L119
.
.
          MOVE      "   44",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOUC1   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RUC10000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L119
            ENDIF
            BRANCH    EXIT,SF00L119,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMUC1,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   44",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOUC1,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L120
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L121
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L122
          CALL      REPT0000
          MOVE      ZERO,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.@@@@@ Function Restart Point @@@@@
.---------------------------------------------
. Default Report Range Values
.---------------------------------------------
DEFPAR00  MOVE     SP70,STRREG
          MOVE     "~~~",ENDREG
          MOVE     SP70,STRASS
          MOVE     "~~~~~~~~~~~~",ENDASS
.
          MOVE     SP70,STRUC1
          MOVE     "~~~",ENDUC1
          MOVE     SP70,STRTYP
          MOVE     "~~~",ENDTYP
          MOVE     SP70,STRSOF
          MOVE     "~~~",ENDSOF
          MOVE     SP70,STRDPT
          MOVE     "~~~",ENDDPT
          MOVE     SP70,STRDTY
          MOVE     "~~~",ENDDTY
          MOVE     SP70,STRBLD
          MOVE     "~~~",ENDBLD
.
          MOVE     SP70,STRLOC
          MOVE     "~~~~~~",ENDLOC
.
          MOVE     SP70,STRDDT
          MOVE     "99999999",ENDDDT
          MOVE     SP70,STRAQD
          MOVE     "99999999",ENDAQD
          MOVE     SP70,STRRDT
          MOVE     "99999999",ENDRDT
.
          MOVE     SP70,STRLSD
          MOVE     "99999999",ENDLSD
          MOVE     SP70,STRLED
          MOVE     "99999999",ENDLED
          MOVE     SP70,STRIRD
          MOVE     "99999999",ENDIRD
.
          MOVE     SP70,STRLCM
          MOVE     "~~~~~",ENDLCM
          MOVE     SP70,STRICM
          MOVE     "~~~~~",ENDICM
.
          MOVE     "Start ",FROMREG
          MOVE     "Finish",TOREG
          MOVE     "Start ",FROMASS
          MOVE     "Finish",TOASS
          MOVE     "Start ",FROMTYP
          MOVE     "Finish",TOTYP
          MOVE     "Start ",FROMUC1
          MOVE     "Finish",TOUC1
          MOVE     "Start ",FROMDPT
          MOVE     "Finish",TODPT
          MOVE     "Start ",FROMSOF
          MOVE     "Finish",TOSOF
          MOVE     "Start ",FROMDTY
          MOVE     "Finish",TODTY
          MOVE     "Start ",FROMBLD
          MOVE     "Finish",TOBLD
          MOVE     "Start ",FROMLOC
          MOVE     "Finish",TOLOC
          MOVE     "Start ",FROMDDT
          MOVE     "Finish",TODDT
          MOVE     "Start ",FROMAQD
          MOVE     "Finish",TOAQD
          MOVE     "Start ",FROMRDT
          MOVE     "Finish",TORDT
          MOVE     "Start ",FROMLSD
          MOVE     "Finish",TOLSD
          MOVE     "Start ",FROMLED
          MOVE     "Finish",TOLED
          MOVE     "Start ",FROMIRD
          MOVE     "Finish",TOIRD
          MOVE     "Start ",FROMLCM
          MOVE     "Finish",TOLCM
          MOVE     "Start ",FROMICM
          MOVE     "Finish",TOICM
          MOVE     ZERO,REPTSEQ
          MOVE     "Register/Asset",RSEQDESC
          PACK     ASATDATE,CCC,CYY,CMM,CDD
          REP      " 0",ASATDATE
          RETURN
DATECURR  MOVE      CDD,CDAY
          MOVE      CMM,CMON
          MOVE      CYY,CYEAR
          MOVE      CCC,CCENT
          REP       " 0",CCENT
          REP       " 0",CYEAR
          REP       " 0",CMON
          REP       " 0",CDAY
          RETURN
RREG0000   MOVE     "    1",FLDID
           CALL     GETPOSIT
           CALL     KAMREA00
           BRANCH   EXIT,RREG0100,RREG0999
           MOVE     AMREREG,STRREG
           PACK     FROMREG,AMREREG,SP1,AMREDES
           GOTO     RREG0140
RREG0100   MOVE     "Start             ",FROMREG
           MOVE     SP70,STRREG
.
RREG0140   MOVE     FROMREG,VAR
           CALL     DISPITEM
.
RREG0150   MOVE     "    2",FLDID
           CALL     GETPOSIT
           CALL     KAMREA00
           BRANCH   EXIT,RREG0200,RREG0999
           MOVE     AMREREG,ENDREG
           PACK     TOREG,AMREREG,SP1,AMREDES
           MATCH    STRREG,ENDREG
           GOTO     RREG0999 IF EQUAL
           GOTO     RREG0999 IF NOT LESS
           BEEP
           MOVE     "To Register Must Be > From Register - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RREG0000
.
RREG0200   MOVE     "Finish             ",TOREG
           MOVE     "~~",ENDREG
.
RREG0999   MOVE     "    1",FLDID
           CALL     GETPOSIT
           RETURN
RTYP0000   MOVE     "    3",FLDID
           CALL     GETPOSIT
           MOVE     "AT",AMCDCAT
           CALL     KAMCDA00
           BRANCH   EXIT,RTYP0100,RTYP0999
           MOVE     AMCDCOD,STRTYP
           PACK     FROMTYP,AMCDCOD,SP1,AMCDDES
           GOTO     RTYP0140
.
RTYP0100   MOVE     "Start             ",FROMTYP
           MOVE     SP70,STRTYP
.
RTYP0140   MOVE     FROMTYP,VAR
           CALL     DISPITEM
.
RTYP0150   MOVE     "    4",FLDID
           CALL     GETPOSIT
           MOVE     "AT",AMCDCAT
           CALL     KAMCDA00
           BRANCH   EXIT,RTYP0200,RTYP0999
           MOVE     AMCDCOD,ENDTYP
           PACK     TOTYP,AMCDCOD,SP1,AMCDDES
           MATCH    STRTYP,ENDTYP
           GOTO     RTYP0999 IF EQUAL
           GOTO     RTYP0999 IF NOT LESS
           BEEP
           MOVE     "To Asset Type Must Be > From Asset Type - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RTYP0000
.
RTYP0200   MOVE     "Finish             ",TOTYP
           MOVE     "~~~",ENDTYP
.
RTYP0999   MOVE     "    3",FLDID
           CALL     GETPOSIT
           RETURN
RDPT0000   MOVE     "    5",FLDID
           CALL     GETPOSIT
           MOVE     "DP",AMCDCAT
           CALL     KAMCDA00
           BRANCH   EXIT,RDPT0100,RDPT0999
           MOVE     AMCDCOD,STRDPT
           PACK     FROMDPT,AMCDCOD,SP1,AMCDDES
           GOTO     RDPT0140
.
RDPT0100   MOVE     "Start             ",FROMDPT
           MOVE     SP70,STRDPT
.
RDPT0140   MOVE     FROMDPT,VAR
           CALL     DISPITEM
.
RDPT0150   MOVE     "    6",FLDID
           CALL     GETPOSIT
           MOVE     "DP",AMCDCAT
           CALL     KAMCDA00
           BRANCH   EXIT,RDPT0200,RDPT0999
           MOVE     AMCDCOD,ENDDPT
           PACK     TODPT,AMCDCOD,SP1,AMCDDES
           MATCH    STRDPT,ENDDPT
           GOTO     RDPT0999 IF EQUAL
           GOTO     RDPT0999 IF NOT LESS
           BEEP
           MOVE     "To Department Must Be > From Department - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RDPT0000
.
RDPT0200   MOVE     "Finish             ",TODPT
           MOVE     "~~~",ENDDPT
.
RDPT0999   MOVE     "    5",FLDID
           CALL     GETPOSIT
           RETURN
RSOF0000   MOVE     "    7",FLDID
           CALL     GETPOSIT
           MOVE     "SF",AMCDCAT
           CALL     KAMCDA00
           BRANCH   EXIT,RSOF0100,RSOF0999
           MOVE     AMCDCOD,STRSOF
           PACK     FROMSOF,AMCDCOD,SP1,AMCDDES
           GOTO     RSOF0140
.
RSOF0100   MOVE     "Start             ",FROMSOF
           MOVE     SP70,STRSOF
.
RSOF0140   MOVE     FROMSOF,VAR
           CALL     DISPITEM
.
RSOF0150   MOVE     "    8",FLDID
           CALL     GETPOSIT
           MOVE     "SF",AMCDCAT
           CALL     KAMCDA00
           BRANCH   EXIT,RSOF0200,RSOF0999
           MOVE     AMCDCOD,ENDSOF
           PACK     TOSOF,AMCDCOD,SP1,AMCDDES
           MATCH    STRSOF,ENDSOF
           GOTO     RSOF0999 IF EQUAL
           GOTO     RSOF0999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RSOF0000
.
RSOF0200   MOVE     "Finish             ",TOSOF
           MOVE     "~~~",ENDSOF
.
RSOF0999   MOVE     "    7",FLDID
           CALL     GETPOSIT
           RETURN
RDTY0000   MOVE     "    9",FLDID
           CALL     GETPOSIT
           MOVE     "DT",AMCDCAT
           CALL     KAMCDA00
           BRANCH   EXIT,RDTY0100,RDTY0999
           MOVE     AMCDCOD,STRDTY
           PACK     FROMDTY,AMCDCOD,SP1,AMCDDES
           GOTO     RDTY0140
.
RDTY0100   MOVE     "Start             ",FROMDTY
           MOVE     SP70,STRDTY
.
RDTY0140   MOVE     FROMDTY,VAR
           CALL     DISPITEM
.
RDTY0150   MOVE     "   10",FLDID
           CALL     GETPOSIT
           MOVE     "DT",AMCDCAT
           CALL     KAMCDA00
           BRANCH   EXIT,RDTY0200,RDTY0999
           MOVE     AMCDCOD,ENDDTY
           PACK     TODTY,AMCDCOD,SP1,AMCDDES
           MATCH    STRDTY,ENDDTY
           GOTO     RDTY0999 IF EQUAL
           GOTO     RDTY0999 IF NOT LESS
           BEEP
           MOVE     "To Disposal Type Must Be > From Disposal Type - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RDTY0000
.
RDTY0200   MOVE     "Finish             ",TODTY
           MOVE     "~~~",ENDDTY
.
RDTY0999   MOVE     "    9",FLDID
           CALL     GETPOSIT
           RETURN
RBLD0000   MOVE     "   11",FLDID
           CALL     GETPOSIT
           MOVE     "BL",AMCDCAT
           CALL     KAMCDA00
           BRANCH   EXIT,RBLD0100,RBLD0999
           MOVE     AMCDCOD,STRBLD
           PACK     FROMBLD,AMCDCOD,SP1,AMCDDES
           GOTO     RBLD0140
.
RBLD0100   MOVE     "Start             ",FROMBLD
           MOVE     SP70,STRBLD
.
RBLD0140   MOVE     FROMBLD,VAR
           CALL     DISPITEM
.
RBLD0150   MOVE     "   12",FLDID
           CALL     GETPOSIT
           MOVE     "BL",AMCDCAT
           CALL     KAMCDA00
           BRANCH   EXIT,RBLD0200,RBLD0999
           MOVE     AMCDCOD,ENDBLD
           PACK     TOBLD,AMCDCOD,SP1,AMCDDES
           MATCH    STRBLD,ENDBLD
           GOTO     RBLD0999 IF EQUAL
           GOTO     RBLD0999 IF NOT LESS
           BEEP
           MOVE     "To Building Must Be > From Building - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RBLD0000
.
RBLD0200   MOVE     "Finish             ",TOBLD
           MOVE     "~~~",ENDBLD
.
RBLD0999   MOVE     "   11",FLDID
           CALL     GETPOSIT
           RETURN
RLOC0000   MOVE     "   13",FLDID
           CALL     GETPOSIT
           MATCH    STRBLD,ENDBLD
           GOTO     RLOC0900 IF NOT EQUAL
.
           MOVE     STRBLD,AMLOBLD
           CALL     KAMLOA00
           BRANCH   EXIT,RLOC0100,RLOC0999
           MOVE     AMLOLOC,STRLOC
           PACK     FROMLOC,AMLOLOC,SP1,AMLODES
           GOTO     RLOC0140
.
RLOC0100   MOVE     "Start             ",FROMLOC
           MOVE     SP70,STRLOC
.
RLOC0140   MOVE     FROMLOC,VAR
           CALL     DISPITEM
.
RLOC0150   MOVE     "   14",FLDID
           CALL     GETPOSIT
           MOVE     STRBLD,AMLOBLD
           CALL     KAMLOA00
           BRANCH   EXIT,RLOC0200,RLOC0999
           MOVE     AMLOLOC,ENDLOC
           PACK     TOLOC,AMLOLOC,SP1,AMLODES
           MATCH    STRLOC,ENDLOC
           GOTO     RLOC0999 IF EQUAL
           GOTO     RLOC0999 IF NOT LESS
           BEEP
           MOVE     "To Location Must Be > From Location - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RLOC0000
RLOC0200   MOVE     "Finish             ",TOLOC
           MOVE     "~~~~~~",ENDLOC
           GOTO     RLOC0999
.
RLOC0900   MOVE     "Finish             ",TOLOC
           MOVE     "~~~~~~",ENDLOC
           MOVE     "Start             ",FROMLOC
           MOVE     SP70,STRLOC
           GOTO     RLOC0999
.
RLOC0999   MOVE     "   13",FLDID
           CALL     GETPOSIT
           RETURN
RDDT0000   MOVE     "   15",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RDDT0100
           MATCH    SP2,CDAY
           GOTO     RDDT0100 IF EQUAL
           PACK     STRDDT,CCENT,CYEAR,CMON,CDAY
           REP      " 0",STRDDT
           CALL     PACDATE
           MOVE     CPCDATE,FROMDDT
           GOTO     RDDT0140
RDDT0100   MOVE     "Start             ",FROMDDT
           MOVE     SP70,STRDDT
.
RDDT0140   MOVE     FROMDDT,VAR
           CALL     DISPITEM
.
RDDT0150   MOVE     "   16",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RDDT0200
           MATCH    SP2,CDAY
           GOTO     RDDT0200 IF EQUAL
           PACK     ENDDDT,CCENT,CYEAR,CMON,CDAY
           REP      " 0",ENDDDT
           CALL     PACDATE
           MOVE     CPCDATE,TODDT
           MATCH    STRDDT,ENDDDT
           GOTO     RDDT0999 IF EQUAL
           GOTO     RDDT0999 IF NOT LESS
           BEEP
           MOVE     "To Date Must Be > From Date - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RDDT0000
.
RDDT0200   MOVE     "Finish             ",TODDT
           MOVE     "99999999",ENDDDT
.
RDDT0999   MOVE     "   15",FLDID
           CALL     GETPOSIT
           RETURN

RAQD0000   MOVE     "   17",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RAQD0100
           MATCH    SP2,CDAY
           GOTO     RAQD0100 IF EQUAL
           PACK     STRAQD,CCENT,CYEAR,CMON,CDAY
           REP      " 0",STRAQD
           CALL     PACDATE
           MOVE     CPCDATE,FROMAQD
           GOTO     RAQD0140
RAQD0100   MOVE     "Start             ",FROMAQD
           MOVE     SP70,STRAQD
.
RAQD0140   MOVE     FROMAQD,VAR
           CALL     DISPITEM
.
RAQD0150   MOVE     "   18",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RAQD0200
           MATCH    SP2,CDAY
           GOTO     RAQD0200 IF EQUAL
           PACK     ENDAQD,CCENT,CYEAR,CMON,CDAY
           REP      " 0",ENDAQD
           CALL     PACDATE
           MOVE     CPCDATE,TOAQD
           MATCH    STRAQD,ENDAQD
           GOTO     RAQD0999 IF EQUAL
           GOTO     RAQD0999 IF NOT LESS
           BEEP
           MOVE     "To Date Must Be > From Date - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RAQD0000
.
RAQD0200   MOVE     "Finish             ",TOAQD
           MOVE     "99999999",ENDAQD
.
RAQD0999   MOVE     "   17",FLDID
           CALL     GETPOSIT
           RETURN

RRDT0000   MOVE     "   19",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RRDT0100
           MATCH    SP2,CDAY
           GOTO     RRDT0100 IF EQUAL
           PACK     STRRDT,CCENT,CYEAR,CMON,CDAY
           REP      " 0",STRRDT
           CALL     PACDATE
           MOVE     CPCDATE,FROMRDT
           GOTO     RRDT0140
RRDT0100   MOVE     "Start             ",FROMRDT
           MOVE     SP70,STRRDT
.
RRDT0140   MOVE     FROMRDT,VAR
           CALL     DISPITEM
.
RRDT0150   MOVE     "   20",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RRDT0200
           MATCH    SP2,CDAY
           GOTO     RRDT0200 IF EQUAL
           PACK     ENDRDT,CCENT,CYEAR,CMON,CDAY
           REP      " 0",ENDRDT
           CALL     PACDATE
           MOVE     CPCDATE,TORDT
           MATCH    STRRDT,ENDRDT
           GOTO     RRDT0999 IF EQUAL
           GOTO     RRDT0999 IF NOT LESS
           BEEP
           MOVE     "To Date Must Be > From Date - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RRDT0000
.
RRDT0200   MOVE     "Finish             ",TORDT
           MOVE     "99999999",ENDRDT
.
RRDT0999   MOVE     "   19",FLDID
           CALL     GETPOSIT
           RETURN

RLSD0000   MOVE     "   21",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RLSD0100
           MATCH    SP2,CDAY
           GOTO     RLSD0100 IF EQUAL
           PACK     STRLSD,CCENT,CYEAR,CMON,CDAY
           REP      " 0",STRLSD
           CALL     PACDATE
           MOVE     CPCDATE,FROMLSD
           GOTO     RLSD0140
RLSD0100   MOVE     "Start             ",FROMLSD
           MOVE     SP70,STRLSD
.
RLSD0140   MOVE     FROMLSD,VAR
           CALL     DISPITEM
.
RLSD0150   MOVE     "   22",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RLSD0200
           MATCH    SP2,CDAY
           GOTO     RLSD0200 IF EQUAL
           PACK     ENDLSD,CCENT,CYEAR,CMON,CDAY
           REP      " 0",ENDLSD
           CALL     PACDATE
           MOVE     CPCDATE,TOLSD
           MATCH    STRLSD,ENDLSD
           GOTO     RLSD0999 IF EQUAL
           GOTO     RLSD0999 IF NOT LESS
           BEEP
           MOVE     "To Date Must Be > From Date - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RLSD0000
.
RLSD0200   MOVE     "Finish             ",TOLSD
           MOVE     "99999999",ENDLSD
.
RLSD0999   MOVE     "   21",FLDID
           CALL     GETPOSIT
           RETURN

RLED0000   MOVE     "   23",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RLED0100
           MATCH    SP2,CDAY
           GOTO     RLED0100 IF EQUAL
           PACK     STRLED,CCENT,CYEAR,CMON,CDAY
           REP      " 0",STRLED
           CALL     PACDATE
           MOVE     CPCDATE,FROMLED
           GOTO     RLED0140
RLED0100   MOVE     "Start             ",FROMLED
           MOVE     SP70,STRLED
.
RLED0140   MOVE     FROMLED,VAR
           CALL     DISPITEM
.
RLED0150   MOVE     "   24",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RLED0200
           MATCH    SP2,CDAY
           GOTO     RLED0200 IF EQUAL
           PACK     ENDLED,CCENT,CYEAR,CMON,CDAY
           REP      " 0",ENDLED
           CALL     PACDATE
           MOVE     CPCDATE,TOLED
           MATCH    STRLED,ENDLED
           GOTO     RLED0999 IF EQUAL
           GOTO     RLED0999 IF NOT LESS
           BEEP
           MOVE     "To Date Must Be > From Date - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RLED0000
.
RLED0200   MOVE     "Finish             ",TOLED
           MOVE     "99999999",ENDLED
.
RLED0999   MOVE     "   23",FLDID
           CALL     GETPOSIT
           RETURN

RIRD0000   MOVE     "   25",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RIRD0100
           MATCH    SP2,CDAY
           GOTO     RIRD0100 IF EQUAL
           PACK     STRIRD,CCENT,CYEAR,CMON,CDAY
           REP      " 0",STRIRD
           CALL     PACDATE
           MOVE     CPCDATE,FROMIRD
           GOTO     RIRD0140
RIRD0100   MOVE     "Start             ",FROMIRD
           MOVE     SP70,STRIRD
.
RIRD0140   MOVE     FROMIRD,VAR
           CALL     DISPITEM
.
RIRD0150   MOVE     "   26",FLDID
           CALL     GETPOSIT
           MOVE     SP70,CDAY
           MOVE     CMM,CMON
           MOVE     CYY,CYEAR
           MOVE     CCC,CCENT
           CALL     KEYDATE
           BRANCH   OVRCD,RIRD0200
           MATCH    SP2,CDAY
           GOTO     RIRD0200 IF EQUAL
           PACK     ENDIRD,CCENT,CYEAR,CMON,CDAY
           REP      " 0",ENDIRD
           CALL     PACDATE
           MOVE     CPCDATE,TOIRD
           MATCH    STRIRD,ENDIRD
           GOTO     RIRD0999 IF EQUAL
           GOTO     RIRD0999 IF NOT LESS
           BEEP
           MOVE     "To Date Must Be > From Date - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RIRD0000
.
RIRD0200   MOVE     "Finish             ",TOIRD
           MOVE     "99999999",ENDIRD
.
RIRD0999   MOVE     "   25",FLDID
           CALL     GETPOSIT
           RETURN

RLCM0000   MOVE     "   27",FLDID
           CALL     GETPOSIT
           CALL     KAPMAA00
           BRANCH   EXIT,RLCM0100,RLCM0999
           MOVE     APMACRD,STRLCM
           PACK     FROMLCM,APMACRD,SP1,APMASN1
           GOTO     RLCM0140
RLCM0100   MOVE     "Start             ",FROMLCM
           MOVE     SP70,STRLCM
.
RLCM0140   MOVE     FROMLCM,VAR
           CALL     DISPITEM
.
RLCM0150   MOVE     "   28",FLDID
           CALL     GETPOSIT
           CALL     KAPMAA00
           BRANCH   EXIT,RLCM0200,RLCM0999
           MOVE     APMACRD,ENDLCM
           PACK     TOLCM,APMACRD,SP1,APMASN1
           MATCH    STRLCM,ENDLCM
           GOTO     RLCM0999 IF EQUAL
           GOTO     RLCM0999 IF NOT LESS
           BEEP
           MOVE     "To Company Must Be > From Company - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RLCM0000
.
RLCM0200   MOVE     "Finish             ",TOLCM
           MOVE     "~~~~~",ENDLCM
.
RLCM0999   MOVE     "   27",FLDID
           CALL     GETPOSIT
           RETURN
RICM0000   MOVE     "   29",FLDID
           CALL     GETPOSIT
           CALL     KAPMAA00
           BRANCH   EXIT,RICM0100,RICM0999
           MOVE     APMACRD,STRICM
           PACK     FROMICM,APMACRD,SP1,APMASN1
           GOTO     RICM0140
RICM0100   MOVE     "Start             ",FROMICM
           MOVE     SP70,STRICM
.
RICM0140   MOVE     FROMICM,VAR
           CALL     DISPITEM
.
RICM0150   MOVE     "   30",FLDID
           CALL     GETPOSIT
           CALL     KAPMAA00
           BRANCH   EXIT,RICM0200,RICM0999
           MOVE     APMACRD,ENDICM
           PACK     TOICM,APMACRD,SP1,APMASN1
           MATCH    STRICM,ENDICM
           GOTO     RICM0999 IF EQUAL
           GOTO     RICM0999 IF NOT LESS
           BEEP
           MOVE     "To Company Must Be > From Company - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RICM0000
.
RICM0200   MOVE     "Finish             ",TOICM
           MOVE     "~~~~~",ENDICM
.
RICM0999   MOVE     "   29",FLDID
           CALL     GETPOSIT
           RETURN
RASS0000   MOVE     "   31",FLDID
           CALL     GETPOSIT
           MATCH    STRREG,ENDREG
           GOTO     RASS0900 IF NOT EQUAL
.
           MOVE     STRREG,AMMAREG
           CALL     KAMMAA00
           BRANCH   EXIT,RASS0100,RASS0999
           MOVE     AMMAASS,STRASS
           PACK     FROMASS,AMMAASS,SP1,AMMADES
           GOTO     RASS0140
.
RASS0100   MOVE     "Start             ",FROMASS
           MOVE     SP70,STRASS
.
RASS0140   MOVE     FROMASS,VAR
           CALL     DISPITEM
.
RASS0150   MOVE     "   32",FLDID
           CALL     GETPOSIT
           MOVE     STRREG,AMMAREG
           CALL     KAMMAA00
           BRANCH   EXIT,RASS0200,RASS0999
           MOVE     AMMAASS,ENDASS
           PACK     TOASS,AMMAASS,SP1,AMMADES
           MATCH    STRASS,ENDASS
           GOTO     RASS0999 IF EQUAL
           GOTO     RASS0999 IF NOT LESS
           BEEP
           MOVE     "To Asset Must Be > From Asset - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RASS0000
RASS0200   MOVE     "Finish             ",TOASS
           MOVE     "~~~~~~~~~~~~",ENDASS
           GOTO     RASS0999
.
RASS0900   MOVE     "Finish             ",TOASS
           MOVE     "~~~~~~~~~~~~",ENDASS
           MOVE     "Start             ",FROMASS
           MOVE     SP70,STRASS
           GOTO     RASS0999
.
RASS0999   MOVE     "   31",FLDID
           CALL     GETPOSIT
           RETURN
KRSEQ000   CALL      DRSEQ000
           MOVE      ZERO,REPTSEQ
KRSEQ001   KEYIN     *PCCOL:CVERT,*V2LON,*RV,REPTSEQ
           COMPARE   ZERO,REPTSEQ
           GOTO      KRSEQ900 IF EQUAL
           BRANCH    REPTSEQ,KRSEQ010,KRSEQ020,KRSEQ030,KRSEQ040,KRSEQ050
           BEEP
           GOTO      KRSEQ001
.
KRSEQ010   MOVE      "Asset Type",RSEQDESC
           GOTO      KRSEQ999
.
KRSEQ020   MOVE      "Department",RSEQDESC
           GOTO      KRSEQ999
.
KRSEQ030   MOVE      "Building/Location",RSEQDESC
           GOTO      KRSEQ999
.
KRSEQ040   MOVE      "Insurance Company",RSEQDESC
           GOTO      KRSEQ999
.
KRSEQ050   MOVE      "Renewal Date",RSEQDESC
           GOTO      KRSEQ999
.
KRSEQ900   MOVE      "Register/Asset",RSEQDESC
           GOTO      KRSEQ999
.
KRSEQ999   CALL      PUTSCR00
           RETURN
.
DRSEQ000  MOVE      "13",HTOP
          MOVE      "55",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P60:14,*V2LON,*ULON,"Report Sequence",*HOFF:
                    *P57:15,*V2LON,"0. ",*HOFF,"Register/Asset":
                    *P57:16,*V2LON,"1. ",*HOFF,"Asset Type":
                    *P57:17,*V2LON,"2. ",*HOFF,"Department":
                    *P57:18,*V2LON,"3. ",*HOFF,"Building/Location":
                    *P57:19,*V2LON,"4. ",*HOFF,"Insurance Company":
                    *P57:20,*V2LON,"5. ",*HOFF,"Renewal Date"
          RETURN
.
RUC10000   MOVE     "   43",FLDID
           CALL     GETPOSIT
           MOVE     "A1",AMCDCAT
           CALL     KAMCDA00
           BRANCH   EXIT,RUC10100,RUC10999
           MOVE     AMCDCOD,STRUC1
           PACK     FROMUC1,AMCDCOD,SP1,AMCDDES
           GOTO     RUC10140
.
RUC10100   MOVE     "Start             ",FROMUC1
           MOVE     SP70,STRUC1
.
RUC10140   MOVE     FROMUC1,VAR
           CALL     DISPITEM
.
RUC10150   MOVE     "   44",FLDID
           CALL     GETPOSIT
           MOVE     "A1",AMCDCAT
           CALL     KAMCDA00
           BRANCH   EXIT,RUC10200,RUC10999
           MOVE     AMCDCOD,ENDUC1
           PACK     TOUC1,AMCDCOD,SP1,AMCDDES
           MATCH    STRUC1,ENDUC1
           GOTO     RUC10999 IF EQUAL
           GOTO     RUC10999 IF NOT LESS
           BEEP
           MOVE     "To Asset Class Must Be > From Asset Class - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RUC10000
.
RUC10200   MOVE     "Finish             ",TOUC1
           MOVE     "~~~",ENDUC1
.
RUC10999   MOVE     "   43",FLDID
           CALL     GETPOSIT
           RETURN
.-------------------------------------------------------------------------------
. Print Report
.--------------
. Report Sequences  0. Register/Asset
.                   1. Asset Type
.                   2. Department
.                   3. Building/Location
.                   4. Lease Company
.                   5. Lease Commencement
.                   6. Lease Retirement
.-------------------------------------------------------------------------------
REPT0000  DISPLAY   *P1:24,*EL,"Printing Report : ";
          MOVE      ZERO,CPAGENO          * reset page no.
          CLOCK     TIME,CTIMEIS          * get current time
          MOVE      "99",CLNO             * init last line number
          MOVE      ZERO,TOTALPRT         * No Total Print
          MOVE      ZERO,ATOTAL1
          MOVE      ZERO,ATOTAL2
          MOVE      ZERO,BTOTAL1
          MOVE      ZERO,BTOTAL2
          MOVE      ZERO,CTOTAL1
          MOVE      ZERO,CTOTAL2
          MOVE      ZERO,GRAND1
          MOVE      ZERO,GRAND2
.
          MOVE      ZERO,USINGUC1
          PACK      UC1HEAD,SP70
          MOVE      "A1   ",KEY5
          CALL      RDAMCD1
          BRANCH    OVRCD,REPT0050
.
          MATCH     SP70,AMCDDES
          GOTO      REPT0050 IF EQUAL
.
          MOVE      AMCDDES,UC1HEAD
          MOVE      ONE,USINGUC1
.
REPT0050  BRANCH    REPTSEQ,REPT0100,REPT0200,REPT0300,REPT0400,REPT0500
.
          CALL      SEQA0000              * Register/Asset
          GOTO      REPT9000
.
REPT0100  CALL      SEQB0000              * Asset Type
          GOTO      REPT9000
.
REPT0200  CALL      SEQC0000              * Department
          GOTO      REPT9000
.
REPT0300  CALL      SEQD0000              * Building/Location
          GOTO      REPT9000
.
REPT0400  CALL      SEQE0000              * Insurance Company
          GOTO      REPT9000
.
REPT0500  CALL      SEQF0000              * Insurance Renewal Date
          GOTO      REPT9000
.
REPT9000  COMPARE   ZERO,CPAGENO
          CALL      HEAD0000 IF EQUAL
          MOVE      "999,999,999,999.99",FTOTAL1
          MOVE      "999,999,999,999.99",FTOTAL2
          FEDIT     GRAND1,FTOTAL1
          FEDIT     GRAND2,FTOTAL2
          CALL      UND132
          PRINT     *1,"Report Total : ",*95,FTOTAL1,SP1,FTOTAL2
          CALL      UND132
          PRINT     *45,"*** End of Report ***"
.
REPT9999  RETURN
.------------------------------------------------------------
. Print Asset Line
.------------------------------------------------------------
PLINE000  COMPARE  "55",CLNO
          CALL     HEAD0000 IF NOT LESS
          ADD      TWO,CLNO
.
          UNPACK   AMINDAT,CCENT,CYEAR,CMON,CDAY
          CALL     PACDATE
          MOVE     "999,999,999,999.99",FTOTAL1
          MOVE     "999,999,999,999.99",FTOTAL2
          FEDIT    AMINVAL,FTOTAL1
          FEDIT    AMINAPR,FTOTAL2
.
          PRINT    AMMAREG,"/",AMMAASS,*17,AMMADES,*53,AMINREF,*84,CPCDATE:
                   *95,FTOTAL1,SP1,FTOTAL2
          MOVE     AMINCOD,KEY29
          PRINT    *17,AMINCOM,SP1,KEY29,SP1,AMINCON
.
          ADD      AMINVAL,ATOTAL1
          ADD      AMINAPR,ATOTAL2
          ADD      AMINVAL,BTOTAL1
          ADD      AMINAPR,BTOTAL2
          ADD      AMINVAL,CTOTAL1
          ADD      AMINAPR,CTOTAL2
          ADD      AMINVAL,GRAND1
          ADD      AMINAPR,GRAND2
          RETURN
.------------------------------------------------------------
. Page Heading
.------------------------------------------------------------
HEAD0000  COMPARE  ZERO,CPAGENO
          GOTO     HEAD1000 IF EQUAL
.
          COMPARE  ZERO,TOTALPRT
          GOTO     HEAD1000 IF EQUAL
.
          CALL     PTOT0000
.
HEAD1000  CALL     HEAD132
          CALL     SELC0000
          CALL     UND132
          PRINT    "Register/Asset  Description                         ":
                   "Policy Reference              Renewal Date          ":
                   " Insured             Annual"
          PRINT    "                Insurance Company                   ":
                   "Contact                                             ":
                   "   Value            Premium"
          CALL     UND132
          ADD      "4",CLNO
          RETURN
.------------------------------------------------------------
. Report Selections
.------------------------------------------------------------
SELC0000  ADD       ONE,CLNO
          PRINT     "Report Sequence        : ",REPTSEQ,SP1,RSEQDESC
          PACK      KEY4,STRREG,ENDREG
          MATCH     "  ~~",KEY4
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Register          From : ",FROMREG," to ",TOREG
          ENDIF
.
          PACK      KEY24,STRASS,ENDASS
          MATCH     "            ~~~~~~~~~~~~",KEY24
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Asset Code        From : ",FROMASS," to ",TOASS
          ENDIF
.
          PACK      KEY6,STRTYP,ENDTYP
          MATCH     "   ~~~",KEY6
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Asset Type        From : ",FROMTYP," to ",TOTYP
          ENDIF
.
          IF        USINGUC1=1
            PACK      KEY6,STRUC1,ENDUC1
            MATCH     "   ~~~",KEY6
            IF        !@EQUAL
              ADD       ONE,CLNO
              MOVE      UC1HEAD,KEY17
              PRINT     KEY17," From : ",FROMUC1," to ",TOUC1
            ENDIF
          ENDIF
.
          PACK      KEY6,STRDPT,ENDDPT
          MATCH     "   ~~~",KEY6
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Department        From : ",FROMDPT," to ",TODPT
          ENDIF
.
          PACK      KEY6,STRSOF,ENDSOF
          MATCH     "   ~~~",KEY6
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Source of Funds   From : ",FROMSOF," to ",TOSOF
          ENDIF
.
          PACK      KEY6,STRDTY,ENDDTY
          MATCH     "   ~~~",KEY6
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Disposal Type     From : ",FROMDTY," to ",TODTY
          ENDIF
.
          PACK      KEY6,STRBLD,ENDBLD
          MATCH     "   ~~~",KEY6
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Building          From : ",FROMBLD," to ",TOBLD
          ENDIF
.
          PACK      KEY12,STRLOC,ENDLOC
          MATCH     "      ~~~~~~",KEY12
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Location          From : ",FROMLOC," to ",TOLOC
          ENDIF
.
          PACK      KEY16,STRDDT,ENDDDT
          MATCH     "        99999999",KEY16
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Disposal Date     From : ",FROMDDT," to ",TODDT
          ENDIF
.
          PACK      KEY16,STRAQD,ENDAQD
          MATCH     "        99999999",KEY16
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Acquisition Date  From : ",FROMAQD," to ",TOAQD
          ENDIF
.
          PACK      KEY16,STRRDT,ENDRDT
          MATCH     "        99999999",KEY16
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Replacement Date  From : ",FROMRDT," to ",TORDT
          ENDIF
.
          PACK      KEY16,STRLSD,ENDLSD
          MATCH     "        99999999",KEY16
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Lease Start Date  From : ",FROMLSD," to ",TOLSD
          ENDIF
.
          PACK      KEY16,STRLED,ENDLED
          MATCH     "        99999999",KEY16
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Lease End   Date  From : ",FROMLED," to ",TOLED
          ENDIF
.
          PACK      KEY16,STRIRD,ENDIRD
          MATCH     "        99999999",KEY16
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Insurance Renewal From : ",FROMIRD," to ",TOIRD
          ENDIF
.
          PACK      KEY10,STRLCM,ENDLCM
          MATCH     "     ~~~~~",KEY10
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Lease Company     From : ",FROMLCM," to ",TOLCM
          ENDIF
.
          PACK      KEY10,STRICM,ENDICM
          MATCH     "     ~~~~~",KEY10
          IF        !@EQUAL
            ADD       ONE,CLNO
            PRINT     "Insurance Company From : ",FROMICM," to ",TOICM
          ENDIF
.
          RETURN
.------------------------------------------------------------
. Page Break Totals
.------------------------------------------------------------
PTOT0000 COMPARE    ZERO,CPAGENO
         CALL       HEAD0000 IF EQUAL
         BRANCH     TOTALPRT,PTOT1000,PTOT2000
.
PTOT1000 MOVE       "999,999,999,999.99",FTOTAL1
         MOVE       "999,999,999,999.99",FTOTAL2
         FEDIT      ATOTAL1,FTOTAL1
         FEDIT      ATOTAL2,FTOTAL2
         CALL       UND132
         PRINT      *1,"Total ",TOTDES01,*95,FTOTAL1,SP1,FTOTAL2
         MOVE       ZERO,ATOTAL1
         MOVE       ZERO,ATOTAL2
         GOTO       PTOT9999
.
PTOT2000 MOVE       "999,999,999,999.99",FTOTAL1
         MOVE       "999,999,999,999.99",FTOTAL2
         FEDIT      ATOTAL1,FTOTAL1
         FEDIT      ATOTAL2,FTOTAL2
         CALL       UND132
         PRINT      *1,"Total ",TOTDES01,*95,FTOTAL1,SP1,FTOTAL2
         MOVE       ZERO,ATOTAL1
         MOVE       ZERO,ATOTAL2
         MOVE       ZERO,ATOTAL3
.
         MOVE       "999,999,999,999.99",FTOTAL1
         MOVE       "999,999,999,999.99",FTOTAL2
         FEDIT      BTOTAL1,FTOTAL1
         FEDIT      BTOTAL2,FTOTAL2
         CALL       UND132
         PRINT      *1,"Total ",TOTDES02,*95,FTOTAL1,SP1,FTOTAL2
         MOVE       ZERO,BTOTAL1
         MOVE       ZERO,BTOTAL2
.
PTOT9999 MOVE       ZERO,TOTALPRT
         RETURN
.------------------------------------------------------------
. Check Asset in Selection Range
.------------------------------------------------------------
RANGE000  MOVE      ZERO,EXIT
. Register
          MATCH     STRREG,AMMAREG
          GOTO      RANGE900 IF LESS
          MATCH     AMMAREG,ENDREG
          GOTO      RANGE900 IF LESS
. Asset Code
          MATCH     STRASS,AMMAASS
          GOTO      RANGE900 IF LESS
          MATCH     AMMAASS,ENDASS
          GOTO      RANGE900 IF LESS
. Asset Type
          MATCH     STRTYP,AMMATYP
          GOTO      RANGE900 IF LESS
          MATCH     AMMATYP,ENDTYP
          GOTO      RANGE900 IF LESS
. User defined code 1
          MATCH     STRUC1,AMMAUC1
          GOTO      RANGE900 IF LESS
          MATCH     AMMAUC1,ENDUC1
          GOTO      RANGE900 IF LESS
. Department
          MATCH     STRDPT,AMMADPT
          GOTO      RANGE900 IF LESS
          MATCH     AMMADPT,ENDDPT
          GOTO      RANGE900 IF LESS
. Source of Funds
          MATCH     STRSOF,AMMASOF
          GOTO      RANGE900 IF LESS
          MATCH     AMMASOF,ENDSOF
          GOTO      RANGE900 IF LESS
. Disposal Type
          MATCH     STRDTY,AMMADTY
          GOTO      RANGE900 IF LESS
          MATCH     AMMADTY,ENDDTY
          GOTO      RANGE900 IF LESS
. Building
          MATCH     STRBLD,AMMABLD
          GOTO      RANGE900 IF LESS
          MATCH     AMMABLD,ENDBLD
          GOTO      RANGE900 IF LESS
. Location
          MATCH     STRLOC,AMMALOC
          GOTO      RANGE900 IF LESS
          MATCH     AMMALOC,ENDLOC
          GOTO      RANGE900 IF LESS
. Disposal Date
          MATCH     STRDDT,AMMADDT
          GOTO      RANGE900 IF LESS
          MATCH     AMMADDT,ENDDDT
          GOTO      RANGE900 IF LESS
. Acquisition Date
          MATCH     STRAQD,AMMAAQD
          GOTO      RANGE900 IF LESS
          MATCH     AMMAAQD,ENDAQD
          GOTO      RANGE900 IF LESS
. Replacement Date
          MATCH     STRRDT,AMMARDT
          GOTO      RANGE900 IF LESS
          MATCH     AMMARDT,ENDRDT
          GOTO      RANGE900 IF LESS
.
          PACK      KEY14,AMMAREG,AMMAASS
          CALL      RDAMLE1
          BRANCH    OVRCD,RANGE100
.
. Lease Start Date
          MATCH     STRLSD,AMLEDAT
          GOTO      RANGE900 IF LESS
          MATCH     AMLEDAT,ENDLSD
          GOTO      RANGE900 IF LESS
. Lease End Date
          MATCH     STRLED,AMLEEDT
          GOTO      RANGE900 IF LESS
          MATCH     AMLEEDT,ENDLED
          GOTO      RANGE900 IF LESS
. Lease Company
          MATCH     STRLCM,AMLECOM
          GOTO      RANGE900 IF LESS
          MATCH     AMLECOM,ENDLCM
          GOTO      RANGE900 IF LESS
.
RANGE100  PACK      KEY14,AMMAREG,AMMAASS
          CALL      RDAMIN1
          BRANCH    OVRCD,RANGE900     * Ignore Items without Insurance
. Insurance Company
          MATCH     STRICM,AMINCOM
          GOTO      RANGE900 IF LESS
          MATCH     AMINCOM,ENDICM
          GOTO      RANGE900 IF LESS
. Insurance Renewal Date
          MATCH     STRIRD,AMINDAT
          GOTO      RANGE900 IF LESS
          MATCH     AMINDAT,ENDIRD
          GOTO      RANGE900 IF LESS
.
          GOTO      RANGE999
RANGE900  MOVE      ONE,EXIT
RANGE999  RETURN
.------------------------------------------------------------
. Print Report in Register/Asset Sequence
.------------------------------------------------------------
SEQA0000  PACK      KEY14,STRREG,STRASS,SP70
          CALL      RDAMMA1
          IF        OVRCD=0
            CALL      RPAMMA1
          ENDIF
          MOVE      SP70,LASTPRT
SEQA1000  CALL      RKAMMA1
          BRANCH    OVRCD,SEQA9000
          MATCH     AMMAREG,ENDREG
          GOTO      SEQA9000 IF LESS
          MATCH     AMMAASS,ENDASS
          GOTO      SEQA9000 IF LESS
.
          CALL      RANGE000
          BRANCH    EXIT,SEQA1000
.
          MATCH     AMMAREG,LASTPRT
          IF        !@EQUAL
            MOVE      "99",CLNO        * Page Break on Change of Register
            MOVE      LASTPRT,KEY2
            CALL      RDAMRE1
            PACK      TOTDES01,AMREREG,SP1,AMREDES
            MOVE      AMMAREG,LASTPRT
            MOVE      ONE,TOTALPRT
          ENDIF
          DISPLAY   *P20:24,*V2LON,AMMAREG,"/",AMMAASS
.
          CALL      PLINE000      * Print Asset Details
.
          GOTO      SEQA1000
.
SEQA9000  MOVE      ONE,TOTALPRT
          MOVE      LASTPRT,KEY2
          CALL      RDAMRE1
          PACK      TOTDES01,AMREREG,SP1,AMREDES
          CALL      PTOT0000
SEQA9999  RETURN
.
.------------------------------------------------------------
. Print Report in Asset Type Sequence
.------------------------------------------------------------
SEQB0000  PACK      KEY17,STRTYP,SP70
          CALL      RDAMMA4
          IF        OVRCD=0
            CALL      RPAMMA4
          ENDIF
          MOVE      SP70,LASTPRT
SEQB1000  CALL      RKAMMA4
          BRANCH    OVRCD,SEQB9000
          MATCH     AMMATYP,ENDTYP
          GOTO      SEQB9000 IF LESS
.
          CALL      RANGE000
          BRANCH    EXIT,SEQB1000
.
          MATCH     AMMATYP,LASTPRT
          IF        !@EQUAL
            MOVE      "99",CLNO        * Page Break on Change of Register
            MOVE      "AT",AMCDCAT
            PACK      KEY5,AMCDCAT,LASTPRT
            CALL      RDAMCD1
            PACK      TOTDES01,AMCDCOD,SP1,AMCDDES
            MOVE      ONE,TOTALPRT
            MOVE      AMMATYP,LASTPRT
          ENDIF
          DISPLAY   *P20:24,*V2LON,AMMAREG,"/",AMMAASS
.
          CALL      PLINE000      * Print Asset Details
.
          GOTO      SEQB1000
.
SEQB9000  MOVE      ONE,TOTALPRT
          MOVE      "AT",AMCDCAT
          PACK      KEY5,AMCDCAT,LASTPRT
          CALL      RDAMCD1
          PACK      TOTDES01,AMCDCOD,SP1,AMCDDES
          CALL      PTOT0000
SEQB9999  RETURN
.
.------------------------------------------------------------
. Print Report in Department Sequence
.------------------------------------------------------------
SEQC0000  PACK      KEY17,STRDPT,SP70
          CALL      RDAMMA3
          IF        OVRCD=0
            CALL      RPAMMA3
          ENDIF
          MOVE      SP70,LASTPRT
SEQC1000  CALL      RKAMMA3
          BRANCH    OVRCD,SEQC9000
          MATCH     AMMADPT,ENDDPT
          GOTO      SEQC9000 IF LESS
.
          CALL      RANGE000
          BRANCH    EXIT,SEQC1000
.
          MATCH     AMMADPT,LASTPRT
          IF        !@EQUAL
            MOVE      "99",CLNO        * Page Break on Change of Register
            MOVE      "DP",AMCDCAT
            PACK      KEY5,AMCDCAT,LASTPRT
            CALL      RDAMCD1
            PACK      TOTDES01,AMCDCOD,SP1,AMCDDES
            MOVE      ONE,TOTALPRT
            MOVE      AMMADPT,LASTPRT
          ENDIF
          DISPLAY   *P20:24,*V2LON,AMMAREG,"/",AMMAASS
.
          CALL      PLINE000      * Print Asset Details
.
          GOTO      SEQC1000
.
SEQC9000  MOVE      ONE,TOTALPRT
          MOVE      "DP",AMCDCAT
          PACK      KEY5,AMCDCAT,LASTPRT
          CALL      RDAMCD1
          PACK      TOTDES01,AMCDCOD,SP1,AMCDDES
          CALL      PTOT0000
.
SEQC9999  RETURN
.
.------------------------------------------------------------
. Print Report in Building/Location Sequence
.------------------------------------------------------------
SEQD0000  PACK      KEY23,STRBLD,STRLOC,SP70
          CALL      RDAMMA2
          IF        OVRCD=0
            CALL      RPAMMA2
          ENDIF
          MOVE      SP70,LASTBLD
          MOVE      SP70,LASTPRT
SEQD1000  CALL      RKAMMA2
          BRANCH    OVRCD,SEQD9000
.
          MATCH     AMMABLD,ENDBLD
          GOTO      SEQD9000 IF LESS
          MATCH     AMMALOC,ENDLOC
          GOTO      SEQD9000 IF LESS
.
          CALL      RANGE000
          BRANCH    EXIT,SEQD1000
.
          MATCH     AMMABLD,LASTBLD
          IF        !@EQUAL
            MOVE      "99",CLNO        * Page Break on Change of Register
            MOVE      "BL",AMCDCAT
            PACK      KEY5,AMCDCAT,LASTBLD
            CALL      RDAMCD1
            PACK      TOTDES02,AMCDCOD,SP1,AMCDDES
.
            PACK      KEY9,LASTBLD,LASTPRT
            CALL      RDAMLO1
            PACK      TOTDES01,AMLOLOC,SP1,AMLODES
.
            MOVE      TWO,TOTALPRT
            MOVE      AMMABLD,LASTBLD
            MOVE      AMMALOC,LASTPRT
          ENDIF
.
          MATCH    AMMALOC,LASTPRT
          IF       !@EQUAL
            PACK      KEY9,LASTBLD,LASTPRT
            CALL      RDAMLO1
            PACK      TOTDES01,AMLOLOC,SP1,AMLODES
            MOVE      ONE,TOTALPRT
            MOVE      AMMALOC,LASTPRT
            CALL      PTOT0000
          ENDIF
.
          DISPLAY   *P20:24,*V2LON,AMMAREG,"/",AMMAASS
.
          CALL      PLINE000      * Print Asset Details
.
          GOTO      SEQD1000
.
SEQD9000  MOVE      TWO,TOTALPRT
          MOVE      "BL",AMCDCAT
          PACK      KEY5,AMCDCAT,LASTBLD
          CALL      RDAMCD1
          PACK      TOTDES02,AMCDCOD,SP1,AMCDDES
          PACK      KEY9,LASTBLD,LASTPRT
          CALL      RDAMLO1
          PACK      TOTDES01,AMLOLOC,SP1,AMLODES
.
          CALL      PTOT0000
SEQD9999  RETURN
.------------------------------------------------------------
. Print Report in Insurance Company Sequence
.------------------------------------------------------------
SEQE0000  PACK      KEY49,STRICM,SP70
          CALL      RDAMIN2
          IF        OVRCD=0
            CALL      RPAMIN2
          ENDIF
          MOVE      SP70,LASTPRT
SEQE1000  CALL      RKAMIN2
          BRANCH    OVRCD,SEQE9000
.
          MATCH     AMINCOM,ENDICM
          GOTO      SEQE9000 IF LESS
.
          PACK      KEY14,AMINREG,AMINASS
          CALL      RDAMMA1
          BRANCH    OVRCD,SEQE1000
.
          CALL      RANGE000
          BRANCH    EXIT,SEQE1000
.
          PACK      KEY31,AMINCOM,SP1,AMINCOD
          MATCH     KEY31,LASTPRT
          IF        !@EQUAL
            MOVE      "99",CLNO        * Page Break on Change of Register
            PACK      TOTDES01,LASTPRT
            MOVE      ONE,TOTALPRT
            PACK      LASTPRT,AMINCOM,SP1,AMINCOD
          ENDIF
.
          DISPLAY   *P20:24,*V2LON,AMMAREG,"/",AMMAASS
.
          CALL      PLINE000      * Print Asset Details
.
          GOTO      SEQE1000
.
SEQE9000  MOVE      ONE,TOTALPRT
          PACK      TOTDES01,LASTPRT
          CALL      PTOT0000
.
SEQE9999  RETURN
.
.------------------------------------------------------------
. Print Report in Insurance Renewal Date Sequence
.------------------------------------------------------------
SEQF0000  PACK      KEY22,STRIRD,SP70
          CALL      RDAMIN3
          IF        OVRCD=0
            CALL      RPAMIN3
          ENDIF
SEQF1000  CALL      RKAMIN3
          BRANCH    OVRCD,SEQF9000
.
          MATCH     AMINDAT,ENDIRD
          GOTO      SEQF9000 IF LESS
.
          PACK      KEY14,AMINREG,AMINASS
          CALL      RDAMMA1
          BRANCH    OVRCD,SEQF1000
.
          CALL      RANGE000
          BRANCH    EXIT,SEQF1000
.
          DISPLAY   *P20:24,*V2LON,AMMAREG,"/",AMMAASS
.
          CALL      PLINE000      * Print Asset Details
.
          GOTO      SEQF1000
.
SEQF9000
.
SEQF9999  RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       AMSCODIO/INC
          INC       AMSCODKY    
          INC       AMSINSIO/INC
          INC       AMSLEAIO/INC
          INC       AMSLOCIO/INC
          INC       AMSLOCKY    
          INC       AMSMASIO/INC
          INC       AMSMASKY    
          INC       AMSREGIO/INC
          INC       AMSREGKY    
          INC       APSCKIKY    
          INC       APSMASIO/INC
          INC       APSMASKY    
          INC       APSMXRIO/INC
.
          INC       STDGENCD
.
