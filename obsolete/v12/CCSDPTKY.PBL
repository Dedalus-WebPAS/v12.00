.-----------------------------------------------
. Get Department Type Description DIM9
.-----------------------------------------------
ECCDPA00  
          MOVE      "Direct  ",DIM9
          MATCH     "1",CCDPDTY
          IF        @EQUAL
            MOVE      "Indirect ",DIM9
          ENDIF
          RETURN
.
.---------------------------------------------------------------------------
.   System    :   Clinical Costing System            
.   Include   :   CCSDPTKY
.   Routine   :   HCCDPA00 Department          
.   Return    :   CCCTCTY 
.-------------------------------------------------------------------------------
HCCDPA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "05",HTOP
            MOVE      "24",HBOT
            MOVE      "30",HLEF
            MOVE      "80",HRIG
          ENDIF
HCCDPA04
          CALL      GSCRN000
          BRANCH    EXIT,HCCDPA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Code"               
.
          MOVE      STDCOL01,STDCOL02
          ADD       " 9",STDCOL02
          DISPLAY   *PSTDCOL02:STDROW,*V2LON,*ULON,"Type"               
.
          MOVE      STDCOL02,STDCOL03
          ADD       " 9",STDCOL03
          DISPLAY   *PSTDCOL03:STDROW,*V2LON,*ULON,"Department"         
.
          MOVE      STDCOL03,STDCOL04
          ADD       "36",STDCOL04
HCCDPA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,CCDPDPT 
          PACK      KEY10,CCDPHCD,CCDPDPT,SP70                                  
          PACK      SAVKEY80,CCDPHCD,CCDPDPT,SP70                               
          SETLPTR   SAVKEY80,2                                                  
          CALL      RSCCDP1 
HCCDPA10
          CALL      RKCCDP1 
          BRANCH    OVRCD,HCCDPA15
          PACK      KEY10,CCDPHCD,CCDPDPT,SP70                                  
          MATCH     SAVKEY80,KEY10                                              
          GOTO      HCCDPA15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,HCCDPA12
          CALL      HCCDPA60
          BRANCH    OVRCD,HCCDPA10
HCCDPA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY10,XITEMNO,ST1,ST2,ST3,ST4,ST5:                          
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,CCDPDPT 
          CALL      ECCDPA00
          DISPLAY   *PSTDCOL02:STDROW,DIM9    
          DISPLAY   *PSTDCOL03:STDROW,CCDPDES 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HCCDPA10 IF NOT EQUAL
HCCDPA15
          UNPACK    SAVKEY80,CCDPHCD,CCDPDPT                                    
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HCCDPA20
          CALL      HSCRI000
          BRANCH    EXIT,HCCDPA30,HCCDPA35,HCCDPA40,HCCDPA45,HCCDPA04:
                              HCCDPA91,HCCDPA50
          GOTO      HCCDPA92
HCCDPA30
          CALL      RKCCDP1 
          BRANCH    OVRCD,HCCDPA85
          PACK      KEY10,CCDPHCD,CCDPDPT,SP70                                  
          MATCH     SAVKEY80,KEY10                                              
          GOTO      HCCDPA85 IF NOT EQUAL                                       
          CALL      RPCCDP1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCDPA10
HCCDPA35
          MOVE      ST1,KEY10
          CALL      RDCCDP1 
          CALL      RPCCDP1 
          BRANCH    OVRCD,HCCDPA85
          PACK      KEY10,CCDPHCD,CCDPDPT,SP70                                  
          MATCH     SAVKEY80,KEY10                                              
          GOTO      HCCDPA85 IF NOT EQUAL                                       
          MATCH     SP70,CCDPDPT                                                
          GOTO      HCCDPA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HCCDPA36
          CALL      RPCCDP1 
          BRANCH    OVRCD,HCCDPA37
          PACK      KEY10,CCDPHCD,CCDPDPT,SP70                                  
          MATCH     SAVKEY80,KEY10                                              
          GOTO      HCCDPA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCCDPA36 IF NOT EQUAL
HCCDPA37
          MOVE      ZERO,XITEMNO
          GOTO      HCCDPA10
HCCDPA40
          MOVE      ST1,KEY10
          CALL      RDCCDP1 
          CALL      RPCCDP1 
          BRANCH    OVRCD,HCCDPA85
          PACK      KEY10,CCDPHCD,CCDPDPT,SP70                                  
          MATCH     SAVKEY80,KEY10                                              
          GOTO      HCCDPA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCDPA08
HCCDPA45
          CALL      RKCCDP1 
          BRANCH    OVRCD,HCCDPA85
          PACK      KEY10,CCDPHCD,CCDPDPT,SP70                                  
          MATCH     SAVKEY80,KEY10                                              
          GOTO      HCCDPA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY10,SAVKEY80,Z70                                          
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSCCDP1 
HCCDPA46
          CALL      RPCCDP1 
          BRANCH    OVRCD,HCCDPA47
          PACK      KEY10,CCDPHCD,CCDPDPT,SP70                                  
          MATCH     SAVKEY80,KEY10                                              
          GOTO      HCCDPA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCCDPA46 IF NOT EQUAL
HCCDPA47
          MOVE      ZERO,XITEMNO
          GOTO      HCCDPA10
HCCDPA50  COMPARE   ZERO,CSEARCH
          GOTO      HCCDPA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          KEYIN     *PSTDCOL02:STDROW,*V2LON,SCHFLD02
          RESET     SCHFLD02
          KEYIN     *PSTDCOL03:STDROW,*V2LON,SCHFLD03
          RESET     SCHFLD03
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCDPA08
HCCDPA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCDPA08
HCCDPA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HCCDPA61 IF EQUAL
          MATCH     SCHFLD01,CCDPDPT 
          GOTO      HCCDPA72 IF NOT EQUAL
HCCDPA61
          CALL      ECCDPA00
          MATCH     SP70,SCHFLD02
          GOTO      HCCDPA62 IF EQUAL
          MATCH     SCHFLD02,DIM9    
          GOTO      HCCDPA72 IF NOT EQUAL
HCCDPA62
          MATCH     SP70,SCHFLD03
          GOTO      HCCDPA63 IF EQUAL
          MATCH     SCHFLD03,CCDPDES 
          GOTO      HCCDPA72 IF NOT EQUAL
HCCDPA63
HCCDPA64
HCCDPA65
HCCDPA66
HCCDPA67
HCCDPA68
HCCDPA69
HCCDPA70
          GOTO      HCCDPA75
HCCDPA72  MOVE      ONE,OVRCD
HCCDPA75  RETURN
HCCDPA85
          LOAD      KEY10,XITEMNO,ST1,ST2,ST3,ST4,ST5:                          
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY10,CCDPHCD,CCDPDPT                                       
          CALL      RDCCDP1 
HCCDPA90
          UNPACK    SAVKEY80,CCDPHCD,CCDPDPT                                    
          BEEP
          GOTO      HCCDPA20
HCCDPA91
          MOVE      SP70,CCDPDES 
          MOVE      SP70,CCDPDTY 
          MOVE      SP70,CCDPSEQ 
          MOVE      SP70,CCDPATY 
          MOVE      SP70,CCDPSPA 
          MOVE      SP70,KEY10
          MOVE      SP70,CCDPDPT 
          GOTO      HCCDPA96
HCCDPA92
          MOVE      SP70,KEY10
          MOVE      SP70,CCDPDPT 
          LOAD      KEY10,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY10,CCDPHCD,CCDPDPT                                       
HCCDPA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HCCDPA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Clinical Costing System            
.   Include   :   CCSDPTKY
.   Routine   :   KCCDPA00 Keyin Department          
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KCCDPA00 TOPIC     "CCDPDPT "
          MOVE      UNDLN70,CCDPDPT 
          KEYIN     *PCCOL:CVERT,*DV,CCDPDPT:                                   
                    *PCCOL:CVERT,*V2LON,CCDPDPT:                                
                    *PCCOL:CVERT,*DV,CCDPDPT 
.
          ENDSET    CCDPDPT 
          APPEND    SP70,CCDPDPT 
          RESET     CCDPDPT 
.
          MATCH     SP70,CCDPDPT 
          GOTO      KCCDPA90 IF EQUAL
.
          CMATCH    EXITCHAR,CCDPDPT 
          GOTO      KCCDPA95 IF EQUAL
.
          CMATCH    QUEST,CCDPDPT 
          GOTO      KCCDPA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCDPA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCDPDPT 
          APPEND    SP70,CCDPDPT 
          RESET     CCDPDPT 
.
          MATCH     SP70,CCDPDPT 
          GOTO      KCCDPA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,CCDPDPT                                 
KCCDPA10
          PACK      KEY10,CCDPHCD,CCDPDPT                                       
          CALL      RACCDP1 
          BRANCH    OVRCD,KCCDPA80
          BRANCH    CKEYTYP,KCCDPA75
          CALL      RDCCDP1 
KCCDPA70
          MOVE      ZERO,EXIT
          GOTO      KCCDPA99
KCCDPA75
          MOVE      "Department Already Exist - ",DISPMSG                                            
          CALL      MESSAGE1
          GOTO      KCCDPA00
KCCDPA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KCCDPA99,KCCDPA99
          MOVE      "Department Does Not Exist - ",DISPMSG                                           
          CALL      MESSAGE1
          GOTO      KCCDPA00
KCCDPA90
          MOVE      ONE,EXIT
          GOTO      KCCDPA99
KCCDPA95
          MOVE      TWO,EXIT
KCCDPA99 TOPIC    PRGID
          RETURN
