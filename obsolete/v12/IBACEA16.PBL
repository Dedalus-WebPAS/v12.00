.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V10.01.01 21/12/2010  Mike Laming   CAR 233046
.           Mods to Misc.Charges PATMCHFD - Key change, logic changes
. V9.02.01  09.07.2002  Glenn Saunders
.           Recompile for changes in includes shared with Southland, but with
.           previously different formats - now merged.  Includes effected :-
.           CCSCEAFD, CCSCONFD, CCSEPSFD, CCSHCDFD, CCSHLCFD, CCSIADFD
.-------------------------------------------------------
. V9.02.00  13.06.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.           Remove all PSN prefix PAS clone includes
.-------------------------------------------------------
. V6.04.01  07.07.1997 B.G.Ackland
.           File Layout Changes
.-------------------------------------------------------
. V6.03.02  30.10.1995 B.G.Ackland
.           Phase 1 WGH Changes
. V6.03.00  02.10.1995 B.G.Ackland
.           Release 6.03
.-------------------------------------------------------
COPYALL   FORM      1
ENDDOC    DIM       6
FROMDOC   DIM       6
SAVEDOC   DIM       6
SAVESPC   DIM       3
STRDOC    DIM       6
TODOC     DIM       6
CURRDATE  DIM       8
KEY21A    DIM       21
. Following File Declared so that a test can be perform to check for VMO System
.
VMOBITTF  IFILE     SQL, FIXED=110,  KEY="U1-8,9-16,17-24,25-34"
VMOFILOP  FORM      1
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACEA16
.   Function      :   Miscellaneous Patient Service Map       
.   Generated  On :   04/01/2011
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CCSCONFD/INC
          INC       CCSSTYFD/INC
          INC       CCSXHDFD/INC
          INC       CEAMAPFD/INC
          INC       CEAMBPFD/INC
          INC       CEAMCPFD/INC
          INC       CEAMDPFD/INC
          INC       CEAMEPFD/INC
          INC       CEAPSCFD/INC
          INC       CEASPCFD/INC
          INC       CEAVAMFD/INC
          INC       CEAVBMFD/INC
          INC       PATCODFD/INC
          INC       PATDO1FD/INC
          INC       PATMCHFD/INC
.=========================
.Local Variable Definition
.-------------------------
.
.    Multi Item Key Fields Scr 01 Fld    15
.-------------------------------------------------------
CEMA1NAM  INIT      "CEMA1"
CEMA1LEN  FORM      "56"
CEMA1IDX  INIT      "DC1-5 UC6-12"
CEMA1FNM  DIM       8  * Filename
CEMA1AFL  FORM      1  * End Accept Mode
CEMA1END  FORM      1  * End Display
CEMA1SNO  FORM      5  * Number of Items on the Screen
CEMA1NXT  DIM         12
CEMA1FL1  IFILE     SQL, FIXED=56,  KEY="D1-5"
CEMA1FL2  IFILE     SQL, FIXED=56, KEY="U6-12"
CEMA1CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 02 Fld    15
.-------------------------------------------------------
CEMB1NAM  INIT      "CEMB1"
CEMB1LEN  FORM      "62"
CEMB1IDX  INIT      "DC1-5 UC6-12"
CEMB1FNM  DIM       8  * Filename
CEMB1AFL  FORM      1  * End Accept Mode
CEMB1END  FORM      1  * End Display
CEMB1SNO  FORM      5  * Number of Items on the Screen
CEMB1NXT  DIM         12
CEMB1FL1  IFILE     SQL, FIXED=62,  KEY="D1-5"
CEMB1FL2  IFILE     SQL, FIXED=62, KEY="U6-12"
CEMB1CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 03 Fld    15
.-------------------------------------------------------
CEMC1NAM  INIT      "CEMC1"
CEMC1LEN  FORM      "56"
CEMC1IDX  INIT      "DC1-5 UC6-12"
CEMC1FNM  DIM       8  * Filename
CEMC1AFL  FORM      1  * End Accept Mode
CEMC1END  FORM      1  * End Display
CEMC1SNO  FORM      5  * Number of Items on the Screen
CEMC1NXT  DIM         12
CEMC1FL1  IFILE     SQL, FIXED=56,  KEY="D1-5"
CEMC1FL2  IFILE     SQL, FIXED=56, KEY="U6-12"
CEMC1CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 04 Fld     7
.-------------------------------------------------------
CEMD1NAM  INIT      "CEMD1"
CEMD1LEN  FORM      "51"
CEMD1IDX  INIT      "DC1-5 UC6-12"
CEMD1FNM  DIM       8  * Filename
CEMD1AFL  FORM      1  * End Accept Mode
CEMD1END  FORM      1  * End Display
CEMD1SNO  FORM      5  * Number of Items on the Screen
CEMD1NXT  DIM         12
CEMD1FL1  IFILE     SQL, FIXED=51,  KEY="D1-5"
CEMD1FL2  IFILE     SQL, FIXED=51, KEY="U6-12"
CEMD1CNT  FORM      3  * Number of Items on Screen
DOCTCODE  DIM       6 * Scr 05 Fld     4
DOCTNAME  DIM      40 * Scr 05 Fld     6
.
.    Multi Item Key Fields Scr 05 Fld     7
.-------------------------------------------------------
CEVA1NAM  INIT      "CEVA1"
CEVA1LEN  FORM      "54"
CEVA1IDX  INIT      "DC1-5 UC6-12"
CEVA1FNM  DIM       8  * Filename
CEVA1AFL  FORM      1  * End Accept Mode
CEVA1END  FORM      1  * End Display
CEVA1SNO  FORM      5  * Number of Items on the Screen
CEVA1NXT  DIM         12
CEVA1FL1  IFILE     SQL, FIXED=54,  KEY="D1-5"
CEVA1FL2  IFILE     SQL, FIXED=54, KEY="U6-12"
CEVA1CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 06 Fld     7
.-------------------------------------------------------
CEVB1NAM  INIT      "CEVB1"
CEVB1LEN  FORM      "51"
CEVB1IDX  INIT      "DC1-5 UC6-12"
CEVB1FNM  DIM       8  * Filename
CEVB1AFL  FORM      1  * End Accept Mode
CEVB1END  FORM      1  * End Display
CEVB1SNO  FORM      5  * Number of Items on the Screen
CEVB1NXT  DIM         12
CEVB1FL1  IFILE     SQL, FIXED=51,  KEY="D1-5"
CEVB1FL2  IFILE     SQL, FIXED=51, KEY="U6-12"
CEVB1CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 07 Fld    20
.-------------------------------------------------------
CEME1NAM  INIT      "CEME1"
CEME1LEN  FORM      "65"
CEME1IDX  INIT      "DC1-5 UC6-12"
CEME1FNM  DIM       8  * Filename
CEME1AFL  FORM      1  * End Accept Mode
CEME1END  FORM      1  * End Display
CEME1SNO  FORM      5  * Number of Items on the Screen
CEME1NXT  DIM         12
CEME1FL1  IFILE     SQL, FIXED=65,  KEY="D1-5"
CEME1FL2  IFILE     SQL, FIXED=65, KEY="U6-12"
CEME1CNT  FORM      3  * Number of Items on Screen
NAMEDOS   DIM      20 * Scr 07 Fld    23
NAMETYQ   DIM      20 * Scr 07 Fld    25
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACEA16"
PRGNAM    INIT      "Miscellaneous Patient Service Map       "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CLOSE     CEMA1FL2
          CLOSE     CEMA1FL1,DELETE
.
          CLOSE     CEMB1FL2
          CLOSE     CEMB1FL1,DELETE
.
          CLOSE     CEMC1FL2
          CLOSE     CEMC1FL1,DELETE
.
          CLOSE     CEMD1FL2
          CLOSE     CEMD1FL1,DELETE
.
          CLOSE     CEVA1FL2
          CLOSE     CEVA1FL1,DELETE
.
          CLOSE     CEVB1FL2
          CLOSE     CEVB1FL1,DELETE
.
          CLOSE     CEME1FL2
          CLOSE     CEME1FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening ccsstyaf";
          OPEN      CCSSTYA1,"ccsstyaf"
          DISPLAY   *P56:24,"Opening ccsstyaf";
          OPEN      CCSSTYA2,"ccsstyaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA1,"ccsxhdaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA2,"ccsxhdaf"
          DISPLAY   *P56:24,"Opening ccsxhdaf";
          OPEN      CCSXHDA3,"ccsxhdaf"
          MOVE      "   64",AUDTSECT
          MOVE      " 39",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ceaaudps";
            OPEN      CEAAUDPS,"ceaaudps"
          ENDIF
          DISPLAY   *P56:24,"Opening ceamapaf";
          OPEN      CEAMAPA1,"ceamapaf"
          DISPLAY   *P56:24,"Opening ceambpaf";
          OPEN      CEAMBPA1,"ceambpaf"
          DISPLAY   *P56:24,"Opening ceamcpaf";
          OPEN      CEAMCPA1,"ceamcpaf"
          DISPLAY   *P56:24,"Opening ceamdpaf";
          OPEN      CEAMDPA1,"ceamdpaf"
          DISPLAY   *P56:24,"Opening ceamepaf";
          OPEN      CEAMEPA1,"ceamepaf"
          DISPLAY   *P56:24,"Opening ceapscaf";
          OPEN      CEAPSCA1,"ceapscaf"
          DISPLAY   *P56:24,"Opening ceaspcaf";
          OPEN      CEASPCA1,"ceaspcaf"
          DISPLAY   *P56:24,"Opening ceavamaf";
          OPEN      CEAVAMA1,"ceavamaf"
          DISPLAY   *P56:24,"Opening ceavbmaf";
          OPEN      CEAVBMA1,"ceavbmaf"
          DISPLAY   *P56:24,"Opening  patcodes           ";
          OPEN      PATCODE1,"patcodes"          
          DISPLAY   *P56:24,"Opening  patcodes           ";
          OPEN      PATCODE2,"patcodes"          
          DISPLAY   *P56:24,"Opening  patcodes           ";
          OPEN      PATCODE3,"patcodes"          
          DISPLAY   *P56:24,"Opening  patcodes           ";
          OPEN      PATCODE4,"patcodes"          
          DISPLAY   *P56:24,"Opening  patdo1af           ";
          OPEN      PATDO1A1,"patdo1af"          
          DISPLAY   *P56:24,"Opening  patdo1af           ";
          OPEN      PATDO1A2,"patdo1af"          
          DISPLAY   *P56:24,"Opening  patdo1af           ";
          OPEN      PATDO1A3,"patdo1af"          
          DISPLAY   *P56:24,"Opening  patmchgf           ";
          OPEN      PATMCHG1,"patmchgf"          
          DISPLAY   *P56:24,"Opening  patmchgf           ";
          OPEN      PATMCHG2,"patmchgf"          
.--------------------------------------------------------
. Initialise Batch Screen Patient Service                    
.--------------------------------------------------------
          MOVE     ZERO,CEMA1SNO
          MOVE     "01   15",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CEMA1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Patient Service                    
.--------------------------------------------------------
          MOVE     ZERO,CEMB1SNO
          MOVE     "02   15",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CEMB1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Patient Service                    
.--------------------------------------------------------
          MOVE     ZERO,CEMC1SNO
          MOVE     "03   15",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CEMC1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Patient Service                    
.--------------------------------------------------------
          MOVE     ZERO,CEMD1SNO
          MOVE     "04    7",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CEMD1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Patient Service                    
.--------------------------------------------------------
          MOVE     ZERO,CEVA1SNO
          MOVE     "05    7",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CEVA1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Patient Service                    
.--------------------------------------------------------
          MOVE     ZERO,CEVB1SNO
          MOVE     "06    7",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CEVB1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Patient Service Code               
.--------------------------------------------------------
          MOVE     ZERO,CEME1SNO
          MOVE     "07   20",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CEME1SNO
            ENDIF
          ENDIF
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Options                            
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Misc Group Mapping to Pat. Serv.   
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Map Misc Charge Code to Pat. Serv. 
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Journal Mapping                    
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Map Discharge Status to Pat. Serv. 
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * VMO Doctor Mapping                 
          ENDIF
          MATCH     "06",SCRID
          IF         @EQUAL
            CALL       PS06L000   * Map VMO Doctor Type to Patient Serv
          ENDIF
          MATCH     "07",SCRID
          IF         @EQUAL
            CALL       PS07L000   * Casemix Type Mapping               
          ENDIF
          RETURN
.--------------------------------
. Screen - Options                            
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Options                            
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Options                            
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Options                            
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Options                            
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Options                            
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Options                            
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Options                            
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105,SF00L106,SF00L107:
                            SF00L108
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          CALL      SC04L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L106
          CALL      SC05L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L107
          CALL      SC06L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L108
          CALL      SC07L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Misc Group Mapping to Pat. Serv.   
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Misc Group Mapping to Pat. Serv.   
.-------------------------------------------------------
CF01L000
          MOVE      SP70,CEMAMGP 
          MOVE      SP70,CEMASPC 
          MOVE      SP70,CEMAPSC 
          MOVE      ZERO,CEMADQTY
          MOVE      ZERO,CEMATQTY
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Misc Group Mapping to Pat. Serv.   
.--------------------------------------------------------
KY01L000
.
KY01L110
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TDESC   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EMGRP000
          BRANCH    EXIT,KY01L900,KY01L900
          MOVE      ZERO,ACCEPT
          MOVE      CEMAMGP,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TDESC,VAR        
            CALL      DISPITEM
          ENDIF
.
KY01L120
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CESPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCESPA00
          MOVE      CESPSPC,CEMASPC
          BRANCH    EXIT,KY01L110,KY01L900
          MOVE      ZERO,ACCEPT
          MOVE      CEMASPC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CESPDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Misc Group Mapping to Pat. Serv.   
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Misc Group Mapping to Pat. Serv.   
.---------------------------------------------------------
LM01L000
.---------------------------------------------------------
. Load for :    15 Patient Service                    
.---------------------------------------------------------
          UNPACK    SP70,CEMAMGP,CEMASPC,CEMAPSC
          PACK      CEMA1FNM,ANST,CEMA1NAM,PORT
          REP       " 0",CEMA1FNM
          MOVE      ZERO,CEMA1AFL
          CLOSE     CEMA1FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CEMA1FL1,CEMA1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CEMA1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CEMA1FNM,SP1,CEMA1LEN,SP1,CEMA1IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      CEMA1FL1,CEMA1FNM
          OPEN      CEMA1FL2,CEMA1FNM
          PACK      KEY13,ACODE,CESPSPC,SP70
          MOVE      KEY13,SAVKEY80
          SETLPTR   SAVKEY80,6 
          CALL      RDCEMA1 
          IF        OVRCD=0
            CALL      RPCEMA1 
          ENDIF
LM01L100
          CALL      RKCEMA1 
          BRANCH    OVRCD,LM01L105
          PACK      KEY13,CEMAMGP,CEMASPC,CEMAPSC
          MATCH     SAVKEY80,KEY13   
          GOTO      LM01L105 IF NOT EQUAL
          RESET     KEY13,7
          MOVE      KEY13,KEY7
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TACEMA12
          IF        OVRCD=0
            CALL      TUCEMA12
          ELSE
            CALL      TWCEMA12
          ENDIF
          GOTO     LM01L100
LM01L105
          MOVE     SP70,KEY7   
          CALL     TSCEMA12
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Misc Group Mapping to Pat. Serv.   
.---------------------------------------------------------
SM01L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM01L010 IF EQUAL
SM01L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L101,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010
SM01L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM01L007
          MATCH     PRGID,SCPSPID
          GOTO      SM01L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM01L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM01L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM01L006 IF NOT EQUAL
          GOTO      SM01L005
SM01L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM01L010
          BRANCH    STDGSFLG,SM01L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM01L900
          MATCH     PRGID,SCPSPID
          GOTO      SM01L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM01L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM01L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM01L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L102,SM01L103,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                           SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010
          GOTO      SM01L010
.
SM01L101
          MOVE     ZERO,CEMA1AFL
          CALL      KCEPSA00
          MOVE      CEPSPSC,CEMAPSC
          BRANCH    EXIT,SM01L990,SM01L990
          PACK     KEY13,CEMAMGP,CEMASPC,CEMAPSC                                                   
          RESET    KEY13,7
          MOVE     KEY13,KEY7
          CALL      TACEMA12
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM01L101
          ENDIF
          MOVE      CEMAPSC,VAR      
          CALL      DISPITEM
          CALL      RPSC0000
.
.
          MOVE      "   16",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   19",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM01L010
.
SM01L102
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEMADQTY
          IF        SCPSMAN=1
            COMPARE   ZERO,CEMADQTY
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM01L102
            ENDIF
          ENDIF
          MOVE      CEMADQTY,VAR     
          CALL      DISPITEM
          GOTO     SM01L010
.
SM01L103
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEMATQTY
          IF        SCPSMAN=1
            COMPARE   ZERO,CEMATQTY
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM01L103
            ENDIF
          ENDIF
          MOVE      CEMATQTY,VAR     
          CALL      DISPITEM
          GOTO     SM01L010
SM01L900
          MATCH    "CEMA1",NAMSSFFI
          IF       @EQUAL
            PACK     KEY13,CEMAMGP,CEMASPC,CEMAPSC
            RESET    KEY13,7
            MOVE     KEY13,KEY7
            CALL      TACEMA12
            IF        OVRCD=0
              CALL      TUCEMA12
            ELSE
              CALL      TWCEMA12
            ENDIF
            GOTO      SM01L999
          ENDIF
          GOTO      SM01L999
SM01L990
          MATCH    "CEMA1",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,CEMA1AFL
          ENDIF
SM01L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP01L000
          MOVE     ZERO,CEMA1CNT
          MOVE     ZERO,CEMA1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP01L600
          MATCH    PRGID,SCPSPID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP01L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L010,DP01L101,DP01L102:
                            DP01L103,DP01L104,DP01L105,DP01L010:
                           DP01L010,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L010,DP01L010,DP01L010:
                           DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L010,DP01L010
          GOTO      DP01L010
.
DP01L101
          IF        CEMA1END=0
            CALL      TKCEMA12
            IF        OVRCD=1
              MOVE      ONE,CEMA1END
            ELSE
              MOVE      ZERO,CEMA1END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUCEMA12
              MOVE      CEMAPSC,VAR      
              CALL      DISPITEM
          CALL      RPSC0000
            ENDIF
          ENDIF
          IF        CEMA1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L102
          IF        CEMA1END=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L103
          IF        CEMA1END=0
            MOVE      CEMADQTY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L104
          IF        CEMA1END=0
            MOVE      CEMATQTY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L105
          IF        CEMA1END=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
DP01L600
          MATCH    "CEMA1",NAMSSFFI
          GOTO     DP01L605 IF NOT EQUAL
          GOTO     DP01L999
DP01L605
DP01L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP01L000
.
          CALL     CT01L000
          MATCH    "CEMA1",NAMSSFFI
          GOTO     FP01L105 IF NOT EQUAL
          MOVE     SP70,KEY7   
          CALL     TSCEMA12 * Start
          CALL     DP01L000
          GOTO     FP01L999
FP01L105
FP01L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP01L000
.
          CALL     CT01L000
          MATCH    "CEMA1",NAMSSFFI
          GOTO     LP01L105 IF NOT EQUAL
          PACK     KEY7,Z70
          CALL     TSCEMA12
          IF       OVRCD=1
            CALL     TPCEMA12 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CEMA1SNO
            CALL     TPCEMA12
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     LP01L999
LP01L105
LP01L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP01L000
.
PP01L100
          MATCH    "CEMA1",NAMSSFFI
          GOTO     PP01L115 IF NOT EQUAL
PP01L105
          MOVE     SP70,CEMA1NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCEMA11
          CALL     TKCEMA11 * First on Page
          MOVE     KEY7,CEMA1NXT
          CALL     TSCEMA12
          CALL     TPCEMA12 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP01L999
          ENDIF
.
          CALL     CT01L000
.
. Position and Display Page
.--------------------------
PP01L110
          MOVE     CEMA1NXT,KEY7   
          CALL     TSCEMA12
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CEMA1SNO
            CALL     TPCEMA12
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     PP01L999
PP01L115
PP01L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP01L000
          MATCH    "CEMA1",NAMSSFFI
          GOTO     NP01L115 IF NOT EQUAL
NP01L105
          MOVE     SP70,CEMA1NXT
          PACK     KEY5,Z70
          CALL     TSCEMA11
          CALL     TPCEMA11
          MOVE     KEY7,CEMA1NXT
          CALL     TSCEMA12
          CALL     TKCEMA12
          IF       OVRCD=1
            BEEP
            GOTO      NP01L999
          ENDIF
.
          CALL     CT01L000
.
. Position and Display Page
.--------------------------
NP01L110
          MOVE     CEMA1NXT,KEY7   
          CALL     TSCEMA12
          CALL     DP01L000
          GOTO     NP01L999
NP01L115
NP01L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT01L000
          MATCH    "CEMA1",NAMSSFFI
          GOTO     CT01L115 IF NOT EQUAL
CT01L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCEMA11
          CALL     TKCEMA11
          BRANCH   OVRCD,CT01L110
          CALL     TRCEMA12
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUCEMA12
          GOTO     CT01L105
CT01L110
          GOTO     CT01L999
CT01L115
CT01L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP01L000
          CALL     CT01L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP01L999
          MATCH    PRGID,SCPSPID
          GOTO     CP01L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP01L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP01L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP01L010,CP01L010,CP01L010,CP01L010:
                            CP01L010,CP01L010,CP01L010,CP01L010:
                            CP01L010,CP01L010,CP01L010,CP01L010:
                           CP01L010,CP01L010,CP01L100,CP01L100:
                            CP01L100,CP01L100,CP01L100,CP01L010:
                           CP01L010,CP01L010,CP01L010,CP01L010:
                           CP01L010,CP01L010,CP01L010,CP01L010:
                           CP01L010,CP01L010,CP01L010,CP01L010:
                            CP01L010,CP01L010,CP01L010,CP01L010
.
CP01L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP01L010
CP01L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD01L000
          CALL      CP01L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD01L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD01L000
          MATCH     PRGID,SCPSPID
          GOTO      AD01L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD01L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD01L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM01L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "CEMA1",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,CEMA1AFL
            GOTO      AD01L010 IF EQUAL
            CALL      FP01L000
            GOTO      AD01L999
          ENDIF
AD01L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL01L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL01L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL01L900,DL01L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL01L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "CEMA1",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRCEMA11
            IF        OVRCD=0
              CALL      TDCEMA12
            ELSE
              BEEP
              GOTO      DL01L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSCEMA11
            CALL      TKCEMA11
            MOVE     KEY7,CEMA1NXT
            CALL      CT01L000
            MOVE      CEMA1NXT,KEY7   
            CALL      TSCEMA12
            CALL      TPCEMA12
            CALL      DP01L000
            GOTO      DL01L005
          ENDIF
DL01L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL01L005
DL01L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Misc Group Mapping to Pat. Serv.   
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    15 Patient Service                    
.---------------------------------------------------------
TSCEMA11  RESET     KEY5
          READ      CEMA1FL1,KEY5;;
          RETURN
.
TSCEMA12  RESET     KEY7   
          READ      CEMA1FL2,KEY7;;
          RETURN
.
TACEMA12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CEMA1FL2,KEY7;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDCEMA11  RESET     KEY5
          DELETE    CEMA1FL1,KEY5
          RETURN
.
TDCEMA12  RESET     KEY7
          DELETE    CEMA1FL2,KEY7
          RETURN
.
TKCEMA11  MOVE      ZERO,OVRCD
          READKS    CEMA1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEMAMGP,CEMASPC,CEMAPSC,CEMADQTY,CEMATQTY:
                        CEMASPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TKCEMA12  MOVE      ZERO,OVRCD
          READKS    CEMA1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEMAMGP,CEMASPC,CEMAPSC,CEMADQTY,CEMATQTY:
                        CEMASPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCEMA11  MOVE      ZERO,OVRCD
          READKP    CEMA1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEMAMGP,CEMASPC,CEMAPSC,CEMADQTY,CEMATQTY:
                        CEMASPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCEMA12  MOVE      ZERO,OVRCD
          READKP    CEMA1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEMAMGP,CEMASPC,CEMAPSC,CEMADQTY,CEMATQTY:
                        CEMASPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCEMA11  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      CEMA1FL1,KEY5;SCTMROW,SCTMCOL,KEY7:
                        CEMAMGP,CEMASPC,CEMAPSC,CEMADQTY,CEMATQTY:
                        CEMASPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCEMA12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CEMA1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CEMAMGP,CEMASPC,CEMAPSC,CEMADQTY,CEMATQTY:
                        CEMASPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TUCEMA11  UPDATE    CEMA1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEMAMGP,CEMASPC,CEMAPSC,CEMADQTY,CEMATQTY:
                        CEMASPA                                                 
          RETURN
.
TUCEMA12
          UPDATE    CEMA1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEMAMGP,CEMASPC,CEMAPSC,CEMADQTY,CEMATQTY:
                        CEMASPA                                                 
          RETURN
.
TWCEMA12  RESET     KEY7   
          WRITE     CEMA1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CEMAMGP,CEMASPC,CEMAPSC,CEMADQTY,CEMATQTY:
                        CEMASPA                                                 
          RETURN
.---------------------------------------------------------
. Display Fields for : Misc Group Mapping to Pat. Serv.   
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
          MOVE      "CEMA1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      FP01L000
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Misc Group Mapping to Pat. Serv.   
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L101,PS01L102:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999
          GOTO     PS01L999
.
PS01L101
          MOVE      TDESC,VAR        
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      CESPDES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Misc Group Mapping to Pat. Serv.   
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L104,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L105,SF01L106:
                            SF01L107,SF01L108,SF01L109,SF01L110
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L104,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          MOVE      "CEMA1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L101
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      POSA0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELA0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF01L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF01L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF01L999
          ENDIF
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF01L000
          ENDIF
          GOTO      SF01L001
.
SF01L104
          CALL      SELECTED
          BRANCH    EXIT,SF01L001
          MOVE      "CEMA1",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRCEMA11
            BRANCH    OVRCD,SF01L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF01L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF01L001 IF NOT EQUAL
            CALL      SM01L000 * Change Line
          ELSE
            IF        CEMA1AFL=0
              MOVE      "CEMA1",NAMSSFFI
              MOVE     "   15",ITMSSFFI
              CALL      AD01L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF01L001
.
SF01L105
          MOVE      "CEMA1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      NP01L000
          GOTO     SF01L001
.
SF01L106
          MOVE      "CEMA1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      PP01L000
          GOTO     SF01L001
.
SF01L107
          MOVE      "CEMA1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      AD01L000
          GOTO     SF01L001
.
SF01L108
          MOVE      "CEMA1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      DL01L000
          GOTO     SF01L001
.
SF01L109
          MOVE      "CEMA1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L110
          MOVE      "CEMA1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      LP01L000
          GOTO     SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Map Misc Charge Code to Pat. Serv. 
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Map Misc Charge Code to Pat. Serv. 
.-------------------------------------------------------
CF02L000
          MOVE      SP70,CEMBMCC 
          MOVE      SP70,CEMASPC 
          MOVE      SP70,CEMBPSC 
          MOVE      ZERO,CEMBDQTY
          MOVE      ZERO,CEMBTQTY
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Map Misc Charge Code to Pat. Serv. 
.--------------------------------------------------------
KY02L000
.
KY02L110
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,MDESC   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KPMCHA00
          BRANCH    EXIT,KY02L900,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      CEMBMCC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      MDESC,VAR        
            CALL      DISPITEM
          ENDIF
.
KY02L120
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CESPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCESPA00
          MOVE      CESPSPC,CEMASPC
          BRANCH    EXIT,KY02L110,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      CEMASPC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CESPDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Map Misc Charge Code to Pat. Serv. 
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Map Misc Charge Code to Pat. Serv. 
.---------------------------------------------------------
LM02L000
.---------------------------------------------------------
. Load for :    15 Patient Service                    
.---------------------------------------------------------
          UNPACK    SP70,CEMBMCC,CEMBSPC,CEMBPSC
          PACK      CEMB1FNM,ANST,CEMB1NAM,PORT
          REP       " 0",CEMB1FNM
          MOVE      ZERO,CEMB1AFL
          CLOSE     CEMB1FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CEMB1FL1,CEMB1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CEMB1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CEMB1FNM,SP1,CEMB1LEN,SP1,CEMB1IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      CEMB1FL1,CEMB1FNM
          OPEN      CEMB1FL2,CEMB1FNM
          PACK      KEY19,MCHARGE,CESPSPC,SP70
          MOVE      KEY19,SAVKEY80
          SETLPTR   SAVKEY80,12
          CALL      RDCEMB1 
          IF        OVRCD=0
            CALL      RPCEMB1 
          ENDIF
LM02L100
          CALL      RKCEMB1 
          BRANCH    OVRCD,LM02L105
          PACK      KEY19,CEMBMCC,CEMBSPC,CEMBPSC
          MATCH     SAVKEY80,KEY19   
          GOTO      LM02L105 IF NOT EQUAL
          RESET     KEY19,13
          MOVE      KEY19,KEY7
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TACEMB12
          IF        OVRCD=0
            CALL      TUCEMB12
          ELSE
            CALL      TWCEMB12
          ENDIF
          GOTO     LM02L100
LM02L105
          MOVE     SP70,KEY7   
          CALL     TSCEMB12
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Map Misc Charge Code to Pat. Serv. 
.---------------------------------------------------------
SM02L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM02L010 IF EQUAL
SM02L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM02L010,SM02L010,SM02L010,SM02L010:
                            SM02L010,SM02L010,SM02L010,SM02L010:
                            SM02L010,SM02L010,SM02L010,SM02L010:
                           SM02L010,SM02L010,SM02L101,SM02L010:
                            SM02L010,SM02L010,SM02L010,SM02L010:
                           SM02L010,SM02L010,SM02L010,SM02L010:
                           SM02L010,SM02L010,SM02L010,SM02L010:
                           SM02L010,SM02L010,SM02L010,SM02L010:
                            SM02L010,SM02L010,SM02L010,SM02L010
SM02L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM02L007
          MATCH     PRGID,SCPSPID
          GOTO      SM02L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM02L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM02L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM02L006 IF NOT EQUAL
          GOTO      SM02L005
SM02L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM02L010
          BRANCH    STDGSFLG,SM02L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM02L900
          MATCH     PRGID,SCPSPID
          GOTO      SM02L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM02L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM02L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM02L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM02L010,SM02L010,SM02L010,SM02L010:
                            SM02L010,SM02L010,SM02L010,SM02L010:
                            SM02L010,SM02L010,SM02L010,SM02L010:
                           SM02L010,SM02L010,SM02L010,SM02L010:
                            SM02L102,SM02L103,SM02L010,SM02L010:
                           SM02L010,SM02L010,SM02L010,SM02L010:
                           SM02L010,SM02L010,SM02L010,SM02L010:
                           SM02L010,SM02L010,SM02L010,SM02L010:
                            SM02L010,SM02L010,SM02L010,SM02L010
          GOTO      SM02L010
.
SM02L101
          MOVE     ZERO,CEMB1AFL
          CALL      KCEPSA00
          MOVE      CEPSPSC,CEMBPSC
          BRANCH    EXIT,SM02L990,SM02L990
          PACK     KEY19,CEMBMCC,CEMBSPC,CEMBPSC                                                   
          RESET    KEY19,13
          MOVE     KEY19,KEY7
          CALL      TACEMB12
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM02L101
          ENDIF
          MOVE      CEMBPSC,VAR      
          CALL      DISPITEM
          CALL      RPSC0000
.
.
          MOVE      "   16",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   19",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM02L010
.
SM02L102
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEMBDQTY
          IF        SCPSMAN=1
            COMPARE   ZERO,CEMBDQTY
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM02L102
            ENDIF
          ENDIF
          MOVE      CEMBDQTY,VAR     
          CALL      DISPITEM
          GOTO     SM02L010
.
SM02L103
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEMBTQTY
          IF        SCPSMAN=1
            COMPARE   ZERO,CEMBTQTY
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM02L103
            ENDIF
          ENDIF
          MOVE      CEMBTQTY,VAR     
          CALL      DISPITEM
          GOTO     SM02L010
SM02L900
          MATCH    "CEMB1",NAMSSFFI
          IF       @EQUAL
            PACK     KEY19,CEMBMCC,CEMBSPC,CEMBPSC
            RESET    KEY19,13
            MOVE     KEY19,KEY7
            CALL      TACEMB12
            IF        OVRCD=0
              CALL      TUCEMB12
            ELSE
              CALL      TWCEMB12
            ENDIF
            GOTO      SM02L999
          ENDIF
          GOTO      SM02L999
SM02L990
          MATCH    "CEMB1",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,CEMB1AFL
          ENDIF
SM02L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP02L000
          MOVE     ZERO,CEMB1CNT
          MOVE     ZERO,CEMB1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP02L600
          MATCH    PRGID,SCPSPID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                           DP02L010,DP02L010,DP02L101,DP02L102:
                            DP02L103,DP02L104,DP02L105,DP02L010:
                           DP02L010,DP02L010,DP02L010,DP02L010:
                           DP02L010,DP02L010,DP02L010,DP02L010:
                           DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010
          GOTO      DP02L010
.
DP02L101
          IF        CEMB1END=0
            CALL      TKCEMB12
            IF        OVRCD=1
              MOVE      ONE,CEMB1END
            ELSE
              MOVE      ZERO,CEMB1END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUCEMB12
              MOVE      CEMBPSC,VAR      
              CALL      DISPITEM
          CALL      RPSC0000
            ENDIF
          ENDIF
          IF        CEMB1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L102
          IF        CEMB1END=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L103
          IF        CEMB1END=0
            MOVE      CEMBDQTY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L104
          IF        CEMB1END=0
            MOVE      CEMBTQTY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L105
          IF        CEMB1END=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
DP02L600
          MATCH    "CEMB1",NAMSSFFI
          GOTO     DP02L605 IF NOT EQUAL
          GOTO     DP02L999
DP02L605
DP02L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP02L000
.
          CALL     CT02L000
          MATCH    "CEMB1",NAMSSFFI
          GOTO     FP02L105 IF NOT EQUAL
          MOVE     SP70,KEY7   
          CALL     TSCEMB12 * Start
          CALL     DP02L000
          GOTO     FP02L999
FP02L105
FP02L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP02L000
.
          CALL     CT02L000
          MATCH    "CEMB1",NAMSSFFI
          GOTO     LP02L105 IF NOT EQUAL
          PACK     KEY7,Z70
          CALL     TSCEMB12
          IF       OVRCD=1
            CALL     TPCEMB12 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CEMB1SNO
            CALL     TPCEMB12
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     LP02L999
LP02L105
LP02L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP02L000
.
PP02L100
          MATCH    "CEMB1",NAMSSFFI
          GOTO     PP02L115 IF NOT EQUAL
PP02L105
          MOVE     SP70,CEMB1NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCEMB11
          CALL     TKCEMB11 * First on Page
          MOVE     KEY7,CEMB1NXT
          CALL     TSCEMB12
          CALL     TPCEMB12 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP02L999
          ENDIF
.
          CALL     CT02L000
.
. Position and Display Page
.--------------------------
PP02L110
          MOVE     CEMB1NXT,KEY7   
          CALL     TSCEMB12
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CEMB1SNO
            CALL     TPCEMB12
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     PP02L999
PP02L115
PP02L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP02L000
          MATCH    "CEMB1",NAMSSFFI
          GOTO     NP02L115 IF NOT EQUAL
NP02L105
          MOVE     SP70,CEMB1NXT
          PACK     KEY5,Z70
          CALL     TSCEMB11
          CALL     TPCEMB11
          MOVE     KEY7,CEMB1NXT
          CALL     TSCEMB12
          CALL     TKCEMB12
          IF       OVRCD=1
            BEEP
            GOTO      NP02L999
          ENDIF
.
          CALL     CT02L000
.
. Position and Display Page
.--------------------------
NP02L110
          MOVE     CEMB1NXT,KEY7   
          CALL     TSCEMB12
          CALL     DP02L000
          GOTO     NP02L999
NP02L115
NP02L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT02L000
          MATCH    "CEMB1",NAMSSFFI
          GOTO     CT02L115 IF NOT EQUAL
CT02L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCEMB11
          CALL     TKCEMB11
          BRANCH   OVRCD,CT02L110
          CALL     TRCEMB12
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUCEMB12
          GOTO     CT02L105
CT02L110
          GOTO     CT02L999
CT02L115
CT02L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP02L000
          CALL     CT02L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP02L999
          MATCH    PRGID,SCPSPID
          GOTO     CP02L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP02L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP02L010,CP02L010,CP02L010,CP02L010:
                            CP02L010,CP02L010,CP02L010,CP02L010:
                            CP02L010,CP02L010,CP02L010,CP02L010:
                           CP02L010,CP02L010,CP02L100,CP02L100:
                            CP02L100,CP02L100,CP02L100,CP02L010:
                           CP02L010,CP02L010,CP02L010,CP02L010:
                           CP02L010,CP02L010,CP02L010,CP02L010:
                           CP02L010,CP02L010,CP02L010,CP02L010:
                            CP02L010,CP02L010,CP02L010,CP02L010
.
CP02L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP02L010
CP02L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD02L000
          CALL      CP02L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD02L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD02L000
          MATCH     PRGID,SCPSPID
          GOTO      AD02L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD02L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD02L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM02L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "CEMB1",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,CEMB1AFL
            GOTO      AD02L010 IF EQUAL
            CALL      FP02L000
            GOTO      AD02L999
          ENDIF
AD02L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL02L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL02L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL02L900,DL02L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL02L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "CEMB1",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRCEMB11
            IF        OVRCD=0
              CALL      TDCEMB12
            ELSE
              BEEP
              GOTO      DL02L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSCEMB11
            CALL      TKCEMB11
            MOVE     KEY7,CEMB1NXT
            CALL      CT02L000
            MOVE      CEMB1NXT,KEY7   
            CALL      TSCEMB12
            CALL      TPCEMB12
            CALL      DP02L000
            GOTO      DL02L005
          ENDIF
DL02L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL02L005
DL02L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Map Misc Charge Code to Pat. Serv. 
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    15 Patient Service                    
.---------------------------------------------------------
TSCEMB11  RESET     KEY5
          READ      CEMB1FL1,KEY5;;
          RETURN
.
TSCEMB12  RESET     KEY7   
          READ      CEMB1FL2,KEY7;;
          RETURN
.
TACEMB12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CEMB1FL2,KEY7;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDCEMB11  RESET     KEY5
          DELETE    CEMB1FL1,KEY5
          RETURN
.
TDCEMB12  RESET     KEY7
          DELETE    CEMB1FL2,KEY7
          RETURN
.
TKCEMB11  MOVE      ZERO,OVRCD
          READKS    CEMB1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEMBMCC,CEMBSPC,CEMBPSC,CEMBDQTY,CEMBTQTY:
                        CEMBSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TKCEMB12  MOVE      ZERO,OVRCD
          READKS    CEMB1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEMBMCC,CEMBSPC,CEMBPSC,CEMBDQTY,CEMBTQTY:
                        CEMBSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCEMB11  MOVE      ZERO,OVRCD
          READKP    CEMB1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEMBMCC,CEMBSPC,CEMBPSC,CEMBDQTY,CEMBTQTY:
                        CEMBSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCEMB12  MOVE      ZERO,OVRCD
          READKP    CEMB1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEMBMCC,CEMBSPC,CEMBPSC,CEMBDQTY,CEMBTQTY:
                        CEMBSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCEMB11  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      CEMB1FL1,KEY5;SCTMROW,SCTMCOL,KEY7:
                        CEMBMCC,CEMBSPC,CEMBPSC,CEMBDQTY,CEMBTQTY:
                        CEMBSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCEMB12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CEMB1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CEMBMCC,CEMBSPC,CEMBPSC,CEMBDQTY,CEMBTQTY:
                        CEMBSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TUCEMB11  UPDATE    CEMB1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEMBMCC,CEMBSPC,CEMBPSC,CEMBDQTY,CEMBTQTY:
                        CEMBSPA                                                 
          RETURN
.
TUCEMB12
          UPDATE    CEMB1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEMBMCC,CEMBSPC,CEMBPSC,CEMBDQTY,CEMBTQTY:
                        CEMBSPA                                                 
          RETURN
.
TWCEMB12  RESET     KEY7   
          WRITE     CEMB1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CEMBMCC,CEMBSPC,CEMBPSC,CEMBDQTY,CEMBTQTY:
                        CEMBSPA                                                 
          RETURN
.---------------------------------------------------------
. Display Fields for : Map Misc Charge Code to Pat. Serv. 
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
          MOVE      "CEMB1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      FP02L000
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Map Misc Charge Code to Pat. Serv. 
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L101,PS02L102:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999
          GOTO     PS02L999
.
PS02L101
          MOVE      MDESC,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      CESPDES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Map Misc Charge Code to Pat. Serv. 
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102,SF02L103:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L006,SF02L006,SF02L104,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L006,SF02L006,SF02L105,SF02L106:
                            SF02L107,SF02L108,SF02L109,SF02L110
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L104,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          MOVE      "CEMB1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L101
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L102
          CALL      POSB0000
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELB0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF02L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF02L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF02L999
          ENDIF
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF02L000
          ENDIF
          GOTO      SF02L001
.
SF02L104
          CALL      SELECTED
          BRANCH    EXIT,SF02L001
          MOVE      "CEMB1",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRCEMB11
            BRANCH    OVRCD,SF02L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF02L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF02L001 IF NOT EQUAL
            CALL      SM02L000 * Change Line
          ELSE
            IF        CEMB1AFL=0
              MOVE      "CEMB1",NAMSSFFI
              MOVE     "   15",ITMSSFFI
              CALL      AD02L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF02L001
.
SF02L105
          MOVE      "CEMB1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      NP02L000
          GOTO     SF02L001
.
SF02L106
          MOVE      "CEMB1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      PP02L000
          GOTO     SF02L001
.
SF02L107
          MOVE      "CEMB1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      AD02L000
          GOTO     SF02L001
.
SF02L108
          MOVE      "CEMB1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      DL02L000
          GOTO     SF02L001
.
SF02L109
          MOVE      "CEMB1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L110
          MOVE      "CEMB1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      LP02L000
          GOTO     SF02L001
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Journal Mapping                    
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Journal Mapping                    
.-------------------------------------------------------
CF03L000
          MOVE      SP70,CEMCJCD 
          MOVE      SP70,CEMCSPC 
          MOVE      SP70,TDESC   
          MOVE      SP70,CESPDES 
          MOVE      SP70,CEMCPSC 
          MOVE      SP70,CEPSDES 
          MOVE      ZERO,CEMCDQTY
          MOVE      ZERO,CEMCTQTY
          MOVE      SP70,CEPSQDES
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Journal Mapping                    
.--------------------------------------------------------
KY03L000
.
KY03L110
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TDESC   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EJCOD000
          BRANCH    EXIT,KY03L900,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      CEMCJCD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TDESC,VAR        
            CALL      DISPITEM
          ENDIF
.
KY03L120
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CESPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCESPA00
          MOVE      CESPSPC,CEMCSPC
          BRANCH    EXIT,KY03L110,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      CEMCSPC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CESPDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Journal Mapping                    
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Journal Mapping                    
.---------------------------------------------------------
LM03L000
.---------------------------------------------------------
. Load for :    15 Patient Service                    
.---------------------------------------------------------
          UNPACK    SP70,CEMCJCD,CEMCSPC,CEMCPSC
          PACK      CEMC1FNM,ANST,CEMC1NAM,PORT
          REP       " 0",CEMC1FNM
          MOVE      ZERO,CEMC1AFL
          CLOSE     CEMC1FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CEMC1FL1,CEMC1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CEMC1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CEMC1FNM,SP1,CEMC1LEN,SP1,CEMC1IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      CEMC1FL1,CEMC1FNM
          OPEN      CEMC1FL2,CEMC1FNM
          PACK      KEY13,ACODE,CESPSPC,SP70
          MOVE      KEY13,SAVKEY80
          SETLPTR   SAVKEY80,6 
          CALL      RDCEMC1 
          IF        OVRCD=0
            CALL      RPCEMC1 
          ENDIF
LM03L100
          CALL      RKCEMC1 
          BRANCH    OVRCD,LM03L105
          PACK      KEY13,CEMCJCD,CEMCSPC,CEMCPSC
          MATCH     SAVKEY80,KEY13   
          GOTO      LM03L105 IF NOT EQUAL
          RESET     KEY13,7
          MOVE      KEY13,KEY7
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TACEMC12
          IF        OVRCD=0
            CALL      TUCEMC12
          ELSE
            CALL      TWCEMC12
          ENDIF
          GOTO     LM03L100
LM03L105
          MOVE     SP70,KEY7   
          CALL     TSCEMC12
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Journal Mapping                    
.---------------------------------------------------------
SM03L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM03L010 IF EQUAL
SM03L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L101,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010
SM03L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM03L007
          MATCH     PRGID,SCPSPID
          GOTO      SM03L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM03L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM03L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM03L006 IF NOT EQUAL
          GOTO      SM03L005
SM03L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM03L010
          BRANCH    STDGSFLG,SM03L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM03L900
          MATCH     PRGID,SCPSPID
          GOTO      SM03L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM03L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM03L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM03L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L102,SM03L103,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L010,SM03L010:
                           SM03L010,SM03L010,SM03L010,SM03L010:
                            SM03L010,SM03L010,SM03L010,SM03L010
          GOTO      SM03L010
.
SM03L101
          MOVE     ZERO,CEMC1AFL
          CALL      KCEPSA00
          MOVE      CEPSPSC,CEMCPSC
          BRANCH    EXIT,SM03L990,SM03L990
          PACK     KEY13,CEMCJCD,CEMCSPC,CEMCPSC                                                   
          RESET    KEY13,7
          MOVE     KEY13,KEY7
          CALL      TACEMC12
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM03L101
          ENDIF
          MOVE      CEMCPSC,VAR      
          CALL      DISPITEM
          CALL      RPSC0000
.
.
          MOVE      "   16",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   19",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM03L010
.
SM03L102
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEMCDQTY
          IF        SCPSMAN=1
            COMPARE   ZERO,CEMCDQTY
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM03L102
            ENDIF
          ENDIF
          MOVE      CEMCDQTY,VAR     
          CALL      DISPITEM
          GOTO     SM03L010
.
SM03L103
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEMCTQTY
          IF        SCPSMAN=1
            COMPARE   ZERO,CEMCTQTY
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM03L103
            ENDIF
          ENDIF
          MOVE      CEMCTQTY,VAR     
          CALL      DISPITEM
          GOTO     SM03L010
SM03L900
          MATCH    "CEMC1",NAMSSFFI
          IF       @EQUAL
            PACK     KEY13,CEMCJCD,CEMCSPC,CEMCPSC
            RESET    KEY13,7
            MOVE     KEY13,KEY7
            CALL      TACEMC12
            IF        OVRCD=0
              CALL      TUCEMC12
            ELSE
              CALL      TWCEMC12
            ENDIF
            GOTO      SM03L999
          ENDIF
          GOTO      SM03L999
SM03L990
          MATCH    "CEMC1",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,CEMC1AFL
          ENDIF
SM03L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP03L000
          MOVE     ZERO,CEMC1CNT
          MOVE     ZERO,CEMC1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP03L600
          MATCH    PRGID,SCPSPID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP03L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010:
                           DP03L010,DP03L010,DP03L101,DP03L102:
                            DP03L103,DP03L104,DP03L105,DP03L010:
                           DP03L010,DP03L010,DP03L010,DP03L010:
                           DP03L010,DP03L010,DP03L010,DP03L010:
                           DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010
          GOTO      DP03L010
.
DP03L101
          IF        CEMC1END=0
            CALL      TKCEMC12
            IF        OVRCD=1
              MOVE      ONE,CEMC1END
            ELSE
              MOVE      ZERO,CEMC1END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUCEMC12
              MOVE      CEMCPSC,VAR      
              CALL      DISPITEM
          CALL      RPSC0000
            ENDIF
          ENDIF
          IF        CEMC1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L102
          IF        CEMC1END=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L103
          IF        CEMC1END=0
            MOVE      CEMCDQTY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L104
          IF        CEMC1END=0
            MOVE      CEMCTQTY,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L105
          IF        CEMC1END=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
DP03L600
          MATCH    "CEMC1",NAMSSFFI
          GOTO     DP03L605 IF NOT EQUAL
          GOTO     DP03L999
DP03L605
DP03L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP03L000
.
          CALL     CT03L000
          MATCH    "CEMC1",NAMSSFFI
          GOTO     FP03L105 IF NOT EQUAL
          MOVE     SP70,KEY7   
          CALL     TSCEMC12 * Start
          CALL     DP03L000
          GOTO     FP03L999
FP03L105
FP03L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP03L000
.
          CALL     CT03L000
          MATCH    "CEMC1",NAMSSFFI
          GOTO     LP03L105 IF NOT EQUAL
          PACK     KEY7,Z70
          CALL     TSCEMC12
          IF       OVRCD=1
            CALL     TPCEMC12 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CEMC1SNO
            CALL     TPCEMC12
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     LP03L999
LP03L105
LP03L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP03L000
.
PP03L100
          MATCH    "CEMC1",NAMSSFFI
          GOTO     PP03L115 IF NOT EQUAL
PP03L105
          MOVE     SP70,CEMC1NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCEMC11
          CALL     TKCEMC11 * First on Page
          MOVE     KEY7,CEMC1NXT
          CALL     TSCEMC12
          CALL     TPCEMC12 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP03L999
          ENDIF
.
          CALL     CT03L000
.
. Position and Display Page
.--------------------------
PP03L110
          MOVE     CEMC1NXT,KEY7   
          CALL     TSCEMC12
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CEMC1SNO
            CALL     TPCEMC12
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     PP03L999
PP03L115
PP03L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP03L000
          MATCH    "CEMC1",NAMSSFFI
          GOTO     NP03L115 IF NOT EQUAL
NP03L105
          MOVE     SP70,CEMC1NXT
          PACK     KEY5,Z70
          CALL     TSCEMC11
          CALL     TPCEMC11
          MOVE     KEY7,CEMC1NXT
          CALL     TSCEMC12
          CALL     TKCEMC12
          IF       OVRCD=1
            BEEP
            GOTO      NP03L999
          ENDIF
.
          CALL     CT03L000
.
. Position and Display Page
.--------------------------
NP03L110
          MOVE     CEMC1NXT,KEY7   
          CALL     TSCEMC12
          CALL     DP03L000
          GOTO     NP03L999
NP03L115
NP03L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT03L000
          MATCH    "CEMC1",NAMSSFFI
          GOTO     CT03L115 IF NOT EQUAL
CT03L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCEMC11
          CALL     TKCEMC11
          BRANCH   OVRCD,CT03L110
          CALL     TRCEMC12
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUCEMC12
          GOTO     CT03L105
CT03L110
          GOTO     CT03L999
CT03L115
CT03L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP03L000
          CALL     CT03L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP03L999
          MATCH    PRGID,SCPSPID
          GOTO     CP03L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP03L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP03L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP03L010,CP03L010,CP03L010,CP03L010:
                            CP03L010,CP03L010,CP03L010,CP03L010:
                            CP03L010,CP03L010,CP03L010,CP03L010:
                           CP03L010,CP03L010,CP03L100,CP03L100:
                            CP03L100,CP03L100,CP03L100,CP03L010:
                           CP03L010,CP03L010,CP03L010,CP03L010:
                           CP03L010,CP03L010,CP03L010,CP03L010:
                           CP03L010,CP03L010,CP03L010,CP03L010:
                            CP03L010,CP03L010,CP03L010,CP03L010
.
CP03L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP03L010
CP03L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD03L000
          CALL      CP03L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD03L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD03L000
          MATCH     PRGID,SCPSPID
          GOTO      AD03L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD03L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD03L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM03L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "CEMC1",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,CEMC1AFL
            GOTO      AD03L010 IF EQUAL
            CALL      FP03L000
            GOTO      AD03L999
          ENDIF
AD03L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL03L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL03L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL03L900,DL03L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL03L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "CEMC1",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRCEMC11
            IF        OVRCD=0
              CALL      TDCEMC12
            ELSE
              BEEP
              GOTO      DL03L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSCEMC11
            CALL      TKCEMC11
            MOVE     KEY7,CEMC1NXT
            CALL      CT03L000
            MOVE      CEMC1NXT,KEY7   
            CALL      TSCEMC12
            CALL      TPCEMC12
            CALL      DP03L000
            GOTO      DL03L005
          ENDIF
DL03L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL03L005
DL03L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Journal Mapping                    
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    15 Patient Service                    
.---------------------------------------------------------
TSCEMC11  RESET     KEY5
          READ      CEMC1FL1,KEY5;;
          RETURN
.
TSCEMC12  RESET     KEY7   
          READ      CEMC1FL2,KEY7;;
          RETURN
.
TACEMC12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CEMC1FL2,KEY7;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDCEMC11  RESET     KEY5
          DELETE    CEMC1FL1,KEY5
          RETURN
.
TDCEMC12  RESET     KEY7
          DELETE    CEMC1FL2,KEY7
          RETURN
.
TKCEMC11  MOVE      ZERO,OVRCD
          READKS    CEMC1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEMCJCD,CEMCSPC,CEMCPSC,CEMCDQTY,CEMCTQTY:
                        CEMCSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TKCEMC12  MOVE      ZERO,OVRCD
          READKS    CEMC1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEMCJCD,CEMCSPC,CEMCPSC,CEMCDQTY,CEMCTQTY:
                        CEMCSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCEMC11  MOVE      ZERO,OVRCD
          READKP    CEMC1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEMCJCD,CEMCSPC,CEMCPSC,CEMCDQTY,CEMCTQTY:
                        CEMCSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCEMC12  MOVE      ZERO,OVRCD
          READKP    CEMC1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEMCJCD,CEMCSPC,CEMCPSC,CEMCDQTY,CEMCTQTY:
                        CEMCSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCEMC11  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      CEMC1FL1,KEY5;SCTMROW,SCTMCOL,KEY7:
                        CEMCJCD,CEMCSPC,CEMCPSC,CEMCDQTY,CEMCTQTY:
                        CEMCSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCEMC12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CEMC1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CEMCJCD,CEMCSPC,CEMCPSC,CEMCDQTY,CEMCTQTY:
                        CEMCSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TUCEMC11  UPDATE    CEMC1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEMCJCD,CEMCSPC,CEMCPSC,CEMCDQTY,CEMCTQTY:
                        CEMCSPA                                                 
          RETURN
.
TUCEMC12
          UPDATE    CEMC1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEMCJCD,CEMCSPC,CEMCPSC,CEMCDQTY,CEMCTQTY:
                        CEMCSPA                                                 
          RETURN
.
TWCEMC12  RESET     KEY7   
          WRITE     CEMC1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CEMCJCD,CEMCSPC,CEMCPSC,CEMCDQTY,CEMCTQTY:
                        CEMCSPA                                                 
          RETURN
.---------------------------------------------------------
. Display Fields for : Journal Mapping                    
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
          MOVE      "CEMC1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      FP03L000
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Journal Mapping                    
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L101,PS03L102:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                           PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999
          GOTO     PS03L999
.
PS03L101
          MOVE      TDESC,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      CESPDES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Journal Mapping                    
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L103:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L006,SF03L104,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L006,SF03L006,SF03L006:
                           SF03L006,SF03L006,SF03L105,SF03L106:
                            SF03L107,SF03L108,SF03L109,SF03L110
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L104,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                           SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          MOVE      "CEMC1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L101
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L102
          CALL      POSC0000
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELC0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF03L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF03L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF03L999
          ENDIF
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF03L000
          ENDIF
          GOTO      SF03L001
.
SF03L104
          CALL      SELECTED
          BRANCH    EXIT,SF03L001
          MOVE      "CEMC1",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRCEMC11
            BRANCH    OVRCD,SF03L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF03L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF03L001 IF NOT EQUAL
            CALL      SM03L000 * Change Line
          ELSE
            IF        CEMC1AFL=0
              MOVE      "CEMC1",NAMSSFFI
              MOVE     "   15",ITMSSFFI
              CALL      AD03L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF03L001
.
SF03L105
          MOVE      "CEMC1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      NP03L000
          GOTO     SF03L001
.
SF03L106
          MOVE      "CEMC1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      PP03L000
          GOTO     SF03L001
.
SF03L107
          MOVE      "CEMC1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      AD03L000
          GOTO     SF03L001
.
SF03L108
          MOVE      "CEMC1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      DL03L000
          GOTO     SF03L001
.
SF03L109
          MOVE      "CEMC1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L110
          MOVE      "CEMC1",NAMSSFFI
          MOVE      "   15",ITMSSFFI
          CALL      LP03L000
          GOTO     SF03L001
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Map Discharge Status to Pat. Serv. 
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Map Discharge Status to Pat. Serv. 
.-------------------------------------------------------
CF04L000
          MOVE      SP70,ACODE   
          MOVE      SP70,CEMDSPC 
          MOVE      SP70,TDESC   
          MOVE      SP70,CEMDPSC 
          MOVE      ZERO,CEMDQTY 
          MOVE      SP70,CEPSDES 
          MOVE      SP70,CESPDES 
          MOVE      SP70,CEPSQDES
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Map Discharge Status to Pat. Serv. 
.--------------------------------------------------------
KY04L000
.
KY04L110
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TDESC   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EDST0000
          BRANCH    EXIT,KY04L900,KY04L900
          MOVE      ZERO,ACCEPT
          MOVE      ACODE,VAR        
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TDESC,VAR        
            CALL      DISPITEM
          ENDIF
.
KY04L120
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CESPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCESPA00
          MOVE      CESPSPC,CEMDSPC
          BRANCH    EXIT,KY04L110,KY04L900
          MOVE      ZERO,ACCEPT
          MOVE      CEMDSPC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CESPDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Map Discharge Status to Pat. Serv. 
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Map Discharge Status to Pat. Serv. 
.---------------------------------------------------------
LM04L000
.---------------------------------------------------------
. Load for :     7 Patient Service                    
.---------------------------------------------------------
          UNPACK    SP70,CEMDCOD,CEMDSPC,CEMDPSC
          PACK      CEMD1FNM,ANST,CEMD1NAM,PORT
          REP       " 0",CEMD1FNM
          MOVE      ZERO,CEMD1AFL
          CLOSE     CEMD1FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CEMD1FL1,CEMD1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CEMD1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CEMD1FNM,SP1,CEMD1LEN,SP1,CEMD1IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      CEMD1FL1,CEMD1FNM
          OPEN      CEMD1FL2,CEMD1FNM
          PACK      KEY13,ACODE,CESPSPC,SP70
          MOVE      KEY13,SAVKEY80
          SETLPTR   SAVKEY80,6 
          CALL      RDCEMD1 
          IF        OVRCD=0
            CALL      RPCEMD1 
          ENDIF
LM04L100
          CALL      RKCEMD1 
          BRANCH    OVRCD,LM04L105
          PACK      KEY13,CEMDCOD,CEMDSPC,CEMDPSC
          MATCH     SAVKEY80,KEY13   
          GOTO      LM04L105 IF NOT EQUAL
          RESET     KEY13,7
          MOVE      KEY13,KEY7
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TACEMD12
          IF        OVRCD=0
            CALL      TUCEMD12
          ELSE
            CALL      TWCEMD12
          ENDIF
          GOTO     LM04L100
LM04L105
          MOVE     SP70,KEY7   
          CALL     TSCEMD12
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Map Discharge Status to Pat. Serv. 
.---------------------------------------------------------
SM04L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM04L010 IF EQUAL
SM04L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM04L010,SM04L010,SM04L010,SM04L010:
                            SM04L010,SM04L010,SM04L101,SM04L010:
                            SM04L010,SM04L010,SM04L010,SM04L010:
                            SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                            SM04L010,SM04L010
SM04L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM04L007
          MATCH     PRGID,SCPSPID
          GOTO      SM04L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM04L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM04L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM04L006 IF NOT EQUAL
          GOTO      SM04L005
SM04L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM04L010
          BRANCH    STDGSFLG,SM04L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM04L900
          MATCH     PRGID,SCPSPID
          GOTO      SM04L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM04L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM04L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM04L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM04L010,SM04L010,SM04L010,SM04L010:
                            SM04L010,SM04L010,SM04L010,SM04L102:
                            SM04L010,SM04L010,SM04L010,SM04L010:
                            SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                           SM04L010,SM04L010,SM04L010,SM04L010:
                            SM04L010,SM04L010
          GOTO      SM04L010
.
SM04L101
          MOVE     ZERO,CEMD1AFL
          CALL      KCEPSA00
          MOVE      CEPSPSC,CEMDPSC
          BRANCH    EXIT,SM04L990,SM04L990
          PACK     KEY13,CEMDCOD,CEMDSPC,CEMDPSC                                                   
          RESET    KEY13,7
          MOVE     KEY13,KEY7
          CALL      TACEMD12
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM04L101
          ENDIF
          MOVE      CEMDPSC,VAR      
          CALL      DISPITEM
          CALL      RPSC0000
.
.
          MOVE      "   10",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   12",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM04L010
.
SM04L102
          CALL      DEFONE00
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEMDQTY 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEMDQTY 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM04L102
            ENDIF
          ENDIF
          MOVE      CEMDQTY,VAR      
          CALL      DISPITEM
          GOTO     SM04L010
SM04L900
          MATCH    "CEMD1",NAMSSFFI
          IF       @EQUAL
            PACK     KEY13,CEMDCOD,CEMDSPC,CEMDPSC
            RESET    KEY13,7
            MOVE     KEY13,KEY7
            CALL      TACEMD12
            IF        OVRCD=0
              CALL      TUCEMD12
            ELSE
              CALL      TWCEMD12
            ENDIF
            GOTO      SM04L999
          ENDIF
          GOTO      SM04L999
SM04L990
          MATCH    "CEMD1",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,CEMD1AFL
          ENDIF
SM04L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP04L000
          MOVE     ZERO,CEMD1CNT
          MOVE     ZERO,CEMD1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP04L600
          MATCH    PRGID,SCPSPID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP04L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L101,DP04L102:
                            DP04L010,DP04L103,DP04L010,DP04L104:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                           DP04L010,DP04L010,DP04L010,DP04L010:
                           DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010
          GOTO      DP04L010
.
DP04L101
          IF        CEMD1END=0
            CALL      TKCEMD12
            IF        OVRCD=1
              MOVE      ONE,CEMD1END
            ELSE
              MOVE      ZERO,CEMD1END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUCEMD12
              MOVE      CEMDPSC,VAR      
              CALL      DISPITEM
          CALL      RPSC0000
            ENDIF
          ENDIF
          IF        CEMD1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L102
          IF        CEMD1END=0
            MOVE      CEMDQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L103
          IF        CEMD1END=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L104
          IF        CEMD1END=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
DP04L600
          MATCH    "CEMD1",NAMSSFFI
          GOTO     DP04L605 IF NOT EQUAL
          GOTO     DP04L999
DP04L605
DP04L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP04L000
.
          CALL     CT04L000
          MATCH    "CEMD1",NAMSSFFI
          GOTO     FP04L105 IF NOT EQUAL
          MOVE     SP70,KEY7   
          CALL     TSCEMD12 * Start
          CALL     DP04L000
          GOTO     FP04L999
FP04L105
FP04L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP04L000
.
          CALL     CT04L000
          MATCH    "CEMD1",NAMSSFFI
          GOTO     LP04L105 IF NOT EQUAL
          PACK     KEY7,Z70
          CALL     TSCEMD12
          IF       OVRCD=1
            CALL     TPCEMD12 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CEMD1SNO
            CALL     TPCEMD12
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     LP04L999
LP04L105
LP04L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP04L000
.
PP04L100
          MATCH    "CEMD1",NAMSSFFI
          GOTO     PP04L115 IF NOT EQUAL
PP04L105
          MOVE     SP70,CEMD1NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCEMD11
          CALL     TKCEMD11 * First on Page
          MOVE     KEY7,CEMD1NXT
          CALL     TSCEMD12
          CALL     TPCEMD12 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP04L999
          ENDIF
.
          CALL     CT04L000
.
. Position and Display Page
.--------------------------
PP04L110
          MOVE     CEMD1NXT,KEY7   
          CALL     TSCEMD12
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CEMD1SNO
            CALL     TPCEMD12
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     PP04L999
PP04L115
PP04L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP04L000
          MATCH    "CEMD1",NAMSSFFI
          GOTO     NP04L115 IF NOT EQUAL
NP04L105
          MOVE     SP70,CEMD1NXT
          PACK     KEY5,Z70
          CALL     TSCEMD11
          CALL     TPCEMD11
          MOVE     KEY7,CEMD1NXT
          CALL     TSCEMD12
          CALL     TKCEMD12
          IF       OVRCD=1
            BEEP
            GOTO      NP04L999
          ENDIF
.
          CALL     CT04L000
.
. Position and Display Page
.--------------------------
NP04L110
          MOVE     CEMD1NXT,KEY7   
          CALL     TSCEMD12
          CALL     DP04L000
          GOTO     NP04L999
NP04L115
NP04L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT04L000
          MATCH    "CEMD1",NAMSSFFI
          GOTO     CT04L115 IF NOT EQUAL
CT04L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCEMD11
          CALL     TKCEMD11
          BRANCH   OVRCD,CT04L110
          CALL     TRCEMD12
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUCEMD12
          GOTO     CT04L105
CT04L110
          GOTO     CT04L999
CT04L115
CT04L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP04L000
          CALL     CT04L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP04L999
          MATCH    PRGID,SCPSPID
          GOTO     CP04L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP04L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP04L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP04L010,CP04L010,CP04L010,CP04L010:
                            CP04L010,CP04L010,CP04L100,CP04L100:
                            CP04L010,CP04L100,CP04L010,CP04L100:
                            CP04L010,CP04L010,CP04L010,CP04L010:
                           CP04L010,CP04L010,CP04L010,CP04L010:
                           CP04L010,CP04L010,CP04L010,CP04L010:
                            CP04L010,CP04L010
.
CP04L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP04L010
CP04L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD04L000
          CALL      CP04L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD04L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD04L000
          MATCH     PRGID,SCPSPID
          GOTO      AD04L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD04L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD04L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM04L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "CEMD1",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,CEMD1AFL
            GOTO      AD04L010 IF EQUAL
            CALL      FP04L000
            GOTO      AD04L999
          ENDIF
AD04L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL04L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL04L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL04L900,DL04L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL04L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "CEMD1",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRCEMD11
            IF        OVRCD=0
              CALL      TDCEMD12
            ELSE
              BEEP
              GOTO      DL04L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSCEMD11
            CALL      TKCEMD11
            MOVE     KEY7,CEMD1NXT
            CALL      CT04L000
            MOVE      CEMD1NXT,KEY7   
            CALL      TSCEMD12
            CALL      TPCEMD12
            CALL      DP04L000
            GOTO      DL04L005
          ENDIF
DL04L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL04L005
DL04L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Map Discharge Status to Pat. Serv. 
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     7 Patient Service                    
.---------------------------------------------------------
TSCEMD11  RESET     KEY5
          READ      CEMD1FL1,KEY5;;
          RETURN
.
TSCEMD12  RESET     KEY7   
          READ      CEMD1FL2,KEY7;;
          RETURN
.
TACEMD12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CEMD1FL2,KEY7;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDCEMD11  RESET     KEY5
          DELETE    CEMD1FL1,KEY5
          RETURN
.
TDCEMD12  RESET     KEY7
          DELETE    CEMD1FL2,KEY7
          RETURN
.
TKCEMD11  MOVE      ZERO,OVRCD
          READKS    CEMD1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEMDCOD,CEMDSPC,CEMDPSC,CEMDQTY,CEMDSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TKCEMD12  MOVE      ZERO,OVRCD
          READKS    CEMD1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEMDCOD,CEMDSPC,CEMDPSC,CEMDQTY,CEMDSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCEMD11  MOVE      ZERO,OVRCD
          READKP    CEMD1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEMDCOD,CEMDSPC,CEMDPSC,CEMDQTY,CEMDSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCEMD12  MOVE      ZERO,OVRCD
          READKP    CEMD1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEMDCOD,CEMDSPC,CEMDPSC,CEMDQTY,CEMDSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCEMD11  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      CEMD1FL1,KEY5;SCTMROW,SCTMCOL,KEY7:
                        CEMDCOD,CEMDSPC,CEMDPSC,CEMDQTY,CEMDSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCEMD12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CEMD1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CEMDCOD,CEMDSPC,CEMDPSC,CEMDQTY,CEMDSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TUCEMD11  UPDATE    CEMD1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEMDCOD,CEMDSPC,CEMDPSC,CEMDQTY,CEMDSPA                 
          RETURN
.
TUCEMD12
          UPDATE    CEMD1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEMDCOD,CEMDSPC,CEMDPSC,CEMDQTY,CEMDSPA                 
          RETURN
.
TWCEMD12  RESET     KEY7   
          WRITE     CEMD1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CEMDCOD,CEMDSPC,CEMDPSC,CEMDQTY,CEMDSPA                 
          RETURN
.---------------------------------------------------------
. Display Fields for : Map Discharge Status to Pat. Serv. 
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
          MOVE      "CEMD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP04L000
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Map Discharge Status to Pat. Serv. 
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L101,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L102,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                           PS04L999,PS04L999,PS04L999,PS04L999:
                           PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999
          GOTO     PS04L999
.
PS04L101
          MOVE      TDESC,VAR        
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      CESPDES,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Map Discharge Status to Pat. Serv. 
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L102,SF04L006:
                            SF04L006,SF04L006,SF04L103,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                           SF04L006,SF04L006,SF04L006,SF04L006:
                           SF04L104,SF04L105,SF04L106,SF04L107:
                            SF04L108,SF04L109
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L103,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L020:
                           SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          MOVE      "CEMD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L101
          CALL      POSD0000
          MOVE      ONE,EXIT
          GOTO      SF04L999
.
SF04L102
          MOVE      ONE,EXIT
          GOTO      SF04L999
.
SF04L103
          CALL      SELECTED
          BRANCH    EXIT,SF04L001
          MOVE      "CEMD1",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRCEMD11
            BRANCH    OVRCD,SF04L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF04L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF04L001 IF NOT EQUAL
            CALL      SM04L000 * Change Line
          ELSE
            IF        CEMD1AFL=0
              MOVE      "CEMD1",NAMSSFFI
              MOVE     "    7",ITMSSFFI
              CALL      AD04L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF04L001
.
SF04L104
          MOVE      "CEMD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      NP04L000
          GOTO     SF04L001
.
SF04L105
          MOVE      "CEMD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      PP04L000
          GOTO     SF04L001
.
SF04L106
          MOVE      "CEMD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      AD04L000
          GOTO     SF04L001
.
SF04L107
          MOVE      "CEMD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      DL04L000
          GOTO     SF04L001
.
SF04L108
          MOVE      "CEMD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L109
          MOVE      "CEMD1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      LP04L000
          GOTO     SF04L001
SF04L990  MOVE      FOUR,EXIT * Exit Char Exit
SF04L999  RETURN
.--------------------------------
. Screen - VMO Doctor Mapping                 
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC05L200
          CALL      CF05L000 * Clear Fields
          CALL      GETDOC00
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : VMO Doctor Mapping                 
.-------------------------------------------------------
CF05L000
          MOVE      SP70,DOCTCODE
          MOVE      SP70,CEVASPC 
          MOVE      SP70,CEVAPSC 
          MOVE      ZERO,CEVAQTY 
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for VMO Doctor Mapping                 
.--------------------------------------------------------
KY05L000
.
KY05L110
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DOCTNAME
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EDOC0000
          BRANCH    EXIT,KY05L900,KY05L900
          MOVE      ZERO,ACCEPT
          MOVE      DOCTCODE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DOCTNAME,VAR     
            CALL      DISPITEM
          ENDIF
.
KY05L120
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CESPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCESPA00
          MOVE      CESPSPC,CEVASPC
          BRANCH    EXIT,KY05L110,KY05L900
          MOVE      ZERO,ACCEPT
          MOVE      CEVASPC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CESPDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : VMO Doctor Mapping                 
.---------------------------------------------------------
WP05L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : VMO Doctor Mapping                 
.---------------------------------------------------------
LM05L000
.---------------------------------------------------------
. Load for :     7 Patient Service                    
.---------------------------------------------------------
          UNPACK    SP70,CEVADOC,CEVASPC,CEVAPSC
          PACK      CEVA1FNM,ANST,CEVA1NAM,PORT
          REP       " 0",CEVA1FNM
          MOVE      ZERO,CEVA1AFL
          CLOSE     CEVA1FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CEVA1FL1,CEVA1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CEVA1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CEVA1FNM,SP1,CEVA1LEN,SP1,CEVA1IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      CEVA1FL1,CEVA1FNM
          OPEN      CEVA1FL2,CEVA1FNM
          PACK      KEY16,DOCTCODE,CESPSPC,SP70
          MOVE      KEY16,SAVKEY80
          SETLPTR   SAVKEY80,9 
          CALL      RDCEVA1 
          IF        OVRCD=0
            CALL      RPCEVA1 
          ENDIF
LM05L100
          CALL      RKCEVA1 
          BRANCH    OVRCD,LM05L105
          PACK      KEY16,CEVADOC,CEVASPC,CEVAPSC
          MATCH     SAVKEY80,KEY16   
          GOTO      LM05L105 IF NOT EQUAL
          RESET     KEY16,10
          MOVE      KEY16,KEY7
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TACEVA12
          IF        OVRCD=0
            CALL      TUCEVA12
          ELSE
            CALL      TWCEVA12
          ENDIF
          GOTO     LM05L100
LM05L105
          MOVE     SP70,KEY7   
          CALL     TSCEVA12
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : VMO Doctor Mapping                 
.---------------------------------------------------------
SM05L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM05L010 IF EQUAL
SM05L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM05L010,SM05L010,SM05L010,SM05L010:
                            SM05L010,SM05L010,SM05L101,SM05L010:
                            SM05L010,SM05L010,SM05L010,SM05L010:
                            SM05L010,SM05L010,SM05L010,SM05L010:
                           SM05L010,SM05L010,SM05L010,SM05L010:
                           SM05L010,SM05L010,SM05L010,SM05L010:
                            SM05L010,SM05L010,SM05L010,SM05L010
SM05L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM05L007
          MATCH     PRGID,SCPSPID
          GOTO      SM05L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM05L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM05L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM05L006 IF NOT EQUAL
          GOTO      SM05L005
SM05L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM05L010
          BRANCH    STDGSFLG,SM05L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM05L900
          MATCH     PRGID,SCPSPID
          GOTO      SM05L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM05L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM05L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM05L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM05L010,SM05L010,SM05L010,SM05L010:
                            SM05L010,SM05L010,SM05L010,SM05L102:
                            SM05L010,SM05L010,SM05L010,SM05L010:
                            SM05L010,SM05L010,SM05L010,SM05L010:
                           SM05L010,SM05L010,SM05L010,SM05L010:
                           SM05L010,SM05L010,SM05L010,SM05L010:
                            SM05L010,SM05L010,SM05L010,SM05L010
          GOTO      SM05L010
.
SM05L101
          MOVE     ZERO,CEVA1AFL
          CALL      KCEPSA00
          MOVE      CEPSPSC,CEVAPSC
          BRANCH    EXIT,SM05L990,SM05L990
          PACK     KEY16,CEVADOC,CEVASPC,CEVAPSC                                                   
          RESET    KEY16,10
          MOVE     KEY16,KEY7
          CALL      TACEVA12
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM05L101
          ENDIF
          MOVE      CEVAPSC,VAR      
          CALL      DISPITEM
          CALL      RPSC0000
.
.
          MOVE      "   10",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   12",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM05L010
.
SM05L102
          CALL      DEFONE00
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEVAQTY 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEVAQTY 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM05L102
            ENDIF
          ENDIF
          MOVE      CEVAQTY,VAR      
          CALL      DISPITEM
          GOTO     SM05L010
SM05L900
          MATCH    "CEVA1",NAMSSFFI
          IF       @EQUAL
            PACK     KEY16,CEVADOC,CEVASPC,CEVAPSC
            RESET    KEY16,10
            MOVE     KEY16,KEY7
            CALL      TACEVA12
            IF        OVRCD=0
              CALL      TUCEVA12
            ELSE
              CALL      TWCEVA12
            ENDIF
            GOTO      SM05L999
          ENDIF
          GOTO      SM05L999
SM05L990
          MATCH    "CEVA1",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,CEVA1AFL
          ENDIF
SM05L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP05L000
          MOVE     ZERO,CEVA1CNT
          MOVE     ZERO,CEVA1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP05L600
          MATCH    PRGID,SCPSPID
          GOTO     DP05L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP05L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP05L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L101,DP05L102:
                            DP05L010,DP05L103,DP05L010,DP05L104:
                            DP05L010,DP05L010,DP05L010,DP05L010:
                           DP05L010,DP05L010,DP05L010,DP05L010:
                           DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010,DP05L010,DP05L010
          GOTO      DP05L010
.
DP05L101
          IF        CEVA1END=0
            CALL      TKCEVA12
            IF        OVRCD=1
              MOVE      ONE,CEVA1END
            ELSE
              MOVE      ZERO,CEVA1END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUCEVA12
              MOVE      CEVAPSC,VAR      
              CALL      DISPITEM
          CALL      RPSC0000
            ENDIF
          ENDIF
          IF        CEVA1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L102
          IF        CEVA1END=0
            MOVE      CEVAQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L103
          IF        CEVA1END=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L104
          IF        CEVA1END=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
DP05L600
          MATCH    "CEVA1",NAMSSFFI
          GOTO     DP05L605 IF NOT EQUAL
          GOTO     DP05L999
DP05L605
DP05L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP05L000
.
          CALL     CT05L000
          MATCH    "CEVA1",NAMSSFFI
          GOTO     FP05L105 IF NOT EQUAL
          MOVE     SP70,KEY7   
          CALL     TSCEVA12 * Start
          CALL     DP05L000
          GOTO     FP05L999
FP05L105
FP05L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP05L000
.
          CALL     CT05L000
          MATCH    "CEVA1",NAMSSFFI
          GOTO     LP05L105 IF NOT EQUAL
          PACK     KEY7,Z70
          CALL     TSCEVA12
          IF       OVRCD=1
            CALL     TPCEVA12 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CEVA1SNO
            CALL     TPCEVA12
            ADD      ONE,SECTOR
          DO
          CALL     DP05L000
          GOTO     LP05L999
LP05L105
LP05L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP05L000
.
PP05L100
          MATCH    "CEVA1",NAMSSFFI
          GOTO     PP05L115 IF NOT EQUAL
PP05L105
          MOVE     SP70,CEVA1NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCEVA11
          CALL     TKCEVA11 * First on Page
          MOVE     KEY7,CEVA1NXT
          CALL     TSCEVA12
          CALL     TPCEVA12 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP05L999
          ENDIF
.
          CALL     CT05L000
.
. Position and Display Page
.--------------------------
PP05L110
          MOVE     CEVA1NXT,KEY7   
          CALL     TSCEVA12
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CEVA1SNO
            CALL     TPCEVA12
            ADD      ONE,SECTOR
          DO
          CALL     DP05L000
          GOTO     PP05L999
PP05L115
PP05L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP05L000
          MATCH    "CEVA1",NAMSSFFI
          GOTO     NP05L115 IF NOT EQUAL
NP05L105
          MOVE     SP70,CEVA1NXT
          PACK     KEY5,Z70
          CALL     TSCEVA11
          CALL     TPCEVA11
          MOVE     KEY7,CEVA1NXT
          CALL     TSCEVA12
          CALL     TKCEVA12
          IF       OVRCD=1
            BEEP
            GOTO      NP05L999
          ENDIF
.
          CALL     CT05L000
.
. Position and Display Page
.--------------------------
NP05L110
          MOVE     CEVA1NXT,KEY7   
          CALL     TSCEVA12
          CALL     DP05L000
          GOTO     NP05L999
NP05L115
NP05L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT05L000
          MATCH    "CEVA1",NAMSSFFI
          GOTO     CT05L115 IF NOT EQUAL
CT05L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCEVA11
          CALL     TKCEVA11
          BRANCH   OVRCD,CT05L110
          CALL     TRCEVA12
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUCEVA12
          GOTO     CT05L105
CT05L110
          GOTO     CT05L999
CT05L115
CT05L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP05L000
          CALL     CT05L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP05L999
          MATCH    PRGID,SCPSPID
          GOTO     CP05L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP05L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP05L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP05L010,CP05L010,CP05L010,CP05L010:
                            CP05L010,CP05L010,CP05L100,CP05L100:
                            CP05L010,CP05L100,CP05L010,CP05L100:
                            CP05L010,CP05L010,CP05L010,CP05L010:
                           CP05L010,CP05L010,CP05L010,CP05L010:
                           CP05L010,CP05L010,CP05L010,CP05L010:
                            CP05L010,CP05L010,CP05L010,CP05L010
.
CP05L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP05L010
CP05L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD05L000
          CALL      CP05L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD05L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD05L000
          MATCH     PRGID,SCPSPID
          GOTO      AD05L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD05L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD05L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM05L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "CEVA1",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,CEVA1AFL
            GOTO      AD05L010 IF EQUAL
            CALL      FP05L000
            GOTO      AD05L999
          ENDIF
AD05L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL05L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL05L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL05L900,DL05L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL05L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "CEVA1",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRCEVA11
            IF        OVRCD=0
              CALL      TDCEVA12
            ELSE
              BEEP
              GOTO      DL05L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSCEVA11
            CALL      TKCEVA11
            MOVE     KEY7,CEVA1NXT
            CALL      CT05L000
            MOVE      CEVA1NXT,KEY7   
            CALL      TSCEVA12
            CALL      TPCEVA12
            CALL      DP05L000
            GOTO      DL05L005
          ENDIF
DL05L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL05L005
DL05L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : VMO Doctor Mapping                 
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     7 Patient Service                    
.---------------------------------------------------------
TSCEVA11  RESET     KEY5
          READ      CEVA1FL1,KEY5;;
          RETURN
.
TSCEVA12  RESET     KEY7   
          READ      CEVA1FL2,KEY7;;
          RETURN
.
TACEVA12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CEVA1FL2,KEY7;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDCEVA11  RESET     KEY5
          DELETE    CEVA1FL1,KEY5
          RETURN
.
TDCEVA12  RESET     KEY7
          DELETE    CEVA1FL2,KEY7
          RETURN
.
TKCEVA11  MOVE      ZERO,OVRCD
          READKS    CEVA1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEVADOC,CEVASPC,CEVAPSC,CEVAQTY,CEVASPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TKCEVA12  MOVE      ZERO,OVRCD
          READKS    CEVA1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEVADOC,CEVASPC,CEVAPSC,CEVAQTY,CEVASPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCEVA11  MOVE      ZERO,OVRCD
          READKP    CEVA1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEVADOC,CEVASPC,CEVAPSC,CEVAQTY,CEVASPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCEVA12  MOVE      ZERO,OVRCD
          READKP    CEVA1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEVADOC,CEVASPC,CEVAPSC,CEVAQTY,CEVASPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCEVA11  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      CEVA1FL1,KEY5;SCTMROW,SCTMCOL,KEY7:
                        CEVADOC,CEVASPC,CEVAPSC,CEVAQTY,CEVASPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCEVA12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CEVA1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CEVADOC,CEVASPC,CEVAPSC,CEVAQTY,CEVASPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TUCEVA11  UPDATE    CEVA1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEVADOC,CEVASPC,CEVAPSC,CEVAQTY,CEVASPA                 
          RETURN
.
TUCEVA12
          UPDATE    CEVA1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEVADOC,CEVASPC,CEVAPSC,CEVAQTY,CEVASPA                 
          RETURN
.
TWCEVA12  RESET     KEY7   
          WRITE     CEVA1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CEVADOC,CEVASPC,CEVAPSC,CEVAQTY,CEVASPA                 
          RETURN
.---------------------------------------------------------
. Display Fields for : VMO Doctor Mapping                 
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
          MOVE      "CEVA1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP05L000
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : VMO Doctor Mapping                 
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L999,PS05L999,PS05L999,PS05L999:
                            PS05L999,PS05L101,PS05L999,PS05L999:
                            PS05L999,PS05L999,PS05L102,PS05L999:
                            PS05L999,PS05L999,PS05L999,PS05L999:
                           PS05L999,PS05L999,PS05L999,PS05L999:
                           PS05L999,PS05L999,PS05L999,PS05L999:
                            PS05L999,PS05L999,PS05L999,PS05L999
          GOTO     PS05L999
.
PS05L101
          MOVE      DOCTNAME,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L102
          MOVE      CESPDES,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : VMO Doctor Mapping                 
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L006,SF05L101,SF05L102,SF05L006:
                            SF05L006,SF05L006,SF05L103,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                           SF05L006,SF05L006,SF05L006,SF05L006:
                           SF05L104,SF05L105,SF05L106,SF05L107:
                            SF05L108,SF05L109,SF05L110,SF05L111
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L103,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                           SF05L020,SF05L020,SF05L020,SF05L020:
                           SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          MOVE      "CEVA1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP05L000
          GOTO     SF05L001
.
SF05L101
          CALL      POSE0000
          MOVE      ONE,EXIT
          GOTO      SF05L999
.
SF05L102
          MOVE      ONE,EXIT
          GOTO      SF05L999
.
SF05L103
          CALL      SELECTED
          BRANCH    EXIT,SF05L001
          MOVE      "CEVA1",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRCEVA11
            BRANCH    OVRCD,SF05L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF05L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF05L001 IF NOT EQUAL
            CALL      SM05L000 * Change Line
          ELSE
            IF        CEVA1AFL=0
              MOVE      "CEVA1",NAMSSFFI
              MOVE     "    7",ITMSSFFI
              CALL      AD05L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF05L001
.
SF05L104
          MOVE      "CEVA1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      NP05L000
          GOTO     SF05L001
.
SF05L105
          MOVE      "CEVA1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      PP05L000
          GOTO     SF05L001
.
SF05L106
          MOVE      "CEVA1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      AD05L000
          GOTO     SF05L001
.
SF05L107
          MOVE      "CEVA1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      DL05L000
          GOTO     SF05L001
.
SF05L108
          MOVE      "CEVA1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP05L000
          GOTO     SF05L001
.
SF05L109
          MOVE      "CEVA1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      LP05L000
          GOTO     SF05L001
.
SF05L110
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELE0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF05L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF05L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF05L999
          ENDIF
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF05L000
          ENDIF
          GOTO      SF05L001
.
SF05L111
          CALL      CVMO0000
          MOVE      ONE,EXIT
          GOTO      SF05L999
SF05L990  MOVE      FOUR,EXIT * Exit Char Exit
SF05L999  RETURN
.--------------------------------
. Screen - Map VMO Doctor Type to Patient Serv
.--------------------------------
SC06L000
SC06L100
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC06L200
          CALL      CF06L000 * Clear Fields
SC06L300
          CALL      KY06L000 * Enter Key Fields
          BRANCH    EXIT,SC06L999,SC06L999
SC06L400
          CALL      WP06L000 * Load any WP Details
SC06L500
          CALL      LM06L000 * Load any Batch Details
SC06L600
          CALL      DF06L000 * Display Fields
SC06L700
          CALL      SF06L000 * Select Fields
          BRANCH    EXIT,SC06L100,SC06L100,SC06L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC06L800
SC06L900
SC06L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Map VMO Doctor Type to Patient Serv
.-------------------------------------------------------
CF06L000
          MOVE      SP70,ACODE   
          MOVE      SP70,CEVASPC 
          MOVE      SP70,CEVBPSC 
          MOVE      ZERO,CEVBQTY 
CF06L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Map VMO Doctor Type to Patient Serv
.--------------------------------------------------------
KY06L000
.
KY06L110
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TDESC   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EDTYP000
          BRANCH    EXIT,KY06L900,KY06L900
          MOVE      ZERO,ACCEPT
          MOVE      ACODE,VAR        
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TDESC,VAR        
            CALL      DISPITEM
          ENDIF
.
KY06L120
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CESPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCESPA00
          MOVE      CESPSPC,CEVASPC
          BRANCH    EXIT,KY06L110,KY06L900
          MOVE      ZERO,ACCEPT
          MOVE      CEVASPC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CESPDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY06L999
.
KY06L900  MOVE      ONE,EXIT
KY06L999  RETURN
.---------------------------------------------------------
. Load WP files for : Map VMO Doctor Type to Patient Serv
.---------------------------------------------------------
WP06L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Map VMO Doctor Type to Patient Serv
.---------------------------------------------------------
LM06L000
.---------------------------------------------------------
. Load for :     7 Patient Service                    
.---------------------------------------------------------
          UNPACK    SP70,CEVBDTY,CEVBSPC,CEVBPSC
          PACK      CEVB1FNM,ANST,CEVB1NAM,PORT
          REP       " 0",CEVB1FNM
          MOVE      ZERO,CEVB1AFL
          CLOSE     CEVB1FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CEVB1FL1,CEVB1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CEVB1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CEVB1FNM,SP1,CEVB1LEN,SP1,CEVB1IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      CEVB1FL1,CEVB1FNM
          OPEN      CEVB1FL2,CEVB1FNM
          PACK      KEY13,ACODE,CESPSPC,SP70
          MOVE      KEY13,SAVKEY80
          SETLPTR   SAVKEY80,6 
          CALL      RDCEVB1 
          IF        OVRCD=0
            CALL      RPCEVB1 
          ENDIF
LM06L100
          CALL      RKCEVB1 
          BRANCH    OVRCD,LM06L105
          PACK      KEY13,CEVBDTY,CEVBSPC,CEVBPSC
          MATCH     SAVKEY80,KEY13   
          GOTO      LM06L105 IF NOT EQUAL
          RESET     KEY13,7
          MOVE      KEY13,KEY7
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TACEVB12
          IF        OVRCD=0
            CALL      TUCEVB12
          ELSE
            CALL      TWCEVB12
          ENDIF
          GOTO     LM06L100
LM06L105
          MOVE     SP70,KEY7   
          CALL     TSCEVB12
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Map VMO Doctor Type to Patient Serv
.---------------------------------------------------------
SM06L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM06L010 IF EQUAL
SM06L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM06L010,SM06L010,SM06L010,SM06L010:
                            SM06L010,SM06L010,SM06L101,SM06L010:
                            SM06L010,SM06L010,SM06L010,SM06L010:
                            SM06L010,SM06L010,SM06L010,SM06L010:
                           SM06L010,SM06L010,SM06L010,SM06L010:
                           SM06L010,SM06L010,SM06L010,SM06L010:
                            SM06L010,SM06L010,SM06L010
SM06L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM06L007
          MATCH     PRGID,SCPSPID
          GOTO      SM06L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM06L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM06L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM06L006 IF NOT EQUAL
          GOTO      SM06L005
SM06L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM06L010
          BRANCH    STDGSFLG,SM06L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM06L900
          MATCH     PRGID,SCPSPID
          GOTO      SM06L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM06L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM06L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM06L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM06L010,SM06L010,SM06L010,SM06L010:
                            SM06L010,SM06L010,SM06L010,SM06L102:
                            SM06L010,SM06L010,SM06L010,SM06L010:
                            SM06L010,SM06L010,SM06L010,SM06L010:
                           SM06L010,SM06L010,SM06L010,SM06L010:
                           SM06L010,SM06L010,SM06L010,SM06L010:
                            SM06L010,SM06L010,SM06L010
          GOTO      SM06L010
.
SM06L101
          MOVE     ZERO,CEVB1AFL
          CALL      KCEPSA00
          MOVE      CEPSPSC,CEVBPSC
          BRANCH    EXIT,SM06L990,SM06L990
          PACK     KEY13,CEVBDTY,CEVBSPC,CEVBPSC                                                   
          RESET    KEY13,7
          MOVE     KEY13,KEY7
          CALL      TACEVB12
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM06L101
          ENDIF
          MOVE      CEVBPSC,VAR      
          CALL      DISPITEM
          CALL      RPSC0000
.
.
          MOVE      "   10",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   12",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SM06L010
.
SM06L102
          CALL      DEFONE00
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEVBQTY 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEVBQTY 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM06L102
            ENDIF
          ENDIF
          MOVE      CEVBQTY,VAR      
          CALL      DISPITEM
          GOTO     SM06L010
SM06L900
          MATCH    "CEVB1",NAMSSFFI
          IF       @EQUAL
            PACK     KEY13,CEVBDTY,CEVBSPC,CEVBPSC
            RESET    KEY13,7
            MOVE     KEY13,KEY7
            CALL      TACEVB12
            IF        OVRCD=0
              CALL      TUCEVB12
            ELSE
              CALL      TWCEVB12
            ENDIF
            GOTO      SM06L999
          ENDIF
          GOTO      SM06L999
SM06L990
          MATCH    "CEVB1",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,CEVB1AFL
          ENDIF
SM06L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP06L000
          MOVE     ZERO,CEVB1CNT
          MOVE     ZERO,CEVB1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP06L600
          MATCH    PRGID,SCPSPID
          GOTO     DP06L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP06L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP06L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L101,DP06L102:
                            DP06L010,DP06L103,DP06L010,DP06L104:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                           DP06L010,DP06L010,DP06L010,DP06L010:
                           DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010
          GOTO      DP06L010
.
DP06L101
          IF        CEVB1END=0
            CALL      TKCEVB12
            IF        OVRCD=1
              MOVE      ONE,CEVB1END
            ELSE
              MOVE      ZERO,CEVB1END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUCEVB12
              MOVE      CEVBPSC,VAR      
              CALL      DISPITEM
          CALL      RPSC0000
            ENDIF
          ENDIF
          IF        CEVB1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L102
          IF        CEVB1END=0
            MOVE      CEVBQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L103
          IF        CEVB1END=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L104
          IF        CEVB1END=0
            MOVE      CEPSQDES,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
DP06L600
          MATCH    "CEVB1",NAMSSFFI
          GOTO     DP06L605 IF NOT EQUAL
          GOTO     DP06L999
DP06L605
DP06L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP06L000
.
          CALL     CT06L000
          MATCH    "CEVB1",NAMSSFFI
          GOTO     FP06L105 IF NOT EQUAL
          MOVE     SP70,KEY7   
          CALL     TSCEVB12 * Start
          CALL     DP06L000
          GOTO     FP06L999
FP06L105
FP06L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP06L000
.
          CALL     CT06L000
          MATCH    "CEVB1",NAMSSFFI
          GOTO     LP06L105 IF NOT EQUAL
          PACK     KEY7,Z70
          CALL     TSCEVB12
          IF       OVRCD=1
            CALL     TPCEVB12 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CEVB1SNO
            CALL     TPCEVB12
            ADD      ONE,SECTOR
          DO
          CALL     DP06L000
          GOTO     LP06L999
LP06L105
LP06L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP06L000
.
PP06L100
          MATCH    "CEVB1",NAMSSFFI
          GOTO     PP06L115 IF NOT EQUAL
PP06L105
          MOVE     SP70,CEVB1NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCEVB11
          CALL     TKCEVB11 * First on Page
          MOVE     KEY7,CEVB1NXT
          CALL     TSCEVB12
          CALL     TPCEVB12 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP06L999
          ENDIF
.
          CALL     CT06L000
.
. Position and Display Page
.--------------------------
PP06L110
          MOVE     CEVB1NXT,KEY7   
          CALL     TSCEVB12
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CEVB1SNO
            CALL     TPCEVB12
            ADD      ONE,SECTOR
          DO
          CALL     DP06L000
          GOTO     PP06L999
PP06L115
PP06L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP06L000
          MATCH    "CEVB1",NAMSSFFI
          GOTO     NP06L115 IF NOT EQUAL
NP06L105
          MOVE     SP70,CEVB1NXT
          PACK     KEY5,Z70
          CALL     TSCEVB11
          CALL     TPCEVB11
          MOVE     KEY7,CEVB1NXT
          CALL     TSCEVB12
          CALL     TKCEVB12
          IF       OVRCD=1
            BEEP
            GOTO      NP06L999
          ENDIF
.
          CALL     CT06L000
.
. Position and Display Page
.--------------------------
NP06L110
          MOVE     CEVB1NXT,KEY7   
          CALL     TSCEVB12
          CALL     DP06L000
          GOTO     NP06L999
NP06L115
NP06L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT06L000
          MATCH    "CEVB1",NAMSSFFI
          GOTO     CT06L115 IF NOT EQUAL
CT06L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCEVB11
          CALL     TKCEVB11
          BRANCH   OVRCD,CT06L110
          CALL     TRCEVB12
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUCEVB12
          GOTO     CT06L105
CT06L110
          GOTO     CT06L999
CT06L115
CT06L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP06L000
          CALL     CT06L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP06L999
          MATCH    PRGID,SCPSPID
          GOTO     CP06L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP06L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP06L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP06L010,CP06L010,CP06L010,CP06L010:
                            CP06L010,CP06L010,CP06L100,CP06L100:
                            CP06L010,CP06L100,CP06L010,CP06L100:
                            CP06L010,CP06L010,CP06L010,CP06L010:
                           CP06L010,CP06L010,CP06L010,CP06L010:
                           CP06L010,CP06L010,CP06L010,CP06L010:
                            CP06L010,CP06L010,CP06L010
.
CP06L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP06L010
CP06L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD06L000
          CALL      CP06L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD06L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD06L000
          MATCH     PRGID,SCPSPID
          GOTO      AD06L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD06L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD06L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM06L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "CEVB1",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,CEVB1AFL
            GOTO      AD06L010 IF EQUAL
            CALL      FP06L000
            GOTO      AD06L999
          ENDIF
AD06L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL06L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL06L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL06L900,DL06L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL06L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "CEVB1",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRCEVB11
            IF        OVRCD=0
              CALL      TDCEVB12
            ELSE
              BEEP
              GOTO      DL06L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSCEVB11
            CALL      TKCEVB11
            MOVE     KEY7,CEVB1NXT
            CALL      CT06L000
            MOVE      CEVB1NXT,KEY7   
            CALL      TSCEVB12
            CALL      TPCEVB12
            CALL      DP06L000
            GOTO      DL06L005
          ENDIF
DL06L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL06L005
DL06L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Map VMO Doctor Type to Patient Serv
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     7 Patient Service                    
.---------------------------------------------------------
TSCEVB11  RESET     KEY5
          READ      CEVB1FL1,KEY5;;
          RETURN
.
TSCEVB12  RESET     KEY7   
          READ      CEVB1FL2,KEY7;;
          RETURN
.
TACEVB12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CEVB1FL2,KEY7;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDCEVB11  RESET     KEY5
          DELETE    CEVB1FL1,KEY5
          RETURN
.
TDCEVB12  RESET     KEY7
          DELETE    CEVB1FL2,KEY7
          RETURN
.
TKCEVB11  MOVE      ZERO,OVRCD
          READKS    CEVB1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEVBDTY,CEVBSPC,CEVBPSC,CEVBQTY,CEVBSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TKCEVB12  MOVE      ZERO,OVRCD
          READKS    CEVB1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEVBDTY,CEVBSPC,CEVBPSC,CEVBQTY,CEVBSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCEVB11  MOVE      ZERO,OVRCD
          READKP    CEVB1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEVBDTY,CEVBSPC,CEVBPSC,CEVBQTY,CEVBSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCEVB12  MOVE      ZERO,OVRCD
          READKP    CEVB1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEVBDTY,CEVBSPC,CEVBPSC,CEVBQTY,CEVBSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCEVB11  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      CEVB1FL1,KEY5;SCTMROW,SCTMCOL,KEY7:
                        CEVBDTY,CEVBSPC,CEVBPSC,CEVBQTY,CEVBSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCEVB12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CEVB1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CEVBDTY,CEVBSPC,CEVBPSC,CEVBQTY,CEVBSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TUCEVB11  UPDATE    CEVB1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEVBDTY,CEVBSPC,CEVBPSC,CEVBQTY,CEVBSPA                 
          RETURN
.
TUCEVB12
          UPDATE    CEVB1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEVBDTY,CEVBSPC,CEVBPSC,CEVBQTY,CEVBSPA                 
          RETURN
.
TWCEVB12  RESET     KEY7   
          WRITE     CEVB1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CEVBDTY,CEVBSPC,CEVBPSC,CEVBQTY,CEVBSPA                 
          RETURN
.---------------------------------------------------------
. Display Fields for : Map VMO Doctor Type to Patient Serv
.---------------------------------------------------------
DF06L000
          BRANCH   ACCEPT,DF06L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF06L900
          MATCH    PRGID,SCPSPID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF06L010 IF NOT EQUAL
.
          CALL     PS06L000 * Display Field
          GOTO     DF06L010
DF06L900
          MOVE      "CEVB1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP06L000
DF06L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Map VMO Doctor Type to Patient Serv
.---------------------------------------------------------
PS06L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L101,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L102,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                           PS06L999,PS06L999,PS06L999,PS06L999:
                           PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999
          GOTO     PS06L999
.
PS06L101
          MOVE      TDESC,VAR        
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L102
          MOVE      CESPDES,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
PS06L999
          RETURN
.---------------------------------------------------------
. Selections for : Map VMO Doctor Type to Patient Serv
.---------------------------------------------------------
SF06L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF06L001  BRANCH   ACCEPT,SF06L020
.
SF06L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L006,SF06L101,SF06L102,SF06L006:
                            SF06L006,SF06L006,SF06L103,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                           SF06L006,SF06L006,SF06L006,SF06L006:
                           SF06L104,SF06L105,SF06L106,SF06L107:
                            SF06L108,SF06L109,SF06L110
SF06L006  BEEP
          GOTO     SF06L005
SF06L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF06L090
          MATCH    PRGID,SCSLPID
          GOTO     SF06L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF06L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L103,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                           SF06L020,SF06L020,SF06L020,SF06L020:
                           SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020
          GOTO     SF06L020
SF06L090  MOVE     ZERO,ACCEPT
          MOVE      "CEVB1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP06L000
          GOTO     SF06L001
.
SF06L101
          CALL      POSF0000
          MOVE      ONE,EXIT
          GOTO      SF06L999
.
SF06L102
          MOVE      ONE,EXIT
          GOTO      SF06L999
.
SF06L103
          CALL      SELECTED
          BRANCH    EXIT,SF06L001
          MOVE      "CEVB1",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRCEVB11
            BRANCH    OVRCD,SF06L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF06L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF06L001 IF NOT EQUAL
            CALL      SM06L000 * Change Line
          ELSE
            IF        CEVB1AFL=0
              MOVE      "CEVB1",NAMSSFFI
              MOVE     "    7",ITMSSFFI
              CALL      AD06L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF06L001
.
SF06L104
          MOVE      "CEVB1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      NP06L000
          GOTO     SF06L001
.
SF06L105
          MOVE      "CEVB1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      PP06L000
          GOTO     SF06L001
.
SF06L106
          MOVE      "CEVB1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      AD06L000
          GOTO     SF06L001
.
SF06L107
          MOVE      "CEVB1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      DL06L000
          GOTO     SF06L001
.
SF06L108
          MOVE      "CEVB1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      FP06L000
          GOTO     SF06L001
.
SF06L109
          MOVE      "CEVB1",NAMSSFFI
          MOVE      "    7",ITMSSFFI
          CALL      LP06L000
          GOTO     SF06L001
.
SF06L110
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELF0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF06L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF06L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF06L999
          ENDIF
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF06L000
          ENDIF
          GOTO      SF06L001
SF06L990  MOVE      FOUR,EXIT * Exit Char Exit
SF06L999  RETURN
.--------------------------------
. Screen - Casemix Type Mapping               
.--------------------------------
SC07L000
SC07L100
          MOVE      "07",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC07L200
          CALL      CF07L000 * Clear Fields
          CALL      REDCON00
SC07L300
          CALL      KY07L000 * Enter Key Fields
          BRANCH    EXIT,SC07L999,SC07L999
SC07L400
          CALL      WP07L000 * Load any WP Details
SC07L500
          CALL      LM07L000 * Load any Batch Details
SC07L600
          CALL      DF07L000 * Display Fields
SC07L700
          CALL      SF07L000 * Select Fields
          BRANCH    EXIT,SC07L100,SC07L100,SC07L200
SC07L800
SC07L900
SC07L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Casemix Type Mapping               
.-------------------------------------------------------
CF07L000
          MOVE      SP70,CEMESTY 
          MOVE      SP70,CCXHKEY 
          MOVE      SP70,CEMESPC 
          MOVE      SP70,CEMEPSC 
          MOVE      ZERO,CEMEDOS 
          MOVE      ZERO,CEMETYQ 
          MOVE      ZERO,CEMEQTY 
CF07L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Casemix Type Mapping               
.--------------------------------------------------------
KY07L000
.
KY07L110
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCSTDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCCSTA00
          MOVE      CCSTSTY,CEMESTY
          BRANCH    EXIT,KY07L900,KY07L900
          MOVE      ZERO,ACCEPT
          MOVE      CEMESTY,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCSTDES,VAR      
            CALL      DISPITEM
          ENDIF
.
KY07L120
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCXHDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EXHD0000
          BRANCH    EXIT,KY07L110,KY07L900
          MOVE      ZERO,ACCEPT
          MOVE      CCXHKEY,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCXHDES,VAR      
            CALL      DISPITEM
          ENDIF
.
KY07L130
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CESPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCESPA00
          MOVE      CESPSPC,CEMESPC
          BRANCH    EXIT,KY07L120,KY07L900
          MOVE      ZERO,ACCEPT
          MOVE      CEMESPC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CESPDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY07L999
.
KY07L900  MOVE      ONE,EXIT
KY07L999  RETURN
.---------------------------------------------------------
. Load WP files for : Casemix Type Mapping               
.---------------------------------------------------------
WP07L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Casemix Type Mapping               
.---------------------------------------------------------
LM07L000
.---------------------------------------------------------
. Load for :    20 Patient Service Code               
.---------------------------------------------------------
          UNPACK    SP70,CEMESTY,CEMEKEY,CEMESPC,CEMEPSC
          PACK      CEME1FNM,ANST,CEME1NAM,PORT
          REP       " 0",CEME1FNM
          MOVE      ZERO,CEME1AFL
          CLOSE     CEME1FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CEME1FL1,CEME1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CEME1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CEME1FNM,SP1,CEME1LEN,SP1,CEME1IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      CEME1FL1,CEME1FNM
          OPEN      CEME1FL2,CEME1FNM
          PACK      KEY23,CCSTSTY,CCXHKEY,CESPSPC,SP70
          MOVE      KEY23,SAVKEY80
          SETLPTR   SAVKEY80,16
          CALL      RDCEME1 
          IF        OVRCD=0
            CALL      RPCEME1 
          ENDIF
LM07L100
          CALL      RKCEME1 
          BRANCH    OVRCD,LM07L105
          PACK      KEY23,CEMESTY,CEMEKEY,CEMESPC,CEMEPSC
          MATCH     SAVKEY80,KEY23   
          GOTO      LM07L105 IF NOT EQUAL
          RESET     KEY23,17
          MOVE      KEY23,KEY7
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TACEME12
          IF        OVRCD=0
            CALL      TUCEME12
          ELSE
            CALL      TWCEME12
          ENDIF
          GOTO     LM07L100
LM07L105
          MOVE     SP70,KEY7   
          CALL     TSCEME12
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Casemix Type Mapping               
.---------------------------------------------------------
SM07L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM07L010 IF EQUAL
SM07L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM07L010,SM07L010,SM07L010,SM07L010:
                            SM07L010,SM07L010,SM07L010,SM07L010:
                            SM07L010,SM07L010,SM07L010,SM07L010:
                           SM07L010,SM07L010,SM07L010,SM07L010:
                           SM07L010,SM07L010,SM07L010,SM07L101:
                            SM07L010,SM07L010,SM07L010,SM07L010:
                            SM07L010,SM07L010,SM07L010,SM07L010:
                           SM07L010,SM07L010,SM07L010,SM07L010:
                           SM07L010,SM07L010,SM07L010,SM07L010:
                            SM07L010,SM07L010,SM07L010,SM07L010:
                            SM07L010
SM07L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM07L007
          MATCH     PRGID,SCPSPID
          GOTO      SM07L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM07L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM07L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM07L006 IF NOT EQUAL
          GOTO      SM07L005
SM07L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM07L010
          BRANCH    STDGSFLG,SM07L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM07L900
          MATCH     PRGID,SCPSPID
          GOTO      SM07L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM07L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM07L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM07L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM07L010,SM07L010,SM07L010,SM07L010:
                            SM07L010,SM07L010,SM07L010,SM07L010:
                            SM07L010,SM07L010,SM07L010,SM07L010:
                           SM07L010,SM07L010,SM07L010,SM07L010:
                           SM07L010,SM07L010,SM07L010,SM07L010:
                            SM07L010,SM07L102,SM07L010,SM07L103:
                            SM07L010,SM07L104,SM07L010,SM07L010:
                           SM07L010,SM07L010,SM07L010,SM07L010:
                           SM07L010,SM07L010,SM07L010,SM07L010:
                            SM07L010,SM07L010,SM07L010,SM07L010:
                            SM07L010
          GOTO      SM07L010
.
SM07L101
          MOVE     ZERO,CEME1AFL
          CALL      KCEPSA00
          MOVE      CEPSPSC,CEMEPSC
          BRANCH    EXIT,SM07L990,SM07L990
          PACK     KEY23,CEMESTY,CEMEKEY,CEMESPC,CEMEPSC                                           
          RESET    KEY23,17
          MOVE     KEY23,KEY7
          CALL      TACEME12
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM07L101
          ENDIF
          MOVE      CEMEPSC,VAR      
          CALL      DISPITEM
          CALL      RPSC0000
.
.
          MOVE      "   21",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SM07L010
.
SM07L102
          MOVE      "0",CKEYTYP
          CALL      EDOS0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM07L102
            ENDIF
            BRANCH    EXIT,SM07L102,SM07L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SM07L990 IF EQUAL
          ENDIF
          MOVE      CEMEDOS,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   23",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      NAMEDOS,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SM07L010
.
SM07L103
          MOVE      "0",CKEYTYP
          CALL      ETYQ0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM07L103
            ENDIF
            BRANCH    EXIT,SM07L103,SM07L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SM07L990 IF EQUAL
          ENDIF
          MOVE      CEMETYQ,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   25",FLDID
          CALL      GETMLPOS
          IF        EXIT=0
            MOVE      NAMETYQ,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SM07L010
.
SM07L104
          CALL      DEFONE00
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,CEMEQTY 
          IF        SCPSMAN=1
            COMPARE   ZERO,CEMEQTY 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SM07L104
            ENDIF
          ENDIF
          MOVE      CEMEQTY,VAR      
          CALL      DISPITEM
          GOTO     SM07L010
SM07L900
          MATCH    "CEME1",NAMSSFFI
          IF       @EQUAL
            PACK     KEY23,CEMESTY,CEMEKEY,CEMESPC,CEMEPSC
            RESET    KEY23,17
            MOVE     KEY23,KEY7
            CALL      TACEME12
            IF        OVRCD=0
              CALL      TUCEME12
            ELSE
              CALL      TWCEME12
            ENDIF
            GOTO      SM07L999
          ENDIF
          GOTO      SM07L999
SM07L990
          MATCH    "CEME1",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,CEME1AFL
          ENDIF
SM07L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP07L000
          MOVE     ZERO,CEME1CNT
          MOVE     ZERO,CEME1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP07L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP07L600
          MATCH    PRGID,SCPSPID
          GOTO     DP07L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP07L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP07L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                           DP07L010,DP07L010,DP07L010,DP07L010:
                           DP07L010,DP07L010,DP07L010,DP07L101:
                            DP07L102,DP07L103,DP07L104,DP07L105:
                            DP07L106,DP07L107,DP07L010,DP07L010:
                           DP07L010,DP07L010,DP07L010,DP07L010:
                           DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010
          GOTO      DP07L010
.
DP07L101
          IF        CEME1END=0
            CALL      TKCEME12
            IF        OVRCD=1
              MOVE      ONE,CEME1END
            ELSE
              MOVE      ZERO,CEME1END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUCEME12
              MOVE      CEMEPSC,VAR      
              CALL      DISPITEM
          CALL      RPSC0000
            ENDIF
          ENDIF
          IF        CEME1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L102
          IF        CEME1END=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L103
          IF        CEME1END=0
            MOVE      CEMEDOS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L104
          IF        CEME1END=0
            MOVE      NAMEDOS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L105
          IF        CEME1END=0
            MOVE      CEMETYQ,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L106
          IF        CEME1END=0
            MOVE      NAMETYQ,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L107
          IF        CEME1END=0
            MOVE      CEMEQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
DP07L600
          MATCH    "CEME1",NAMSSFFI
          GOTO     DP07L605 IF NOT EQUAL
          GOTO     DP07L999
DP07L605
DP07L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP07L000
.
          CALL     CT07L000
          MATCH    "CEME1",NAMSSFFI
          GOTO     FP07L105 IF NOT EQUAL
          MOVE     SP70,KEY7   
          CALL     TSCEME12 * Start
          CALL     DP07L000
          GOTO     FP07L999
FP07L105
FP07L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP07L000
.
          CALL     CT07L000
          MATCH    "CEME1",NAMSSFFI
          GOTO     LP07L105 IF NOT EQUAL
          PACK     KEY7,Z70
          CALL     TSCEME12
          IF       OVRCD=1
            CALL     TPCEME12 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CEME1SNO
            CALL     TPCEME12
            ADD      ONE,SECTOR
          DO
          CALL     DP07L000
          GOTO     LP07L999
LP07L105
LP07L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP07L000
.
PP07L100
          MATCH    "CEME1",NAMSSFFI
          GOTO     PP07L115 IF NOT EQUAL
PP07L105
          MOVE     SP70,CEME1NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCEME11
          CALL     TKCEME11 * First on Page
          MOVE     KEY7,CEME1NXT
          CALL     TSCEME12
          CALL     TPCEME12 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP07L999
          ENDIF
.
          CALL     CT07L000
.
. Position and Display Page
.--------------------------
PP07L110
          MOVE     CEME1NXT,KEY7   
          CALL     TSCEME12
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CEME1SNO
            CALL     TPCEME12
            ADD      ONE,SECTOR
          DO
          CALL     DP07L000
          GOTO     PP07L999
PP07L115
PP07L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP07L000
          MATCH    "CEME1",NAMSSFFI
          GOTO     NP07L115 IF NOT EQUAL
NP07L105
          MOVE     SP70,CEME1NXT
          PACK     KEY5,Z70
          CALL     TSCEME11
          CALL     TPCEME11
          MOVE     KEY7,CEME1NXT
          CALL     TSCEME12
          CALL     TKCEME12
          IF       OVRCD=1
            BEEP
            GOTO      NP07L999
          ENDIF
.
          CALL     CT07L000
.
. Position and Display Page
.--------------------------
NP07L110
          MOVE     CEME1NXT,KEY7   
          CALL     TSCEME12
          CALL     DP07L000
          GOTO     NP07L999
NP07L115
NP07L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT07L000
          MATCH    "CEME1",NAMSSFFI
          GOTO     CT07L115 IF NOT EQUAL
CT07L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSCEME11
          CALL     TKCEME11
          BRANCH   OVRCD,CT07L110
          CALL     TRCEME12
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUCEME12
          GOTO     CT07L105
CT07L110
          GOTO     CT07L999
CT07L115
CT07L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP07L000
          CALL     CT07L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP07L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP07L999
          MATCH    PRGID,SCPSPID
          GOTO     CP07L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP07L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP07L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP07L010,CP07L010,CP07L010,CP07L010:
                            CP07L010,CP07L010,CP07L010,CP07L010:
                            CP07L010,CP07L010,CP07L010,CP07L010:
                           CP07L010,CP07L010,CP07L010,CP07L010:
                           CP07L010,CP07L010,CP07L010,CP07L100:
                            CP07L100,CP07L100,CP07L100,CP07L100:
                            CP07L100,CP07L100,CP07L010,CP07L010:
                           CP07L010,CP07L010,CP07L010,CP07L010:
                           CP07L010,CP07L010,CP07L010,CP07L010:
                            CP07L010,CP07L010,CP07L010,CP07L010:
                            CP07L010
.
CP07L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP07L010
CP07L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD07L000
          CALL      CP07L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD07L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD07L000
          MATCH     PRGID,SCPSPID
          GOTO      AD07L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD07L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD07L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM07L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "CEME1",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,CEME1AFL
            GOTO      AD07L010 IF EQUAL
            CALL      FP07L000
            GOTO      AD07L999
          ENDIF
AD07L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL07L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL07L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL07L900,DL07L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL07L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "CEME1",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRCEME11
            IF        OVRCD=0
              CALL      TDCEME12
            ELSE
              BEEP
              GOTO      DL07L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSCEME11
            CALL      TKCEME11
            MOVE     KEY7,CEME1NXT
            CALL      CT07L000
            MOVE      CEME1NXT,KEY7   
            CALL      TSCEME12
            CALL      TPCEME12
            CALL      DP07L000
            GOTO      DL07L005
          ENDIF
DL07L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL07L005
DL07L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Casemix Type Mapping               
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    20 Patient Service Code               
.---------------------------------------------------------
TSCEME11  RESET     KEY5
          READ      CEME1FL1,KEY5;;
          RETURN
.
TSCEME12  RESET     KEY7   
          READ      CEME1FL2,KEY7;;
          RETURN
.
TACEME12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CEME1FL2,KEY7;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDCEME11  RESET     KEY5
          DELETE    CEME1FL1,KEY5
          RETURN
.
TDCEME12  RESET     KEY7
          DELETE    CEME1FL2,KEY7
          RETURN
.
TKCEME11  MOVE      ZERO,OVRCD
          READKS    CEME1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEMESTY,CEMEKEY,CEMESPC,CEMEPSC,CEMEDOS:
                        CEMETYQ,CEMEQTY,CEMESPA                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TKCEME12  MOVE      ZERO,OVRCD
          READKS    CEME1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEMESTY,CEMEKEY,CEMESPC,CEMEPSC,CEMEDOS:
                        CEMETYQ,CEMEQTY,CEMESPA                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCEME11  MOVE      ZERO,OVRCD
          READKP    CEME1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEMESTY,CEMEKEY,CEMESPC,CEMEPSC,CEMEDOS:
                        CEMETYQ,CEMEQTY,CEMESPA                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPCEME12  MOVE      ZERO,OVRCD
          READKP    CEME1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEMESTY,CEMEKEY,CEMESPC,CEMEPSC,CEMEDOS:
                        CEMETYQ,CEMEQTY,CEMESPA                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCEME11  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      CEME1FL1,KEY5;SCTMROW,SCTMCOL,KEY7:
                        CEMESTY,CEMEKEY,CEMESPC,CEMEPSC,CEMEDOS:
                        CEMETYQ,CEMEQTY,CEMESPA                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRCEME12  RESET     KEY7   
          MOVE      ZERO,OVRCD
          READ      CEME1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CEMESTY,CEMEKEY,CEMESPC,CEMEPSC,CEMEDOS:
                        CEMETYQ,CEMEQTY,CEMESPA                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TUCEME11  UPDATE    CEME1FL1;SCTMROW,SCTMCOL,KEY7:
                        CEMESTY,CEMEKEY,CEMESPC,CEMEPSC,CEMEDOS:
                        CEMETYQ,CEMEQTY,CEMESPA                                 
          RETURN
.
TUCEME12
          UPDATE    CEME1FL2;SCTMROW,SCTMCOL,KEY7:
                        CEMESTY,CEMEKEY,CEMESPC,CEMEPSC,CEMEDOS:
                        CEMETYQ,CEMEQTY,CEMESPA                                 
          RETURN
.
TWCEME12  RESET     KEY7   
          WRITE     CEME1FL2,KEY7;SCTMROW,SCTMCOL,KEY7:
                        CEMESTY,CEMEKEY,CEMESPC,CEMEPSC,CEMEDOS:
                        CEMETYQ,CEMEQTY,CEMESPA                                 
          RETURN
.---------------------------------------------------------
. Display Fields for : Casemix Type Mapping               
.---------------------------------------------------------
DF07L000
          BRANCH   ACCEPT,DF07L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF07L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF07L900
          MATCH    PRGID,SCPSPID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF07L010 IF NOT EQUAL
.
          CALL     PS07L000 * Display Field
          GOTO     DF07L010
DF07L900
          MOVE      "CEME1",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      FP07L000
DF07L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Casemix Type Mapping               
.---------------------------------------------------------
PS07L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L101,PS07L999,PS07L102,PS07L999:
                            PS07L103,PS07L999,PS07L999,PS07L999:
                           PS07L999,PS07L999,PS07L999,PS07L999:
                           PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                           PS07L999,PS07L999,PS07L999,PS07L999:
                           PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999
          GOTO     PS07L999
.
PS07L101
          MOVE      CCSTDES,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L102
          MOVE      CCXHDES,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L103
          MOVE      CESPDES,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
PS07L999
          RETURN
.---------------------------------------------------------
. Selections for : Casemix Type Mapping               
.---------------------------------------------------------
SF07L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF07L001  BRANCH   ACCEPT,SF07L020
.
SF07L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L006,SF07L101,SF07L102,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L103,SF07L006,SF07L006:
                           SF07L006,SF07L006,SF07L006,SF07L006:
                           SF07L006,SF07L006,SF07L006,SF07L104:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                           SF07L006,SF07L006,SF07L006,SF07L006:
                           SF07L006,SF07L006,SF07L006,SF07L105:
                            SF07L106,SF07L107,SF07L108,SF07L109:
                            SF07L110
SF07L006  BEEP
          GOTO     SF07L005
SF07L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF07L090
          MATCH    PRGID,SCSLPID
          GOTO     SF07L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF07L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                           SF07L020,SF07L020,SF07L020,SF07L020:
                           SF07L020,SF07L020,SF07L020,SF07L104:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                           SF07L020,SF07L020,SF07L020,SF07L020:
                           SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020
          GOTO     SF07L020
SF07L090  MOVE     ZERO,ACCEPT
          MOVE      "CEME1",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      FP07L000
          GOTO     SF07L001
.
SF07L101
          CALL      POSG0000
          MOVE      ONE,EXIT
          GOTO      SF07L999
.
SF07L102
          MOVE      ONE,EXIT
          GOTO      SF07L999
.
SF07L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DELG0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF07L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF07L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF07L999
          ENDIF
          MOVE      "07",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF07L000
          ENDIF
          GOTO      SF07L001
.
SF07L104
          CALL      SELECTED
          BRANCH    EXIT,SF07L001
          MOVE      "CEME1",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRCEME11
            BRANCH    OVRCD,SF07L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF07L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF07L001 IF NOT EQUAL
            CALL      SM07L000 * Change Line
          ELSE
            IF        CEME1AFL=0
              MOVE      "CEME1",NAMSSFFI
              MOVE     "   20",ITMSSFFI
              CALL      AD07L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF07L001
.
SF07L105
          MOVE      "CEME1",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      NP07L000
          GOTO     SF07L001
.
SF07L106
          MOVE      "CEME1",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      PP07L000
          GOTO     SF07L001
.
SF07L107
          MOVE      "CEME1",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      AD07L000
          GOTO     SF07L001
.
SF07L108
          MOVE      "CEME1",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      DL07L000
          GOTO     SF07L001
.
SF07L109
          MOVE      "CEME1",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      FP07L000
          GOTO     SF07L001
.
SF07L110
          MOVE      "CEME1",NAMSSFFI
          MOVE      "   20",ITMSSFFI
          CALL      LP07L000
          GOTO     SF07L001
SF07L990  MOVE      ONE,EXIT * Exit Char Restart
SF07L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------
. Read Patient Service Description
.------------------------------------------------------------
RPSC0000  MOVE      SCRID,F2
          BRANCH    F2,RPSC1100,RPSC1200,RPSC1300,RPSC1400,RPSC1500,RPSC1600:
                       RPSC1700
RPSC1100  PACK      KEY7,CEMAPSC
          GOTO      RPSC9000
RPSC1200  PACK      KEY7,CEMBPSC
          GOTO      RPSC9000
RPSC1300  PACK      KEY7,CEMCPSC
          GOTO      RPSC9000
RPSC1400  PACK      KEY7,CEMDPSC
          GOTO      RPSC9000
RPSC1500  PACK      KEY7,CEVAPSC
          GOTO      RPSC9000
RPSC1600  PACK      KEY7,CEVBPSC
          GOTO      RPSC9000
RPSC1700  PACK      KEY7,CEMEPSC
          CALL      GETCEM00
          GOTO      RPSC9000
RPSC9000  CALL      RDCEPS1
          IF        OVRCD=1
            MOVE      "Invalid",CEPSDES
          ENDIF
          RETURN
.------------------------------------------------------------
. Determine Fields for Casemix Type Mapping
.------------------------------------------------------------
GETCEM00  MOVE      "Discharge",NAMEDOS
          IF        CEMEDOS=1
            MOVE      "Admission",NAMEDOS
          ENDIF
          BRANCH    CEMETYQ,GETCEM10,GETCEM20,GETCEM30,GETCEM40,GETCEM50:
                            GETCEM60,GETCEM70,GETCEM80,GETCEM90
GETCEM10  MOVE     "Adm./Discharge",NAMETYQ
          GOTO     GETCEM99
GETCEM20  MOVE     "Bed Days (LOS)",NAMETYQ
          GOTO     GETCEM99
GETCEM30  MOVE     "LOS ",KEY4
          PACK     NAMETYQ,KEY4,CCCOIA1
          GOTO     GETCEM99
GETCEM40  MOVE     "LOS ",KEY4
          PACK     NAMETYQ,KEY4,CCCOIA2
          GOTO     GETCEM99
GETCEM50  MOVE     "LOS ",KEY4
          PACK     NAMETYQ,KEY4,CCCOIA3
          GOTO     GETCEM99
GETCEM60  MOVE     CCCOTH1,NAMETYQ
          GOTO     GETCEM99
GETCEM70  MOVE     CCCOTH2,NAMETYQ
          GOTO     GETCEM99
GETCEM80  MOVE     CCCOTH3,NAMETYQ
          GOTO     GETCEM99
GETCEM90  MOVE     CCCOTH4,NAMETYQ
          GOTO     GETCEM99
GETCEM99  RETURN
.
.------------------------------------------------------------
. Save Misc Group Service Mapping
.------------------------------------------------------------
POSA0000  PACK      KEY13,ACODE,CESPSPC,SP70                           * V90200
          CALL      RSCEMA1
POSA1000  CALL      RKCEMA1                * Delete all Patient Services
          BRANCH    OVRCD,POSA1900
          MATCH     ACODE,CEMAMGP                                      * V90200
          GOTO      POSA1900 IF NOT EQUAL
          MATCH     CESPSPC,CEMASPC
          GOTO      POSA1900 IF NOT EQUAL
.
          PACK      KEY13,CEMAMGP,CEMASPC,CEMAPSC
          CALL      DECEMA1
          GOTO      POSA1000
.
. Insert New Patient Services
.-----------------------------
POSA1900  MOVE      SP70,KEY5
          CALL      TRCEMA11
          COMPARE   ZERO,OVRCD
          GOTO      POSA2100 IF EQUAL
.
POSA2000  CALL      TKCEMA11
          BRANCH    OVRCD,POSA2900
.
POSA2100  MOVE      ACODE,CEMAMGP                                      * V90200
          MOVE      CESPSPC,CEMASPC
          PACK      KEY13,CEMAMGP,CEMASPC,CEMAPSC
          CALL      RACEMA1
          IF        OVRCD=0
            CALL      UPCEMA1
          ELSE
            CALL      WRCEMA1
          ENDIF
          GOTO      POSA2000
POSA2900
POSA9999  RETURN
.
.------------------------------------------------------------
. Delete Misc. Group Service Mapping
.------------------------------------------------------------
DELA0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DELA1000,DELA9000,DELA9100
.
DELA1000  PACK     KEY13,ACODE,CESPSPC,SP70                            * V90200
          CALL     RSCEMA1
DELA1100  CALL     RKCEMA1                * Delete all Patient Services
          BRANCH   OVRCD,DELA1900
          MATCH    ACODE,CEMAMGP                                       * V90200
          GOTO     DELA1900 IF NOT EQUAL
          MATCH    CESPSPC,CEMASPC
          GOTO     DELA1900 IF NOT EQUAL
.
          PACK     KEY13,CEMAMGP,CEMASPC,CEMAPSC
          CALL     DECEMA1
          GOTO     DELA1100
.
DELA1900  MOVE     TWO,EXIT            * Restart Screen
          GOTO     DELA9999
DELA9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DELA9999
DELA9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DELA9999
DELA9999  RETURN
.
.------------------------------------------------------------
. Enter Misc Group Code
.------------------------------------------------------------
EMGRP000  MOVE      "FI",TCODE                                         * V90200
          MOVE      ZERO,CKEYTYP
          CALL      KPCODA00                                           * V90200
          BRANCH    EXIT,EMGRP999,EMGRP999
          MOVE      ACODE,CEMAMGP                                      * V90200
EMGRP999  RETURN
.------------------------------------------------------------
. Save Misc Group Service Mapping
.------------------------------------------------------------
POSB0000  PACK      KEY19,MCHARGE,CESPSPC,SP70                         * V90200
          CALL      RSCEMB1
POSB1000  CALL      RKCEMB1                * Delete all Patient Services
          BRANCH    OVRCD,POSB1900
          MATCH     MCHARGE,CEMBMCC                                    * V90200
          GOTO      POSB1900 IF NOT EQUAL
          MATCH     CESPSPC,CEMBSPC
          GOTO      POSB1900 IF NOT EQUAL
          PACK      KEY19,CEMBMCC,CEMBSPC,CEMBPSC
          CALL      DECEMB1
          GOTO      POSB1000
.
. Insert New Patient Services
.-----------------------------
POSB1900  MOVE      SP70,KEY5
          CALL      TRCEMB11
          COMPARE   ZERO,OVRCD
          GOTO      POSB2100 IF EQUAL
.
POSB2000  CALL      TKCEMB11
          BRANCH    OVRCD,POSB2900
.
POSB2100  MOVE      MCHARGE,CEMBMCC                                    * V90200
          MOVE      CESPSPC,CEMBSPC
          PACK      KEY19,CEMBMCC,CEMBSPC,CEMBPSC
          CALL      RACEMB1
          IF        OVRCD=0
            CALL      UPCEMB1
          ELSE
            CALL      WRCEMB1
          ENDIF
          GOTO      POSB2000
POSB2900
POSB9999  RETURN
.
.
.------------------------------------------------------------
. Delete Misc. Group Service Mapping
.------------------------------------------------------------
DELB0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DELB1000,DELB9000,DELB9100
.
DELB1000  PACK     KEY19,MCHARGE,CESPSPC,SP70                          * V90200
          CALL     RSCEMB1
DELB1100  CALL     RKCEMB1                * Delete all Patient Services
          BRANCH   OVRCD,DELB1900
          MATCH    MCHARGE,CEMBMCC                                     * V90200
          GOTO     DELB1900 IF NOT EQUAL
          MATCH    CESPSPC,CEMBSPC
          GOTO     DELB1900 IF NOT EQUAL
          PACK     KEY19,CEMBMCC,CEMBSPC,CEMBPSC
          CALL     DECEMB1
          GOTO     DELB1100
.
DELB1900  MOVE     TWO,EXIT            * Restart Screen
          GOTO     DELB9999
DELB9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DELB9999
DELB9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DELB9999
DELB9999  RETURN
.
.
.------------------------------------------------------------
. Save Journal Code Service Mapping
.------------------------------------------------------------
POSC0000  PACK      KEY13,ACODE,CESPSPC,SP70                           * V90200
          CALL      RSCEMC1
POSC1000  CALL      RKCEMC1                * Delete all Patient Services
          BRANCH    OVRCD,POSC1900
          MATCH     ACODE,CEMCJCD                                      * V90200
          GOTO      POSC1900 IF NOT EQUAL
          MATCH     CESPSPC,CEMCSPC
          GOTO      POSC1900 IF NOT EQUAL
          PACK      KEY13,CEMCJCD,CEMCSPC,CEMCPSC
          CALL      DECEMC1
          GOTO      POSC1000
.
. Insert New Patient Services
.-----------------------------
POSC1900  MOVE      SP70,KEY5
          CALL      TRCEMC11
          COMPARE   ZERO,OVRCD
          GOTO      POSC2100 IF EQUAL
.
POSC2000  CALL      TKCEMC11
          BRANCH    OVRCD,POSC2900
.
POSC2100  MOVE      ACODE,CEMCJCD                                      * V90200
          MOVE      CESPSPC,CEMCSPC
          PACK      KEY13,CEMCJCD,CEMCSPC,CEMCPSC
          CALL      RACEMC1
          IF        OVRCD=0
            CALL      UPCEMC1
          ELSE
            CALL      WRCEMC1
          ENDIF
          GOTO      POSC2000
POSC2900
POSC9999  RETURN
.------------------------------------------------------------
. Delete Journal Code Service Mapping
.------------------------------------------------------------
DELC0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DELC1000,DELC9000,DELC9100
.
DELC1000  PACK     KEY13,ACODE,CESPSPC,SP70                            * V90200
          CALL     RSCEMC1
DELC1100  CALL     RKCEMC1                * Delete all Patient Services
          BRANCH   OVRCD,DELC1900
          MATCH    ACODE,CEMCJCD                                       * V90200
          GOTO     DELC1900 IF NOT EQUAL
          MATCH    CESPSPC,CEMCSPC
          GOTO     DELC1900 IF NOT EQUAL
          PACK     KEY13,CEMCJCD,CEMCSPC,CEMCPSC
          CALL     DECEMC1
          GOTO     DELC1100
.
DELC1900  MOVE     TWO,EXIT            * Restart Screen
          GOTO     DELC9999
DELC9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DELC9999
DELC9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DELC9999
DELC9999  RETURN
.


.------------------------------------------------------------
. Enter Journal Code
.------------------------------------------------------------
EJCOD000  MOVE      "J ",TCODE                                         * V90200
          MOVE      ZERO,CKEYTYP
          CALL      KPCODA00                                           * V90200
          BRANCH    EXIT,EJCOD999,EJCOD999
          MOVE      ACODE,CEMCJCD                                      * V90200
EJCOD999  RETURN

.------------------------------------------------------------
. Default Patient Service Quantity to 1
.------------------------------------------------------------
DEFONE00  MOVE      ONE,CEVAQTY
          MOVE      ONE,CEMDQTY
          MOVE      ONE,CEMEQTY
          RETURN
.
.------------------------------------------------------------
. Save Implant Quantity Mapping
.------------------------------------------------------------
POSD0000  PACK      KEY13,ACODE,CESPSPC,SP70                           * V90200
          CALL      RSCEMD1
POSD1000  CALL      RKCEMD1                * Delete all Patient Services
          BRANCH    OVRCD,POSD1900
          MATCH     ACODE,CEMDCOD                                      * V90200
          GOTO      POSD1900 IF NOT EQUAL
          MATCH     CESPSPC,CEMDSPC
          GOTO      POSD1900 IF NOT EQUAL
          PACK      KEY13,CEMDCOD,CEMDSPC,CEMDPSC
          CALL      DECEMD1
          GOTO      POSD1000
.
. Insert New Patient Services
.-----------------------------
POSD1900  MOVE      SP70,KEY5
          CALL      TRCEMD11
          COMPARE   ZERO,OVRCD
          GOTO      POSD2100 IF EQUAL
.
POSD2000  CALL      TKCEMD11
          BRANCH    OVRCD,POSD2900
.
POSD2100  MOVE      ACODE,CEMDCOD                                      * V90200
          MOVE      CESPSPC,CEMDSPC
          PACK      KEY13,CEMDCOD,CEMDSPC,CEMDPSC
          CALL      RACEMD1
          IF        OVRCD=0
            CALL      UPCEMD1
          ELSE
            CALL      WRCEMD1
          ENDIF
          GOTO      POSD2000
POSD2900
POSD9999  RETURN
.

.------------------------------------------------------------
. Enter Discharge Status Mapping
.------------------------------------------------------------
EDST0000  MOVE      "D ",TCODE                                         * V90200
          MOVE      ZERO,CKEYTYP
          CALL      KPCODA00                                           * V90200
          BRANCH    EXIT,EDST9999,EDST9999
          MOVE      ACODE,CEMDCOD                                      * V90200
EDST9999  RETURN

.------------------------------------------------------------
. Determine Doctors File to Use
.------------------------------------------------------------
GETDOC00  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      VMOBITTF,"vmobitaf"
          TRAPCLR   IO
          MOVE      OVRCD,VMOFILOP
          BRANCH    OVRCD,GETDOC99
          CLOSE     VMOBITTF
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      PATDO1A1,"patdo1af"                                * V90200
          TRAPCLR   IO
          MOVE      OVRCD,VMOFILOP
          GOTO      GETDOC99
.
GETDOC99  RETURN
.------------------------------------------------------------
. Save Journal Code Service Mapping
.------------------------------------------------------------
POSE0000  PACK      KEY16,DOCTCODE,CESPSPC,SP70
          CALL      RSCEVA1
POSE1000  CALL      RKCEVA1                * Delete all Patient Services
          BRANCH    OVRCD,POSE1900
          MATCH     DOCTCODE,CEVADOC
          GOTO      POSE1900 IF NOT EQUAL
          MATCH     CESPSPC,CEVASPC
          GOTO      POSE1900 IF NOT EQUAL
          PACK      KEY16,CEVADOC,CEVASPC,CEVAPSC
          CALL      DECEVA1
          GOTO      POSE1000
.
. Insert New Patient Services
.-----------------------------
POSE1900  MOVE      SP70,KEY5
          CALL      TRCEVA11
          COMPARE   ZERO,OVRCD
          GOTO      POSE2100 IF EQUAL
.
POSE2000  CALL      TKCEVA11
          BRANCH    OVRCD,POSE2900
.
POSE2100  MOVE      DOCTCODE,CEVADOC
          MOVE      CESPSPC,CEVASPC
          PACK      KEY16,CEVADOC,CEVASPC,CEVAPSC
          CALL      RACEVA1
          IF        OVRCD=0
            CALL      UPCEVA1
          ELSE
            CALL      WRCEVA1
          ENDIF
          GOTO      POSE2000
POSE2900
POSE9999  RETURN
.
.------------------------------------------------------------
. Enter Doctor Code
.------------------------------------------------------------
EDOC0000  BRANCH    VMOFILOP,EDOC9000
.
EDOC1000  MOVE      ZERO,CKEYTYP
          CALL      KPDOCA00                                           * V90200
          BRANCH    EXIT,EDOC9999,EDOC9999
          MOVE      DCODE,DOCTCODE                                     * V90200
          MOVE      DCODE,CEVADOC                                      * V90200
          MOVE      DGNAME,ANS                                         * V90200
          STRIP     DTITL                                              * V90200
          PACK      DOCTNAME,DTITL,SP1,ANS,SP1,DSNAME,SP70             * V90200
          GOTO      EDOC9999
.
EDOC9000  MOVE      "V.M.O. System Not Available - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          MOVE      TWO,EXIT
.
EDOC9999  RETURN
.
.------------------------------------------------------------
. Delete Journal Code Service Mapping
.------------------------------------------------------------
DELE0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DELE1000,DELE9000,DELE9100
.
DELE1000  PACK     KEY16,DOCTCODE,CESPSPC,SP70
          CALL     RSCEVA1
DELE1100  CALL     RKCEVA1                * Delete all Patient Services
          BRANCH   OVRCD,DELE1900
          MATCH    DOCTCODE,CEVADOC
          GOTO     DELE1900 IF NOT EQUAL
          MATCH    CESPSPC,CEVASPC
          GOTO     DELE1900 IF NOT EQUAL
          PACK     KEY16,CEVADOC,CEVASPC,CEVAPSC
          CALL     DECEVA1
          GOTO     DELE1100
.
DELE1900  MOVE     TWO,EXIT            * Restart Screen
          GOTO     DELE9999
DELE9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DELE9999
DELE9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DELE9999
DELE9999  RETURN
.

.------------------------------------------------------------
. Copy Patient Service Mappings
.------------------------------------------------------------
CVMO0000  MOVE      DOCTCODE,SAVEDOC
          MOVE      CEVASPC,SAVESPC
          CALL      POSE0000
          DISPLAY   *P1:12,*EF
          HLINE     *G37,12,1,80
          DISPLAY   *P1:14,*V2LON,*ULON,"Copy Pat. Serv. to Range",*HOFF:
                    *P1:17,"Doctor From   :":
                    *P1:18,"       To     :"
CVMO1000  MOVE      ZERO,CKEYTYP
          MOVE      "18",CCOL
          MOVE      "17",CVERT
          CALL      EDOC0000
          BRANCH    EXIT,CVMO9000,CVMO9000
          DISPLAY   *PCCOL:CVERT,*V2LON,DOCTCODE,*HOFF,SP1,DOCTNAME
          MOVE      DOCTCODE,STRDOC
.
          COMPARE   ZERO,F1
          MOVE      "17",CCOL
          MOVE      "18",CVERT
          MOVE      ZERO,CKEYTYP
          CALL      EDOC0000
          BRANCH    EXIT,CVMO9000,CVMO9000
          MOVE      DOCTCODE,ENDDOC
          DISPLAY   *PCCOL:CVERT,*V2LON,DOCTCODE,*HOFF,SP1,DOCTNAME
.
          MATCH     STRDOC,ENDDOC
          GOTO      CVMO1100 IF EQUAL
          GOTO      CVMO1100 IF NOT LESS
          BEEP
          MOVE      "To Doctor Must Be > From Doctor - ",DISPMSG
          CALL      MESSAGE1
          GOTO      CVMO1000
.
CVMO1100  DISPLAY   *P1:23,"Copy Details for All Service Providers (":
                            *V2LON,"Y",*HOFF,"/":
                            *V2LON,"N",*HOFF,") ? "
          MOVE      "48",CCOL
          MOVE      "23",CVERT
          CALL      YORN0000
          MOVE      FYESNO,COPYALL
.
          DISPLAY   *P1:24,"Post Copy (",*V2LON,"Y",*HOFF,"/":
                                                  *V2LON,"N",*HOFF,") ? "
          MOVE      "19",CCOL
          MOVE      "24",CVERT
          CALL      YORN0000
          COMPARE   ONE,FYESNO
          GOTO      CVMO9000 IF NOT EQUAL
.
CVMO3000  PACK      KEY6,STRDOC,SP70
          CALL      RDDOCT1                                            * V90200
          IF        OVRCD=0
            CALL      RDPDOCT1                                         * V90200
          ENDIF
CVMO3100  CALL      RDKDOCT1                                           * V90200
          BRANCH    OVRCD,CVMO9000
          MATCH     DCODE,ENDDOC                                       * V90200
          GOTO      CVMO9000 IF LESS
          MOVE      SAVEDOC,FROMDOC
          MOVE      DCODE,TODOC                                        * V90200
          CALL      CDOC0000
          GOTO      CVMO3100
.
CVMO9000
CVMO9999  RETURN
.------------------------------------------------------------
. Copy a Wards Details
. From Ward = FROMDOC
. To   Ward = TODOC
. All Service Providers 1=Yes
.------------------------------------------------------------
CDOC0000  IF        COPYALL=1
            PACK      KEY16,FROMDOC,SP70
          ELSE
            PACK      KEY16,FROMDOC,SAVESPC,SP70
          ENDIF
          CALL      RSCEVA1
CDOC1000  CALL      RKCEVA1
          BRANCH    OVRCD,CDOC9999
          MATCH     FROMDOC,CEVADOC
          GOTO      CDOC9999 IF NOT EQUAL
          BRANCH    COPYALL,CDOC1100
          MATCH     SAVESPC,CEVASPC
          GOTO      CDOC9999 IF NOT EQUAL
.
CDOC1100  PACK      KEY16,TODOC,CEVASPC,CEVAPSC
          UNPACK    KEY16,CEVADOC,CEVASPC,CEVAPSC
          CALL      RACEVA1
          IF        OVRCD=0
              CALL      UPCEVA1
          ELSE
              CALL      WRCEVA1
          ENDIF
          PACK      KEY16,FROMDOC,CEVASPC,CEVAPSC
          CALL      RDCEVA1
          GOTO      CDOC1000
CDOC9999  RETURN
.
.------------------------------------------------------------
. Save VMO Doc Type Service Mapping
.------------------------------------------------------------
POSF0000  PACK      KEY13,ACODE,CESPSPC,SP70                           * V90200
          CALL      RSCEVB1
POSF1000  CALL      RKCEVB1                * Delete all Patient Services
          BRANCH    OVRCD,POSF1900
          MATCH     ACODE,CEVBDTY                                      * V90200
          GOTO      POSF1900 IF NOT EQUAL
          MATCH     CESPSPC,CEVBSPC
          GOTO      POSF1900 IF NOT EQUAL
          PACK      KEY13,CEVBDTY,CEVBSPC,CEVBPSC
          CALL      DECEVB1
          GOTO      POSF1000
.
. Insert New Patient Services
.-----------------------------
POSF1900  MOVE      SP70,KEY5
          CALL      TRCEVB11
          COMPARE   ZERO,OVRCD
          GOTO      POSF2100 IF EQUAL
.
POSF2000  CALL      TKCEVB11
          BRANCH    OVRCD,POSF2900
.
POSF2100  MOVE      ACODE,CEVBDTY                                      * V90200
          MOVE      CESPSPC,CEVBSPC
          PACK      KEY13,CEVBDTY,CEVBSPC,CEVBPSC
          CALL      RACEVB1
          IF        OVRCD=0
            CALL      UPCEVB1
          ELSE
            CALL      WRCEVB1
          ENDIF
          GOTO      POSF2000
POSF2900
POSF9999  RETURN
.
.------------------------------------------------------------
. Enter Doctor Type
.------------------------------------------------------------
EDTYP000  MOVE      "DT",TCODE                                         * V90200
          MOVE      ZERO,CKEYTYP
          CALL      KPCODA00                                           * V90200
          BRANCH    EXIT,EDTYP999,EDTYP999
          MOVE      ACODE,CEVBDTY                                      * V90200
.
EDTYP999  RETURN

.------------------------------------------------------------
. Delete Journal Code Service Mapping
.------------------------------------------------------------
DELF0000  MOVE     SP70,DISPMSG        * Clear Line 24 Display Message
          CALL     MESSAGE2            * Save and Clear Line 24
          CALL     DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL     MESSAGE3            * Restore Line 24
          BRANCH   CEXIT,DELF1000,DELF9000,DELF9100
.
DELF1000  PACK     KEY13,ACODE,CESPSPC,SP70                            * V90200
          CALL     RSCEVB1
DELF1100  CALL     RKCEVB1                * Delete all Patient Services
          BRANCH   OVRCD,DELF1900
          MATCH    ACODE,CEVBDTY                                       * V90200
          GOTO     DELF1900 IF NOT EQUAL
          MATCH    CESPSPC,CEVBSPC
          GOTO     DELF1900 IF NOT EQUAL
          PACK     KEY13,CEVBDTY,CEVBSPC,CEVBPSC
          CALL     DECEVB1
          GOTO     DELF1100
.
DELF1900  MOVE     TWO,EXIT            * Restart Screen
          GOTO     DELF9999
DELF9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DELF9999
DELF9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DELF9999
DELF9999  RETURN
.

.------------------------------------------------------------
. Read Control File Details
.------------------------------------------------------------
REDCON00  MOVE      "   64",AUDTSECT
          READ      CONTROLF,AUDTSECT;*109,CCCOIA1,CCCOIA2,CCCOIA3:
                                      *183,CCCOTH1,CCCOTH2,CCCOTH3,CCCOTH4
          RETURN

.------------------------------------------------------------
. Save Casemix Type/Code Mapping
.------------------------------------------------------------
POSG0000  PACK      KEY23,CCSTSTY,CCXHKEY,CESPSPC,SP70
          CALL      RSCEME1
POSG1000  CALL      RKCEME1                * Delete all Patient Services
          BRANCH    OVRCD,POSG1900
          MATCH     CCSTSTY,CEMESTY
          GOTO      POSG1900 IF NOT EQUAL
          MATCH     CCXHKEY,CEMEKEY
          GOTO      POSG1900 IF NOT EQUAL
          MATCH     CESPSPC,CEMESPC
          GOTO      POSG1900 IF NOT EQUAL
          PACK      KEY23,CEMESTY,CEMEKEY,CEMESPC,CEMEPSC,SP70
          CALL      DECEME1
          GOTO      POSG1000
.
. Insert New Patient Services
.-----------------------------
POSG1900  MOVE      SP70,KEY5
          CALL      TRCEME11
          COMPARE   ZERO,OVRCD
          GOTO      POSG2100 IF EQUAL
.
POSG2000  CALL      TKCEME11
          BRANCH    OVRCD,POSG2900
.
POSG2100  MOVE      CCSTSTY,CEMESTY
          MOVE      CCXHKEY,CEMEKEY
          MOVE      CESPSPC,CEMESPC
          PACK      KEY23,CEMESTY,CEMEKEY,CEMESPC,CEMEPSC
          CALL      RACEME1
          IF        OVRCD=0
            CALL      UPCEME1
          ELSE
            CALL      WRCEME1
          ENDIF
          GOTO      POSG2000
POSG2900
POSG9999  RETURN
.
.------------------------------------------------------------
. Enter Casemix Code to Map
.------------------------------------------------------------
EXHD0000  MOVE    ZERO,CKEYTYP
          MOVE    CCSTSTY,CCXHSTY
          CALL    KCCXHA00
          BRANCH  EXIT,EXHD9999,EXHD9999
          MOVE    CCSTSTY,CEMESTY
          MOVE    CCXHKEY,CEMEKEY
EXHD9999  RETURN
.------------------------------------------------------------
. Delete Casemix Type/Code Mapping
.------------------------------------------------------------
DELG0000  MOVE      SP70,DISPMSG        * Clear Line 24 Display Message
          CALL      MESSAGE2            * Save and Clear Line 24
          CALL      DELQST              * Delete (Y/N/C) CEXIT 1/2/3
          CALL      MESSAGE3            * Restore Line 24
          BRANCH    CEXIT,DELG1000,DELG9000,DELG9100
.
DELG1000  PACK      KEY23,CCSTSTY,CCXHKEY,CESPSPC,SP70
          CALL      RSCEME1
DELG1100  CALL      RKCEME1                * Delete all Patient Services
          BRANCH    OVRCD,POSG1900
          MATCH     CCSTSTY,CEMESTY
          GOTO      DELG1900 IF NOT EQUAL
          MATCH     CCXHKEY,CEMEKEY
          GOTO      DELG1900 IF NOT EQUAL
          MATCH     CESPSPC,CEMESPC
          GOTO      DELG1900 IF NOT EQUAL
          PACK      KEY23,CEMESTY,CEMEKEY,CEMESPC,CEMEPSC,SP70
          CALL      DECEME1
          GOTO      DELG1100
.
DELG1900  MOVE     TWO,EXIT            * Restart Screen
          GOTO     DELF9999
DELG9000  MOVE     ONE,EXIT            * Return to Prompt on "No"
          GOTO     DELF9999
DELG9100  MOVE     TWO,EXIT            * Restart Screen on "Cancel"
          GOTO     DELF9999
DELG9999  RETURN
.
.------------------------------------------------------------
. Enter Date of Service
.------------------------------------------------------------
EDOS0000  CALL     DDOS0000
EDOS0010  MOVE     ONE,F2
          KEYIN    *PCCOL:CVERT,*V2LON,*RV,F2
          MOVE     F2,CEMEDOS
          BRANCH   F2,EDOS0100,EDOS0200
          BEEP
          GOTO     EDOS0010
EDOS0100  MOVE     "Admission",NAMEDOS
          GOTO     EDOS9000
EDOS0200  MOVE     "Discharge",NAMEDOS
          GOTO     EDOS9000
EDOS9000  CALL     PUTSCR00
EDOS9999  RETURN
.
DDOS0000  MOVE      "20",HTOP
          MOVE      "55",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P60:21,*V2LON,*ULON,"Date of Service",*HOFF:
                    *P57:22,*V2LON,"1. ",*HOFF,"Admission Date":
                    *P57:23,*V2LON,"2. ",*HOFF,"Discharge Date"
          RETURN
.
.
.------------------------------------------------------------
. Enter Type of Quantity
.------------------------------------------------------------
ETYQ0000  CALL     DTYQ0000
ETYQ0010  MOVE     ONE,F2
          KEYIN    *PCCOL:CVERT,*V2LON,*RV,F2
          MOVE     F2,CEMETYQ
          BRANCH   F2,ETYQ0100,ETYQ0200,ETYQ0300,ETYQ0400,ETYQ0500:
                      ETYQ0600,ETYQ0700,ETYQ0800,ETYQ0900
          BEEP
          GOTO     ETYQ0010
ETYQ0100  MOVE     "Adm./Discharge",NAMETYQ
          GOTO     ETYQ9000
ETYQ0200  MOVE     "Bed Days (LOS)",NAMETYQ
          GOTO     ETYQ9000
ETYQ0300  MOVE     "LOS ",KEY4
          PACK     NAMETYQ,KEY4,CCCOIA1
          GOTO     ETYQ9000
ETYQ0400  MOVE     "LOS ",KEY4
          PACK     NAMETYQ,KEY4,CCCOIA2
          GOTO     ETYQ9000
ETYQ0500  MOVE     "LOS ",KEY4
          PACK     NAMETYQ,KEY4,CCCOIA3
          GOTO     ETYQ9000
ETYQ0600  MOVE     CCCOTH1,NAMETYQ
          GOTO     ETYQ9000
ETYQ0700  MOVE     CCCOTH2,NAMETYQ
          GOTO     ETYQ9000
ETYQ0800  MOVE     CCCOTH3,NAMETYQ
          GOTO     ETYQ9000
ETYQ0900  MOVE     CCCOTH4,NAMETYQ
          GOTO     ETYQ9000
ETYQ9000  CALL     PUTSCR00
ETYQ9999  RETURN
.
DTYQ0000  MOVE      "13",HTOP
          MOVE      "55",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P60:14,*V2LON,*ULON,"Base Quantity",*HOFF:
                    *P57:15,*V2LON,"1. ",*HOFF,"Adm./Discharge":
                    *P57:16,*V2LON,"2. ",*HOFF,"Bed Days (LOS)":
                    *P57:17,*V2LON,"3. ",*HOFF,"LOS ",CCCOIA1:
                    *P57:18,*V2LON,"4. ",*HOFF,"LOS ",CCCOIA2:
                    *P57:19,*V2LON,"5. ",*HOFF,"LOS ",CCCOIA3:
                    *P57:20,*V2LON,"6. ",*HOFF,CCCOTH1:
                    *P57:21,*V2LON,"7. ",*HOFF,CCCOTH2:
                    *P57:22,*V2LON,"8. ",*HOFF,CCCOTH3:
                    *P57:23,*V2LON,"9. ",*HOFF,CCCOTH4
          RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CCSSTYIO/INC
          INC       CCSSTYKY    
          INC       CCSXHDIO/INC
          INC       CCSXHDKY    
          INC       CEACODKY    
          INC       CEADOCKY    
          INC       CEAMAPIO/INC
          INC       CEAMBPIO/INC
          INC       CEAMCGKY    
          INC       CEAMCPIO/INC
          INC       CEAMDPIO/INC
          INC       CEAMEPIO/INC
          INC       CEAPSCIO/INC
          INC       CEAPSCKY    
          INC       CEASPCIO/INC
          INC       CEASPCKY    
          INC       CEAVAMIO/INC
          INC       CEAVBMIO/INC
          INC       PATCODIO/INC
          INC       PATDO1IO/INC
          INC       PATMCHIO/INC
          INC       PATMCHRD    
.
          INC       STDGENCD
.
