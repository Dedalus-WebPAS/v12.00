.---------------------------------------------------------------------------
.   System    :   Clinical Costing System            
.   Include   :   CCSEPSKY
.   Routine   :   HCCEPA00 Episode             
.   Return    :           
.-------------------------------------------------------------------------------
HCCEPA00
          MOVE      ZERO,CSCRSIZ
          IF        HTOP<3
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "60",HLEF
            MOVE      "80",HRIG
          ENDIF
HCCEPA04
          CALL      GSCRN000
          BRANCH    EXIT,HCCEPA99
          MOVE      STDCOL00,STDCOL01
          ADD       " 5",STDCOL01
          DISPLAY   *PSTDCOL01:STDROW,*V2LON,*ULON,"Episode"            
.
          MOVE      STDCOL01,STDCOL02
          ADD       "17",STDCOL02
HCCEPA08
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          MOVE      SP70,CCEPEPS 
          PACK      KEY18,CCEPHCD,CCEPEPS,SP70                                  
          PACK      SAVKEY80,CCEPHCD,CCEPEPS,SP70                               
          SETLPTR   SAVKEY80,2                                                  
          CALL      RSCCEP1 
HCCEPA10
          CALL      RKCCEP1 
          BRANCH    OVRCD,HCCEPA15
          PACK      KEY18,CCEPHCD,CCEPEPS,SP70                                  
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HCCEPA15 IF NOT EQUAL                                       
          BRANCH    CSEARCH,HCCEPA12
          CALL      HCCEPA60
          BRANCH    OVRCD,HCCEPA10
HCCEPA12
          ADD       ONE,XITEMNO
          ADD       ONE,STDROW
          STORE     KEY18,XITEMNO,ST1,ST2,ST3,ST4,ST5:                          
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          DISPLAY   *PSTDCOL00:STDROW,SP1,*V2LON,XITEMNO,DOT
          DISPLAY   *PSTDCOL01:STDROW,CCEPEPS 
          COMPARE   MAXITEM,XITEMNO
          GOTO      HCCEPA10 IF NOT EQUAL
HCCEPA15
          UNPACK    SAVKEY80,CCEPHCD,CCEPEPS                                    
          MOVE      ONE,DITEM
          MOVE      MINITEM,DROW
          ADD       ONE,DROW
          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1,DITEM,DOT
          CLIP
          FLUSH     HLEF,HTOP,HRIG,HBOT
.
HCCEPA20
          CALL      HSCRI000
          BRANCH    EXIT,HCCEPA30,HCCEPA35,HCCEPA40,HCCEPA45,HCCEPA04:
                              HCCEPA91,HCCEPA50
          GOTO      HCCEPA92
HCCEPA30
          CALL      RKCCEP1 
          BRANCH    OVRCD,HCCEPA85
          PACK      KEY18,CCEPHCD,CCEPEPS,SP70                                  
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HCCEPA85 IF NOT EQUAL                                       
          CALL      RPCCEP1 
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCEPA10
HCCEPA35
          MOVE      ST1,KEY18
          CALL      RDCCEP1 
          CALL      RPCCEP1 
          BRANCH    OVRCD,HCCEPA85
          PACK      KEY18,CCEPHCD,CCEPEPS,SP70                                  
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HCCEPA85 IF NOT EQUAL                                       
          MATCH     SP70,CCEPEPS                                                
          GOTO      HCCEPA85 IF EQUAL                                           
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
HCCEPA36
          CALL      RPCCEP1 
          BRANCH    OVRCD,HCCEPA37
          PACK      KEY18,CCEPHCD,CCEPEPS,SP70                                  
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HCCEPA37 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCCEPA36 IF NOT EQUAL
HCCEPA37
          MOVE      ZERO,XITEMNO
          GOTO      HCCEPA10
HCCEPA40
          MOVE      ST1,KEY18
          CALL      RDCCEP1 
          CALL      RPCCEP1 
          BRANCH    OVRCD,HCCEPA85
          PACK      KEY18,CCEPHCD,CCEPEPS,SP70                                  
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HCCEPA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCEPA08
HCCEPA45
          CALL      RKCCEP1 
          BRANCH    OVRCD,HCCEPA85
          PACK      KEY18,CCEPHCD,CCEPEPS,SP70                                  
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HCCEPA85 IF NOT EQUAL                                       
          SUSPEND
          CLIP      1,1,CRIG,24
.
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          MOVE      ZERO,XITEMNO
          PACK      KEY18,SAVKEY80,Z70                                          
          MOVE      MINITEM,STDROW
          MOVE      MAXITEM,XITEMNO
          CALL      RSCCEP1 
HCCEPA46
          CALL      RPCCEP1 
          BRANCH    OVRCD,HCCEPA47
          PACK      KEY18,CCEPHCD,CCEPEPS,SP70                                  
          MATCH     SAVKEY80,KEY18                                              
          GOTO      HCCEPA47 IF NOT EQUAL                                       
          SUB       ONE,XITEMNO
          COMPARE   ZERO,XITEMNO
          GOTO      HCCEPA46 IF NOT EQUAL
HCCEPA47
          MOVE      ZERO,XITEMNO
          GOTO      HCCEPA10
HCCEPA50  COMPARE   ZERO,CSEARCH
          GOTO      HCCEPA55 IF EQUAL
          MOVE      ZERO,CSEARCH
          MOVE      ZERO,XITEMNO
          MOVE      MINITEM,STDROW
          ADD       ONE,STDROW
          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03,SCHFLD04,SCHFLD05
          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08,SCHFLD09,SCHFLD10
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,"Sch"
          KEYIN     *PSTDCOL01:STDROW,*V2LON,SCHFLD01
          RESET     SCHFLD01
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCEPA08
HCCEPA55  MOVE      ONE,CSEARCH
          PACK      KEY8,SP70
          SUSPEND
          CLIP      1,1,CRIG,24
          BOXCLR    CLEF,CTOP,CRIG,CBOT
          GOTO      HCCEPA08
HCCEPA60  MOVE      ZERO,OVRCD
          MATCH     SP70,SCHFLD01
          GOTO      HCCEPA61 IF EQUAL
          MATCH     SCHFLD01,CCEPEPS 
          GOTO      HCCEPA72 IF NOT EQUAL
HCCEPA61
HCCEPA62
HCCEPA63
HCCEPA64
HCCEPA65
HCCEPA66
HCCEPA67
HCCEPA68
HCCEPA69
HCCEPA70
          GOTO      HCCEPA75
HCCEPA72  MOVE      ONE,OVRCD
HCCEPA75  RETURN
HCCEPA85
          LOAD      KEY18,XITEMNO,ST1,ST2,ST3,ST4,ST5:                          
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY18,CCEPHCD,CCEPEPS                                       
          CALL      RDCCEP1 
HCCEPA90
          UNPACK    SAVKEY80,CCEPHCD,CCEPEPS                                    
          BEEP
          GOTO      HCCEPA20
HCCEPA91
          MOVE      SP70,CCEPSUR 
          MOVE      SP70,CCEPGIV 
          MOVE      SP70,CCEPCOM 
          MOVE      SP70,CCEPURN 
          MOVE      SP70,CCEPSDT 
          MOVE      SP70,CCEPLTD 
          MOVE      ZERO,CCEPLOS 
          MOVE      SP70,CCEPINPT
          MOVE      SP70,CCEPDAY 
          MOVE      ZERO,CCEPVIST
          MOVE      SP70,CCEPSEX 
          MOVE      SP70,CCEPDOB 
          MOVE      SP70,CCEPAGEY
          MOVE      SP70,CCEPAGEM
          MOVE      SP70,CCEPAGED
          MOVE      SP70,CCEPCOB 
          MOVE      SP70,CCEPREL 
          MOVE      SP70,CCEPDDAT
          MOVE      SP70,CCEPDWAR
          MOVE      SP70,CCEPDSTA
          MOVE      SP70,CCEPDDES
          MOVE      SP70,CCEPDMBS
          MOVE      SP70,CCEPDDPT
          MOVE      SP70,CCEPDSER
          MOVE      SP70,CCEPMDCC
          MOVE      SP70,CCEPDRGC
          MOVE      SP70,CCEPADAT
          MOVE      SP70,CCEPAWAR
          MOVE      SP70,CCEPASRC
          MOVE      SP70,CCEPACLS
          MOVE      SP70,CCEPACAR
          MOVE      SP70,CCEPADPT
          MOVE      SP70,CCEPASER
          MOVE      SP70,CCEPARDC
          MOVE      SP70,CCEPATDC
          MOVE      SP70,CCEPAADC
          MOVE      SP70,CCEPDADC
          MOVE      SP70,CCEPAHFD
          MOVE      SP70,CCEPAHTB
          MOVE      SP70,CCEPAMBS
          MOVE      SP70,CCEPOPCL
          MOVE      SP70,CCEPPDIA
          MOVE      SP70,CCEPSDIA
          MOVE      SP70,CCEPPOPP
          MOVE      SP70,CCEPSOPP
          MOVE      SP70,CCEPEXC 
          MOVE      SP70,CCEPPMBS
          MOVE      SP70,CCEPSMBS
          MOVE      SP70,CCEPMU1 
          MOVE      SP70,CCEPMU2 
          MOVE      SP70,CCEPMU3 
          MOVE      SP70,CCEPMU4 
          MOVE      SP70,CCEPMU5 
          MOVE      SP70,CCEPMU6 
          MOVE      SP70,CCEPMU7 
          MOVE      SP70,CCEPPCD 
          MOVE      SP70,CCEPCLM 
          MOVE      SP70,CCEPCLI 
          MOVE      SP70,CCEPCTY 
          MOVE      SP70,CCEPANA 
          MOVE      SP70,CCEPOTY 
          MOVE      SP70,CCEPTTR 
          MOVE      SP70,CCEPOY6 
          MOVE      SP70,CCEPOY7 
          MOVE      SP70,CCEPOY8 
          MOVE      SP70,CCEPOY9 
          MOVE      SP70,CCEPORM 
          MOVE      SP70,CCEPOKI 
          MOVE      SP70,CCEPOTP 
          MOVE      SP70,CCEPTST 
          MOVE      SP70,CCEPINS 
          MOVE      SP70,CCEPTIM 
          MOVE      SP70,CCEPTDP 
          MOVE      SP70,CCEPAST 
          MOVE      SP70,CCEPAMD 
          MOVE      SP70,CCEPAU1 
          MOVE      SP70,CCEPAU2 
          MOVE      SP70,CCEPAU3 
          MOVE      SP70,CCEPAU4 
          MOVE      SP70,CCEPAU5 
          MOVE      SP70,CCEPAU6 
          MOVE      SP70,CCEPAU7 
          MOVE      SP70,CCEPAU8 
          MOVE      SP70,CCEPAWT 
          MOVE      SP70,CCEPAPR 
          MOVE      SP70,CCEPAET 
          MOVE      SP70,CCEPART 
          MOVE      SP70,CCEPAIN 
          MOVE      SP70,CCEPAPL 
          MOVE      SP70,CCEPAPY 
          MOVE      SP70,CCEPOST 
          MOVE      SP70,CCEPOCL 
          MOVE      SP70,CCEPOCT 
          MOVE      SP70,CCEPOVT 
          MOVE      SP70,CCEPODY 
          MOVE      SP70,CCEPOSS 
          MOVE      SP70,CCEPODS 
          MOVE      SP70,CCEPOAT 
          MOVE      SP70,CCEPOPR 
          MOVE      SP70,CCEPOU1 
          MOVE      SP70,CCEPOU2 
          MOVE      SP70,CCEPOU3 
          MOVE      SP70,CCEPOU4 
          MOVE      SP70,CCEPODP 
          MOVE      SP70,CCEPOTR 
          MOVE      SP70,CCEPOLG 
          MOVE      SP70,CCEPOOT 
          MOVE      SP70,CCEPMU8 
          MOVE      SP70,CCEPMU9 
          MOVE      SP70,CCEPMU10
          MOVE      SP70,CCEPPHP 
          MOVE      SP70,CCEPAGN 
          MOVE      ZERO,CCEPVW5 
          MOVE      ZERO,CCEPV5A 
          MOVE      SP70,CCEPSPA 
          MOVE      SP70,KEY18
          MOVE      SP70,CCEPEPS 
          GOTO      HCCEPA96
HCCEPA92
          MOVE      SP70,KEY18
          MOVE      SP70,CCEPEPS 
          LOAD      KEY18,CCITEM,ST1,ST2,ST3,ST4,ST5:                           
                                ST6,ST7,ST8,ST9,ST10:
                                ST11,ST12,ST13,ST14,ST15:
                                ST16,ST17
          UNPACK    KEY18,CCEPHCD,CCEPEPS                                       
HCCEPA96
          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT
          CALL      FRESCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
HCCEPA99
          RETURN
.---------------------------------------------------------------------------
.   System    :   Clinical Costing System            
.   Include   :   CCSEPSKY
.   Routine   :   KCCEPA00 Keyin Episode             
.   Parameter :   CKEYTYP 0 = Keyin , 1 = Accept, 2 = Either
.   Return    :   EXIT = 1 null entry, 2 EXITCHAR entered
.-------------------------------------------------------------------------------
KCCEPA00 TOPIC     "CCEPEPS "
          MOVE      UNDLN70,CCEPEPS 
          KEYIN     *PCCOL:CVERT,*DV,CCEPEPS:                                   
                    *PCCOL:CVERT,*V2LON,CCEPEPS:                                
                    *PCCOL:CVERT,*DV,CCEPEPS 
.
          ENDSET    CCEPEPS 
          APPEND    SP70,CCEPEPS 
          RESET     CCEPEPS 
.
          MATCH     SP70,CCEPEPS 
          GOTO      KCCEPA90 IF EQUAL
.
          CMATCH    EXITCHAR,CCEPEPS 
          GOTO      KCCEPA95 IF EQUAL
.
          CMATCH    QUEST,CCEPEPS 
          GOTO      KCCEPA10 IF NOT EQUAL
.
          MOVE      CCITEM,SCCITEM
          CALL      HCCEPA00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    CCEPEPS 
          APPEND    SP70,CCEPEPS 
          RESET     CCEPEPS 
.
          MATCH     SP70,CCEPEPS 
          GOTO      KCCEPA00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,CCEPEPS                                 
KCCEPA10
          PACK      KEY18,CCEPHCD,CCEPEPS                                       
          CALL      RACCEP1 
          BRANCH    OVRCD,KCCEPA80
          BRANCH    CKEYTYP,KCCEPA75
          CALL      RDCCEP1 
KCCEPA70
          MOVE      ZERO,EXIT
          GOTO      KCCEPA99
KCCEPA75
          MOVE      "Episode Already Exist - ",DISPMSG                                               
          CALL      MESSAGE1
          GOTO      KCCEPA00
KCCEPA80
          MOVE      ZERO,EXIT
          BRANCH    CKEYTYP,KCCEPA99,KCCEPA99
          MOVE      "Episode Does Not Exist - ",DISPMSG                                              
          CALL      MESSAGE1
          GOTO      KCCEPA00
KCCEPA90
          MOVE      ONE,EXIT
          GOTO      KCCEPA99
KCCEPA95
          MOVE      TWO,EXIT
KCCEPA99 TOPIC    PRGID
          RETURN
