.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.01  09.07.2002  Glenn Saunders
.           Recompile for changes in includes shared with Southland, but with
.           previously different formats - now merged.  Includes effected :-
.           CCSCEAFD, CCSCONFD, CCSEPSFD, CCSHCDFD, CCSHLCFD, CCSIADFD
.-------------------------------------------------------
. V9.02.00  03.06.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.B01 23.11.2000 Sandra Barcham
.           Allow for changed ccsepsaf
.-------------------------------------------------------
. V6.06.01  15.12.1999 Charles Handaya
.           Fixed DRG Codes
.-------------------------------------------------------
. V6.03.02  30.10.1995 B.G.Ackland
.           Phase 1 WGH Changes
. V6.03.01  03.10.1995 B.G.Ackland
.           Added Service Cat. , Actual
.           Cost Ind and DRG Ind
.           Recompiled for Change to CEASTR & CEAPSC
. V6.03.00  02.10.1995 B.G.Ackland
.           Release 6.03
.-------------------------------------------------------
ACCOTHER  INIT      "Acc. Other"
MISOTHER  INIT      "Misc Other"
THEATRE   INIT      "Theatre   "
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACEA49
.   Function      :   Patient Episode Income/Cost Enquiries   
.   Generated  On :   09/07/2002
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CCSCONFD/INC
          INC       CCSEPSFD/INC
          INC       CCSIADFD/INC
          INC       CEAPSCFD/INC
          INC       CEASPCFD/INC
          INC       CEASTRFD/INC
          INC       CEAVSCFD/INC
.=========================
.Local Variable Definition
.-------------------------
.
.    Multi Item Key Fields Scr 00 Fld    21
.-------------------------------------------------------
CEST3NAM  INIT      "CEST3"
CEST3END  FORM      1   * End Display
CEST3SNO  FORM      5   * Number of Items on the Screen
CEST3MKY  DIM       127 * Match Key 
CEST3EKY  DIM       127 * End Key
CEST3SKY  DIM       127 * Start Key
CEST3IDX  INIT      " 132 UC1-5"
CEST3FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CEST3FNM  DIM       8  * Filename
CEST3CNT  FORM      3  * Number of Items on Screen
SERVCOST  FORM     12.2 * Scr 00 Fld    29
COSTETH   FORM      8.2 * Scr 02 Fld    73
COSTEA1   FORM      8.2 * Scr 02 Fld    74
COSTEA2   FORM      8.2 * Scr 02 Fld    75
COSTEA3   FORM      8.2 * Scr 02 Fld    76
COSTEAO   FORM      8.2 * Scr 02 Fld    77
COSTEM1   FORM      8.2 * Scr 02 Fld    78
COSTEM2   FORM      8.2 * Scr 02 Fld    79
COSTEM3   FORM      8.2 * Scr 02 Fld    80
COSTEMO   FORM      8.2 * Scr 02 Fld    81
TOTINC    FORM     12.2 * Scr 02 Fld    82
TOTCST    FORM     12.2 * Scr 02 Fld    83
TOTCST1   FORM     12.2 * Scr 02 Fld    84
TOTCST2   FORM     12.2 * Scr 02 Fld    85
TOTCST3   FORM     12.2 * Scr 02 Fld    86
TOTCST4   FORM     12.2 * Scr 02 Fld    87
TOTCST5   FORM     12.2 * Scr 02 Fld    88
VARTH     FORM      8.2 * Scr 03 Fld    91
VARA1     FORM      8.2 * Scr 03 Fld    92
VARA2     FORM      8.2 * Scr 03 Fld    93
VARA3     FORM      8.2 * Scr 03 Fld    94
VARAO     FORM      8.2 * Scr 03 Fld    95
VARM1     FORM      8.2 * Scr 03 Fld    96
VARM2     FORM      8.2 * Scr 03 Fld    97
VARM3     FORM      8.2 * Scr 03 Fld    98
VARMO     FORM      8.2 * Scr 03 Fld    99
VARTOT    FORM     12.2 * Scr 03 Fld   100
PVARTH    FORM      8.2 * Scr 03 Fld   102
PVARA1    FORM      8.2 * Scr 03 Fld   103
PVARA2    FORM      8.2 * Scr 03 Fld   104
PVARA3    FORM      8.2 * Scr 03 Fld   105
PVARAO    FORM      8.2 * Scr 03 Fld   106
PVARM1    FORM      8.2 * Scr 03 Fld   107
PVARM2    FORM      8.2 * Scr 03 Fld   108
PVARM3    FORM      8.2 * Scr 03 Fld   109
PVARMO    FORM      8.2 * Scr 03 Fld   110
PVARTOT   FORM     12.2 * Scr 03 Fld   111
TYPDESC   DIM      10 * Scr SD Fld    45
TOTCOST1  FORM     12.2 * Scr SD Fld    51
TOTCOST2  FORM     12.2 * Scr SD Fld    52
TOTCOST3  FORM     12.2 * Scr SD Fld    53
TOTCOST4  FORM     12.2 * Scr SD Fld    54
TOTCOST5  FORM     12.2 * Scr SD Fld    55
TOTCOST   FORM     12.2 * Scr SD Fld    56
TOTUNIT   FORM     12.2 * Scr SD Fld    57
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACEA49"
PRGNAM    INIT      "Patient Episode Income/Cost Enquiries   "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CLOSE     CEST3FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   64",AUDTSECT
          MOVE      " 37",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ccsaudep";
            OPEN      CCSAUDEP,"ccsaudep"
          ENDIF
          MOVE      "   64",AUDTSECT
          MOVE      " 38",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ccsaudia";
            OPEN      CCSAUDIA,"ccsaudia"
          ENDIF
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA1,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA2,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA3,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA4,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA5,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsiadaf";
          OPEN      CCSIADA1,"ccsiadaf"
          MOVE      "   64",AUDTSECT
          MOVE      " 39",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ceaaudps";
            OPEN      CEAAUDPS,"ceaaudps"
          ENDIF
          MOVE      "   64",AUDTSECT
          MOVE      " 40",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ceaaudst";
            OPEN      CEAAUDST,"ceaaudst"
          ENDIF
          DISPLAY   *P56:24,"Opening ceapscaf";
          OPEN      CEAPSCA1,"ceapscaf"
          DISPLAY   *P56:24,"Opening ceaspcaf";
          OPEN      CEASPCA1,"ceaspcaf"
          DISPLAY   *P56:24,"Opening ceastraf";
          OPEN      CEASTRA1,"ceastraf"
          DISPLAY   *P56:24,"Opening ceastraf";
          OPEN      CEASTRA2,"ceastraf"
          DISPLAY   *P56:24,"Opening ceastraf";
          OPEN      CEASTRA3,"ceastraf"
          DISPLAY   *P56:24,"Opening ceastraf";
          OPEN      CEASTRA4,"ceastraf"
          DISPLAY   *P56:24,"Opening ceastraf";
          OPEN      CEASTRA5,"ceastraf"
          DISPLAY   *P56:24,"Opening ceavscaf";
          OPEN      CEAVSCA1,"ceavscaf"
          DISPLAY   *P56:24,"Opening ceavscaf";
          OPEN      CEAVSCA2,"ceavscaf"
.--------------------------------------------------------
. Initialise Batch Screen Batch                              
.--------------------------------------------------------
          MOVE     ZERO,CEST3SNO
          MOVE     "00   21",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CEST3SNO
            ENDIF
          ENDIF
          PACK      CEST3FNM,ANST,CEST3NAM,PORT
          REP       " 0",CEST3FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CEST3FL1,CEST3FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CEST3FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CEST3FNM,CEST3IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",CEST3FNM;
          EXECUTE   KEY80,TASKID
          OPEN      CEST3FL1,CEST3FNM
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Basic Patient Details              
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Display Summary Options            
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Income/Cost Summary                
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Income/Cost Comparision            
          ENDIF
          MATCH     "SD",SCRID
          IF         @EQUAL
            CALL       PSSDL000   * Patient Service Details Screen     
          ENDIF
          RETURN
.--------------------------------
. Screen - Basic Patient Details              
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Basic Patient Details              
.-------------------------------------------------------
CF00L000
          MOVE      SP70,CCEPEPS 
          MOVE      SP70,CESTBAT 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Basic Patient Details              
.--------------------------------------------------------
KY00L000
.
KY00L110
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEPMDCC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCEPDRGC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL      GETHCD00
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCCEPA00
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      CCEPEPS,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEPMDCC,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCEPDRGC,VAR     
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Basic Patient Details              
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Basic Patient Details              
.---------------------------------------------------------
LM00L000
.---------------------------------------------------------
. Load for :    21 Batch                              
.---------------------------------------------------------
          PACK      KEY27,CCEPHCD,CCEPEPS,SP70
          MOVE      KEY27,CEST3EKY
          MOVE      CEST3EKY,CEST3SKY
          STRIP     CEST3SKY
          SETLPTR   CEST3EKY,18
          CALL      RDCEST3 
          IF        OVRCD=0
            CALL      RPCEST3 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP00L000
          MOVE     ZERO,CEST3CNT
          MOVE     ZERO,CEST3END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP00L600
          MATCH    PRGID,SCPSPID
          GOTO     DP00L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP00L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP00L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                           DP00L101,DP00L102,DP00L103,DP00L104:
                            DP00L105,DP00L106,DP00L107,DP00L108:
                            DP00L109,DP00L110,DP00L010,DP00L111:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                           DP00L010,DP00L010,DP00L010,DP00L010:
                           DP00L010,DP00L010,DP00L010,DP00L010:
                           DP00L010,DP00L010
          GOTO      DP00L010
.
DP00L101
          PACK      CEST3MKY,SP70,SP70
          CALL      UPTCEST3
          IF        CEST3END=0
            CALL      RPCEST3 
            IF        OVRCD=0
              PACK      CEST3MKY,CESTHCD,CESTEPS,CESTBAT,CESTLIN                                                
              MATCH     CEST3EKY,CEST3MKY
              IF        @EQUAL
                MOVE      ZERO,CEST3END
                ADD       ONE,CEST3CNT
                CALL      UPTCEST3
                MOVE      CESTBAT,VAR      
                CALL      DISPITEM
          CALL      GETDET00
              ELSE
                MOVE      ONE,CEST3END
              ENDIF
            ELSE
              MOVE      ONE,CEST3END
            ENDIF
          ENDIF
          IF        CEST3END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L102
          IF        CEST3END=0
            MOVE      CESTLIN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L103
          IF        CEST3END=0
            MOVE      CESTKEY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L104
          IF        CEST3END=0
            UNPACK    CESTDAT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L105
          IF        CEST3END=0
            MOVE      CESTTIM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L106
          IF        CEST3END=0
            MOVE      CESTPSC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L107
          IF        CEST3END=0
            MOVE      CESTSPC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L108
          IF        CEST3END=0
            MOVE      CESTQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L109
          IF        CEST3END=0
            MOVE      SERVCOST,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L110
          IF        CEST3END=0
            MOVE      CESPDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L111
          IF        CEST3END=0
            MOVE      CEPSDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
DP00L600
          MATCH    "CEST3",NAMSSFFI
          GOTO     DP00L605 IF NOT EQUAL
          GOTO     DP00L999
DP00L605
DP00L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP00L000
.
          MATCH    "CEST3",NAMSSFFI
          GOTO     FP00L105 IF NOT EQUAL
          PACK     KEY27,CEST3SKY,Z70
          CALL     RDCEST3  * Start
          IF       OVRCD=0
            CALL     RPCEST3  * Start
          ENDIF
          CALL     DP00L000
          GOTO     FP00L999
FP00L105
FP00L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP00L000
.
          MATCH    "CEST3",NAMSSFFI
          GOTO     LP00L105 IF NOT EQUAL
          PACK     KEY27,CEST3SKY,SP70
          CALL     RSCEST3  * End
          IF       OVRCD=1
            CALL     RKCEST3 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CEST3SNO
            CALL     RKCEST3 
            IF       OVRCD=1
              MOVE     CEST3SNO,SECTOR
            ENDIF
            PACK     CEST3MKY,CESTHCD,CESTEPS,CESTBAT,CESTLIN                                                
            MATCH    CEST3EKY,CEST3MKY
            IF       !@EQUAL
              MOVE     CEST3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP00L000
          GOTO     LP00L999
LP00L105
LP00L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP00L000
.
          MATCH    "CEST3",NAMSSFFI
          GOTO     PP00L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP00L105
          CALL      RFTCEST3
          BRANCH   OVRCD,PP00L115
          MOVE      CEST3MKY,KEY27 
          CALL      RSCEST3 
PP00L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CEST3SNO
            CALL     RKCEST3 
            IF       OVRCD=1
              MOVE     CEST3SNO,SECTOR
            ENDIF
            PACK     CEST3MKY,CESTHCD,CESTEPS,CESTBAT,CESTLIN                                                
            MATCH    CEST3EKY,CEST3MKY
            IF       !@EQUAL
              MOVE     CEST3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP00L000
          GOTO     PP00L999
PP00L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CEST3SNO
            CALL     RPCEST3 
            IF       OVRCD=1
              MOVE     CEST3SNO,SECTOR
            ENDIF
            PACK     CEST3MKY,CESTHCD,CESTEPS,CESTBAT,CESTLIN                                                
            MATCH    CEST3EKY,CEST3MKY
            IF       !@EQUAL
              MOVE     CEST3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP00L999
PP00L120
PP00L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP00L000
          MATCH    "CEST3",NAMSSFFI
          GOTO     NP00L115 IF NOT EQUAL
NP00L105
          CALL     RPCEST3 
          BRANCH   OVRCD,NP00L110
          PACK     CEST3MKY,CESTHCD,CESTEPS,CESTBAT,CESTLIN                                                
          MATCH    CEST3EKY,CEST3MKY
          GOTO     NP00L110 IF NOT EQUAL
          CALL     RKCEST3 
          CALL     DP00L000
          GOTO     NP00L999
NP00L110
          CALL     RKCEST3 
          BEEP
          GOTO     NP00L999
NP00L115
NP00L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT00L000
CT00L105
CT00L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Basic Patient Details              
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    21 Batch                              
.---------------------------------------------------------
UPTCEST3
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CEST3FL1,KEY5;ANS
          IF        @OVER
            WRITE     CEST3FL1,KEY5;SCPSROW,SCPSCOL,CEST3MKY
          ELSE
            UPDATE    CEST3FL1;SCPSROW,SCPSCOL,CEST3MKY
          ENDIF
          RETURN
RDTCEST3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CEST3FL1,KEY5;SCPSROW,SCPSCOL,CEST3MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTCEST3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      CEST3FL1,KEY5;;
          READKS    CEST3FL1;SCPSROW,SCPSCOL,CEST3MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,CEST3MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Basic Patient Details              
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
          MOVE      "CEST3",NAMSSFFI
          MOVE      "   21",ITMSSFFI
          CALL      FP00L000
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Basic Patient Details              
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L101,PS00L102,PS00L103:
                            PS00L104,PS00L105,PS00L106,PS00L107:
                            PS00L108,PS00L109,PS00L110,PS00L111:
                            PS00L112,PS00L113,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999
          GOTO     PS00L999
.
PS00L101
          MOVE      CCEPSUR,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      CCEPGIV,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPCOM,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      CCEPURN,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          UNPACK    CCEPSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          UNPACK    CCEPLTD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      CCEPSEX,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          UNPACK    CCEPDOB,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      CCEPAGEY,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          UNPACK    CCEPDDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          UNPACK    CCEPADAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      CCEPMDCC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      CCEPDRGC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Basic Patient Details              
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L101:
                            SF00L102,SF00L103,SF00L006,SF00L006:
                           SF00L104,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L105,SF00L106,SF00L006,SF00L006:
                           SF00L107,SF00L108
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L104,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          MOVE      "CEST3",NAMSSFFI
          MOVE      "   21",ITMSSFFI
          CALL      FP00L000
          GOTO     SF00L001
.
SF00L101
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L102
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC01L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF00L000
          GOTO      SF00L001
.
SF00L104
          CALL      SELECTED
          BRANCH    EXIT,SF00L001
          COMPARE   ONE,ACCEPT
          GOTO      SF00L001 IF EQUAL
          CALL      RDTCEST3
          IF        OVRCD=1
            BEEP
            GOTO      SF00L001
          ENDIF
          MATCH     SP70,CEST3MKY
          IF        @EQUAL
            BEEP
            GOTO      SF00L001
          ENDIF
          MOVE      CEST3MKY,KEY27 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELDET00
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCEST3
          IF        OVRCD=1
            CALL      FP00L000
          ELSE
            MOVE      CEST3MKY,KEY27 
            CALL      RSCEST3 
            CALL      RKCEST3 
            CALL      DP00L000
          ENDIF
          GOTO     SF00L001
.
SF00L105
          MOVE      "CEST3",NAMSSFFI
          MOVE      "   21",ITMSSFFI
          CALL      NP00L000
          GOTO     SF00L001
.
SF00L106
          MOVE      "CEST3",NAMSSFFI
          MOVE      "   21",ITMSSFFI
          CALL      PP00L000
          GOTO     SF00L001
.
SF00L107
          MOVE      "CEST3",NAMSSFFI
          MOVE      "   21",ITMSSFFI
          CALL      FP00L000
          GOTO     SF00L001
.
SF00L108
          MOVE      "CEST3",NAMSSFFI
          MOVE      "   21",ITMSSFFI
          CALL      LP00L000
          GOTO     SF00L001
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Display Summary Options            
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Display Summary Options            
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Display Summary Options            
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Display Summary Options            
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Display Summary Options            
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Display Summary Options            
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Display Summary Options            
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L999
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Display Summary Options            
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L103
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF01L999
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Income/Cost Summary                
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   89",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC02L200
          CALL      CF02L000 * Clear Fields
          CALL      GETIAD00
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Income/Cost Summary                
.-------------------------------------------------------
CF02L000
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Income/Cost Summary                
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Income/Cost Summary                
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Income/Cost Summary                
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Income/Cost Summary                
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Income/Cost Summary                
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L101,PS02L102,PS02L103,PS02L104:
                            PS02L105,PS02L106,PS02L107,PS02L108:
                            PS02L109,PS02L110,PS02L111,PS02L112:
                            PS02L113,PS02L114,PS02L115,PS02L116:
                            PS02L117,PS02L118,PS02L119,PS02L120:
                            PS02L121,PS02L122,PS02L123,PS02L124:
                            PS02L125,PS02L126,PS02L127,PS02L128:
                            PS02L129,PS02L130,PS02L131,PS02L132:
                            PS02L133,PS02L134,PS02L135,PS02L136:
                            PS02L137,PS02L138,PS02L139,PS02L140:
                            PS02L141,PS02L142,PS02L143,PS02L144:
                            PS02L145,PS02L146,PS02L147,PS02L148:
                            PS02L149,PS02L150,PS02L151,PS02L152:
                            PS02L153,PS02L154,PS02L155,PS02L156:
                            PS02L157,PS02L158,PS02L159,PS02L160:
                            PS02L161,PS02L162,PS02L163,PS02L164:
                            PS02L165,PS02L166,PS02L167,PS02L168:
                            PS02L169,PS02L170,PS02L171,PS02L172:
                            PS02L173,PS02L174,PS02L175,PS02L176:
                            PS02L177,PS02L178,PS02L179,PS02L180:
                            PS02L181,PS02L182,PS02L183,PS02L184:
                            PS02L185,PS02L186,PS02L187,PS02L188:
                            PS02L999,PS02L999
          GOTO     PS02L999
.
PS02L101
          MOVE      CCCOCD1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      CCCOCD2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      CCCOCD3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      CCCOCD4,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      CCCOCD5,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      CCCOIA1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      CCCOIA2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      CCCOIA3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          MOVE      CCCOIM1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          MOVE      CCCOIM2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          MOVE      CCCOIM3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L112
          MOVE      CCCOIA1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L113
          MOVE      CCCOIA2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L114
          MOVE      CCCOIA3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L115
          MOVE      CCIABA1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L116
          MOVE      CCIABA2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L117
          MOVE      CCIABA3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L118
          MOVE      CCIALOS,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L119
          MOVE      CCIAITH,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L120
          MOVE      CCIAIA1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L121
          MOVE      CCIAIA2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L122
          MOVE      CCIAIA3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L123
          MOVE      CCIAIAO,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L124
          MOVE      CCIAIM1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L125
          MOVE      CCIAIM2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L126
          MOVE      CCIAIM3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L127
          MOVE      CCIAIMO,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L128
          MOVE      CCIAETH1,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L129
          MOVE      CCIAETH2,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L130
          MOVE      CCIAETH3,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L131
          MOVE      CCIAETH4,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L132
          MOVE      CCIAETH5,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L133
          MOVE      CCIAEA11,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L134
          MOVE      CCIAEA12,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L135
          MOVE      CCIAEA13,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L136
          MOVE      CCIAEA14,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L137
          MOVE      CCIAEA15,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L138
          MOVE      CCIAEA21,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L139
          MOVE      CCIAEA22,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L140
          MOVE      CCIAEA23,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L141
          MOVE      CCIAEA24,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L142
          MOVE      CCIAEA25,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L143
          MOVE      CCIAEA31,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L144
          MOVE      CCIAEA32,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L145
          MOVE      CCIAEA33,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L146
          MOVE      CCIAEA34,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L147
          MOVE      CCIAEA35,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L148
          MOVE      CCIAEAO1,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L149
          MOVE      CCIAEAO2,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L150
          MOVE      CCIAEAO3,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L151
          MOVE      CCIAEAO4,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L152
          MOVE      CCIAEAO5,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L153
          MOVE      CCIAEM11,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L154
          MOVE      CCIAEM12,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L155
          MOVE      CCIAEM13,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L156
          MOVE      CCIAEM14,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L157
          MOVE      CCIAEM15,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L158
          MOVE      CCIAEM21,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L159
          MOVE      CCIAEM22,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L160
          MOVE      CCIAEM23,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L161
          MOVE      CCIAEM24,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L162
          MOVE      CCIAEM25,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L163
          MOVE      CCIAEM31,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L164
          MOVE      CCIAEM32,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L165
          MOVE      CCIAEM33,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L166
          MOVE      CCIAEM34,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L167
          MOVE      CCIAEM35,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L168
          MOVE      CCIAEMO1,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L169
          MOVE      CCIAEMO2,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L170
          MOVE      CCIAEMO3,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L171
          MOVE      CCIAEMO4,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L172
          MOVE      CCIAEMO5,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L173
          MOVE      COSTETH,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L174
          MOVE      COSTEA1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L175
          MOVE      COSTEA2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L176
          MOVE      COSTEA3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L177
          MOVE      COSTEAO,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L178
          MOVE      COSTEM1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L179
          MOVE      COSTEM2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L180
          MOVE      COSTEM3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L181
          MOVE      COSTEMO,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L182
          MOVE      TOTINC,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L183
          MOVE      TOTCST,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L184
          MOVE      TOTCST1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L185
          MOVE      TOTCST2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L186
          MOVE      TOTCST3,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L187
          MOVE      TOTCST4,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L188
          MOVE      TOTCST5,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Income/Cost Summary                
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L101
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Income/Cost Comparision            
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   89",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC03L200
          CALL      CF03L000 * Clear Fields
          CALL      GETIAD00
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Income/Cost Comparision            
.-------------------------------------------------------
CF03L000
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Income/Cost Comparision            
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Income/Cost Comparision            
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Income/Cost Comparision            
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Income/Cost Comparision            
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Income/Cost Comparision            
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L101,PS03L102,PS03L103,PS03L104:
                            PS03L105,PS03L106,PS03L107,PS03L108:
                            PS03L109,PS03L110,PS03L111,PS03L112:
                            PS03L113,PS03L114,PS03L115,PS03L116:
                            PS03L117,PS03L118,PS03L119,PS03L120:
                            PS03L121,PS03L122,PS03L123,PS03L124:
                            PS03L125,PS03L126,PS03L127,PS03L128:
                            PS03L129,PS03L130,PS03L131,PS03L132:
                            PS03L133,PS03L134,PS03L135,PS03L136:
                            PS03L137,PS03L138,PS03L139,PS03L140:
                            PS03L141,PS03L142,PS03L143,PS03L144:
                            PS03L145,PS03L146,PS03L147,PS03L148:
                            PS03L149,PS03L150,PS03L151,PS03L152:
                            PS03L153,PS03L154,PS03L155,PS03L156:
                            PS03L157,PS03L158,PS03L159,PS03L160:
                            PS03L161,PS03L162,PS03L163,PS03L164:
                            PS03L165,PS03L166,PS03L167,PS03L168:
                            PS03L169,PS03L170,PS03L171,PS03L172:
                            PS03L173,PS03L174,PS03L175,PS03L176:
                            PS03L177,PS03L178,PS03L179,PS03L180:
                            PS03L181,PS03L182,PS03L183,PS03L184:
                            PS03L185,PS03L186,PS03L187,PS03L188:
                            PS03L999,PS03L999,PS03L189,PS03L190:
                            PS03L191,PS03L192,PS03L193,PS03L194:
                            PS03L195,PS03L196,PS03L197,PS03L198:
                            PS03L999,PS03L199,PS03L200,PS03L201:
                            PS03L202,PS03L203,PS03L204,PS03L205:
                            PS03L206,PS03L207,PS03L208
          GOTO     PS03L999
.
PS03L101
          MOVE      CCCOCD1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      CCCOCD2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      CCCOCD3,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      CCCOCD4,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L105
          MOVE      CCCOCD5,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L106
          MOVE      CCCOIA1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L107
          MOVE      CCCOIA2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L108
          MOVE      CCCOIA3,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L109
          MOVE      CCCOIM1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L110
          MOVE      CCCOIM2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L111
          MOVE      CCCOIM3,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L112
          MOVE      CCCOIA1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L113
          MOVE      CCCOIA2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L114
          MOVE      CCCOIA3,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L115
          MOVE      CCIABA1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L116
          MOVE      CCIABA2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L117
          MOVE      CCIABA3,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L118
          MOVE      CCIALOS,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L119
          MOVE      CCIAITH,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L120
          MOVE      CCIAIA1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L121
          MOVE      CCIAIA2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L122
          MOVE      CCIAIA3,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L123
          MOVE      CCIAIAO,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L124
          MOVE      CCIAIM1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L125
          MOVE      CCIAIM2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L126
          MOVE      CCIAIM3,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L127
          MOVE      CCIAIMO,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L128
          MOVE      CCIAETH1,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L129
          MOVE      CCIAETH2,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L130
          MOVE      CCIAETH3,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L131
          MOVE      CCIAETH4,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L132
          MOVE      CCIAETH5,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L133
          MOVE      CCIAEA11,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L134
          MOVE      CCIAEA12,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L135
          MOVE      CCIAEA13,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L136
          MOVE      CCIAEA14,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L137
          MOVE      CCIAEA15,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L138
          MOVE      CCIAEA21,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L139
          MOVE      CCIAEA22,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L140
          MOVE      CCIAEA23,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L141
          MOVE      CCIAEA24,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L142
          MOVE      CCIAEA25,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L143
          MOVE      CCIAEA31,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L144
          MOVE      CCIAEA32,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L145
          MOVE      CCIAEA33,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L146
          MOVE      CCIAEA34,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L147
          MOVE      CCIAEA35,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L148
          MOVE      CCIAEAO1,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L149
          MOVE      CCIAEAO2,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L150
          MOVE      CCIAEAO3,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L151
          MOVE      CCIAEAO4,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L152
          MOVE      CCIAEAO5,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L153
          MOVE      CCIAEM11,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L154
          MOVE      CCIAEM12,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L155
          MOVE      CCIAEM13,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L156
          MOVE      CCIAEM14,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L157
          MOVE      CCIAEM15,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L158
          MOVE      CCIAEM21,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L159
          MOVE      CCIAEM22,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L160
          MOVE      CCIAEM23,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L161
          MOVE      CCIAEM24,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L162
          MOVE      CCIAEM25,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L163
          MOVE      CCIAEM31,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L164
          MOVE      CCIAEM32,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L165
          MOVE      CCIAEM33,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L166
          MOVE      CCIAEM34,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L167
          MOVE      CCIAEM35,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L168
          MOVE      CCIAEMO1,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L169
          MOVE      CCIAEMO2,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L170
          MOVE      CCIAEMO3,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L171
          MOVE      CCIAEMO4,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L172
          MOVE      CCIAEMO5,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L173
          MOVE      COSTETH,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L174
          MOVE      COSTEA1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L175
          MOVE      COSTEA2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L176
          MOVE      COSTEA3,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L177
          MOVE      COSTEAO,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L178
          MOVE      COSTEM1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L179
          MOVE      COSTEM2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L180
          MOVE      COSTEM3,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L181
          MOVE      COSTEMO,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L182
          MOVE      TOTINC,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L183
          MOVE      TOTCST,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L184
          MOVE      TOTCST1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L185
          MOVE      TOTCST2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L186
          MOVE      TOTCST3,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L187
          MOVE      TOTCST4,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L188
          MOVE      TOTCST5,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L189
          MOVE      VARTH,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L190
          MOVE      VARA1,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L191
          MOVE      VARA2,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L192
          MOVE      VARA3,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L193
          MOVE      VARAO,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L194
          MOVE      VARM1,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L195
          MOVE      VARM2,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L196
          MOVE      VARM3,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L197
          MOVE      VARMO,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L198
          MOVE      VARTOT,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L199
          MOVE      PVARTH,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L200
          MOVE      PVARA1,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L201
          MOVE      PVARA2,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L202
          MOVE      PVARA3,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L203
          MOVE      PVARAO,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L204
          MOVE      PVARM1,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L205
          MOVE      PVARM2,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L206
          MOVE      PVARM3,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L207
          MOVE      PVARMO,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L208
          MOVE      PVARTOT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Income/Cost Comparision            
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L101,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Patient Service Details Screen     
.--------------------------------
SCSDL000
SCSDL100
          MOVE      "SD",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCSDL200
          CALL      CFSDL000 * Clear Fields
SCSDL300
          CALL      KYSDL000 * Enter Key Fields
          BRANCH    EXIT,SCSDL999,SCSDL999
SCSDL400
          CALL      WPSDL000 * Load any WP Details
SCSDL500
          CALL      LMSDL000 * Load any Batch Details
SCSDL600
          CALL      DFSDL000 * Display Fields
SCSDL700
          CALL      SFSDL000 * Select Fields
          BRANCH    EXIT,SCSDL100,SCSDL100,SCSDL200
SCSDL800
SCSDL900
SCSDL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Patient Service Details Screen     
.-------------------------------------------------------
CFSDL000
CFSDL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Patient Service Details Screen     
.--------------------------------------------------------
KYSDL000
          MOVE      ZERO,EXIT
          GOTO      KYSDL999
.
KYSDL900  MOVE      ONE,EXIT
KYSDL999  RETURN
.---------------------------------------------------------
. Load WP files for : Patient Service Details Screen     
.---------------------------------------------------------
WPSDL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Patient Service Details Screen     
.---------------------------------------------------------
LMSDL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Patient Service Details Screen     
.---------------------------------------------------------
DFSDL000
          BRANCH   ACCEPT,DFSDL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFSDL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFSDL900
          MATCH    PRGID,SCPSPID
          GOTO     DFSDL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFSDL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFSDL010 IF NOT EQUAL
.
          CALL     PSSDL000 * Display Field
          GOTO     DFSDL010
DFSDL900
DFSDL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Patient Service Details Screen     
.---------------------------------------------------------
PSSDL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSSDL999,PSSDL999,PSSDL101,PSSDL102:
                            PSSDL103,PSSDL104,PSSDL105,PSSDL106:
                            PSSDL107,PSSDL108,PSSDL109,PSSDL110:
                            PSSDL111,PSSDL112,PSSDL113,PSSDL114:
                            PSSDL115,PSSDL116,PSSDL117,PSSDL118:
                            PSSDL119,PSSDL120,PSSDL121,PSSDL122:
                            PSSDL123,PSSDL124,PSSDL125,PSSDL126:
                            PSSDL127,PSSDL128,PSSDL129,PSSDL130:
                            PSSDL131,PSSDL132,PSSDL133,PSSDL134:
                            PSSDL135,PSSDL136,PSSDL137,PSSDL138:
                            PSSDL139,PSSDL140,PSSDL141,PSSDL142:
                            PSSDL143,PSSDL144,PSSDL145,PSSDL146:
                            PSSDL147,PSSDL148,PSSDL149,PSSDL150:
                            PSSDL151,PSSDL152,PSSDL153,PSSDL154:
                            PSSDL155,PSSDL156,PSSDL157,PSSDL158:
                            PSSDL159,PSSDL160,PSSDL161
          GOTO     PSSDL999
.
PSSDL101
          MOVE      CESTBAT,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL102
          MOVE      CESTLIN,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL103
          MOVE      CESTHCD,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL104
          MOVE      CESTEPS,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL105
          UNPACK    CESTDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL106
          MOVE      CESTTIM,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL107
          MOVE      CESTPSC,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL108
          MOVE      CESTSPC,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL109
          MOVE      CESTQTY,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL110
          MOVE      CESTST1,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL111
          MOVE      CESTST2,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL112
          MOVE      CESTST3,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL113
          MOVE      CESTST4,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL114
          MOVE      CESTST5,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL115
          MOVE      CESTFIL,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL116
          MOVE      CESTKEY,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL117
          UNPACK    CESTUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL118
          UNPACK    CESTUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CESTUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL120
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CESTUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL121
          MOVE      CESPDES,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL122
          MOVE      CESPUR1,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL123
          MOVE      CESPUR2,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL124
          UNPACK    CESPUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL125
          UNPACK    CESPUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL126
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CESPUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL127
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CESPUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL128
          MOVE      CEPSDES,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL129
          MOVE      CEPSTYP,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL130
          MOVE      CEPSQTY,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL131
          MOVE      CEPSQDES,VAR     
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL132
          MOVE      CEPSST1,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL133
          MOVE      CEPSST2,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL134
          MOVE      CEPSST3,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL135
          MOVE      CEPSST4,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL136
          MOVE      CEPSST5,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL137
          MOVE      CEPSUR1,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL138
          MOVE      CEPSUR2,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL139
          UNPACK    CEPSUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL140
          UNPACK    CEPSUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL141
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CEPSUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL142
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CEPSUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL143
          MOVE      TYPDESC,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL144
          MOVE      CCCOCD1,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL145
          MOVE      CCCOCD2,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL146
          MOVE      CCCOCD3,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL147
          MOVE      CCCOCD4,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL148
          MOVE      CCCOCD5,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL149
          MOVE      TOTCOST1,VAR     
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL150
          MOVE      TOTCOST2,VAR     
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL151
          MOVE      TOTCOST3,VAR     
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL152
          MOVE      TOTCOST4,VAR     
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL153
          MOVE      TOTCOST5,VAR     
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL154
          MOVE      TOTCOST,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL155
          MOVE      TOTUNIT,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL156
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CEPSACT,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL157
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CEPSDRG,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL158
          MOVE      CEPSVSC,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL159
          MOVE      CEVSDES,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL160
          MOVE      CESTITM,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
.
PSSDL161
          MOVE      CESTDCD,VAR      
          CALL      DISPITEM
          GOTO     PSSDL999
PSSDL999
          RETURN
.---------------------------------------------------------
. Selections for : Patient Service Details Screen     
.---------------------------------------------------------
SFSDL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFSDL001  BRANCH   ACCEPT,SFSDL020
.
SFSDL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFSDL006,SFSDL101,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006,SFSDL006:
                            SFSDL006,SFSDL006,SFSDL006
SFSDL006  BEEP
          GOTO     SFSDL005
SFSDL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFSDL090
          MATCH    PRGID,SCSLPID
          GOTO     SFSDL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFSDL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020,SFSDL020:
                            SFSDL020,SFSDL020,SFSDL020
          GOTO     SFSDL020
SFSDL090  MOVE     ZERO,ACCEPT
          GOTO     SFSDL001
.
SFSDL101
          MOVE      ZERO,EXIT
          GOTO      SFSDL999
SFSDL990  MOVE      ONE,EXIT * Exit Char Restart
SFSDL999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------
. Get Hospital
.------------------------------------------------------------
GETHCD00  MOVE      "1 ",CCEPHCD
          RETURN
.------------------------------------------------------------
. Get Details for Each Line
.------------------------------------------------------------
GETDET00  ASSIGN     CESTQTY*(CESTST1+CESTST2+CESTST3+CESTST4+CESTST5),SERVCOST
          MOVE       CESTSPC,KEY3
          CALL       RDCESP1
          IF         OVRCD=1
            MOVE       "Invalid ",CESPDES
          ENDIF
.
          MOVE       CESTPSC,KEY7
          CALL       RDCEPS1
          IF         OVRCD=1
            MOVE       "Invalid ",CEPSDES
          ENDIF
.
          RETURN
.------------------------------------------------------------
. Select Line
.------------------------------------------------------------
SELDET00  CALL       RDCEST3
.
          ASSIGN     CESTST1+CESTST2+CESTST3+CESTST4+CESTST5,TOTUNIT
          ASSIGN     CESTQTY*(CESTST1+CESTST2+CESTST3+CESTST4+CESTST5),TOTCOST
          ASSIGN     CESTQTY*CESTST1,TOTCOST1
          ASSIGN     CESTQTY*CESTST2,TOTCOST2
          ASSIGN     CESTQTY*CESTST3,TOTCOST3
          ASSIGN     CESTQTY*CESTST4,TOTCOST4
          ASSIGN     CESTQTY*CESTST5,TOTCOST5
.
          MOVE       CESTSPC,KEY3
          CALL       RDCESP1
          IF         OVRCD=1
            MOVE       "Invalid ",CESPDES
          ENDIF
.
          MOVE       CESTPSC,KEY7
          CALL       RDCEPS1
          IF         OVRCD=1
            MOVE       "Invalid ",CEPSDES
          ENDIF
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4,CCCOCD5:
                                        CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
          MOVE      CEPSTYP,F1
          LOAD      TYPDESC,F1,THEATRE,CCCOIA1,CCCOIA2,CCCOIA3,ACCOTHER:
                               CCCOIM1,CCCOIM2,CCCOIM3,MISOTHER
.
.
          CALL       SCSDL000       * Service Details Screen
.
          RETURN
GETIAD00  PACK     KEY18,CCEPHCD,CCEPEPS
          CALL     RDCCIA1
          IF       OVRCD=1
            CALL     CLRIAD00
          ENDIF
          MOVE      "64",SECTOR
          READ      CONTROLF,SECTOR;*59,CCCOCD1,CCCOCD2,CCCOCD3,CCCOCD4:
                                        CCCOCD5,CCCOIA1,CCCOIA2,CCCOIA3:
                                        CCCOIM1,CCCOIM2,CCCOIM3
.
          ASSIGN   CCIAITH+CCIAIA1+CCIAIA2+CCIAIA3+CCIAIAO,TOTINC
          ASSIGN   TOTINC+CCIAIM1+CCIAIM2+CCIAIM3+CCIAIMO,TOTINC
.
          ASSIGN   CCIAETH1+CCIAEA11+CCIAEA21+CCIAEA31+CCIAEAO1,TOTCST1
          ASSIGN    TOTCST1+CCIAEM11+CCIAEM21+CCIAEM31+CCIAEMO1,TOTCST1
.
          ASSIGN   CCIAETH2+CCIAEA12+CCIAEA22+CCIAEA32+CCIAEAO2,TOTCST2
          ASSIGN    TOTCST2+CCIAEM12+CCIAEM22+CCIAEM32+CCIAEMO2,TOTCST2
.
          ASSIGN   CCIAETH3+CCIAEA13+CCIAEA23+CCIAEA33+CCIAEAO3,TOTCST3
          ASSIGN    TOTCST3+CCIAEM13+CCIAEM23+CCIAEM33+CCIAEMO3,TOTCST3
.
          ASSIGN   CCIAETH4+CCIAEA14+CCIAEA24+CCIAEA34+CCIAEAO4,TOTCST4
          ASSIGN    TOTCST4+CCIAEM14+CCIAEM24+CCIAEM34+CCIAEMO4,TOTCST4
.
          ASSIGN   CCIAETH5+CCIAEA15+CCIAEA25+CCIAEA35+CCIAEAO5,TOTCST5
          ASSIGN    TOTCST5+CCIAEM15+CCIAEM25+CCIAEM35+CCIAEMO5,TOTCST5
.
          ASSIGN    TOTCST1+TOTCST2+TOTCST3+TOTCST4+TOTCST5,TOTCST
.
          ASSIGN   CCIAETH1+CCIAETH2+CCIAETH3+CCIAETH4+CCIAETH5,COSTETH
          ASSIGN   CCIAEA11+CCIAEA12+CCIAEA13+CCIAEA14+CCIAEA15,COSTEA1
          ASSIGN   CCIAEA21+CCIAEA22+CCIAEA23+CCIAEA24+CCIAEA25,COSTEA2
          ASSIGN   CCIAEA31+CCIAEA32+CCIAEA33+CCIAEA34+CCIAEA35,COSTEA3
          ASSIGN   CCIAEAO1+CCIAEAO2+CCIAEAO3+CCIAEAO4+CCIAEAO5,COSTEAO
          ASSIGN   CCIAEM11+CCIAEM12+CCIAEM13+CCIAEM14+CCIAEM15,COSTEM1
          ASSIGN   CCIAEM21+CCIAEM22+CCIAEM23+CCIAEM24+CCIAEM25,COSTEM2
          ASSIGN   CCIAEM31+CCIAEM32+CCIAEM33+CCIAEM34+CCIAEM35,COSTEM3
          ASSIGN   CCIAEMO1+CCIAEMO2+CCIAEMO3+CCIAEMO4+CCIAEMO5,COSTEMO
.
          ASSIGN   CCIAITH-COSTETH,VARTH
          ASSIGN   CCIAIA1-COSTEA1,VARA1
          ASSIGN   CCIAIA2-COSTEA2,VARA2
          ASSIGN   CCIAIA3-COSTEA3,VARA3
          ASSIGN   CCIAIAO-COSTEAO,VARAO
          ASSIGN   CCIAIM1-COSTEM1,VARM1
          ASSIGN   CCIAIM2-COSTEM2,VARM2
          ASSIGN   CCIAIM3-COSTEM3,VARM3
          ASSIGN   CCIAIMO-COSTEMO,VARMO
          ASSIGN   TOTINC-TOTCST,VARTOT
.
          ASSIGN   ((CCIAITH-COSTETH)/COSTETH)*100.0,PVARTH
          ASSIGN   ((CCIAIA1-COSTEA1)/COSTEA1)*100.0,PVARA1
          ASSIGN   ((CCIAIA2-COSTEA2)/COSTEA2)*100.0,PVARA2
          ASSIGN   ((CCIAIA3-COSTEA3)/COSTEA3)*100.0,PVARA3
          ASSIGN   ((CCIAIAO-COSTEAO)/COSTEAO)*100.0,PVARAO
          ASSIGN   ((CCIAIM1-COSTEM1)/COSTEM1)*100.0,PVARM1
          ASSIGN   ((CCIAIM2-COSTEM2)/COSTEM2)*100.0,PVARM2
          ASSIGN   ((CCIAIM3-COSTEM3)/COSTEM3)*100.0,PVARM3
          ASSIGN   ((CCIAIMO-COSTEMO)/COSTEMO)*100.0,PVARMO
          ASSIGN   ((TOTINC-TOTCST)/TOTCST)*100.0,PVARTOT
.
          RETURN
.
CLRIAD00  MOVE      ZERO,CCIABA1
          MOVE      ZERO,CCIABA2
          MOVE      ZERO,CCIABA3
          MOVE      ZERO,CCIALOS
          MOVE      ZERO,CCIAITH
          MOVE      ZERO,CCIAIA1
          MOVE      ZERO,CCIAIA2
          MOVE      ZERO,CCIAIA3
          MOVE      ZERO,CCIAIAO
          MOVE      ZERO,CCIAIM1
          MOVE      ZERO,CCIAIM2
          MOVE      ZERO,CCIAIM3
          MOVE      ZERO,CCIAIMO
          MOVE      ZERO,CCIAETH1
          MOVE      ZERO,CCIAETH2
          MOVE      ZERO,CCIAETH3
          MOVE      ZERO,CCIAETH4
          MOVE      ZERO,CCIAETH5
          MOVE      ZERO,CCIAEA11
          MOVE      ZERO,CCIAEA12
          MOVE      ZERO,CCIAEA13
          MOVE      ZERO,CCIAEA14
          MOVE      ZERO,CCIAEA15
          MOVE      ZERO,CCIAEA21
          MOVE      ZERO,CCIAEA22
          MOVE      ZERO,CCIAEA23
          MOVE      ZERO,CCIAEA24
          MOVE      ZERO,CCIAEA25
          MOVE      ZERO,CCIAEA31
          MOVE      ZERO,CCIAEA32
          MOVE      ZERO,CCIAEA33
          MOVE      ZERO,CCIAEA34
          MOVE      ZERO,CCIAEA35
          MOVE      ZERO,CCIAEAO1
          MOVE      ZERO,CCIAEAO2
          MOVE      ZERO,CCIAEAO3
          MOVE      ZERO,CCIAEAO4
          MOVE      ZERO,CCIAEAO5
          MOVE      ZERO,CCIAEM11
          MOVE      ZERO,CCIAEM12
          MOVE      ZERO,CCIAEM13
          MOVE      ZERO,CCIAEM14
          MOVE      ZERO,CCIAEM15
          MOVE      ZERO,CCIAEM21
          MOVE      ZERO,CCIAEM22
          MOVE      ZERO,CCIAEM23
          MOVE      ZERO,CCIAEM24
          MOVE      ZERO,CCIAEM25
          MOVE      ZERO,CCIAEM31
          MOVE      ZERO,CCIAEM32
          MOVE      ZERO,CCIAEM33
          MOVE      ZERO,CCIAEM34
          MOVE      ZERO,CCIAEM35
          MOVE      ZERO,CCIAEMO1
          MOVE      ZERO,CCIAEMO2
          MOVE      ZERO,CCIAEMO3
          MOVE      ZERO,CCIAEMO4
          MOVE      ZERO,CCIAEMO5
          RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CCSCONIO/INC
          INC       CCSEPSIO/INC
          INC       CCSEPSKY    
          INC       CCSIADIO/INC
          INC       CEAPSCIO/INC
          INC       CEASPCIO/INC
          INC       CEASTRIO/INC
          INC       CEAVSCIO/INC
.
          INC       STDGENCD
.
