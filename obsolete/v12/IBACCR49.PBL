.---------------------------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.00.00"
.-------------------------------------------------------
. V9.02.00  04.07.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from r5.09
.           Use CCISITH instead of CCIATHE, CCIAIA1 for CCIAACC
.           and CCIAIM1 for CCIAOTH.
.---------------------------------------------------------------------------
. V5.09.01  08/08/2001  Davin
.           Recompiled for change to CCSEPSFD
.---------------------------------------------------------------------------
. V5.04.02  28.07.1996 B.G.Ackland
.           New Fields for Southern Health
. V5.04.01  11.02.1996 B.G.Ackland
.           Extend Episode file.
. V6.00.05  13.07.1993 B.G.Ackland
.           Extend Episode file.
.---------------------------------------------------------------------------
DPTSUMA1  IFILE     SQL, FIXED=100, KEY="U1-2,3-10"
.
DPSUHCD   DIM       2     2    1
DPSUDPT   DIM       8     8    3
DPSUNUM   FORM      12.2  8   11
DPSUFDR   FORM      12.2  8   19
DPSUFID   FORM      12.2  8   27
DPSUVDR   FORM      12.2  8   35
DPSUVID   FORM      12.2  8   43
.
AMOUNT    FORM      12.2
PRICE     FORM      12.2
REPTLEV   FORM      1
TOTAL     FORM      12.2
TOTALFDR  FORM      12.2
TOTALFID  FORM      12.2
TOTALVDR  FORM      12.2
TOTALVID  FORM      12.2
.---------------------------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBACCR49
.   Function      :   Episode Enquiries                       
.   Generated  On :   08/07/2002
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       CCSCALFD/INC
          INC       CCSCMAFD/INC
          INC       CCSDEQFD/INC
          INC       CCSDPTFD/INC
          INC       CCSEPSFD/INC
          INC       CCSHCDFD/INC
          INC       CCSIADFD/INC
          INC       CCSMSCFD/INC
          INC       CCSMTSFD/INC
          INC       CCSPAQFD/INC
          INC       CCSPDPFD/INC
          INC       CCSPERFD/INC
          INC       CCSRASFD/INC
          INC       CCSRBDFD/INC
          INC       CCSSPCFD/INC
          INC       CCSUPDFD/INC
          INC       GPHSTDDF    
.=========================
.Local Variable Definition
.-------------------------
TOTCOST   FORM     12.2 * Scr 01 Fld    13
TOTVARI   FORM     12.2 * Scr 01 Fld    15
.
.    Multi Item Key Fields Scr DA Fld     3
.-------------------------------------------------------
CCDE1NAM  INIT      "CCDE1"
CCDE1END  FORM      1   * End Display
CCDE1SNO  FORM      5   * Number of Items on the Screen
CCDE1MKY  DIM       127 * Match Key 
CCDE1EKY  DIM       127 * End Key
CCDE1SKY  DIM       127 * Start Key
CCDE1IDX  INIT      " 132 UC1-5"
CCDE1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCDE1FNM  DIM       8  * Filename
CCDE1CNT  FORM      3  * Number of Items on Screen
TOT1AMT   FORM     12.2 * Scr DA Fld    20
TOT2AMT   FORM     12.2 * Scr DA Fld    21
TOT3AMT   FORM     12.2 * Scr DA Fld    22
.
.    Multi Item Key Fields Scr DD Fld    10
.-------------------------------------------------------
CCPA1NAM  INIT      "CCPA1"
CCPA1END  FORM      1   * End Display
CCPA1SNO  FORM      5   * Number of Items on the Screen
CCPA1MKY  DIM       127 * Match Key 
CCPA1EKY  DIM       127 * End Key
CCPA1SKY  DIM       127 * Start Key
CCPA1IDX  INIT      " 132 UC1-5"
CCPA1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCPA1FNM  DIM       8  * Filename
CCPA1CNT  FORM      3  * Number of Items on Screen
GPHACT    FORM      1 * Scr DG Fld     5
GPHBUD    FORM      1 * Scr DG Fld     6
GPHSTD    FORM      1 * Scr DG Fld     7
BUDYEAR   DIM       4 * Scr PA Fld     4
BUDMODL   DIM       4 * Scr PA Fld     5
ACTYEAR   DIM       4 * Scr PA Fld     6
ACTMODL   DIM       4 * Scr PA Fld     7
COST1AMT  FORM     12.2 * Scr PA Fld    10
UNIT1AMT  FORM     12.2 * Scr PA Fld    11
COST2AMT  FORM     12.2 * Scr PA Fld    12
UNIT2AMT  FORM     12.2 * Scr PA Fld    13
COST3AMT  FORM     12.2 * Scr PA Fld    14
UNIT3AMT  FORM     12.2 * Scr PA Fld    15
F12P2     FORM     12.2 * Scr PA Fld    16
CCPERCNT  FORM      3 * Scr PA Fld    17
.
.    Multi Item Key Fields Scr PC Fld     5
.-------------------------------------------------------
CCUP2NAM  INIT      "CCUP2"
CCUP2END  FORM      1   * End Display
CCUP2SNO  FORM      5   * Number of Items on the Screen
CCUP2MKY  DIM       127 * Match Key 
CCUP2EKY  DIM       127 * End Key
CCUP2SKY  DIM       127 * Start Key
CCUP2IDX  INIT      " 132 UC1-5"
CCUP2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
CCUP2FNM  DIM       8  * Filename
CCUP2CNT  FORM      3  * Number of Items on Screen
F4x       FORM      4 * Scr PC Fld    36
F8x       FORM      8 * Scr PC Fld    37
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBACCR49"
PRGNAM    INIT      "Episode Enquiries                       "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SCPAL000
          CLOSE     CCDE1FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   64",AUDTSECT
          MOVE      " 37",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ccsaudep";
            OPEN      CCSAUDEP,"ccsaudep"
          ENDIF
          MOVE      "   64",AUDTSECT
          MOVE      " 38",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening ccsaudia";
            OPEN      CCSAUDIA,"ccsaudia"
          ENDIF
          DISPLAY   *P56:24,"Opening ccscalaf";
          OPEN      CCSCALA1,"ccscalaf"
          DISPLAY   *P56:24,"Opening ccscalaf";
          OPEN      CCSCALA2,"ccscalaf"
          DISPLAY   *P56:24,"Opening ccscalaf";
          OPEN      CCSCALA3,"ccscalaf"
          DISPLAY   *P56:24,"Opening ccscmaaf";
          OPEN      CCSCMAA1,"ccscmaaf"
          DISPLAY   *P56:24,"Opening ccsdeqaf";
          OPEN      CCSDEQA1,"ccsdeqaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA1,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA2,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA3,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccsdptaf";
          OPEN      CCSDPTA4,"ccsdptaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA1,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA2,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA3,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA4,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccsepsaf";
          OPEN      CCSEPSA5,"ccsepsaf"
          DISPLAY   *P56:24,"Opening ccshcdaf";
          OPEN      CCSHCDA1,"ccshcdaf"
          DISPLAY   *P56:24,"Opening ccshcdaf";
          OPEN      CCSHCDA2,"ccshcdaf"
          DISPLAY   *P56:24,"Opening ccsiadaf";
          OPEN      CCSIADA1,"ccsiadaf"
          DISPLAY   *P56:24,"Opening ccsmscaf";
          OPEN      CCSMSCA1,"ccsmscaf"
          DISPLAY   *P56:24,"Opening ccsmtsaf";
          OPEN      CCSMTSA1,"ccsmtsaf"
          DISPLAY   *P56:24,"Opening ccspaqaf";
          OPEN      CCSPAQA1,"ccspaqaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA1,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA2,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA3,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccspdpaf";
          OPEN      CCSPDPA4,"ccspdpaf"
          DISPLAY   *P56:24,"Opening ccsperaf";
          OPEN      CCSPERA1,"ccsperaf"
          DISPLAY   *P56:24,"Opening ccsupdaf";
          OPEN      CCSUPDA1,"ccsupdaf"
          DISPLAY   *P56:24,"Opening ccsupdaf";
          OPEN      CCSUPDA2,"ccsupdaf"
          DISPLAY   *P56:24,"Opening ccsupdaf";
          OPEN      CCSUPDA3,"ccsupdaf"
          DISPLAY   *P56:24,"Opening ccsupdaf";
          OPEN      CCSUPDA4,"ccsupdaf"
.--------------------------------------------------------
. Initialise Batch Screen Hospital                           
.--------------------------------------------------------
          MOVE     ZERO,CCDE1SNO
          MOVE     "DA    3",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCDE1SNO
            ENDIF
          ENDIF
          PACK      CCDE1FNM,ANST,CCDE1NAM,PORT
          REP       " 0",CCDE1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CCDE1FL1,CCDE1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     CCDE1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,CCDE1FNM,CCDE1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",CCDE1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      CCDE1FL1,CCDE1FNM
.--------------------------------------------------------
. Initialise Batch Screen Patient Service Code               
.--------------------------------------------------------
          MOVE     ZERO,CCPA1SNO
          MOVE     "DD   10",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCPA1SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Date of Service                    
.--------------------------------------------------------
          MOVE     ZERO,CCUP2SNO
          MOVE     "PC    5",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,CCUP2SNO
            ENDIF
          ENDIF
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Episode Enquiry Options            
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Split Cost Model Summary           
          ENDIF
          MATCH     "DA",SCRID
          IF         @EQUAL
            CALL       PSDAL000   * Departmental Analysis              
          ENDIF
          MATCH     "DD",SCRID
          IF         @EQUAL
            CALL       PSDDL000   * Department Details                 
          ENDIF
          MATCH     "DG",SCRID
          IF         @EQUAL
            CALL       PSDGL000   * Graph by Date Options              
          ENDIF
          MATCH     "ED",SCRID
          IF         @EQUAL
            CALL       PSEDL000   * Episode Details                    
          ENDIF
          MATCH     "PA",SCRID
          IF         @EQUAL
            CALL       PSPAL000   * Parameters                         
          ENDIF
          MATCH     "PC",SCRID
          IF         @EQUAL
            CALL       PSPCL000   * Patient Service Analysis           
          ENDIF
          MATCH     "PD",SCRID
          IF         @EQUAL
            CALL       PSPDL000   * Patient Service Details            
          ENDIF
          RETURN
.--------------------------------
. Screen - Episode Enquiry Options            
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   50",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Episode Enquiry Options            
.-------------------------------------------------------
CF00L000
          MOVE      SP70,CCEPHCD 
          MOVE      SP70,CCEPEPS 
          MOVE      SP70,CCHCDES 
          MOVE      SP70,CCEPCOM 
          MOVE      SP70,CCEPURN 
          MOVE      SP70,CCEPSDT 
          MOVE      SP70,CCEPLTD 
          MOVE      ZERO,CCEPLOS 
          MOVE      SP70,CCEPINPT
          MOVE      SP70,CCEPDAY 
          MOVE      ZERO,CCEPVIST
          MOVE      SP70,CCEPSEX 
          MOVE      SP70,CCEPDOB 
          MOVE      SP70,CCEPAGEY
          MOVE      SP70,CCEPAGEM
          MOVE      SP70,CCEPAGED
          MOVE      SP70,CCEPCOB 
          MOVE      SP70,CCEPREL 
          MOVE      SP70,CCEPDDAT
          MOVE      SP70,CCEPDSTA
          MOVE      SP70,CCEPDDES
          MOVE      SP70,CCEPDMBS
          MOVE      SP70,CCEPDDPT
          MOVE      SP70,CCEPDSER
          MOVE      SP70,CCEPMDCC
          MOVE      SP70,CCEPDRGC
          MOVE      SP70,CCEPADAT
          MOVE      SP70,CCEPAWAR
          MOVE      SP70,CCEPASRC
          MOVE      SP70,CCEPACLS
          MOVE      SP70,CCEPACAR
          MOVE      SP70,CCEPADPT
          MOVE      SP70,CCEPASER
          MOVE      SP70,CCEPARDC
          MOVE      SP70,CCEPATDC
          MOVE      SP70,CCEPAADC
          MOVE      SP70,CCEPDADC
          MOVE      SP70,CCEPAHFD
          MOVE      SP70,CCEPAHTB
          MOVE      SP70,CCEPAMBS
          MOVE      SP70,CCEPOPCL
          MOVE      SP70,CCEPPDIA
          MOVE      SP70,CCEPSDIA
          MOVE      SP70,CCEPPOPP
          MOVE      SP70,CCEPSOPP
          MOVE      SP70,CCEPDWAR
          MOVE      SP70,CCEPSUR 
          MOVE      SP70,CCEPGIV 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Episode Enquiry Options            
.--------------------------------------------------------
KY00L000
.
KY00L110
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCHCDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCCHCA00
          MOVE      CCHCHCD,CCEPHCD
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      CCEPHCD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCHCDES,VAR      
            CALL      DISPITEM
          ENDIF
.
KY00L120
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KCCEPA00
          BRANCH    EXIT,KY00L110,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      CCEPEPS,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Episode Enquiry Options            
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Episode Enquiry Options            
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Episode Enquiry Options            
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Episode Enquiry Options            
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L101,PS00L102:
                            PS00L103,PS00L104,PS00L105,PS00L106:
                            PS00L107,PS00L108,PS00L109,PS00L110:
                            PS00L111,PS00L112,PS00L113,PS00L114:
                            PS00L115,PS00L116,PS00L117,PS00L118:
                            PS00L119,PS00L120,PS00L121,PS00L122:
                            PS00L123,PS00L124,PS00L125,PS00L126:
                            PS00L127,PS00L128,PS00L129,PS00L130:
                            PS00L131,PS00L132,PS00L133,PS00L134:
                            PS00L135,PS00L136,PS00L137,PS00L138:
                            PS00L139,PS00L140,PS00L141,PS00L142:
                            PS00L143,PS00L144,PS00L145,PS00L146:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999
          GOTO     PS00L999
.
PS00L101
          MOVE      CCHCDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPCOM,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      CCEPURN,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          UNPACK    CCEPSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          UNPACK    CCEPLTD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      CCEPLOS,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPINPT,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPDAY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      CCEPVIST,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      CCEPSEX,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          UNPACK    CCEPDOB,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      CCEPAGEY,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      CCEPAGEM,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      CCEPAGED,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      CCEPCOB,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      CCEPREL,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          UNPACK    CCEPDDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      CCEPDSTA,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      CCEPDDES,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE      CCEPDMBS,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          MOVE      CCEPDDPT,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      CCEPDSER,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          MOVE      CCEPMDCC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          MOVE      CCEPDRGC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          UNPACK    CCEPADAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L126
          MOVE      CCEPAWAR,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L127
          MOVE      CCEPASRC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L128
          MOVE      CCEPACLS,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L129
          MOVE      CCEPACAR,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L130
          MOVE      CCEPADPT,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L131
          MOVE      CCEPASER,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L132
          MOVE      CCEPARDC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L133
          MOVE      CCEPATDC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L134
          MOVE      CCEPAADC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L135
          MOVE      CCEPDADC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L136
          MOVE      CCEPAHFD,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L137
          MOVE      CCEPAHTB,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L138
          MOVE      CCEPAMBS,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L139
          MOVE      CCEPOPCL,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L140
          MOVE      CCEPPDIA,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L141
          MOVE      CCEPSDIA,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L142
          MOVE      CCEPPOPP,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L143
          MOVE      CCEPSOPP,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L144
          MOVE      CCEPDWAR,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L145
          MOVE      CCEPSUR,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L146
          MOVE      CCEPGIV,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Episode Enquiry Options            
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L101,SF00L006,SF00L102,SF00L103:
                            SF00L104,SF00L105,SF00L106
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCEDL000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   50",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L103
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      MAKDPT00
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   50",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCPCL000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   50",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L106
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC01L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   50",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Split Cost Model Summary           
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 8",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Split Cost Model Summary           
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Split Cost Model Summary           
.--------------------------------------------------------
KY01L000
.
KY01L110
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCSPDES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ESMOD000
          BRANCH    EXIT,KY01L900,KY01L900
          MOVE      ZERO,ACCEPT
          MOVE      CCSPMID,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCSPDES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Split Cost Model Summary           
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Split Cost Model Summary           
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Split Cost Model Summary           
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Split Cost Model Summary           
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L101,PS01L102:
                            PS01L103,PS01L104,PS01L105,PS01L106:
                            PS01L107,PS01L108,PS01L109,PS01L110:
                            PS01L111,PS01L112,PS01L113,PS01L999:
                            PS01L999,PS01L999
          GOTO     PS01L999
.
PS01L101
          MOVE      CCSPDES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      CCSPFYR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      CCSPFPR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      CCSPTYR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      CCSPTPR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      CCSPMOD,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      CCRBFDR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      CCRBFID,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      CCRBVDR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      CCRBVID,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      TOTCOST,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          MOVE      CCIAIA1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          MOVE      TOTVARI,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Split Cost Model Summary           
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L101:
                            SF01L102,SF01L103
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L103
          CALL      REPT0000
          GOTO      SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Departmental Analysis              
.--------------------------------
SCDAL000
SCDAL100
          MOVE      "DA",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 8",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCDAL200
          CALL      CFDAL000 * Clear Fields
SCDAL300
          CALL      KYDAL000 * Enter Key Fields
          BRANCH    EXIT,SCDAL999,SCDAL999
SCDAL400
          CALL      WPDAL000 * Load any WP Details
SCDAL500
          CALL      LMDAL000 * Load any Batch Details
SCDAL600
          CALL      DFDAL000 * Display Fields
SCDAL700
          CALL      SFDAL000 * Select Fields
          BRANCH    EXIT,SCDAL100,SCDAL100,SCDAL200
SCDAL800
SCDAL900
SCDAL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Departmental Analysis              
.-------------------------------------------------------
CFDAL000
CFDAL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Departmental Analysis              
.--------------------------------------------------------
KYDAL000
          MOVE      ZERO,EXIT
          GOTO      KYDAL999
.
KYDAL900  MOVE      ONE,EXIT
KYDAL999  RETURN
.---------------------------------------------------------
. Load WP files for : Departmental Analysis              
.---------------------------------------------------------
WPDAL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Departmental Analysis              
.---------------------------------------------------------
LMDAL000
.---------------------------------------------------------
. Load for :     3 Hospital                           
.---------------------------------------------------------
          PACK      KEY12,PORT,SP70
          MOVE      KEY12,CCDE1EKY
          MOVE      CCDE1EKY,CCDE1SKY
          STRIP     CCDE1SKY
          SETLPTR   CCDE1EKY,2
          CALL      RDCCDE1 
          IF        OVRCD=0
            CALL      RPCCDE1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPDAL000
          MOVE     ZERO,CCDE1CNT
          MOVE     ZERO,CCDE1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPDAL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPDAL600
          MATCH    PRGID,SCPSPID
          GOTO     DPDAL600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPDAL600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPDAL010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPDAL010,DPDAL010,DPDAL101,DPDAL010:
                            DPDAL102,DPDAL103,DPDAL104,DPDAL105:
                            DPDAL106,DPDAL107,DPDAL010,DPDAL010:
                           DPDAL010,DPDAL010,DPDAL010,DPDAL010:
                            DPDAL010,DPDAL010,DPDAL010,DPDAL010:
                            DPDAL010,DPDAL010
          GOTO      DPDAL010
.
DPDAL101
          PACK      CCDE1MKY,SP70,SP70
          CALL      UPTCCDE1
          IF        CCDE1END=0
            CALL      RKCCDE1 
            IF        OVRCD=0
              PACK      CCDE1MKY,CCDEPORT,CCDEHCD,CCDEDPT                                                       
              MATCH     CCDE1EKY,CCDE1MKY
              IF        @EQUAL
                MOVE      ZERO,CCDE1END
                ADD       ONE,CCDE1CNT
                CALL      UPTCCDE1
                MOVE      CCDEHCD,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,CCDE1END
              ENDIF
            ELSE
              MOVE      ONE,CCDE1END
            ENDIF
          ENDIF
          IF        CCDE1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL102
          IF        CCDE1END=0
            MOVE      CCDEDPT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL103
          IF        CCDE1END=0
            MOVE      CCDEDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL104
          IF        CCDE1END=0
            MOVE      CCDENUM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL105
          IF        CCDE1END=0
            MOVE      CCDESTD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL106
          IF        CCDE1END=0
            MOVE      CCDEACT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
.
DPDAL107
          IF        CCDE1END=0
            MOVE      CCDEBUD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDAL010
DPDAL600
          MATCH    "CCDE1",NAMSSFFI
          GOTO     DPDAL605 IF NOT EQUAL
          GOTO     DPDAL999
DPDAL605
DPDAL999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPDAL000
.
          MATCH    "CCDE1",NAMSSFFI
          GOTO     FPDAL105 IF NOT EQUAL
          PACK     KEY12,CCDE1SKY,SP70
          CALL     RDCCDE1  * Start
          IF       OVRCD=0
            CALL     RPCCDE1  * Start
          ENDIF
          CALL     DPDAL000
          GOTO     FPDAL999
FPDAL105
FPDAL999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPDAL000
.
          MATCH    "CCDE1",NAMSSFFI
          GOTO     LPDAL105 IF NOT EQUAL
          PACK     KEY12,CCDE1SKY,Z70
          CALL     RSCCDE1  * End
          IF       OVRCD=1
            CALL     RPCCDE1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCDE1SNO
            CALL     RPCCDE1 
            IF       OVRCD=1
              MOVE     CCDE1SNO,SECTOR
            ENDIF
            PACK     CCDE1MKY,CCDEPORT,CCDEHCD,CCDEDPT                                                       
            MATCH    CCDE1EKY,CCDE1MKY
            IF       !@EQUAL
              MOVE     CCDE1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPDAL000
          GOTO     LPDAL999
LPDAL105
LPDAL999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPDAL000
.
          MATCH    "CCDE1",NAMSSFFI
          GOTO     PPDAL120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPDAL105
          CALL      RFTCCDE1
          BRANCH   OVRCD,PPDAL115
          MOVE      CCDE1MKY,KEY12 
          CALL      RSCCDE1 
PPDAL110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=CCDE1SNO
            CALL     RPCCDE1 
            IF       OVRCD=1
              MOVE     CCDE1SNO,SECTOR
            ENDIF
            PACK     CCDE1MKY,CCDEPORT,CCDEHCD,CCDEDPT                                                       
            MATCH    CCDE1EKY,CCDE1MKY
            IF       !@EQUAL
              MOVE     CCDE1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPDAL000
          GOTO     PPDAL999
PPDAL115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCDE1SNO
            CALL     RKCCDE1 
            IF       OVRCD=1
              MOVE     CCDE1SNO,SECTOR
            ENDIF
            PACK     CCDE1MKY,CCDEPORT,CCDEHCD,CCDEDPT                                                       
            MATCH    CCDE1EKY,CCDE1MKY
            IF       !@EQUAL
              MOVE     CCDE1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPDAL999
PPDAL120
PPDAL999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPDAL000
          MATCH    "CCDE1",NAMSSFFI
          GOTO     NPDAL115 IF NOT EQUAL
NPDAL105
          CALL     RKCCDE1 
          BRANCH   OVRCD,NPDAL110
          PACK     CCDE1MKY,CCDEPORT,CCDEHCD,CCDEDPT                                                       
          MATCH    CCDE1EKY,CCDE1MKY
          GOTO     NPDAL110 IF NOT EQUAL
          CALL     RPCCDE1 
          CALL     DPDAL000
          GOTO     NPDAL999
NPDAL110
          CALL     RPCCDE1 
          BEEP
          GOTO     NPDAL999
NPDAL115
NPDAL999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTDAL000
CTDAL105
CTDAL999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Departmental Analysis              
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     3 Hospital                           
.---------------------------------------------------------
UPTCCDE1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCDE1FL1,KEY5;ANS
          IF        @OVER
            WRITE     CCDE1FL1,KEY5;SCPSROW,SCPSCOL,CCDE1MKY
          ELSE
            UPDATE    CCDE1FL1;SCPSROW,SCPSCOL,CCDE1MKY
          ENDIF
          RETURN
RDTCCDE1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      CCDE1FL1,KEY5;SCPSROW,SCPSCOL,CCDE1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTCCDE1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      CCDE1FL1,KEY5;;
          READKS    CCDE1FL1;SCPSROW,SCPSCOL,CCDE1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,CCDE1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Departmental Analysis              
.---------------------------------------------------------
DFDAL000
          BRANCH   ACCEPT,DFDAL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFDAL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFDAL900
          MATCH    PRGID,SCPSPID
          GOTO     DFDAL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFDAL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFDAL010 IF NOT EQUAL
.
          CALL     PSDAL000 * Display Field
          GOTO     DFDAL010
DFDAL900
          MOVE      "CCDE1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPDAL000
DFDAL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Departmental Analysis              
.---------------------------------------------------------
PSDAL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSDAL999,PSDAL999,PSDAL999,PSDAL999:
                            PSDAL999,PSDAL999,PSDAL999,PSDAL999:
                            PSDAL999,PSDAL999,PSDAL999,PSDAL999:
                           PSDAL999,PSDAL999,PSDAL999,PSDAL999:
                            PSDAL999,PSDAL999,PSDAL999,PSDAL101:
                            PSDAL102,PSDAL103
          GOTO     PSDAL999
.
PSDAL101
          MOVE      TOT1AMT,VAR      
          CALL      DISPITEM
          GOTO     PSDAL999
.
PSDAL102
          MOVE      TOT2AMT,VAR      
          CALL      DISPITEM
          GOTO     PSDAL999
.
PSDAL103
          MOVE      TOT3AMT,VAR      
          CALL      DISPITEM
          GOTO     PSDAL999
PSDAL999
          RETURN
.---------------------------------------------------------
. Selections for : Departmental Analysis              
.---------------------------------------------------------
SFDAL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFDAL001  BRANCH   ACCEPT,SFDAL020
.
SFDAL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFDAL006,SFDAL101,SFDAL102,SFDAL103:
                            SFDAL006,SFDAL006,SFDAL006,SFDAL006:
                            SFDAL006,SFDAL006,SFDAL006,SFDAL006:
                           SFDAL006,SFDAL006,SFDAL006,SFDAL104:
                            SFDAL105,SFDAL106,SFDAL107,SFDAL006:
                            SFDAL006,SFDAL006
SFDAL006  BEEP
          GOTO     SFDAL005
SFDAL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFDAL090
          MATCH    PRGID,SCSLPID
          GOTO     SFDAL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFDAL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFDAL020,SFDAL020,SFDAL102,SFDAL020:
                            SFDAL020,SFDAL020,SFDAL020,SFDAL020:
                            SFDAL020,SFDAL020,SFDAL020,SFDAL020:
                           SFDAL020,SFDAL020,SFDAL020,SFDAL020:
                            SFDAL020,SFDAL020,SFDAL020,SFDAL020:
                            SFDAL020,SFDAL020
          GOTO     SFDAL020
SFDAL090  MOVE     ZERO,ACCEPT
          MOVE      "CCDE1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPDAL000
          GOTO     SFDAL001
.
SFDAL101
          MOVE      ZERO,EXIT
          GOTO      SFDAL999
.
SFDAL102
          CALL      SELECTED
          BRANCH    EXIT,SFDAL001
          COMPARE   ONE,ACCEPT
          GOTO      SFDAL001 IF EQUAL
          CALL      RDTCCDE1
          IF        OVRCD=1
            BEEP
            GOTO      SFDAL001
          ENDIF
          MATCH     SP70,CCDE1MKY
          IF        @EQUAL
            BEEP
            GOTO      SFDAL001
          ENDIF
          MOVE      CCDE1MKY,KEY12 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELDPT00
          MOVE      "DA",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTCCDE1
          IF        OVRCD=1
            CALL      FPDAL000
          ELSE
            MOVE      CCDE1MKY,KEY12 
            CALL      RSCCDE1 
            CALL      RPCCDE1 
            CALL      DPDAL000
          ENDIF
          GOTO     SFDAL001
.
SFDAL103
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFDAL999
.
SFDAL104
          MOVE      "CCDE1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NPDAL000
          GOTO     SFDAL001
.
SFDAL105
          MOVE      "CCDE1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PPDAL000
          GOTO     SFDAL001
.
SFDAL106
          MOVE      "CCDE1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FPDAL000
          GOTO     SFDAL001
.
SFDAL107
          MOVE      "CCDE1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LPDAL000
          GOTO     SFDAL001
SFDAL990  MOVE      ONE,EXIT * Exit Char Restart
SFDAL999  RETURN
.--------------------------------
. Screen - Department Details                 
.--------------------------------
SCDDL000
SCDDL100
          MOVE      "DD",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 9",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCDDL200
          CALL      CFDDL000 * Clear Fields
SCDDL300
          CALL      KYDDL000 * Enter Key Fields
          BRANCH    EXIT,SCDDL999,SCDDL999
SCDDL400
          CALL      WPDDL000 * Load any WP Details
SCDDL500
          CALL      LMDDL000 * Load any Batch Details
SCDDL600
          CALL      DFDDL000 * Display Fields
SCDDL700
          CALL      SFDDL000 * Select Fields
          BRANCH    EXIT,SCDDL100,SCDDL100,SCDDL200
SCDDL800
SCDDL900
SCDDL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Department Details                 
.-------------------------------------------------------
CFDDL000
CFDDL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Department Details                 
.--------------------------------------------------------
KYDDL000
          MOVE      ZERO,EXIT
          GOTO      KYDDL999
.
KYDDL900  MOVE      ONE,EXIT
KYDDL999  RETURN
.---------------------------------------------------------
. Load WP files for : Department Details                 
.---------------------------------------------------------
WPDDL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Department Details                 
.---------------------------------------------------------
LMDDL000
.---------------------------------------------------------
. Load for :    10 Patient Service Code               
.---------------------------------------------------------
          PACK      KEY10,PORT,SP70
          MOVE      KEY10,CCPA1EKY
          MOVE      CCPA1EKY,CCPA1SKY
          STRIP     CCPA1SKY
          SETLPTR   CCPA1EKY,2
          CALL      RDCCPA1 
          IF        OVRCD=0
            CALL      RPCCPA1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPDDL000
          MOVE     ZERO,CCPA1CNT
          MOVE     ZERO,CCPA1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPDDL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPDDL600
          MATCH    PRGID,SCPSPID
          GOTO     DPDDL600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPDDL600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPDDL010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPDDL010,DPDDL010,DPDDL010,DPDDL010:
                            DPDDL010,DPDDL010,DPDDL010,DPDDL010:
                            DPDDL010,DPDDL101,DPDDL102,DPDDL103:
                            DPDDL104,DPDDL105,DPDDL106,DPDDL010:
                           DPDDL010,DPDDL010,DPDDL010,DPDDL010:
                           DPDDL010,DPDDL010,DPDDL010,DPDDL010
          GOTO      DPDDL010
.
DPDDL101
          IF        CCPA1END=0
            CALL      RKCCPA1 
            IF        OVRCD=0
              PACK      CCPA1MKY,CCPAPORT,CCPAPCD                                                               
              MATCH     CCPA1EKY,CCPA1MKY
              IF        @EQUAL
                MOVE      ZERO,CCPA1END
                ADD       ONE,CCPA1CNT
                MOVE      CCPAPCD,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,CCPA1END
              ENDIF
            ELSE
              MOVE      ONE,CCPA1END
            ENDIF
          ENDIF
          IF        CCPA1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDDL010
.
DPDDL102
          IF        CCPA1END=0
            MOVE      CCPADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDDL010
.
DPDDL103
          IF        CCPA1END=0
            MOVE      CCPANUM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDDL010
.
DPDDL104
          IF        CCPA1END=0
            MOVE      CCPASTD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDDL010
.
DPDDL105
          IF        CCPA1END=0
            MOVE      CCPAACT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDDL010
.
DPDDL106
          IF        CCPA1END=0
            MOVE      CCPABUD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPDDL010
DPDDL600
          MATCH    "CCPA1",NAMSSFFI
          GOTO     DPDDL605 IF NOT EQUAL
          GOTO     DPDDL999
DPDDL605
DPDDL999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPDDL000
.
          MATCH    "CCPA1",NAMSSFFI
          GOTO     FPDDL105 IF NOT EQUAL
          PACK     KEY10,CCPA1SKY,SP70
          CALL     RDCCPA1  * Start
          IF       OVRCD=0
            CALL     RPCCPA1  * Start
          ENDIF
          CALL     DPDDL000
          GOTO     FPDDL999
FPDDL105
FPDDL999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPDDL000
.
          MATCH    "CCPA1",NAMSSFFI
          GOTO     LPDDL105 IF NOT EQUAL
          PACK     KEY10,CCPA1SKY,Z70
          CALL     RSCCPA1  * End
          IF       OVRCD=1
            CALL     RPCCPA1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCPA1SNO
            CALL     RPCCPA1 
            IF       OVRCD=1
              MOVE     CCPA1SNO,SECTOR
            ENDIF
            PACK     CCPA1MKY,CCPAPORT,CCPAPCD                                                               
            MATCH    CCPA1EKY,CCPA1MKY
            IF       !@EQUAL
              MOVE     CCPA1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPDDL000
          GOTO     LPDDL999
LPDDL105
LPDDL999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPDDL000
.
          MATCH    "CCPA1",NAMSSFFI
          GOTO     PPDDL120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPDDL105
          COMPARE  SECTOR,CCPA1SNO
          GOTO     PPDDL110 IF EQUAL
          CALL     RPCCPA1 
          BRANCH   OVRCD,PPDDL115
          PACK     CCPA1MKY,CCPAPORT,CCPAPCD                                                               
          MATCH    CCPA1EKY,CCPA1MKY
          GOTO     PPDDL115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PPDDL105
PPDDL110
          MOVE     ZERO,SECTOR
          IF       CCPA1CNT=CCPA1SNO
            SUB      ONE,CCPA1CNT
          ENDIF
          WHILE    SECTOR<=CCPA1CNT
            CALL     RPCCPA1 
            IF       OVRCD=1
              MOVE     CCPA1SNO,SECTOR
            ENDIF
            PACK     CCPA1MKY,CCPAPORT,CCPAPCD                                                               
            MATCH    CCPA1EKY,CCPA1MKY
            IF       !@EQUAL
              MOVE     CCPA1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPDDL000
          GOTO     PPDDL999
PPDDL115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCPA1SNO
            CALL     RKCCPA1 
            IF       OVRCD=1
              MOVE     CCPA1SNO,SECTOR
            ENDIF
            PACK     CCPA1MKY,CCPAPORT,CCPAPCD                                                               
            MATCH    CCPA1EKY,CCPA1MKY
            IF       !@EQUAL
              MOVE     CCPA1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPDDL999
PPDDL120
PPDDL999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPDDL000
          MATCH    "CCPA1",NAMSSFFI
          GOTO     NPDDL115 IF NOT EQUAL
NPDDL105
          CALL     RKCCPA1 
          BRANCH   OVRCD,NPDDL110
          PACK     CCPA1MKY,CCPAPORT,CCPAPCD                                                               
          MATCH    CCPA1EKY,CCPA1MKY
          GOTO     NPDDL110 IF NOT EQUAL
          CALL     RPCCPA1 
          CALL     DPDDL000
          GOTO     NPDDL999
NPDDL110
          CALL     RPCCPA1 
          BEEP
          GOTO     NPDDL999
NPDDL115
NPDDL999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTDDL000
CTDDL105
CTDDL999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Department Details                 
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Department Details                 
.---------------------------------------------------------
DFDDL000
          BRANCH   ACCEPT,DFDDL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFDDL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFDDL900
          MATCH    PRGID,SCPSPID
          GOTO     DFDDL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFDDL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFDDL010 IF NOT EQUAL
.
          CALL     PSDDL000 * Display Field
          GOTO     DFDDL010
DFDDL900
          MOVE      "CCPA1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FPDDL000
DFDDL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Department Details                 
.---------------------------------------------------------
PSDDL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSDDL999,PSDDL999,PSDDL999,PSDDL101:
                            PSDDL102,PSDDL103,PSDDL104,PSDDL105:
                            PSDDL106,PSDDL999,PSDDL999,PSDDL999:
                            PSDDL999,PSDDL999,PSDDL999,PSDDL999:
                           PSDDL999,PSDDL999,PSDDL999,PSDDL999:
                           PSDDL999,PSDDL999,PSDDL999,PSDDL999
          GOTO     PSDDL999
.
PSDDL101
          MOVE      CCDEHCD,VAR      
          CALL      DISPITEM
          GOTO     PSDDL999
.
PSDDL102
          MOVE      CCDEDPT,VAR      
          CALL      DISPITEM
          GOTO     PSDDL999
.
PSDDL103
          MOVE      CCDEDES,VAR      
          CALL      DISPITEM
          GOTO     PSDDL999
.
PSDDL104
          MOVE      CCDESTD,VAR      
          CALL      DISPITEM
          GOTO     PSDDL999
.
PSDDL105
          MOVE      CCDEACT,VAR      
          CALL      DISPITEM
          GOTO     PSDDL999
.
PSDDL106
          MOVE      CCDEBUD,VAR      
          CALL      DISPITEM
          GOTO     PSDDL999
PSDDL999
          RETURN
.---------------------------------------------------------
. Selections for : Department Details                 
.---------------------------------------------------------
SFDDL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFDDL001  BRANCH   ACCEPT,SFDDL020
.
SFDDL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFDDL006,SFDDL101,SFDDL102,SFDDL006:
                            SFDDL006,SFDDL006,SFDDL006,SFDDL006:
                            SFDDL006,SFDDL006,SFDDL006,SFDDL006:
                            SFDDL006,SFDDL006,SFDDL006,SFDDL006:
                           SFDDL006,SFDDL006,SFDDL006,SFDDL006:
                           SFDDL103,SFDDL104,SFDDL105,SFDDL106
SFDDL006  BEEP
          GOTO     SFDDL005
SFDDL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFDDL090
          MATCH    PRGID,SCSLPID
          GOTO     SFDDL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFDDL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFDDL020,SFDDL020,SFDDL020,SFDDL020:
                            SFDDL020,SFDDL020,SFDDL020,SFDDL020:
                            SFDDL020,SFDDL020,SFDDL020,SFDDL020:
                            SFDDL020,SFDDL020,SFDDL020,SFDDL020:
                           SFDDL020,SFDDL020,SFDDL020,SFDDL020:
                           SFDDL020,SFDDL020,SFDDL020,SFDDL020
          GOTO     SFDDL020
SFDDL090  MOVE     ZERO,ACCEPT
          MOVE      "CCPA1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FPDDL000
          GOTO     SFDDL001
.
SFDDL101
          MOVE      ZERO,EXIT
          GOTO      SFDDL999
.
SFDDL102
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFDDL999
.
SFDDL103
          MOVE      "CCPA1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      NPDDL000
          GOTO     SFDDL001
.
SFDDL104
          MOVE      "CCPA1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      PPDDL000
          GOTO     SFDDL001
.
SFDDL105
          MOVE      "CCPA1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      FPDDL000
          GOTO     SFDDL001
.
SFDDL106
          MOVE      "CCPA1",NAMSSFFI
          MOVE      "   10",ITMSSFFI
          CALL      LPDDL000
          GOTO     SFDDL001
SFDDL990  MOVE      ONE,EXIT * Exit Char Restart
SFDDL999  RETURN
.--------------------------------
. Screen - Graph by Date Options              
.--------------------------------
SCDGL000
SCDGL100
          MOVE      "DG",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      " 48",CLEF
          MOVE      " 80",CRIG
          MOVE      "15",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCDGL200
          CALL      CFDGL000 * Clear Fields
SCDGL300
          CALL      KYDGL000 * Enter Key Fields
          BRANCH    EXIT,SCDGL999,SCDGL999
SCDGL400
          CALL      WPDGL000 * Load any WP Details
SCDGL500
          CALL      LMDGL000 * Load any Batch Details
SCDGL600
          CALL      DFDGL000 * Display Fields
SCDGL700
          CALL      SFDGL000 * Select Fields
          BRANCH    EXIT,SCDGL100,SCDGL100,SCDGL200
SCDGL800
SCDGL900
SCDGL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Graph by Date Options              
.-------------------------------------------------------
CFDGL000
CFDGL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Graph by Date Options              
.--------------------------------------------------------
KYDGL000
          MOVE      ZERO,EXIT
          GOTO      KYDGL999
.
KYDGL900  MOVE      ONE,EXIT
KYDGL999  RETURN
.---------------------------------------------------------
. Load WP files for : Graph by Date Options              
.---------------------------------------------------------
WPDGL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Graph by Date Options              
.---------------------------------------------------------
LMDGL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Graph by Date Options              
.---------------------------------------------------------
DFDGL000
          BRANCH   ACCEPT,DFDGL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFDGL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFDGL900
          MATCH    PRGID,SCPSPID
          GOTO     DFDGL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFDGL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFDGL010 IF NOT EQUAL
.
          CALL     PSDGL000 * Display Field
          GOTO     DFDGL010
DFDGL900
DFDGL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Graph by Date Options              
.---------------------------------------------------------
PSDGL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSDGL999,PSDGL999,PSDGL999,PSDGL999:
                            PSDGL101,PSDGL102,PSDGL103
          GOTO     PSDGL999
.
PSDGL101
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHACT,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSDGL999
.
PSDGL102
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHBUD,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSDGL999
.
PSDGL103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHSTD,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSDGL999
PSDGL999
          RETURN
.---------------------------------------------------------
. Selections for : Graph by Date Options              
.---------------------------------------------------------
SFDGL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFDGL001  BRANCH   ACCEPT,SFDGL020
.
SFDGL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFDGL006,SFDGL101,SFDGL102,SFDGL103:
                            SFDGL104,SFDGL105,SFDGL106
SFDGL006  BEEP
          GOTO     SFDGL005
SFDGL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFDGL090
          MATCH    PRGID,SCSLPID
          GOTO     SFDGL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFDGL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFDGL020,SFDGL020,SFDGL020,SFDGL020:
                            SFDGL104,SFDGL105,SFDGL106
          GOTO     SFDGL020
SFDGL090  MOVE     ZERO,ACCEPT
          GOTO     SFDGL001
.
SFDGL101
          MOVE      ZERO,EXIT
          GOTO      SFDGL999
.
SFDGL102
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFDGL999
.
SFDGL103
          CALL      GPHDAT00
          GOTO      SFDGL001
.
SFDGL104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHACT00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFDGL104
            ENDIF
            BRANCH    EXIT,SFDGL104,SFDGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFDGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHACT,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFDGL001
.
SFDGL105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHBUD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFDGL105
            ENDIF
            BRANCH    EXIT,SFDGL105,SFDGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFDGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHBUD,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFDGL001
.
SFDGL106
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      GPHSTD00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFDGL106
            ENDIF
            BRANCH    EXIT,SFDGL106,SFDGL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFDGL990 IF EQUAL
          ENDIF
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      GPHSTD,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SFDGL001
SFDGL990  MOVE      ONE,EXIT * Exit Char Restart
SFDGL999  RETURN
.--------------------------------
. Screen - Episode Details                    
.--------------------------------
SCEDL000
SCEDL100
          MOVE      "ED",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCEDL200
          CALL      CFEDL000 * Clear Fields
SCEDL300
          CALL      KYEDL000 * Enter Key Fields
          BRANCH    EXIT,SCEDL999,SCEDL999
SCEDL400
          CALL      WPEDL000 * Load any WP Details
SCEDL500
          CALL      LMEDL000 * Load any Batch Details
SCEDL600
          CALL      DFEDL000 * Display Fields
SCEDL700
          CALL      SFEDL000 * Select Fields
          BRANCH    EXIT,SCEDL100,SCEDL100,SCEDL200
SCEDL800
SCEDL900
SCEDL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Episode Details                    
.-------------------------------------------------------
CFEDL000
CFEDL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Episode Details                    
.--------------------------------------------------------
KYEDL000
          MOVE      ZERO,EXIT
          GOTO      KYEDL999
.
KYEDL900  MOVE      ONE,EXIT
KYEDL999  RETURN
.---------------------------------------------------------
. Load WP files for : Episode Details                    
.---------------------------------------------------------
WPEDL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Episode Details                    
.---------------------------------------------------------
LMEDL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Episode Details                    
.---------------------------------------------------------
DFEDL000
          BRANCH   ACCEPT,DFEDL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFEDL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFEDL900
          MATCH    PRGID,SCPSPID
          GOTO     DFEDL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFEDL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFEDL010 IF NOT EQUAL
.
          CALL     PSEDL000 * Display Field
          GOTO     DFEDL010
DFEDL900
DFEDL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Episode Details                    
.---------------------------------------------------------
PSEDL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSEDL999,PSEDL999,PSEDL999,PSEDL999:
                           PSEDL999,PSEDL101,PSEDL102,PSEDL103:
                            PSEDL104,PSEDL105,PSEDL106,PSEDL107:
                            PSEDL108,PSEDL109,PSEDL110,PSEDL111:
                            PSEDL112,PSEDL113,PSEDL114,PSEDL115:
                            PSEDL116,PSEDL117,PSEDL118,PSEDL119:
                            PSEDL120,PSEDL121,PSEDL122,PSEDL123:
                            PSEDL124,PSEDL125,PSEDL126,PSEDL127:
                            PSEDL128,PSEDL129,PSEDL130,PSEDL131:
                            PSEDL132,PSEDL133,PSEDL134,PSEDL135:
                            PSEDL136,PSEDL137,PSEDL138,PSEDL139:
                            PSEDL140,PSEDL141,PSEDL142,PSEDL143:
                            PSEDL144,PSEDL145,PSEDL146,PSEDL147:
                            PSEDL148,PSEDL149,PSEDL150,PSEDL151:
                            PSEDL152,PSEDL153,PSEDL154,PSEDL155:
                            PSEDL156,PSEDL157,PSEDL158
          GOTO     PSEDL999
.
PSEDL101
          MOVE      CCEPHCD,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL102
          MOVE      CCEPEPS,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPCOM,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL104
          MOVE      CCEPURN,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL105
          UNPACK    CCEPSDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL106
          UNPACK    CCEPLTD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL107
          MOVE      CCEPLOS,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL108
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPINPT,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPDAY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL110
          MOVE      CCEPVIST,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL111
          MOVE      CCEPSEX,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL112
          UNPACK    CCEPDOB,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL113
          MOVE      CCEPAGEY,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL114
          MOVE      CCEPAGEM,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL115
          MOVE      CCEPAGED,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL116
          MOVE      CCEPCOB,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL117
          MOVE      CCEPREL,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL118
          UNPACK    CCEPDDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL119
          MOVE      CCEPDSTA,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL120
          MOVE      CCEPDDES,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL121
          MOVE      CCEPDMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL122
          MOVE      CCEPDDPT,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL123
          MOVE      CCEPDSER,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL124
          MOVE      CCEPMDCC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL125
          MOVE      CCEPDRGC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL126
          UNPACK    CCEPADAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL127
          MOVE      CCEPAWAR,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL128
          MOVE      CCEPASRC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL129
          MOVE      CCEPACLS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL130
          MOVE      CCEPACAR,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL131
          MOVE      CCEPADPT,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL132
          MOVE      CCEPASER,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL133
          MOVE      CCEPARDC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL134
          MOVE      CCEPATDC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL135
          MOVE      CCEPAADC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL136
          MOVE      CCEPDADC,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL137
          MOVE      CCEPAHFD,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL138
          MOVE      CCEPAHTB,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL139
          MOVE      CCEPAMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL140
          MOVE      CCEPOPCL,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL141
          MOVE      CCEPPDIA,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL142
          MOVE      CCEPSDIA,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL143
          MOVE      CCEPPOPP,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL144
          MOVE      CCEPSOPP,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL145
          MOVE      CCEPDWAR,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL146
          MOVE      CCEPSUR,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL147
          MOVE      CCEPGIV,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL148
          MOVE      CCEPPMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL149
          MOVE      CCEPSMBS,VAR     
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL150
          MOVE      CCEPMU1,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL151
          MOVE      CCEPMU2,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL152
          MOVE      CCEPMU3,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL153
          MOVE      CCEPMU4,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL154
          MOVE      CCEPMU5,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL155
          MOVE      CCEPMU6,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL156
          MOVE      CCEPMU7,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL157
          MOVE      CCEPPCD,VAR      
          CALL      DISPITEM
          GOTO     PSEDL999
.
PSEDL158
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CCEPEXC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PSEDL999
PSEDL999
          RETURN
.---------------------------------------------------------
. Selections for : Episode Details                    
.---------------------------------------------------------
SFEDL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFEDL001  BRANCH   ACCEPT,SFEDL020
.
SFEDL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFEDL006,SFEDL101,SFEDL102,SFEDL006:
                           SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006,SFEDL006:
                            SFEDL006,SFEDL006,SFEDL006
SFEDL006  BEEP
          GOTO     SFEDL005
SFEDL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFEDL090
          MATCH    PRGID,SCSLPID
          GOTO     SFEDL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFEDL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                           SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020,SFEDL020:
                            SFEDL020,SFEDL020,SFEDL020
          GOTO     SFEDL020
SFEDL090  MOVE     ZERO,ACCEPT
          GOTO     SFEDL001
.
SFEDL101
          MOVE      ZERO,EXIT
          GOTO      SFEDL999
.
SFEDL102
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFEDL999
SFEDL990  MOVE      ONE,EXIT * Exit Char Restart
SFEDL999  RETURN
.--------------------------------
. Screen - Parameters                         
.--------------------------------
SCPAL000
SCPAL100
          MOVE      "PA",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCPAL200
          CALL      CFPAL000 * Clear Fields
          CALL      MVACCEPT
SCPAL300
          CALL      KYPAL000 * Enter Key Fields
          BRANCH    EXIT,SCPAL999,SCPAL999
SCPAL400
          CALL      WPPAL000 * Load any WP Details
SCPAL500
          CALL      LMPAL000 * Load any Batch Details
SCPAL600
          CALL      DFPAL000 * Display Fields
SCPAL700
          CALL      SFPAL000 * Select Fields
          BRANCH    EXIT,SCPAL100,SCPAL100,SCPAL200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SCPAL800
SCPAL900
SCPAL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Parameters                         
.-------------------------------------------------------
CFPAL000
          MOVE      SP70,BUDYEAR 
          MOVE      SP70,BUDMODL 
          MOVE      SP70,ACTYEAR 
          MOVE      SP70,ACTMODL 
CFPAL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Parameters                         
.--------------------------------------------------------
KYPAL000
          MOVE      ZERO,EXIT
          GOTO      KYPAL999
.
KYPAL900  MOVE      ONE,EXIT
KYPAL999  RETURN
.---------------------------------------------------------
. Load WP files for : Parameters                         
.---------------------------------------------------------
WPPAL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Parameters                         
.---------------------------------------------------------
LMPAL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Parameters                         
.---------------------------------------------------------
DFPAL000
          BRANCH   ACCEPT,DFPAL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFPAL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFPAL900
          MATCH    PRGID,SCPSPID
          GOTO     DFPAL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFPAL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFPAL010 IF NOT EQUAL
.
          CALL     PSPAL000 * Display Field
          GOTO     DFPAL010
DFPAL900
DFPAL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Parameters                         
.---------------------------------------------------------
PSPAL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSPAL999,PSPAL999,PSPAL999,PSPAL101:
                            PSPAL102,PSPAL103,PSPAL104,PSPAL105:
                            PSPAL106,PSPAL107,PSPAL108,PSPAL109:
                            PSPAL110,PSPAL111,PSPAL112,PSPAL113:
                            PSPAL114
          GOTO     PSPAL999
.
PSPAL101
          MOVE      BUDYEAR,VAR      
          CALL      DISPITEM
          GOTO     PSPAL999
.
PSPAL102
          MOVE      BUDMODL,VAR      
          CALL      DISPITEM
          GOTO     PSPAL999
.
PSPAL103
          MOVE      ACTYEAR,VAR      
          CALL      DISPITEM
          GOTO     PSPAL999
.
PSPAL104
          MOVE      ACTMODL,VAR      
          CALL      DISPITEM
          GOTO     PSPAL999
.
PSPAL105
          MOVE      CCMADES,VAR      
          CALL      DISPITEM
          GOTO     PSPAL999
.
PSPAL106
          MOVE      CCMADES,VAR      
          CALL      DISPITEM
          GOTO     PSPAL999
.
PSPAL107
          MOVE      COST1AMT,VAR     
          CALL      DISPITEM
          GOTO     PSPAL999
.
PSPAL108
          MOVE      UNIT1AMT,VAR     
          CALL      DISPITEM
          GOTO     PSPAL999
.
PSPAL109
          MOVE      COST2AMT,VAR     
          CALL      DISPITEM
          GOTO     PSPAL999
.
PSPAL110
          MOVE      UNIT2AMT,VAR     
          CALL      DISPITEM
          GOTO     PSPAL999
.
PSPAL111
          MOVE      COST3AMT,VAR     
          CALL      DISPITEM
          GOTO     PSPAL999
.
PSPAL112
          MOVE      UNIT3AMT,VAR     
          CALL      DISPITEM
          GOTO     PSPAL999
.
PSPAL113
          MOVE      F12P2,VAR        
          CALL      DISPITEM
          GOTO     PSPAL999
.
PSPAL114
          MOVE      CCPERCNT,VAR     
          CALL      DISPITEM
          GOTO     PSPAL999
PSPAL999
          RETURN
.---------------------------------------------------------
. Selections for : Parameters                         
.---------------------------------------------------------
SFPAL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFPAL001  BRANCH   ACCEPT,SFPAL020
.
SFPAL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPAL006,SFPAL101,SFPAL102,SFPAL103:
                            SFPAL104,SFPAL105,SFPAL106,SFPAL006:
                            SFPAL006,SFPAL006,SFPAL006,SFPAL006:
                            SFPAL006,SFPAL006,SFPAL006,SFPAL006:
                            SFPAL006
SFPAL006  BEEP
          GOTO     SFPAL005
SFPAL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFPAL090
          MATCH    PRGID,SCSLPID
          GOTO     SFPAL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFPAL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPAL020,SFPAL020,SFPAL020,SFPAL103:
                            SFPAL104,SFPAL105,SFPAL106,SFPAL020:
                            SFPAL020,SFPAL020,SFPAL020,SFPAL020:
                            SFPAL020,SFPAL020,SFPAL020,SFPAL020:
                            SFPAL020
          GOTO     SFPAL020
SFPAL090  MOVE     ZERO,ACCEPT
          GOTO     SFPAL001
.
SFPAL101
          MOVE      ZERO,EXIT
          GOTO      SFPAL999
.
SFPAL102
          CALL      SC00L000
          MOVE      ZERO,EXIT
          GOTO      SFPAL999
.
SFPAL103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCCCAB00
          MOVE      CCCAYEAR,BUDYEAR
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPAL103
            ENDIF
            BRANCH    EXIT,SFPAL103,SFPAL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPAL990 IF EQUAL
          ENDIF
          MOVE      BUDYEAR,VAR      
          CALL      DISPITEM
          GOTO     SFPAL001
.
SFPAL104
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCCMAA00
          MOVE      CCMACOM,BUDMODL
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPAL104
            ENDIF
            BRANCH    EXIT,SFPAL104,SFPAL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPAL990 IF EQUAL
          ENDIF
          MOVE      BUDMODL,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCMADES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFPAL001
.
SFPAL105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCCCAB00
          MOVE      CCCAYEAR,ACTYEAR
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPAL105
            ENDIF
            BRANCH    EXIT,SFPAL105,SFPAL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPAL990 IF EQUAL
          ENDIF
          MOVE      ACTYEAR,VAR      
          CALL      DISPITEM
          GOTO     SFPAL001
.
SFPAL106
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CCMADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCCMAA00
          MOVE      CCMACOM,ACTMODL
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SFPAL106
            ENDIF
            BRANCH    EXIT,SFPAL106,SFPAL990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SFPAL990 IF EQUAL
          ENDIF
          MOVE      ACTMODL,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CCMADES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SFPAL001
SFPAL990  MOVE      FOUR,EXIT * Exit Char Exit
SFPAL999  RETURN
.--------------------------------
. Screen - Patient Service Analysis           
.--------------------------------
SCPCL000
SCPCL100
          MOVE      "PC",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 8",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCPCL200
          CALL      CFPCL000 * Clear Fields
SCPCL300
          CALL      KYPCL000 * Enter Key Fields
          BRANCH    EXIT,SCPCL999,SCPCL999
SCPCL400
          CALL      WPPCL000 * Load any WP Details
SCPCL500
          CALL      LMPCL000 * Load any Batch Details
SCPCL600
          CALL      DFPCL000 * Display Fields
SCPCL700
          CALL      SFPCL000 * Select Fields
          BRANCH    EXIT,SCPCL100,SCPCL100,SCPCL200
SCPCL800
SCPCL900
SCPCL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Patient Service Analysis           
.-------------------------------------------------------
CFPCL000
CFPCL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Patient Service Analysis           
.--------------------------------------------------------
KYPCL000
          MOVE      ZERO,EXIT
          GOTO      KYPCL999
.
KYPCL900  MOVE      ONE,EXIT
KYPCL999  RETURN
.---------------------------------------------------------
. Load WP files for : Patient Service Analysis           
.---------------------------------------------------------
WPPCL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Patient Service Analysis           
.---------------------------------------------------------
LMPCL000
.---------------------------------------------------------
. Load for :     5 Date of Service                    
.---------------------------------------------------------
          PACK      KEY31,CCEPHCD,CCEPEPS,SP70
          MOVE      KEY31,CCUP2EKY
          MOVE      CCUP2EKY,CCUP2SKY
          STRIP     CCUP2SKY
          SETLPTR   CCUP2EKY,18
          CALL      RDCCUP2 
          IF        OVRCD=0
            CALL      RPCCUP2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPPCL000
          MOVE     ZERO,CCUP2CNT
          MOVE     ZERO,CCUP2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPPCL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPPCL600
          MATCH    PRGID,SCPSPID
          GOTO     DPPCL600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPPCL600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPPCL010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPPCL010,DPPCL010,DPPCL010,DPPCL010:
                            DPPCL101,DPPCL102,DPPCL103,DPPCL104:
                            DPPCL105,DPPCL106,DPPCL107,DPPCL108:
                            DPPCL109,DPPCL110,DPPCL111,DPPCL112:
                            DPPCL113,DPPCL114,DPPCL115,DPPCL116:
                            DPPCL117,DPPCL118,DPPCL119,DPPCL120:
                            DPPCL121,DPPCL122,DPPCL123,DPPCL124:
                            DPPCL010,DPPCL010,DPPCL010,DPPCL010:
                            DPPCL010,DPPCL010,DPPCL010,DPPCL010:
                            DPPCL010
          GOTO      DPPCL010
.
DPPCL101
          IF        CCUP2END=0
            CALL      RKCCUP2 
            IF        OVRCD=0
              PACK      CCUP2MKY,CCUPHCD,CCUPENC,CCUPDAT,CCUPTIM                                                
              MATCH     CCUP2EKY,CCUP2MKY
              IF        @EQUAL
                MOVE      ZERO,CCUP2END
                ADD       ONE,CCUP2CNT
                UNPACK    CCUPDAT,CCENT,CYEAR,CMON,CDAY           
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
          CALL      GETDAT00
              ELSE
                MOVE      ONE,CCUP2END
              ENDIF
            ELSE
              MOVE      ONE,CCUP2END
            ENDIF
          ENDIF
          IF        CCUP2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL102
          IF        CCUP2END=0
            MOVE      CCUPRUN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL103
          IF        CCUP2END=0
            MOVE      CCUPREC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL104
          IF        CCUP2END=0
            MOVE      CCUPDPT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL105
          IF        CCUP2END=0
            MOVE      CCUPPCD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL106
          IF        CCUP2END=0
            MOVE      CCUPURN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL107
          IF        CCUP2END=0
            MOVE      CCPDDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL108
          IF        CCUP2END=0
            MOVE      CCUPTIM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL109
          IF        CCUP2END=0
            MOVE      CCUPQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL110
          IF        CCUP2END=0
            MOVE      CCUPCHG,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL111
          IF        CCUP2END=0
            MOVE      CCUPCL1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL112
          IF        CCUP2END=0
            MOVE      CCUPCL2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL113
          IF        CCUP2END=0
            MOVE      CCUPCL3,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL114
          IF        CCUP2END=0
            MOVE      CCUPCL4,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL115
          IF        CCUP2END=0
            MOVE      CCUPCL5,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL116
          IF        CCUP2END=0
            MOVE      UNIT1AMT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL117
          IF        CCUP2END=0
            MOVE      COST1AMT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL118
          IF        CCUP2END=0
            MOVE      UNIT2AMT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL119
          IF        CCUP2END=0
            MOVE      COST2AMT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL120
          IF        CCUP2END=0
            MOVE      UNIT3AMT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL121
          IF        CCUP2END=0
            MOVE      COST3AMT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL122
          IF        CCUP2END=0
            MOVE      CCUPHCD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL123
          IF        CCUP2END=0
            MOVE      CCDPDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
.
DPPCL124
          IF        CCUP2END=0
            MOVE      CCPDDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPPCL010
DPPCL600
          MATCH    "CCUP2",NAMSSFFI
          GOTO     DPPCL605 IF NOT EQUAL
          GOTO     DPPCL999
DPPCL605
DPPCL999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPPCL000
.
          MATCH    "CCUP2",NAMSSFFI
          GOTO     FPPCL105 IF NOT EQUAL
          PACK     KEY31,CCUP2SKY,SP70
          CALL     RDCCUP2  * Start
          IF       OVRCD=0
            CALL     RPCCUP2  * Start
          ENDIF
          CALL     DPPCL000
          GOTO     FPPCL999
FPPCL105
FPPCL999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPPCL000
.
          MATCH    "CCUP2",NAMSSFFI
          GOTO     LPPCL105 IF NOT EQUAL
          PACK     KEY31,CCUP2SKY,Z70
          CALL     RSCCUP2  * End
          IF       OVRCD=1
            CALL     RPCCUP2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCUP2SNO
            CALL     RPCCUP2 
            IF       OVRCD=1
              MOVE     CCUP2SNO,SECTOR
            ENDIF
            PACK     CCUP2MKY,CCUPHCD,CCUPENC,CCUPDAT,CCUPTIM                                                
            MATCH    CCUP2EKY,CCUP2MKY
            IF       !@EQUAL
              MOVE     CCUP2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPPCL000
          GOTO     LPPCL999
LPPCL105
LPPCL999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPPCL000
.
          MATCH    "CCUP2",NAMSSFFI
          GOTO     PPPCL120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PPPCL105
          COMPARE  SECTOR,CCUP2SNO
          GOTO     PPPCL110 IF EQUAL
          CALL     RPCCUP2 
          BRANCH   OVRCD,PPPCL115
          PACK     CCUP2MKY,CCUPHCD,CCUPENC,CCUPDAT,CCUPTIM                                                
          MATCH    CCUP2EKY,CCUP2MKY
          GOTO     PPPCL115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PPPCL105
PPPCL110
          MOVE     ZERO,SECTOR
          IF       CCUP2CNT=CCUP2SNO
            SUB      ONE,CCUP2CNT
          ENDIF
          WHILE    SECTOR<=CCUP2CNT
            CALL     RPCCUP2 
            IF       OVRCD=1
              MOVE     CCUP2SNO,SECTOR
            ENDIF
            PACK     CCUP2MKY,CCUPHCD,CCUPENC,CCUPDAT,CCUPTIM                                                
            MATCH    CCUP2EKY,CCUP2MKY
            IF       !@EQUAL
              MOVE     CCUP2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DPPCL000
          GOTO     PPPCL999
PPPCL115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<CCUP2SNO
            CALL     RKCCUP2 
            IF       OVRCD=1
              MOVE     CCUP2SNO,SECTOR
            ENDIF
            PACK     CCUP2MKY,CCUPHCD,CCUPENC,CCUPDAT,CCUPTIM                                                
            MATCH    CCUP2EKY,CCUP2MKY
            IF       !@EQUAL
              MOVE     CCUP2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PPPCL999
PPPCL120
PPPCL999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPPCL000
          MATCH    "CCUP2",NAMSSFFI
          GOTO     NPPCL115 IF NOT EQUAL
NPPCL105
          CALL     RKCCUP2 
          BRANCH   OVRCD,NPPCL110
          PACK     CCUP2MKY,CCUPHCD,CCUPENC,CCUPDAT,CCUPTIM                                                
          MATCH    CCUP2EKY,CCUP2MKY
          GOTO     NPPCL110 IF NOT EQUAL
          CALL     RPCCUP2 
          CALL     DPPCL000
          GOTO     NPPCL999
NPPCL110
          CALL     RPCCUP2 
          BEEP
          GOTO     NPPCL999
NPPCL115
NPPCL999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTPCL000
CTPCL105
CTPCL999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Patient Service Analysis           
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Patient Service Analysis           
.---------------------------------------------------------
DFPCL000
          BRANCH   ACCEPT,DFPCL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFPCL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFPCL900
          MATCH    PRGID,SCPSPID
          GOTO     DFPCL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFPCL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFPCL010 IF NOT EQUAL
.
          CALL     PSPCL000 * Display Field
          GOTO     DFPCL010
DFPCL900
          MOVE      "CCUP2",NAMSSFFI
          MOVE      "    5",ITMSSFFI
          CALL      FPPCL000
DFPCL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Patient Service Analysis           
.---------------------------------------------------------
PSPCL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSPCL999,PSPCL999,PSPCL999,PSPCL999:
                            PSPCL999,PSPCL999,PSPCL999,PSPCL999:
                            PSPCL999,PSPCL999,PSPCL999,PSPCL999:
                            PSPCL999,PSPCL999,PSPCL999,PSPCL999:
                            PSPCL999,PSPCL999,PSPCL999,PSPCL999:
                            PSPCL999,PSPCL999,PSPCL999,PSPCL999:
                            PSPCL999,PSPCL999,PSPCL999,PSPCL999:
                            PSPCL999,PSPCL999,PSPCL999,PSPCL999:
                            PSPCL999,PSPCL999,PSPCL999,PSPCL101:
                            PSPCL102
          GOTO     PSPCL999
.
PSPCL101
          MOVE      F4x,VAR          
          CALL      DISPITEM
          GOTO     PSPCL999
.
PSPCL102
          MOVE      F8x,VAR          
          CALL      DISPITEM
          GOTO     PSPCL999
PSPCL999
          RETURN
.---------------------------------------------------------
. Selections for : Patient Service Analysis           
.---------------------------------------------------------
SFPCL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFPCL001  BRANCH   ACCEPT,SFPCL020
.
SFPCL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPCL006,SFPCL101,SFPCL102,SFPCL103:
                            SFPCL006,SFPCL006,SFPCL006,SFPCL006:
                            SFPCL006,SFPCL006,SFPCL006,SFPCL006:
                            SFPCL006,SFPCL006,SFPCL006,SFPCL006:
                            SFPCL006,SFPCL006,SFPCL006,SFPCL006:
                            SFPCL006,SFPCL006,SFPCL006,SFPCL006:
                            SFPCL006,SFPCL006,SFPCL006,SFPCL006:
                            SFPCL006,SFPCL006,SFPCL104,SFPCL105:
                            SFPCL106,SFPCL107,SFPCL108,SFPCL006:
                            SFPCL006
SFPCL006  BEEP
          GOTO     SFPCL005
SFPCL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFPCL090
          MATCH    PRGID,SCSLPID
          GOTO     SFPCL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFPCL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPCL020,SFPCL020,SFPCL020,SFPCL020:
                            SFPCL020,SFPCL020,SFPCL020,SFPCL020:
                            SFPCL020,SFPCL020,SFPCL020,SFPCL020:
                            SFPCL020,SFPCL020,SFPCL020,SFPCL020:
                            SFPCL020,SFPCL020,SFPCL020,SFPCL020:
                            SFPCL020,SFPCL020,SFPCL020,SFPCL020:
                            SFPCL020,SFPCL020,SFPCL020,SFPCL020:
                            SFPCL020,SFPCL020,SFPCL020,SFPCL020:
                            SFPCL020,SFPCL020,SFPCL020,SFPCL020:
                            SFPCL020
          GOTO     SFPCL020
SFPCL090  MOVE     ZERO,ACCEPT
          MOVE      "CCUP2",NAMSSFFI
          MOVE      "    5",ITMSSFFI
          CALL      FPPCL000
          GOTO     SFPCL001
.
SFPCL101
          MOVE      ZERO,EXIT
          GOTO      SFPCL999
.
SFPCL102
          CALL      RESTARTP
          MOVE      ZERO,EXIT
          GOTO      SFPCL999
.
SFPCL103
          CALL      SCDGL000
          MOVE      ONE,EXIT
          GOTO      SFPCL999
.
SFPCL104
          MOVE      "CCUP2",NAMSSFFI
          MOVE      "    5",ITMSSFFI
          CALL      NPPCL000
          GOTO     SFPCL001
.
SFPCL105
          MOVE      "CCUP2",NAMSSFFI
          MOVE      "    5",ITMSSFFI
          CALL      PPPCL000
          GOTO     SFPCL001
.
SFPCL106
          MOVE      "CCUP2",NAMSSFFI
          MOVE      "    5",ITMSSFFI
          CALL      FPPCL000
          GOTO     SFPCL001
.
SFPCL107
          MOVE      "CCUP2",NAMSSFFI
          MOVE      "    5",ITMSSFFI
          CALL      LPPCL000
          GOTO     SFPCL001
.
SFPCL108
          CALL      SELRUN00
          MOVE      ONE,EXIT
          GOTO      SFPCL999
SFPCL990  MOVE      ONE,EXIT * Exit Char Restart
SFPCL999  RETURN
.--------------------------------
. Screen - Patient Service Details            
.--------------------------------
SCPDL000
SCPDL100
          MOVE      "PD",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 9",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SCPDL200
          CALL      CFPDL000 * Clear Fields
SCPDL300
          CALL      KYPDL000 * Enter Key Fields
          BRANCH    EXIT,SCPDL999,SCPDL999
SCPDL400
          CALL      WPPDL000 * Load any WP Details
SCPDL500
          CALL      LMPDL000 * Load any Batch Details
SCPDL600
          CALL      DFPDL000 * Display Fields
SCPDL700
          CALL      SFPDL000 * Select Fields
          BRANCH    EXIT,SCPDL100,SCPDL100,SCPDL200
SCPDL800
SCPDL900
SCPDL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Patient Service Details            
.-------------------------------------------------------
CFPDL000
CFPDL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Patient Service Details            
.--------------------------------------------------------
KYPDL000
          MOVE      ZERO,EXIT
          GOTO      KYPDL999
.
KYPDL900  MOVE      ONE,EXIT
KYPDL999  RETURN
.---------------------------------------------------------
. Load WP files for : Patient Service Details            
.---------------------------------------------------------
WPPDL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Patient Service Details            
.---------------------------------------------------------
LMPDL000
          RETURN
.---------------------------------------------------------
. Display Fields for : Patient Service Details            
.---------------------------------------------------------
DFPDL000
          BRANCH   ACCEPT,DFPDL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFPDL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFPDL900
          MATCH    PRGID,SCPSPID
          GOTO     DFPDL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFPDL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFPDL010 IF NOT EQUAL
.
          CALL     PSPDL000 * Display Field
          GOTO     DFPDL010
DFPDL900
DFPDL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Patient Service Details            
.---------------------------------------------------------
PSPDL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSPDL999,PSPDL999,PSPDL101,PSPDL102:
                            PSPDL103,PSPDL104,PSPDL105,PSPDL106:
                            PSPDL107,PSPDL108,PSPDL109,PSPDL110:
                            PSPDL111,PSPDL112,PSPDL113,PSPDL114:
                            PSPDL115,PSPDL116,PSPDL117,PSPDL118:
                            PSPDL119,PSPDL120,PSPDL121,PSPDL122:
                            PSPDL123,PSPDL124,PSPDL125
          GOTO     PSPDL999
.
PSPDL101
          MOVE      CCUPRUN,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL102
          MOVE      CCUPREC,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL103
          MOVE      CCUPHCD,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL104
          MOVE      CCUPDPT,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL105
          MOVE      CCUPPCD,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL106
          MOVE      CCUPENC,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL107
          MOVE      CCUPURN,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL108
          UNPACK    CCUPDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL109
          MOVE      CCUPTIM,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL110
          MOVE      CCUPQTY,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL111
          MOVE      CCUPCHG,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL112
          MOVE      CCUPCL1,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL113
          MOVE      CCUPCL2,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL114
          MOVE      CCUPCL3,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL115
          MOVE      CCUPCL4,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL116
          MOVE      CCUPCL5,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL117
          MOVE      CCHCDES,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL118
          MOVE      CCDPDES,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL119
          MOVE      CCPDDES,VAR      
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL120
          MOVE      UNIT1AMT,VAR     
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL121
          MOVE      COST1AMT,VAR     
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL122
          MOVE      UNIT2AMT,VAR     
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL123
          MOVE      COST2AMT,VAR     
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL124
          MOVE      UNIT3AMT,VAR     
          CALL      DISPITEM
          GOTO     PSPDL999
.
PSPDL125
          MOVE      COST3AMT,VAR     
          CALL      DISPITEM
          GOTO     PSPDL999
PSPDL999
          RETURN
.---------------------------------------------------------
. Selections for : Patient Service Details            
.---------------------------------------------------------
SFPDL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFPDL001  BRANCH   ACCEPT,SFPDL020
.
SFPDL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPDL006,SFPDL101,SFPDL006,SFPDL006:
                            SFPDL006,SFPDL006,SFPDL006,SFPDL006:
                            SFPDL006,SFPDL006,SFPDL006,SFPDL006:
                            SFPDL006,SFPDL006,SFPDL006,SFPDL006:
                            SFPDL006,SFPDL006,SFPDL006,SFPDL006:
                            SFPDL006,SFPDL006,SFPDL006,SFPDL006:
                            SFPDL006,SFPDL006,SFPDL006
SFPDL006  BEEP
          GOTO     SFPDL005
SFPDL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFPDL090
          MATCH    PRGID,SCSLPID
          GOTO     SFPDL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFPDL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFPDL020,SFPDL020,SFPDL020,SFPDL020:
                            SFPDL020,SFPDL020,SFPDL020,SFPDL020:
                            SFPDL020,SFPDL020,SFPDL020,SFPDL020:
                            SFPDL020,SFPDL020,SFPDL020,SFPDL020:
                            SFPDL020,SFPDL020,SFPDL020,SFPDL020:
                            SFPDL020,SFPDL020,SFPDL020,SFPDL020:
                            SFPDL020,SFPDL020,SFPDL020
          GOTO     SFPDL020
SFPDL090  MOVE     ZERO,ACCEPT
          GOTO     SFPDL001
.
SFPDL101
          MOVE      ZERO,EXIT
          GOTO      SFPDL999
SFPDL990  MOVE      ONE,EXIT * Exit Char Restart
SFPDL999  RETURN
.@@@@@ Function Restart Point @@@@@
.--------------------------------------------------
. Calculate Episode Costs
.--------------------------------------------------
MAKDPT00  DISPLAY   *P1:24,*EL,"Calculating Episode Costs"
          CALL      CLRDPT00
          MOVE      ZERO,TOT1AMT
          MOVE      ZERO,TOT2AMT
          MOVE      ZERO,TOT3AMT
          PACK      KEY31,CCEPHCD,CCEPEPS,SP70
          CALL      RSCCUP2
MAKDPT10  CALL      RKCCUP2
          BRANCH    OVRCD,MAKDPT90
          MATCH     CCEPHCD,CCUPHCD
          GOTO      MAKDPT90 IF NOT EQUAL
          MATCH     CCEPEPS,CCUPENC
          GOTO      MAKDPT90 IF NOT EQUAL
.
          CALL      CALACT00 * Calculate 1 Actual
          CALL      CALBUD00 * Calculate 2 Budget
          CALL      CALSTD00 * Calculate 3 Standard Cost
          PACK      KEY12,PORT,CCUPHCD,CCUPDPT
          CALL      RDCCDE1
          IF        OVRCD=0
            ADD       CCUPQTY,CCDENUM
            ADD       COST1AMT,CCDEACT
            ADD       COST2AMT,CCDEBUD
            ADD       COST3AMT,CCDESTD
            CALL      UPCCDE1
          ELSE
            UNPACK    KEY12,CCDEPORT,CCDEHCD,CCDEDPT
            PACK      KEY10,CCUPHCD,CCUPDPT
            CALL      RDCCDP1
            MOVE      CCUPQTY,CCDENUM
            MOVE      CCDPDES,CCDEDES
            MOVE      COST1AMT,CCDEACT
            MOVE      COST2AMT,CCDEBUD
            MOVE      COST3AMT,CCDESTD
            CALL      WRCCDE1
          ENDIF
          ADD       COST1AMT,TOT1AMT
          ADD       COST2AMT,TOT2AMT
          ADD       COST3AMT,TOT3AMT
          GOTO      MAKDPT10
.
MAKDPT90  CALL      SCDAL000
.
          RETURN
.------------------------------------------------------------
. Calculate Actual
.------------------------------------------------------------
CALACT00  PACK      KEY18,ACTYEAR,ACTMODL,CCUPHCD,CCUPPCD
          CALL      RDCCMS1
          IF        OVRCD=1
            PACK      KEY26,ACTYEAR,ACTMODL,CCUPHCD,CCUPDPT,CCUPPCD
            CALL      RDCCMT1
            IF        OVRCD=1
              MOVE      ZERO,CCMSUCT
              MOVE      ZERO,CCMSFIX
              MOVE      ZERO,CCMSFUC
            ELSE
              MOVE      CCMTUCT,CCMSUCT
              MOVE      CCMTFIX,CCMSFIX
              MOVE      CCMTFUC,CCMSFUC
            ENDIF
          ENDIF
          IF        CCMSFIX=1
            MOVE      CCMSFUC,UNIT1AMT
            ASSIGN    CCUPQTY*CCMSFUC,COST1AMT
          ELSE
            MOVE      CCMSFUC,UNIT1AMT
            ASSIGN    CCUPQTY*CCMSUCT,COST1AMT
          ENDIF
          RETURN
.------------------------------------------------------------
. Calculate Budget
.------------------------------------------------------------
CALBUD00  PACK      KEY18,BUDYEAR,BUDMODL,CCUPHCD,CCUPPCD
          CALL      RDCCMS1
          IF        OVRCD=1
            PACK      KEY26,BUDYEAR,BUDMODL,CCUPHCD,CCUPDPT,CCUPPCD
            CALL      RDCCMT1
            IF        OVRCD=1
              MOVE      ZERO,CCMSUCT
              MOVE      ZERO,CCMSFIX
              MOVE      ZERO,CCMSFUC
            ELSE
              MOVE      CCMTUCT,CCMSUCT
              MOVE      CCMTFIX,CCMSFIX
              MOVE      CCMTFUC,CCMSFUC
            ENDIF
          ENDIF
          IF        CCMSFIX=1
            MOVE      CCMSFUC,UNIT2AMT
            ASSIGN    CCUPQTY*CCMSFUC,COST2AMT
          ELSE
            MOVE      CCMSUCT,UNIT2AMT
            ASSIGN    CCUPQTY*CCMSUCT,COST2AMT
          ENDIF
          RETURN
.------------------------------------------------------------
. Calculate Standard Cost
.------------------------------------------------------------
CALSTD00  PACK      KEY18,CCUPHCD,CCUPDPT,CCUPPCD
          CALL      RDCCPD1
          IF        OVRCD=1
            MOVE      ZERO,CCPDSTC
          ENDIF
          MOVE      CCPDSTC,UNIT3AMT
          ASSIGN    CCUPQTY*CCPDSTC,COST3AMT
          RETURN
.
.------------------------------------------------------------
. Clear Department Select
.------------------------------------------------------------
CLRDPT00   PACK    KEY12,PORT,SP70
           CALL    RSCCDE1
.
CLRDPT10   CALL    RKCCDE1
           BRANCH  OVRCD,CLRDPT90
           MATCH   PORT,CCDEPORT
           GOTO    CLRDPT90 IF NOT EQUAL
           PACK    KEY12,CCDEPORT,CCDEHCD,CCDEDPT
           CALL    DECCDE1
           GOTO    CLRDPT10
.
CLRDPT90   RETURN
.
.------------------------------------------------------------
.  Enter Split Cost Model ID
.------------------------------------------------------------
ESMOD000  CALL      KCCSPA00                * Call Standard Keyin Routine with ?
          BRANCH    EXIT,ESMOD999,ESMOD999  * Exit 1 Null Entry 2 Exitchar
.
          CALL      CLRTOT00
.
          PACK      KEY18,CCEPHCD,CCEPEPS
          CALL      RDCCIA1
          PACK      KEY21,CCEPHCD,CCEPEPS,CCSPMID
          CALL      RDCCRB1
          BRANCH    OVRCD,ESMOD999
.
          ASSIGN    CCRBFDR+CCRBFID+CCRBVDR+CCRBVID,TOTCOST
          ASSIGN    TOTCOST-CCIAIA1,TOTVARI                            * V90200
.
ESMOD999  RETURN
.
CLRTOT00  MOVE      ZERO,TOTVARI
          MOVE      ZERO,TOTCOST
          MOVE      ZERO,CCRBFDR
          MOVE      ZERO,CCRBFID
          MOVE      ZERO,CCRBVDR
          MOVE      ZERO,CCRBVID
          RETURN
.
.------------------------------------------------------------
. Print Patient Cost Analysis Report
.------------------------------------------------------------
REPT0000  MOVE      ZERO,CPAGENO
          CLOCK     TIME,CTIMEIS
          MOVE      "90",CLNO
          MOVE      "1",REPTLEV
          MOVE      ZERO,TOTALFDR
          MOVE      ZERO,TOTALFID
          MOVE      ZERO,TOTALVDR
          MOVE      ZERO,TOTALVID
          MOVE      ZERO,TOTAL
.
          CALL      MKTEMP00
.
          PACK      KEY31,CCEPHCD,CCEPEPS,SP70
          CALL      RSCCUP2
REPT1000  CALL      RKCCUP2
          BRANCH    OVRCD,REPT1900
          MATCH     CCUPHCD,CCEPHCD
          GOTO      REPT1900 IF NOT EQUAL
          MATCH     CCUPENC,CCEPEPS
          GOTO      REPT1900 IF NOT EQUAL
.
          UNPACK    CCUPDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
          PACK      KEY18,CCUPHCD,CCUPDPT,CCUPPCD
          CALL      RDCCPD1
.
          MOVE      ZERO,CCRAFDR
          MOVE      ZERO,CCRAFID
          MOVE      ZERO,CCRAVDR
          MOVE      ZERO,CCRAVID
          PACK      KEY21,CCSPMID,CCUPHCD,CCUPDPT,CCUPPCD
          CALL      RDCCRA1
.
          ADD       ONE,CLNO
          COMPARE   "55",CLNO
          CALL      HEAD0000 IF NOT LESS
.
          ASSIGN    (CCRAFDR*CCUPQTY),DPSUFDR
          ASSIGN    (CCRAFID*CCUPQTY),DPSUFID
          ASSIGN    (CCRAVDR*CCUPQTY),DPSUVDR
          ASSIGN    (CCRAVID*CCUPQTY),DPSUVID
          ASSIGN    DPSUFDR+DPSUFID+DPSUVDR+DPSUVID,AMOUNT
          ADD       DPSUFDR,TOTALFDR
          ADD       DPSUFID,TOTALFID
          ADD       DPSUVDR,TOTALVDR
          ADD       DPSUVID,TOTALVID
          ADD       AMOUNT,TOTAL
.
          PRINT     CCUPPCD,SP1,CCPDDES,CCUPQTY:
                    DPSUVDR,DPSUFDR,DPSUVID,DPSUFID,AMOUNT
.          PRINT     CPCDATE,SP1,CCUPTIM,SP1,CCUPHCD,SP1,CCUPDPT,SP1,CCUPPCD:
.                    SP1,CCPDDES,SP1:
.                    CCUPQTY,SP1,PRICE,SP1,AMOUNT
.
          PACK      KEY10,CCUPHCD,CCUPDPT
          UNPACK    KEY10,DPSUHCD,DPSUDPT
          CALL      RDDPSU1
          IF        OVRCD=0
            ADD       CCUPQTY,DPSUNUM
            ASSIGN    DPSUFDR+(CCRAFDR*CCUPQTY),DPSUFDR
            ASSIGN    DPSUFID+(CCRAFID*CCUPQTY),DPSUFID
            ASSIGN    DPSUVDR+(CCRAVDR*CCUPQTY),DPSUVDR
            ASSIGN    DPSUVID+(CCRAVID*CCUPQTY),DPSUVID
            CALL      UPDPSU1
          ELSE
            MOVE      CCUPQTY,DPSUNUM
            ASSIGN    (CCRAFDR*CCUPQTY),DPSUFDR
            ASSIGN    (CCRAFID*CCUPQTY),DPSUFID
            ASSIGN    (CCRAVDR*CCUPQTY),DPSUVDR
            ASSIGN    (CCRAVID*CCUPQTY),DPSUVID
            CALL      WRDPSU1
          ENDIF
.
          GOTO      REPT1000
REPT1900  CALL      UND132
          PRINT     SP2,SP1,SP8,SP1,SP30,SP5,SP1:
                    TOTALVDR,TOTALFDR,TOTALVID,TOTALFID,TOTAL
          CALL      UND132
.
          MOVE      ZERO,TOTALFDR
          MOVE      ZERO,TOTALFID
          MOVE      ZERO,TOTALVDR
          MOVE      ZERO,TOTALVID
          MOVE      ZERO,TOTAL
          MOVE      "90",CLNO
          MOVE      "2",REPTLEV
          PACK      KEY10,SP70
          CALL      RSDPSU1
REPT2000  CALL      RKDPSU1
          BRANCH    OVRCD,REPT2900
          PACK      KEY10,DPSUHCD,DPSUDPT
          CALL      RDCCDP1
          ASSIGN    DPSUFDR+DPSUFID+DPSUVDR+DPSUVID,AMOUNT
          ADD       DPSUFDR,TOTALFDR
          ADD       DPSUFID,TOTALFID
          ADD       DPSUVDR,TOTALVDR
          ADD       DPSUVID,TOTALVID
          ADD       AMOUNT,TOTAL
          ADD       ONE,CLNO
          COMPARE   "55",CLNO
          CALL      HEAD0000 IF NOT LESS
          PRINT     DPSUHCD,SP1,DPSUDPT,SP1,CCDPDES,SP1:
                    DPSUVDR,DPSUFDR,DPSUVID,DPSUFID,AMOUNT
          GOTO      REPT2000
REPT2900  CALL      UND132
          PRINT     SP2,SP1,SP8,SP1,SP30,SP5,SP1:
                    TOTALVDR,TOTALFDR,TOTALVID,TOTALFID,TOTAL
          CALL      UND132
.
          CLOSE     DPTSUMA1,DELETE
.
REPT9999  RETURN
.
HEAD0000  CALL      HEAD132
          UNPACK    CCEPADAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,KEY10
          UNPACK    CCEPDDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          PACK      KEY18,CCEPHCD,CCEPEPS
          CALL      RDCCIA1
          IF        OVRCD=1
            MOVE      ZERO,CCIAIA1                                     * V90200
          ENDIF
          PRINT     "Hospital/Episode : ",CCEPHCD,"/",CCEPEPS:
                    SP1,CCEPSUR,SP1,CCEPGIV:
                 *N,"Admission       : ",KEY10,"  Discharge : ",CPCDATE:
                 *N,"Length of Stay  : ",CCEPLOS:
                 *N,"Income          : ",CCIAIA1                       * V90200
          CALL      UND132
          IF        REPTLEV=1
            PRINT     "Procedure                                         Qty":
                      "     Dir Var        Dir Fix        Ind Var        I":
                      "nd Fix          Total"
..            PRINT     "  Date     Time  Hospital Department Procedure     ":
..                      "                        Quantity           Price   ":
..                      "        Total"
          ELSE
            PRINT     "Department                                         ":
                      "     Dir Var        Dir Fix        Ind Var        I":
                      "nd Fix          Total"
          ENDIF
          CALL      UND132
          RETURN
.
MKTEMP00  MOVE      "CCR49T",KEY6
          PACK      KEY8,KEY6,PORT
          REP       " 0",KEY8
          CLEAR     KEY80
          APPEND    "isbuild ",KEY80
          APPEND    KEY8,KEY80
          APPEND    " 100 U1-2,3-10",KEY80
          RESET     KEY80
          EXECUTE   KEY80,TASKID
          OPEN      DPTSUMA1,KEY8
          RETURN
.
RSDPSU1   READ      DPTSUMA1,KEY10;;
          RETURN
.
RADPSU1   MOVE      ZERO,OVRCD
          READ      DPTSUMA1,KEY10;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
RDDPSU1   MOVE      ZERO,OVRCD
          READ      DPTSUMA1,KEY10;DPSUHCD,DPSUDPT,DPSUNUM,DPSUFDR:
                                   DPSUFID,DPSUVDR,DPSUVID
          GOTO      OVERCOND IF OVER
          RETURN
.
RKDPSU1   MOVE      ZERO,OVRCD
          READKS    DPTSUMA1;DPSUHCD,DPSUDPT,DPSUNUM,DPSUFDR:
                                   DPSUFID,DPSUVDR,DPSUVID
          GOTO      OVERCOND IF OVER
          RETURN
.
UPDPSU1   UPDATE    DPTSUMA1;DPSUHCD,DPSUDPT,DPSUNUM,DPSUFDR:
                                   DPSUFID,DPSUVDR,DPSUVID
          RETURN
.
WRDPSU1   WRITE     DPTSUMA1,KEY10;DPSUHCD,DPSUDPT,DPSUNUM,DPSUFDR:
                                   DPSUFID,DPSUVDR,DPSUVID
          RETURN
.--------------------------------------------------
. Selected Department Analysis
.--------------------------------------------------
SELDPT00  CALL       RDCCDE1
          IF         OVRCD=1
            BEEP
            GOTO       SELDPT99
          ENDIF
.
          CALL       MAKPCD00
.
SELDPT99  RETURN
.--------------------------------------------------
. Calculate Episode Costs
.--------------------------------------------------
MAKPCD00  DISPLAY   *P1:24,*EL,"Calculating Procedure Costs"
          CALL      CLRPCD00
          MOVE      ZERO,TOT1AMT
          MOVE      ZERO,TOT2AMT
          MOVE      ZERO,TOT3AMT
          PACK      KEY31,CCEPHCD,CCEPEPS,SP70
          CALL      RSCCUP2
MAKPCD10  CALL      RKCCUP2
          BRANCH    OVRCD,MAKPCD90
          MATCH     CCEPHCD,CCUPHCD
          GOTO      MAKPCD90 IF NOT EQUAL
          MATCH     CCEPEPS,CCUPENC
          GOTO      MAKPCD90 IF NOT EQUAL
.
          MATCH     CCUPHCD,CCDEHCD
          GOTO      MAKPCD10 IF NOT EQUAL
          MATCH     CCUPDPT,CCDEDPT
          GOTO      MAKPCD10 IF NOT EQUAL
.
          CALL      CALACT00 * Calculate 1 Actual
          CALL      CALBUD00 * Calculate 2 Budget
          CALL      CALSTD00 * Calculate 3 Standard Cost
          PACK      KEY10,PORT,CCUPPCD,SP70
          CALL      RDCCPA1
          IF        OVRCD=0
            ADD       CCUPQTY,CCPANUM
            ADD       COST1AMT,CCPAACT
            ADD       COST2AMT,CCPABUD
            ADD       COST3AMT,CCPASTD
            CALL      UPCCPA1
          ELSE
            UNPACK    KEY10,CCPAPORT,CCPAPCD
            PACK      KEY18,CCUPHCD,CCUPDPT,CCUPPCD
            CALL      RDCCPD1
            MOVE      CCUPQTY,CCPANUM
            MOVE      CCPDDES,CCPADES
            MOVE      COST1AMT,CCPAACT
            MOVE      COST2AMT,CCPABUD
            MOVE      COST3AMT,CCPASTD
            CALL      WRCCPA1
          ENDIF
          GOTO      MAKPCD10
.
MAKPCD90  CALL      SCDDL000
.
          RETURN
.------------------------------------------------------------
. Clear Department Select
.------------------------------------------------------------
CLRPCD00   PACK    KEY10,PORT,SP70
           CALL    RSCCPA1
.
CLRPCD10   CALL    RKCCPA1
           BRANCH  OVRCD,CLRPCD90
           MATCH   PORT,CCPAPORT
           GOTO    CLRPCD90 IF NOT EQUAL
           PACK    KEY10,CCPAPORT,CCPAPCD
           CALL    DECCPA1
           GOTO    CLRPCD10
.
CLRPCD90   RETURN
.
.------------------------------------------------------------
. This will restart a program from any point with out the
. need to clear variables and stacks.
.------------------------------------------------------------
RESTARTP  CHAIN    PRGID
.
.--------------------------------------------------
. Calculate Episode Costs
.--------------------------------------------------
GPHDAT00  CALL    OPNGRAPH
.
          MOVE    "6",GPHNOCOX
          MOVE    "6",GPHNOCOY
          MOVE    ZERO,GPHNTYP
          MOVE    ONE,SECTOR
.
          IF      GPHACT=1
            MOVE    "Actual Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
.
          IF      GPHBUD=1
            MOVE    "Cost Model",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
          IF      GPHSTD=1
            MOVE    "Standard Cost",GPHLEDG[SECTOR]
            ADD     ONE,SECTOR
            ADD     ONE,GPHNTYP
          ENDIF
.
          IF      SECTOR=2
            MOVE    FOUR,GPHBLKX
          ENDIF
          IF      SECTOR=3
            MOVE    TWO,GPHBLKX
          ENDIF
          IF      SECTOR=4
            MOVE    ONE,GPHBLKX
          ENDIF
          IF      GPHNTYP=GPHNOCOY
            ADD     ONE,GPHNOCOX
            ADD     ONE,GPHNOCOY
          ENDIF
.
          IF      GPHNTYP>GPHNOCOY
            MOVE    GPHNTYP,GPHNOCOX
            MOVE    GPHNTYP,GPHNOCOY
            ADD     ONE,GPHNOCOX
            ADD     ONE,GPHNOCOY
          ENDIF
.
          MOVE      ZERO,CCPERCNT
          DISPLAY   *P70:2,*BLINKON," Loading "
.
          CLEAR    GPHNAME
          APPEND   "Cost Analysis by Date for Episode - ",GPHNAME
          APPEND   CCEPEPS,GPHNAME
          RESET    GPHNAME
.
          CALL    DATLOD00
.
          MOVE    ZERO,HLEF
          HLINE   *G37,2,70,80
          CALL    GETSCR00
.
          MOVE    ZERO,GPHTYPE    * 0=XY 1=YX
          CALL    DISGRAPH
          CALL    CLSGRAPH
.
          CALL    PUTSCR00
.
          RETURN
.--------------------------------------------------
. Load Costs by Date
.--------------------------------------------------
DATLOD00  PACK      KEY31,CCEPHCD,CCEPEPS,SP70
          CALL      RSCCUP2
          CALL      RKCCUP2
          MOVE      CCUPDAT,KEY8
          MOVE      ZERO,TOT1AMT
          MOVE      ZERO,TOT2AMT
          MOVE      ZERO,TOT3AMT
.
          PACK      KEY31,CCEPHCD,CCEPEPS,SP70
          CALL      RSCCUP2
DATLOD10  CALL      RKCCUP2
          BRANCH    OVRCD,DATLOD90
          MATCH     CCEPHCD,CCUPHCD
          GOTO      DATLOD90 IF NOT EQUAL
          MATCH     CCEPEPS,CCUPENC
          GOTO      DATLOD90 IF NOT EQUAL
.
          MATCH     CCUPDAT,KEY8
          CALL      DATWRT00 IF NOT EQUAL
.
          IF        GPHACT=1
            CALL      CALACT00 * Calculate 1 Actual
          ENDIF
.
          IF        GPHBUD=1
            CALL      CALBUD00 * Calculate 2 Budget
          ENDIF
.
          IF        GPHSTD=1
             CALL      CALSTD00 * Calculate 3 Standard Cost
          ENDIF
          ADD       COST1AMT,TOT1AMT
          ADD       COST2AMT,TOT2AMT
          ADD       COST3AMT,TOT3AMT
          GOTO      DATLOD10
.
DATLOD90  CALL      DATWRT00
          RETURN
.
DATWRT00  UNPACK    KEY8,CCENT,CYEAR,CMON,CDAY
          PACK      SCGPDES,CDAY,SLASH,CMON
          ADD       ONE,CCPERCNT
          MOVE      CCPERCNT,SCGPPER
          MOVE      ZERO,F3
          IF        GPHACT=1
            MOVE      TOT1AMT,F12P2
            CALL      GRAPHWRT
          ENDIF
          IF        GPHBUD=1
            MOVE      TOT2AMT,F12P2
            CALL      GRAPHWRT
          ENDIF
          IF        GPHSTD=1
            MOVE      TOT3AMT,F12P2
            CALL      GRAPHWRT
          ENDIF
.
          MOVE      CCUPDAT,KEY8
          MOVE      ZERO,TOT1AMT
          MOVE      ZERO,TOT2AMT
          MOVE      ZERO,TOT3AMT
          RETURN
.
GRAPHWRT  ADD     ONE,F3
          MOVE    F3,SCGPITM
          MOVE    F12P2,SCGPVAL
          PACK    KEY6,SCGPPER,SCGPITM
          CALL    RASCGP1
          IF      OVRCD=0
            CALL    UPSCGP1
          ELSE
            CALL    WRSCGP1
          ENDIF
          RETURN
.
.
GPHACT00  IF      GPHACT=0
            MOVE    ONE,GPHACT
          ELSE
            MOVE    ZERO,GPHACT
          ENDIF
          RETURN

.
GPHBUD00  IF      GPHBUD=0
            MOVE    ONE,GPHBUD
          ELSE
            MOVE    ZERO,GPHBUD
          ENDIF
          RETURN

.
GPHSTD00  IF      GPHSTD=0
            MOVE    ONE,GPHSTD
          ELSE
            MOVE    ZERO,GPHSTD
          ENDIF
          RETURN

.----------------------------------------
. Move one to accept to for insert mode
.----------------------------------------
MVACCEPT  MOVE      ONE,ACCEPT
          RETURN
GETDAT00  CALL      CALACT00 * Calculate 1 Actual
          CALL      CALBUD00 * Calculate 2 Budget
          CALL      CALSTD00 * Calculate 3 Standard Cost
          PACK      KEY10,CCUPHCD,CCUPDPT
          CALL      RDCCDP1
          PACK      KEY18,CCUPHCD,CCUPDPT,CCUPPCD
          CALL      RDCCPD1
          RETURN
.------------------------------------------------------------
. Input a Selected Procedure Record
.------------------------------------------------------------
SELRUN00  DISPLAY    *P1:24,*EL,"Enter Run/Record : "
          MOVE       "20",CCOL
          MOVE       "24",CVERT
          CALL       ERUNN000
          BRANCH     EXIT,SELRUN99,SELRUN99

          DISPLAY    *P25:24,*EL,"/"
          MOVE       "26",CCOL
          MOVE       "24",CVERT
          CALL       ERECN000
          BRANCH     EXIT,SELRUN99
.
          CALL       SCPDL000 * Display Details
.
SELRUN99  RETURN
.------------------------------------------------------------
. Keyin Run Number
.------------------------------------------------------------
ERUNN000  KEYIN     *PCCOL:CVERT,*V2LON,*MASK,F4
          IF        F4=0
            MOVE      ONE,EXIT
            GOTO      ERUNN999
          ENDIF
          MOVE      F4,CCUPRUN
          MOVE      F4,KEY4
          PACK      KEY12,KEY4,SP70
          CALL      RSCCUP1
          CALL      RKCCUP1
          BRANCH    OVRCD,ERUNN010
          MATCH     KEY4,CCUPRUN
          GOTO      ERUNN010 IF NOT EQUAL
          MOVE      ZERO,EXIT
          GOTO      ERUNN999
.
ERUNN010  MOVE      "No Records for Run. - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          GOTO      ERUNN000
.
ERUNN999  RETURN
.------------------------------------------------------------
. Keyin Error Run Number
.------------------------------------------------------------
ERECN000  KEYIN     *PCCOL:CVERT,*V2LON,*MASK,F8
          IF        F8=0
            MOVE      ONE,EXIT
            GOTO      ERECN999
          ENDIF
.
          PACK      KEY12,CCUPRUN,F8,SP70
          CALL      RDCCUP1
          IF        OVRCD=1
            MOVE      "Number Not Found - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      ERECN000
          ENDIF
          CALL      CALACT00 * Calculate 1 Actual
          CALL      CALBUD00 * Calculate 2 Budget
          CALL      CALSTD00 * Calculate 3 Standard Cost
          PACK      KEY2,CCUPHCD
          CALL      RDCCHC1
          PACK      KEY10,CCUPHCD,CCUPDPT
          CALL      RDCCDP1
          PACK      KEY18,CCUPHCD,CCUPDPT,CCUPPCD
          CALL      RDCCPD1
.
ERECN090  MOVE      ZERO,EXIT
          MOVE      ZERO,OVRCD
ERECN999  RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       CCSCALIO/INC
          INC       CCSCALKY    
          INC       CCSCMAIO/INC
          INC       CCSCMAKY    
          INC       CCSDEQIO/INC
          INC       CCSDPTIO/INC
          INC       CCSEPSIO/INC
          INC       CCSEPSKY    
          INC       CCSHCDIO/INC
          INC       CCSHCDKY    
          INC       CCSIADIO/INC
          INC       CCSMSCIO/INC
          INC       CCSMTSIO/INC
          INC       CCSPAQIO/INC
          INC       CCSPDPIO/INC
          INC       CCSPERIO/INC
          INC       CCSRASIO/INC
          INC       CCSRBDIO/INC
          INC       CCSSPCIO/INC
          INC       CCSSPCKY    
          INC       CCSUPDIO/INC
          INC       GPHSTDCD    
.
          INC       STDGENCD
.
