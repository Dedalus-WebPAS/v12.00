<!--"TemplateVersion"  : "V12.00.00"
    "TemplateHome"     : "lookups"-->
<html><head><title>Calendar Lookup</title>
<link rel="stylesheet" href="../html/standard.css" type="text/css">
<link rel="stylesheet" href="../html/custom.css" type="text/css">
<script type="text/javascript" src="../js/Standard.js"></script>
<script type="text/javascript" src="../js/Custom.js"></script>
<style type="text/css">
input.Daybutton {
font: 8pt ;
width: 24;
}
input.WeekEndButton {
font: 8pt ;
width: 24;
background-color: #AAAAAA;
}
input.Calbutton {
font: 8pt ;
}
</style>
<script type="text/javascript">
function setToday() {
    // SET DAY MONTH AND YEAR TO TODAY'S DATE
    var now   = new Date();
    var day   = now.getDate();
    var month = now.getMonth();
    var year  = now.getFullYear();
    this.focusDay                           = day;
    document.calControl.month.selectedIndex = month;
    document.calControl.year.value          = year;
    displayCalendar(day, month, year);
}
function isFourDigitYear(year) {
    if (year.length != 4) {
        alert ("Sorry, the year must be four-digits in length.");
        document.calControl.year.select();
        document.calControl.year.focus();
    }
    else {
        return true;
    }
}
function selectDate() {
    var year  = document.calControl.year.value;
    if (isFourDigitYear(year)) {
        var day   = 0;
        var month = document.calControl.month.selectedIndex;
        displayCalendar(day, month, year);
    }
}
function setPreviousTenYear() {
    var year  = document.calControl.year.value;
    if (isFourDigitYear(year)) {
        var day   = 0;
        var month = document.calControl.month.selectedIndex;
        year = parseInt(year)-10
        document.calControl.year.value = year;
        displayCalendar(day, month, year);
    }
}
function setPreviousYear() {
    var year  = document.calControl.year.value;
    if (isFourDigitYear(year)) {
        var day   = 0;
        var month = document.calControl.month.selectedIndex;
        year--;
        document.calControl.year.value = year;
        displayCalendar(day, month, year);
    }
}
function setPreviousMonth() {
    var year  = document.calControl.year.value;
    if (isFourDigitYear(year)) {
        var day   = 0;
        var month = document.calControl.month.selectedIndex;
        if (month == 0) {
            month = 11;
            if (year > 1000) {
                year--;
                document.calControl.year.value = year;
            }
        }
        else {
            month--;
        }
        document.calControl.month.selectedIndex = month;
        displayCalendar(day, month, year);
    }
}
function setNextMonth() {
    var year  = document.calControl.year.value;
    if (isFourDigitYear(year)) {
        var day   = 0;
        var month = document.calControl.month.selectedIndex;
        if (month == 11) {
            month = 0;
            year++;
            document.calControl.year.value = year;
        }
        else {
            month++;
        }
        document.calControl.month.selectedIndex = month;
        displayCalendar(day, month, year);
    }
}
function setNextYear() {
    var year  = document.calControl.year.value;
    if (isFourDigitYear(year)) {
        var day   = 0;
        var month = document.calControl.month.selectedIndex;
        year++;
        document.calControl.year.value = year;
        displayCalendar(day, month, year);
    }
}
function setNextTenYear() {
    var year  = document.calControl.year.value;
    if (isFourDigitYear(year)) {
        var day   = 0;
        var month = document.calControl.month.selectedIndex;
        year = parseInt(year)+10
        document.calControl.year.value = year;
        displayCalendar(day, month, year);
    }
}
function displayCalendar(day, month, year) {

    day     = parseInt(day);
    month   = parseInt(month);
    year    = parseInt(year);
    var i   = 0;
    var now = new Date();

    if (day == 0) {
        var nowDay = now.getDate();
    }
    else {
        var nowDay = day;
    }
    var days         = getDaysInMonth(month+1,year);
    var firstOfMonth = new Date (year, month, 1);
    var startingPos  = firstOfMonth.getDay();
    days += startingPos;

    // MAKE BEGINNING NON-DATE buttonS BLANK
    for (i = 0; i < startingPos; i++) {
        document.calbuttons.elements[i].value = "   ";
        document.calbuttons.elements[i].style.backgroundColor="#CCCCCC";
    }

    // SET VALUES FOR DAYS OF THE MONTH
    for (i = startingPos; i < days; i++)
    {
        document.calbuttons.elements[i].value = i-startingPos+1;
        document.calbuttons.elements[i].onClick = "returnDate"
        document.calbuttons.elements[i].style.color="black";
        document.calbuttons.elements[i].style.backgroundColor="";
    }

    // MAKE REMAINING NON-DATE buttonS BLANK
    for (i=days; i<42; i++)  {
        document.calbuttons.elements[i].value = "   ";
        document.calbuttons.elements[i].style.backgroundColor="#CCCCCC";
    }

    // GIVE FOCUS TO CORRECT DAY
    document.calbuttons.elements[focusDay+startingPos-1].focus();
    document.calbuttons.elements[focusDay+startingPos-1].style.color="red";
}
// GET NUMBER OF DAYS IN MONTH
function getDaysInMonth(month,year)  {
    var days;
    if (month==1 || month==3 || month==5 || month==7 || month==8 ||
        month==10 || month==12)  days=31;
    else if (month==4 || month==6 || month==9 || month==11) days=30;
    else if (month==2)  {
        if (isLeapYear(year)) {
            days=29;
        }
        else {
            days=28;
        }
    }
    return (days);
}


// CHECK TO SEE IF YEAR IS A LEAP YEAR
function isLeapYear (Year) {
    if (((Year % 4)==0) && ((Year % 100)!=0) || ((Year % 400)==0)) {
        return (true);
    }
    else {
        return (false);
    }
}


// SET FORM FIELD VALUE TO THE DATE SELECTED
function returnDate(inDay)
{
    var mthnam = new Array(13);
    mthnam[1]  = "January";
    mthnam[2]  = "February";
    mthnam[3]  = "March";
    mthnam[4]  = "April";
    mthnam[5]  = "May";
    mthnam[6]  = "June";
    mthnam[7]  = "July";
    mthnam[8]  = "August";
    mthnam[9]  = "September";
    mthnam[10] = "October";
    mthnam[11] = "November";
    mthnam[12] = "December";
    var day = inDay;
    var month = (document.calControl.month.selectedIndex)+1;
    var year  = document.calControl.year.value;

    if ((""+day).length == 1)
    {
        day="0"+day;
    }
    if ((""+month).length == 1)
    {
        month="0"+month;
    }
    if (day != "   ") {
     opener.dateField.value = year + month + day;
     opener.SelectPeriod.viewtype.value = "0";
     opener.GoDate(opener.dateField);
     self.close()
    }
}

// -->
</SCRIPT>
</head>

<BODY BGCOLOR="#CCCCCC" ONLOAD="PageLoad(event);setToday()">

<CENTER>
<FORM NAME="calControl" onSubmit="return false;">
<TABLE CELLPADDING=0 CELLSPACING=0 BORDER=1 bgcolor=#CCCCCC width=100%>
<tr><TD COLSPAN=7 align=center>
<SELECT NAME="month" onChange='selectDate()'>
   <OPTION>January
   <OPTION>February
   <OPTION>March
   <OPTION>April
   <OPTION>May
   <OPTION>June
   <OPTION>July
   <OPTION>August
   <OPTION>September
   <OPTION>October
   <OPTION>November
   <OPTION>December
</SELECT>
<input NAME="year" type=TEXT SIZE=4 MAXLENGTH=4 onChange="selectDate()">
</td>
</tr>

<tr>
<TD COLSPAN=7 align=center>
<input type=button class=CalButton VALUE="<<<"    
         onClick="setPreviousTenYear()">
<input type=button class=CalButton VALUE="<<"    
         onClick="setPreviousYear()">
<input type=button class=CalButton VALUE="<"   
         onClick="setPreviousMonth()">
<input type=button class=CalButton VALUE="Today" 
         onClick="setToday()">
<input type=button class=CalButton VALUE=">"   
         onClick="setNextMonth()">
<input type=button class=CalButton VALUE=">>"    
         onClick="setNextYear()">
<input type=button class=CalButton VALUE=">>>"    
         onClick="setNextTenYear()">
</td></tr>
</FORM>

<FORM NAME="calbuttons">

<tr><td class=HeadingCell align=center>Su</TD>
    <td class=HeadingCell align=center>Mo</TD>
    <td class=HeadingCell align=center>Tu</TD>
    <td class=HeadingCell align=center>We</TD>
    <td class=HeadingCell align=center>Th</TD>
    <td class=HeadingCell align=center>Fr</TD>
    <td class=HeadingCell align=center>Sa</TD></tr>

<tr><td><input type=button class=WeekEndButton name="but0"  value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but1"  value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but2"  value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but3"  value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but4"  value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but5"  value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=WeekEndButton name="but6"  value="    " 
         onClick="returnDate(this.value)"></td></tr>

<tr><td><input type=button class=WeekEndButton name="but7"  value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but8"  value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but9"  value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but10" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but11" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but12" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=WeekEndButton name="but13" value="    " 
         onClick="returnDate(this.value)"></td></tr>

<tr><td><input type=button class=WeekEndButton name="but14" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but15" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but16" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but17" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but18" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but19" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=WeekEndButton name="but20" value="    " 
         onClick="returnDate(this.value)"></td></tr>

<tr><td><input type=button class=WeekEndButton name="but21" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but22" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but23" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but24" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but25" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but26" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=WeekEndButton name="but27" value="    " 
         onClick="returnDate(this.value)"></td></tr>

<tr><td><input type=button class=WeekEndButton name="but28" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but29" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but30" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but31" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but32" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but33" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=WeekEndButton name="but34" value="    " 
         onClick="returnDate(this.value)"></td></tr>

<tr><td><input type=button class=WeekEndButton name="but35" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but36" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but37" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but38" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but39" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=DayButton name="but40" value="    " 
         onClick="returnDate(this.value)"></td>
    <td><input type=button class=WeekEndButton name="but41" value="    " 
         onClick="returnDate(this.value)"></td></tr>

</TABLE>
</FORM>
</body>
</html>
