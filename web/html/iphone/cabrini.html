<!DOCTYPE HTML>
<head>
<meta id="viewport" name="viewport" 
 content="width=device-width, initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0" />
<META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">
<META HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">
<link rel="stylesheet" href="iphone.css" type="text/css">
<script type="text/javascript" src="iphone.js"> </script>
<script type="text/javascript">
var PatientRecord = new Array();
var ListLocation;
var homePageTitle;
var homePageURL;
var homePageJS;
function init() {
 homePageTitle= getCookie("homePageTitle");
 homePageURL  = getCookie("homePageURL");
 homePageJS   = getCookie("homePageJS");
 if (isWhitespace(homePageTitle)) {
   homePageTitle="Patients";
   homePageURL  ="patweb97.pbl?reportno=1&template=12";
   homePageJS   ="PatientListTable1()";
   setCookie("homePageTitle",homePageTitle,0);
   setCookie("homePageURL",homePageURL,0);
   setCookie("homePageJS",homePageJS,0);
 }
 ShowPage();
}
function ShowPage() {
 elPageTitle=document.getElementById("PageTitle")
 elPageTitle.innerText=homePageTitle
 var h  = document.getElementsByTagName("head")[0];
 ListLocation=document.getElementById("ListScreen")
 xmlHttp = new XMLHttpRequest(); // Firefox, Opera 8.0+, Safari
 theURL = "../../cgi-bin/" + homePageURL
 xmlHttp.open("GET", theURL, false);
 xmlHttp.send();
 if (xmlHttp.responseText!="") {
   var s = document.createElement("script");
   s.type="text/javascript";
   h.appendChild(s);
   s.text=xmlHttp.responseText;
   eval(homePageJS)
 }
 else {
   ListLocation.innerHTML="<h4 align=center>Web Service Not Available</h4><br>" +
                          "<p align=center>Please Contact System Administrators</p>"
 }
}
//----------------------------------------------------------------------------
// Patient List Display
//---------------------------------------------------------------------------
function PatientListTable1() {
 t = new Table("patient-list","patient-item");
 PatientList();
 SortOrderBy=3;
 t.rows.sort(StringSort);
 ShowPatientList();
 setTimeout(CachePatients,100)
}
function ShowPatientList() {
 var OS = "<ul class=patient-list>";
 for(var i = 0; i < t.rows.length; i++) {
   OS += "<li class=patient-item onclick='ShowPatient("+i+");'>" + t.rows[i][3] +
         "<br><span class=subscriptLeft>Admitted:"+FormatDate(t.rows[i][5]) + "</span>" +
         "<span class=subscriptRight>Expected Discharge:"+t.rows[i][10] + "</span>" +
         "<br><span class=subscriptLeft>Unit: "+t.rows[i][9] + "</span>" +
         "<span class=subscriptRight>Ward/Bed:"+ t.rows[i][4] + "</span>" +
         "</li>";
 }
 OS += "</ul>";
 ListLocation.innerHTML=OS;
}
function CachePatients() {
 xmlHttp = new XMLHttpRequest(); // Firefox, Opera 8.0+, Safari
 for(var i = 0; i < t.rows.length; i++) {
   theURL = "../../cgi-bin/patweb98.pbl?reportno=1&template=183" +
            "&urnumber="+t.rows[i][0].replace(/ /g,"+") +
            "&admissno="+t.rows[i][1].replace(/ /g,"+") 
   xmlHttp.open("GET", theURL, false);
   xmlHttp.send();
   PatientRecord[i]=xmlHttp.responseText;
 }
}
function ShowPatient(RecordNo) {
  el=document.getElementById("ListScreen")
  el.style.display='none';
  el=document.getElementById("ShowScreen")
  el.style.display='';
  el.innerHTML=PatientRecord[RecordNo];
  
}
function PatientListTable2() {
 t = new Table("patient-list","patient-item");
 t.addColumn("Patient","ListText",3,3,"30","","15","")
 t.addColumn("Loc","LeftSubscript",4,4,"","","","")
 t.addColumn("Adm","RightDate",5,5,"","","","")
 PatientList();
 TableOutput(0,1);
}
function LinkTo(urnumber,admissno) {
  mScreen=top.document.getElementById("mainScreen")
  mScreen.style.display = "none";
  pFrame=top.document.getElementById("patientFrame")
  pScreen=top.document.getElementById("patientScreen")
  pScreen.style.position = "absolute";
  pScreen.style.top = "0px";
  pScreen.style.left = "0px";
  pScreen.style.width = "100%";
  pFrame.src="LoadingPage.html";
  pScreen.style.display = "";
  top.setCookie("PatientPageURL","","1")
  top.setCookie("PatientPageTitle","","1")
  pFrame.src = "../../cgi-bin/patweb98.pbl?reportno=1&template=183"+
                                "&urnumber="+urnumber.replace(/ /g,"+") +
                                "&admissno="+admissno.replace(/ /g,"+") 
}
function GoBack() {
  location.href="LoginPage.html";
}
function Menu() {
  elList=document.getElementById("ListScreen")
  elMenu=document.getElementById("MenuScreen")
  elExitTag=document.getElementById("exitTag")
  elMenuTag=document.getElementById("menuTag")
  elPageTitle=document.getElementById("PageTitle")
  if (elMenu.style.display=="none")  {
    elList.style.display="none";
    elMenu.style.display="";
    elExitTag.style.display="none";
    elPageTitle.innerText="Menu"
    elMenuTag.innerText="List"
  }
  else {
    elList.style.display="";
    elMenu.style.display="none";
    elExitTag.style.display="";
    elPageTitle.innerText="Patients"
    elMenuTag.innerText="Menu"
  }
}
function MenuSelect(itemNo) {
  switch (itemNo) {
   case 1:
      homePageTitle="Patients";
      homePageURL  ="patweb97.pbl?reportno=1&template=12";
      homePageJS   ="PatientListTable1()";
      break;
   case 2:
      homePageTitle="Patients";
      homePageURL  ="patweb97.pbl?reportno=1&template=12";
      homePageJS   ="PatientListTable2()";
      break;
   case 3:
      homePageTitle="Ward";
      homePageURL  ="patweb97.pbl?reportno=1&template=12";
      homePageJS   ="PatientListTable1()";
      break;
   case 4:
      homePageTitle="Search";
      homePageURL  ="patweb97.pbl?reportno=1&template=12";
      homePageJS   ="PatientListTable1()";
      break;
   case 5:
      homePageTitle="Patients";
      homePageURL  ="patweb97.pbl?reportno=1&template=12";
      homePageJS   ="PatientListTable2()";
      break;
  }
  Menu();
  ShowPage();
}
</script>
<style type="text/css">
.MenuTable {
 width:90%;
 margin-right:auto;
 margin-left:auto;
}
.MenuCell {
 vertical-align:bottom;
 font-size:12px;
 width:80px;
 height:80px;
}
.MenuIcon {
 text-align:middle;
 display:block;
 margin:5px;
 margin-top:10px;
 margin-bottom:10px;
}
</style>
</head>
<body class=PatientList onload="init();">
<div id=toolbar class=PageHeadingDiv>
  <h1 id=PageTitle class=PageHeading onclick='document.location.reload();'></h1>
  <a  id=exitTag   class="backPage nav-button" href="javascript:GoBack();">Exit</a>
  <a  id=menuTag   class="menuPage nav-button" href="javascript:Menu();">Menu</a>
</div>

<div id=content>
  <div id=ListScreen class=w-table>
  </div>

  <div id=ShowScreen style='color:white;display:none;background-color:black;'>
  </div>

  <div id=MenuScreen style='color:white;display:none;background-color:black;'>
  <table border=0 cellpadding= cellspacing=0 class=MenuTable>
  <tr>
      <td class=MenuCell align=center onclick='MenuSelect(1);'>
      <img class=MenuIcon src=./patients.png>Patients by Ward</td>
      <td class=MenuCell align=center onclick='MenuSelect(2);'>
      <img class=MenuIcon src=./wards.png>Wards</td>
      <td class=MenuCell align=center onclick='MenuSelect(3);'>
      <img class=MenuIcon src=./results.png>Results</td>
      <td class=MenuCell align=center onclick='MenuSelect(4);'>
      <img class=MenuIcon src=./search.png>Search</td>
  </tr>
  <tr>
      <td class=MenuCell align=center onclick='MenuSelect(5);'>
      <img class=MenuIcon src=./patients.png>Patients by Name</td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
  </tr>
  <tr>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
  </tr>
  <tr>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
  </tr>
  <tr>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
  </tr>
  <tr>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
  </tr>
  <tr>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
  </tr>
  <tr>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
  </tr>
  <tr>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
  </tr>
  <tr>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
  </tr>
  <tr>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
  </tr>
  <tr>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
  </tr>
  <tr>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
  </tr>
  <tr>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
      <td class=MenuCell align=center></td>
  </tr>
  </table>
  </div>  
</div>
</body>
