<!DOCTYPE HTML>
<head>
<title>Bed Requests</title>
<link rel="stylesheet" href="iphone.css" type="text/css">
<script type="text/javascript" src="iphone.js"> </script>
<script type="text/javascript">
var ListLocation;
function init() {
  var h  = document.getElementsByTagName("head")[0];
  ListLocation=document.getElementById("WidgetTable1")
  xmlHttp = new XMLHttpRequest(); // Firefox, Opera 8.0+, Safari
  var today = new Date();
  var lastweek = new Date();
  lastweek.setDate(lastweek.getDate()-7);
  var dd = today.getDate();
  var mm = today.getMonth()+1;//January is 0!
  var yyyy = today.getFullYear();
  if(dd<10){dd='0'+dd}
  if(mm<10){mm='0'+mm}
  lastdate=yyyy.toString()+mm.toString()+dd.toString();
  var dd = lastweek.getDate();
  var mm = lastweek.getMonth()+1;//January is 0!
  var yyyy = lastweek.getFullYear();
  if(dd<10){dd='0'+dd}
  if(mm<10){mm='0'+mm}
  frstdate=yyyy.toString()+mm.toString()+dd.toString();
  theURL = "../../cgi-bin/patweb10.pbl?reportno=9&template=2&viewtype=1&frstdate="+frstdate+
           "&lastdate="+lastdate+"&filtward="
  xmlHttp.open("GET", theURL, false);
  xmlHttp.send();
  if (xmlHttp.responseText!="") {
    var s = document.createElement("script");
    s.type="text/javascript";
    h.appendChild(s);
    s.text=xmlHttp.responseText;
    PatientListTable()
  }
  else {
    ListLocation.innerHTML="<h4 align=center>Web Service Not Available</h4><br>" +
                            "<p align=center>Please Contact System Administrators</p>"
  }
}
//----------------------------------------------------------------------------
// Patient List Display
//---------------------------------------------------------------------------
function PatientListTable() {
 t = new Table("patient-list","patient-item");
 t.addColumn("Patient","PatientImage",18,18,"../../cgi-bin/","","","")
 t.addColumn("LinkOnly","LinkOnly",3,3,"","","0","")
 t.addColumn("Patient","PatientName",21,21,"30","","","")
 t.addColumn("","ReqDateTime",1,1,"left","","","")  // Request Date Time
 t.addColumn("Dept","RightSubscript",3,3,"wrap","","","")
 t.addColumn("","LeftSubscript",9,9,"20","","","")
 t.addColumn("Type","RightSubscript",6,6,"","","","")
 t.addColumn("LinkClose","LinkClose",3,3,"","","15","")
 PatientList();
 TableOutput(0,1);
 if (t.rows.length == 0) {
    ListLocation.innerHTML="<h4 align=center>No Outstanding Bed Requests for Hospital</h4><br>" +
                           "<a href=\"BedRequestsWeek.html\">Check Weekly</a><br>" 
 }
}
function UpdateRequest(vis,dat,tim,ur) {
  linkurl="patweb10.pbl?reportno=8&template=6" +
          "&urnumber=" + ur.replace(/ /g,"+") +
          "&admissno=" + vis.replace(/ /g,"+") +
          "&pmbrq001=" + vis.replace(/ /g,"+") +
          "&pmbrq002=" + dat.replace(/ /g,"+") +
          "&pmbrq003=" + tim.replace(/ /g,"+") 

  top.setCookie("PatientPageURL",linkurl,"1")
  top.setCookie("PatientPageTitle","Allocate Bed","1")

  location.href="../../cgi-bin/patweb98.pbl?reportno=1&template=181"+
                "&urnumber="+ur.replace(/ /g,"+") +
                "&admissno="+vis.replace(/ /g,"+")

}
function GoBack() {
  backPage=top.getCookie('HomePageURL');
  backPage=backPage.replace(/.*iphone\//,"");
  location.href=backPage;
}
</script>
</head>
<body class=PatientList onload="init();">
<div class=PageHeadingDiv><h1 class=PageHeading>Requests</h1>
<a class="backPage nav-button" href="javascript:GoBack();">Home</a>
</div>
<div id=WidgetTable1 class=w-table></div>
</body>
