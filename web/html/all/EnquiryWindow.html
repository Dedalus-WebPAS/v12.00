<head>
<meta name="CrossBrowser" content="true">
<link rel="stylesheet" href="../standard.css" type="text/css">
<link rel="stylesheet" href="../custom.css" type="text/css">
<script language=javascript src="../../js/Standard.js"> </script>
<script language=javascript src="../../js/Custom.js"> </script>
<script language=javascript>
function SetLocation() {
  var server = top.opener.PatientLinks.action;
  var report = parseInt(top.opener.PatientLinks.reportno.value);
  
  if (server == "oprweb01.pbl" && report == 14) {
    if (top.opener.PatientLinks.casekeys == undefined) {
      alert("Case not selected.");
      top.window.close();
    }
    else {
      if(top.opener.PatientLinks.action.match(/^http/)) {
        var theURL = top.opener.PatientLinks.action;
      } else {
        var theURL = "../../cgi-bin/" + top.opener.PatientLinks.action;
      }
      theURL+= "?reportno=" + 
      top.opener.PatientLinks.reportno.value.replace(/ /g,"+") +
      "&template=" + top.opener.PatientLinks.template.value.replace(/ /g,"+") +
      "&urnumber=" + top.opener.PatientLinks.urnumber.value.replace(/ /g,"+") +
      "&admissno=" + top.opener.PatientLinks.admissno.value.replace(/ /g,"+") +
      "&casekeys=" + top.opener.PatientLinks.casekeys.value.replace(/ /g,"+"); 
      location.href=theURL;
    }
    return;
  }

  if(top.opener.PatientLinks.action.match(/^http/)) {
    var theURL = top.opener.PatientLinks.action;
  } else {
    var theURL = "../../cgi-bin/" + top.opener.PatientLinks.action;
  }
  theURL +="?reportno=" + 
  top.opener.PatientLinks.reportno.value.replace(/ /g,"+") +
  "&template=" + top.opener.PatientLinks.template.value.replace(/ /g,"+") +
  "&urnumber=" + top.opener.PatientLinks.urnumber.value.replace(/ /g,"+") +
  "&admissno=" + top.opener.PatientLinks.admissno.value.replace(/ /g,"+"); 
  location.href=theURL;
  return;
}
</script>
</head>
<body onload="SetLocation();"> 
</body>
