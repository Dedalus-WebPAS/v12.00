<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="nz">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script language="javascript" src="../js/allweb02.js"></script>
<script language="javascript" src="../js/allweb0203.js"></script>
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientTypeClinic.js"></script>
<script type="text/javascript">
function SetPrinter(Nolabel,SelectList) {
  if (SelectList.className=="Mandatory SelectBig") {
      SelectList.className="SelectBig" }
  else {
      SelectList.className="Mandatory SelectBig" }
  if (Nolabel!=undefined) {
      if (Nolabel.className=="Mandatory") {
          Nolabel.className="" }
      else {
          Nolabel.className="Mandatory" }
  }
}
//------------------------------------------------------------
// Set Link ACC Redirect and Return program after link ACC
//------------------------------------------------------------
function SetLinkACC(CurForm,ReturnCd) {

   //Checks if the referral is to be rejected, and if so opens
   //the referral screen and sends parameter to advise being rejected
   if (CurForm.refrejct.value == "1") {
       CurForm.redirect.value="allweb02.pbl?reportno=02&template=002"
              + "&urnumber=" + CurForm.urnumber.value.replace(/ /g,"+")
              + "&admissno=" + CurForm.admissno.value.replace(/ /g,"+")
              + "&refrejct=1";
   }

  if ((CurForm.ptcnueoc.value==1)&&(CurForm.alref035.value.substr(5,1)=='A')) {
       CurForm.redirect.value="eocweb01.pbl?reportno=01&template=006"
             + "&urnumber=" + CurForm.urnumber.value.replace(/ /g,"+")
             + "&returncd=" + ReturnCd
             + "&admissno=" + CurForm.admissno.value.replace(/ /g,"+")
  }

  //Checks if a claim needs to be lodged, and if so directs user to
  //claim form.
  if (CurForm.alref035.value.substr(3,1)=='W') {
       CurForm.redirect.value="patweb89.pbl?reportno=01&template=005"
             + "&urnumber=" + CurForm.urnumber.value.replace(/ /g,"+")
             + '&returncd=' + ReturnCd
             + "&systflag=9"
             + "&admissno=" + CurForm.admissno.value.replace(/ /g,"+")
             + "&refrejct=" + CurForm.refrejct.value.replace(/ /g,"+")
  }
} //end SetLinkACC
function AddReferral(theForm) {

  //Checks if the referral will be rejected
  checkReject(theForm.d_depcod.value,theForm.alref141,theForm);

  if (!ValCaseTeamMember()) {
    return;
  }
  window.PageAddForm=theForm;
  theForm.target="PopUpFrame1";
  if (validateMandatory(theForm)) {
    if (SetDateYYYYMMDD(theForm.alref019.value) < SetDateYYYYMMDD(theForm.alrerdat.value)) {
      alert("Referral date must be after the original referral date.");
      return;
    }
    if (!isWhitespace(AddForm.alref022.value) &&
       AddForm.rusualgp.checked==true) {
       AddForm.pmpmi059.value=AddForm.alref022.value;
       AddForm.pmpmi060.value=AddForm.alref023.value;
       AddForm.pmpmi061.value=AddForm.alref024.value;
    }
    SetLinkACC(theForm,"AH1");
    theForm.submit();
  }
}
function SetSite() {
  p=AddForm
  var SetSite
  if(isWhitespace(p.alref119.value)) {
    SetSite=p.wbsesite.value;
  } else {
    SetSite=p.alref119.value;
  }
 for (var i =0 ; i < document.AddForm.alref119.length; i++) {
  if (document.AddForm.alref119.options[i].value==SetSite.substr(0,6)) {
       document.AddForm.alref119.selectedIndex=i } };
  SetList();
}
function SetList() {
  p=AddForm
  p.alref106.options.length=1;
  DeptClinicType(p.deptcode,p.alref119,p.alref106,p.defctype)
//
  SetList2();
}
function SetList2() {
  p=AddForm
  p.alref120.options.length=1;
  SetTypeClinic(p.alref120,p.deftclid.value,p.alref119.value,p.alref106.value);
}
//this function is a onchange emulator when a search frame is used
function caseTeamOnChange(alref087,n_alref087,alref038,n_alref038,alref019) {
  var oldValue = alref087.value;
  TeamSearchFrame(alref087,n_alref087,function() {
    if(alref087.value != oldValue) {
       setTimeout(function() {
          getHCPbyCaseTeam(alref087,alref038,n_alref038,alref019);
       },100);
    }
  });
}
function hcpOnChange(alref038,n_alref038,alref087,n_alref087,alref019) {
  var oldValue = alref038.value;
  HCPSearchFrame(alref038,n_alref038,1,function() {
     if(alref038.value != oldValue) {
       setTimeout(function() {
         getCaseTeamByHCP(alref038,alref087,n_alref087,alref019);
       },100);
     }
  });
}
function CheckHCP() {
  if(!isWhitespace(document.all.d_alref085.value) ||
     !isWhitespace(document.all.d_alref086.value) ||
     !isWhitespace(document.all.d_alref166.value) ||
     !isWhitespace(document.all.d_alref167.value)) {
     document.AddForm.addithcp.checked=true;
     CheckAddHCP();
  }
}
function CheckAddHCP() {
  if(document.AddForm.addithcp.checked==true) {
     AdditionalHCP1H.style.display="";
     AdditionalHCP1F.style.display="";
     AdditionalHCP2H.style.display="";
     AdditionalHCP2F.style.display="";
     AdditionalHCP3H.style.display="";
     AdditionalHCP3F.style.display="";
     AdditionalHCP4H.style.display="";
     AdditionalHCP4F.style.display="";
     AdditionalHCP1H.innerHTML=ShowAdditionalHCP1H.innerHTML;
     AdditionalHCP1F.innerHTML=ShowAdditionalHCP1F.innerHTML;
     AdditionalHCP2H.innerHTML=ShowAdditionalHCP2H.innerHTML;
     AdditionalHCP2F.innerHTML=ShowAdditionalHCP2F.innerHTML;
     AdditionalHCP3H.innerHTML=ShowAdditionalHCP3H.innerHTML;
     AdditionalHCP3F.innerHTML=ShowAdditionalHCP3F.innerHTML;
     AdditionalHCP4H.innerHTML=ShowAdditionalHCP4H.innerHTML;
     AdditionalHCP4F.innerHTML=ShowAdditionalHCP4F.innerHTML;
  } else {
     AdditionalHCP1H.style.display="none";
     AdditionalHCP1F.style.display="none";
     AdditionalHCP2H.style.display="none";
     AdditionalHCP2F.style.display="none";
     AdditionalHCP3H.style.display="none";
     AdditionalHCP3F.style.display="none";
     AdditionalHCP4H.style.display="none";
     AdditionalHCP4F.style.display="none";
     AdditionalHCP1H.innerHTML=Blank.innerHTML;
     AdditionalHCP1F.innerHTML=BlankAdditionalHCP1F.innerHTML;
     AdditionalHCP2H.innerHTML=Blank.innerHTML;
     AdditionalHCP2F.innerHTML=BlankAdditionalHCP2F.innerHTML;
     AdditionalHCP3H.innerHTML=Blank.innerHTML;
     AdditionalHCP3F.innerHTML=BlankAdditionalHCP3F.innerHTML;
     AdditionalHCP4H.innerHTML=Blank.innerHTML;
     AdditionalHCP4F.innerHTML=BlankAdditionalHCP4F.innerHTML;
  }
}
function ChkSusNotedDate() {
  if (isWhitespace(document.AddForm.alref061.value)) {
    document.AddForm.alref165.className="PastDate"
  } else {
    document.AddForm.alref165.className="Mandatory PastDate";
  }
}
function chkRegisteredGP() {
  if (isWhitespace(AddForm.pmpxrhc1.value)) {
      return; }
  if (trim(AddForm.alref022.value) == trim(AddForm.pmpxrhc1.value)) {
      PrintRefrLtr1H.style.display="none";
      PrintRefrLtr2H.style.display="none";
      PrintRefrLtr2F.style.display="none";
      PrintRefrLtr1H.innerHTML=Blank.innerHTML;
      PrintRefrLtr2H.innerHTML=Blank.innerHTML;
      PrintRefrLtr2F.innerHTML=Blank.innerHTML;
  } else {
      PrintRefrLtr1H.style.display="";
      PrintRefrLtr2H.style.display="";
      PrintRefrLtr2F.style.display="";
      PrintRefrLtr1H.innerHTML=ShowPrintRefrLtr1H.innerHTML;
      PrintRefrLtr2H.innerHTML=ShowPrintRefrLtr2H.innerHTML;
      PrintRefrLtr2F.innerHTML=ShowPrintRefrLtr2F.innerHTML;
  }
}
function ValCaseTeam(CaseTeamFld, CaseTeamDesc) {
  if (validateCode2(7,CaseTeamFld, CaseTeamDesc)) {
    var p = document.AddForm;
    getHCPbyCaseTeam(p.alref087,p.alref038,p.n_alref038,p.alref019);
    if (!ValCaseTeamMember()) {
      CaseTeamFld.value = "";
      CaseTeamDesc.value = "";
      CaseTeamFld.focus();
    }
  }
}
function ValCaseTeamMember() {
  if (!isWhitespace(document.AddForm.alref019.value)&&
      !isWhitespace(document.AddForm.alref038.value)&&
      !isWhitespace(document.AddForm.alref087.value)) {
    var serverURL = "../cgi-bin/allweb01.pbl?reportno=8"+
        "&functype=7"+
        "&valddate=" + document.AddForm.alref019.value.replace(/ /g,"+")+
        "&valdhcpc=" + document.AddForm.alref038.value.replace(/ /g,"+")+
        "&valdteam=" + document.AddForm.alref087.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status != 0) {
      return false;
    }
  }
  return true;
}
function NZCommonLoad() {
   document.AddForm.d_alref141.value=document.AddForm.alref141.value;
   selectCatCodInd(AddForm.catAO,AddForm.alref141,AddForm.d_alref141,
                  AddForm.alref027,'1','1');
   defDateOfPriority(AddForm);defPrioritsingHCP(AddForm);
   defSuspCancer(AddForm);
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);SetSite();DisplayTrnSrc();CheckHCP();
      ChkSusNotedDate();chkRegisteredGP();defaultDHB();
      DisplayTrnSrcOut(AddForm);showACC(AddForm);expPurchDef(AddForm);
      FilterReferralSource(AddForm);
      defPriorityOutOfPriority(AddForm);
      NZCommonLoad();showServiceSubtype(document.AddForm);">
<span class=DFrameTitleBar>
  <img border=0 align=right src="../images/ExitIcon.gif" onclick="DFrameExit();">
       %ALLWEB02.03.125.0 Referral - Copy
</span>
<div id=PageBodySection style="overflow: auto;">
<form name=AddForm action="allweb02.pbl" method=post
      onsubmit="return validateMandatory(AddForm);">
 <input type=hidden name=reportno value="2">
 <input type=hidden name=updatety value="A">
 <input type=hidden name=nextpage value="5">
 <input type=hidden name=redirect value="%ALLWEB02.03.001.allweb02.02.002">
 <input type=hidden name=urnumber value="%ALLWEB02.03.003">
 <input type=hidden name=admissno value="%ALLWEB02.03.081">
 <input type=hidden name=deptcode value="%ALLWEB02.03.125.1">
 <input type=hidden name=uservari value="%ALLWEB02.03.113">
 <input type=hidden name=override value="2">
 <input type=hidden name=usermemr value="">
 <input type=hidden name=dummy>
 <input type=hidden name=wbsesite value="%STANDARD.01.023">
 <input type=hidden name=ptcnueoc value="%ALLWEB02.03.203">
 <input type=hidden name=hcpprovno value="%ALLWEB02.03.122.2">
 <input type=hidden name=defctype value="%ALLWEB02.03.167.1">
 <input type=hidden name=deftclid value="%ALLWEB02.03.188.1">
 <input type=hidden name=sacsvisn value="%ALLWEB02.03.207">
 <input type=hidden name=alrerdat value="%ALLWEB02.03.119">
 <input type=hidden name=pmpmi059 value="%ALLWEB02.03.484.001">
 <input type=hidden name=pmpmi060 value="%ALLWEB02.03.485.001">
 <input type=hidden name=pmpmi061 value="%ALLWEB02.03.461">
 <input type=hidden name=catAO value="AO">
 <input type=hidden name=d_alref141 value="%ALLWEB02.03.199.012.1">
 <input type=hidden name=pmpxrhc1 value="%ALLWEB02.03.459">
 <input type=hidden name=alcncdhb id=alcncdhb 
  value="%STANDARD.01.025.121.103.0.1">
 <input type=hidden name=nhdmdhb id=nhdmdhb value="%ALLWEB02.03.764">
 <input type=hidden name=d_ostcatg id=d_ostcatg value="%ALLWEB02.03.229">
 <input type=hidden name=d_depcod value="%ALLWEB02.03.125.3">
 <input type=hidden name=refrejct value="0">

 <table align=center cellspacing=0 cellpadding=0 border=0 width=95%>
 <tr><td class=DataLabel width=10%>Date of Referral</td>
     <td class=DataField width=40%>
         <input type=text name=alref019 size=12 tabindex=1
                onblur="checkDate(this,'Date');" value="%STANDARD.01.015"
                class= "Mandatory PastDate" title="Date of Referral">
           <img src="../images/DateTimeStamp.gif" class=Icon
                date=AddForm.alref019 time=null>
           <img src="../images/DateLookup.gif" class=Icon
                date=AddForm.alref019></td>
     <td class=DataLabel width=10%>Department Code</td>
     <td class=DataLabel width=40%>
         <input name=allrf001 type=text value="%ALLWEB02.03.125.0" readonly
                class=Readonly notab></td></tr>

 <tr><td class=DataLabel>Date Letter Received</td>
     <td><input type=text name=alref039 size=12 class="Mandatory PastDate"
                value="%ALLWEB02.03.139" onblur="checkDate(this,'Date');"
                title="Date Letter Received" tabindex=2>
           <img src="../images/DateTimeStamp.gif" class=Icon alt="Current"
                date=AddForm.alref039 time=null>
           <img src="../images/DateLookup.gif" class=Icon alt="Show Calendar"
                date=AddForm.alref039></td>
     <td class=DataLabel>Link to Visit</td>
     <td><input type=text size=10 maxlength=8 name=alref005 tabindex=20
                value="%ALLWEB02.03.105"
                onblur="justifyRight(this);
                        ValidateVisit(AddForm.alref005,AddForm.urnumber,
                        AddForm.dummy);">
          <img src="../images/SearchIcon.gif" class=Icon
               onclick="VisitSearchFrame(AddForm.urnumber,
                        AddForm.alref005);"></td></tr>

 <tr><td class=DataLabel>Referral Source</td>
     <td><select title="Referral Source" name=alref034 tabindex=3
                 class="Mandatory SelectBig" onchange="DisplayTrnSrc();">
           <option></option>
             %ALLWEB02.03.134.2
         </select></td>
     <td class=DataLabel>Prev Related Ref ID</td>
     <td><input type=text size=40 maxlength=36 name=alref146 tabindex=20
          value="%ALLWEB02.03.199.018" title="Prev Related Ref ID">
     </td></tr>

 <tr><td><div id=TranSrcHeading></div>
     <td><div id=TranSrc></div></td>
     <td class=DataLabel>Prev Related Ref Date</td>
     <td><input type=text name=alref161 value="%ALLWEB02.03.199.036"
      title="Prev Related Ref Date" class="Date" tabindex=20>
     <img src=../images/DateLookup.gif class=Icon
      align=absmiddle onclick="DateLookupFrame(AddForm.alref161);">
      Time&nbsp;<input type=text size=6 title="Time"
      value="%ALLWEB02.03.199.037" tabindex=20
      class="Time" name=alref162>
     <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(AddForm.alref161,AddForm.alref162);">
     <img src="../images/TimeLookup.gif" class=Icon
       onclick="TimeLookupFrame(AddForm.alref162);">
     </td></tr>

 <tr><td class=DataLabel>Inform GP</td>
     <td><select name=pmsvx010 tabindex=4>
           <option value="0">No</option>
           <option value="1">Yes</option>
         </select></td>
     <td class=DataLabel>Referral Originator</td>
     <td><input type=text size=32 maxlength=30 name=alref153 tabindex=22
                value="%ALLWEB02.03.199.028" title="Referral Originator"></td></tr>

 <tr><td class=DataLabel>Referring HCP</td>
     <td><input type=text name=alref022 size=10 maxlength=10 tabindex=5
                value="%ALLWEB02.03.122.1" class=Mandatory title="Referring HCP"
                onchange="UpCase(this);
                          if (checkAlphanumDesc(event,this) != false) {
                            ReadDoc(18,0,AddForm.alref022,AddForm.n_alref022,
                            AddForm.alref023,AddForm.n_alref023,
                            AddForm.alref024,AddForm.hcpprovno);
                            chkRegisteredGP();
                          }">
        <input type=text name=n_alref022 size=30 readonly title="HCP Name"
               class=Readonly value="%ALLWEB02.03.122.0">
          <img src="../images/SearchIcon.gif" class=Icon
               onclick="GPHCPSearchFrame(AddForm.alref022,AddForm.n_alref022,
                        AddForm.hcpprovno,AddForm.alref023,
                        AddForm.n_alref023,AddForm.alref024,0);
                        chkRegisteredGP();">
          <img src="../images/ClearIcon.gif" class=Icon
               onclick="clrFields(AddForm.alref022,AddForm.n_alref022,
                        AddForm.hcpprovno);
                        chkRegisteredGP();"></td>
     <td class=DataLabel>Retain as Usual GP?</td>
     <td><input type=checkbox value="0" name=rusualgp tabindex=23
                title="Retain as Usual GP" onclick="UpdateGP();"></td></tr>

 <tr><td class=DataLabel>HCP Practice</td>
     <td><input type=text size=10 class=readonly value="%ALLWEB02.03.123.0"
                title="HCP Practice" readonly notab name=alref023>
         <input type=text size=30 class=readonly value="%ALLWEB02.03.123.1"
                title="Practice Name" readonly notab name=n_alref023>
         <img src="../images/SearchIcon.gif" class=Icon
              onclick="GPHCGSearchFrame(AddForm.alref022,AddForm.n_alref022,
                       AddForm.hcpprovno,AddForm.alref023,
                       AddForm.n_alref023,AddForm.alref024);">
         <img src="../images/ClearIcon.gif" class=Icon
              onclick="clrFields(AddForm.alref023,AddForm.n_alref023,
                       AddForm.alref024,AddForm.hcpprovno);">
         <input type=hidden name=alref024
                title="Practice Count" value="%ALLWEB02.03.124">
     </td>
     <td class=DataLabel>
         <script type="text/javascript">MRDescription()</script></td>
     <td><input type=checkbox name=alref083 tabindex=24 value="1"></td></tr>

 <tr><td class=DataLabel>%STANDARD.01.017.RI</td>
     <td><select name=alref124 title="%STANDARD.01.017.RI" tabindex=6
                 class=Mandatory>
           <option></option>
             %ALLWEB02.03.186.2
         </select></td>
     <td class=DataLabel>Reason for Referral</td>
     <td><input type=text size=42 maxlength=60 name=alref088
                value="%ALLWEB02.03.149" tabindex=25></td></tr>

  <tr><td class=DataLabel>%STANDARD.01.017.lu</td>
      <td><select name=alref060 title="%STANDARD.01.017.lu" tabindex=7>
            <option></option>
              %ALLWEB02.03.199.044.2
          </select></td>
      <td class=DataLabel>%STANDARD.01.017.lt</td>
      <td><select name=alref059 title="%STANDARD.01.017.lt" tabindex=26>
            <option></option>
              %ALLWEB02.03.199.045.2
          </select></td></tr>

 <tr><td class=DataLabel>Problem 1</td>
     <td><select title="Problem 1" name=alref028 tabindex=8
                 class="SelectBig">
           <option></option>
             %ALLWEB02.03.128.2
         </select></td>
     <td class=DataLabel>Diagnosis 1</td>
     <td><input type=text name=alref031 title="Diagnosis 1" size=12 tabindex=27
                value="%ALLWEB02.03.131.1" maxlength=9
                onblur="validateAHDiag(AddForm.deptcode,AddForm.alref031,
                        AddForm.d_alref031);">
         <input type=text name=d_alref031 title="Diagnosis 1" size=25
                class=Readonly readonly notab value="%ALLWEB02.03.131.0">
           <img src="../images/SearchIcon.gif" class=Icon
                onclick="AHDiagSearchFrame(AddForm.deptcode,AddForm.alref031,
                         AddForm.d_alref031);">
           <img src="../images/ClearIcon.gif" class=Icon
                onclick="clrFields(AddForm.alref031,AddForm.d_alref031);">
     </td></tr>

 <tr><td class=DataLabel>Problem 2</td>
     <td><select title="Problem 2" name=alref029 tabindex=9 class="SelectBig">
           <option></option>
             %ALLWEB02.03.129.2
         </select></td>
     <td class=DataLabel>Diagnosis 2</td>
     <td><input type=text name=alref032 title="Diagnosis 2" size=12 tabindex=28
                value="%ALLWEB02.03.132.1" maxlength=9
                onblur="validateAHDiag(AddForm.deptcode,AddForm.alref032,
                        AddForm.d_alref032);">
         <input type=text name=d_alref032 title="Diagnosis 2" size=25
                class=Readonly readonly notab value="%ALLWEB02.03.132.0">
           <img src="../images/SearchIcon.gif" class=Icon
                onclick="AHDiagSearchFrame(AddForm.deptcode,AddForm.alref032,
                         AddForm.d_alref032);">
           <img src="../images/ClearIcon.gif" class=Icon
                onclick="clrFields(AddForm.alref032,AddForm.d_alref032);">
     </td></tr>

 <tr><td class=DataLabel>Problem 3</td>
     <td><select title="Problem 3" name=alref030 tabindex=10 class="SelectBig">
           <option></option>
             %ALLWEB02.03.130.2
         </select></td>
     <td class=DataLabel>Diagnosis 3</td>
     <td><input type=text name=alref033 title="Diagnosis 3" size=12 tabindex=29
                value="%ALLWEB02.03.133.1" maxlength=9
                onblur="validateAHDiag(AddForm.deptcode,AddForm.alref033,
                        AddForm.d_alref033);">
         <input type=text name=d_alref033 title="Diagnosis 3" size=25
                class=Readonly readonly notab value="%ALLWEB02.03.133.0">
           <img src="../images/SearchIcon.gif" class=Icon
                onclick="AHDiagSearchFrame(AddForm.deptcode,AddForm.alref033,
                         AddForm.d_alref033);">
           <img src="../images/ClearIcon.gif" class=Icon
                onclick="clrFields(AddForm.alref033,AddForm.d_alref033);">
     </td></tr>

 <tr><td class=DataLabel>%STANDARD.01.017.CL</td>
     <td><select title="%STANDARD.01.017.CL" name=alref035 tabindex=11
                 class="Mandatory SelectBig"
                 onchange="showACC(AddForm);expPurchDef(AddForm);"> 
           <option></option>
             %ALLWEB02.03.135.2
         </select></td>
    <td class=DataLabel>Diagnosis 4</td>
    <td><input type=text name=alref169 title="Diagnosis 4" size=12 tabindex=29
                value="%ALLWEB02.03.199.048.1" maxlength=9
                onblur="validateAHDiag(AddForm.deptcode,AddForm.alref169,
                        AddForm.d_alref169);">
         <input type=text name=d_alref169 title="Diagnosis 4" size=25
                class=Readonly readonly notab value="%ALLWEB02.03.199.048.0">
           <img src="../images/SearchIcon.gif" class=Icon
                onclick="AHDiagSearchFrame(AddForm.deptcode,AddForm.alref169,
                         AddForm.d_alref169);">
           <img src="../images/ClearIcon.gif" class=Icon
                onclick="clrFields(AddForm.alref169,AddForm.d_alref169);">
     </td></tr>

<tr><td><div id=ACCHeading></div></td>
    <td><div id=ACCId></div></tr>

 <tr><td class=DataLabel>%ALLWEB02.03.199.011.8</td>
     <td><select title="%ALLWEB02.03.199.011.8" name=alref140 tabindex=12
                 class="SelectBig">
           <option></option>
             %ALLWEB02.03.199.011.2
         </select></td>
    <td class=DataLabel>Diagnosis 5</td>
    <td><input type=text name=alref170 title="Diagnosis 5" size=12 tabindex=30
                value="%ALLWEB02.03.199.049.1" maxlength=9
                onblur="validateAHDiag(AddForm.deptcode,AddForm.alref170,
                        AddForm.d_alref170);">
         <input type=text name=d_alref170 title="Diagnosis 5" size=25
                class=Readonly readonly notab value="%ALLWEB02.03.199.049.0">
           <img src="../images/SearchIcon.gif" class=Icon
                onclick="AHDiagSearchFrame(AddForm.deptcode,AddForm.alref170,
                         AddForm.d_alref170);">
           <img src="../images/ClearIcon.gif" class=Icon
                onclick="clrFields(AddForm.alref170,AddForm.d_alref170);"></td>
    </tr>

 <tr><td class=DataLabel>Score</td>
     <td><input type=text name=alref143 title="Score" size=5 maxlength=5
                tabindex=13></td>
    <td class=DataLabel>Procedure 1</td>
    <td><input type=text name=alref171 title="Procedure 1" size=12 tabindex=31
          value="%ALLWEB02.03.199.050.1" maxlength=9
          onblur="validateAHProc(AddForm.deptcode,AddForm.alref171,
                  AddForm.d_alref171);">
         <input type=text name=d_alref171 title="Procedure 1" size=25
          class=Readonly readonly notab value="%ALLWEB02.03.199.050.0">
         <img src="../images/SearchIcon.gif" class=Icon
          onclick="AHProcSearchFrame(AddForm.deptcode,AddForm.alref171,
                   AddForm.d_alref171);">
         <img src="../images/ClearIcon.gif" class=Icon
          onclick="clrFields(AddForm.alref171,AddForm.d_alref171);"></td>
    </tr>

 <tr><td class=DataLabel>%ALLWEB02.03.199.013.8</td>
     <td><select title="%ALLWEB02.03.199.013.8" name=alref142 tabindex=14
                 class="SelectBig">
           <option></option>
             %ALLWEB02.03.226
         </select></td>
    <td class=DataLabel>Procedure 2</td>
    <td><input type=text name=alref172 title="Procedure 2" size=12 tabindex=32
          value="%ALLWEB02.03.199.051.1" maxlength=9
          onblur="validateAHProc(AddForm.deptcode,AddForm.alref172,
                  AddForm.d_alref172);">
         <input type=text name=d_alref172 title="Procedure 2" size=25
          class=Readonly readonly notab value="%ALLWEB02.03.199.051.0">
         <img src="../images/SearchIcon.gif" class=Icon
          onclick="AHProcSearchFrame(AddForm.deptcode,AddForm.alref172,
                   AddForm.d_alref172);">
         <img src="../images/ClearIcon.gif" class=Icon
          onclick="clrFields(AddForm.alref172,AddForm.d_alref172);"></td>
    </tr>

 <tr><td class=DataLabel></td>
     <td></td>
    <td class=DataLabel>Procedure 3</td>
    <td><input type=text name=alref173 title="Procedure 3" size=12 tabindex=32
          value="%ALLWEB02.03.199.052.1" maxlength=9
          onblur="validateAHProc(AddForm.deptcode,AddForm.alref173,
                  AddForm.d_alref173);">
         <input type=text name=d_alref173 title="Procedure 3" size=25
          class=Readonly readonly notab value="%ALLWEB02.03.199.052.0">
         <img src="../images/SearchIcon.gif" class=Icon
          onclick="AHProcSearchFrame(AddForm.deptcode,AddForm.alref173,
                   AddForm.d_alref173);">
         <img src="../images/ClearIcon.gif" class=Icon
          onclick="clrFields(AddForm.alref173,AddForm.d_alref173);"></td>
     </tr>

 <tr><td class=DataLabel></td>
     <td></td>
     <td class=DataLabel>Procedure 4</td>
     <td><input type=text name=alref174 title="Procedure 4" size=12 tabindex=34
          value="%ALLWEB02.03.199.053.1" maxlength=9
          onblur="validateAHProc(AddForm.deptcode,AddForm.alref174,
                  AddForm.d_alref174);">
         <input type=text name=d_alref174 title="Procedure 4" size=25
          class=Readonly readonly notab value="%ALLWEB02.03.199.053.0">
         <img src="../images/SearchIcon.gif" class=Icon
          onclick="AHProcSearchFrame(AddForm.deptcode,AddForm.alref174,
                   AddForm.d_alref174);">
         <img src="../images/ClearIcon.gif" class=Icon
          onclick="clrFields(AddForm.alref174,AddForm.d_alref174);"></td>
     <tr>

 <tr><td class=DataLabel></td>
     <td></td>
     <td class=DataLabel>Procedure 5</td>
     <td><input type=text name=alref175 title="Procedure 5" size=12 tabindex=35
          value="%ALLWEB02.03.199.054.1" maxlength=9
          onblur="validateAHProc(AddForm.deptcode,AddForm.alref175,
                  AddForm.d_alref175);">
         <input type=text name=d_alref175 title="Procedure 5" size=25
          class=Readonly readonly notab value="%ALLWEB02.03.199.054.0">
         <img src="../images/SearchIcon.gif" class=Icon
          onclick="AHProcSearchFrame(AddForm.deptcode,AddForm.alref175,
                   AddForm.d_alref175);">
         <img src="../images/ClearIcon.gif" class=Icon
          onclick="clrFields(AddForm.alref175,AddForm.d_alref175);"></td>
     <tr>

 <tr><td colspan=4><hr></td></tr>

 <tr><td class=DataLabel>Preferred Hospital</td>
     <td><select name=alref107 id=alref107 title="Preferred Hospital"
             class=Mandatory type="" tabindex=50 onchange="ShowOutofArea();">
           <option></option>
             %ALLWEB02.03.170.2
         </select></td>
     <td class=DataLabel>Priority</td>
     <td><select title="Priority" name=alref027 class="SelectBig" tabindex=80
          onchange="selectCatCodInd(AddForm.catAO,AddForm.alref141,
                                    AddForm.d_alref141,AddForm.alref027,'1','1');
                    defDateOfPriority(AddForm);
                    defPrioritsingHCP(AddForm);
                    showServiceSubtype(document.AddForm);">
           <option></option>
             %ALLWEB02.03.127.4
         </select></td></tr>

 <tr><td class=DataLabel>Preferred Site</td>
     <td><select name=alref119 title="Preferred Site"
                 tabindex=51 class="SelectBig" onchange="SetList();">
           <option></option>
             %ALLWEB02.03.182.2
         </select></td>
     <td>Date of Priority</td>
     <td><input type=text name=alref127 size=12 tabindex=81
                onblur="checkDate(this,'Date');"
                value="%ALLWEB02.03.194"
                title="Date of Priority" class="PastDate">
           <img src="../images/DateTimeStamp.gif" class=Icon alt="Current"
                date=AddForm.alref127 time=null>
           <img src="../images/DateLookup.gif" class=Icon alt="Show Calendar"
                date=AddForm.alref127></td></tr>

 <tr><td class=DataLabel>Clinic Type </td>
     <td><select class=SelectBig name=alref106 maxlength=45 tabindex=52
                 class="SelectBig" title="Clinic Type" onchange="SetList2();">
           <option></option>
         </select></td>
     <td>Must Be Seen By Date</td>
     <td><input type=text name=alref126 size=12 tabindex=82
                onblur="checkDate(this,'Date');" value="%ALLWEB02.03.189"
                title="Must Be Seen By Date">
           <img src="../images/DateTimeStamp.gif" class=Icon alt="Current"
                date=AddForm.alref126 time=null>
           <img src="../images/DateLookup.gif" class=Icon alt="Show Calendar"
                date=AddForm.alref126></td></tr>

 <tr><tr><td class=DataLabel>Clinic ID</td>
     <td><select name=alref120 title="Clinic ID" class="SelectBig" tabindex=53>
           <option></option>
         </select></td>
     <td class=DataLabel>Prioritising HCP</td>
     <td><input type=text name=alref084 size=10 maxlength=10
                value="%ALLWEB02.03.145.1" tabindex=83 title="Prioritising HCP"
                onblur="UpCase(this);defPrioritsingHCP(AddForm);
                        if (checkAlphanumDesc(event,this) != false) {
                          ValidateHCP(18,14,AddForm.alref084,
                          AddForm.n_alref084);
                        }">
         <input type=text name=n_alref084 size=30 readonly notab
                title="Prioritising HCP" class=Readonly 
                value="%ALLWEB02.03.145.0">
           <img src="../images/SearchIcon.gif" class=Icon
            onclick="HCPSearchFrame(AddForm.alref084,AddForm.n_alref084,1);">
           <img src="../images/ClearIcon.gif" class=Icon
            onclick="clrFields(AddForm.alref084,AddForm.n_alref084);"></td></tr>

 <tr><td class=DataLabel width=10%>Slot Type</td>
     <td><select name=alref117 class=SelectBig title="Slot Type" tabindex=54>
           <option></option>
             %ALLWEB02.03.180.2
         </select></td>
     <td class=DataLabel>%ALLWEB02.03.199.012.8</td>
     <td><select title="%ALLWEB02.03.199.012.8" name=alref141 tabindex=84
                 class="SelectBig" 
          onchange="DisplayTrnSrcOut(AddForm);defSuspCancer(AddForm);">
           <option></option>
             %ALLWEB02.03.199.012.4
         </select></td></tr>

 <tr><td class=DataLabel width=10%></td>
     <td></td>
     <td><div id=TranSrcHeadingOut></div></td>
     <td><div id=TranSrcOut></div></td>
     <tr>

 <tr><td class=DataLabel>Responsible HCP</td>
     <td><input type=text name=alref038 size=10 maxlength=10
          value="" class=Mandatory tabindex=55 title="Responsible HCP"
          onblur="UpCase(this);
                  if (checkAlphanumDesc(event,this) != false) {
                    ValidateHCP(18,14,AddForm.alref038,AddForm.n_alref038);
                  }"
          onchange="if (checkAlphanumDesc(event,this) != false) {
                      getCaseTeamByHCP(AddForm.alref038,AddForm.alref087,
                      AddForm.n_alref087,AddForm.alref019);
                    }">
         <input type=text name=n_alref038 size=30 readonly title="HCP Name"
                value="" class=Readonly>
           <img src="../images/SearchIcon.gif" class=Icon
                onclick="hcpOnChange(AddForm.alref038,AddForm.n_alref038,
                         AddForm.alref087,AddForm.n_alref087,
                         AddForm.alref019);">
           <img src="../images/ClearIcon.gif" class=Icon
                onclick="clrFields(AddForm.alref038,AddForm.n_alref038);"></td>
      <td class=DataLabel>%STANDARD.01.017.lv</td>
      <td><select name=alref061 title="%STANDARD.01.017.lv" tabindex="85"
                  onchange="ChkSusNotedDate();">
            <option></option>
              %ALLWEB02.03.199.046.2
          </select></td></tr>

<tr id=ShowServiceSubtypeDet>
  <td>&nbsp;</td>
  <td>&nbsp;</td>
  <td class=DataLabel>Service Subtype</td>
  <td><select name=alref193 id=alref193 title="Service Subtype" tabindex="85">
        <option></option>
         %ALLWEB02.03.199.074
      </select>
  </td>
</tr>

 <tr><td class=DataLabel>Case Team</td>
     <td><input type=text name=alref087 size=10 maxlength=10 title="Case Team"
                onchange="if (checkAlphanumDesc(event,this) != false) {
                            ValCaseTeam(AddForm.alref087,AddForm.n_alref087);
                          }" tabindex=56>
         <input type=text name=n_alref087 size=30 readonly
                class=Readonly tabindex=-1 title="Team Description">
           <img src="../images/SearchIcon.gif" class=Icon
                onclick="caseTeamOnChange(AddForm.alref087,AddForm.n_alref087,
                         AddForm.alref038,AddForm.n_alref038,
                         AddForm.alref019);">
           <img src="../images/ClearIcon.gif" class=Icon
                onclick="clrFields(AddForm.alref087,AddForm.n_alref087);"></td>
      <td class=DataLabel>Suspicion Noted Date</td>
      <td><input type=text name=alref165 size=12 class="Mandatory PastDate"
           tabindex=86 value="%ALLWEB02.03.199.040" title="Suspicion Noted Date"
                 onblur="checkDate(this,'Date');">
            <img src="../images/DateTimeStamp.gif" class=Icon alt="Current"
                 date=AddForm.alref165 time=null>
            <img src="../images/DateLookup.gif" class=Icon alt="Show Calendar"
                 date=AddForm.alref165></td></tr>

 <tr><td class=DataLabel>Additional HCP</td>
     <td><input type=checkbox name=addithcp value="1" tabindex=57
                onclick="CheckAddHCP();"></td>
      <td class=DataLabel><div id=InsertActiveH></td>
      <td><div id=InsertActiveF></div></td></tr>

  <tr><td class=DataLabel><div id=AdditionalHCP1H></div></td>
      <td><div id=AdditionalHCP1F></div></td>
      <td class=DataLabel><div id=AdditionalHCP2H></div></td>
      <td><div id=AdditionalHCP2F></div></td></tr>

  <tr><td class=DataLabel><div id=AdditionalHCP3H></div></td>
      <td><div id=AdditionalHCP3F></div></td>
      <td class=DataLabel><div id=AdditionalHCP4H></div></td>
      <td><div id=AdditionalHCP4F></div></td></tr>

  <tr>
      <td class=DataLabel id=DHBtitl><div id=DHBtitleDIV></div></td>
      <td class=DataField id=DHBcode><div id=DHBcodeDIV></div></td>
  </tr>
  <tr>
      <td class=DataLabel><div id=outofareatitleDIV></div></td>
      <td><div id=outofareacodeDIV></div></td>
  </tr>

 <tr><td class=DataLabel colspan=2>Print New Referral Letter to Patient &nbsp;&nbsp;
         <input type=checkbox name=prtnewpt tabindex=60
                title="New Referral to pat" value="1"></td>
     <td class=DataLabel>Printer </td>
     <td><select name=prtpsl01 tabindex=90>
           %STANDARD.01.001.ALLNEWPT.01
         </select></td></tr>

 <tr><td class=DataLabel colspan=2>Print New Referral Letter to Referrer
         <input type=checkbox name=prtnewrf tabindex=61
                title="New Referral to pat" value="1"></td>
       <td class=DataLabel>Printer </td>
       <td><select name=prtpsl02 tabindex=91>
             %STANDARD.01.001.ALLNEWRF.01
       </select></td></tr>

  <tr><td class=DataLabel colspan=2><div id=PrintRefrLtr1H></div></td>
      <td class=DataLabel><div id=PrintRefrLtr2H></div></td>
      <td><div id=PrintRefrLtr2F></div></td></tr>

 <tr><td class=DataLabel colspan=2>Referral Labels
         <input type=checkbox value="1" name=prtreflb tabindex=62
                onclick="SetPrinter(AddForm.prtpno07,AddForm.prtpsl07);">
         Copies
         <select name=prtpno07 tabindex=63>
           %STANDARD.01.027.2.1
         </select></td>
     <td class=DataLabel>Printer</td>
     <td><select class="SelectBig" name=prtpsl07 title="Printer" tabindex=92>
         <option></option>
         %STANDARD.01.001.LABELALL.01
         </select></td></tr>

 <tr><td colspan=4 align=center><br>
         <input type=button name=formactn value="Copy" class="button"
          id="CopyBut"
          tabindex=100 onclick="tempDisable(this);AddReferral(AddForm);">
         <input type=button Value="Cancel" class="button" tabindex=101
                onclick="DFrameCloseRefresh();"></td></tr>
 </table>
</form>
</div>

<span id=transferhd style="display:none">Transfer Source</span>

<span id=transfersrc style="display:none">
  <input type="text" size=7 maxlength=5 name=aldad001 class=Mandatory
         title="Transfer Source" tabindex=3 value="%ALLWEB02.03.210.0"
         onchange="validateTransferSource(9,AddForm.aldad001,AddForm.trandesc,
                   AddForm.alref034);">
  <input type=text size=27 name=trandesc notab value="%ALLWEB02.03.210.1"
         class=Readonly readonly>
    <img src="../images/SearchIcon.gif" class=Icon
   onclick="TransferSourceFrameCategory(AddForm.aldad001,AddForm.trandesc,
            AddForm.alref034,AddForm.d_ostcatg);">
</span>

<span id=transferblank style="display:none">
   <input type=hidden name=aldad001>
</span>

<span id="Blank" style="display:none;"></span>

<span id="BlankAdditionalHCP1F" style="display:none;">
  <input type=hidden name=alref085 value="">
</span>

<span id="BlankAdditionalHCP2F" style="display:none;">
  <input type=hidden name=alref086 value="">
</span>

<span id="BlankAdditionalHCP3F" style="display:none;">
  <input type=hidden name=alref166 value="">
</span>

<span id="BlankAdditionalHCP4F" style="display:none;">
  <input type=hidden name=alref167 value="">
</span>

<span id="ShowAdditionalHCP1H" style="display:none;">Additional HCP 1</span>

<span id="ShowAdditionalHCP1F" style="display:none;">
  <input type=text name=alref085 size=10 maxlength=10
         title="Additional HCP 1" tabindex=58
         onblur="ValidateHCP(18,0,AddForm.alref085,AddForm.d_alref085);">
  <input type=text name=d_alref085 size=30 class=Readonly readonly
         title="Additional HCP 1">
    <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(AddForm.alref085,AddForm.d_alref085,0);">
    <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(AddForm.alref085,AddForm.d_alref085);">
</span>

<span id="ShowAdditionalHCP2H" style="display:none;">Additional HCP 2</span>

<span id="ShowAdditionalHCP2F" style="display:none;">
  <input type=text name=alref086 size=10 maxlength=10
         title="Additional HCP 2" tabindex=88
         onblur="ValidateHCP(18,0,AddForm.alref086,AddForm.d_alref086);">
  <input type=text name=d_alref086 size=30 class=Readonly readonly
         title="Additional HCP 2">
    <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(AddForm.alref086,AddForm.d_alref086,0);">
    <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(AddForm.alref086,AddForm.d_alref086);">
</span>

<span id="ShowAdditionalHCP3H" style="display:none;">Additional HCP 3</span>

<span id="ShowAdditionalHCP3F" style="display:none;">
  <input type=text name=alref166 size=10 maxlength=10
         title="Additional HCP 3" tabindex=59
         onblur="ValidateHCP(18,0,AddForm.alref166,AddForm.d_alref166);">
  <input type=text name=d_alref166 size=30 class=Readonly readonly
         title="Additional HCP 3">
    <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(AddForm.alref166,AddForm.d_alref166,0);">
    <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(AddForm.alref166,AddForm.d_alref166);">
</span>

<span id="ShowAdditionalHCP4H" style="display:none;">Additional HCP 4</span>

<span id="ShowAdditionalHCP4F" style="display:none;">
  <input type=text name=alref167 size=10 maxlength=10
         title="Additional HCP 4" tabindex=89
         onblur="ValidateHCP(18,0,AddForm.alref167,AddForm.d_alref167);">
  <input type=text name=d_alref167 size=30 class=Readonly readonly
         title="Additional HCP 4">
    <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(AddForm.alref167,AddForm.d_alref167,0);">
    <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(AddForm.alref167,AddForm.d_alref167);">
</span>

<span id="ShowInsertActiveH" style="display:none;">Activate Referral</span>

<span id="ShowInsertActiveF" style="display:none;">
  <input type=checkbox name=activref value="1" title="Activate Referral"
         tabindex=87>
</span>

<span id="ShowPrintRefrLtr1H" style="display:none;">
  Print New Referral Letter to GP &nbsp;&nbsp;
  <select name=prtrefgp tabindex=62>
    <option></option>
      %ALLWEB02.03.755.1
  </select>
</span>

<span id="ShowPrintRefrLtr2H" style="display:none;">Printer</span>

<span id="ShowPrintRefrLtr2F" style="display:none;">
  <select class="SelectBig" name=prtpsl08 title="Printer" tabindex=92>
    <option></option>
      %STANDARD.01.001.ALLNEWGP.01
  </select>
</span>

<span id=DHBtitleSPAN style="display:none">
Patient's DHB
</span>

<span id=DHBcodeSPAN style="display:none">
%ALLWEB02.03.070.024
</span>

<span id=outofareatitleSPAN style="display:none">
%STANDARD.01.017.ly
</span>

<span id=outofareacodeBLANK style="display:none">
  <input type=hidden name=alref064 value="">
</span>

<span id=outofareacodeSPAN style="display:none">
  <select name=alref064 title="%STANDARD.01.017.ly" class="Mandatory SelectBig">
    <option></option>
    %ALLWEB02.03.140.25.5
  </select>
</span>

<span id=transferhdout style="display:none">Transfer Destination</span>

<span id=transfersrcout style="display:none">
  <input type="text" size=7 maxlength=5 name=aldad002 class=Mandatory
         title="Transfer Destination" tabindex=85 value="%ALLWEB02.03.211.0"
         onchange="validateCodeTransfer(9,AddForm.aldad002,AddForm.trnodesc,
                   AddForm.alref141);">
  <input type=text size=27 name=trnodesc notab value="%ALLWEB02.03.211.1"
         class=Readonly readonly>
  <img src="../images/SearchIcon.gif"
         onclick="TransferSourceFrameOutcome(AddForm.aldad002,
                  AddForm.trnodesc,AddForm.alref141);">
  <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(AddForm.aldad002,AddForm.trnodesc);">
</span>

<span id=transferblankout style="display:none">
  <input type=hidden name=aldad002>
</span>

<span id=blanklabel style="display:none">
</span>
<span id=acchd style="display:none">
ACC Purchase Order Number
</span>

<span id=accorderid style="display:none">
  <input type=text name=accpordn id=accpordn title="ACC Purchase Order Number"
   tabindex=11 value="" maxlength=20 size=25>
</span>

<script type="text/javascript">
//
 if ("%ALLWEB02.03.103" == "Active    ") {
    InsertActiveF.style.display="";
    InsertActiveH.style.display="";
    InsertActiveF.innerHTML=ShowInsertActiveF.innerHTML;
    InsertActiveH.innerHTML=ShowInsertActiveH.innerHTML;
 } else {
    InsertActiveF.style.display="none";
    InsertActiveH.style.display="none";
    InsertActiveF.innerHTML=Blank.innerHTML;
    InsertActiveH.innerHTML=Blank.innerHTML; }
//
 SACSRef="%ALLWEB02.03.144";
 if ( SACSRef == "Yes") {
   document.AddForm.alref083.checked=1;
 }
 for (var i=0;i<document.AddForm.pmsvx010.length;i++) {
 if (document.AddForm.pmsvx010.options[i].value=="%ALLWEB02.03.325.0") {
     document.AddForm.pmsvx010.selectedIndex=i; } };
 DefaultHosp="%ALLWEB02.03.752";
 for(i=0 ; i<document.AddForm.alref107.length; i++) {
    if(document.AddForm.alref107.options[i].value==DefaultHosp.substr(0,3)) {
       document.AddForm.alref107.selectedIndex=i;
    }
 }
 for(var i=0;i<AddForm.alref142.length;i++) {
     if(AddForm.alref142.options[i].value=="%ALLWEB02.03.227") {
        AddForm.alref142.selectedIndex=i;
     }
 }
</script>
