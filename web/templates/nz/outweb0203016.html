<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome"    content="nz">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true"> 
<script type="text/javascript">
function ChkChkIn() {
  var ChkTime=UpdateForm.outbb032.value.replace(/:/g,"")
  var TimSeen=UpdateForm.outbb033.value.replace(/:/g,"")
  ChkTime=trim(ChkTime);
  TimSeen=trim(TimSeen);
  if (!(isWhitespace(UpdateForm.outbb033.value))) {
    if (ChkTime>TimSeen) {
      alert("Check in time should be less than time seen");
      UpdateForm.outbb032.value="";
    }
  }
}
function ChkTimSn() {
  var ChkTime=UpdateForm.outbb032.value.replace(/:/g,"")
  var TimSeen=UpdateForm.outbb033.value.replace(/:/g,"")
  var DepTime=UpdateForm.outbb034.value.replace(/:/g,"")
  ChkTime=trim(ChkTime);
  TimSeen=trim(TimSeen);
  DepTime=trim(DepTime);

  if (!(isWhitespace(UpdateForm.outbb033.value))){
    if (ChkTime>TimSeen) {
      alert("Time seen should be greater than check in time");
      UpdateForm.outbb033.value="";
    }
  }
  if (!(isWhitespace(UpdateForm.outbb034.value))){
    if (TimSeen>DepTime){
      alert("Time seen should be less than departure time");
      UpdateForm.outbb033.value="";
    }
  }
}

function ChkTimDp(){
  var DepTime=UpdateForm.outbb034.value.replace(/:/g,"")
  var TimSeen=UpdateForm.outbb033.value.replace(/:/g,"")
  DepTime=trim(DepTime);
  TimSeen=trim(TimSeen);
  if (!(isWhitespace(UpdateForm.outbb034.value))){
    if (isWhitespace(UpdateForm.outbb033.value)){
      alert("Patient not Seen,cannot be departed");
      UpdateForm.outbb034.value="";
    }
    else if (TimSeen>DepTime){
      alert("Departure time should be greater than time seen");
      UpdateForm.outbb034.value="";
    }
  }
}
function checkUpdate() {
  var ChkTime=UpdateForm.outbb032.value.replace(/:/g,"")
  var TimSeen=UpdateForm.outbb033.value.replace(/:/g,"")
  var DepTime=UpdateForm.outbb034.value.replace(/:/g,"")
  ChkTime=trim(ChkTime);
  TimSeen=trim(TimSeen);
  DepTime=trim(DepTime);

  if (!isWhitespace(DepTime)) {
    if (isWhitespace(ChkTime)) {
        alert("Patient with no check in time, cannot be departed");
        UpdateForm.outbb032.focus();
        return;
    }
    if (isWhitespace(TimSeen)) {
        alert("Patient with no time seen, cannot be departed");
        UpdateForm.outbb033.focus();
        return;
    }
  }
  if ((!isWhitespace(ChkTime) || !isWhitespace(TimSeen) 
      || !isWhitespace(DepTime)) && UpdateForm.bookstat.value=="1") {
    alert("Invalid Status - Booked patients can not have a " +
          "Check-In, Time Seen or Departure Time .");
    UpdateForm.bookstat.focus();
    return;
  }
  if ((!isWhitespace(ChkTime) || !isWhitespace(TimSeen)
      || !isWhitespace(DepTime)) && UpdateForm.bookstat.value=="5") {
    alert("Invalid Status - DNA patients can not have a " +
          "Check-In, Time Seen or Departure Time .");
    UpdateForm.bookstat.focus();
    return;
  }
  if (isWhitespace(ChkTime) && isWhitespace(TimSeen) 
      && UpdateForm.bookstat.value=="4") {
    alert("Invalid Status - Visit can not be Attended when " +
          "Check-In and Seen Times are blank.");
    UpdateForm.bookstat.focus();
    return;
  }
  setRedirect();
  SubmitHidden(UpdateForm);
}

function setRedirect() {
  strTemplate="" ;
  scrName="";
  checkInd=document.UpdateForm.outbb002.value.substr(3,5)
  if(checkInd.search(/W/g) >= 0) {
    strTemplate="005"; 
    scrName="WC";}
  if(checkInd.search(/M/g) >= 0) {
    strTemplate="042";
    scrName="TAC";}
  if(checkInd.search(/V/g) >= 0) {
    strTemplate="043"; 
    scrName="VA";}
  checkInd=document.UpdateForm.outbb002.value.substr(8,1)
  if(checkInd.search(/C/g) >= 0) {
    strTemplate="048"; }

  if (strTemplate!="") {
    document.UpdateForm.nextpage.value="6"
    document.UpdateForm.redirect.value="patweb89.pbl?reportno=01" +
               "&template=" + strTemplate +
               "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+") +
               "&admissno=" + PatientLinks.admissno.value.replace(/ /g,"+") +
               "&systflag=2" +
               "&casekeys=" + PatientLinks.casekeys.value.replace(/ /g,"+")
  }
}

function ChangeUR(linkurl) {
  Left=(document.body.clientWidth-600)/2
  DFrameLink(linkurl,0,Left,600,370)
}
//
function SetFollow() {
 if(document.UpdateForm.d_outbb064.checked == true) {
   document.UpdateForm.outbb064.value=1;
 } else {
   document.UpdateForm.outbb064.value=0;
 }
}
function LinkEOC() {
  linkUrl="allweb03.pbl?reportno=1&template=009" +
          "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+") +
          "&admissno=" + PatientLinks.alrevisn.value.replace(/ /g,"+") +
          "&deptcode=" + PatientLinks.alredept.value.replace(/ /g,"+") +
          "&bulkenck=" + PatientLinks.alrevisn.value.replace(/ /g,"+") +
                         PatientLinks.admissno.value.replace(/ /g,"+")
          Left=(document.body.clientWidth-screen.width*0.85)/2;
          DFrameLink(linkUrl,0,Left,screen.width*0.85,screen.height*0.85);
}
</script>
</head>

%START.OF.PAGE
<body onload="PageLoad(event);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
Supervisor Update - %OUTWEB02.03.618.1
</span>
<div id=PageBodySection style="overflow: auto;">
<form action=outweb02.pbl name=UpdateForm method=post 
 onsubmit="return validateMandatory(this);">
<input type=hidden name=reportno id=reportno value="4">
<input type=hidden name=redirect id=redirect value="%OUTWEB02.03.001.outweb02.03.003">
<input type=hidden name=updatety id=updatety value="9">
<input type=hidden name=nextpage id=nextpage value="">
<input type=hidden name=casekeys id=casekeys value="%OUTWEB02.03.366">
<input type=hidden name=outbb064 id=outbb064 value="%OUTWEB02.03.328">

<table cellspacing=2 cellpadding=1 border=0 width=95% align=center>
<tr><td class=DataLabel>Clinic Id         </td>
    <td class=DataField>%OUTWEB02.03.303.1</td>
    <td class=DataLabel>Clinic Type       </td>
    <td class=DataField>%OUTWEB02.03.605.0</td></tr>

<tr><td class=DataLabel>Appointment</td>
    <td class=DataField>%OUTWEB02.03.313 %OUTWEB02.03.304
    at %OUTWEB02.03.316</td></tr>

<tr><td class=DataLabel>Created</td>
    <td class=DataField>%OUTWEB02.03.870.1 %OUTWEB02.03.868 %OUTWEB02.03.869
    </td>
    <td class=DataLabel>Last Updated</td>
    <td class=DataField>%OUTWEB02.03.873.1 %OUTWEB02.03.871 %OUTWEB02.03.872
    </td></tr>

<tr><td class=DataLabel>Date </td>
    <td class=DataLabel>
    <input type=text size=11 value="%OUTWEB02.03.304" readonly class=Readonly>
    <td class=DataLabel>Check in Time </td>
    <td class=DataField>
    <input type=text name=outbb032 id=outbb032 value="%OUTWEB02.03.351" size=8
     title="Check In Time" onblur="ChkChkIn();">
    <img src="../images/DateTimeStamp.gif" class=Icon
    onclick="SetCurrentDateTime(null,outbb032);">
    <img src="../images/TimeLookup.gif" class=Icon
    onclick="TimeLookupFrame(outbb032);">
</td></tr>
<tr><td class=DataLabel>Time Seen </td>
    <td class=DataField>
    <input type=text name=outbb033 id=outbb033 
     value="%OUTWEB02.03.352" size=8 title="Time Seen" onblur="ChkTimSn();">
    <img src="../images/DateTimeStamp.gif" class=Icon
    onclick="SetCurrentDateTime(null,outbb033);">
    <img src="../images/TimeLookup.gif" class=Icon
    onclick="TimeLookupFrame(outbb033);"> </td>
    <td class=DataLabel>Departure Time </td>
    <td class=DataField>
    <input type=text name=outbb034 id=outbb034 value="%OUTWEB02.03.307" size=8
     title="Departure Time" onblur="ChkTimDp();">
    <img src="../images/DateTimeStamp.gif" class=Icon
    onclick="SetCurrentDateTime(null,outbb034);">
    <img src="../images/TimeLookup.gif" class=Icon
    onclick="TimeLookupFrame(outbb034);">
</td></tr>

<tr><td class=DataLabel>Booking Status</td>
    <td class=DataField>
    <select name=bookstat id=bookstat class=SelectBig>
    %OUTWEB02.03.608
    </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.CL</td>
    <td class=DataField>
    <select name=outbb002 id=outbb002 class=SelectBig>
    %OUTWEB02.03.321.9.1.10.2.X
    </select>
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CI</td>
    <td class=DataField>
    <select name=outbb063 id=outbb063 class=SelectBig>
    <option></option>
    %OUTWEB02.03.396.2
    </select>
    </td>
    <td class=DataLabel>Follow Up Appointment Done</td>
    <td class=DataField>
    <input type=checkbox name=d_outbb064 id=d_outbb064 value=1 
     title="Follow Up Appointment Done"
     onclick="SetFollow();">
    </tr>

<tr>
  <td>%STANDARD.01.017.HP</td>
  <td>
    <select name=outbb073 id=outbb073 class="Mandatory">
      <option value=""></option>
      %OUTWEB02.03.327.013.2
    </select>
  </td>
</tr>

<tr><td colspan=4 align=center><br>
    <input type=button class="button" value="Ok" onclick="checkUpdate();">

    <input type=button Value="Change U/R" class="button" 
     onclick='ChangeUR("%OUTWEB02.03.001.patweb98.01.041")'>

    <span id=InsertEpisodeButton style="display:none">
    <input type=button Value="Encounter" class="button"
     onclick='LinkEOC();'>
    </span>

    <input type=button class="button" Value="Cancel" onclick="DFrameCloseRefresh()">
    </td></tr>
</table>
</form>
</div>

<form name=PatientLinks method=get>
<input type=hidden name=reportno id=reportno value=1>
<input type=hidden name=template id=template value=004>
<input type=hidden name=urnumber id=urnumber value="%OUTWEB02.03.003">
<input type=hidden name=admissno id=admissno value="%OUTWEB02.03.081">
<input type=hidden name=MenuType id=MenuType value="%OUTWEB02.03.088">
<input type=hidden name=casekeys id=casekeys value="%OUTWEB02.03.366">
<input type=hidden name=othecenc id=othecenc value="%OUTWEB02.03.640.030">
<input type=hidden name=alrevisn id=alrevisn value="%OUTWEB02.03.646">
<input type=hidden name=alenenct id=alenenct value="%OUTWEB02.03.647">
<input type=hidden name=alredept id=alredept value="%OUTWEB02.03.648">
<input type=hidden name=noaddenc id=noaddenc value="1">
</form>

<script type="text/javascript">
if (document.UpdateForm.outbb064.value==1) {
  document.UpdateForm.d_outbb064.checked=true;
}
if (document.PatientLinks.othecenc.value == "1" &&
 !isWhitespace(document.PatientLinks.alrevisn.value) &&
 !isWhitespace(PatientLinks.alenenct.value)) {
 InsertEpisodeButton.style.display="";
}

var hp = "%OUTWEB02.03.327.013.0"
for(var i=0; i<document.UpdateForm.outbb073.length; i++){
  if(document.UpdateForm.outbb073.options[i].value.substring(0,3)==hp){
     document.UpdateForm.outbb073.selectedIndex=i;
     break;
  }
}
</script>
