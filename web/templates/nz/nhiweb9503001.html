<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="nz">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
//
// Columns Available
//  0 - HTML Link
//  1 - NBRS File Name
//  2 - NBRS Icon Ext
//  3 - Extract Date
//  4 - Status Text
//  5 - Status value
//  6 - Status Update HTML Link
//  7 - Process Env. Text
//  8 - No. of Records (excl HD)
//  9 - Ret No. Processed
// 10 - Ret No. Deleted
// 11 - Ret No. Inserted
// 12 - Ret No. In Error
// 13 - Ret No. Warning
// 14 - Date Loaded MOH 
// 15 - Error File HTML Link
//---------------------------------------------------------------------------
function InitTable(TableView) {
  document.title="NBRS Transmissions";

  switch (TableView) {
    case 0: {
      t = new Table(1,0,2,"100%","center",35,35);
      t.addColumn("NBRS File Id.","ImageText",1,1,"left","","0",90,2)
      t.addColumn("Extract Date","DateTime",3,3,"left","","",50)
      t.addColumn("Status","String",4,4,"left","MaintenanceIcon1.gif","6",50)
      t.addColumn("Process Env.","String",7,7,"center","","",40)
      t.addColumn("No. of Records (excl HD)","String",8,8,"center","","",45)
      t.addColumn("Ret No. Processed","String",9,9,"center","","",40)
      t.addColumn("Ret No. Deleted","String",10,10,"center","","",40)
      t.addColumn("Ret No. Inserted","String",11,11,"center","","",40)
      t.addColumn("Ret No. In Error","String",12,12,"center","","",40)
      t.addColumn("Ret No. Warning","String",13,13,"center","","",40)
      t.addColumn("Date Loaded MOH","DateTime",14,14,"left","","",60)
      t.addColumn("File Failure Flag","String",15,15,"center","","",50)
      AddTableRows()
      TableOutput(1,2);    // Order Column,Asc Dsc
      break; 
    }
  }
}

function RefreshPage() {
  if (document.SelectPeriod.d_fltdhb.selectedIndex == 0) {
    document.SelectPeriod.filtrdhb.value = "   ";
  } else {
    document.SelectPeriod.filtrdhb.value =
      document.SelectPeriod.d_fltdhb.value.substr(14,3);
  }

  document.SelectPeriod.submit();
}

function LinkDetails(RecordKey) {
  if (isWhitespace(RecordKey)) {
    alert("No Acknowledgement details loaded");
    return;
  }

  document.PatientLinks.action="nhiweb95.pbl";
  document.PatientLinks.reportno.value="4";
  document.PatientLinks.template.value="001";
  document.PatientLinks.deftstat.value="1";           // default view
  document.PatientLinks.recrdkey.value=RecordKey;
  document.PatientLinks.filtrdhb.value =
    document.SelectPeriod.d_fltdhb.value.substr(14,3);

  saveScrollPosition();
  document.PatientLinks.submit();
}

function LinkStatus(RecordKey) {
  if (isWhitespace(RecordKey))
    return;

  var sURL = "nhiweb95.pbl?reportno=3&template=100&recrdkey=" + RecordKey;

  Top = (document.body.scrollTop+100);
  Left = (document.body.clientWidth-300)/2;

  DFrameLink(sURL,Top,Left,300,200);
}

function LinkExtract(ExtFile) {
  if (isWhitespace(ExtFile)) {
    alert("No Extract file name specified");
    return;
  }

  var sURL = "nhiweb95.pbl?reportno=3&template=101&outfilnm=" + ExtFile;

  Top = (document.body.clientHeight-400)/2;
  Left = (document.body.clientWidth-935)/2;

  DFrameLink(sURL,Top,Left,935,400);
}

function LinkError(ErrorFile) {
  if (isWhitespace(ErrorFile)) {
    alert("No Error file name specified");
    return;
  }

  var sURL = "nhiweb95.pbl?reportno=3&template=102&outfilnm=" + ErrorFile;

  Top = (document.body.clientHeight-400)/2;
  Left = (document.body.clientWidth-920)/2;

  DFrameLink(sURL,Top,Left,920,400);
}

</script>
</head>
%START.OF.PAGE
<body onLoad="PageLoad(event);self.focus();
              InitTable(0);getScrollPosition();">

<form name=SelectPeriod action=nhiweb95.pbl method=get style="margin:0">
<input type=hidden name=reportno value="3">
<input type=hidden name=template value="001">
<input type=hidden name=updttype value=" ">
<input type=hidden name=filtrdhb value="">

<div id=HeadingSection>
<table width="100%" cellpadding=0 cellspacing=0 border=1 bgcolor=#CCCCCC>
<tr>
  <td align=center class=HeadingCell>
    <table width="40%" cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td align=center
          style="font-weight:bold;color:white;text-decoration:none">
        Status&nbsp;
        <select name=filtstat onchange="RefreshPage();">
          <option value=" ">All</option>
          <option value="1">Sent</option>
          <option value="2">Ack File Loaded</option>
          <option value="3">Error Processing</option>
          <option value="4">Completed</option>
          <option value="5">File Failure</option>
        </select>
      </td>
      <td align=center
          style="font-weight:bold;color:white;text-decoration:none">
        DHB
        <select name=d_fltdhb onchange="RefreshPage();">
          <option></option>
          %NHIWEB95.03.102.9.1. 2.1.B
        </select>
      </td>
    </tr>
    </table>
  </td>
</tr>
</table>
</div>

<div id=TableLocation></div>
</form>

<script type="text/javascript">
function AddTableRows() {
  %NHIWEB95.03.113
}

var filtStatus = "%NHIWEB95.03.103";
if (!isWhitespace(filtStatus)) {
  for (var i = 0; i < document.SelectPeriod.filtstat.length; i++) {
    if (document.SelectPeriod.filtstat.options[i].value == filtStatus) {
      document.SelectPeriod.filtstat.selectedIndex = i;
    }
  }
}

var filtDHB = "%NHIWEB95.03.104";
if (!isWhitespace(filtDHB)) {
  for (var i = 0; i < document.SelectPeriod.d_fltdhb.length; i++) {
    if (document.SelectPeriod.d_fltdhb.options[i].value.substr(14,3) == 
          filtDHB) {
      document.SelectPeriod.d_fltdhb.selectedIndex = i;
    }
  }
}
</script>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value="3">
<input type=hidden name=template value="001">
<input type=hidden name=deftstat value="0">
<input type=hidden name=recrdkey value="">
<input type=hidden name=filtrdhb value="">
<input type=hidden name=MenuType value="%NHIWEB95.03.088">
</form>

