<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="nz">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/admission.js"></script>
<script type="text/javascript">
function showACC() {
    ind=document.UpdateForm.ptmis027.value.substring(3,4)
    if (ind=="W") {
      ACCHeading.innerHTML=acchd.innerHTML;
      ACCId.innerHTML=accorderid.innerHTML;
    } else {
      ACCHeading.innerHTML=blanklabel.innerHTML;
      ACCId.innerHTML=blanklabel.innerHTML;
    }
}
function ShowAdmissionWeight(theForm) {
  BabyAge.style.display="none";
  document.UpdateForm.ptmis051.className="";
  document.UpdateForm.ptmis051.min="0";
  document.UpdateForm.agebmand.value=0;
//
  if(isWhitespace(theForm.ptcnbage.value) ||
     isWhitespace(theForm.pbdate.value) ||
     isWhitespace(theForm.d_ptmis001.value)) {
     return;
  }
//
  Bday = new Date();
  Bday.setFullYear(theForm.pbdate.value.substring(6,11));
  monstr= theForm.pbdate.value.substring(3,6)
  if (monstr=="Jan" || monstr=="JAN" || monstr=="jan") mon=00
  if (monstr=="Feb" || monstr=="FEB" || monstr=="feb") mon=01
  if (monstr=="Mar" || monstr=="MAR" || monstr=="mar") mon=02
  if (monstr=="Apr" || monstr=="APR" || monstr=="apr") mon=03
  if (monstr=="May" || monstr=="MAY" || monstr=="may") mon=04
  if (monstr=="Jun" || monstr=="JUN" || monstr=="jun") mon=05
  if (monstr=="Jul" || monstr=="JUL" || monstr=="jul") mon=06
  if (monstr=="Aug" || monstr=="AUG" || monstr=="aug") mon=07
  if (monstr=="Sep" || monstr=="SEP" || monstr=="sep") mon=08
  if (monstr=="Oct" || monstr=="OCT" || monstr=="oct") mon=09
  if (monstr=="Nov" || monstr=="NOV" || monstr=="nov") mon=10
  if (monstr=="Dec" || monstr=="DEC" || monstr=="dec") mon=11
  Bday.setMonth(mon);
  Bday.setDate(theForm.pbdate.value.substring(0,2));
//
  Adat = new Date();
  Adat.setFullYear(theForm.d_ptmis001.value.substring(6,11));
  monstr= theForm.d_ptmis001.value.substring(3,6)
  if (monstr=="Jan" || monstr=="JAN" || monstr=="jan") mon=00
  if (monstr=="Feb" || monstr=="FEB" || monstr=="feb") mon=01
  if (monstr=="Mar" || monstr=="MAR" || monstr=="mar") mon=02
  if (monstr=="Apr" || monstr=="APR" || monstr=="apr") mon=03
  if (monstr=="May" || monstr=="MAY" || monstr=="may") mon=04
  if (monstr=="Jun" || monstr=="JUN" || monstr=="jun") mon=05
  if (monstr=="Jul" || monstr=="JUL" || monstr=="jul") mon=06
  if (monstr=="Aug" || monstr=="AUG" || monstr=="aug") mon=07
  if (monstr=="Sep" || monstr=="SEP" || monstr=="sep") mon=08
  if (monstr=="Oct" || monstr=="OCT" || monstr=="oct") mon=09
  if (monstr=="Nov" || monstr=="NOV" || monstr=="nov") mon=10
  if (monstr=="Dec" || monstr=="DEC" || monstr=="dec") mon=11
  Adat.setMonth(mon);
  Adat.setDate(theForm.d_ptmis001.value.substring(0,2));
//
  if (Adat.getTime() >= Bday.getTime()) {
    daysold = Adat.getTime() - Bday.getTime();
    daysold = Math.floor(daysold / (1000 * 60 * 60 * 24));
  } else {
    return;
  }
//
  if(daysold <= theForm.ptcnbage.value) {
    BabyAge.style.display="";
    document.UpdateForm.ptmis051.className="Mandatory Number";
    document.UpdateForm.ptmis051.min="1";
    document.UpdateForm.agebmand.value=1;
  }
}
function SubmitUpd() {
  MandatoryOk=validateMandatory(document.UpdateForm)
  if (MandatoryOk) {
    SetLinkACC(UpdateForm,"ADM");
    document.UpdateForm.submit();
   }
}

function validateCodeOnChange(num,trnsfsrc,trndesc,ptmis009)
{
  if(validateCode(num,trnsfsrc,trndesc))
  {
   validateTransSrcWithRef(trnsfsrc,ptmis009,trndesc);
  }
}

function DisplayPreadmNotes() {
  if (!isWhitespace(UpdateForm.bkreproc.value)) {
    document.getElementById('prenotesdet').style.display = "";
  } else {
    document.getElementById('prenotesdet').style.display = "none";
  }
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);displayDiv(document.UpdateForm.ptmis011,'PT');
             DisplayTrnSrc();RJAdmWeight();showACC();
             DisplayPreadmNotes();"> 
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.01.003";
PatientVIS="%PATWEB89.01.081";
PatientNAM="%PATWEB89.01.002";
PatientSTA="%PATWEB89.01.086.078";
PatientALT="%PATWEB89.01.084";
PatientSEX="%PATWEB89.01.019";
PatientDOB="%PATWEB89.01.020";
PatientAGE="%PATWEB89.01.021";
PatientLOC="%PATWEB89.01.083";
PatientPRI="%PATWEB89.01.086.066.1";
PatientUNT="%PATWEB89.01.066.0";
DoctorCOD="%PATWEB89.01.082.003";
DoctorNAM="%PATWEB89.01.082.002";
PatientAID="%PATWEB89.01.086.090";
PatientIND="%PATWEB89.01.086.091";
PatientCUR="%PATWEB89.01.086.092";
PatientCLC="%PATWEB89.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.01.086.094";
PatientCDM="%PATWEB89.01.086.095";
PatientVDH="%PATWEB89.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>

<form name=UpdateForm method=post style="margin:0">
<input type="hidden" name="reportno" value="2">
<input type="hidden" name="template" value="030">
<input type="hidden" name="urnumber" value="%PATWEB89.01.003">
<input type="hidden" name="admissno" value="%PATWEB89.01.081">
<input type="hidden" name="updatety" value="6">
<input type="hidden" name="allocate" value="1">
<input type="hidden" name="redirect" value="%PATWEB89.01.001.patweb98.01.002">
<input type="hidden" name="chckname" value="0">
<input type="hidden" name="emradmit" value="0">
<input type="hidden" name="emradmis" value="0">
<input type="hidden" name="newbmand" value="0">
<input type="hidden" name="agebmand" value="0">
<input type="hidden" name="ptvis063" value="1">
<input type="hidden" name="ptcnueoc" value="%PATWEB89.01.925">
<input type="hidden" name="ptmis027" value="%PATWEB89.01.126.3">
<input type="hidden" name="ptcnbage" value="%STANDARD.01.025.021.046.1.3">
<input type="hidden" name="pbdate"   value="%PATWEB89.01.020">
<input type="hidden" name="chdisdte" id=chdisdte value="1">
<input type=hidden name=o_ptmis030 value="%PATWEB89.01.129">
<input type=hidden name=admnstat value="%PATWEB89.01.924">
<input type=hidden name=mh_visit value="%PATWEB89.01.999.008">
<input type=hidden name=bkreproc value="%PATWEB89.01.717">

<input type=hidden name=ptcndigp id=ptcndigp
 value="%STANDARD.01.025.124.122.0.1">

<table border=1 colspan=1 width=100% cellspacing=1 cellpadding=1 >
<tr><td class=HeadingCell align=center>
    Update Admission Details</tr>
<tr>
<tr><td>
    <table width=100%  border=0 class=TableBody cellpadding=2 cellspacing=2>
<tr><td width=50%>
    <table border=0 width=100% class=TableBody cellpadding=0 cellspacing=0>
       <tr><td class=DataLabel>Admission Date</td>
           <td class=DataLabel><input type="text" readOnly
            size="12" tabindex=-1 name=d_ptmis001 value="%PATWEB89.01.102" 
            title="Admission Date" class="Mandatory Readonly"
            onblur="checkDate(this,'Admission Date')">
       Time 
       <input type=text name=ptmis002 tabindex=2 size=8 
        title="Admission Time" class="Readonly" readonly
        value="%PATWEB89.01.103" onblur="checkTime(this,'AdmissionTime');">
          </td>
      <tr><td class=DataLabel>%STANDARD.01.017.P </td>
          <td><select name=ptmis011 tabindex=3 title="%STANDARD.01.017.P " 
               class="Mandatory" onchange="displayDiv(ptmis011,'PT');"> 
              <option> </option>
               %PATWEB89.01.112.2
              </select></tr>

      <tr><td class=DataLabel>Referral Source</td>
          <td><select name=ptmis009 tabindex=4 id=ptmis009 title="Referral Source"
 onblur="validateCodeOnChange(9,trnsfsrc,trandesc,ptmis009);"
               onchange="DisplayTrnSrc()" class="Mandatory">
                 <option> </option>
                 %PATWEB89.01.110.2
                 </select></td><tr>
          <td><div id=TranSrcHeading></div></td>
          <td><div id=TranSrc></div></td>

<tr><td class=DataLabel>Referring HCP</td>
    <td><input type="text" size=10 maxlength=10 name=ptvis028 tabindex=5
               value="%PATWEB89.01.231.1" id=ptvis028
        onchange="ReadDoc(18,0,ptvis028,genpname,ptvis029,genpprac,ptvis030,genpprov);">
        <input type=text size=25 notab readonly name=genpname id=genpname
               value="%PATWEB89.01.231.0">
        <img src="../images/SearchIcon.gif" class=Icon
        onclick="GPHCPSearchFrame(ptvis028,genpname,genpprov,ptvis029,genpprac,ptvis030,0)">
        <img src="../images/erase.gif" class=Icon onclick="clrFields(ptvis028,genpname);"></td></tr>

<tr><td class=DataLabel>Practice</td>
    <td><input type=text name=genpprac size=35 readonly id=genpprac
                 value="%PATWEB89.01.232.0">
        <input type=hidden name=ptvis029 value="%PATWEB89.01.232.1" id=ptvis029>
        <input type=hidden name=ptvis030 value="%PATWEB89.01.233.1" id=ptvis030>
        <input type=hidden name=genpprov value="" id=genpprov>
          <img src="../images/SearchIcon.gif" class=Icon
 onclick="GPHCGSearchFrame(ptvis028,genpname,genpprov,ptvis029,genpprac,ptvis030)">
 <img src="../images/erase.gif" class=Icon onclick="clrFields(ptvis029,genpprac,ptvis030,genpprov);">
      </td></tr>

      <tr><td class=DataLabel>Inform GP</td>
      <td><select name=ptvis022 tabindex=6>
         <option value="0">No</option>
         <option value="1">Yes</option>
        </select></td></tr>

      <tr><td class=DataLabel>Readmission Indicator</td>
          <td><select name=ptmis042 tabindex=7 title="Readmission Indicator">
                <option> </option>
                 %PATWEB89.01.138.2
              </select></td></tr>     

      <tr><td class=DataLabel>Admission Type</td>
          <td><input type=text readonly class=Readonly 
               value="%PATWEB89.01.113.0">
              </td></tr>

      <tr><td class=DataLabel>Admitting Doctor</td>
          <td><input type="text" size=11 maxlength=6 class=Readonly
               readonly title="Admitting Doctor" value="%PATWEB89.01.108.003">
              <input type=text size=25 name=doctnam2
               class=Readonly readonly value="%PATWEB89.01.108.002"></td></tr>

      <tr><td class=DataLabel>Case Team</td>
          <td><input type="text" size=11 maxlength=10 class=Readonly readonly
               value="%PATWEB89.01.298.062.1" title="Case Team">
              <input type=text size=42 class=Readonly readonly
               value="%PATWEB89.01.298.062.0" ></td></tr>

      <tr><td class=DataLabel>%STANDARD.01.017.A </td>
          <td><input type=text class=Readonly readonly
                 value="%PATWEB89.01.111.0">
          </td></tr>
	  
      <tr><td class=DataLabel>%STANDARD.01.017.CL</td>
          <td><input type=text class=Readonly readonly size=30
               value="%PATWEB89.01.126.0">
          </td></tr>

     <tr><td><div id=ACCHeading></div></td>
         <td><div id=ACCId></div></tr>


      <tr><td class=DataLabel> Planned Length of Stay</td>
        <td>
        <input type=text size=5 maxlength=5 name=ptmis030
         tabindex=8 title='Expected Length of Stay'
         class=Integer onblur="checkInteger(this,this.value);"
             value="%PATWEB89.01.129">
        </td></tr>

     <tr id=prenotesdet valign=top>
       <td class=DataLabel>Waiting List Pre-admission Notes</td>
       <td class=DataField colspan=3>
         <textarea wrap=virtual name=prenotes class=Readonly readonly
           cols=60 rows=3>%PATWEB89.01.999.100</textarea>
       </td></tr>

</table>
</td>
<td width=50%>
    <table width=100% border=0 class=TableBody cellpadding=0 cellspacing=0>
      <tr><td class=DataLabel>Reason For Admission </td>
          <td><input type=text name="ptmis020" size=80 maxlength=80 tabindex=20 
	       value="%PATWEB89.01.121" title="Reason For Admission">
	  </td></tr>

      <tr><td class=DataLabel>&nbsp;</td>
          <td><input type=text name="ptmis021" size=80 maxlength=80 tabindex=21 
	       value="%PATWEB89.01.122"> 
          </td></tr>

      <tr><td class=DataLabel>%STANDARD.01.017.HP</td>
          <td><select name="ptmis060" tabindex=22
               title="%STANDARD.01.017.HP" class="Mandatory">
            <option> </option>
            %PATWEB89.01.151.2
          </select>
          </td></tr>

      <tr><td class=DataLabel>Health Agency</td>
          <td><select name="ptmis061" tabindex=23
               title="Health Agency" class="Mandatory">
            <option> </option>
            %PATWEB89.01.152.2
          </select>
          </td></tr>

      <tr><td>Admitting Point</td>
          <td><select name=ptvis046 tabindex=24>
               <option> </option>
                %PATWEB89.01.290.2
               </select>
          </td></tr>

      <tr><td class=DataLabel>Ward / Bed </td>
          <td><input type=hidden name=bedstat1>
             <input type=hidden name=warddesc>
             <select name=ptmis004 disabled>
              <option> </option>
              %PATWEB89.01.449.2
             </select>
             <input type=text name=ptmis005 maxlength=3 size=3 
               value="%PATWEB89.01.106" readonly class=Readonly>
          </td></tr>

      <tr><td class=DataLabel>Diet</td>
          <td><select name=ptmis028 tabindex=26>
              <option></option>
              PATWEB89.01.065.2
              %PATWEB89.01.127.2
              </select>
          </td></tr>

<tr><td colspan=2 rowspan=4>
         <table width=100%>
<tr><td>
<span id=BabyAge style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Admission Weight</td>
    <td><input type=text name=ptmis051 size=8 maxlength=6 tabindex=27  title="Admission Weight" 
         value="%PATWEB89.01.186" onblur="justifyRight(this);">grams</td></tr>
</table>
</span>
</td></tr>
<tr><td><div id=NewBorn></div>
</td></tr>
<tr><td rowspan=2>
<span id=WaitingList style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Date of Referral</td>
    <td><input type=text size=12 name=ptmis058 tabindex=28 id=ptmis058
         onblur="checkDate(this,'ReferralDate')">
         <img notab src=../images/CalendarLookup.gif 
          class=Icon onclick="DateLookupFrame(ptmis058);"></td></tr>
<tr><td class=DataLabel>Date of 1st Spec Consult</td>
    <td><input type=text size=12 name=ptmis059 tabindex=29 id=ptmis059
         onblur="checkDate(this,'SpecConDate')">
         <img notab src=../images/CalendarLookup.gif 
          class=Icon onclick="DateLookupFrame(ptmis059);"></td></tr>
</table>
</span>
</td><tr>
</table>
</td><td></tr>

</table>
</td>
</tr>

      <tr align=center>
       <td colspan=4 align=center><br>
       <input type=button value="Update" class="button" tabindex=30 
  id="pat89sub" onclick="tempDisable(this);isChangedExpectedDate();SubmitUpd()">
       <input type=button value="Cancel" class="button" tabindex=31
        onclick="history.go(-1);">
    </table>
</td></tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.081">
<input type=hidden name=MenuType value="%PATWEB89.01.088">
</form>

<form name=linkForm action=patweb89.pbl method=post>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.101">
</form>

<script language=javascript>
//
for (var i=0;i<document.UpdateForm.ptmis004.length;i++){
if (document.UpdateForm.ptmis004.options[i].value=="%PATWEB89.01.105.1"){
    document.UpdateForm.ptmis004.selectedIndex=i}};
//
ShowAdmissionWeight(UpdateForm);
</script>
<script language="Javascript">
//
if ("%PATWEB89.01.466.1" == "BED" ) { var site="4711"}else{ site="4712" }
/*
for (var i=0;i<document.UpdateForm.ptvis022.length;i++){
if (document.UpdateForm.ptvis022.options[i].value=="%PATWEB89.01.225.0"){
    document.UpdateForm.ptvis022.selectedIndex=i}};
*/

var informGP = "%PATWEB89.01.225.0";               //ptvis022
valInformGP2(document.UpdateForm.ptvis022,informGP, document.UpdateForm.ptcndigp.value);

function RJAdmWeight() {
  if (document.UpdateForm.ptmis051!=undefined) {
    justifyRight(document.UpdateForm.ptmis051);
  }
}

FilterMentalHealth(document.UpdateForm.mh_visit.value);

</script>
<span id=NewBorn1 style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Gestation Period</td>
    <td><select name=ptmis077 title="Gestation Period">
        <option></option>
        %PATWEB89.01.199.006.2
        </select>
    <td></tr>
</table>
</span>
<span id=transferhd style="display:none" class=DataLabel>
Transfer Source
</span>
<span id=transfersrc style="display:none">
<input type="text" size=7 maxlength=5 name=trnsfsrc class=Mandatory
      title="Transfer Source" tabindex=3 id=trnsfsrc
      value="%PATWEB89.01.193.0"
     onblur="validateCodeOnChange(9,trnsfsrc,trandesc,ptmis009);">
    <input type=text size=27 name=trandesc notab id=trandesc
     class=Readonly readonly value="%PATWEB89.01.193.1">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="TransferSourceFrame(trnsfsrc,trandesc,ptmis009)">
</span>
<span id=blanklabel style="display:none">&nbsp;</span>
<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc>
</span>
<span id=acchd style="display:none">
ACC Purchase Order Number
</span>

<span id=accorderid style="display:none">
  <input type=text name=accpordn id=accpordn title="ACC Purchase Order Number" 
         value="%PATWEB89.01.392" maxlength=20 size=25>
</span>

