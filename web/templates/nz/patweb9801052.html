<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome"    content="nz">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript" src="../js/UltraGenda.js"> </script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link                   
//  1 - Visit Number
//  2 - Visit Date
//  3 - Discharge Date
//  4 - Visit Desc
//  5 - Ward
//  6 - Doctor
//  7 - Admission Type (CMBS Class)
//  8 - Claim Type
//  9 - Coding Status
// 10 - Department
// 11 - Home Location 
// 12 - Document Type
// 13 - Volume Number
// 14 - Unit Description
// 15 - Visit Day
// 16 - Visit Type
// 17 - Diagnosis/Procedure Code
// 18 - Location/Ward
// 19 - Status
// 20 - Slot Number
// 21 - Diagnosis Description
// 22 - Triage Code
// 28 - Unit Code
// 29 - Claim Code
//---------------------------------------------------------------------------
var typeJSON="";
var sectionJSON="";
var visitJSON="";
function InitTable(TableView) {
switch (TableView) {
case 0: {
 t = new Table(1,0,2,"100%","center",30,30);
 t.addColumn("Adm/Visit Date","DateTime",2,2,"left","AppointmentIcon.gif","0",100)
 t.addColumn("Day","String",15,15,"left","","",25)
 t.addColumn("Type","String",16,16,"left","","",32)
 t.addColumn("Unit","String",28,28,"left","","",40)
 t.addColumn("HCP","String",6,6,"left","","",100)
// t.addColumn("Slot","String",20,20,"left","","",35)
 t.addColumn("Location","String",18,18,"left","","",75)
 t.addColumn(document.PatientLinks.claimcode.value,"String",29,29,"left","","",35)
 t.addColumn("Status","String",19,19,"left","","",110)
 t.addColumn("Visit No.","String",1,1,"left","","",50)
 t.addColumn("Med Rec Volume","String",13,13,"left","","",45)
 AddTableRows()
 TableOutput(0,2);    // Order Column,Asc Dsc
 break; }
case 1: {
 t = new Table(1,0,2,"100%","center",30,30);
 t.addColumn("Adm/Visit Date","DateTime",2,2,"left","AppointmentIcon.gif","0",100)
 t.addColumn("Day","String",15,15,"left","","",25)
 t.addColumn("Type","String",16,16,"left","","",32)
 t.addColumn("Unit","String",28,28,"left","","",40)
 t.addColumn("HCP","String",6,6,"left","","",100)
 t.addColumn("Diagnosis/Procedure","String",21,21,"left","","",130)
 t.addColumn("Code","String",17,17,"left","","",60)
 t.addColumn("Med Rec Volume","String",13,13,"left","","",50)
 t.addColumn("Visit No.","String",1,1,"left","","",50)
 AddTableRows()
 TableOutput(0,2);    // Order Column,Asc Dsc
 break; }
 }
}
</script>
<script type="text/javascript">
function linkPatient(Urnumber,VisitNo,VisitType,SecOpt,Casekeys,Site,AAEFlag,EVNTFlag,EpisodeNo,Emrsite) {
  if (VisitType=="7") {
    document.PatientLinks.action="patweb89.pbl"
    document.PatientLinks.reportno.value="1"
    document.PatientLinks.template.value="20"
    document.PatientLinks.admissno.value=VisitNo
    document.PatientLinks.urnumber.value=Urnumber
    document.PatientLinks.target=""
    document.PatientLinks.submit()
  }

  if (VisitType=="3") {
    document.PatientLinks.action="patweb98.pbl"
    document.PatientLinks.reportno.value="1"
    document.PatientLinks.template.value="2"
    document.PatientLinks.admissno.value=VisitNo
    document.PatientLinks.urnumber.value=Urnumber
    document.PatientLinks.target=""
    document.PatientLinks.submit()
  }

  if (VisitType=="2") {
    if(document.PatientLinks.outpsite.value!=Site) {
      alert("Invalid Outpatient Site Security.")
      return;
    }
    document.PatientLinks.action="outweb02.pbl"
    document.PatientLinks.reportno.value="3"
    document.PatientLinks.template.value="1"
    document.PatientLinks.admissno.value=VisitNo
    document.PatientLinks.urnumber.value=Urnumber
    document.PatientLinks.target=""
    document.PatientLinks.submit()
  }

  if (VisitType=="4") {
    if(document.PatientLinks.outpsite.value!=Site) {
     alert("Invalid Outpatient Site Security.")
     return;
    }
    document.PatientLinks.action="outweb02.pbl"
    document.PatientLinks.reportno.value="3"
    document.PatientLinks.template.value="015"
    document.PatientLinks.admissno.value=VisitNo
    document.PatientLinks.urnumber.value=Urnumber
    document.PatientLinks.target=""
    document.PatientLinks.submit()
  }

  if (VisitType=="1") {
    var usersite = GetCookieData("IBAUserEMR");
    if(AAEFlag=="0" && Emrsite.replace(/ /g,"")!=usersite.replace(/ /g,"")) {
      alert("Invalid Emergency Site Security.")
      return;
    }
    if (AAEFlag=="1") {
      document.PatientLinks.action="patweb98.pbl"
      document.PatientLinks.reportno.value="1"
      document.PatientLinks.template.value="070"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      document.PatientLinks.target=""
      document.PatientLinks.submit()
    } else {
      if (top.location.pathname.match(/EmergencyMap/g)) {
        document.PatientLinks.action="emrweb02.pbl"
        document.PatientLinks.reportno.value="1"
        document.PatientLinks.template.value="100"
        document.PatientLinks.admissno.value=VisitNo
        document.PatientLinks.urnumber.value=Urnumber
        document.PatientLinks.target=""
        document.PatientLinks.submit()
      } else {
        document.PatientLinks.action="emrweb02.pbl"
        document.PatientLinks.reportno.value="1"
        document.PatientLinks.template.value="021"
        document.PatientLinks.admissno.value=VisitNo
        document.PatientLinks.urnumber.value=Urnumber
        document.PatientLinks.target=""
        document.PatientLinks.submit()
      }
    }
  }

  if (VisitType=="8") {
    document.PatientLinks.action="watweb01.pbl"
    document.PatientLinks.reportno.value="2"
    document.PatientLinks.template.value="010"
    document.PatientLinks.admissno.value=VisitNo
    document.PatientLinks.urnumber.value=Urnumber
    document.PatientLinks.casekeys.value=Casekeys
    document.PatientLinks.target=""
    document.PatientLinks.submit()
  }

  if (VisitType=="9") {
    
    if (EVNTFlag=="1") 
    {
      document.PatientLinks.action="patweb81.pbl"
      document.PatientLinks.reportno.value="1"
      document.PatientLinks.template.value="7"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      document.PatientLinks.target=""
      document.PatientLinks.submit()
//  Left=(document.body.clientWidth-600)/2
//  DFrameSubmit(PatientLinks,0,Left,650,400)
      return;
    }
   
    if(EVNTFlag=="2")
    {
      document.PatientLinks.action="patweb81.pbl"
      document.PatientLinks.reportno.value="1"
      document.PatientLinks.template.value="5"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      document.PatientLinks.target=""
      document.PatientLinks.submit()
//  Left=(document.body.clientWidth-600)/2
//  DFrameSubmit(PatientLinks,0,Left,650,400)
      return;
    }

    if(EVNTFlag=="3")
    {
      document.PatientLinks.action="patweb81.pbl"
      document.PatientLinks.reportno.value="1"
      document.PatientLinks.template.value="3"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      document.PatientLinks.target=""
      document.PatientLinks.submit()
//  Left=(document.body.clientWidth-600)/2
//  DFrameSubmit(PatientLinks,0,Left,650,400)
      return;
    }

    if(SecOpt=="2")
    {
      document.PatientLinks.action="patweb81.pbl"
      document.PatientLinks.reportno.value="1"
      document.PatientLinks.template.value="1"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      document.PatientLinks.target=""
      document.PatientLinks.submit()
    }

    if(SecOpt=="0")
    {
      document.PatientLinks.action="allweb02.pbl"
      document.PatientLinks.reportno.value="2"
      document.PatientLinks.template.value="1"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      document.PatientLinks.target=""
      document.PatientLinks.submit()
    }

    if(SecOpt!=="0"&SecOpt!=="2")
    {
      alert("Screen is not viewable by all departments")
    }
  }
}

function checkType(el) {
  switch (el) { 
     case "CAR"  :return "IP";
     case "002"  :return "IP";
     case "IP"  :return el;
     case "OP"  :return el;
     case "AH"  :return el;
     case "EMG" :return el;
     case "RF"  :return el;
     case "W/L" :return el;
     case "Book":return el;
     default : return "Unkwn"
  }
}
function getText(el) {
  if (!isWhitespace(el[21])&&el[21].replace(/ /g,"")!="&nbsp;") 
    return LinkText(el[0],el[21]);
  if (!isWhitespace(el[6])&&el[6].replace(/ /g,"")!="&nbsp;") 
    return LinkText(el[0],el[6]);
  if (!isWhitespace(el[28])&&el[28].replace(/ /g,"")!="&nbsp;") 
    return LinkText(el[0],el[28]);
  if (!isWhitespace(el[16])&&el[21].replace(/ /g,"")!="&nbsp;") 
    return LinkText(el[0],el[16]);
}
function LinkText(href,text) {
  return '<a href=\\"'+href.replace(/javascript:/,"javascript:parent.")+'\\">'+text+'</a>';
}
function datefmt(theDate) {
  if (!isWhitespace(theDate)) {
    return theDate.substr(0,4)+"-"+
           theDate.substr(4,2)+"-"+
           theDate.substr(6,2)+" 00:00:00"
  }
}
</script>
<style type=text/css>
.Timeline {
 width:100%;
 border:0;
 margin:0;
 padding:0;
}
.Timeline iframe {
 width:100%;
 border:0;
 margin:0;
 padding:0;
}
</style>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0)" style="overflow:hidden">
<div id=HeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB98.01.003";
PatientVIS="%PATWEB98.01.081";
PatientNAM="%PATWEB98.01.002";
PatientSTA="%PATWEB98.01.086.078";
PatientALT="%PATWEB98.01.084";
PatientSEX="%PATWEB98.01.019";
PatientDOB="%PATWEB98.01.020";
PatientAGE="%PATWEB98.01.021";
PatientLOC="%PATWEB98.01.083";
PatientPRI="%PATWEB98.01.086.066.1";
PatientUNT="%PATWEB98.01.066.0";
DoctorCOD="%PATWEB98.01.082.003";
DoctorNAM="%PATWEB98.01.082.002";
PatientAID="%PATWEB98.01.086.090";
PatientIND="%PATWEB98.01.086.091";
PatientCUR="%PATWEB98.01.086.092";
PatientCLC="%PATWEB98.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB98.01.086.094";
PatientCDM="%PATWEB98.01.086.095";
PatientVDH="%PATWEB98.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<table width=100% cellpadding=1 cellspacing=0 border=0>
<tr><td class=HeadingCell>
      <input type=button class=button value="Administrative"
       onclick="InitTable(0);">
      <input type=button class=button value="Clinical"
       onclick="InitTable(1);">
    </td>
</tr>
</table>
</div>

<div id=TableLocation></div>

<script type="text/javascript">
function AddTableRows() {
%PATWEB98.01.301.patweb98.01.001.0.0
UGAppointmentList(PatientURN,"PATWEB98.01.301");
}
</script>


<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB98.01.003">
<input type=hidden name=admissno value="%PATWEB98.01.081">
<input type=hidden name=MenuType value="%PATWEB98.01.088">
<input type=hidden name=casekeys value="                        ">
<input type=hidden name=outpsite value="%STANDARD.01.023">
<input type=hidden name=claimcode value="%STANDARD.01.017.CL">
</form>
