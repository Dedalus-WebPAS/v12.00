<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="nz">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">

function SelectPeriodSubmit() {
  SelectPeriod.submit();
}

function AddHONOS(urn,adn,uniq,honostype) {
  var temp="002";
  hontype=honostype.substr(3,1);
  if(hontype=="C"){
     temp="004";}
  if(hontype=="L"){
     temp="006";}
  if(hontype=="S"){
     temp="018";}
  if(hontype=="M"){
     temp="022";}
  linkurl="allweb06.pbl?reportno=04&template=" + temp +
           "&urnumber=" + urn.replace(/ /g,"+") +
           "&admissno=" + adn.replace(/ /g,"+") +
           "&honostyp=" + honostype.replace(/ /g,"+");
  Left=(document.body.clientWidth-1000)/2
  DFrameLink(linkurl,100,Left,1000,680);
}

function UpdateHONOS(urn,adn,uniq,honostype) {
  var temp="003";
  hontype=honostype.substr(3,1);
  if(hontype=="C"){
     temp="005";}
  if(hontype=="L"){
     temp="007";}
  if(hontype=="S"){
     temp="019";}
  if(hontype=="M"){
     temp="023";}
  linkurl="allweb06.pbl?reportno=04&template=" + temp +
           "&urnumber=" + urn.replace(/ /g,"+") +
           "&admissno=" + adn.replace(/ /g,"+") +
           "&mhhon001=" + adn.replace(/ /g,"+") +
           "&mhhon002=" + uniq.replace(/ /g,"+") 
  Left=(document.body.clientWidth-1000)/2;
  DFrameLink(linkurl,100,Left,1000,680);
}
function UpdateHONOSNew(urn,adn,uniq,honostype) {
  linkurl="allweb06.pbl?reportno=04&template=027" +
           "&urnumber=" + urn.replace(/ /g,"+") +
           "&admissno=" + adn.replace(/ /g,"+") +
           "&mhhon001=" + adn.replace(/ /g,"+") +
           "&mhhon002=" + uniq.replace(/ /g,"+")
  Left=(document.body.clientWidth-1000)/2;
  DFrameLink(linkurl,100,Left,1000,680);
}

function RefreshHonos() {
  f = document.SelectPeriod;
  f.honfiltr.value = f.d_honfil.value;
  f.filtstat.value = f.d_filtstat.value;
  f.submit();
}
function OMFilterSubmit() {
  document.SelectPeriod.omeasure.value=
  document.SelectPeriod.d_omeas.value.substring(0,3);
  document.SelectPeriod.submit();
}
function SetMandatory() {
  f = document.SelectPeriod;
  i = f.d_filtstat.selectedIndex;
  var status = f.d_filtstat.options[i].value;
  if (status == "N") {
    f.deptcode.className = "Mandatory"; 
  }
  else {
    f.deptcode.className = "";
  }
}
function RespHcpChange() {
  f = document.SelectPeriod;
  if (isWhitespace(f.doctcode.value)) {
    clrFields(f.doctcode,f.psevt000,SelectPeriodSubmit);
  }
  else {
    ValidateHCP(18,0,f.doctcode,f.psevt000,SelectPeriodSubmit);
  }
}
function CaseTeamChange() {
  f = document.SelectPeriod;
  if (isWhitespace(f.caseteam.value)) {
    clrFields(f.caseteam,f.n_caseteam,SelectPeriodSubmit);
  }
  else {
    validateCode2(7,f.caseteam,f.n_caseteam,SelectPeriodSubmit);
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);SetMandatory();">

<form name=PatientLinks action=allweb06.pbl method=get style="margin:0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=014>
<input type=hidden name=urnumber>
<input type=hidden name=admissno>
<input type=hidden name=honostyp>
<input type=hidden name=wbsedall value="%STANDARD.01.028">
</form>

<form name=SelectPeriod action=allweb06.pbl method=get style="margin:0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=14>
<input type=hidden name=viewtype value="%ALLWEB06.04.203">
<input type=hidden name=wbsesite value="%STANDARD.01.023">
<input type=hidden name=wbseclid value="%STANDARD.01.026">
<input type=hidden name=honfiltr value="%ALLWEB06.04.216">
<input type=hidden name=omeasure value="%ALLWEB06.04.217">
<input type=hidden name=deftflag value=1>
<input type=hidden name=norecord value=10>
<input type=hidden name=filtstat value="%ALLWEB06.04.230">
<input type=hidden name=statschg value="%ALLWEB06.04.231">

<table width=100% cellspacing=0 border=0 bgcolor=#cccccc>
<tr>
  <td>Department</td>
  <td>
    <select class=PMenuSelectList name=deptcode 
     onchange="SelectPeriodSubmit();">
    <option></option>
    %ALLWEB06.04.218
    </select>
  </td>
  <td class=DataLabel>Responsible HCP</td>
  <td>
    <input type=text name=doctcode value="%ALLWEB06.04.205.0"
     class=DataField size=10 maxlength=10
     onchange="UpCase(this);RespHcpChange();">
    <input type=text name=psevt000 title="Responsible HCP" readonly
     size=24 value="%ALLWEB06.04.205.1">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="HCPSearchFrame(SelectPeriod.doctcode,SelectPeriod.psevt000,
              7,SelectPeriodSubmit);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(SelectPeriod.doctcode,SelectPeriod.psevt000,
              SelectPeriodSubmit);">
  </td>
  <td class=DataLabel>Case Team</td>
  <td>
    <input type=text name=caseteam value="%ALLWEB06.04.220.0" class=DataField
     size=11 maxlength=11 title="Case Team"
     onchange="UpCase(this);CaseTeamChange();">
    <input type=text name=n_caseteam title="Team Description" readonly size=42
     class=Readonly value="%ALLWEB06.04.220.1">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="TeamSearchFrame(SelectPeriod.caseteam,SelectPeriod.n_caseteam,
              SelectPeriodSubmit)">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(SelectPeriod.caseteam,SelectPeriod.n_caseteam,
              SelectPeriodSubmit);">
  </td></tr>
  <td>Outcome Measure</td>
  <td>
    <select name=d_omeas onchange="OMFilterSubmit();">
      <option></option>
      %ALLWEB06.04.103.2
    </select>
  </td>
  <td>Outcome Review Date</td>
  <td>
    <input type=button value="<<" class=SmallButton
     onclick='location.href="%ALLWEB06.04.207"'>
    %ALLWEB06.04.209 
    <input type=button value=">>" class=SmallButton
     onclick='location.href="%ALLWEB06.04.206"'>
    <a href='javascript:SelectDateFrame();'>
    <img src="../images/DateLookup.gif" class="Icon"
     alt="Select Date"></a>
    <a href='javascript:SelectView("0");'>
    <img src=../images/DayIcon.gif class="Icon"
     alt="View Today"></a>
    <a href='javascript:SelectView("1");'>
    <img src=../images/WeekIcon.gif class="Icon"
     alt="View This Week"></a>
    <a href='javascript:SelectView("2");'>
    <img src=../images/MonthIcon.gif class="Icon"
     alt="View This Month"></a>
  </td>  
  <td>Status</td>
  <td>  
    <select name=d_filtstat onchange="RefreshHonos();">
      <option value="I">Incomplete/Review</option>
      <option value="N">New</option>
    </select>
  </td>  
  <td class=DataLabel>Record Type</td>
  <td>
    <select name=d_honfil onchange="RefreshHonos();">
      <option value=1>All</option>
      <option value=2>ADOM</option>
      <option value=3>HONOS</option>
    </select>
  </td>
</tr>
</table>
</form>
</div>

<table width=100% cellspacing=0 border=1 bgcolor=#cccccc>
<tr>
  <td width=95% class=HeadingCell align=center> 
    Outcome Measures Review List
  </td>
  <td class=HeadingCell align=right>
    <img src='../images/PrinterIcon.gif' class=Icon alt='Print Page' 
     onclick='print();'>
  </td>
</tr>
</table>

<div id=TableLocation></div>
<table width=100% cellspacing=0 border=1>
<tr>
  <td class=HeadingCell>Patient</td>
  <td class=HeadingCell>Review Date</td>
  <td class=HeadingCell>Responsible HCP</td>
  <td class=HeadingCell>Performing HCP</td>
  <td class=HeadingCell>Case Team</td>
  <td class=HeadingCell>Collection Date</td>
  <td class=HeadingCell>Outcome Measure</td>
  <td class=HeadingCell>Status</td>
</tr>
%ALLWEB06.04.202.1
</table>

<table width=100% bgcolor=#CCCCCC>
<tr>
  <td align=center>
    <input type=button value="<< Previous" class=button
     onclick='location.href="%ALLWEB06.04.212.014"'>
    <input type=button value="Next >>" class=button
     onclick='location.href="%ALLWEB06.04.211.014"'>
  </td>
</tr>
</table>

<script type="text/javascript">
f = document.SelectPeriod;
var val = f.honfiltr.value;
var hf = f.d_honfil;
for(i=0; i<hf.options.length; i++){
  if(hf.options[i].value==val){
    hf.selectedIndex=i;
    break;
  }
}
for(i=0; i<document.SelectPeriod.d_omeas.length; i++){
  if(document.SelectPeriod.d_omeas.options[i].value.substring(0,3)==
     document.SelectPeriod.omeasure.value){
     document.SelectPeriod.d_omeas.selectedIndex=i;
     break;
  }
}
var val = f.filtstat.value;
var fs = f.d_filtstat;
for(i=0; i < fs.options.length; i++) {
  if(fs.options[i].value == val) {
    fs.selectedIndex = i;
    break;
  }
}
</script>
