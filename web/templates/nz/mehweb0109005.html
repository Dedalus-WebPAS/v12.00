<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="nz">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/mehweb0109005.js"></script>
<script type="text/javascript">
function CheckStatus() {

  var newExpiryDate = new Date();
  if (document.AddForm.mhdls004.value.substr(6,1)=="1")
  {
    if (document.AddForm.mhdls004.value.substr(7,1)=="H")
    {
      if (!isWhitespace(document.AddForm.mhdls002.value)&&
          !isWhitespace(document.AddForm.mhdls004.value.substr(25,6))&&
          !isWhitespace(document.AddForm.mhdls003.value))
      {

        newExpiryDate.setDate(parseInt(document.AddForm.mhdls002.value.substring(0,2)));

        var varMonth = 0;
        if (document.AddForm.mhdls002.value.substr(3,3)=="Jan"){varMonth=0;}
        if (document.AddForm.mhdls002.value.substr(3,3)=="Feb"){varMonth=1;}
        if (document.AddForm.mhdls002.value.substr(3,3)=="Mar"){varMonth=2;}
        if (document.AddForm.mhdls002.value.substr(3,3)=="Apr"){varMonth=3;}
        if (document.AddForm.mhdls002.value.substr(3,3)=="May"){varMonth=4;}
        if (document.AddForm.mhdls002.value.substr(3,3)=="Jun"){varMonth=5;}
        if (document.AddForm.mhdls002.value.substr(3,3)=="Jul"){varMonth=6;}
        if (document.AddForm.mhdls002.value.substr(3,3)=="Aug"){varMonth=7;}
        if (document.AddForm.mhdls002.value.substr(3,3)=="Sep"){varMonth=8;}
        if (document.AddForm.mhdls002.value.substr(3,3)=="Oct"){varMonth=9;}
        if (document.AddForm.mhdls002.value.substr(3,3)=="Nov"){varMonth=10;}
        if (document.AddForm.mhdls002.value.substr(3,3)=="Dec"){varMonth=11;}
        newExpiryDate.setMonth(parseInt(varMonth));

        newExpiryDate.setFullYear(document.AddForm.mhdls002.value.substr(7,4));
        
        newExpiryDate.setHours(document.AddForm.mhdls003.value.substr(0,2));

        newExpiryDate.setMinutes(document.AddForm.mhdls003.value.substr(3,2));

        newExpiryDate.setSeconds(document.AddForm.mhdls003.value.substr(6,2));

        var newHours = newExpiryDate.getHours() +
                      parseInt(document.AddForm.mhdls004.value.substr(25,6));

        newExpiryDate.setHours(parseInt(newHours));

        varMonth = "   ";
        if (newExpiryDate.getMonth()==0) {varMonth="Jan";}
        if (newExpiryDate.getMonth()==1) {varMonth="Feb";}
        if (newExpiryDate.getMonth()==2) {varMonth="Mar";}
        if (newExpiryDate.getMonth()==3) {varMonth="Apr";}
        if (newExpiryDate.getMonth()==4) {varMonth="May";}
        if (newExpiryDate.getMonth()==5) {varMonth="Jun";}
        if (newExpiryDate.getMonth()==6) {varMonth="Jul";}
        if (newExpiryDate.getMonth()==7) {varMonth="Aug";}
        if (newExpiryDate.getMonth()==8) {varMonth="Sep";}
        if (newExpiryDate.getMonth()==9) {varMonth="Oct";}
        if (newExpiryDate.getMonth()==10) {varMonth="Nov";}
        if (newExpiryDate.getMonth()==11) {varMonth="Dec";}

        document.AddForm.mhdls006.value=newExpiryDate.getDate() +" "+
                                           varMonth +" "+
                                           newExpiryDate.getFullYear();

        if(newExpiryDate.getHours().toString().length==1) {
          document.AddForm.mhdls007.value="0"+
          newExpiryDate.getHours().toString()+":";
        } else {
          document.AddForm.mhdls007.value=
          newExpiryDate.getHours().toString()+":";
        }

        if(newExpiryDate.getMinutes().toString().length==1) {
          document.AddForm.mhdls007.value=
          document.AddForm.mhdls007.value.toString()+"0"+
          newExpiryDate.getMinutes().toString()+":";
        } else {
          document.AddForm.mhdls007.value=
          document.AddForm.mhdls007.value.toString()+
          newExpiryDate.getMinutes().toString()+":";
        }

        if(newExpiryDate.getSeconds().toString().length==1) {
          document.AddForm.mhdls007.value=
          document.AddForm.mhdls007.value.toString()+"0"+
          newExpiryDate.getSeconds().toString();
        } else {
          document.AddForm.mhdls007.value=
          document.AddForm.mhdls007.value.toString()+
          newExpiryDate.getSeconds().toString();
        }
      }
    }
    else
    {
      if (!isWhitespace(document.AddForm.mhdls002.value)&&
          !isWhitespace(document.AddForm.mhdls004.value.substr(25,6)))
      {
//    alert("1");
        var serverURL   = "../cgi-bin/patweb80.pbl?reportno=96" +
           "&valdcode=" + document.AddForm.mhdls002.value.replace(/ /g,"+") +
           document.AddForm.mhdls004.value.substr(25,6).replace(/ /g,"+") +
           document.AddForm.mhdls004.value.substr(7,1).replace(/ /g,"+") +
           document.AddForm.mhdls003.value.replace(/ /g,"+");

//alert(serverURL);

        var returnValue = RSExecute(serverURL);
        if (returnValue.status==0)
        {
          ReturnValue=returnValue.return_value.split("|")
//alert(ReturnValue);
          document.AddForm.mhdls006.value=trim(ReturnValue[0])
          document.AddForm.mhdls007.value=document.AddForm.mhdls003.value;
        }
      }
    }
  }
  else
  {
    if (document.AddForm.mhdls004.value.substr(6,1)=="2")
    {
      if (document.AddForm.mhdls004.value.substr(7,1)=="H")
      {
        if (!isWhitespace(document.AddForm.precdate.value)&&
            !isWhitespace(document.AddForm.mhdls004.value.substr(25,6))&&
            !isWhitespace(document.AddForm.prectime.value))
        {

          newExpiryDate.setDate(parseInt(document.AddForm.precdate.value.substring(0,2)));

          var varMonth = 0;
          if (document.AddForm.precdate.value.substr(3,3)=="Jan"){varMonth=0;}
          if (document.AddForm.precdate.value.substr(3,3)=="Feb"){varMonth=1;}
          if (document.AddForm.precdate.value.substr(3,3)=="Mar"){varMonth=2;}
          if (document.AddForm.precdate.value.substr(3,3)=="Apr"){varMonth=3;}
          if (document.AddForm.precdate.value.substr(3,3)=="May"){varMonth=4;}
          if (document.AddForm.precdate.value.substr(3,3)=="Jun"){varMonth=5;}
          if (document.AddForm.precdate.value.substr(3,3)=="Jul"){varMonth=6;}
          if (document.AddForm.precdate.value.substr(3,3)=="Aug"){varMonth=7;}
          if (document.AddForm.precdate.value.substr(3,3)=="Sep"){varMonth=8;}
          if (document.AddForm.precdate.value.substr(3,3)=="Oct"){varMonth=9;}
          if (document.AddForm.precdate.value.substr(3,3)=="Nov"){varMonth=10;}
          if (document.AddForm.precdate.value.substr(3,3)=="Dec"){varMonth=11;}
          newExpiryDate.setMonth(parseInt(varMonth));

          newExpiryDate.setFullYear(document.AddForm.precdate.value.substr(7,4));

          newExpiryDate.setHours(document.AddForm.prectime.value.substr(0,2));

          newExpiryDate.setMinutes(document.AddForm.prectime.value.substr(3,2));

          newExpiryDate.setSeconds(document.AddForm.prectime.value.substr(6,2));

          var newHours = newExpiryDate.getHours() +
                         parseInt(document.AddForm.mhdls004.value.substr(25,6));
 
          newExpiryDate.setHours(parseInt(newHours));

          varMonth = "   ";
          if (newExpiryDate.getMonth()==0) {varMonth="Jan";}
          if (newExpiryDate.getMonth()==1) {varMonth="Feb";}
          if (newExpiryDate.getMonth()==2) {varMonth="Mar";}
          if (newExpiryDate.getMonth()==3) {varMonth="Apr";}
          if (newExpiryDate.getMonth()==4) {varMonth="May";}
          if (newExpiryDate.getMonth()==5) {varMonth="Jun";}
          if (newExpiryDate.getMonth()==6) {varMonth="Jul";}
          if (newExpiryDate.getMonth()==7) {varMonth="Aug";}
          if (newExpiryDate.getMonth()==8) {varMonth="Sep";}
          if (newExpiryDate.getMonth()==9) {varMonth="Oct";}
          if (newExpiryDate.getMonth()==10) {varMonth="Nov";}
          if (newExpiryDate.getMonth()==11) {varMonth="Dec";}

          document.AddForm.mhdls006.value=newExpiryDate.getDate() +" "+
                                             varMonth +" "+
                                             newExpiryDate.getFullYear();

          if(newExpiryDate.getHours().toString().length==1) {
            document.AddForm.mhdls007.value="0"+
            newExpiryDate.getHours().toString()+":";
          } else {
            document.AddForm.mhdls007.value=
            newExpiryDate.getHours().toString()+":";
          }

          if(newExpiryDate.getMinutes().toString().length==1) {
            document.AddForm.mhdls007.value=
            document.AddForm.mhdls007.value.toString()+"0"+
            newExpiryDate.getMinutes().toString()+":"; 
          } else {
            document.AddForm.mhdls007.value=
            document.AddForm.mhdls007.value.toString()+
            newExpiryDate.getMinutes().toString()+":";
          }

          if(newExpiryDate.getSeconds().toString().length==1) {
            document.AddForm.mhdls007.value=
            document.AddForm.mhdls007.value.toString()+"0"+
            newExpiryDate.getSeconds().toString();
          } else {
            document.AddForm.mhdls007.value=
            document.AddForm.mhdls007.value.toString()+
            newExpiryDate.getSeconds().toString();
          }
        }
      }
      else
      {
        if (!isWhitespace(document.AddForm.precdate.value)&&
            !isWhitespace(document.AddForm.mhdls004.value.substr(25,6)))
        {
//     alert("2");
          var serverURL   = "../cgi-bin/patweb80.pbl?reportno=96" +
             "&valdcode=" + document.AddForm.precdate.value.replace(/ /g,"+") +
             document.AddForm.mhdls004.value.substr(25,6).replace(/ /g,"+") +
             document.AddForm.mhdls004.value.substr(7,1).replace(/ /g,"+") +
             document.AddForm.prectime.value.replace(/ /g,"+");

//alert(serverURL);

          var returnValue = RSExecute(serverURL);
          if (returnValue.status==0)
          {
            ReturnValue=returnValue.return_value.split("|");
//alert(ReturnValue);
            document.AddForm.mhdls006.value=trim(ReturnValue[0]);
            document.AddForm.mhdls007.value=document.AddForm.prectime.value;
          }
        }
      }
    }
  }
}
function GetLSManCookie() {
  if (GetCookieData("lsmancookie")!="unknown") {
    document.getElementById("lsmancki").value=GetCookieData("lsmancookie");
    ExpireCookiePath("lsmancookie");
  }
}
function CancelButtonSubroutine() {
  if (document.getElementById('lsmancki').value == '1') {
      parent.location.href = 'mehweb01.pbl?reportno=09&template=003&urnumber=' +
      document.AddForm.urnumber.value.replace(/ /g,'+') +
      '&admissno=' + document.AddForm.admissno.value.replace(/ /g,'+') +
      '&uniqnumb=' + document.AddForm.uniqnumb.value.replace(/ /g,'+');
  } else {
    DFrameExitRefresh();
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);setTimeout('GetDates(AddForm.mhdls004)',100);
              GetDates(AddForm.mhdls004);GetLSManCookie();">
<span class=DFrameTitleBar>
<img align=right alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
Legal Status Details
</span>
<form name=AddForm action="mehweb01.pbl" method=post style="margin:0">
<input type=hidden name=reportno value="9">
<input type=hidden name=updttype value="I">
<input type=hidden name=urnumber value="%MEHWEB01.09.003">
<input type=hidden name=admissno value="%MEHWEB01.09.081">
<input type=hidden name=uniqnumb value="%MEHWEB01.09.101">
<input type=hidden name=nextpage value="0">
<input type=hidden name=mhdls012 value="">
<input type=hidden name=mhdls013 value="">
<input type=hidden name=precdate value="%MEHWEB01.09.412">
<input type=hidden name=prectime value="%MEHWEB01.09.413"> 
<input type=hidden name=currdate>
<input type=hidden name=currtime>
<input type=hidden name=defldate value="%STANDARD.01.015">
<input type=hidden name=lsmancki id=lsmancki value="">
<input type=hidden name=redirect value="">
<input type=hidden name=d_mhhlsdat value="%MEHWEB01.09.102">
<input type=hidden name=d_mhhlstim value="%MEHWEB01.09.103">
<input type=hidden name=trothfac value="">
<input type=hidden name=d_pbdate value="%MEHWEB01.09.020"> 

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td width=12% class=DataLabel>Start Date</td>
    <td class=DataLabel>
    <input type=text name=mhdls002 title="Legal Status Start Date" size=12
     class="Date Mandatory NotFuturEdate" 
     onblur="checkDate(this,'Date');validateTime(AddForm.mhdls002,
     AddForm.mhdls003);GetDates(AddForm.mhdls004);">
    <img src="../images/DateLookup.gif" class=Icon date=date1
     onclick="DateLookupFrame(AddForm.mhdls002);">
     Time
    <input type=text size=8 title="Start Time" name=mhdls003
     value=" " class="Mandatory Time" onblur="checkTime(this);
     CheckStatus();validateTime(AddForm.mhdls002,AddForm.mhdls003);">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(AddForm.mhdls002,AddForm.mhdls003);">
    <img src="../images/TimeLookup.gif" class=Icon 
     onclick="TimeLookupFrame(AddForm.mhdls003);">
    </td>
    <td class=DataLabel>Transfer In From Another Facility</td>
    <td align=left>
    <input type="checkbox" name=chkothfa value="0">
    </td>
</tr>

<tr><td class=DataLabel>End Date</td>
    <td class=DataLabel>
    <input type=text name=mhdls017 title="End Date" class="NotFuturEdate"
     size=12 onblur="setEndTime();validateTime(AddForm.mhdls017,
     AddForm.mhdls018);">
    <img src="../images/DateLookup.gif" class=Icon date=date1
     onclick="DateLookupFrame(AddForm.mhdls017);">
     Time  
    <input type=text size=8 title="End Time" name=mhdls018
     value=" " class="Time" 
     onblur="validateTime(AddForm.mhdls017,AddForm.mhdls018);">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(AddForm.mhdls017,AddForm.mhdls018);">
    <img src="../images/TimeLookup.gif" class=Icon 
     onclick="TimeLookupFrame(AddForm.mhdls018);">
    </td>
</tr>

<tr><td class=DataLabel>Legal Status</td>
    <td><select name=mhdls004 title="Legal Status" class="Mandatory"
         onchange="CheckStatus();GetDates(this);">
        <option></option>
        %MEHWEB01.09.324
        </select></td>

    <td width=15% class=DataLabel>Supp. Legal Status</td>
    <td><select name=mhdls019 title="Supp. Legal Status">
        <option></option>
         %STANDARD.01.021.LS
        </select></td>
</tr>

<tr><td class=DataLabel>Review Status</td>
    <td><select name=mhdls005 title="Review Status">
        <option></option>
         %STANDARD.01.021.LR
        </select></td>

    <td class=DataLabel>Supp. LS Effective Date</td>
    <td class=DataLabel>
        <input type=text name=mhdls020 title="Supp. LS Effective Date" 
         size=12 value=" " class="Date" onblur="checkDate(this,'Date');">
    <img src="../images/DateLookup.gif" class=Icon date=date1
         onclick="DateLookupFrame(AddForm.mhdls020);">
    </td>
</tr>

<tr><td class=DataLabel>Review HCP</td>
    <td><input type="text" size=10 maxlength=10 name="mhdls008" tabindex=13
       onblur="UpCase(this);ValidateHCP(18,18,AddForm.mhdls008,
       AddForm.doctnam1);">
       <input type="text" size=25 notab readonly name="doctnam1">
       <img src="../images/SearchIcon.gif" class=Icon
        onclick="HCPSearchFrame(AddForm.mhdls008,AddForm.doctnam1,9);">
    </td>

    <td class=DataLabel>Date Review performed</td>
    <td class=DataLabel>
        <input type=text name=mhdls021 title="Date Review Performed" size=12	
         value=" " class="NotFuturEdate" onblur="checkDate(this,'Date');">
    <img src="../images/DateLookup.gif" class=Icon date=date1
         onclick="DateLookupFrame(AddForm.mhdls021);">
    </td>
</tr>

<tr><td class=DataLabel>Review Location</td>
    <td><select name=mhdls010 title="Review Location">
        <option></option>
        %MEHWEB01.09.231.9.1.01.1.L
        </select></td>

    <td colspan=1><div id=CnsDate1></div></td>
    <td colspan=1><div id=CnsDate2></div></td>
</tr>

<tr><td class=DataLabel>Review Due Date</td>
    <td class=DataLabel>
    <input type=text name=mhdls006 title="Review Due Date" class="Date"
     size=12 onblur="checkDate(this,'Date');">
    <img src="../images/DateLookup.gif" class=Icon date=date1
     onclick="DateLookupFrame(AddForm.mhdls006);">
     Time
    <input type=text size=8 title="Review Due Time" name=mhdls007
     value=" " class="Time">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(AddForm.mhdls006,AddForm.mhdls007);">
    <img src="../images/TimeLookup.gif" class=Icon
     onclick="TimeLookupFrame(AddForm.mhdls007);">
    </td>

    <td colspan=1><div id=TriDate1></div></td>
    <td colspan=1><div id=TriDate2></div></td>
</tr>

<tr><td class=DataLabel>Reminder Date</td>
    <td><input type=text name=mhdls011 title="Reminder Date" size=12
     value="" class="Date" 
     onblur="checkDate(this,'Date');">
    <img src="../images/DateLookup.gif" class=Icon date=date1
     onclick="DateLookupFrame(AddForm.mhdls011);">
    </td>

    <td colspan=1><div id=LogDate1></div></td>
    <td colspan=2><div id=LogDate2></div></td>
</tr>

<tr><td class=DataLabel></td>
    <td> &nbsp; </td>

    <td colspan=1><div id=CrtTime1></div></td>
    <td colspan=1><div id=CrtTime2></div></td>
</tr>
</table>

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td width=12% class=DataLabel>Comments 1</td>
    <td><input type="text" size="120" maxlength="100" name=mhdls016
         title="Comments" tabindex=18>
    </td>
</tr>
<tr><td width=12% class=DataLabel>Comments 2</td>
    <td><input type="text" size="120" maxlength="100" name=mhdls026
         title="Comments" tabindex=19>
    </td>
</tr>

<tr><td colspan=4 align=center><br>
    <input tabindex=31 type=button value="Add" class="button" name=addbutton
     onclick="if (document.getElementById('lsmancki').value == '1') {
   document.AddForm.nextpage.value='4';
   document.AddForm.redirect.value=
   'mehweb01.pbl?reportno=09&template=003&urnumber=' +
   document.AddForm.urnumber.value.replace(/ /g,'+') +
   '&admissno=' + document.AddForm.admissno.value.replace(/ /g,'+') +
   '&uniqnumb=' + document.AddForm.uniqnumb.value.replace(/ /g,'+');
   }
   chkenddatetime();">
    <input type=button Value="Cancel" class="button" 
     onclick="CancelButtonSubroutine();">
    </td>
</tr>
</table>
</form>

<span id=PlaceResd style="display:none">
<table cellspacing=0 cellpadding=1 border=0 width=100%>
<tr><td class=DataLabel width=17%>Place of Residence</td>
    <td><select name=mhdls014 title="Place of Residence">
        <option></option>
        %MEHWEB01.09.214.2
        </select></td>
</tr></table>
</span>

<span id=CrtNotice1 style="display:none">
    <td class=DataLabel>Court Notice Sent Date</td>
</span>

<span id=CrtNotice2 style="display:none">
    <td><input type=text name=mhdls022 title="Court Notice Sent Date"
     size=12 class="Date" onblur="checkDate(this,'Date');">
    <img src="../images/DateLookup.gif" class=Icon date=date1
     onclick="DateLookupFrame(AddForm.mhdls022);">
    </td>
</span>

<span id=TribunalD1 style="display:none">
    <td class=DataLabel>Tribunal Date</td>
</span>

<span id=TribunalD2 style="display:none">
    <td><input type=text name=mhdls023 title="Tribunal Date"
     size=12 class="Date" onblur="checkDate(this,'Date');">
    <img src="../images/DateLookup.gif" class=Icon date=date1
     onclick="DateLookupFrame(AddForm.mhdls023);">
    </td>
</span>

<span id=LodgedDat1 style="display:none">
    <td class=DataLabel>Lodged with Court Date</td>
</span>

<span id=LodgedDat2 style="display:none">
    <td><input type=text name=mhdls024 title="Lodged with Court Date"
     size=12 class="Date" onblur="checkDate(this,'Date');">
    <img src="../images/DateLookup.gif" class=Icon date=date1
     onclick="DateLookupFrame(AddForm.mhdls024);">
    </td>
</span>

<span id=CourtTime1 style="display:none">
    <td class=DataLabel>%STANDARD.01.017.xy</td>
</span>

<span id=CourtTime2 style="display:none">
    <td><select name=mhdls025 title="Court Type">
        <option></option>
         %STANDARD.01.021.xy 
        </select></td>
</span>

<script type="text/javascript">
Defaultlegalstat="%STANDARD.01.025.069.094.0.3"
for (var i =0 ; i < document.AddForm.mhdls004.length; i++) {
  if (document.AddForm.mhdls004.options[i].value.substr(0,3)==Defaultlegalstat)
  {
    document.AddForm.mhdls004.selectedIndex=i;
  } 
}

function setEndTime() {
  document.AddForm.mhdls004.selectedIndex=0;
  FirstLS="%MEHWEB01.09.421"
  if (FirstLS=="0") {
    Defaultlegalstat="%STANDARD.01.025.069.094.0.3"
    for (var i =0 ; i < document.AddForm.mhdls004.length; i++) {
      if (document.AddForm.mhdls004.options[i].value.substr(0,3)==Defaultlegalstat)
      { 
        document.AddForm.mhdls004.selectedIndex=i;
      }
    }
  }
  checkDate(document.AddForm.mhdls017,'Date');
  if (!isWhitespace(document.AddForm.mhdls017.value)) {
      document.AddForm.mhdls018.className="Mandatory";
  }
  else {
    document.AddForm.mhdls018.className="";
  }
}
function chkenddatetime() {
  strtDate=AddForm.mhdls002;
  strtTime=AddForm.mhdls003;
  endDate=AddForm.mhdls017;
  endTime=AddForm.mhdls018;

  if (!ChkDateTime(strtDate,strtTime,endDate,endTime)) {
    alert("Start Date/Time must be before End Date/Time.");
    AddForm.mhdls017.value="";
    AddForm.mhdls018.value="";
    AddForm.mhdls018.className="";
    return;
  }
  if(!CheckDateRange(AddForm.d_pbdate,
                     AddForm.mhdls002)) {
    return;
  }

  if(AddForm.chkothfa.checked == true) {
    AddForm.trothfac.value="1";
    if(!CheckDateTimeRange(AddForm.mhdls002,
                           AddForm.mhdls003,
                           AddForm.d_mhhlsdat,
                           AddForm.d_mhhlstim)) {
      alert("Date/Time cannot be after Current Legal Status Date/Time \n" +
            "when Transfer In From Another Facility is checked");
      return;
    }
  }
  else {
    document.AddForm.trothfac.value="0";
  }

  FormSubmit();
}
</script>
