<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="nz">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">

function MergePatients() {
if(validateMandatory(UpdateForm)) {
 if (UpdateForm.urnumbe1.value==UpdateForm.urnumbe2.value) {
   alert("Both U/R Number are the same.")
   return }

   AddForm.oldurnum.value=UpdateForm.urnumbe1.value
   AddForm.newurnum.value=UpdateForm.urnumbe2.value 
//
   document.AddForm.redirect.value="mrtweb02.pbl?reportno=5&template=001"
   + "&oldurnum=" + document.UpdateForm.urnumbe1.value.replace(/ /g,"+")
   + "&newurnum=" + document.UpdateForm.urnumbe2.value.replace(/ /g,"+")
//
   tempDisable(document.UpdateForm.pat83sub,10);
   AddForm.submit();
 }
}
//
function validateRecordID1() {
  if(isWhitespace(document.UpdateForm.urnumbe1.value)) {
    return;
  }
  if(document.UpdateForm.urnumbe1.value.length < 7 ) {
    alert("Must be a valid temporary U/R number");
    document.UpdateForm.urnumbe1.value="";
    document.UpdateForm.urnumbe1.focus();
    return;
  }
  ans=document.UpdateForm.urnumbe1.value.substr(1,1);
  if(ans != "-" ) {
    alert("Must be a valid temporary U/R number");
    document.UpdateForm.urnumbe1.value="";
    document.UpdateForm.urnumbe1.focus();
    return;
  }
 p=document.UpdateForm
 if(p.urnumbe1.value!="") {
   LenUR=p.urnumbe1.value.length
   if (LenUR < 9) { 
      Count= 8 - LenUR ;
      Blanks="";
      for (i=0; i < Count;i++) { Blanks+=" ";}
      p.urnumbe1.value=Blanks + p.urnumbe1.value }
   validateCode(13,p.urnumbe1,p.fna1,UpdateUR1,p.sex1,p.dob1,p.pce1,p.dum1,p.admissn1,
         p.da1,p.typ1,p.age1,p.medi1,p.adda1,p.addb1,p.sub1,p.addc1,p.post1)}
}
//
function validateRecordID2() {
 p=document.UpdateForm
 if(p.urnumbe2.value!="") {
   LenUR=p.urnumbe2.value.length
   if (LenUR < 9) { 
      Count= 8 - LenUR ;
      Blanks="";
      for (i=0; i < Count;i++) { Blanks+=" ";}
      p.urnumbe2.value=Blanks + p.urnumbe2.value }

      var serverURL   = "../cgi-bin/patweb80.pbl?reportno=33" +
                    "&valdcode=" + p.urnumbe2.value.replace(/ /g,"+")

      var returnValue = RSExecute(serverURL);

      if (returnValue.status==0) {
        ReturnValue=returnValue.return_value.split("|")
        ExistFlag=ReturnValue[0];
        if (ExistFlag=="1") {
          alert("New U/R number already exists");
          document.UpdateForm.urnumbe2.value="";
          document.UpdateForm.urnumbe2.focus();
          return;
        }
      } else {
        document.UpdateForm.urnumbe2.value="";
        document.UpdateForm.urnumbe2.focus();
      }
    }
} 
//
function UpdateUR1() {
  if (document.UpdateForm.dum1.value != document.UpdateForm.urnumbe1.value) {
     alert("UR Number Merged with " + document.UpdateForm.dum1.value )
     document.UpdateForm.urnumbe1.value = document.UpdateForm.dum1.value }
}

</script>
%START.OF.PAGE
</head>
<body onload="PageLoad(event);">
<form name=UpdateForm method=post action=patweb83.pbl style=margin:0>
   <input type=hidden name=reportno value="2">
   <input type=hidden name=template value="002">
   <input type=hidden name=admissn1 value="">
   <input type=hidden name=admissn2 value="">
   <input type=hidden name=da1 value="">
   <input type=hidden name=da2 value="">
   <input type=hidden name=pce1 value="">
   <input type=hidden name=pce2 value="">
   <input type=hidden name=dum1 value="">
   <input type=hidden name=dum2 value="">
   <input type=hidden name=typ1 value="1">
   <input type=hidden name=typ2 value="1">
   <input type=hidden name=savealia value="1">
<table width=100% align=center border=0 cellspacing=0>
<tr><td align=center class=HeadingCell>
    Temp U/R Merge</td></tr>
</table>

<table width=95% align=center border=0 cellspacing=0>
<tr><td class=HeadingCell width=20%></td>
    <td class=HeadingCell width=40%>T-U/R (No longer required)</td>
    <td class=HeadingCell width=40%>New U/R</td></tr>

<tr><td class=DataLabel>U/R or Record ID</td>
    <td class=DataField>
    <input type=text  title="U/R No" name=urnumbe1 class=Mandatory size=10
     maxlength=8
     onblur='UpCase(this);validateRecordID1()'></td>
    <td class=DataField>
    <input type=text  title="U/R No" name=urnumbe2 class=Mandatory size=10
     maxlength=8
     onblur='UpCase(this);validateRecordID2()'></td></tr>

<tr><td class=DataLabel>Name</td>
    <td class=DataField>
    <input type=text name=fna1 size=50 readonly></td></tr>

<tr><td class=DataLabel>Date of Birth</td>
    <td class=DataLabel>
    <input type=text name=dob1 size=20 readonly>
    Age <input type=text name=age1 size=10 readonly></td></tr>

<tr><td class=DataLabel>Sex</td>
    <td class=DataField>
    <input type=text name=sex1 size=10 readonly></td></tr>

<tr><td class=DataLabel>Medicare Number</td>
    <td class=DataField>
    <input type=text name=medi1 size=10 readonly></td></tr>

<tr><td class=DataLabel>Address 1</td>
    <td class=DataField>
    <input type=text name=adda1 size=35 readonly></td></tr>

<tr><td class=DataLabel>Address 2</td>
    <td class=DataField>
    <input type=text name=addb1 size=35 readonly></td></tr>

<tr><td class=DataLabel>Address 3</td>
    <td class=DataField>
    <input type=text name=sub1 size=35 readonly></td></tr>

<tr><td class=DataLabel>Address 4</td>
    <td class=DataField>
    <input type=text name=addc1 size=35 readonly></td></tr>

<tr><td class=DataLabel>Postcode</td>
    <td class=DataField>
    <input type=text name=post1 size=8 readonly></td></tr>

<tr><td colspan=3 align=center>
    <input type=button id="pat83sub" value=Ok class="button" 
     onclick="MergePatients();">
    <input type=reset value=Clear class="button">
    </td></tr>
</table>
</form>

<table width=95% align=center border=0 cellspacing=0>
<form action=patweb83.pbl name=AddForm type=post>
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=001>
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="">
<input type=hidden name=oldurnum>
<input type=hidden name=newurnum>
<input type=hidden name=savealia value="1">
</form>
</table>

