<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="nz">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/EmrRegistration.js"></script>
<script type="text/javascript" src="../js/emrweb0202020.js"></script>
<script type="text/javascript">
function PatientSearch() {
  PatientSearchFrame(UpdateForm.dummyadm,
                     UpdateForm.emexp018,
                     UpdateForm.dummyadm,PatientReturn,UpdateForm.dummsrch);
}
function PatientReturn() {
  if(isWhitespace(document.UpdateForm.emexp018.value)) {
    return;
  }
             validateUrMerge(8,
               UpdateForm.emexp018,
               UpdateForm.gname,
               UpdateForm.selsex,
               UpdateForm.emexp005,
               UpdateForm.deceased,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.gname,
               UpdateForm.sname,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.selsex);

  if (UpdateForm.deceased.value=="1") {
    alert("Patient Deceased")
    UpdateForm.emexp018.value="";
    UpdateForm.gname.value="";
    UpdateForm.selsex.value="";
    UpdateForm.emexp005.value="";
    UpdateForm.emexp005.value="";
    return false; }
//
   if(!CheckEmrVisit(UpdateForm.emexp018.value,UpdateForm.emvis001.value)) {
       UpdateForm.emexp018.value="";
       UpdateForm.gname.value="";
       UpdateForm.emexp002.value="";
       UpdateForm.emexp003.value="";
       UpdateForm.emexp004.selectedIndex=0;
       UpdateForm.selsex.value="";
       UpdateForm.emexp005.value="";
       UpdateForm.emexp005.value="";
       return;
   }
//
  UpdateForm.emexp002.value=UpdateForm.gname.value.replace(/,/g,"")
  UpdateForm.emexp003.value=UpdateForm.sname.value.replace(/,/g,"")
  dispsex();
  return true;
}

function dispsex(){
 for (var i =0 ; i < document.UpdateForm.emexp004.length; i++) {
  if (trim(UpdateForm.emexp004.options[i].value.substr(0,1))==
      trim(UpdateForm.selsex.value)) {
       UpdateForm.emexp004.selectedIndex=i }
  }
}


function getPresentCom(SearchField,ReturnSelect,CatCode) {
  var serverURL   = "../cgi-bin/patweb80.pbl?reportno=32" +
                    "&valdcode=" + SearchField.value.replace(/ /g,"+") +
                    "&valdcatc=" + CatCode.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnSelect.options.length=0
    ReturnValue=returnValue.return_value.split("|");
    for (var j=0; j < ReturnValue.length; j++) {
       if (!isWhitespace(ReturnValue[j])) {
         SelectValue=ReturnValue[j].split(",");
         ReturnSelect.options[ReturnSelect.options.length]=
          new Option(SelectValue[1],SelectValue[0]); } } }
}
function Validateprecom001() {
    onblurHandler()
    var formatedtext=formateText(UpdateForm.prcom001,'50')
    if ((formatedtext.split(/[\r\n]/).length>6) ||
        (UpdateForm.prcom001.value.length > 300)) {
      alert("Presenting Complaint comments - Max 6 lines."
          + "\nPlease remove extra lines to continue.");
      document.UpdateForm.prcom001.focus();
      return; }
}
function DisplayDiv() {
Indicator=document.UpdateForm.emvis060.value.substr(13,1);
  if (Indicator=="I") {
     document.all.Triage.style.display="";
     document.all.Triage.innerHTML=document.all.EmergencyProc.innerHTML;
     }
  else {
     document.all.Triage.style.display="none";
     document.all.Triage.innerHTML="";}
}
function CancelLink() {
document.LinkForm.emexp001.value=document.UpdateForm.emexp001.value.replace(/ /g,"+")
document.LinkForm.submit();
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);SetFields();checkReferred();
      justifyRight(document.UpdateForm.emexp018);PatientReturn();">
<span class=DFrameTitleBar>
Register Emergency Expected Patient
</span>
<div id=PageBodySection>

<form name=UpdateForm action="emrweb02.pbl" method=post style="margin:0">
<input type=hidden name=reportno value="02">
<input type=hidden name=template value="20">
<input type=hidden name=updatety value="4">
<input type=hidden name=formactn>
<input type=hidden name=updttype>
<input type=hidden name=urnumber value="%EMRWEB02.02.003">
<input type=hidden name=admissno value="%EMRWEB02.02.081">
<input type=hidden name=updateky value="%EMRWEB02.02.700">
<input type=hidden name=nextpage value="14">
<input type=hidden name=redirect value="emrweb02.pbl?reportno=1&template=4">
<input type=hidden name=deceased>
<input type=hidden name=selsex>
<input type=hidden name=gname>
<input type=hidden name=sname>
<input type=hidden name=dummy>
<input type=hidden name=dummyadm> 
<input type=hidden name=dummsrch value="1">
<input type=hidden name=pcomdeft value="0">
<input type=hidden name=emexp001 value="%EMRWEB02.02.410">
<input type=hidden name=emexp007 value="">
<input type=hidden name=emexp008 value="">
<input type=hidden name=emexp009 value="">
<input type=hidden name=emexp010 value="">
<input type=hidden name=emexp011 value="">
<input type=hidden name=emexp012 value="">
<input type=hidden name=emexp013 value="">
<input type=hidden name=patsname value="%EMRWEB02.02.411">
<input type=hidden name=patgname value="%EMRWEB02.02.412">
  
<table align=center width=95% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel>U/R</td> 
   <td><input type=text size=10 maxlength=8 name=emexp018 tabindex=2
       title="U/R number" class=Mandatory value="%EMRWEB02.02.435"
       onblur="justifyRight(this);PatientReturn();">
       <img class=Icon src=../images/SearchIcon.gif onclick="PatientSearch();">
</td>
    <td class=DataLabel>Surname </td>
    <td><input type=text size=25 max=25 name=emexp002 tabindex=3
         value="%EMRWEB02.02.411" onblur="UpCase(this);"></td>
    <td class=DataLabel>Given Name </td>
    <td><input type=text size=25 max=25 name=emexp003 tabindex=4
         value="%EMRWEB02.02.412" onblur="UpCase(this);"></td></tr>
<tr><td></td>
    <td></td>
    <td class=DataLabel>%STANDARD.01.017.G </td>
    <td><select name=emexp004 tabindex=5>
         <option> </option>
        %EMRWEB02.02.086.099.061.9.1.19.3.H
       </select></td>
    <td class=DataLabel>Date of Birth </td>
    <td><input type=text size=12 max=11 name=emexp005 value="%EMRWEB02.02.414"
         title="Date of Birth" class="Past Date" tabindex=6>
        <img class=Icon src=../images/DateTimeStamp.gif date=document.UpdateForm.emexp005>
        <img class=Icon src=../images/DateLookup.gif date=document.UpdateForm.emexp005>
        </td></tr>
</table>

<table align=center width=95% border=0 cellspacing=0 cellpadding=0>

<tr valign=top><td class=DataLabel width=15%>Presenting Complaint </td>
    <td>
    <input type=hidden name=emrviscat value="el">
    <input type="text" size=10 tabindex=7 name=test
       value="%EMRWEB02.02.416.1"
       onKeyUp='UpCase(this);getPresentCom(this,UpdateForm.emvis060,
                UpdateForm.emrviscat);'
       onBlur='DisplayDiv()'>
    <select name=emvis060 class=SelectBig onchange="DisplayDiv();">
      <option value="%EMRWEB02.02.416.1">%EMRWEB02.02.416.0</option>
    </select>
    </td>
    <td colspan=5>
    <textarea name=prcom001 wrap=hard tabindex=8
     onkeydown="LimitText(this,6,300);"
     cols=50 rows=2 onblur="TextareaBlurHandler(this);Validateprecom001();">i
    </textarea>
    </td></tr>

</table>

<div id=Triage></div>

<table align=center width=95% border=0 cellspacing=0 cellpadding=0>

    <tr><td class=DataLabel>Arrival Date/Time </td>
    <td>
    <input type=text size=11 max=11 name="emvis001" value="%EMRWEB02.02.465"
     title="Arrival Date" class="Mandatory PastDate" tabindex=10>
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Show Calendar" date="UpdateForm.emvis001">
    <input type=text size=8 max=8 name="emvis002" value="%EMRWEB02.02.466"
     title="Arrival Time" class=Mandatory tabindex=11>
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="UpdateForm.emvis001" time="UpdateForm.emvis002">
    <img notab src="../images/TimeLookup.gif" class="Icon"
     alt="Time Select" time="UpdateForm.emvis002">
    </td>

    <td class=DataLabel>Attendance Type</td>
    <td><select class="Mandatory SelectMed" name=emvis053 tabindex=20
         title="Attendance Type">
     <option></option>
     %EMRWEB02.02.213.2
     </select></td>

    <td class=DataLabel>Location</td>
    <td><input type=hidden name=name_emvis006 title="Location">
        <select class="Mandatory" name="emvis006" title="Location" tabindex=30
         onchange="validateLocation(UpdateForm.emvis006,
                   UpdateForm.name_emvis006);">
         <option></option>
         %EMRWEB02.02.468
        </select>
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
     <td><select class="Mandatory SelectMed" name=emvis008 tabindex=12 
          title="%STANDARD.01.017.CL">
     <option></option>
     %EMRWEB02.02.108.2
     </select></td>
     <td class=DataLabel>Attendance Source</td>
     <td><select class="Mandatory SelectMed" name=emvis061 tabindex=21 
         title="Attendance Source" 
         onchange="checkReferred();">
         <option></option>
         %EMRWEB02.02.462.2
         </select></td>
     <td><div id=TranSrcHeading></div></td>
     <td><div id=TranSrc></div></td>
     </tr>

<tr><td class=DataLabel>Arrival Transport</td>
    <td><select name=emvis013 tabindex=13 class="Mandatory SelectMed" 
         title="Arrival Transport"
         onchange="document.UpdateForm.emvis034.disabled=0;CheckAmbType();">
     <option></option>
     %EMRWEB02.02.113.2
     </select></td>
     <td class=DataLabel>Amb Case No</td>
     <td><input type=text size=10 maxlength=6 name=emvis034 tabindex=22
         onFocus="CheckAmbType();" value="%EMRWEB02.02.469" title="Amb Case No"
         onblur="ValidateAmbCase();"></td>
     <td class=DataLabel>Clerical ID</td>
     <td><input type=text size=3 maxlength=3 name=emvis062 tabindex=32 
          class=Mandatory title="Clerical ID"
      value="%EMRWEB02.02.222.1" 
      onchange="CheckCode(UpdateForm.emvis062,UpdateForm.v062name)">
      <select name=v062name class="Mandatory SelectMed" 
       onchange="UpdateCode(UpdateForm.emvis062,UpdateForm.v062name)">
      <option></option>
      %EMRWEB02.02.222.2
      </select></td></tr>

<tr>
  <td>%STANDARD.01.017.HP</td>
  <td>
    <select name=emvis160>
      <option value=""></option>
      %EMRWEB02.02.281.1.4
    </select>
  </td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>

<tr><td colspan=6 align=center><br>
    <input type=button value="Add" class="button" tabindex=40 name="AddButton"
     onclick="tempDisable(this);UpdateVisit();">
    <input type=button value="Cancel" class="button" tabindex=41
     onclick="CancelLink();">
    </td></tr>
</table>
</form>

<form name=LinkForm action="emrweb02.pbl" method=get style="margin:0">
<input type=hidden name=reportno value="02">
<input type=hidden name=template value="011">
<input type=hidden name=formactn value="SP">
<input type=hidden name=emexp001>
</form>

<span id=transferhd style="display:none">
<td class=DataLabel>Transfer Source</td>
</span>

<span id=transferblank style="display:none">
   <input type=hidden name=emvis032 value="" notab>
</span>

<span id=transfersrc style="display:none">
<td><input type="text" size=8 maxlength=6 name="emvis032" tabindex=31
     value="%EMRWEB02.02.132.1" title="Transfer Source" class=Mandatory
     onchange='validateCode(9,UpdateForm.emvis032,UpdateForm.trnsfsrc);'>
     <input type=text  size=25 name=trnsfsrc value="%EMRWEB02.02.132.0"
      readonly notab>
     <img class=Icon src="../images/SearchIcon.gif" notab
     onclick="TransferSourceFrame(UpdateForm.emvis032,UpdateForm.trnsfsrc)">
     </td>
</span>

<span id=EmergencyProc style="display:none;">
<table align=center cellspacing=0 cellpadding=0 border=0 width=95%>
<tr><td class=DataLabel width=15%>Place Where Injury Occurred</td>
    <td><select name="emvis021" class=SelectBig tabindex=10
         title="Place Where Injury Occurred">
    <option></option>
    %EMRWEB02.02.121.2
     </select>
    </td>
    <td class=DataLabel>Activity When Injured</td>
    <td><select name="injur006" class=SelectBig title="Activity When Injured"
         tabindex=11>
    <option></option>
      %EMRWEB02.02.183.2
       </select>
</td>
    <td class=DataLabel> Injury Cause</td>
    <td><select name="injur004" class=SelectBig title="Injury Cause"
         tabindex=12>
    <option></option>
     %EMRWEB02.02.181.2
     </select>
    </td></tr>

<tr valign=top><td class=DataLabel> Human Intent</td>
    <td><select name="injur005" class=SelectBig title="Human Intent"
         tabindex=13>
    <option></option>
     %EMRWEB02.02.182.2
      </select>
</td>
    <td class=DataLabel>
    Desc. of Injury Event</td>
    <td colspan=3><input type="text" name="injur002" maxlength="50" size="40"
         title="Description of Injury Event" value="" tabindex=14>
    <input type="text" name="injur003" maxlength="50" size="40" value=""
     tabindex=14>
</td></tr>
</table>
</span>

<script type="text/javascript">
function init(){
  for (var i =0 ; i < document.UpdateForm.emexp004.length; i++) {
  if  (document.UpdateForm.emexp004.options[i].value.substr(0,1)== "%EMRWEB02.02.413") {
       document.UpdateForm.emexp004.selectedIndex=i }
  }
 var ExpectedLocation="%EMRWEB02.02.472"
 if(!isWhitespace(ExpectedLocation)) {
   validateLocation(document.UpdateForm.emvis006,document.UpdateForm.name_emvis006);
 }
var str1= trim("%EMRWEB02.02.417");
    if(!isWhitespace(str1)) { str1+="\n"}
var str2= trim("%EMRWEB02.02.418");
    if(!isWhitespace(str2)) { str2+="\n"}
var str3= trim("%EMRWEB02.02.419");
    if(!isWhitespace(str3)) { str3+="\n"}
var str4= trim("%EMRWEB02.02.420");
    if(!isWhitespace(str4)) { str4+="\n"}
var str5= trim("%EMRWEB02.02.421");
    if(!isWhitespace(str5)) { str5+="\n"}
var str6= trim("%EMRWEB02.02.422");
UpdateForm.prcom001.value=str1+str2+str3+str4+str5+str6
}

for(var i=0; i<document.UpdateForm.emvis160.length; i++){
  if(document.UpdateForm.emvis160.options[i].value.substring(0,3)=="%EMRWEB02.02.281.0"){
     document.UpdateForm.emvis160.selectedIndex=i;
     break;
  }
}
</script>
