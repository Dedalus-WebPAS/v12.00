<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="nz">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/EmergencyCodingTable.js"> </script>
<script type="text/javascript">
function getDiagnosis(SearchField,ReturnSelect) {
  var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=1" +
                    "&valdcode=" + SearchField.value.replace(/ /g,"+");

  var ReturnValue = null;

  if (IEBrowser) {
    var returnValue = RSExecute(serverURL);

    if (returnValue.status==0) {
      ReturnSelect.options.length=0;
      ReturnValue=returnValue.return_value.split("|");
      for (var j=0; j < ReturnValue.length; j++) {
        if (!isWhitespace(ReturnValue[j])) {
          SelectValue=ReturnValue[j].split(",");
          ReturnSelect.options[ReturnSelect.options.length]=
            new Option(SelectValue[1],SelectValue[0]);
        }
      }
    }
  }
  else {
    var returnValue = RSExecuteFetch(serverURL);

    returnValue.then(
      function (returnValue) {
        returnValue = ParseFetchData(returnValue);  // parse fetch() result

        if (returnValue.status==0) {
          ReturnSelect.options.length=0;
          ReturnValue=returnValue.return_value.split("|");
          for (var j=0; j < ReturnValue.length; j++) {
            if (!isWhitespace(ReturnValue[j])) {
              SelectValue=ReturnValue[j].split(",");
              ReturnSelect.options[ReturnSelect.options.length]=
                new Option(SelectValue[1],SelectValue[0]);
            } 
          }
        }
      }
    );
  }
}
function newDiagnosis() {
  if (isWhitespace(document.Dummy.diagselt.value)) {
      alert("No Diagnosis selected !");
      return;;
  }
  document.AddDiagnosis.emvcd005.value=Dummy.diagselt.value
  SubmitHidden(AddDiagnosis);
}
function addDetail() {
    Left=(document.body.clientWidth-600)/2
    DFrameLink("emrweb05.pbl?reportno=7&template=5",100,Left,600,300)
}
function addMult(linkurl) {
   location.href=linkurl;
}
function ShowDetail(urnumber,recordky,type) {
    if (type == "001") {
      Template="003";
    }
    else if (type == "002" ) {
      Template="005";
    } else if (type == "003") {
      Template="007";
    } else if (type == "004") {
      Template="009";
    } else if (type == "005") {
      Template="011";
    } else {
      alert("Incorrect Type to determine template number");
      return
    }
    linkURL="emrweb06.pbl?reportno=2&template=" + Template +
            "&urnumber=" + urnumber.replace(/ /g,"+") +
            "&recordky=" + recordky.replace(/ /g,"+");
    Left=(document.body.clientWidth-590)/2
    DFrameLink(linkURL,100,Left,590,410)
}
function ToggleAll(Value) {
  var inputElmnts = document.getElementsByTagName('INPUT');
  for (var i=0; i < inputElmnts.length; i++) {
    if (inputElmnts[i].type == "radio") {
      if ((inputElmnts[i].name.substr(0,6) == "evcrdb") &&
          (inputElmnts[i].value.substr(0,1) == Value)) {
        inputElmnts[i].checked = true;
      }
    }
  }
}
function Update() {
  var inputElmnts = document.getElementsByTagName('INPUT');
  for (var i=0; i < inputElmnts.length; i++) {
    if (inputElmnts[i].type == "radio") {
      if ((inputElmnts[i].name.substr(0,6) == "evcrdb") &&
          (!inputElmnts[i].checked)) {
        inputElmnts[i].disabled = true;
      }
    }
  }
  document.AddDiagnosis.updatety.value = "E";
  SubmitHidden(AddDiagnosis);
}
function SearchDiagnosis() {

    // keep clearing the timeout function execute until the last onkeyup
    // so only one onkeyup event gets executed

    if (this.timer) {
        window.clearTimeout(this.timer);
    }
    this.timer = window.setTimeout(function() {

    getDiagnosis(Dummy.searchfl,Dummy.diagselt);

    }, 1000);
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);initTables();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%EMRWEB06.02.003";
PatientVIS="%EMRWEB06.02.081";
PatientNAM="%EMRWEB06.02.002";
PatientSTA="%EMRWEB06.02.086.078";
PatientALT="%EMRWEB06.02.084";
PatientSEX="%EMRWEB06.02.019";
PatientDOB="%EMRWEB06.02.020";
PatientAGE="%EMRWEB06.02.021";
PatientLOC="%EMRWEB06.02.083";
PatientPRI="%EMRWEB06.02.086.066.1";
PatientUNT="%EMRWEB06.02.066.0";
DoctorCOD="%EMRWEB06.02.082.003";
DoctorNAM="%EMRWEB06.02.082.002";
PatientAID="%EMRWEB06.02.086.090";
PatientIND="%EMRWEB06.02.086.091";
PatientCUR="%EMRWEB06.02.086.092";
PatientCLC="%EMRWEB06.02.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%EMRWEB06.02.086.094";
PatientCDM="%EMRWEB06.02.086.095";
PatientVDH="%EMRWEB06.02.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<form name=Dummy onsubmit='return false;' style="margin:0">
<table border=0 cellspacing=0 cellpadding=0 width=100%>
<tr><td class=HeadingCell width=20% align=center>Diagnosis Summary</td>
    <td class=HeadingCell>  
    Search
    <input type=text name=searchfl id=searchfl class=SelectBig
     onKeyUp='getDiagnosis(this,Dummy.diagselt);'>
    <select name=diagselt id=diagselt class=SelectXlrg>
    </select>
    <input type=button class="button" value="Add"
     onclick='newDiagnosis();'>
    </td></tr>
</table>
</form>

<form name=AddDiagnosis method=post action=emrweb06.pbl style="margin:0">
<input type=hidden name=reportno value="2">
<input type=hidden name=template value="002">
<input type=hidden name=updatety value="A">
<input type=hidden name=nextpage value="7">
<input type=hidden name=redirect value="%EMRWEB06.02.001.emrweb06.02.001">     
<input type=hidden name=urnumber value="%EMRWEB06.02.003">
<input type=hidden name=admissno value="%EMRWEB06.02.081">
<input type=hidden name=emvcd001 value="%EMRWEB06.02.081">
<input type=hidden name=emvcd002 value="005">
<input type=hidden name=emvcd004 value="5">
<input type=hidden name=emuty001 value="EMRD">
<input type=hidden name=emvcd005 value="">
<input type=hidden name=emvcd006 value="   ">
<input type=hidden name=emvcd031 value="1">

<div id="TableLocation5"></div>

</form>

<br>

<table align=center border=0 cellpadding=0 cellspacing=0>
<tr><td>
      <input type=button class=button value=Update onclick="Update();">
    </td>
</tr>
</table>

<script type="text/javascript">
function initTables() {
  initTable5();
}
//
// Table 5
//
function initTable5() {
 TB5 = new Table("TB5",1,0,1,"100%","center",TableLocation5);  
//
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column,Align
//
 TB5.addColumn("Type","String",0,0,"center","","",150)
 TB5.addColumn("Description","String",11,11,"left","MaintenanceIcon.gif","10",600)
// TB5.addColumn("Send in Extract","String",6,6,"center","","")

 var sMiscHTML = "<table border=0 width=100% cellspacing=0 cellpadding=0>" +
                 "<tr>" +
                   "<td align=right style='font-weight:bold;color:white;'>" +
                     "<input type=button class=SlimButton value='All'" +
                     " onclick='ToggleAll(1)'>&nbsp;Left" + 
                   "</td>" +
                   "<td align=right style='font-weight:bold;color:white;'>" +
                     "<input type=button class=SlimButton value='All'" +
                     " onclick='ToggleAll(2)'>&nbsp;Right" +
                   "</td>" +
                   "<td align=right style='font-weight:bold;color:white;'>" +
                     "<input type=button class=SlimButton value='All'" +
                     " onclick='ToggleAll(3)'>&nbsp;N/A" +
                   "</td>"+
                 "</tr>" +
                 "</table>";

 TB5.addColumn(sMiscHTML,"String",21,-1,"left","","",280)

 TB5.addColumn("User","String",7,7,"left","","")
//
// Add Rows to Table (Output from Web Server)
//
%EMRWEB06.02.134.TB5.005  
//
//
 OrderColumn=0;
 AscDsc=2;
 lastOrderColumn=OrderColumn;
 TableOutput(TB5,OrderColumn,AscDsc);
}
</script>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=urnumber value="%EMRWEB06.02.003">
<input type=hidden name=admissno value="%EMRWEB06.02.081">
<input type=hidden name=MenuType value="%EMRWEB06.02.088">
</form>

