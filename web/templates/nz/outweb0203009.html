<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome"    content="nz">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true"> 
<script type="text/javascript" src="../js/OutExtraTemplates.js"></script>
<script type="text/javascript" src="../js/outweb02.js"></script>
<script type="text/javascript">
function showACC(theForm) {
  checkInd=theForm.outbb002.value.substr(3,5)
  if (checkInd.search(/W/g) >= 0) {
      ACCHeading.innerHTML=acchd.innerHTML;
      ACCId.innerHTML=accorderid.innerHTML;
    } else {
      ACCHeading.innerHTML=blanklabel.innerHTML;
      ACCId.innerHTML=blanklabel.innerHTML;
    }
}

function ClinicSearch() {
   if (!isWhitespace(UpdateForm.newslotk.value)) {
     cancelSlot(UpdateForm.newslotk.value,ClinicSearchLink)
   }
}
function ClinicSearchLink() {
 ClinicSearchFrame(UpdateForm.newslotk,UpdateForm.clindesc,UpdateForm.clindate,
                   UpdateForm.defclnty,UpdateForm.defclnid)
}
function AppointSearch() {
   if (!isWhitespace(UpdateForm.newslotk.value)) {
     cancelSlot(UpdateForm.newslotk.value,AppointSearchLink)
   }
}
function AppointSearchLink() {
AppointmentSearchFrame(UpdateForm.newslotk,UpdateForm.clindesc,
                       UpdateForm.clindate,UpdateForm.defclnty,
                       UpdateForm.defclnid,UpdateForm.defvisty);
}
function UpdateApp() {
  p=document.UpdateForm;
  validateSuspension(p.urnumber,p.dateclin,p.datefrom,p.dateto);
  if(p.datefrom.value!='0'){
       ans=confirm("Warning : Patient has a Suspension record for period \n" +
             "\t" + p.datefrom.value  + " - " + p.dateto.value);
       if (ans!=true) {
          return; }
  } 
  setRedirect()
  if (validateMandatory(UpdateForm)) {
      if(isWhitespace(UpdateForm.nextpage.value)) {
         UpdateForm.redirect.value=parent.location.href;
         UpdateForm.nextpage.value="6";
      }
      SubmitHiddenNew(UpdateForm);
  }
}
function setRedirect() {
  strTemplate="" ;
  scrName="";
  checkInd=document.UpdateForm.outbb002.value.substr(3,5)
  if(checkInd.search(/W/g) >= 0) {
    strTemplate="005";
    scrName="WC";}
  if(checkInd.search(/M/g) >= 0) {
    strTemplate="042";
    scrName="TAC";}
  if(checkInd.search(/V/g) >= 0) {
    strTemplate="043";
    scrName="VA";}

  checkInd=document.UpdateForm.outbb002.value.substr(8,1)
  if(checkInd.search(/C/g) >= 0) {
    strTemplate="021";
    scrName="CT";}
  if (strTemplate=="") {
    if ((document.UpdateForm.ptcnueoc.value==1) &&
        (document.UpdateForm.outbb002.value.substr(5,1)=='A')) {
      scrName="ACC";
      document.UpdateForm.nextpage.value="6"
      document.UpdateForm.redirect.value="eocweb01.pbl?reportno=1&template=006"
        + "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")
        + "&returncd=OUT";
    }
    else {
      document.UpdateForm.redirect.value="outweb02.pbl?reportno=3&template=1" +
                                      "&shwprint=1" 
    }
  }
  else {
    document.UpdateForm.nextpage.value="6"
    document.UpdateForm.redirect.value="patweb89.pbl?reportno=01" +
               "&template=" + strTemplate +
               "&systflag=2" +
               "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")  }

  if(chkExtraTempl(document.UpdateForm,"B",document.UpdateForm.newslotk.value,
                PatientLinks.urnumber.value.replace(/ /g,"+"),scrName)) {
    document.UpdateForm.nextpage.value="6";
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);makeCheck();showACC(UpdateForm);
              FilterMentalHealth(UpdateForm);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Update Appointment - %OUTWEB02.03.618.1 - %OUTWEB02.03.002
</span>
<div id=PageBodySection style="overflow: auto;">

<form action=outweb02.pbl method=post name=UpdateForm id=UpdateForm
 onsubmit='return validateMandatory(this);' >
<input type=hidden name=reportno id=reportno value="04">
<input type=hidden name=template id=template value="004">
<input type=hidden name=urnumber id=urnumber value="%OUTWEB02.03.003">
<input type=hidden name=admissno id=admissno value="%OUTWEB02.03.081">
<input type=hidden name=casekeys id=casekeys value="%OUTWEB02.03.366" >
<input type=hidden name=updatety id=updatety value="6">
<input type=hidden name=defclnty id=defclnty value="%OUTWEB02.03.308">
<input type=hidden name=defclnid id=defclnid value="%OUTWEB02.03.303.0">
<input type=hidden name=defvisty id=defvisty value="%OUTWEB02.03.310.1">
<input type=hidden name=redirect id=redirect value="">
<input type=hidden name=nextpage id=nextpage value="">
<input type=hidden name=ptcnueoc id=ptcnueoc value="%OUTWEB02.03.616">
<input type=hidden name=clinctyp id=clinctyp value="%OUTWEB02.03.605.1">
<input type=hidden name=dateclin id=dateclin value="%OUTWEB02.03.304">
<input type=hidden name=datefrom id=datefrom>
<input type=hidden name=dateto   id=dateto>
<input type=hidden name=clincgrp id=clincgrp value="%OUTWEB02.03.327.017">

<table cellspacing=0 cellpadding=1 border=0 width=90% align=center>
<tr><td class=DataLabel>Clinic</td>
<td class=DataField>
<input type=hidden name=newslotk id=newslotk value="%OUTWEB02.03.366">
<input type=text size=30 name=clindesc id=clindesc readonly class=ReadOnly
 title="Clinic" value="%OUTWEB02.03.303.1" >
</td></tr>
<tr><td class=DataLabel> Date </td>
  <td class=DataField colspan = 3>
  <input type=text size=35 name=clindate id=clindate readonly class=ReadOnly
   value="%OUTWEB02.03.313 %OUTWEB02.03.304 at %OUTWEB02.03.316">
  </td>
</tr>
<tr><td class=DataLabel>Visit Type</td>
    <td class=DataField colspan=3>
    <select name=outbb047 id=outbb047 title="Visit Type" class="SelectBig Mandatory">
    %OUTWEB02.03.399
    </select>
    </td></tr>

<!-- Mode of Delivery -->
<tr><td class=DataLabel>%STANDARD.01.017.sd</td>
    <td class=DataField colspan=3>
    <select name=outbb070 id=outbb070 title="%STANDARD.01.017.sd">
    <option></option>
    %OUTWEB02.03.327.006.9.5
    </select>
    </td></tr>

<tr valign=top>
    <td class=DataLabel>Presenting Complaint</td>
    <td class=DataField colspan=3>
    <input type=text name=pmsvx052 id=pmsvx052 size=50 maxlength=50 
      value="%OUTWEB02.03.852">
</td></tr>

<tr valign=top>
    <td class=DataLabel>Diagnosis</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb045 id=outbb045 value="%OUTWEB02.03.364"
     onblur="validateCode(6,UpdateForm.outbb045,UpdateForm.outbb046);">
    <input type=text name=outbb046 id=outbb046 readonly class=Readonly size=75
     maxlength=50 value="%OUTWEB02.03.365">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.outbb045,UpdateForm.outbb046);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb045,UpdateForm.outbb046);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb055 id=outbb055 value="%OUTWEB02.03.379"
     onblur="validateCode(6,UpdateForm.outbb055,UpdateForm.outbb056);">
    <input type=text name=outbb056 id=outbb056 readonly class=Readonly size=75 
     maxlength=50 value="%OUTWEB02.03.380">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.outbb055,UpdateForm.outbb056);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb055,UpdateForm.outbb056);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb057 id=outbb057 value="%OUTWEB02.03.381"
     onblur="validateCode(6,UpdateForm.outbb057,UpdateForm.outbb058);">
    <input type=text size=75 maxlength=50 name=outbb058 id=outbb058 readonly 
     class=Readonly value="%OUTWEB02.03.382">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.outbb057,UpdateForm.outbb058);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb057,UpdateForm.outbb058);">
    </td></tr>
<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb059 id=outbb059 value="%OUTWEB02.03.383"
     onblur="validateCode(6,UpdateForm.outbb059,UpdateForm.outbb060);">
    <input type=text size=75 maxlength=50 name=outbb060 id=outbb060 readonly 
     class=Readonly value="%OUTWEB02.03.384" >
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.outbb059,UpdateForm.outbb060);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb059,UpdateForm.outbb060);">
    </td></tr>
<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb061 id=outbb061 value="%OUTWEB02.03.385"
     onblur="validateCode(6,UpdateForm.outbb061,UpdateForm.outbb062);">
    <input type=text size=75 maxlength=50 name=outbb062 id=outbb062 readonly
     class=Readonly value="%OUTWEB02.03.386" >
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.outbb061,UpdateForm.outbb062);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb061,UpdateForm.outbb062);">
    </td></tr>

<tr><td>Procedure</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=otprc002 id=otprc002
     value="%OUTWEB02.03.692.002"
     onblur="validateCode(7,UpdateForm.otprc002,UpdateForm.otprc003);">
    <input type=text size=75 maxlength=50 name=otprc003 id=otprc003 readonly
     class=Readonly value="%OUTWEB02.03.692.003" >
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10ProSearchFrame(UpdateForm.otprc002,UpdateForm.otprc003);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypeprocSearchFrame(UpdateForm.otprc002,UpdateForm.otprc003);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=otprc004 id=otprc004
     value="%OUTWEB02.03.692.004"
     onblur="validateCode(7,UpdateForm.otprc004,UpdateForm.otprc005);">
    <input type=text size=75 maxlength=50 name=otprc005 id=otprc005 readonly
     class=Readonly value="%OUTWEB02.03.692.005" >
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10ProSearchFrame(UpdateForm.otprc004,UpdateForm.otprc005);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypeprocSearchFrame(UpdateForm.otprc004,UpdateForm.otprc005);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=otprc006 id=otprc006
     value="%OUTWEB02.03.692.006"
     onblur="validateCode(7,UpdateForm.otprc006,UpdateForm.otprc007);">
    <input type=text size=75 maxlength=50 name=otprc007 id=otprc007 readonly
     class=Readonly value="%OUTWEB02.03.692.007" >
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10ProSearchFrame(UpdateForm.otprc006,UpdateForm.otprc007);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypeprocSearchFrame(UpdateForm.otprc006,UpdateForm.otprc007);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=otprc008 id=otprc008
     value="%OUTWEB02.03.692.008"
     onblur="validateCode(7,UpdateForm.otprc008,UpdateForm.otprc009);">
    <input type=text size=75 maxlength=50 name=otprc009 id=otprc009 readonly
     class=Readonly value="%OUTWEB02.03.692.009" >
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10ProSearchFrame(UpdateForm.otprc008,UpdateForm.otprc009);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypeprocSearchFrame(UpdateForm.otprc008,UpdateForm.otprc009);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=otprc010 id=otprc010
     value="%OUTWEB02.03.692.010"
     onblur="validateCode(7,UpdateForm.otprc010,UpdateForm.otprc011);">
    <input type=text size=75 maxlength=50 name=otprc011 id=otprc011 readonly
     class=Readonly value="%OUTWEB02.03.692.011" >
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10ProSearchFrame(UpdateForm.otprc010,UpdateForm.otprc011);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypeprocSearchFrame(UpdateForm.otprc010,UpdateForm.otprc011);">
    </td></tr>

<tr><td>Problem</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=otprc012 id=otprc012
     value="%OUTWEB02.03.692.012.1"
     onblur="valCtypeProblem(defclnty,this,d_otprc012);">
    <input type=text size=75 maxlength=50 name=d_otprc012 id=d_otprc012 readonly
     class=Readonly value="%OUTWEB02.03.692.012.0" >
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypeprobSearchFrame(UpdateForm.otprc012,UpdateForm.d_otprc012);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=otprc013 id=otprc013
     value="%OUTWEB02.03.692.013.1"
     onblur="valCtypeProblem(defclnty,this,d_otprc013);">
    <input type=text size=75 maxlength=50 name=d_otprc013 id=d_otprc013 readonly
     class=Readonly value="%OUTWEB02.03.692.013.0" >
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypeprobSearchFrame(UpdateForm.otprc013,UpdateForm.d_otprc013);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=otprc014 id=otprc014
     value="%OUTWEB02.03.692.014.1"
     onblur="valCtypeProblem(defclnty,this,d_otprc014);">
    <input type=text size=75 maxlength=50 name=d_otprc014 id=d_otprc014 readonly
     class=Readonly value="%OUTWEB02.03.692.014.0" >
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypeprobSearchFrame(UpdateForm.otprc014,UpdateForm.d_otprc014);">
    </td></tr>

<tr><td class=DataLabel>Transport</td>
    <td class=DataField><select name=outbb023 id=outbb023 class=SelectBig>
        <option></option>
        %OUTWEB02.03.342.2
        </select></td>
    <td class=DataLabel>Priority</td>
    <td class=DataField><select name=outbb013 id=outbb013 class=SelectBig>
	<option></option>
	%OUTWEB02.03.332.2
	</select>
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td class=DataField>
      <select name=outbb002 id=outbb002 class="Mandatory SelectBig"
        title="%STANDARD.01.017.CL" onchange="showACC(UpdateForm);">
        <option></option>
        %OUTWEB02.03.321.2
        </select></td>
  <td class=DataLabel>Unit</td>
    <td class=DataField>
      <select name=outbb022 id=outbb022 class="SelectBig" title="Unit">
      <option></option>
       %OUTWEB02.03.341.2
	</select></td></tr>

     <tr><td><div id=ACCHeading></div></td>
         <td><div id=ACCId></div></tr>


<tr><td class=DataLabel>Source of Referral</td>
    <td class=DataField>
      <select name=outbb001 id=outbb001 class="Mandatory SelectBig"
         title="Source of Referral">
        <option></option>
         %OUTWEB02.03.320.2
        </select></td>
    <td class=DataLabel>Reports Required</td>
    <td class=DataField>
      <select name=outbb017 id=outbb017 class=SelectBig>
        <option></option>
        %OUTWEB02.03.336.2
        </select></td>
     </tr>
<tr><td class=DataLabel>Special Arrangements</td>
    <td class=DataField>
      <select name=outbb054 id=outbb054 class=SelectBig>
        <option></option>
        %OUTWEB02.03.378.2
      </select></td>
    <td class=DataLabel>Referring GP</td>
    <td class=DataField>
    <input type=hidden name=outbb029 id=outbb029 value='%OUTWEB02.03.390'>
    <input type=text readonly name=genpname id=genpname class=Readonly>
    <img src="../images/SearchIcon.gif" class=Icon
       onclick="HCPSearchFrameExpanded(outbb029,genpname,6,outbb030,d_outbb030,outbb037)">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(outbb029,genpname);">
    </td></tr>

<tr><td class=DataLabel>Preferred Contact Method</td>
    <td class=DataField >
      <select name=outbb040 id=outbb040>
       <option value="   "></option>
        %OUTWEB02.03.359.2
       </select></td>
    <td>Practice</td>
    <td>
      <input type=hidden name=returnprov1 id=returnprov1>
      <input type=hidden name=outbb030 id=outbb030 value="%OUTWEB02.03.349">
      <input type=hidden name=outbb037 id=outbb037 value="%OUTWEB02.03.356">
      <input type=text name="d_outbb030" id="d_outbb030" title="Practice"
       readonly class="Readonly" value="%OUTWEB02.03.639.005">
      <img src="../images/SearchIcon.gif" class=Icon
       onclick="GPHCGSearchFrame(outbb029,genpname,returnprov1,outbb030,d_outbb030,outbb037)">
      <img src="../images/erase.gif" class=Icon
       onclick="clrFields(d_outbb030,returnprov1,outbb030,outbb037);"></td></tr>

<tr>
  <td class=DataLabel>%STANDARD.01.017.gb</td>
  <td>
    <select name=contcode id=contcode>
      <option value=""></option>
      %OUTWEB02.03.686
    </select>
  </td>
    <td class=DataLabel>Inform GP</td>
      <td><select name=pmsvx010 id=pmsvx010>
         <option value="0">No</option>
         <option value="1">Yes</option>
        </select></td></tr>
<tr>
  <td colspan=2>&nbsp;</td>
  <td>%STANDARD.01.017.HP</td>
  <td>
    <select name=outbb073 id=outbb073 class="Mandatory">
      <option value=""></option>
      %OUTWEB02.03.327.013.2
    </select>
  </td>
</tr>

<tr><td><table border=0 width=100% class=TableBody cellpadding=0 cellspacing=0>
        <tr><td class=DataLabel>Comments</td></tr>
        <tr><td colspan=6 align=left>
              <input type=button value="Add" class="button"
               name="AddComm" id="AddComm"
               onclick="tempDisable(this);AddComment();"></td></tr>
        <tr><td>&nbsp;</td></tr>
        <tr><td>&nbsp;</td></tr>
        </table>
    </td>
    <td colspan=6 align=left>
      <textarea wrap=hard name=outptcoa id=outptcoa class=Readonly readonly
       rows=4 cols=70>%OUTWEB02.03.327.016.005</textarea>
    </td></tr>

<tr><td colspan=4 align=center>
    <input type=button class="button" value="Ok"
     onclick="UpdateApp();">
    <input type=button class="button" value="Cancel" 
     onclick="DFrameCloseRefresh();">
    </td></tr>
</table>
</form>
</div>
<span id=blanklabel style="display:none">
</span>
<span id=acchd style="display:none">
ACC Purchase Order Number
</span>

<span id=accorderid style="display:none">
  <input type=text name=accpordn id=accpordn maxlength=20 size=25
   title="ACC Purchase Order Number" value="%OUTWEB02.03.698">
</span>

<form name=PatientLinks id=PatientLinks method=get>
<input type=hidden name=reportno id=reportno value=1>
<input type=hidden name=template id=template value=004>
<input type=hidden name=urnumber id=urnumber value="%OUTWEB02.03.003">
<input type=hidden name=admissno id=admissno value="%OUTWEB02.03.081">
<input type=hidden name=MenuType id=MenuType value="%OUTWEB02.03.088">
<input type=hidden name=casekeys id=casekeys value="%OUTWEB02.03.366">
</form>

<script type="text/javascript">
for(var i=0; i<document.UpdateForm.pmsvx010.length; i++){
  if(document.UpdateForm.pmsvx010.options[i].value=="%OUTWEB02.03.810.0"){
     document.UpdateForm.pmsvx010.selectedIndex=i;
     break;
  }
}

for(var i=0; i<document.UpdateForm.contcode.length; i++){
  if(document.UpdateForm.contcode.options[i].value.substring(0,3)=="%OUTWEB02.03.687.0"){
     document.UpdateForm.contcode.selectedIndex=i;
     break;
  }
}

var hp = "%OUTWEB02.03.327.013.0"
for(var i=0; i<document.UpdateForm.outbb073.length; i++){
  if(document.UpdateForm.outbb073.options[i].value.substring(0,3)==hp){
     document.UpdateForm.outbb073.selectedIndex=i;
     break;
  }
}


function init(){
  var title = '%OUTWEB02.03.348.003'
  var gname  = '%OUTWEB02.03.348.004'
  var surname = '%OUTWEB02.03.348.005'
  UpdateForm.genpname.value = trim(title)+" "+trim(gname)+" "+trim(surname);
}

function makeCheck(){
  if("%OUTWEB02.03.355" == "1"){
     UpdateForm.outbb036.checked=1;
  }
}
</script>

