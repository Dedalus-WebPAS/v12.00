<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="nz">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/outweb0202.js"></script>
<script type="text/javascript"> 
function ViewLink(OptionLink) {
 switch (OptionLink) {
  case "0":
  {
   if(DeleteStatus.redirflg.value=="1") {
     location.href="../cgi-bin/outweb02.pbl?reportno=2&template=011&sesskeys="+
                   DeleteStatus.sesskeys.value.replace(/ /g,"+");
   } else {
     location.href="../cgi-bin/outweb02.pbl?reportno=2&template=4&sesskeys="+
                   DeleteStatus.sesskeys.value.replace(/ /g,"+");
   }
   break;
   }
  case "1":
   {
   location.href="../cgi-bin/outweb02.pbl?reportno=2&template=5&sesskeys="+
                 SelectPeriod.sesskeys.value.replace(/ /g,"+") +
                 "&redirflg=" + SelectPeriod.redirflg.value
   break;
   }
  case "2":
   {
   location.href="../cgi-bin/outweb02.pbl?reportno=2&template=6&sesskeys="+
		    DeleteStatus.sesskeys.value.replace(/ /g,"+") +
                 "&redirflg=" + DeleteStatus.redirflg.value
   break;
   }
 }
}
//
function ProcessUpdate() {
  if(DeleteStatus.newsltyp2.selectedIndex!=0) {
    UnavailableSlots();
    return;
  }
  if(DeleteStatus.newsltyp1.selectedIndex!=0) {
    AvailableSlots();
    return;
  }
  alert("Please select a visit type");
}
//
function SetVisitType() {
  DeleteStatus.newsltyp2.className="";
  DeleteStatus.newsltyp2.selectedIndex=0;
  DeleteStatus.newsltyp1.className="Mandatory SelectBig";
  Comments.innerHTML="";
}
//
function SetVisitType1() {
  DeleteStatus.newsltyp1.className="";
  DeleteStatus.newsltyp1.selectedIndex=0;
  DeleteStatus.newsltyp2.className="Mandatory SelectBig";
  Comments.innerHTML=SlotComments.innerHTML;
}
//
function DeleteSlots() 
 {
 DeleteStatus.updatety.value=2;
 DeleteStatus.redirect.value="outweb02.pbl?reportno=2&template=5" +
	 "&sesskeys=" + DeleteStatus.sesskeys.value.replace(/ /g,"+") +
         "&redirflg=" + DeleteStatus.redirflg.value
 DeleteStatus.submit();
 }

function UnavailableSlots() {
  DeleteStatus.newsltyp1.className="";
  DeleteStatus.newsltyp1.selectedIndex=0;
  DeleteStatus.newsltyp2.className="Mandatory SelectBig";
//
  if (validateMandatory(DeleteStatus)) {
    DeleteStatus.newsltyp1.className="";
    DeleteStatus.newsltyp1.selectedIndex=0;
    DeleteStatus.newsltyp2.className="Mandatory SelectBig";
    DeleteStatus.newsltyp.value=DeleteStatus.newsltyp2.value;
    DeleteStatus.updatety.value=3;
    DeleteStatus.redirect.value="outweb02.pbl?reportno=2&template=5" +
    "&sesskeys=" + DeleteStatus.sesskeys.value.replace(/ /g,"+") +
    "&redirflg=" + DeleteStatus.redirflg.value
    DeleteStatus.submit();
  }
}
function AvailableSlots() {
  DeleteStatus.newsltyp2.className="";
  DeleteStatus.newsltyp2.selectedIndex=0;
  DeleteStatus.newsltyp1.className="Mandatory SelectBig";
  if (validateMandatory(DeleteStatus)) {
    DeleteStatus.newsltyp.value=DeleteStatus.newsltyp1.value;
    DeleteStatus.updatety.value=6;
    if (!isWhitespace(document.DeleteStatus.apptckie.value)) {

      if (document.AddSlot.othemref.value=="1") {
        if (isWhitespace(document.AddSlot.slotrefn.value)) {
          if (confirm("Referral Does Not Exist. Ok to Continue.")) {
            location.href="patweb98.pbl?reportno=01&template=036&urnumber=" +
                           document.AddSlot.d_sloturno.value.replace(/ /g,"+");
            return;
          } else {
            return;
          } 
        } 
      }

      var appointmentkeycookie;

      DeleteStatus.redirect.value=document.DeleteStatus.apptckie.value;
      SetCookie("AppointmentTypeCookie",document.DeleteStatus.aptyckie.value);

      for(i = 0; i < document.all.length; i++)
      {
          if (document.all(i).type == "checkbox" && 
              document.all(i).checked == true) {
//            alert(document.all(i).name);
              i++;
//            <td> element
              i++; 
//            hiddcsky
              appointmentkeycookie = document.all(i).value + "|";             
              i++;
//            hiddjavs
              appointmentkeycookie = appointmentkeycookie + 
                                     trim(document.all(i).value) + "|";
              i++;
//            hidddate
              appointmentkeycookie = appointmentkeycookie +
                                     document.all(i).value + "|";
//              i++;
//            hiddtime
//            appointmentkeycookie = appointmentkeycookie +
//                                   document.all(i).value + "|";
              i++;
//            hiddvist
//              appointmentkeycookie = appointmentkeycookie +
//                                     document.all(i).value + "|";
              appointmentkeycookie = appointmentkeycookie +
                        document.DeleteStatus.newsltyp1.value.substr(0,3) + "|";
              i++;
//            hiddctyp
              appointmentkeycookie = appointmentkeycookie +
                                     document.all(i).value + "|";
              i++;
//            hiddcdsc
              appointmentkeycookie = appointmentkeycookie +
                                     document.all(i).value + "|";
              i++;
//            hiddcind
              appointmentkeycookie = appointmentkeycookie +
                                     document.all(i).value + "|";
              i++;
//            hiddclds
              appointmentkeycookie = appointmentkeycookie +
                                     document.all(i).value + "|";
              i++;
//            hiddotmu
              appointmentkeycookie = appointmentkeycookie +
                                     document.all(i).value + "|";
              i++;
//            hiddothc
              appointmentkeycookie = appointmentkeycookie +
                                     document.all(i).value + "|";
              i++;
//            hiddothn
              appointmentkeycookie = appointmentkeycookie +
                                     document.all(i).value + "|";
              i++;
//            hiddothm
              appointmentkeycookie = appointmentkeycookie +
                                     document.all(i).value + "|";
              i++;
//            hiddotha
              appointmentkeycookie = appointmentkeycookie +
                                     document.all(i).value + "|";
              i++;
//            hiddoths
              appointmentkeycookie = appointmentkeycookie +
                                     document.all(i).value + "|";
              i++;
//            hiddothl
              appointmentkeycookie = appointmentkeycookie +
                                     document.all(i).value + "|";
              i++;
//            hiddind2
              appointmentkeycookie = appointmentkeycookie +
                                     document.all(i).value + "|";

              SetCookie("appointmentkeycookie",appointmentkeycookie);
              break;
          }
      }
//      alert(appointmentkeycookie);

    } else {
      DeleteStatus.redirect.value="outweb02.pbl?reportno=2&template=5" +
      "&sesskeys=" + DeleteStatus.sesskeys.value.replace(/ /g,"+") +
      "&redirflg=" + DeleteStatus.redirflg.value
    }
    DeleteStatus.submit();
  }
}
function UpdateVisitType() {
  DeleteStatus.newsltyp2.className="";
  DeleteStatus.newsltyp2.selectedIndex=0;
  DeleteStatus.newsltyp1.className="Mandatory SelectBig";
  if (validateMandatory(DeleteStatus)) {
     DeleteStatus.newsltyp.value=DeleteStatus.newsltyp1.value;
     DeleteStatus.updatety.value=4;
     DeleteStatus.redirect.value="outweb02.pbl?reportno=2&template=5" +
     "&sesskeys=" + DeleteStatus.sesskeys.value.replace(/ /g,"+") +
     "&redirflg=" + DeleteStatus.redirflg.value
     DeleteStatus.submit(); 
   }
}
function AddNewSlot() {
 DeleteStatus.newsltyp1.style.visibility="hidden";
 DeleteStatus.newsltyp2.style.visibility="hidden";
 AddSlot.redirect.value="outweb02.pbl?reportno=2&template=5" +
	 "&sesskeys=" + AddSlot.sesskeys.value.replace(/ /g,"+") +
         "&redirflg=" + AddSlot.redirflg.value

 if(document.AddSlot.ptcnualt.value=="1"){
    document.AddSlot.sloturno.maxLength=20;
    document.AddSlot.sloturno.size=20;
  }

 AddFrame.style.top=PageBodySection.scrollTop
 AddFrame.style.location="no";
 AddFrame.style.left=300
 AddFrame.style.width=500
 AddFrame.style.height=170
 AddFrame.style.display=''

 if(!isWhitespace(document.AddSlot.slotrefn.value)) {
   document.getElementById('slot_ref_no').innerText="Referral";
   document.getElementById('slot_ref_dep').innerText=
                           document.AddSlot.slotrefn.value + " " +
                           document.AddSlot.d_slotrefn.value;
 } else {
   document.getElementById('ReferralTitle').innerHTML=
   document.getElementById('ShowReferralTitle').innerHTML;
   document.getElementById('ReferralField').innerHTML=
   document.getElementById('ShowReferralField').innerHTML;
 }

 if(!isWhitespace(document.AddSlot.d_sloturno.value)) {
   document.AddSlot.sloturno.value=document.AddSlot.d_sloturno.value
   PatientReturn();
 }
 AddSlot.newsltim.focus()
}
function UpdateSlotTime(SlotNo,SlotTime) {
 DeleteStatus.newsltyp1.style.visibility="hidden";
 DeleteStatus.newsltyp2.style.visibility="hidden";
 UpdateSlot.redirect.value="outweb02.pbl?reportno=2&template=5" +
         "&sesskeys=" + UpdateSlot.sesskeys.value.replace(/ /g,"+") +
         "&redirflg=" + UpdateSlot.redirflg.value
 UpdateFrame.style.top=PageBodySection.scrollTop
 UpdateFrame.style.location="no";
 UpdateFrame.style.left=300
 UpdateFrame.style.width=400
 UpdateFrame.style.height=110
 UpdateFrame.style.display=''
 document.UpdateSlot.updsltim.value=SlotTime
 document.UpdateSlot.updsltno.value=SlotNo
 UpdateSlot.updsltim.focus()
}
function closeAddFrame()
{
 DeleteStatus.newsltyp1.style.visibility="visible";
 DeleteStatus.newsltyp2.style.visibility="visible";
 AddFrame.style.display="none";

}
function closeUpdateFrame()
{
 DeleteStatus.newsltyp1.style.visibility="visible";
 DeleteStatus.newsltyp2.style.visibility="visible";
 UpdateFrame.style.display="none";

}
function PatientReturn() {
 if(isWhitespace(document.AddSlot.sloturno.value)) {
   document.AddSlot.slotrefn.value="";
   document.AddSlot.d_slotrefn.value="";
   document.AddSlot.d_sloturno.value="";
   document.getElementById('slot_ref_no').innerText="";
   document.getElementById('slot_ref_dep').innerText="";
   document.getElementById('ReferralTitle').innerHTML=
   document.getElementById('ShowReferralTitle').innerHTML;
   document.getElementById('ReferralField').innerHTML=
   document.getElementById('ShowReferralField').innerHTML;
 } else {
   if(isWhitespace(document.AddSlot.d_sloturno.value)) {
     if(document.AddSlot.othemref.value=="1") {
       document.AddSlot.refnumbr.readOnly=false;
       document.AddSlot.refnumbr.className="Mandatory";
     } else {
       document.AddSlot.refnumbr.readOnly=false;
       document.AddSlot.refnumbr.className="";
     }
   } else {
     if(isWhitespace(document.AddSlot.d_slotrefn.value)) {
       if(document.AddSlot.othemref.value=="1") {
         document.AddSlot.refnumbr.readOnly=false;
         document.AddSlot.refnumbr.className="Mandatory";
       } else {
         document.AddSlot.refnumbr.readOnly=false;
         document.AddSlot.refnumbr.className="";
       }
     }
   }
 }
 if(document.AddSlot.ptcnualt.value=="1"){
   document.AddSlot.alternid.value=document.AddSlot.sloturno.value;
   document.AddSlot.alternid.maxLength=20;
   justifyRight(document.AddSlot.alternid);
   document.AddSlot.sloturno.maxLength=8;
   checkAlternateID(document.AddSlot.alternid.value,
                           document.AddSlot.aisearch,document.AddSlot.sloturno);
 }
 document.AddSlot.sloturno.maxLength=8;
 justifyRight(document.AddSlot.sloturno);
 validateCode(8,AddSlot.sloturno,AddSlot.gname);
 FN(AddSlot.gname.value)
 if(document.AddSlot.ptcnualt.value=="1"){
   document.AddSlot.sloturno.maxLength=20;
 }
}
//-----------------------------------------------------------------
// Function To Check Alternate ID
//-----------------------------------------------------------------
function checkAlternateID(altid,numofids,urnumber) {
  if (isWhitespace(altid)) return;;
  ReturnFunction="" ;
  for (var i=1; i < checkAlternateID.arguments.length; i++) {
   if (typeof(checkAlternateID.arguments[i]) == 'function') {
     ReturnFunction=checkAlternateID.arguments[i] } }
  var serverURL = "../cgi-bin/patweb90.pbl?reportno=2&remoteno=1" +
                  "&alternid="+altid.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|")
    numofids.value=trim(ReturnValue[0])
    urnumber.value=trim(ReturnValue[1])
    if (typeof(ReturnFunction) == 'function') {
       ReturnFunction() } }
}
function FN(Name) {
    document.AddSlot.slotpnam.value=Name
}
function CheckReferral(ValdRef,ValdUr) {
  if (isWhitespace(ValdRef.value)) return;;
  var serverURL  = "../cgi-bin/allweb03.pbl?reportno=9" +
               "&valdcode=" + ValdRef.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|")
    if(ValdUr.value!=ReturnValue[5]) {
      alert("Invalid referral for this U/R.");
      ValdRef.value="";
      return;
    }
    if(ReturnValue[4]!="0" && ReturnValue[4]!="1") {
      alert("Invalid referral status. Must be Waiting or Active.");
      ValdRef.value="";
      return;
    }
  } else {
    ValdRef.value="";
    return;
  }
}
function ListReferral() {
  if(isWhitespace(AddSlot.sloturno.value)) {
    alert("U/R number is a required field.");
    return;
  }
  VisitSearchFrameAll2(AddSlot.sloturno,AddSlot.refnumbr);
}
function AddNewBok() {
if (validateMandatory(document.AddSlot)) {
  if(AddSlot.sloturno.value!="") { 
    if(isWhitespace(AddSlot.slotbtyp.value)){
      if(AddSlot.refnumbr!=undefined) {
        if(!isWhitespace(AddSlot.refnumbr.value)) {
           AddSlot.slotbtyp.value="1";
           AddSlot.slotrefn.value=AddSlot.refnumbr.value;
        }
      }
    } else {
      if(AddSlot.refnumbr!=undefined) {
        if(!isWhitespace(AddSlot.refnumbr.value)) {
           AddSlot.slotrefn.value=AddSlot.refnumbr.value;
        }
      }
    }
    if(AddSlot.slotbtyp.value=="1" || // Booking
       AddSlot.slotbtyp.value=="2") { // Appointment Request
       AddSlot.redirect.value="outweb02.pbl?reportno=5&template=1" +
               "&urnumber=" + AddSlot.sloturno.value.replace(/ /g,"+") +
               "&sesskeys=" + AddSlot.sesskeys.value.replace(/ /g,"+") 
       AddSlot.redirec1.value="&admissno=" + 
                               AddSlot.slotrefn.value.replace(/ /g,"+") +
                              "&slotrefn=" +
                               AddSlot.slotrefn.value.replace(/ /g,"+") +
                              "&slotbtyp=" + 
                               AddSlot.slotbtyp.value.replace(/ /g,"+") +
                              "&requestk=" +
                               AddSlot.slotreqk.value.replace(/ /g,"+")
       if(AddSlot.slotbtyp.value=="2") {
          AddSlot.redirec1.value+="&slotreqk=" + 
                                 AddSlot.slotreqk.value.replace(/ /g,"+")
       }
    } else if(AddSlot.slotbtyp.value=="3" ) {     // Follow-Up Appointment
       AddSlot.redirect.value="outweb02.pbl?reportno=3&template=1" +
               "&urnumber=" + AddSlot.sloturno.value.replace(/ /g,"+") +
               "&casekeys=" + AddSlot.slotcask.value.replace(/ /g,"+") +
               "&showfoll=1"
       SetCookie("AddSlotFollowUp","NotDone",20);
    } else if(AddSlot.slotbtyp.value=="4" ) {     // Reschedule Appointment
       AddSlot.redirect.value="outweb02.pbl?reportno=3&template=1" +
               "&urnumber=" + AddSlot.sloturno.value.replace(/ /g,"+") +
               "&casekeys=" + AddSlot.slotcask.value.replace(/ /g,"+") +
               "&showresc=1"
       SetCookie("AddSlotResc","NotDone",20);
    } else if(AddSlot.slotbtyp.value=="5" ) {     // DNA Appointment
       AddSlot.redirect.value="outweb02.pbl?reportno=3&template=1" +
               "&urnumber=" + AddSlot.sloturno.value.replace(/ /g,"+") +
               "&casekeys=" + AddSlot.slotcask.value.replace(/ /g,"+") +
               "&showdnaa=1"
       SetCookie("AddSlotDnaa","NotDone",20);
    } else {                                      // Booking
     AddSlot.redirect.value="outweb02.pbl?reportno=5&template=1" +
            "&urnumber=" + AddSlot.sloturno.value.replace(/ /g,"+") +
            "&sesskeys=" + AddSlot.sesskeys.value.replace(/ /g,"+") 
     AddSlot.redirec1.value="&redirflg=" + AddSlot.redirflg.value
    }
  } else {
    AddSlot.redirect.value="outweb02.pbl?reportno=2&template=5" +
        "&sesskeys=" + AddSlot.sesskeys.value.replace(/ /g,"+") +
         "&redirflg=" + AddSlot.redirflg.value
  }
  var NewTime=AddSlot.newsltim.value.replace(/:/g,"")
  var OpenTime=AddSlot.sesskeys.value.substr(20,5).replace(/:/g,"")
  var DisplayTime=AddSlot.sesskeys.value.substr(20,5).replace(/:/g,"")
  var EndTime=AddSlot.endtime.value.replace(/:/g,"")
//
  NewTime=trim(NewTime);
  OpenTime=trim(OpenTime);
  EndTime=trim(EndTime);
  if (NewTime<OpenTime || NewTime>EndTime){
    var DisplayOpen=AddSlot.sesskeys.value.substr(20,5)
    var DisplayNew=AddSlot.newsltim.value
    var DisplayEnd=AddSlot.endtime.value
    
    if (NewTime<OpenTime){
      ans = confirm("New slot time " + DisplayNew
                     + " is before session open time " + DisplayOpen);
    } else {
      ans = confirm("New slot time " + DisplayNew
                     + " is after booking finish time " + DisplayEnd);
    }
    if (ans) {
      tempDisable(document.AddSlot.out02new);
//alert(AddSlot.redirect.value);
      AddSlot.submit(); 
      return;
    } else {
      return;
    }
  }
  tempDisable(document.AddSlot.out02new);
//alert(AddSlot.redirect.value);
  AddSlot.submit(); 
}
}
//
function UpdateBookTime() {
if (validateMandatory(document.UpdateSlot)) {
//
  var NewTime=UpdateSlot.updsltim.value.replace(/:/g,"")
  var OpenTime=UpdateSlot.sesskeys.value.substr(20,5).replace(/:/g,"")
  var DisplayTime=UpdateSlot.sesskeys.value.substr(20,5).replace(/:/g,"")
  var EndTime=UpdateSlot.endtime.value.replace(/:/g,"")
//
  NewTime=trim(NewTime);
  OpenTime=trim(OpenTime);
  EndTime=trim(EndTime);
  if (NewTime<OpenTime || NewTime>EndTime){
    var DisplayOpen=UpdateSlot.sesskeys.value.substr(20,5)
    var DisplayNew=UpdateSlot.updsltim.value
    var DisplayEnd=UpdateSlot.endtime.value
    
    if (NewTime<OpenTime){
      ans = confirm("New slot time " + DisplayNew
                     + " is before session open time " + DisplayOpen);
    } else {
      ans = confirm("New slot time " + DisplayNew
                     + " is after booking finish time " + DisplayEnd);
    }
    if (ans) {
      tempDisable(document.UpdateSlot.out02tim);
      UpdateSlot.submit(); 
      return;
    } else {
      return;
    }
  }
  tempDisable(document.UpdateSlot.out02tim);
  UpdateSlot.submit(); 
}
}
function GetAppointmentCookies() {

  if (GetCookieData("AppointmentCookie")!="unknown") {
    document.DeleteStatus.apptckie.value=
    GetCookieData("AppointmentCookie");
    ExpireCookiePath("AppointmentCookie");
//alert(document.DeleteStatus.apptckie.value);
  }


  if (GetCookieData("AppointmentTypeCookie")!="unknown") {
    document.DeleteStatus.aptyckie.value=
    GetCookieData("AppointmentTypeCookie");
    ExpireCookiePath("AppointmentTypeCookie");
//alert(document.DeleteStatus.aptyckie.value);
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);GetAppointmentCookies();showTodayButton();">
<form name=SelectPeriod action=outweb02.pbl method=get style="margin:0">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=5>
<input type=hidden name=redirflg value="%OUTWEB02.02.136">
<input type=hidden name=sesskeyt value="%OUTWEB02.02.071">
<input type=hidden name=loctoday value="%OUTWEB02.02.072">
<input type=hidden name=otcndtdy id=otcndtdy
       value="%STANDARD.01.025.032.148.1.1">

<table cellspacing=0 cellpadding=1 bgcolor=#CCCCCC border=0 width=100%>
<tr><td class=HeadingCell align=center colspan=4>
    Clinic for %OUTWEB02.02.006	 </td></tr>

<tr><td width=10% class=DataLabel>Views</td>
    <td width=35% class=DataField>
    <select onchange="ViewLink(this.value);" class=SelectMed>
    <option value=0>Bookings Details</option>
    <option value=1 selected>Update Slots</option>
    <option value=2>Reschedule</option>
    </select>
    </td>
    <td class=DataLabel>
    Date & Start Time</td>
    <td align=right>
    <span id=TodayButSpan style="display:none">
      <input type=button name=btnToday id=btnToday value="Today" class=button
       title="Switch to today's clinic"
       onclick='setTodayDate();'>
    </span>
    <input type=button value="<<" class=SmallButton
    onclick='location.href="%OUTWEB02.02.002"'>
    <select name=sesskeys onchange='document.SelectPeriod.submit();'>
    %OUTWEB02.02.003
    </select>
    <input type=button value=">>" class=SmallButton
    onclick='location.href="%OUTWEB02.02.001"'>
    </td>
</tr>

<tr><td width=10% class=DataLabel>Clinic Type</td>
    <td width=35% class=DataField>%OUTWEB02.02.027.0</td>
    <td class=DataLabel>Location</td>
    <td class=DataField>%OUTWEB02.02.029.0</td>
</tr>

<tr><td class=DataLabel>Session Status</td>
    <td class=DataField>%OUTWEB02.02.020.0</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td></tr>

<tr valign=top>
    <td class=DataLabel>Comments</td>
    <td class=DataField>
    %OUTWEB02.02.026
    <td class=DataLabel>Instructions
    </td> <td>
    <b> %OUTWEB02.02.028</b> <br></td> </tr>

    <tr><td></td><td>
    <b>%OUTWEB02.02.021<br>
    %OUTWEB02.02.022 </b>
    </td></tr>

</table>
</form>

<div id=PageBodySection>

<form name=DeleteStatus action=outweb02.pbl method=post style="margin:0">
<table width=100% border=1 cellspacing=0 name="tblSlots" id="tblSlots">
<input type=hidden name=reportno value=8>
<input type=hidden name=template value=1>
<input type=hidden name=updatety value>
<input type=hidden name=redirect value=1>
<input type=hidden name=sesskeys value='%OUTWEB02.02.004'>
<input type=hidden name=newsltyp value="">
<input type=hidden name=redirflg value="%OUTWEB02.02.136">
<input type=hidden name=apptckie value="">
<input type=hidden name=aptyckie value="">
<tr><td align=right class=HeadingCell>Slot</td>
    <td align=center class=HeadingCell>Time</td>
    <td class=HeadingCell>Visit Type</td>
    <td class=HeadingCell>Patient</td>
    <td align=center class=HeadingCell>
      <input type="button" class="button" value="All" 
       onclick="SelectAll('tblSlots',4);"></input>
    </td>
</tr>
%OUTWEB02.02.010.0
</table>
<table width=100% border=1 cellspacing=0 >
<tr><td align=center>
    New Visit Type
    <select name=newsltyp1 class="Mandatory SelectBig" title="Visit Type"
     onchange="SetVisitType();">
    <option></option>
    %OUTWEB02.02.011
    </select>
    &nbsp;&nbsp;Unavailable&nbsp;&nbsp;
    <select name=newsltyp2 class="Mandatory SelectBig" title="Unavailable"
    onchange="SetVisitType1();">
    <option></option>
    %OUTWEB02.02.033
    </select>
    </td>
    <td><div id=Comments></td>
    </tr>
<tr><td colspan=5 align=center>
    <input type=button value=Add class="button" id="out02add"
     onclick="tempDisable(this);AddNewSlot();">
    <input type=button value=Update class="button" id="out02upd"
     onclick="tempDisable(this);ProcessUpdate();">
    <input type=button value=Delete class="button" id="out02del"
     onclick="tempDisable(this);DeleteSlots();">
    </td></tr>
</table>
</form>

<div name=AddFrame id=AddFrame
style="display:none;position:absolute;border-style:outset;background-color:#cccccc">
<span class=DFrameTitleBar>
<img align=right src="../images/ExitIcon.gif" class=Icon
 onclick="closeAddFrame();">
Add New Time Slot
</span>
<form name=AddSlot action=outweb02.pbl method=post style="margin:0"
 onsubmit="return validateMandatory(this);">

<table width=95% border=0 cellspacing=0	 align=center>
<input type=hidden name=reportno value=8>
<input type=hidden name=template value=1>
<input type=hidden name=updatety value=1>
<input type=hidden name=redirect>
<input type=hidden name=redirec1>
<input type=hidden name=nextpage value=7>
<input type=hidden name=gname>
<input type=hidden name=sesskeys value='%OUTWEB02.02.004'>
<input type=hidden name=endtime value='%OUTWEB02.02.016'>
<input type=hidden name=ptcnualt value='%STANDARD.01.025.110.240.1.1'>
<input type=hidden name=alternid value="">
<input type=hidden name=aisearch value="0">
<input type=hidden name=redirflg value="%OUTWEB02.02.136">
<input type=hidden name=slotrefn value="%OUTWEB02.02.168.0">
<input type=hidden name=d_slotrefn value="%OUTWEB02.02.168.1">
<input type=hidden name=d_sloturno value="%OUTWEB02.02.169">
<input type=hidden name=slotbtyp value="%OUTWEB02.02.170">
<input type=hidden name=slotreqk value="%OUTWEB02.02.171">
<input type=hidden name=slotcask value="%OUTWEB02.02.172">
<input type=hidden name=othemref value="%OUTWEB02.02.060">

<tr><td class=DataLabel>Slot Time</td>
    <td class=DataField>
    <input type=text name=newsltim id=newsltim size=8 class=Mandatory
     title="Slot Time">
    <img src="../images/DateTimeStamp.gif" class=Icon
    onclick="SetCurrentDateTime(null,AddSlot.newsltim);">
    <img src="../images/TimeLookup.gif" class=Icon
    onclick="TimeLookupFrame(AddSlot.newsltim);">
    </td></tr>
<tr><td class=DataLabel>Visit Type</td>
    <td class=DataField>
    <select name=newsltyp class="Mandatory SelectBig" title="Visit Type">
    <option></option>
    %OUTWEB02.02.034
    </select>
    </td></tr>
<tr><td class=DataLabel>U/R</td>
    <td class=DataField>
  <input type=text name=sloturno id=sloturno title="UR Number"
   size=10 maxlength=8
   onblur="PatientReturn();">
  <input type=text name=slotpnam id=slotpnam size=30 class=Readonly readonly>
  </td></tr>
<tr><td class=DataLabel id="slot_ref_no"></td>
    <td class=DataField id="slot_ref_dep"></td>
    </tr>

<tr><td><div id=ReferralTitle></td>
    <td><div id=ReferralField></td>
    </tr>

<tr><td colspan=2 align=center>
    <input type=button value="Ok" class="button" id="out02new"
     onclick="tempDisable(this);AddNewBok()">
    <input type=button value="Cancel" class="button"
     onclick="closeAddFrame();">
    </td></tr>
</table>
</form>
</div>

<div name=UpdateFrame id=UpdateFrame
style="display:none;position:absolute;border-style:outset;background-color:#cccccc">
<span class=DFrameTitleBar>
<img align=right src="../images/ExitIcon.gif" class=Icon
 onclick="closeUpdateFrame();">
Update Slot Time Slot
</span>

<form name=UpdateSlot action=outweb02.pbl method=post style="margin:0"
 onsubmit="return validateMandatory(this);">
<table width=95% border=0 cellspacing=0  align=center>
<input type=hidden name=reportno value=8>
<input type=hidden name=template value=1>
<input type=hidden name=updatety value=11>
<input type=hidden name=redirect>
<input type=hidden name=nextpage value=1>
<input type=hidden name=gname>
<input type=hidden name=sesskeys value='%OUTWEB02.02.004'>
<input type=hidden name=updsltno value="">
<input type=hidden name=endtime value='%OUTWEB02.02.016'>
<input type=hidden name=redirflg value="%OUTWEB02.02.136">

<tr><td class=DataLabel>Slot Time</td>
    <td class=DataField>
    <input type=text name=updsltim id=updsltim size=8 class=Mandatory
     title="Slot Time">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(null,UpdateSlot.updsltim);">
    <img src="../images/TimeLookup.gif" class=Icon
     onclick="TimeLookupFrame(UpdateSlot.updsltim);">
    </td></tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    </tr>

<tr><td colspan=2 align=center>
    <input type=button value="Ok" class="button" id="out02tim"
     onclick="tempDisable(this);UpdateBookTime()">
    <input type=button value="Cancel" class="button"
     onclick="closeUpdateFrame();">
    </td></tr>
</table>
</form>
</div>

<span id=SlotComments style="display:none">
    &nbsp;Unavailable Comments&nbsp;
    <input type=text name=slotcomm id=slotcomm title="Unavailable Comments" 
     size=72 maxlength=70 onblur="TextBlurHandler(this);">
</span>

<span id=ShowReferralTitle style="display:none">
Referral No.
</span>

<span id=ShowReferralField style="display:none">
 <input type=text name=refnumbr id=refnumbr title="Referral Number"
  size=10 maxlength=8 
  class=Readonly readonly
  onblur="justifyRight(this);CheckReferral(this,AddSlot.sloturno);">
 <img src="../images/ViewIcon1.gif" class=ListIcon
  onclick='ListReferral(AddSlot.sloturno.value);'>
</span>

</div>

<script type="text/javascript">
  var chkStatus = false;
  function SelectAll(TblName, ColNum)
  {
    var chkBox = null;
    var tbl = document.getElementById(TblName);
    if (tbl && tbl.rows && (tbl.rows.length > 1)) {
      for (var i=1; i < tblSlots.rows.length; i++) {
        chkBox = tblSlots.rows[i].childNodes[ColNum].childNodes[0];
        if (chkBox && (chkBox.type == "checkbox")) {
          chkBox.checked = !chkStatus;
        }
      }
      chkStatus = !chkStatus;
    }
  }
</script>
