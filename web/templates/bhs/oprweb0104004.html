<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="bhs">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
%START.OF.PAGE
function ChkAnaes(){
   if((!isWhitespace(UpdateForm.opdea022.value)) &&
      (isWhitespace(UpdateForm.opdea021.value))) {
      alert("Anaesthetic Prep should be entered");
      UpdateForm.opdea022.value="";
      UpdateForm.opdea021.focus();
      return;
   }
   if(!isWhitespace(UpdateForm.opdea022.value)) {
   AnaesP= UpdateForm.opdea021.value.replace(/:/g,"");  
   AnaesC= UpdateForm.opdea022.value.replace(/:/g,"");  
   if(AnaesC < AnaesP) {
     if(confirm("Anaesthetic Commenced should be greater than Anaesthetic Prep"+
       "\n Do you want to override")) {
      return;
      }
      UpdateForm.opdea022.value="";
      UpdateForm.opdea022.focus();
     }
   }  
 }
function ChkPrep() {
if(!isWhitespace(UpdateForm.opdea021.value)) {
  ArrivT= UpdateForm.opard002.value.replace(/:/g,"");
  AnaesP= UpdateForm.opdea021.value.replace(/:/g,"");
  if(AnaesP < ArrivT) {
      if(confirm("Anaesthetic Prep should be greater than Arrival Time "
               + UpdateForm.opard002.value +
       "\n Do you want to override")) {
        return;
      }
      UpdateForm.opdea021.value="";
      UpdateForm.opdea021.focus();
     }
  }
}
function ChkArrv() {
if(isWhitespace(UpdateForm.opard002.value)) {
   alert("Arrival Details Missing");
   DFrameExit();
  }
if(!isWhitespace(UpdateForm.opdea022.value)) {
 //   Bug no SV47
 //   UpdateForm.opard045.className="Mandatory";
  }
}
function SetValue(){
UpdateForm.opard041.value=UpdateForm.opdea021.value;     
UpdateForm.opard042.value=UpdateForm.opdea022.value;
UpdateForm.opard044.value=UpdateForm.opdea009.value;

if(validateMandatory(UpdateForm)){
   UpdateForm.submit();
}
}
function ManASA() {
if(!isWhitespace(UpdateForm.opdea022.value)) {
 //   Bug no SV47
//UpdateForm.opard045.className="Mandatory";
}}
</script>
<script>
function TimeCheck(){

  var fieldElement;
  var theatreDate = "%OPRWEB01.04.301".slice(3,8);
  var fieldName = "timecheck%STANDARD.01.044.113.064.002".replace(" ", "0");

  try{
    if(!this.event.srcElement.value){
      return;
    }
    if(this.event.srcElement.id!=fieldName){
      return;
    }
    if(!Get("discdate").value){
      return;
    }
    fieldElement = Get(fieldName);
    var dateArray = Get("discdate").value.split(" ");
    var monthNumber = new Date(Date.parse(dateArray[1] +" 1, 2012")).getMonth()+1;
    var monthString = monthNumber<10? "0" + monthNumber : "" + monthNumber
    var dDate = dateArray[2] + monthString + dateArray[0];
    if(theatreDate + fieldElement.value > dDate+Get("disctime").value){
       alert(fieldElement.title + " cannot be after the discharge date."+
             "\nDo you want to override?");
       fieldElement.value = "";
       fieldElement.focus();
    }
  }catch(e){}
}
function Get(el){return document.getElementById(el);}
</script>
</head>
<body onload="PageLoad(event);ChkArrv()">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Theatre Case Anaesthetic Details
</span>

<form name=UpdateForm method=post action=oprweb01.pbl style="margin:0"
autocomplete="off" onsubmit='return validateMandatory(this);'>
<input type=hidden name=reportno value=5>
<input type=hidden name=template value=1>
<input type=hidden name=updatedb value="1">
<input type=hidden name=urnumber value="%OPRWEB01.04.003">
<input type=hidden name=admissno value="%OPRWEB01.04.081">
<input type=hidden name=casekeys value="%OPRWEB01.04.101">
<input type=hidden name=opsedate value="%OPRWEB01.04.302">
<input type=hidden name=currdate value="%STANDARD.01.013">
<input type=hidden name=currtime>
<input type=hidden name=opard041 value="">
<input type=hidden name=opard042 value=""> 
<input type=hidden name=opard044 value="">
<input type=hidden name=prepasec value=0>
<input type=hidden name=commesec value=0>
<input type=hidden name=opard002 value="%OPRWEB01.04.402">
<input type=hidden name="discdate" id="discdate" value="%OPRWEB01.04.629">
<input type=hidden name="disctime" id="disctime" value="%OPRWEB01.04.630">

<table border="0" cellpadding="2" cellspacing="0" width="95%" align=center>
<tr><td class=DataLabel nowrap>Anaesthetic Prep Commenced</td>
  <td class=DataField>
  <input type=text name=opdea021 value="%OPRWEB01.04.441" id="timecheck03"
  size=8 title="Anaesthetic Prep Commenced Time" 
  onblur="checkTime(this,this.title);ChkPrep();
  CheckFutureTime(UpdateForm,UpdateForm.opsedate.value,UpdateForm.opdea021);TimeCheck()">
      <img src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(null,UpdateForm.opdea021);">
      <img src=../images/TimeLookup.gif class=Icon
      onclick="TimeLookupFrame(UpdateForm.opdea021);"></td>
    <td class=DataLabel nowrap>Patient Entered OR</td>
    <td class=DataField>
    <input type=text name=opdea022 value="%OPRWEB01.04.442" id="timecheck04"
     size=8 title="Patient Entered OR Time" 
     onblur="checkTime(this,this.title);ChkAnaes();ManASA();
     CheckFutureTime(UpdateForm,UpdateForm.opsedate.value,UpdateForm.opdea022);TimeCheck()">
      <img src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(null,UpdateForm.opdea022);">
      <img src=../images/TimeLookup.gif class=Icon
      onclick="TimeLookupFrame(UpdateForm.opdea022);"></td></tr>
<!--
<tr>
    <td class=DataLabel nowrap>Anaesthetic Time Out</td>
    <td class=DataField><input type=text name=opard061 size=8 maxlength=8
       title="Anaesthetic Time Out" value="OPRWEB01.04.461" 
       onblur="checkTime(this,this.title);">
      <img src="../images/DateTimeStamp.gif" class=Icon align=absmiddle
       onclick="SetCurrentDateTime(null,UpdateForm.opard061);">
      <img src=../images/TimeLookup.gif border=0 class=Icon align=absmiddle
       onclick="TimeLookupFrame(UpdateForm.opard061);"></td>
</tr>
-->

<tr><td class=DataLabel>Anaesthetic Type</td>
    <td class=DataField>
    <select name=opdea003 title="Anaesthetic Type" >
    <option></option>
      %OPRWEB01.04.113.2
    </select></td>

    <td class=DataLabel>Intubated</td>
    <td class=DataField>
    <select name=opdea009 title="Intubated">
    <option></option>
    %OPRWEB01.04.119.2
    </select>
    </td></tr>

<tr><td class=DataLabel>ASA Score</td>
    <td class=DataField>
    <select name=opard045 title="ASA Score">
    <option></option>
      %OPRWEB01.04.445.2
    </select></td></tr>

<tr valign=top><td class=DataLabel>Preadmission and<br> Operation Notes
    <td colspan=3>
<textarea wrap=hard cols=50 rows=5 name=opcom002>%OPRWEB01.04.143.002</textarea>
<a href='javascript:LookupPage(null,UpdateForm.opcom002,"Lookup_00100000_000")'>
    <img src="../images/LookupIcon.gif" border=0></a>
    </td></tr>

<tr><td colspan=4 align=center>
    <input class="button" type=button id="opr01sub" value="OK" onclick="tempDisable(this);SetValue();">
    <input class="button" type=button value="Cancel" onclick="DFrameClose();">
    </td></tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%OPRWEB01.04.003">
<input type=hidden name=admissno value="%OPRWEB01.04.081">
<input type=hidden name=casekeys value="%OPRWEB01.04.101">
<input type=hidden name=MenuType value="%OPRWEB01.04.088">
<input type=hidden name=opdeb001>
</form>
