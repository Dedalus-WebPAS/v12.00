<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="svha">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb01.js"></script>
<script type="text/javascript" >
function validateNurse() {
  var hcpnurse = chkHcpOTNurse();
  if (hcpnurse==true){
     validateCode('18',document.arrivalForm.opard003,
                       document.arrivalForm.name_opard003);
  }
  else {
     validateCode('17',document.arrivalForm.opard003,
                       document.arrivalForm.name_opard003,
                       document.arrivalForm.gnm,
                       SetNurseName);
  }
}
function SetNurseName() {
arrivalForm.name_opard003.value=arrivalForm.gnm.value.replace(/\s*$/g,"")+
                              " " +
                            arrivalForm.name_opard003.value.replace(/\s*$/g,"")
}
function ChkDelay() {
if(arrivalForm.opard002.value === "")
 return;

var TimeCald=trim(arrivalForm.opard039.value.replace(/:/g,""))
var ArrvTime=trim(arrivalForm.opard002.value.replace(/:/g,""))
TimeCald=TimeCald.substr(0,4)
ArrvTime=ArrvTime.substr(0,4)
TimeCald=TimeCald - 0;
ArrvTime=ArrvTime - 0;
if(TimeCald>ArrvTime) {
  if(document.arrivalForm.suprlevl.value != "S") {
     alert("Time Called for cannot be after the Arrival Time.");
     arrivalForm.opard002.value="";
     FocusDelay(document.arrivalForm.opard002);
     return;
  }
  if (confirm("Time Called for cannot be after the Arrival Time." +
     "\n Do you want to override")) {
     if(TimeCald >= (2200 - 0)) {
        ArrvTime = ArrvTime + 2400;
     }
  } else {
    arrivalForm.opard002.value="";
    return;
  }
}
var MaxDelay=(parseInt(TimeCald) + parseInt(arrivalForm.mindelay.value))
var Minutes=parseInt(MaxDelay) % 100
var Hour=parseInt(MaxDelay) / 100
if (Minutes>=60) {
   Minutes=Minutes - 60
   Hour=parseInt(Hour) + 1
   MaxDelay = (Hour*100) + Minutes
}
if (MaxDelay < ArrvTime) {
   arrivalForm.opard004.className="Mandatory"
   }
else {
   arrivalForm.opard004.className=""
   }
}
function ChkArrv() {
  if(arrivalForm.opard039.value === "")
     return;

  if(!isWhitespace(arrivalForm.opard002.value)) {
    var TimeCald=trim(arrivalForm.opard039.value.replace(/:/g,""))
    var ArrvTime=trim(arrivalForm.opard002.value.replace(/:/g,""))
    TimeCald=TimeCald - 0;
    ArrvTime=ArrvTime - 0;
    if(TimeCald>ArrvTime) {
      if(document.arrivalForm.suprlevl.value != "S") {
        alert("Time Called for cannot be after the Arrival Time.");
        arrivalForm.opard002.value="";
        FocusDelay(document.arrivalForm.opard039);
        return;
      }
      if (confirm("Time Called for cannot be after the Arrival Time." +
         "\n Do you want to override")) {
        return;
       }
       arrivalForm.opard002.value="";
       arrivalForm.opard039.value="";
       return;
      }
   }
}
function formSubmit(){
   setCGI(arrivalForm);
   anTime=arrivalForm.anaesTime.value.replace(/:/g,"");
   arTime=arrivalForm.opard002.value.replace(/:/g,"")
   if(!isWhitespace(anTime)){
    if(arTime > anTime){
      if(document.arrivalForm.suprlevl.value != "S") {
        alert("Arrival time should be less than Anaesthetic time.");
        FocusDelay(document.arrivalForm.opard039);
        return;
      }
      if(!confirm("Arrival time should be less than Anaesthetic time " +
               arrivalForm.anaesTime.value +
         "\n Do you want to override")) {
      return;
      }
     }
   }
   if(validateMandatory(arrivalForm))
       arrivalForm.submit();
}
//C-0825792 - Check Use pmshcpaf/oprnuraf for OT Nurse
function chkHcpOTNurse(){
  if (document.getElementById('opcnurse')) {
      if (document.getElementById('opcnurse').value == "1") {
        return true;
      }
      else {
        return false;
      }
  }
  else {
      return false;
  }
}

//C-0825792 - Search Nurse from pmshcpaf/oprnuraf for OT Nurse
function SearchOTNurse(NurseId,ReturnNurseName) {
  var hcpnurse = chkHcpOTNurse();
  if (hcpnurse==true){
     HCPSearchFrame(NurseId,ReturnNurseName,20);
  }
  else {
     NurseSearchFrame(NurseId,ReturnNurseName);
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);setRadio(arrivalForm)">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Theatre Case Arrival Details
</span>

<form name=arrivalForm method=get action=oprweb01.pbl style="margin:0"
 onsubmit="setCGI(arrivalForm);return validateMandatory(this);">
<input type=hidden name=reportno value=5>
<input type=hidden name=template value=003>
<input type=hidden name=updttype value="U">
<input type=hidden name=urnumber value="%OPRWEB01.04.003">
<input type=hidden name=admissno value="%OPRWEB01.04.081">
<input type=hidden name=anaesTime value="%OPRWEB01.04.442">
<input type=hidden name=mindelay value="%OPRWEB01.04.602">
<input type=hidden name=casekeys value="%OPRWEB01.04.101">
<input type=hidden name=gnm id=gnm>
 
<!-- dont change order of hidden parameters opard005-12. it will adversely 
  affect java script functions setCGI() and setRadio() -->
<input type=hidden name=opard005 value="%OPRWEB01.04.405">
<input type=hidden name=opard006 value="%OPRWEB01.04.406">
<input type=hidden name=opard007 value="%OPRWEB01.04.407">
<input type=hidden name=opard008 value="%OPRWEB01.04.408">
<input type=hidden name=opard009 value="%OPRWEB01.04.409">
<input type=hidden name=opard010 value="%OPRWEB01.04.410">
<input type=hidden name=opard011 value="%OPRWEB01.04.411">
<input type=hidden name=opard012 value="%OPRWEB01.04.412">
<input type=hidden name=opsedate value="%OPRWEB01.04.302">
<input type=hidden name=currdate value="%STANDARD.01.013">
<input type=hidden name=currtime value="">
<input type=hidden name=opcnurse id=opcnurse
       value="%STANDARD.01.025.113.051.0.1">
<input type=hidden name=I value="%OPRWEB01.04.007">
<input type=hidden name="suprlevl" id="suprlevl" value="%OPRWEB01.04.654">

<table border="0" cellpadding="2" cellspacing="0" width="100%">
<tr><td class=DataLabel>Time Called For</td>
    <td class=DataField><input type=text name=opard039 id=opard039 size=8
     value="%OPRWEB01.04.439" title="Time Called For"
     onblur="checkTime(this,this.title);ChkArrv();ChkDelay();
             CheckFutureTime(arrivalForm,document.arrivalForm.opsedate.value,opard039);">
      <img src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(null,opard039);">
      <img src="../images/TimeLookup.gif" class=Icon
      onclick="TimeLookupFrame(opard039);">
    </td>
    <td class=DataLabel>Time Arrived</td>
    <td class=DataField><input type=text name=opard002 id=opard002 size=8
     value="%OPRWEB01.04.402" title="Time Arrived"
      onblur="checkTime(this,this.title);ChkDelay();
      CheckFutureTime(arrivalForm,document.arrivalForm.opsedate.value,opard002);">
      <img src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(null,opard002);">
      <img src="../images/TimeLookup.gif" class=Icon
      onclick="TimeLookupFrame(opard002);">
    </td></tr>

<tr><td class=DataLabel nowrap>Pre-op Check List Complete</td>
    <td class=DataField>
    <input type=radio name=checkl05 value="Yes">Yes
    <input type=radio name=checkl05 value="No">No</td>

    <td class=DataLabel>Consent Form Signed</td>
    <td class=DataField>
    <input type=radio name=checkl06 value="Consent Form Signed">Yes
    <input type=radio name=checkl06 value="Consent Form NOT Signed">No</td>
</tr>

<tr><td class=DataLabel>Medical Record</td>
    <td class=DataField>
    <input type=radio name=checkl07 value="Medical Record">Yes
    <input type=radio name=checkl07 value="NO Medical Record">No</td>

    <td class=DataLabel>X-Rays</td>
    <td class=DataField>
    <input type=radio name=checkl08 value="X-Rays">Yes
    <input type=radio name=checkl08 value="NO X-Rays">No</td>
</tr>
<tr><td class=DataLabel>Bladder Empty</td>
    <td class=DataField>
    <input type=radio name=checkl09 value="Bladder Empty">Yes
    <input type=radio name=checkl09 value="Bladder NOT Empty">No</td>

    <td class=DataLabel nowrap>Make-up/Jewellery Removed</td>
    <td class=DataField>
    <input type=radio name=checkl10 value="Make-up Removed">Yes
    <input type=radio name=checkl10 value="Make-up NOT Removed">No</td>
</tr>

<tr><td class=DataLabel>Pre-medication Given</td>
    <td class=DataField>
    <input type=radio name=checkl11 value="Pre-medication Given">Yes
    <input type=radio name=checkl11 value="Pre-medication NOT Given">No</td>

    <td class=DataLabel>Checked Allergies</td>
    <td class=DataField>
    <input type=radio name=checkl12 value="Allergies Checked">Yes
    <input type=radio name=checkl12 value="Allergies NOT Checked">No</td>
</tr>

<tr><td class=DataLabel>Arrival Delay Reason</td>
    <td class=DataField>
    <select name=opard004 id=opard004 title="Arrival Delay Reason" 
     class=selectBig>
    <option></option>
    %OPRWEB01.04.404.2
    </select></td>
    <td class=DataLabel>Admitting Nurse</td>
    <td class=DataField nowrap>
    <input type=text name=opard003 id=opard003 title="Nurse Code" size=6 
     class=DataField maxlength=6 value="%OPRWEB01.04.403.1" 
     onblur="validateNurse();">
    <input type=text name=name_opard003 id=name_opard003 title="Nurse"
     class=ReadOnly readonly size=22 maxlength=30 value="%OPRWEB01.04.403.0">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="SearchOTNurse(opard003,name_opard003);">
     </td></tr>
    
<tr><td class=DataLabel>Prosthesis</td>
    <td class=DataField >
    <input type=text name=opard013 value='%OPRWEB01.04.413' maxlength=40>
    </td></tr>

<tr><td colspan=4 align=center>
    <input class="button" type=button id="opr01sub" value="Update" 
     onclick="tempDisable(this);formSubmit();">
    <input class="button" type=button value="Cancel" onclick="DFrameClose();">
    </td></tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%OPRWEB01.04.003">
<input type=hidden name=admissno value="%OPRWEB01.04.081">
<input type=hidden name=casekeys value="%OPRWEB01.04.101">
<input type=hidden name=MenuType value="%OPRWEB01.04.088">
</form>
