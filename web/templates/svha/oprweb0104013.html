<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="svha">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function Rebooking() {
 if(RebookForm.casekeys.value.substr(22,1)!=3) {
   alert("Booking will be reinstated if Patient has Cancelled status");
   return;
  }
 RebookForm.submit();
}

function RecoveryDetails() {
  PatientLinks.teamnumb.value = document.getElementById('thteamno').value;
  PatientLinkTo("oprweb06.pbl",10,1,0,0,0);
}

function TeamDetails() {
  PatientLinks.teamnumb.value = document.getElementById('thteamno').value;
  PatientLinkTo("oprweb01.pbl",04,13,0,0,0);
}
function UnusagePatSess() {
  if (confirm("Do you want to cancel the above Usage record.")) {
    UsageForm.redirect.value="oprweb01.pbl?reportno=4&template=013&casekeys="
                             + UsageForm.casekeys.value;
    UsageForm.submit();
  }
}
function CalcTheatreMins() {
  var divThtrMins = document.getElementById('divThtrMins');
  var startTime, endTime = "";

  // Get 'Procedure Start Time'
  if (!isWhitespace(DisplayForm.anaestrt.value)) {
    startTime = DisplayForm.anaestrt.value;
  } else if (!isWhitespace(DisplayForm.surgstrt.value)) {
    startTime = DisplayForm.surgstrt.value;
  }
  else {  // no 'Procedure Start Time'
    divThtrMins.innerHTML = "";  // show blank theatre minutes
    return;
  }

  // Get 'Procedure End Time'
  if (!isWhitespace(DisplayForm.patdiedt.value)) {  // Patient Died Time
    endTime = DisplayForm.patdiedt.value;
  } else if (!isWhitespace(DisplayForm.d_opa071.value)) {  // Time into RR First
    endTime = DisplayForm.d_opa071.value;
  } else if (!isWhitespace(DisplayForm.d_opa077.value)) {  // Time into RR Third
    endTime = DisplayForm.d_opa077.value;
  } else if (!isWhitespace(DisplayForm.d_opa083.value)) {  // Time into ICU
    endTime = DisplayForm.d_opa083.value;
  } else if (!isWhitespace(DisplayForm.d_anaeft.value)) {  // Anaes. Finish Time
    endTime = DisplayForm.d_anaeft.value;
  } else if (!isWhitespace(DisplayForm.surgendt.value)) {  // Surgery End Time
    endTime = DisplayForm.surgendt.value;
  }
  else {  // no 'Procedure End Time'
    divThtrMins.innerHTML = "";  // show blank theatre minutes
    return;
  }

  //
  // Calculate theatre minutes ...
  //
  var theatreDate = DisplayForm.casekeys.value.substr(3,8);

  // Set 'From' date/time fields
  DisplayForm.surgfrdt.value = SetDateDDMMMYYYY(theatreDate);
  DisplayForm.surgfrtm.value = startTime;

  // Set 'To' date/time fields
  DisplayForm.surgtodt.value = SetDateDDMMMYYYY(theatreDate);
  if (DisplayForm.ovrnight.value == "Yes") {  // overnight indicator set
    // add 1 day to our date
    AddSubtractDate(DisplayForm.surgtodt,"1","A");
  }
  DisplayForm.surgtotm.value = endTime;

  // Calculate the duration
  CalculateDuration(DisplayForm.surgfrdt,DisplayForm.surgfrtm,DisplayForm.surgtodt,DisplayForm.surgtotm,DisplayForm.duration);

  // Display theatre minutes
  divThtrMins.innerHTML = DisplayForm.duration.value + " minutes";
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);CalcTheatreMins();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OPRWEB01.04.003";
PatientVIS="%OPRWEB01.04.081";
PatientNAM="%OPRWEB01.04.002";
PatientSTA="%OPRWEB01.04.086.078";
PatientALT="%OPRWEB01.04.084";
PatientSEX="%OPRWEB01.04.019";
PatientDOB="%OPRWEB01.04.020";
PatientAGE="%OPRWEB01.04.021";
PatientLOC="%OPRWEB01.04.083";
PatientPRI="%OPRWEB01.04.086.066.1";
PatientUNT="%OPRWEB01.04.066.0";
DoctorCOD="%OPRWEB01.04.082.003";
DoctorNAM="%OPRWEB01.04.082.002";
PatientAID="%OPRWEB01.04.086.090";
PatientIND="%OPRWEB01.04.086.091";
PatientCUR="%OPRWEB01.04.086.092";
PatientCLC="%OPRWEB01.04.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OPRWEB01.04.086.094";
PatientCDM="%OPRWEB01.04.086.095";
PatientVDH="%OPRWEB01.04.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>

<form name=DisplayForm id=DisplayForm>
<input type=hidden name=casekeys id=casekeys value="%OPRWEB01.04.101">
<input type=hidden name=anaestrt id=anaestrt value="%OPRWEB01.04.442">
<input type=hidden name=surgstrt id=surgstrt value="%OPRWEB01.04.705">
<input type=hidden name=surgendt id=surgendt value="%OPRWEB01.04.706">
<input type=hidden name=patdiedt id=patdiedt value="%OPRWEB01.04.482">
<input type=hidden name=surgfrdt id=surgfrdt value="">
<input type=hidden name=surgtodt id=surgtodt value="">
<input type=hidden name=surgfrtm id=surgfrtm value="">
<input type=hidden name=surgtotm id=surgtotm value="">
<input type=hidden name=duration id=duration value="">
<input type=hidden name=ovrnight id=ovrnight value="%OPRWEB01.04.771">
<input type=hidden name=d_anaeft id=d_anaeft value="%OPRWEB01.04.443">
<input type=hidden name=d_opa071 id=d_opa071 value="%OPRWEB01.04.471">
<input type=hidden name=d_opa077 id=d_opa077 value="%OPRWEB01.04.477">
<input type=hidden name=d_opa083 id=d_opa083 value="%OPRWEB01.04.483">

<table border=1 width=100% cellspacing=0>
<tr><td>
<table border="0" cellpadding="2" cellspacing="0" width="100%" >
<tr><td colspan=4 align=center class=HeadingCell>
    Supervisor Corrections</td>
    <td class=HeadingCell align=right>
      <font color=red>%OPRWEB01.04.601</font></td></tr>

<tr><td width=15% class=DataLabel>Team No. </td>
    <td class=DataField>
      <select name=thteamno id=thteamno title="Theatre Team" class=Mandatory
       onchange="TeamDetails();">
       %OPRWEB01.04.148
      </select></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td></tr>


<tr><td width=15% class=DataLabel>Consultant   </td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB01.04.304.003")'>
    %OPRWEB01.04.304.002 </a></td>
    <td class=DataLabel>Operating Surgeon</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB01.04.604.003")'>
    %OPRWEB01.04.604.002 </a></td></tr>
<tr><td width=15% class=DataLabel>Anaesthetist   </td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB01.04.316.003")'>
    %OPRWEB01.04.316.002 </a></td></tr>
<tr><td class=DataLabel>Unit</td>
    <td class=DataField>%OPRWEB01.04.313.0</td>
    <td class=DataLabel>Session Type</td>
    <td class=DataField>%OPRWEB01.04.369.0</td>
<tr><td class=DataLabel>Theatre</td>
    <td class=DataField>%OPRWEB01.04.314.0</td>
    <td class=DataLabel>Actual Theatre</td>
    <td class=DataField>%OPRWEB01.04.130</td>
<tr><td class=DataLabel>Date </td>
    <td class=DataField>%OPRWEB01.04.306 %OPRWEB01.04.302</td>
    <td class=DataLabel>Time </td>
    <td class=DataField>%OPRWEB01.04.303 to %OPRWEB01.04.308</td></tr>
<tr><td class=DataLabel>Time Called For</td>
    <td class=DataField>%OPRWEB01.04.439</td></tr>
<tr><td class=DataLabel>Time Arrived </td>
    <td class=DataField><font color=green>%OPRWEB01.04.402</font></td>
    <td class=DataLabel>Time into Recovery Room - First Stage</td>
    <td class=DataField><font color=green>%OPRWEB01.04.471</font></td></tr>
<tr><td class=DataLabel>Anaesthetic Prep</td>
    <td class=DataField>%OPRWEB01.04.441</td>
    <td class=DataLabel>Anaesthetic Finish Time / Handover to Recovery Complete</td>
    <td class=DataField>%OPRWEB01.04.443</td></tr>
<tr><td class=DataLabel>Anaesthetic Time Out</td>
    <td class=DataField><font color=green>%OPRWEB01.04.461</font></td>
    <td class=DataLabel>Time into Second Stage Recovery Room</td>
    <td class=DataField><font color=green>%OPRWEB01.04.474</font></td></tr>
<tr><td class=DataLabel>Anaesthesia Start Time</td>
    <td class=DataField>%OPRWEB01.04.442</td>
    <td class=DataLabel>Time into Third Stage Recovery Room</td>
    <td class=DataField>%OPRWEB01.04.477</td></tr>
<tr><td class=DataLabel>Time into OR</td>
    <td class=DataField><font color=green>%OPRWEB01.04.703</font></td>
    <td class=DataLabel>Time Ready to Depart</td>
    <td class=DataField><font color=green>%OPRWEB01.04.485</font></td></tr>
<tr><td class=DataLabel>Surgical Team Time Out</td>
    <td class=DataField>%OPRWEB01.04.429</td>
    <td class=DataLabel>Exit Theatre Complex Time</td>
    <td class=DataField>%OPRWEB01.04.480</td></tr>
<tr><td class=DataLabel>Surgery Start Time</td>
    <td class=DataField><font color=green>%OPRWEB01.04.705</font></td>
    <td class=DataLabel>Time Patient Went to ICU</td>
    <td class=DataField><font color=green>%OPRWEB01.04.483</font></td></tr>
<tr><td class=DataLabel>Surgery End Time</td>
    <td class=DataField>%OPRWEB01.04.706</td>
    <td class=DataLabel>Time Patient Died</td>
    <td class=DataField>%OPRWEB01.04.482</td></tr>
<tr><td class=DataLabel>Prosthetics Charge</td>
    <td class=DataField>%OPRWEB01.04.424 </td>
    <td class=DataLabel>%STANDARD.01.017.oa</td>
    <td class=DataField>%OPRWEB01.04.414.0</td></tr>
<tr><td>Theatre Minutes</td>
    <td class=DataField><div id=divThtrMins></div></td>
    <td class=DataLabel>%STANDARD.01.017.ob</td>
    <td class=DataField>%OPRWEB01.04.415.0</td></tr>
</table>
</td></tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%" >
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td width=15%><td><input type=button value="Arrival" class="button"
      onclick='PatientLinkTo("oprweb01.pbl",4,3,1,650,280);'></td>
     <td><input type=button value="Anaesthetic" class="button"
      onclick='PatientLinkTo("oprweb01.pbl",4,4,1,650,280);'></td>
     <td><input type=button value="Surgery" class="button"
      onclick='PatientLinkTo("oprweb06.pbl",1,1,0,0,0);'></td>
     <td><input type=button value="Other Theatre" class="button"
      onclick='PatientLinkTo("oprweb06.pbl",8,1,0,0,0);'></td>
     <td><input type=button value="Un-Usage" class="button"
      onclick='UnusagePatSess();'></td>
     <td><input type=button value="Unplanned Ret" class="button"
      onclick="PatientLinkTo('oprweb01.pbl',4,22,1,750,400);"></td>
</tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td width=15%><td><input type=button value="Tourniquet" class="button"
      onclick='PatientLinkTo("oprweb06.pbl",9,1,0,0,0);'></td>
     <td><input type=button value="Recovery" class="button"
      onclick="RecoveryDetails();"></td>
     <td><input type=button value="Change Theatre" class="button"
      onclick='PatientLinkTo("oprweb01.pbl",4,14,1,350,180);'></td>
     <td><input type=button value="Reinstate Booking" class="Bigbutton"
      onclick='Rebooking();'></td>
     <td><input type=button value="Change UR" class="button"
      onclick='PatientLinkTo("patweb98.pbl",1,41,1,350,380);'></td>
     <td><input type=button value="Merge Booking" class="button"
      onclick='PatientLinkTo("oprweb01.pbl",4,21,1,750,400);'></td></tr>
</table>

</form>
</div>

<form name=PatientLinks id=PatientLinks method=get>
<input type=hidden name=reportno id=reportno value=1>
<input type=hidden name=template id=template value=004>
<input type=hidden name=urnumber id=urnumber value="%OPRWEB01.04.003">
<input type=hidden name=admissno id=admissno value="%OPRWEB01.04.081">
<input type=hidden name=casekeys id=casekeys value="%OPRWEB01.04.101">
<input type=hidden name=MenuType id=MenuType value="%OPRWEB01.04.088">
<input type=hidden name=suprlevl id=suprlevl value="S">
<input type=hidden name=teamnumb id=teamnumb value="1">
<input type=hidden name=svmpflag id=svmpflag value="1">
<input type=hidden name=nodressg id=nodressg value="1">
</form>
<form name=RebookForm id=RebookForm method=post action="oprweb01.pbl">
<input type=hidden name=reportno id=reportno value=18>
<input type=hidden name=casekeys id=casekeys value="%OPRWEB01.04.101">
<input type=hidden name=urnumber id=urnumber value="%OPRWEB01.04.003">
<input type=hidden name=admissno id=admissno value="%OPRWEB01.04.081">
<input type=hidden name=nextpage id=nextpage value="1">
</form>
<form name=UsageForm id=UsageForm method=post action="oprweb01.pbl">
<input type=hidden name=reportno id=reportno value=5>
<input type=hidden name=casekeys id=casekeys value="%OPRWEB01.04.101">
<input type=hidden name=urnumber id=urnumber value="%OPRWEB01.04.003">
<input type=hidden name=admissno id=admissno value="%OPRWEB01.04.081">
<input type=hidden name=updttype id=updttype value="R">
<input type=hidden name=nextpage id=nextpage value="1">
<input type=hidden name=redirect id=redirect value="oprweb01.pbl?reportno=4&template=013">
</form>
