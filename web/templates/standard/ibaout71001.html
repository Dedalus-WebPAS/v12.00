<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function init() {
  var p = document.ReportForm;
  if (p.ptcnsmsn.value=="1") {
    p.keystr01.options[p.keystr01.options.length]= new Option("SMS","8");
  }
}
function LetterType() {
  var fe=document.getElementById('ReportForm').elements;
  if (fe.namedItem('keystr01').value==1) {
     OptPrinter.innerHTML = normalPrinter.innerHTML;
     document.getElementById('LetterOption').innerHTML=
       document.getElementById('GeneralLetter').innerHTML;
     fe.namedItem('d_schdprnt').className = "Mandatory";
     fe.namedItem('d_schdprnt').disabled = false;
     ShowHospital();   
     setClinicIdList();
  } else if (fe.namedItem('keystr01').value==6) {
     OptPrinter.innerHTML = normalPrinter.innerHTML;
     document.getElementById('LetterOption').innerHTML=
       document.getElementById('ClinicLetter').innerHTML;
     fe.namedItem('d_schdprnt').className = "Mandatory";
     fe.namedItem('d_schdprnt').disabled = false;
     ShowHospital();   
     setClinicIdList();
  } else {
     OptPrinter.innerHTML = smsPrinter.innerHTML;
     document.getElementById('LetterOption').innerHTML=
       document.getElementById('ClinicSMS').innerHTML;
     ShowHospital();   
     setClinicIdList();
     if(fe.namedItem('ptcnsmso').value=="1") {
       sortSelectionList(fe.namedItem('keystr36'));
     }
  }
  ShowDateTitle();
}

function ProcessReport() {
  var f=document.getElementById('ReportForm');
  var fe=document.getElementById('ReportForm').elements;

  if(!validateMandatory(f)) {
     return;
  }

  if (!isWhitespace(fe.namedItem('keystr08').value)) {  // Site To not blank
    if(!CheckRange(fe.namedItem('keystr07'),fe.namedItem('keystr08'))) {
      return ;
    }
  }

  if (!isWhitespace(fe.namedItem('keystr11').value)) {  // Clinic To not blank
    if(!CheckRange(fe.namedItem('keystr10'),fe.namedItem('keystr11'))) {
      return ;
    }
  }

  if(!CheckRange(fe.namedItem('keystr13'),fe.namedItem('keystr14'))) {
    return ;
  }
  if(!CheckRange(fe.namedItem('keystr16'),fe.namedItem('keystr17'))) {
    return ;
  }

/*
  if (!isWhitespace(fe.namedItem('keystr22').value)) {  // Visit ty To not blank
    if(!CheckRange(fe.namedItem('keystr21'),fe.namedItem('keystr22'))) {
      return ;
    }
  }
*/
  if(!CheckDateRange(fe.namedItem('keystr24'),fe.namedItem('keystr25'))) {
     return ;
  }

  if (fe.namedItem('keystr01').options[
       fe.namedItem('keystr01').selectedIndex].value == "8") {  // SMS ?
    if (fe.namedItem('multiple').selectedIndex == -1) {
      alert("Please select the Clinic Type value(s)");
      fe.namedItem('multiple').focus();
      return;
    }

    if (fe.namedItem('multiple').selectedIndex == 0) {  // ALL option selected?
      fe.namedItem('multiple').disabled = true;         // don't post Clinic
                                                        // Type selection
    }

    if (fe.namedItem('multipl1').selectedIndex == -1) {
      alert("Please select the Visit Type value(s)");
      fe.namedItem('multipl1').focus();
      return;
    }
    if (fe.namedItem('multipl1').selectedIndex == 0) {  // ALL option selected?
      fe.namedItem('multipl1').disabled = true;         // don't post Visit 
                                                        // Type selection
    }


  }
  else {  // not SMS
    if (!isWhitespace(fe.namedItem('keystr28').value)) {
      if (!CheckRange(fe.namedItem('keystr27'),fe.namedItem('keystr28'))) {
        return;
      }
    }
    if (!isWhitespace(fe.namedItem('keystr22').value)) {
      if (!CheckRange(fe.namedItem('keystr21'),fe.namedItem('keystr22'))) {
        return;
      }
    }
  }

  if(!CheckRange(fe.namedItem('keystr30'),fe.namedItem('keystr31'))) {
     return ;
  }

  var dateFrom, dateTo;
  if (fe.namedItem('schdrdat').value == "") {  // Schedule to print now
    var dateRngFr = fe.namedItem('datran01');  // Date Range From
    var dateRngTo = fe.namedItem('datran02');  // Date Range To

    if (fe.namedItem('keystr01').value == "6") {
      // Clinic Master Booking Letter
      dateFrom = fe.namedItem('keystr33');
      dateTo = fe.namedItem('keystr34');

      dateFrom.title = "From Date"
      dateTo.title = "To Date"

      dateFrom.value = dateRngFr.value;  // set 'From Date' with Range From
      dateTo.value = dateRngTo.value;    // set 'To Date' with Range To

      if (!CheckDateRange(dateFrom,dateTo)) {
        return;
      }
    }
    else {
      // General Letter & SMS
      dateFrom = fe.namedItem('keystr02');
      dateTo = fe.namedItem('keystr03');

      dateFrom.title = "From Date"
      dateTo.title = "To Date"

      dateFrom.value = dateRngFr.value;  // set 'From Date' with Range From
      dateTo.value = dateRngTo.value;    // set 'To Date' with Range To

      if (!CheckDateRange(dateFrom,dateTo)) {
        return;
      }
    }
  }
  else {  // Re-scheduling
    if (fe.namedItem('keystr01').value == "6") {
      // Clinic Master Booking Letter
      fe.namedItem('keystr33').title="From Schedule";
      fe.namedItem('keystr34').title="To Schedule";
    }
    else {
      // General Letter & SMS
      fe.namedItem('keystr02').title="From Schedule";
      fe.namedItem('keystr03').title="To Schedule";
    }
  }

  if (fe.namedItem('keystr01').value=="8") {
    // Use system parameter SMS printer
    fe.namedItem('schdprnt').value = fe.namedItem('smsprntr').value;
    fe.namedItem('schdtype').value = "3";  // 'SMS' output type
  }
  else {
    // Use selected printer
    fe.namedItem('schdprnt').value = fe.namedItem('d_schdprnt').value;
  }

  if (fe.namedItem('ibcnmhos').value==1) {
    fe.namedItem('keystr38').value = fe.namedItem('filthosp').value;
  }
  else {
    fe.namedItem('keystr38').value = "";
  }

  SubmitReport(f);
}

function ShowDateTitle() {
  var fe=document.getElementById('ReportForm').elements;
  if(fe.namedItem('keystr01').value=="6") {
    document.getElementById("datetitle").innerHTML="Generate Letter Date";
  } else {
    document.getElementById("datetitle").innerHTML="Booking Date";
  } 
}
function CallReportSchedule() {
  var fe=document.getElementById('ReportForm').elements;
  var dateRngSch = document.getElementById('datsch01');
  var dateFrom, dateTo;

  if (fe.namedItem('keystr01').value == "6") {
    // Clinic Master Booking Letter
    dateFrom = fe.namedItem('keystr33');
    dateTo = fe.namedItem('keystr34');
  } else {
    // General Letter & SMS
    dateFrom = fe.namedItem('keystr02');
    dateTo = fe.namedItem('keystr03');
  }

  UpReportSchedule(dateRngSch,dateFrom,dateTo);
}
function ValidateSelect(List) {
  if (List.selectedIndex == 0) {  // 'All' option selected
    for (i=1; i < List.options.length; i++) {
      List.options[i].selected = false;  // de-select all other options
    }
  }
}
function ShowHospital() {
  var fe=document.getElementById('ReportForm').elements;
  if (fe.namedItem('ibcnmhos').value == "1") {
    document.getElementById('ShowHospital').style.display = "";
  }
  else {
    document.getElementById('ShowHospital').style.display = "none";
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ReportLoad();LetterType();
              ShowHospital();
              ShowDateTitle(); 
 document.getElementById('ReportForm').elements.namedItem('schddate').focus();">
<form name=ReportForm id=ReportForm method=post action=rshweb02.pbl
      style="margin:0">
<input type=hidden name=reportno id=reportno value=4>
<input type=hidden name=template id=template value=001>
<input type=hidden name=updttype id=updttype value="A">
<input type=hidden name=setdfprg id=setdfprg value="IBAOUT71">
<input type=hidden name=setdfrep id=setdfrep value="01">
<input type=hidden name=schdpgid id=schdpgid value="IBAOUT71">    
<input type=hidden name=schddesc id=schddesc value="Outpatient Letter Print">   
<input type=hidden name=schdtype id=schdtype value="">
<input type=hidden name=nextpage id=nextpage value="1">
<input type=hidden name=redirect id=redirect
       value="rshweb02.pbl?reportno=1&template=1">
<input type=hidden name=ptcnsmsn id=ptcnsmsn
       value="%STANDARD.01.025.120.243.0.1">
<input type=hidden name=smsprntr id=smsprntr
       value="%STANDARD.01.025.124.105.0.6">
<input type=hidden name=ibcnmhos id=ibcnmhos
       value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=ptcnsmso id=ptcnsmso 
       value="%STANDARD.01.025.128.106.0.1">

<table width=100% align=center border=0 cellspacing=0>
<tr><td class=HeadingCell align=center colspan=2>
  Outpatient Letters</td>
</tr>
</table>
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Schedule Date</td>
    <td class=DataLabel>
    <input type=text name=schddate id=schddate size=12 title="Schedule Date"
      value="%STANDARD.01.015"
      onblur="checkDate(this,'Schedule Date');">
    <img src=../images/DateLookup.gif 
     onclick="DateLookupFrame(ReportForm.schddate);">
    Time
    <input type=text name=schdtime id=schdtime size=12 title="Schedule Time"
    value="%STANDARD.01.016">
    <img src=../images/DateTimeStamp.gif  alt="Schedule Time"
     onclick="SetCurrentDateTime(ReportForm.schddate,ReportForm.schdtime);">
    <img src=../images/TimeLookup.gif 
     onclick="TimeLookupFrame(ReportForm.schdtime);">
    </td></tr>

<tr><td class=DataLabel>Printer</td>
    <td><div id=OptPrinter></div></td>
    </tr>
<input type=hidden name=schdprnt id=schdprnt value="">
 
<tr><td class=DataLabel>Number of Copies</td>
    <td><select name=schdcopy id=schdcopy title="Number of Copies"
          class=Mandatory>
        </select>
    </td></tr>
 
<tr><td class=DataLabel>Re-schedule Type</td> 
    <td class=DataLabel colspan=3> 
    <select name=schdrdat id=schdrdat title="Schedule Type" 
      onchange="SetReportDates();ShowDateTitle();"> 
    <option></option> 
    </select> 
    </td></tr> 
 
<tr><td class=DataLabel>Re-schedule Until Date</td> 
    <td class=DataLabel colspan=3> 
    <input type=text name=schdrend id=schdrend size=12 
     onblur="checkDate(this,'Re-schedule Until Date');"> 
    <img src=../images/DateTimeStamp.gif 
     onclick="SetCurrentDateTime(ReportForm.schdrend,null);"> 
    <img src=../images/DateLookup.gif 
     onclick="DateLookupFrame(ReportForm.schdrend);">
    </td></tr>
 
<tr><td colspan=2 align=center><hr width=80%></td></tr>
<tr><td class=DataLabel>Letter Printing</td>
    <td><select name=keystr01 id=keystr01
          onchange="LetterType();CallReportSchedule();">
        <option value="6">Clinic Master Booking Letter</option>
        <option value="1">General Letter</option>
        </select>
    </td></tr>
    <input type=hidden name=keystr02 id=keystr02 value="">
    <input type=hidden name=keystr03 id=keystr03 value="">

</table>

<span id=DateRange></span>
<span id=LetterOption></span>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td align=center colspan=2><br>
    <input type=button value=Ok class="button" onclick="ProcessReport();">
    <input type=button value=Cancel class="button" 
     onclick='location.href="../lookups/blank.html"' >
    </td></tr>
</table>
</form>

<span id=smsPrinter style="display:none">
  <input type=text name=d_schdprntdesc id=d_schdprntdesc title="Printer"
    readonly class="Readonly"
         value="%RSHWEB02.01.199.002">
</span>

<span id=normalPrinter style="display:none">
  <select name=d_schdprnt id=d_schdprnt title="Printer" class=Mandatory>
    <option></option>
      %STANDARD.01.001.IBAOUT71.01
  </select>
</span>

<span id=GeneralLetter style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Booking Type</td>
    <td><input type=hidden name=keystr04 id=keystr04 value="2">
        <select name=keystr05 id=keystr05 title="Booking Type">
        <option value=" ">ALL</option>
        <option value="B">Booked</option>
        <option value="A">Attendees</option>
        <option value="N">Non-Attendees</option>
        <option value="R">Rescheduled</option>
        <option value="C">Cancelled Bookings</option>
        </select></td></tr>

<tr><td class=DataLabel width=25%>Outpatient Site</td>
    <td><input type=hidden name=keystr06 id=keystr06 value="3">
        <select name=keystr07 id=keystr07 title="Outpatient Site From">
        <option value=" ">Start</option>
        %RSHWEB02.01.109
        </select> To
        <select name=keystr08 id=keystr08 title="Outpatient Site To">
        <option value=" ">Finish</option>
        %RSHWEB02.01.109
        </select>
        </td></tr>

<tr><td class=DataLabel width=25%>Clinic</td>
    <td><input type=hidden name=keystr09 id=keystr09 value="4">
        <select name=keystr10 id=keystr10 title="Clinic From">
        <option value=" ">Start</option>
        </select> To
        <select name=keystr11 id=keystr11 title="Clinic To">
        <option value=" ">Finish</option>
        </select>
        <input type=checkbox name=inactivecode id=inactivecode
         title="Include Inactive Codes" onclick="setClinicIdList()">
        Show Inactive Codes
        </td></tr>

<tr><td class=DataLabel width=25%>Session Start Time</td>
  <td><input type=hidden name=keystr12 id=keystr12 value="5">
      <input type=text name=keystr13 id=keystr13 size=7 
       onblur="checkTimeMin(this,this.title);"
       title="Session Start Time From">
      <img src=../images/TimeLookup.gif 
       onclick="TimeLookupFrameMin(ReportForm.keystr13);">
      To
      <input type=text name=keystr14 id=keystr14 size=7
       onblur="checkTimeMin(this,this.title);"
      title="Session Start Time To">         
      <img src=../images/TimeLookup.gif
       onclick="TimeLookupFrameMin(ReportForm.keystr14);">
      </td></tr>

<tr><td class=DataLabel width=25%>U/R Range</td>
    <td><input type=hidden name=admissno id=admissno>
        <input type=hidden name=keystr15 id=keystr15 value="6">
        <input name=keystr16 id=keystr16 type=text size=10 maxlength=8 
         title="U/R Number From"
         onblur="justifyRight(this);
                 validateCode(8,ReportForm.keystr16,ReportForm.n_keystr16);">
        <input type=text name=n_keystr16 id=n_keystr16 readonly size=25
          title="Patient Name"
         notab class="ReadOnly">
        <img src="../images/SearchIcon.gif" class="Icon" alt="Search"
        onclick="PatientSearchFrame(ReportForm.n_keystr16,
                                    ReportForm.keystr16,
                                    ReportForm.admissno);">
        <img src="../images/ClearIcon.gif" class=Icon
         onClick="clrFields(ReportForm.keystr16,ReportForm.n_keystr16);">
        To
        <input name=keystr17 id=keystr17 type=text size=10 maxlength=8 
         title="U/R Number To"
         onblur="justifyRight(this);
                 validateCode(8,ReportForm.keystr17,ReportForm.n_keystr17);">
        <input type=text name=n_keystr17 id=n_keystr17 readonly size=25
          title="Patient Name" 
         notab class="ReadOnly">
        <img src="../images/SearchIcon.gif" class="Icon" alt="Search"
         onclick="PatientSearchFrame(ReportForm.n_keystr17,
                                     ReportForm.keystr17,
                                     ReportForm.admissno);">
        <img src="../images/ClearIcon.gif" class=Icon
         onClick="clrFields(ReportForm.keystr17,ReportForm.n_keystr17);">
        </td></tr>

<tr><td class=DataLabel>Include Deceased Patients</td>
    <td><input type=hidden name=keystr18 id=keystr18 value="7">
        <select name=keystr19 id=keystr19 title="Include Deceased Patients">
        <option value="N">No</option>
        <option value="Y">Yes</option>
        </select>
    </td></tr>

<tr><td class=DataLabel width=25%>Visit Type</td>
    <td><input type=hidden name=keystr20 id=keystr20 value="8">
        <select name=keystr21 id=keystr21 title="Visit Type From">
        <option value=" ">Start</option>
          %STANDARD.01.007.CV
        </select> To
        <select name=keystr22 id=keystr22 title="Visit Type To">
        <option value=" ">Finish</option>
          %STANDARD.01.007.CV
        </select>
        </td></tr>

<tr><td class=DataLabel width=25%>Date Booking Made</td>
<td><input type=hidden name=keystr23 id=keystr23 value="9">
    <input type=text size=15 maxlength=12 name=keystr24 id=keystr24 
    onblur="checkDate(this,'Date Booking Made From')"
    class="PastDate" title="Date Booking Made From">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.keystr24">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.keystr24">
    To
    <input type=text size=15 maxlength=12 name=keystr25 id=keystr25 
    onblur="checkDate(this,'Date Booking Made To')" class="PastDate" 
    title="Date Booking's Made To">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.keystr25">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.keystr25">
    </td></tr>

<tr><td class=DataLabel width=25%>Clinic Type</td>
    <td><input type=hidden name=keystr26 id=keystr26 value="10">
        <select name=keystr27 id=keystr27 title="Clinic Type From">
        <option value=" ">Start</option>
        %RSHWEB02.01.124
        </select> To
        <select name=keystr28 id=keystr28 title="Clinic Type To">
        <option value=" ">Finish</option>
        %RSHWEB02.01.124
        </select>
        </td></tr>

<tr><td class=DataLabel width=25%>Outcome</td>
    <td><input type=hidden name=keystr29 id=keystr29 value="11">
        <select name=keystr30 id=keystr30 title="Outcome From">
        <option value=" ">Start</option>
          %STANDARD.01.007.OZ
        </select> To
        <select name=keystr31 id=keystr31 title="Outcome To">
        <option value=" ">Finish</option>
          %STANDARD.01.007.OZ
        </select>
        </td></tr>

<tr><td class=DataLabel width=25%>Generate Letter Date</td>
<td><input type=hidden name=keystr32 id=keystr32 value="12">
    <input type=text size=15 maxlength=12 name=keystr33 id=keystr33
    onblur="checkDate(this,'Generate Letter Date From')"
    class="Date" title="Generate Letter Date From">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.keystr33">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.keystr33">
    To
    <input type=text size=15 maxlength=12 name=keystr34 id=keystr34
    onblur="checkDate(this,'Generate Letter Date To')" class="Date"
    title="Generate letter Date To">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.keystr34">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.keystr34">
    </td></tr>

    <input type=hidden name=keystr35 id=keystr35 value="P" >

<tr><td class=DataLabel width=25%>Letter to Print</td>
    <td><select name=keystr36 id=keystr36 title="Letter to Print">
           %RSHWEB02.01.128
        </select></td></tr>

     <input type=hidden name=keystr37 id=keystr37 value="%STANDARD.01.008">

<tr id=ShowHospital>
  <td class=DataLabel width=25%>Hospital</td>
  <td><select name=filthosp id=filthosp class="SelectBig" title="Hospital">
     <option value="">All</option>
       %RSHWEB02.01.122
     </select></td>
</tr>
     <input type=hidden name=keystr38 id=keystr38 value="" >
     <input type=hidden name=keystr39 id=keystr39 value="" >
     <input type=hidden name=keystr40 id=keystr40 value="" >
</table>
</span>

<span id=ClinicLetter style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Outpatient Site</td>
    <td><input type=hidden name=keystr04 id=keystr04 value="2" >
        <input type=hidden name=keystr05 id=keystr05 value="B" >
        <input type=hidden name=keystr06 id=keystr06 value="3">
        <select name=keystr07 id=keystr07 title="Outpatient Site From">
        <option value=" ">Start</option>
        %RSHWEB02.01.109
        </select> To
        <select name=keystr08 id=keystr08 title="Outpatient Site To">
        <option value=" ">Finish</option>
        %RSHWEB02.01.109
        </select>
        </td></tr>

<tr><td class=DataLabel width=25%>Clinic</td>
    <td><input type=hidden name=keystr09 id=keystr09 value="4">
        <select name=keystr10 id=keystr10 title="Clinic From">
        <option value=" ">Start</option>
        </select> To
        <select name=keystr11 id=keystr11 title="Clinic To">
        <option value=" ">Finish</option>
        </select>
        <input type=checkbox name=inactivecode id=inactivecode
         title="Include Inactive Codes" onclick="setClinicIdList()">
        Show Inactive Codes
        </td></tr>

<tr><td class=DataLabel width=25%>Session Start Time</td>
  <td><input type=hidden name=keystr12 id=keystr12 value="5">
      <input type=text name=keystr13 id=keystr13 size=7
       onblur="checkTimeMin(this,this.title);"
       title="Session Start Time From">
      <img src=../images/TimeLookup.gif
       onclick="TimeLookupFrameMin(ReportForm.keystr13);">
      To
      <input type=text name=keystr14 id=keystr14 size=7
       onblur="checkTimeMin(this,this.title);"
      title="Session Start Time To">
      <img src=../images/TimeLookup.gif
       onclick="TimeLookupFrameMin(ReportForm.keystr14);">
      </td></tr>

<tr><td class=DataLabel>Include Deceased Patients</td>
    <td><input type=hidden name=keystr15 id=keystr15 value="">
        <input type=hidden name=keystr16 id=keystr16 value="">
        <input type=hidden name=keystr17 id=keystr17 value="">
        <input type=hidden name=keystr18 id=keystr18 value="7">
        <select name=keystr19 id=keystr19 title="Include Deceased Patients">
        <option value="N">No</option>
        <option value="Y">Yes</option>
        </select>
    </td></tr>

<tr><td class=DataLabel width=25%>Visit Type</td>
    <td><input type=hidden name=keystr20 id=keystr20 value="8">
        <select name=keystr21 id=keystr21 title="Visit Type From">
        <option value=" ">Start</option>
          %STANDARD.01.007.CV
        </select> To
        <select name=keystr22 id=keystr22 title="Visit Type To">
        <option value=" ">Finish</option>
          %STANDARD.01.007.CV
        </select>
        </td></tr>

<tr><td class=DataLabel width=25%>Clinic Type</td>
    <td><input type=hidden name=keystr23 id=keystr23 value="">
        <input type=hidden name=keystr24 id=keystr24 value="">
        <input type=hidden name=keystr25 id=keystr25 value="">
        <input type=hidden name=keystr26 id=keystr26 value="10">
        <select name=keystr27 id=keystr27 title="Clinic Type From">
        <option value=" ">Start</option>
        %RSHWEB02.01.124
        </select> To
        <select name=keystr28 id=keystr28 title="Clinic Type To">
        <option value=" ">Finish</option>
        %RSHWEB02.01.124
        </select>
        </td></tr>

    <input type=hidden name=keystr29 id=keystr29 value="">
    <input type=hidden name=keystr30 id=keystr30 value="">
    <input type=hidden name=keystr31 id=keystr31 value="">
    <input type=hidden name=keystr32 id=keystr32 value="12">
    <input type=hidden name=keystr33 id=keystr33 value="">
    <input type=hidden name=keystr34 id=keystr34 value="">
    <input type=hidden name=keystr35 id=keystr35 value="P" >
    <input type=hidden name=keystr36 id=keystr36 value="%STANDARD.01.008">

<tr id=ShowHospital>
  <td class=DataLabel width=25%>Hospital</td>
  <td><select name=filthosp id=filthosp class="SelectBig" title="Hospital">
     <option value="">All</option>
       %RSHWEB02.01.122
     </select></td>
</tr>
    <input type=hidden name=keystr38 id=keystr38 value="" >
    <input type=hidden name=keystr39 id=keystr39 value="" >
    <input type=hidden name=keystr40 id=keystr40 value="" >
</table>
</span>

<span id=ClinicSMS style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Outpatient Site</td>
    <td><input type=hidden name=keystr04 id=keystr04 value="2" >
        <input type=hidden name=keystr05 id=keystr05 value="B" >
        <input type=hidden name=keystr06 id=keystr06 value="3">
        <select name=keystr07 id=keystr07 title="Outpatient Site From">
        <option value=" ">Start</option>
        %RSHWEB02.01.109
        </select> To
        <select name=keystr08 id=keystr08 title="Outpatient Site To">
        <option value=" ">Finish</option>
        %RSHWEB02.01.109
        </select>
        </td></tr>

<tr><td class=DataLabel width=25%>Clinic</td>
    <td><input type=hidden name=keystr09 id=keystr09 value="4">
        <select name=keystr10 id=keystr10 title="Clinic From">
        <option value=" ">Start</option>
        </select> To
        <select name=keystr11 id=keystr11 title="Clinic To">
        <option value=" ">Finish</option>
        </select>
        <input type=checkbox name=inactivecode id=inactivecode
         title="Include Inactive Codes" onclick="setClinicIdList()">
        Show Inactive Codes
        </td></tr>

<tr><td class=DataLabel width=25%>Session Start Time</td>
  <td><input type=hidden name=keystr12 id=keystr12 value="5">
      <input type=text name=keystr13 id=keystr13 size=7
       onblur="checkTimeMin(this,this.title);"
       title="Session Start Time From">
      <img src=../images/TimeLookup.gif 
       onclick="TimeLookupFrameMin(ReportForm.keystr13);">
      To
      <input type=text name=keystr14 id=keystr14 size=7
       onblur="checkTimeMin(this,this.title);"
      title="Session Start Time To">
      <img src=../images/TimeLookup.gif
       onclick="TimeLookupFrameMin(ReportForm.keystr14);">
      </td></tr>

<tr><td class=DataLabel>Include Deceased Patients</td>
    <td><input type=hidden name=keystr15 id=keystr15 value="">
        <input type=hidden name=keystr16 id=keystr16 value="">
        <input type=hidden name=keystr17 id=keystr17 value="">
        <input type=hidden name=keystr18 id=keystr18 value="7">
        <select name=keystr19 id=keystr19 title="Include Deceased Patients">
        <option value="N">No</option>
        <option value="Y">Yes</option>
        </select>
    </td></tr>

<tr><td class=DataLabel width=25%>Visit Type</td>
    <td style="vertical-align:top">
        <input type=hidden name=keystr20 id=keystr20 value="8">

        <select class="SelectMultipleLong" name=multipl1 id=multipl1
         title="Visit Type"
         size=5 multiple="multiple" onclick="ValidateSelect(this);">
          <option value="  ">All</option>
          %STANDARD.01.007.CV
        </select>&nbsp;Press CTRL or SHIFT to select multiple Visit Types
    </td></tr>

<tr><td class=DataLabel width=25%>Clinic Type</td>
    <td style="vertical-align:top">
        <input type=hidden name=keystr23 id=keystr23 value="">
        <input type=hidden name=keystr24 id=keystr24 value="">
        <input type=hidden name=keystr25 id=keystr25 value="">
        <input type=hidden name=keystr26 id=keystr26 value="10">

        <select class="SelectMultipleLong" name=multiple id=multiple
         title="Clinic Type"
         size=5 multiple="multiple" onclick="ValidateSelect(this);">
          <option value="  ">All</option>
          %RSHWEB02.01.124
        </select>&nbsp;Press CTRL or SHIFT to select multiple Clinic Types
    </td></tr>

    <input type=hidden name=keystr29 id=keystr29 value="">
    <input type=hidden name=keystr30 id=keystr30 value="">
    <input type=hidden name=keystr31 id=keystr31 value="">
    <input type=hidden name=keystr32 id=keystr32 value="12">
    <input type=hidden name=keystr33 id=keystr33 value="">
    <input type=hidden name=keystr34 id=keystr34 value="">
    <input type=hidden name=keystr35 id=keystr35 value="P" >

<tr><td class=DataLabel width=25%>SMS Message to Send</td>
    <td><select name=keystr36 id=keystr36 title="SMS Message to Send"
          class=Mandatory>
        <option value=" "> </option>
        %RSHWEB02.01.195
        </select></td>
    </tr>

    <input type=hidden name=keystr37 id=keystr37 value="%STANDARD.01.008">

<tr id=ShowHospital>
  <td class=DataLabel width=25%>Hospital</td>
  <td><select name=filthosp id=filthosp class="SelectBig" title="Hospital">
     <option value="">All</option>
       %RSHWEB02.01.122
     </select></td>
</tr>

    <input type=hidden name=keystr38 id=keystr38 value="" >
    <input type=hidden name=keystr39 id=keystr39 value="" >
    <input type=hidden name=keystr40 id=keystr40 value="" >
    <input type=hidden name=keystr41 id=keystr41 value="" >
    <input type=hidden name=keystr42 id=keystr42 value="" >
</table>
</span>

<div id=SetDateRange style="display:none;">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25% id=datetitle >Booking Date</td>
    <td><input type=text size=15 maxlength=12 name=datran01 id=datran01
    onblur="checkDate(this,'Date')"
    class="Mandatory Date" title="From Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.datran01">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.datran01">
    To
    <input type=text size=15 maxlength=12 name=datran02 id=datran02
    onblur="checkDate(this,'Date')" class="Mandatory Date" title="To Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.datran02">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.datran02">
    </td></tr>
</table>
</div>

<div id=SetScheduleRange style="display:none;">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25% id=datetitle>Booking Date</td>
    <td><select name=datsch01 id=datsch01 title="Schedule Range" 
          class=Mandatory
    onblur="CallReportSchedule();">
    <option></option></select>
    Sample Range
    <input type=text name=SampleFrom id=SampleFrom size=12> To
    <input type=text name=SampleTo id=SampleTo size=12>
    </td></tr>
</table>
</div>

<div id=HiddenClinics style="display:none;">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td>
    <select name="allclinics" title="All Clinics" id="allclinics">
        %RSHWEB02.01.110
        </select>
    </td></tr>
</table>
</div>

<div id=HiddenClinicsActive style="display:none;">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td>
    <select name="allactiveclinics" title="All Clinics" id="allactiveclinics">
        %RSHWEB02.01.199.004
        </select>
    </td></tr>
</table>
</div>

<script type="text/javascript">
function setClinicIdList() {
  var checkForinactivecode=document.getElementById("inactivecode");
  if (checkForinactivecode.checked == true){
  clinics = document.getElementById("allclinics"); // List of all Clinics
  }
  else{
  clinics = document.getElementById("allactiveclinics"); // List of all Active Clinics
  }

  clinic_t = document.ReportForm.keystr10;
  clinic_f = document.ReportForm.keystr11;
   
  clinic_t.length=1;
  clinic_f.length=1;

  for (var i =0 ; i < clinics.length; i++) {

    clinic_f[clinic_f.options.length]=
    new Option(clinics.options[i].text,clinics.options[i].value);

    clinic_t[clinic_t.options.length]=
    new Option(clinics.options[i].text,clinics.options[i].value);
  }
}

</script>
