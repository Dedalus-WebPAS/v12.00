Content-Type: text/html
Cache-Control: no-cache

%START.OF.PAGE
<!DOCTYPE html>
<html>
<head>
<title>Portal Codes Table Maintenance</title>
<meta name="ServerID"       content="%STANDARD.01.004">
<meta name="ServerName"     content="%STANDARD.01.005">
<meta name="ServerVersion"  content="%STANDARD.01.006">
<meta name="ServerOption"   content="%STANDARD.01.002">
<meta name="ServerTemplate" content="%STANDARD.01.003">
<meta name="TemplateFile"   content="websec0106107.html">
<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome"    content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript" src="../js/Standard.js"></script>
<script type="text/javascript" src="../js/Custom.js"></script>
<script type="text/javascript" src="../js/json2.js"></script>
<link rel="stylesheet" href="../html/standard.css" type="text/css">
<link rel="stylesheet" href="../html/custom.css" type="text/css">
<style type=text/css>
.MaintenanceIcon {
  display:inline-block;
  vertical-align:middle;
  margin-bottom:2px;
  background: url("../images/AlertSprite.png")  -140px -60px no-repeat;
  width:20px;
  height:20px;
}
.FreeTextEditor {
  width:800px;
  height:600px;
  background-color:white;
  border:3px outset silver;
}
.FreeTextEditorHeading {
 font-weight:bold;
 background-color: #99CCFF;
 padding-top:3px;
 padding-bottom:3px;
 text-align:center;
}
.FreeTextEditorFooter {
 text-align:center;
 padding:10px;
}
.Label {
  font-weight:bold;
}
</style>
<script type=text/javascript>
var TablesArray;
var TableSelected="";
var CodeArray;
var CodeSelected="";
function SaveTable() {
  var url="PortalConfiguration.php" 
  var el;
  var qry="reportno=7"
  el=document.getElementById('db_server');
  qry=qry+"&db_server="+encodeURIComponent(el.value);
  el=document.getElementById('db_username');
  qry=qry+"&db_username="+encodeURIComponent(el.value);
  el=document.getElementById('db_password');
  qry=qry+"&db_password="+encodeURIComponent(el.value);
  el=document.getElementById('site_domain');
  qry=qry+"&site_domain="+encodeURIComponent(el.value);
  el=document.getElementById('site_url');
  qry=qry+"&site_url="+encodeURIComponent(el.value);
  el=document.getElementById('site_email');
  qry=qry+"&site_email="+encodeURIComponent(el.value);
  el=document.getElementById('site_logo');
  qry=qry+"&site_logo="+encodeURIComponent(el.value);
  el=document.getElementById('site_name');
  qry=qry+"&site_name="+encodeURIComponent(el.value);
  el=document.getElementById('site_timeout');
  qry=qry+"&site_timeout="+encodeURIComponent(el.value);

  var xmlHttp = createHttpObject();
  xmlHttp.open("POST",url,false);
  xmlHttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
  xmlHttp.send(qry);
  if (xmlHttp.status == 200) {
    if (xmlHttp.responseText=="COMPLETE") {
      alert("Update Complete");
      location.reload();
      return;
    } 
  } else {
    alert("ERROR : A problem occurred saving the records Try Again.");
    return;
  }
}
function init() {
  var theURL   = "PortalConfiguration.php?reportno=7&option=1" 
  var xmlHttp=new XMLHttpRequest(); // Firefox, Opera 8.0+, Safari
  xmlHttp.open("GET", theURL, false);
  xmlHttp.send();
  if (xmlHttp.status == 200) {
    TablesArray = JSON.parse(xmlHttp.responseText);
    var OS="<table width=100% cellpadding=4 border=1 style='border:1px #ccc solid'>"+
           "<tr class=FreeTextEditorHeading>"+
           "<td>Table</td>"+
           "<td style='text-align:center;'>Active</td></tr>";
    for (var i=0;i<TablesArray.length;i++) {
      OS+="<tr onclick='EditTable(\""+i+"\");'>"+
          "<td><span class=MaintenanceIcon></span>"+
                    TablesArray[i].description+"</td>"+
             "<td style='text-align:center;'>"+TablesArray[i].active+"</td></tr>";
    }
    OS+="</table>";
    var el=document.getElementById("TableLocation");
    el.innerHTML=OS;
  }
  el=document.getElementById("btnNewTable");
  el.style.display='';
  el=document.getElementById("btnNewCode");
  el.style.display='none';
  el=document.getElementById("PageTitle");
  el.innerHTML="Portal Table Maintenance";
}
function EditTable(TableIndex) {
  TableSelected=TableIndex;
  var theURL="websec01.pbl?reportno=6&template=110";
  var t=100;
  var h=130;
  var w=480;
  var l = (getClientWidth() - w)/2;
  DFrameLink(theURL,t,l,w,h) 
}
function EditCode(CodeIndex) {
  CodeSelected=CodeIndex;
  var theURL="websec01.pbl?reportno=6&template=111";
  var t=100;
  var h=480;
  var w=640;
  var l = (getClientWidth() - w)/2;
  DFrameLink(theURL,t,l,w,h) 
}
function ShowCodes(TableID) {
  var theURL   = "PortalConfiguration.php?reportno=7&option=2&TableID="+TableID
  var xmlHttp=new XMLHttpRequest(); // Firefox, Opera 8.0+, Safari
  xmlHttp.open("GET", theURL, false);
  xmlHttp.send();
  if (xmlHttp.status == 200) {
    CodeArray = JSON.parse(xmlHttp.responseText);
    var OS="<table width=100% cellpadding=4 border=1 style='border:1px #ccc solid'>"+
           "<tr class=FreeTextEditorHeading>"+
           "<td>Code </td>"+
           "<td>Description</td>"+
           "<td>Short Description</td>"+
           "<td>Indicators</td>"+
           "<td style='text-align:center;'>Sequence</td>"+
           "<td style='text-align:center;'>Active</td></tr>";
    for (var i=0;i<CodeArray.length;i++) {
      OS+="<tr onclick='EditCode(\""+i+"\");'>"+
          "<td><span class=MaintenanceIcon></span>"+
                 CodeArray[i].code+"</td>"+
          "<td>"+CodeArray[i].description+"</td>"+
          "<td>"+CodeArray[i].shortDescription+"</td>"+
          "<td>"+CodeArray[i].indicators+"</td>"+
          "<td style='text-align:center;'>"+CodeArray[i].sequence+"</td>"+
          "<td style='text-align:center;'>"+CodeArray[i].active+"</td></tr>";
    }
    OS+="</table>"; 
    var el=document.getElementById("TableLocation");
    el.innerHTML=OS;
    el=document.getElementById("btnNewTable");
    el.style.display='none';
    el=document.getElementById("btnNewCode");
    el.style.display='';
    el=document.getElementById("PageTitle");
    el.innerHTML="Portal Codes Maintenance";
  }
}
function NewTable() {
  TableSelected=-1;
  var theURL="websec01.pbl?reportno=6&template=110";
  var t=100;
  var h=130;
  var w=480;
  var l = (getClientWidth() - w)/2;
  DFrameLink(theURL,t,l,w,h);
}
function NewCode() {
  CodeSelected=-1;
  var theURL="websec01.pbl?reportno=6&template=111";
  var t=100;
  var h=480;
  var w=640;
  var l = (getClientWidth() - w)/2;
  DFrameLink(theURL,t,l,w,h);
}
</script>
</head>
<body onload="PageLoad(event);">
<form name=PageEdit action=PortalConfiguration.php method=POST>
<input type=hidden name=reportno value=5>
<table width=100% >
<tr valign=top><td>
  <table width=100% cellpadding=4 border=1 style='border:1px #ccc solid'>
  <tr>
  <td width=25%></td>
  <td style='text-align:center;font-weight:bold;font-size:14px'>
  <span id=PageTitle>Portal Codes Table Maintenance</span></td>
  <td width=25% style='text-align:right;'>
  <input id=btnNewTable type=button class=button value="New Table" onclick='NewTable();'>
  <input id=btnNewCode type=button class=button value="New Code" onclick='NewCode();'>
  </td></tr>
  </table>
</td></tr>
<tr valign=top><td>
<div id=TableLocation></div>
</td></tr>
</td></tr>
<table>
</form>
<div name="PopUpScreen" id="PopUpScreen" style="display: none;">
<iframe scrolling="no" width="100%" height="100%" name="PopUpFrame" id="PopUpFrame"></iframe>
<iframe scrolling="no" style="display: none;" name="PopUpFrame1" id="PopUpFrame1"></iframe>
</div>
</body>
</html>
