<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientClinicId.js"></script>
<script language="javascript" src="../js/allweb02.js"></script>
<script language="javascript">
function UpdateReferral(theForm) {
  if (validateMandatory(theForm)) {
    enablePostField();
    theForm.submit(); }
}
function SetList(){
  p = UpdateForm;
  if(p.alcndevp.value=="1"){
     document.getElementById("EventProgramLabel").innerHTML=
     document.getElementById("ShowEventProgramLabel").innerHTML;
     document.getElementById("EventProgramField").innerHTML=
     document.getElementById("ShowEventProgramField").innerHTML;
  }
  var SetSite;
  if(isWhitespace(p.alref119.value)){
     SetSite = p.wbsesite.value;
  }
  else{
    SetSite = p.alref119.value;
  }

  for(var i =0 ; i < document.UpdateForm.alref119.length; i++){
      if(document.UpdateForm.alref119.options[i].value==SetSite.substr(0,6)){
         document.UpdateForm.alref119.selectedIndex = i;
      }
  }

  if(p.alref120.type=="select-one") {
    p.alref120.options.length=1;
    SetClinicId(p.alref120,p.deftclid.value,p.alref119.value);

    for (var i =0 ; i < document.UpdateForm.alref120.length; i++) {
      if (document.UpdateForm.alref120.options[i].value==
          document.UpdateForm.d_alref120.value) {
        document.UpdateForm.alref120.selectedIndex=i
      }
    };

  }
  
  p.alref106.options.length=1;
  SetClinicType(p.alref106,p.defctype.value,p.alref119.value);
  if(p.alref120.type=="select-one") {
    p.alref120.options.length=1;
    SetClinicId(p.alref120,p.deftclid.value,p.alref119.value);
  }
}
function displayClinicId() {
  if (document.UpdateForm.deptlcod.value.substr(34,1)  == "2") {
    clinicidtitlespan.style.display="";
    clinicidfieldspan.style.display="";
    return;
  }
  if (document.UpdateForm.deptlcod.value.substr(34,1)  == "1") {
    clinicidtitlespan.style.display="";
    clinicidfieldspan.style.display="";
    document.UpdateForm.alref120.className="Mandatory";
    return;
  }
}
function displayReason() {
  if (document.UpdateForm.deptlcod.value.substr(30,1)  == "2" ||
      document.UpdateForm.deptlcod.value.substr(30,1)  == "3") {
    reasontitlespan.style.display="";
    reasonfieldspan.style.display="";
    document.UpdateForm.alref028.className="SelectBig";
    return;
  }

  if (document.UpdateForm.deptlcod.value.substr(30,1)  == "1") {
    reasontitlespan.style.display="";
    reasonfieldspan.style.display="";
    document.UpdateForm.alref028.className="SelectBig Mandatory";
    return;
  }

  reasontitlespan.style.display="none";
  reasonfieldspan.style.display="none";
  document.UpdateForm.alref028.className="SelectBig";
  return;

}
function displaySourceOfReferral() {
  if (document.UpdateForm.deptlcod.value.substr(35,1)  == "2") {
    sourceofreferraltitlespan.style.display="";
    sourceofreferralfieldspan.style.display="";
    return;
  }
  if (document.UpdateForm.deptlcod.value.substr(35,1)  == "1") {
    sourceofreferraltitlespan.style.display="";
    sourceofreferralfieldspan.style.display="";
    document.UpdateForm.alref034.className="SelectBig Mandatory";
    return;
  }
  sourceofreferraltitlespan.style.display="none";
  sourceofreferralfieldspan.style.display="none";
  document.UpdateForm.alref034.className="SelectBig";
  return;

}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);SetList();displayClinicId();displayReason();
              displaySourceOfReferral();ValidatePriority();
              CommonEpisodeRef();">
<span class=DFrameTitleBar>
<img border=0 align=right src="../images/ExitIcon.gif" onclick="DFrameExit();">
 %ALLWEB02.02.125.0  Referral  </span>
<div id=PageBodySection style="overflow: auto;">
<form id=UpdateForm name=UpdateForm onsubmit='return validateMandatory(this)' 
            action="allweb02.pbl" method=post>
<input type=hidden name=reportno value="2">
<input type=hidden name=updatety value="U">
<input type=hidden id=urnumber name=urnumber value="%ALLWEB02.02.003">
<input type=hidden id=admissno name=admissno value="%ALLWEB02.02.081">
<input type=hidden id=deptcode name=deptcode value="%ALLWEB02.02.125.1">
<input type=hidden name=redirect value="allweb02.pbl?reportno=2&template=3">
<input type=hidden id=dummy name=dummy>
<input type=hidden name=alref083 value="">
<input type=hidden name=wbsesite value="%STANDARD.01.023">
<input type=hidden name=defctype value="%ALLWEB02.02.167.1">
<input type=hidden name=deptIndi value="%ALLWEB02.02.125.3">
<input type=hidden name=refrflag  value="1">
<input type=hidden name=deftclid value="">
<input type=hidden name=d_alref120 value="%ALLWEB02.02.188.1">
<input type=hidden name=deptlcod id=deptlcod value="%ALLWEB02.02.125.3">
<input type=hidden name=alcndevp value="%STANDARD.01.025.106.225.0.1">
<input type="hidden" name="d_aldeutrs" id="d_aldeutrs"
 value="%ALLWEB02.02.262.3">
<input type="hidden" name="d_alrestat" id="d_alrestat"
 value="%ALLWEB02.02.199.027">
<input type="hidden" name="d_aldeuprt" id="d_aldeuprt"
 value="%ALLWEB02.02.262.4">

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td class=DataLabel width=15%>Department Code</td>
    <td><input type=text value="%ALLWEB02.02.125.0"
          readonly class=Readonly></td>
    <td class=DataLabel>Entered by</td>
    <td><input type=text name=alref000 
         value="%ALLWEB02.02.163" readonly class=Readonly></td>
    </tr>

   <tr><td class=DataLabel><div id="tsHeading"></div></td>
       <td><div id="tsField"></div></td>
       <td class=DataLabel><div id="tdHeading"></div></td>
       <td><div id="tdField"></div></td>
       </tr>

   <tr><td class=DataLabel><div id="prHeading"></div></td>
       <td><div id="prField"></div></td>
    <td class=DataLabel>Referral Date</td>
    <td><input type=text name=d_alref019 id=alref019 value="%ALLWEB02.02.119" 
         title="Referral Date" readonly class=Readonly size=12></td>
    </tr>

<tr><td class=DataLabel>
    <span id="sourceofreferraltitlespan" style="display:none">
    Referral Source
    </span>
    </td>
    <td>
    <span id="sourceofreferralfieldspan" style="display:none">
      <select Title="Referral Source" name=alref034 
         class="selectBig">
        <option></option>
        %ALLWEB02.02.134.2
      </select>
    </span>
    </td>
    <td class=DataLabel>Referred By</td>
    <td><input type=hidden id=alref022 name=alref022 
         value="%ALLWEB02.02.122.1">
        <input type=text id=n_alref022 name=n_alref022 readonly title="HCP Name"
         value="%ALLWEB02.02.122.0">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(UpdateForm.alref022,UpdateForm.n_alref022,0);">
        <img src="../images/ClearIcon.gif" class=Icon
        onclick="clrFields(alref022,n_alref022);">
        </td></tr>

<tr><td class=DataLabel>Responsible HCP</td>
    <td><input type=text id=alref038 name=alref038 size=10 maxlength=10
         value="%ALLWEB02.02.138.1"
         onblur="ValidateHCP(18,0,alref038,n_alref038);" >
        <input type=text name=n_alref038 size=30 readonly title="HCP Name"
         id=n_alref038 value="%ALLWEB02.02.138.0" class=Readonly>
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(UpdateForm.alref038,UpdateForm.n_alref038,0);">
        </td>
    <td class=DataLabel>Link to Visit</td>
    <td><input type=text size=10 maxlength=8 class=DataField 
         Title="Link to Visit" name=alref005 value="%ALLWEB02.02.105"
          id=alref005 onblur="justifyRight(this);
                ValidateVisit(UpdateForm.alref005,UpdateForm.urnumber,dummy);">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="VisitSearchFrame(UpdateForm.urnumber,UpdateForm.alref005);" >
    </td></tr>

<tr><td></td>
    <td><input type="button" class="Extralargebutton" id="btnMainHealth"
         value="Episode Health Conditions" onclick="openHealthConditionV();" />
    </td>
    <td class=DataLabel>Advanced Care Plan Documented</td>
    <td class=DataField>
    <input type=text id=alref164 name=alref164 size=12
     onblur="checkDate(this,'Date')" value="%ALLWEB02.02.199.039"
     class="PastDate" title="Advanced Care Plan Documented">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref164
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref164>
    </td>
    </tr>

<tr><td></td>
    <td><input type="button" class="Extralargebutton" id="btnOtherFactors"
          value="Other Factors Affecting Health"
         onclick="openOtherFactorsAffectingHealth();"/></td>
    <td class=DataLabel>
    <span id="careplantitlespan" style="display:none">
    Episode Care Plan Documented
    </span>
    </td>
    <td class=DataField> 
    <span id="careplanfieldspan" style="display:none">
    <input type=text id=alref096 name=alref096 size=12
     onblur="checkDate(this,'Date')" value="%ALLWEB02.02.157"
     class="PastDate" title="Episode Care Plan Documented">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref096
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref096>
    </span>
   </td>
   </tr>

<tr><td></td>
<td><input type="button" class="Extralargebutton"
         id="btnReferralDestination" name="btnReferralDestination"
         value="Referral Out" onclick="openReferralDestination();"/>
    </td>
    <td class=DataLabel>Preferred Site</td>
    <td class=DataField>
      <select name=alref119 title="Preferred Site" onchange="SetList();">
        <option></option>
        %ALLWEB02.02.182.2
      </select>
    </td>

<tr><td class=DataLabel>Clinic Type </td>
    <td><select class="SelectBig Mandatory" name=alref106  tabindex=10
         maxlength=45 title="Clinic Type">
        <option></option>
        </select></td>
     <td class=DataLabel>
    <span id="clinicidtitlespan" style="display:none">
    Clinic ID
    </span>
    </td>
    <td class=DataField>
    <span id="clinicidfieldspan" style="display:none">
    <select name=alref120 title="Clinic ID" >
          <option></option>
          </select>
    </span>
    </td>
     </tr>
<tr><td class=DataLabel>
    <span id="reasontitlespan" style="display:none">
    Reason for Referral
    </span>
    </td>
    <td>
    <span id="reasonfieldspan" style="display:none">
      <select title="Reason for Referral" name=alref028 id="alref028"
         class="SelectBig">
        <option></option>
        %ALLWEB02.02.128.2
      </select>
    </span>
    </td>
    <td class=DataLabel></td>
     <td class=DataField></td>
    </tr>

<tr><td class=DataLabel>Status</td>
   <td><input type=text value="%ALLWEB02.02.103"
          readonly class=Readonly></td>
    <td class=DataLabel><div id="EventProgramLabel"></div></td>
    <td class=DataField><div id="EventProgramField"></div></td>
   </tr>

</table>

<div id=InsertActive style="display:none;">
<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<td class=DataLabel width=15%>Activate Referral</td>
      <td><input type=checkbox name=activref 
       title="Activate Referral" value="1">
      </td>
</table>
</div>

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>

<tr><td class=DataLabel width=15%>Comments 1</td>
    <td colspan=3><input type=text size=65 maxlength=62 name=alref088 
         value="%ALLWEB02.02.149">
    </td></tr>

<tr><td class=DataLabel width=15%>Comments 2</td>
    <td colspan=3><input type=text size=65 maxlength=60 name=alref089 
         value="%ALLWEB02.02.150">
    </td></tr>

<tr><td class=DataLabel>Case Team</td>
   <td colspan=3><input type=text name=alref087 size=11 maxlength=11 title="Case Team"
        id=alref087 value="%ALLWEB02.02.148.1"
        onblur="validateCode2(7,alref087,n_alref087)">
       <input type=text id=n_alref087 name=n_alref087 size=30 readonly 
        class=Readonly tabindex=-1 title="Team Description"
        value="%ALLWEB02.02.148.0">
       <img src="../images/SearchIcon.gif" class=Icon
        onclick="TeamSearchFrame(alref087,n_alref087)">
        <img src="../images/ClearIcon.gif" class=Icon
        onclick="clrFields(alref087,n_alref087);">
       </td></tr>

<tr><td class=DataLabel>Date Referral Accepted</td>
    <td class=DataField> <input type=text name=alref090 size=12 tabindex=80
     id=alref090 onblur="checkDate(this,'Date')" value="%ALLWEB02.02.151"
     class="PastDate" title="Date Referral Accepted">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref090
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref090>
    </td>
    <td class=DataLabel></td>
    <td></td>
    </tr>

<tr><td class=DataLabel colspan=2>Print Update Referral Letter to Patient &nbsp;
&nbsp;
      <input type=checkbox name=prtupdpt
       title="Upd Referral to pat" value="1">
      </td>
      <td class=DataLabel>Printer </td>
      <td><select name=prtpsl03 class="SelectBig">
      %STANDARD.01.001.ALLUPDPT.01
      </select></td></tr>
<tr><td class=DataLabel colspan=2>Print Update Referral Letter to Referrer
      <input type=checkbox name=prtupdrf
       title="Upd Referral to pat" value="1">
      </td>
      <td class=DataLabel>Printer </td>
      <td><select name=prtpsl04 class="SelectBig">
      %STANDARD.01.001.ALLUPDRF.01
      </select></td></tr>

<tr><td class=DataLabel colspan=2>Referral Labels
    <input type=checkbox value="1" id=prtreflb name=prtreflb width=30%
        onclick="SetPrinter(UpdateForm.prtpno07,UpdateForm.prtpsl07);">
    Copies
    <select name=prtpno07 width=20%>
        %STANDARD.01.027.2.1
    </select></td>

  <td class=DataLabel>Printer</td>
    <td><select class="SelectBig" name=prtpsl07 title="Printer" width=15%>
        <option></option>
        %STANDARD.01.001.LABELALL.01
        </select></td></tr>
</table>

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td colspan=4 align=center><br>
    <input type=button id=btnAdd name=formactn value="OK" class="button"
     onclick="tempDisable(this); UpdateReferral(UpdateForm);">
    <input type=button Value="Close" class="button"
     onclick="DFrameClose();">
    </td></tr>
</table>
</form>

<span id="ShowEventProgramLabel" style="display:none">
  Event Program
</span>

<span id="ShowEventProgramField" style="display:none">
  <select class="Mandatory SelectBig" name=alref145 title="Event Program">
  <option></option>
  %ALLWEB02.02.199.016.2
  </select>
</span>

<span id="showtsHeading" style="display:none">
Triage Status
</span>

<span id="showtsField" style="display:none">
<select title="Triage Status" name=alref186 class="Mandatory SelectBig"
 id="alref186" onchange="showPriorityTriage();">
<option></option>
%ALLWEB02.02.199.066.2
</select>
</span>

<span id="showtdHeading" style="display:none">
Triage Date
</span>

<span id="showtdField" style="display:none">
<input type=text name=alref187 id=alref187 size=12 title="Triage Date"
 value="%ALLWEB02.02.199.067" class="PastDate"
 onblur="checkTriageDate(this);">
<img src=../images/DateTimeStamp.gif class=Icon
 date=UpdateForm.alref187 time=null>
<img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref187>
</span>

<span id="showprHeading" style="display:none">
Priority
</span>

<span id="showprField" style="display:none">
<select class="Mandatory selectBig" name=alref027 id=alref027
 title="Priority" onchange="ValidatePriority();">
<option></option>
 %ALLWEB02.02.127.2
</select>
</span>

<script type="text/javascript">
//
  if ("%ALLWEB02.02.103" == "Waiting   ") {
  InsertActive.style.display='';
}
  else {
  InsertActive.style.display='none'; }
//
if ("%ALLWEB02.02.103" == "Closed    ") {
  document.UpdateForm.alref164.className="Mandatory"
}
//
 SACSRef="%ALLWEB02.02.144";
 if ( SACSRef == "Yes") {
   document.UpdateForm.alref083.value=1;
 }
//
 mainHealthRecord="%ALLWEB02.02.808"
 var btnMainHealth = document.getElementById("btnMainHealth");

 if(mainHealthRecord==1)
   btnMainHealth.style.color = "red";
 else
   btnMainHealth.style.color = "black";
//
 otherFactors="%ALLWEB02.02.810"
 var btnOtherFactors = document.getElementById("btnOtherFactors");

 if(otherFactors == 1)
   btnOtherFactors.style.color = "red";
 else
   btnOtherFactors.style.color = "black";
//
 referralDestination="%ALLWEB02.02.813"
 var btnreferralDestination = document.getElementById("btnReferralDestination");

 if(referralDestination == 1)
  btnreferralDestination.style.color = "red";
 else
  btnreferralDestination.style.color = "black";
</script>
