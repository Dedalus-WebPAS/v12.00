<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src=../js/PathologySort.js></script>
<script type="text/javascript">
function selectView(viewTypeValue) {
 document.SelectView.viewtype.value=viewTypeValue
 document.SelectView.submit();
}
function linkURL(link) {
location.href=link
}
function linkPatient(urNumber,admissionNo) {
  document.linkForm.admissno.value=admissionNo;
  document.linkForm.urnumber.value=urNumber;
  document.linkForm.action="patweb98.pbl";
  document.linkForm.reportno.value="1";
  document.linkForm.template.value="1";
  document.linkForm.target="newWindow";
  newWindow=open("","newWindow",
   "width=640,height=250,scrollbars=no,status=no,toolbar=no,menubar=no");
  document.linkForm.submit();
}
function ShowMore(NextResultKey) {
 document.SelectPeriod.startkey.value=NextResultKey
 document.SelectPeriod.submit();
}
function ShowUnread() {
document.SelectView.template.value=2
document.SelectView.viewtype.value=1
document.SelectView.submit();
}
function SelectPeriodSubmit() {
if (SelectPeriod.lookupdt.value!=null) {
    day=SelectPeriod.lookupdt.value.substr(0,2)
    mth=SelectPeriod.lookupdt.value.substr(3,3)
    yrr=SelectPeriod.lookupdt.value.substr(7,4)
    switch(mth) {
      case "Jan": DateValue=yrr + "01" + day; break;
      case "Feb": DateValue=yrr + "02" + day; break;
      case "Mar": DateValue=yrr + "03" + day; break;
      case "Apr": DateValue=yrr + "04" + day; break;
      case "May": DateValue=yrr + "05" + day; break;
      case "Jun": DateValue=yrr + "06" + day; break;
      case "Jul": DateValue=yrr + "07" + day; break;
      case "Aug": DateValue=yrr + "08" + day; break;
      case "Sep": DateValue=yrr + "09" + day; break;
      case "Oct": DateValue=yrr + "10" + day; break;
      case "Nov": DateValue=yrr + "11" + day; break;
      case "Dec": DateValue=yrr + "12" + day; break;
    }
    SelectPeriod.lastdate.options[SelectPeriod.lastdate.options.length]=
    new Option(SelectPeriod.lookupdt.value,DateValue,true,true)
 }
SelectPeriod.submit();
}
function SelectPeriodSetFld() {
 document.SelectPeriod.lastdate.style.display="none";
 document.SelectPeriod.lookupdt.style.display="";
}
</script>
%START.OF.PAGE
<body onload=PageLoad(event);InitTable();>
<div id=HeadingSection>
<form name=SelectView action=cliweb03.pbl method=get style=margin:0>
<input type=hidden name=reportno value=8>
<input type=hidden name=template value=1>
<input type=hidden name=viewtype value="%CLIWEB03.08.110">
</form>
 <form name=SelectPeriod action=cliweb03.pbl method=get style=margin:0>
 <input type=hidden name=reportno value=8>
 <input type=hidden name=template value=1>
 <input type=hidden name=startkey value="">
 <input type=hidden name=flagnorm value="%CLIWEB03.08.117">
 <input type=hidden name=viewtype value="%CLIWEB03.08.110">
<table cellpadding=0 cellspacing=0 bgcolor=#CCCCCC border=1 width=100%>
<tr><td>
<table cellpadding=0 cellspacing=0 bgcolor=#CCCCCC border=0 width=100%>
 <tr><td align=left>
  Results Service
  <select name=labrcode onChange=document.SelectPeriod.submit()>
  <option value='   '>All</option>
  %CLIWEB03.08.115
  </select>
  Result Status
  <select name=normalfl onChange=document.SelectPeriod.submit()>
  <option value=' '>All </option>
  <option value='0'>Abnormal </option>
  <option value='1'>Normal </option>
  </select>
  <input type=button value="Unread Results" class="button" onClick='ShowUnread();'>
  <td align=right>
  <input type=button value="<<" class=SmallButton
    onClick='location.href="%CLIWEB03.08.102"'>
    %CLIWEB03.08.107
    <input type=button value=">>" class=SmallButton
    onClick='location.href="%CLIWEB03.08.101"'>
    <a href='javascript:SelectDateFrame();'>
    <img src="../images/DateLookup.gif" border=0
     alt="Select Date" align=absmiddle></a>
    <a href='javascript:SelectView("0");'>
    <img src=../images/DayIcon.gif border=0
     alt="View Today" align=absmiddle></a>
    <a href='javascript:SelectView("1");'>
    <img src=../images/WeekIcon.gif border=0 
     alt="View This Week" align=absmiddle></a>
    <a href='javascript:SelectView("2");'>
    <img src=../images/MonthIcon.gif border=0 
     alt="View This Month" align=absmiddle></a>
 </td></tr>
</table>
</table>
 </form>
</div>
<div id=TableLocation></div>


<form name=linkForm action=patweb98.pbl method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="  ">
<input type=hidden name=admissno value="  ">
</form>


<script type="text/javascript">
function InitTable() {
  el=SelectPeriod.normalfl
  for (i=0;i<el.options.length;i++) {
    if (el.options[i].value==SelectPeriod.flagnorm.value) {
      el.selectedIndex=i;
    }
  }
//
// Create New Table Object
//
//
 t = new Table(1,0,1,"100%","center",25);
//
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column, Width,
// Link Type, Javascript, Parameter Columns
t.addColumn("Date & Time","DateTime",1,1,"left","pathology.gif","0",110)
t.addColumn("Patient","Name",2,2,"left nowrap","","",190)
t.addColumn("Result","String",3,3,"left nowrap","","",190)
t.addColumn("Status","String",7,7,"left","","",70)
t.addColumn("Norm","Image",4,4,"center","ResultStatus","",40)
t.addColumn("Read","Image",5,5,"center","ResultRead","",40)
//
// Add Rows to Table (Output from Web Server)
//
%CLIWEB03.08.111.cliweb10.01.001

if (t.rows.length != 0 ) {
   OrderColumn=0; 
   AscDsc=2;
   lastOrderColumn=OrderColumn;
   TableOutput(OrderColumn,AscDsc);
 }
}
</script>
