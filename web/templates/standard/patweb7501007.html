<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="CrossBrowser" content="true">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src="../js/patweb7501001.js"></script>
<script type="text/javascript" src="../js/TableSort.js"></script>
<script type="text/javascript">
//=============================================================================
//        Function Calling Remote Scripting To Get MBS Description
//=============================================================================
function defaultQuant() {
  if (isWhitespace(document.AddForm.qunty000.value)) {
    document.AddForm.qunty000.value="1";
  }
}

function GetDesc(ReturnCode,ReturnDesc,DateField,Quant,Ref,Sess,
                 Amount,GstA,GstC,Iamnt,PatPr,RebPr,NZUnique,Strttim,Endtime) {
  var code=ReturnCode.name;

  if ((isWhitespace(ReturnCode.value))&&(isWhitespace(ReturnDesc.value))) {
    return;
  }

  ReturnCode.value=ReturnCode.value.replace(/ /g,"")
  NZUnique.value=NZUnique.value.replace(/ /g,"")

  ReturnDesc.value="";

  if (isWhitespace(ReturnCode.value)) { return; }

  var serverURL = "../cgi-bin/patweb80.pbl?reportno=4" +
        "&valdcode=" + ReturnCode.value.replace(/ /g,"+") +
        "&returndt=" + DateField.value.replace(/ /g,"+") +
        "&valdadno=" + AddForm.admissno.value.replace(/ /g,"+") +
        "&valduniq=" + NZUnique.value.replace(/ /g,"+")

  if (document.AddForm.cfeetyp!=undefined) {
    if (document.AddForm.cfeetyp.value=="5") {
      serverURL+="&valdtype=3";
    } else {
      serverURL+="&valdtype=1";
    }
  }

  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    ReturnDesc.value=trim(ReturnValue[0]);
    ReturnDesc.value=ReturnDesc.value.toUpperCase()

    if (document.AddForm.cfeetyp!=undefined){
      if (document.AddForm.cfeetyp.value=="5") {
        ReturnDesc.value=trim(ReturnValue[16]);
        ReturnDesc.value=ReturnDesc.value.toUpperCase()
      }
    }


    Amount.value=ReturnValue[1];
    Iamnt.value=ReturnValue[1];          // amount for a single item
    justifyLeft(Amount);
    justifyLeft(Iamnt);

    PatPr.value=ReturnValue[12];
    RebPr.value=ReturnValue[13];

    GstA.value=ReturnValue[10];
    GstC.value=ReturnValue[11];

    ReturnCode.className="Mandatory";
    DateField.className="Date Mandatory";

    if (ReturnValue[2]==1) // keyin description ?
    {
      ReturnDesc.className="Mandatory";
      ReturnDesc.readOnly=false;
    }
    else
    {
      ReturnDesc.className="ReadOnly";
      ReturnDesc.readOnly=true;
    }

    if (ReturnValue[4]==1) {
      alert("Warning: This is an Exclusion List Item.");
    }

    if (ReturnValue[5]==1) {
      alert("Warning: MBS Item has been changed.");
    }

    if (ReturnValue[6]==1) {
      alert("Warning: A Prosthetic may need to be entered.");
    }

    if (ReturnValue[8]==1) {
      i=ReturnValue[9];
      alert("Warning: Admission Type Should be " + i);
    }

    if (ReturnValue[8]==2) {
      alert("Warning: Invalid Suggested Admission Type.");
    }

    if (ReturnValue[8]==3) {
      alert("Warning: Item has been Entered in the Previous Invoice.");
    }

    if (ReturnValue[8]==4) {
      alert("Warning: Possible Admission Type Changed Required.");
    }

    if (ReturnValue[8]==5) {
      alert("Warning: Possible Admission Type Changed Required and Item " +
            "has been Entered in Previous Invoice.");
    }

    if (ReturnValue[8]==6) {
     i=ReturnValue[14];
     alert("Warning: Suggested Adm Type: " + i +
           " for this patient is excluded from " + "auto adm type update.");
    }

    //Quant.select();
    //Quant.focus();
    FocusDelay(Quant);

    if ((ReturnValue[3]==1)&&(ReturnValue[10]==2)) {
      Amount.className="ReadOnly";
      Amount.readOnly=true;

      window.GstA=GstA;
      window.GstC=GstC;
      window.Amount=Amount;
      window.Iamnt=Iamnt;
      window.PatPr=PatPr;
      window.RebPr=RebPr;
      window.Quant=Quant;
      document.AddForm.postflag.value="1";

      linkURL="patweb75.pbl?reportno=01&template=004" +
              "&urnumber=" + AddForm.urnumber.value.replace(/ /g,"+") +
              "&admissno=" + AddForm.admissno.value.replace(/ /g,"+")

      Left=(document.body.clientWidth-350)/2
      DFrameLink(linkURL,0,Left,350,120)
      return;
    }

    if (ReturnValue[10]==2) {
      Amount.className="ReadOnly";
      Amount.readOnly=true;
      window.GstA=GstA;
      window.GstC=GstC;
      window.Quant=Quant;
      document.AddForm.postflag.value="1";

      linkURL="patweb75.pbl?reportno=01&template=002" +
              "&urnumber=" + AddForm.urnumber.value.replace(/ /g,"+") +
              "&admissno=" + AddForm.admissno.value.replace(/ /g,"+")

      Left=(document.body.clientWidth-350)/2
      DFrameLink(linkURL,0,Left,350,120)
      return;
    }

    if (ReturnValue[3]==1) {
      window.Amount=Amount;
      window.Iamnt=Iamnt;
      window.PatPr=PatPr;
      window.RebPr=RebPr;
      window.Quant=Quant;
      window.ItDes=ReturnDesc;
      document.AddForm.postflag.value="1";

      linkURL="patweb75.pbl?reportno=01&template=009" +
              "&urnumber=" + AddForm.urnumber.value.replace(/ /g,"+") +
              "&admissno=" + AddForm.admissno.value.replace(/ /g,"+")

      Left=(document.body.clientWidth-350)/2
      DFrameLink(linkURL,0,Left,350,120)
      return;
    }
  } else {
    Amount.className="Number Mandatory";
    Amount.readOnly=false;
    Amount.onkeydown = null;
    ReturnCode.value="";
    ReturnDesc.value="";
    ReturnDesc.className="";
    ReturnDesc.readOnly=false;
    Quant.value=" ";
    ReturnCode.select();
  }
}

function DeleteItm(trnno) {
   ans=confirm("Are you sure you want to Delete ?")
   if (ans)  {
  document.ItemForm.redirect.value="patweb75.pbl?reportno=1&template=7"+
     "&urnumber=" + document.AddForm.urnumber.value.replace(/ /g,"+") +
     "&admissno=" + document.AddForm.admissno.value.replace(/ /g,"+") +
     "&mdate000=" + document.AddForm.mdate000.value.replace(/ /g,"+") +
     "&incty000=" + document.AddForm.incty000.value.replace(/ /g,"+") +
     "&uniqu000=" + document.AddForm.uniqu000.value.replace(/ /g,"+") +
     "&proce000=" + document.AddForm.proce000.value.replace(/ /g,"+") +
  "&casekeys=" + document.PatientLinks.casekeys.value.replace(/ /g,'+') +
  "&uniqueky=" + document.PatientLinks.uniqueky.value.replace(/ /g,'+') +
  "&teamnumb=" + document.PatientLinks.teamnumb.value.replace(/ /g,'+');
        ItemForm.transnum.value=trnno;
        ItemForm.updttype.value="D";
        ItemForm.submit();
   }
}
function UpdateItm(trnno,itmfld) {
  document.ItemForm.redirect.value="patweb75.pbl?reportno=1&template=7"+
     "&urnumber=" + document.AddForm.urnumber.value.replace(/ /g,"+") +
     "&admissno=" + document.AddForm.admissno.value.replace(/ /g,"+") +
     "&mdate000=" + document.AddForm.mdate000.value.replace(/ /g,"+") +
     "&incty000=" + document.AddForm.incty000.value.replace(/ /g,"+") +
     "&uniqu000=" + document.AddForm.uniqu000.value.replace(/ /g,"+") +
     "&proce000=" + document.AddForm.proce000.value.replace(/ /g,"+") +
  "&casekeys=" + document.PatientLinks.casekeys.value.replace(/ /g,'+') +
  "&uniqueky=" + document.PatientLinks.uniqueky.value.replace(/ /g,'+') +
  "&teamnumb=" + document.PatientLinks.teamnumb.value.replace(/ /g,'+');

  if (checkInteger(itmfld,document.AddForm.qunty000.title)) {
    if (itmfld.value > 0) {
      ItemForm.mschamnt.value=itmfld.value;
      ItemForm.transnum.value=trnno
      ItemForm.updttype.value = "U";
      ItemForm.submit();
    }
    else {
      alert("Quantity must be greater than 0");
      itmfld.select();
    }
  }
}
function LookupProc(admissno,RETuniq,RETproc,IncTy,RETprocd,RETitem){
  document.AddForm.urnumber.value=document.ItemForm.urnumber.value;
  document.AddForm.admissno.value=document.ItemForm.admissno.value;
  var PopUpFrameDoc = DFrameStart();
  window.admissno=admissno;
  window.RETproc=RETproc;
  window.RETuniq=RETuniq;
  window.RETitem=RETitem;
  window.RETprocd=RETprocd;
  PopUpFrameDoc.location.href = "../lookups/NZProcedureSearchFrame.html";
  SearchFrameShow();
}
function MiscNextNZP() {
  f = document.AddForm;
  window.ReturnSpecMbs="";    // Var to set onblur on UpdateParent()
  // Custom Misc.Search
  Code=document.getElementById('itemn000');
  if (f.ibcnmhos.value == "1" && f.cfeetyp.value == "5") {
    MiscChargeSearchFrameNZP(Code,
                             f.dummy,
                             f.pmvxmhos,
                             f.srchclam,
                             f.srchcntr,
                             f.srchtabl,
                             ValNZMBS);
  }
  else {
    MiscChargeSearchFrameNZP(Code,
                             f.dummy,
                             f.multhosp,
                             f.srchclam,
                             f.srchcntr,
                             f.srchtabl,
                             ValNZMBS);
  }
}
function ValNZMBS() {
  setTimeout('ValNZItm();',400);
}
function ValNZItm() {
 p=document.AddForm;
 GetDesc(p.itemn000,p.nzdes000,p.mdate000,p.qunty000,p.refnc000,p.sessn000,p.camnt000,
     p.gstap000,p.gstcd000,p.iamnt000,p.patpr000,p.rebpr000,p.uniqu000,p.sttim000,p.entim000);

}
function PostItems() {
  document.AddForm.redirect.value="patweb75.pbl?reportno=1&template=7"+
     "&urnumber=" + document.AddForm.urnumber.value.replace(/ /g,"+") +
     "&admissno=" + document.AddForm.admissno.value.replace(/ /g,"+") +
     "&mdate000=" + document.AddForm.mdate000.value.replace(/ /g,"+") +
     "&incty000=" + document.AddForm.incty000.value.replace(/ /g,"+") +
     "&uniqu000=" + document.AddForm.uniqu000.value.replace(/ /g,"+") +
     "&proce000=" + document.AddForm.proce000.value.replace(/ /g,"+") +
     "&procdesc=" + document.AddForm.procdesc.value.replace(/ /g,"+") +
     "&uniqueky=" + document.PatientLinks.uniqueky.value.replace(/ /g,"+") +
     "&casekeys=" + document.PatientLinks.casekeys.value.replace(/ /g,'+');

 if (!checkInteger(document.AddForm.qunty000,document.AddForm.qunty000.title)) {
   document.AddForm.qunty000.value="";
   //document.AddForm.qunty000.select();
   return;
 }

 if (document.AddForm.itemn000) {
   if (!isWhitespace(document.AddForm.itemn000.value)) {

     if ((trim(document.AddForm.qunty000.value)=="0") ||
         (trim(document.AddForm.qunty000.value)=="")) {

       document.AddForm.postflag.value=0;
       document.AddForm.keynflag.value=0;
       document.AddForm.itemn000.value="";
       document.AddForm.nzdes000.value="";
       document.AddForm.qunty000.value="";
       document.AddForm.itemn000.select();
       return;
     } 
     else {
       if (document.AddForm.keynflag.value=="0") {
         if (document.AddForm.postflag.value=="1") {
           document.AddForm.postflag.value="0";
           document.AddForm.keynflag.value="1";
           return;
         } else {
               document.AddForm.keynflag.value="1";
               if (document.AddForm.nzdes000.className=='Mandatory') {
                   document.AddForm.nzdes000.select();
               } else {
                   document.AddForm.qunty000.select();
               }
               return;
         }
       } else {
         if (document.AddForm.postflag.value=="1") {
           document.AddForm.keynflag.value="0";
           document.AddForm.qunty000.select();
           return;
         }
       }

       if (document.AddForm.postflag.value=="0") {
         document.AddForm.keynflag.value=0;
         document.AddForm.nextpage.value=9;
         document.AddForm.urnumber.value=
          document.AddForm.urnumber.value.replace(/ /g,"+");
         document.AddForm.admissno.value=
          document.AddForm.admissno.value.replace(/ /g,"+");

         document.AddForm.nzdes000.value=
          document.AddForm.nzdes000.value.replace(/\"/g, "");

         if (validateMandatory(document.AddForm)) {
           document.AddForm.submit();
         }
       }
     }
   }
 }

}

function PrintItems() {
    LinkURL="patweb05.pbl?reportno=03&template=001&urnumber=" +
             document.AddForm.urnumber.value.replace(/ /g,"+") +
            "&admissno=" +
             document.AddForm.admissno.value.replace(/ /g,"+") +
            "&menuflag=1";

    Left=(document.body.clientWidth-550)/2
    DFrameLink(LinkURL,100,Left,650,280);
}

function ChkClsPrt() {
  if ((isWhitespace(document.AddForm.itemn000.value))&&
      (isWhitespace(document.AddForm.nzdes000.value))) {
    return;
  }

  if (document.AddForm.itemn000!=undefined) {

    if (!isWhitespace(document.AddForm.itemn000.value)) {
      document.AddForm.clsprtbut.disabled=true;
      return;
    }
  }
  document.AddForm.clsprtbut.disabled=false;
}

function ChkDesc() {
  if ((isWhitespace(document.AddForm.itemn000.value))&&
      (isWhitespace(document.AddForm.nzdes000.value))) {
    return;
  }

  if (document.AddForm.nzdes000.className!='ReadOnly') {
    document.AddForm.nzdes000.select();
  } else {
    document.AddForm.qunty000.value="1";
    document.AddForm.keynflag.value="1";
    document.AddForm.qunty000.select();
  }
}

</script>
%START.OF.PAGE
<script type="text/javascript">
function InitTable() {
  f = document.AddForm;
//
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column,Align
//
  document.title="Existing Items"
  t = new Table(1,0,2,"100%","center",30,30);

  if (VariableNameExists('EditDelMiscItems')) {
    if (EditDelMiscItems == true) {
      EditDel = "Y";
    }
    else {
      EditDel = "N";
    }
   }

  if (f.ptcnhdps.value == "1") {
    if (EditDel == "Y") {
      t.addColumn("Date & Time","DateTimeImg",1,1,"left","DeleteIcon","9",80,11)
      t.addColumn("Incl Type","String",7,7,"left","","",20)
      t.addColumn("Procedure","String",8,8,"left","","",60)
      t.addColumn("Code","String",2,2,"left","","",20)
      t.addColumn("Description","String",3,3,"left","","",120)
      t.addColumn("Quantity","String",10,10,"left","","",20)
      t.addColumn("User ID","String",5,5,"left","","",20)
    }
    else {
      t.addColumn("Date & Time","DateTimeImg",1,1,"left","DeleteIcon","0",80,6)
      t.addColumn("Incl Type","String",7,7,"left","","",20)
      t.addColumn("Procedure","String",8,8,"left","","",60)
      t.addColumn("Code","String",2,2,"left","","",20)
      t.addColumn("Description","String",3,3,"left","","",120)
      t.addColumn("Quantity","String",4,4,"left","","",20)
      t.addColumn("User ID","String",5,5,"left","","",20)
    }
  }
  else {
    if (EditDel == "Y") {
      t.addColumn("Date & Time","DateTimeImg",1,1,"left","DeleteIcon","9",80,11)
      t.addColumn("Code","String",2,2,"left","","",20)
      t.addColumn("Description","String",3,3,"left","","",120)
      t.addColumn("Quantity","String",10,10,"left","","",20)
      t.addColumn("User ID","String",5,5,"left","","",20)
    }
    else {
      t.addColumn("Date & Time","DateTimeImg",1,1,"left","DeleteIcon","0",80,6)
      t.addColumn("Code","String",2,2,"left","","",20)
      t.addColumn("Description","String",3,3,"left","","",120)
      t.addColumn("Quantity","String",4,4,"left","","",20)
      t.addColumn("User ID","String",5,5,"left","","",20)
    }
  }
//
// Add Rows to Table (Output from Web Server)
//
//

%PATWEB75.01.123

  OrderColumn=0
  AscDsc=2
  lastOrderColumn=OrderColumn;
  TableOutput(OrderColumn,AscDsc);

}
function PrefReqItems() {
  var PopUpFrameDoc = DFrameStart();
  URLstring = "oprweb06.pbl?reportno=14&template=005" + 
  "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,'+') +
  "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,'+') +
  "&casekeys=" + document.PatientLinks.casekeys.value.replace(/ /g,'+') +
  "&uniqueky=" + document.PatientLinks.uniqueky.value.replace(/ /g,'+') +
  "&teamnumb=" + document.PatientLinks.teamnumb.value.replace(/ /g,'+') +
  "&mdate000=" + document.AddForm.mdate000.value.replace(/ /g,"+") +
  "&incty000=" + document.AddForm.incty000.value.replace(/ /g,"+") +
  "&uniqu000=" + document.AddForm.uniqu000.value.replace(/ /g,"+") +
  "&proce000=" + document.AddForm.proce000.value.replace(/ /g,"+") +
  "&procdesc=" + document.AddForm.procdesc.value.replace(/ /g,"+")
  PopUpFrameDoc.location.href=URLstring;

  SearchFrameShow();
}
function displayPrefReqButton() {
  FavButtonDIV.innerHTML=FavButtonSPAN.innerHTML;
  if (document.AddForm.opcnptmc.value=="1" &&
      !isWhitespace(document.AddForm.casekeys.value)) {
    PrefReqButtonDIV.innerHTML=PrefReqButtonSPAN.innerHTML;
  }
}
function FavItems() {

  SetCookie("favOnloadCookie","1");

  var PopUpFrameDoc = DFrameStart();
  URLstring = "oprweb06.pbl?reportno=20&template=001" +
  "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,'+') +
  "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,'+') +
  "&casekeys=" + document.PatientLinks.casekeys.value.replace(/ /g,'+') +
  "&uniqueky=" + document.PatientLinks.uniqueky.value.replace(/ /g,'+') +
  "&teamnumb=" + document.PatientLinks.teamnumb.value.replace(/ /g,'+') +
  "&mdate000=" + document.AddForm.mdate000.value.replace(/ /g,"+") +
  "&incty000=" + document.AddForm.incty000.value.replace(/ /g,"+") +
  "&uniqu000=" + document.AddForm.uniqu000.value.replace(/ /g,"+") +
  "&proce000=" + document.AddForm.proce000.value.replace(/ /g,"+") +
  "&procdesc=" + document.AddForm.procdesc.value.replace(/ /g,"+")
  PopUpFrameDoc.location.href=URLstring;

  SearchFrameShow();
}
function displayNzFields() {
  f = document.AddForm;
  if (f.ptcnhdps.value == "1") {
    document.getElementById('ShowInclTypeNZ').style.display = "";
    document.getElementById('ShowProcCodeSearchNZ').style.display = "";
    document.getElementById('ShowProcDescNZ').style.display = "";
    document.getElementById('ShowInclTypeAUS').style.display = "none";
    document.getElementById('ShowProcCodeSearchAUS').style.display = "none";
    document.getElementById('ShowProcDescAUS').style.display = "none";
  }
  else {
    document.getElementById('ShowInclTypeNZ').style.display = "none";
    document.getElementById('ShowProcCodeSearchNZ').style.display = "none";
    document.getElementById('ShowProcDescNZ').style.display = "none";
    document.getElementById('ShowInclTypeAUS').style.display = "";
    document.getElementById('ShowProcCodeSearchAUS').style.display = "";
    document.getElementById('ShowProcDescAUS').style.display = "";
  }
}
</script>
</head>
<body onload="PageLoad(event);
              InitTable();
              ChkClsPrt();
              displayPrefReqButton();
              displayNzFields();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB75.01.003";
PatientVIS="%PATWEB75.01.081";
PatientNAM="%PATWEB75.01.002";
PatientSTA="%PATWEB75.01.086.078";
PatientALT="%PATWEB75.01.084";
PatientSEX="%PATWEB75.01.019";
PatientDOB="%PATWEB75.01.020";
PatientAGE="%PATWEB75.01.021";
PatientLOC="%PATWEB75.01.083";
PatientPRI="%PATWEB75.01.086.066.1";
PatientUNT="%PATWEB75.01.066.0";
DoctorCOD="%PATWEB75.01.082.003";
DoctorNAM="%PATWEB75.01.082.002";
PatientAID="%PATWEB75.01.086.090";
PatientIND="%PATWEB75.01.086.091";
PatientCUR="%PATWEB75.01.086.092";
PatientCLC="%PATWEB75.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB75.01.086.094";
PatientCDM="%PATWEB75.01.086.095";
PatientVDH="%PATWEB75.01.086.099.015";
InsertPatientHeader()
</script>
<form name=AddForm id=AddForm method=post action=patweb75.pbl style="margin:0">
  <input type=hidden name=reportno id=reportno value="1">
  <input type=hidden name=template id=template value="007">
  <input type=hidden name=updatety id=updatety value="A">
  <input type=hidden name=urnumber id=urnumber value="%PATWEB75.01.003">
  <input type=hidden name=admissno id=admissno value="%PATWEB75.01.081">
  <input type=hidden name=multhosp id=multhosp value="%PATWEB75.01.113">
  <input type=hidden name=previtem id=previtem value="%PATWEB75.01.105">
  <input type=hidden name=visittyp id=visittyp value="%PATWEB75.01.111">
  <input type=hidden name=nextpage id=nextpage value="1">
  <input type=hidden name=dummy    id=dummy value="">
  <input type=hidden name=counter  id=counter value="">
  <input type=hidden name=primuniq id=primuniq value="%PATWEB75.01.115">
  <input type=hidden name=ptcnhdps id=ptcnhdps
   value="%STANDARD.01.025.080.250.0.1">
  <input type=hidden name=cfeetyp id=cfeetyp
   value="%STANDARD.01.025.019.212.0.1">
  <input type=hidden name=currdate id=currdate value="%PATWEB75.01.112">
  <input type=hidden name=defproc id=defproc value="%PATWEB75.01.114">
  <input type=hidden name=postflag id=postflag value="0">
  <input type=hidden name=keynflag id=keynflag value="0">
  <input type=hidden name=redirect value="%PATWEB75.01.001.patweb75.01.007">
  <input type=hidden name=uniqu000 id=uniqu000 value="">
  <input type=hidden name=opcnptmc id=opcnptmc value="%STANDARD.01.025.113. 66.0.1">
  <input type=hidden name=casekeys value='%PATWEB75.01.138'>
  <input type=hidden name=uniqueky value='%PATWEB75.01.139'>
  <input type=hidden name=teamnumb value='%PATWEB75.01.140'>
  <input type=hidden name=pmvxmhos value="%PATWEB75.01.113">
  <input type=hidden name=ibcnmhos id=ibcnmhos
   value="%STANDARD.01.025.000.043.1.1">
  <input type=hidden name=cfeetyp id=cfeetyp
   value="%STANDARD.01.025.019.212.1.1">

<table width=100% border=0 cellpadding=0 cellspacing=0>
  <tr>
    <td colspan=6 align=center class=HeadingCell style='line-height:25px;'>
      Input Miscellaneous Items</td>
  </tr>
  </tr>
  <tr>
    <td width=13%>
      <input type=text size=10 maxlength=12 name=mdate000 id=mdate000
        value="%PATWEB75.01.112"
        class='NoAutoFocus Mandatory' title='Item Date'
        onblur="CheckIDate(AddForm.mdate000);">
      <img notab src="../images/DateTimeStamp.gif"
        class='Icon' alt='Current' date='AddForm.mdate000'>
      <img notab src="../images/DateLookup.gif" 
        class='Icon' alt='Show Calendar' 
        date='AddForm.mdate000'>
    </td>
    <td id=ShowInclTypeNZ width=17%>Incl type
      <select name=incty000 id=incty000 title='Inclusion Type'
        class='NoAutoFocus'>
        <option value='0'>Included in Contract</option>
        <option value='1'>Bill to Patient</option>
        <option value='2'>Extra to Contract</option>
      </select>
    </td>
    <td id=ShowInclTypeAUS width=17%>&nbsp;</td>
    <td id=ShowProcCodeSearchNZ width=40%>Procedure &nbsp; 
      <img src="../images/SearchIcon.gif" class='Icon'
        onclick="LookupProc(AddForm.admissno,
                            AddForm.uniqu000,
                            AddForm.proce000,
                            AddForm.incty000,
                            AddForm.procdesc,
                            ItemNo);">
      <input type=text size=9 name=proce000 id=proce000
        value="%PATWEB75.01.114"
        maxlength=9 title='Procedure' class=readonly 
        readonly=true >
    </td>
    <td id=ShowProcCodeSearchAUS width=40%>&nbsp;</td>
    <td width=10%>
      <img src="../images/SearchIcon.gif" class=Icon 
        style='padding-right:5px;'
        onclick='javascript:MiscNextNZP();'>Item Search</td>
    <td width=10%>
      <div id="PrefReqButtonDIV"></div>
    </td>
    <td width=10%>
      <div id="FavButtonDIV"></div>
    </td>
  </tr>

  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td id=ShowProcDescNZ>Description &nbsp;
      <input type=text size=50 name=procdesc id=procdesc
        class="Readonly" readonly
        value="%PATWEB75.01.141">
    </td>
    <td id=ShowProcDescAUS>&nbsp;</td>
    <td>&nbsp;<td>
    <td>&nbsp;<td>
     <td>&nbsp;<td>
  </tr> 
</table>

<table width=100% border=1 cellpadding=2 cellspacing=0>
<tr bgcolor=#CCFFFF>
    <td width=15%><b> Item </b></td>
    <td width=70%><b> Description </b></td>
    <td width=13%><b> Quantity </b></td>
    <td>&nbsp;</td>
</tr>
</table>

<input type=hidden name=gstap000 id=gstap000>
<input type=hidden name=gstcd000 id=gstcd000>
<input type=hidden name=iamnt000 id=iamnt000>
<input type=hidden name=patpr000 id=patpr000>
<input type=hidden name=rebpr000 id=rebpr000>
<input type=hidden name=efdat000 id=efdat000>
<input type=hidden name=sessn000 id=sessn000>
<input type=hidden name=sttim000 id=sttim000>
<input type=hidden name=entim000 id=entim000>
<input type=hidden name=count000 id=count000 value='101'>
<input type=hidden name=refnc000 id=refnc000 maxlength=12 title='Reference'>
<input type=hidden name=camnt000 id=camnt000 maxlength=8 title='Amount'> 

<table width=100% border=0 cellpadding=2 cellspacing=0>
<tr><td width=15%>
 <input type=text size=10 
 maxlength=9
 name=itemn000 id=itemn000 value="%PATWEB75.01.132"
 onblur='GetDesc(document.AddForm.itemn000,
                 document.AddForm.nzdes000,
                 document.AddForm.mdate000,
                 document.AddForm.qunty000,
                 document.AddForm.refnc000,
                 document.AddForm.sessn000,
                 document.AddForm.camnt000,
                 document.AddForm.gstap000,
                 document.AddForm.gstcd000,
                 document.AddForm.iamnt000,
                 document.AddForm.patpr000,
                 document.AddForm.rebpr000,
                 document.AddForm.uniqu000,
                 document.AddForm.sttim000,
                 document.AddForm.entim000);
         ChkClsPrt();
         ChkDesc();'
 title='Item'></td>
<td width=70%>
<input type=text size=110 name=nzdes000 id=nzdes000 maxlength=110 title='Item Description'>
 </td>
<td width=13%>
<input type=text size=7 name=qunty000 id=qunty000 maxlength=4
 title="Quantity" class=Integer min=0 onfocus="defaultQuant()"
 onblur="PostItems();"></td>
<td>&nbsp;</td>
</table>
<table width=100%>
<tr><td align=center>
    <input type=button class=button value="Close" tabindex=-1
     onclick="window.close();">
    <input type=button class=button value="Close & Print" tabindex=-1
     name=clsprtbut id=clsprtbut onclick='PrintItems();'>
    </td></tr>
</table>
</form>

<div id="TableLocation"></div>

<form name=ItemForm id=ItemForm action="patweb71.pbl" method=post
 style="margin:0">
  <input type=hidden name=reportno value="1">
  <input type=hidden name=template value=009>
  <input type=hidden name=updttype value=" ">
  <input type=hidden name=nextpage value="1">
  <input type=hidden name=urnumber value="%PATWEB75.01.003">
  <input type=hidden name=admissno value="%PATWEB75.01.081">
  <input type=hidden name=transnum id=transnum value="%PATWEB75.01.124">
  <input type=hidden name=mschamnt id=mschamnt value="">
  <input type=hidden name=redirect id=redirect value="%PATWEB75.01.001.patweb75.01.007">
</form>

<form name=PatientLinks id=PatientLinks method="get" style="margin:0">
  <input type=hidden name=reportno value="1">
  <input type=hidden name=template value="004">
  <input type=hidden name=urnumber value="%PATWEB75.01.003">
  <input type=hidden name=admissno value="%PATWEB75.01.081">
  <input type=hidden name=MenuType id=MenuType value="%PATWEB75.01.088">
  <input type=hidden name=ckhospid id=ckhospid value="%PATWEB75.01.389">
  <input type=hidden name=casekeys id=casekeys value='%PATWEB75.01.138'>
  <input type=hidden name=uniqueky id=uniqueky value='%PATWEB75.01.139'>
  <input type=hidden name=teamnumb id=teamnumb value='%PATWEB75.01.140'>
</form>

<script type="text/javascript">

 FilterInc="%PATWEB75.01.131";
 for (var i =0 ; i < document.AddForm.incty000.length; i++) {
   if (document.AddForm.incty000.options[i].value==trim(FilterInc)) {
       document.AddForm.incty000.selectedIndex=i;
   }
 }

 if (isWhitespace(document.AddForm.uniqu000.value)) {
   unique="%PATWEB75.01.133";
   document.AddForm.uniqu000.value=unique;
 }

</script>

<span id=PrefReqButtonSPAN style="display:none">
  <input type=button class=Bigbutton value="Pref. Requisitions"
   name=prefreqbutton id=prefreqbutton onclick='PrefReqItems();'>
</span>

<span id=FavButtonSPAN style="display:none">
  <input type=button class=button value="Favourites"
   name=favbutton id=favbutton onclick='FavItems();'>
</span>
