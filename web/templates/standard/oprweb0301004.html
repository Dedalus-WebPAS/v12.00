<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src=../js/TableSort.js></script>
<script type="text/javascript" src=../js/TableBodyHighlight.js></script>
<script type="text/javascript" src=../js/oprweb03.js></script>
<script type="text/javascript">
function TableBody() {
  HighlightAdhocSessions(15);  // Pass column containing Session Status
}
//----------------------------------------------------------------------------
// Columns Available
//  0 - HTML Link   
//  1 - Theatre
//  2 - Session Date & Time
//  3 - Surgeon
//  4 - Anaesthetist
//  5 - Available
//  6 - Booked
//  7 - Actual
//  8 - Graph Use (0-120)
//  9 - Day
// 10 - Unit
// 11 - Over
// 12 - No. Patients
// 13 -
// 14 -
// 15 - Session Status - 0=Cancelled, 1=Active, 2=Active (Extra Session)
//---------------------------------------------------------------------------
function InitTable(TableView) {
document.SelectPeriod.deftview.value=TableView
switch (TableView) {
case 1: {
 t = new Table(1,0,2,"100%","center",35,30);
 if(document.SelectPeriod.dispwkno.value != "1") {
   t.addColumn("Date Time","DateTime",2,2,"left nowrap ","TheatreSessionIcon.gif","0",150)
 } else {
   t.addColumn("Date Time","String",25,2,"left nowrap ","TheatreSessionIcon.gif","0",150)
 }
 t.addColumn("Theatre","String",14,14,"left","","",140)
 t.addColumn("Surgeon","String",3,3,"left","","",110,"","","",23)
 t.addColumn("Anaesthetist","String",4,4,"left","","",110)
 t.addColumn("Status","Graph",8,8,"left","bar1.gif","",120)
 AddTableRows()
 TableOutput(0,1);
 break; }
case 0: {
 t = new Table(1,0,2,"100%","center",35,35);
 if(document.SelectPeriod.dispwkno.value != "1") {
   t.addColumn("Date Time","DateTime",2,2,"left nowrap ","TheatreSessionIcon.gif","0",150)
 } else {
   t.addColumn("Date Time","String",25,2,"left nowrap ","TheatreSessionIcon.gif","0",150)
 }
 t.addColumn("Day","String",9,9,"left","","",25)
 t.addColumn("Theatre","String",1,1,"left","","",30)
 t.addColumn("Surgeon","String",3,3,"left","","",70,"","","",23)
 t.addColumn("Anaesthetist","String",4,4,"left","","",70)
 t.addColumn("Session Type","String",13,13,"left","","",65)
 t.addColumn("Unit","String",10,10,"left","","",80)
 t.addColumn("Avail. Op Min","String",5,5,"right","","",40)
 t.addColumn("Booked Op Min","String",6,6,"right","","",40)
 t.addColumn("Actual Op Min","String",7,7,"right","","",40)
 t.addColumn("% Over","String",11,11,"right","","",40)
 t.addColumn("No. Patients","String",12,12,"right","","",40)
 AddTableRows()
 TableOutput(0,1);
 break; }
case 2: {
 t = new Table(1,0,2,"100%","center",35,35);
 if(document.SelectPeriod.dispwkno.value != "1") {
   t.addColumn("Date Time","DateTime",2,2,"left nowrap ","TheatreSessionIcon.gif","0",150)
 } else {
   t.addColumn("Date Time","String",25,2,"left nowrap ","TheatreSessionIcon.gif","0",150)
 }
 t.addColumn("Theatre","String",1,1,"left","","",30)
 t.addColumn("Surgeon","String",3,3,"left","","",70,"","","",23)
 t.addColumn("Anaesthetist","String",4,4,"left","","",70)
 t.addColumn("Session Type","String",13,13,"left","","",65)
 t.addColumn("Finalisation Date/Time","DateTime",16,16,"left","","",60)
 t.addColumn("Actual Start Date/Time","DateTime",17,17,"left","","",60)
 t.addColumn("Start Delay","String",19,19,"left","","",60)
 t.addColumn("Actual End Date/Time","DateTime",20,20,"left","","",60)
 t.addColumn("End Delay","String",22,22,"left","","",60)
 AddTableRows()
 TableOutput(0,1);
 break; }
 }
}
function frmSubmit() {
 SelectPeriod.submit()
}
function focusonunit(){
 SelectPeriod.unitcode.focus();
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(%OPRWEB03.01.026);
              SetReturnPathCookie();dispDayCmt();focusonunit();">
<div id=HeadingSection>
<form name=SelectPeriod action=oprweb03.pbl method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=4>
<input type=hidden name=viewtype value="%OPRWEB03.01.010">
<input type=hidden name=dispteam value="%OPRWEB03.01.018">
<input type=hidden name=deftview value="">
<input type=hidden name=opcnscom id=opcnscom 
       value="%STANDARD.01.025.042.241.0.1">
<input type=hidden name=dispdayc id=dispdayc
       value="%OPRWEB03.01.023" >
<input type=hidden name=daycmcnt id=daycmcnt
       value="%OPRWEB03.01.024">
<input type=hidden name=currdate id=currdate
       value="%STANDARD.01.015">
<input type=hidden name="dispwkno" id="dispwkno"
       value="%OPRWEB03.01.027">

<table cellpadding=3 cellspacing=0 bgcolor=#CCCCCC border=0 width=100%>
<tr><td>
  <a href=javascript:InitTable(1)>
  <img src=../images/TableViewIcon.gif class=Icon 
  alt="Show Times"></a>
  <a href=javascript:InitTable(0)>
  <img src=../images/TableViewIcon.gif class=Icon 
  alt="Default View"></a>
  <a href=javascript:InitTable(2)>
  <img src=../images/TableViewIcon.gif class=Icon 
  alt="Finalisation View" ></a>
  <input type=button value="<<" class=SmallButton
  onClick='location.href="%OPRWEB03.01.002" +
           "&deftview=" + document.SelectPeriod.deftview.value'>
  %OPRWEB03.01.007
  <input type=button value=">>" class=SmallButton
  onClick='location.href="%OPRWEB03.01.001" +
           "&deftview=" + document.SelectPeriod.deftview.value'>
  &nbsp;&nbsp;  
  Unit
  <select class=PMenuSelectList name=unitcode onchange="frmSubmit()">
  <option value=" ">All Units</option>
    %OPRWEB03.01.015.2
  </select>
  &nbsp;&nbsp;  
  %STANDARD.01.017.YD
  <select class=PMenuSelectList name=surgtype onchange="frmSubmit()">
  <option value="ALL">All</option>
    %OPRWEB03.01.017.2
  </select>
  &nbsp;&nbsp;  
  Session Bookings
  <select class=Select200 name=sessbook onchange="frmSubmit()">
    %OPRWEB03.01.021
  </select>

  </td>

  <!--T0846427-start-->
  <td align=left id="dispdcmmt" style="display:none"><b>Comments for today: </b>
   &nbsp;&nbsp;%OPRWEB03.01.022 </td>
  <td align=left id="dispdcmbt" style="display:none"><b>Comments for today: </b>
      &nbsp;&nbsp; %OPRWEB03.01.022 &nbsp;&nbsp;
       <input type=button name=daycmtbutton id=daycmtbutton 
       class=button value="Day Comments" 
       onClick="DayCommentsUpd(currdate);"></td>
  <!--T0846427-end-->

  <td align=left id="displayrecovery" class="Red Bold Large"></td>
  <td align=right id="recoveryclosed" class="Red Bold Large"></td>
  <td align=right>
  <a href='javascript:SelectDateFrame();'>
  <img src="../images/DateLookup.gif" class=Icon 
   alt="Select Date" ></a>
  <a href='javascript:SelectView("0");'>
  <img src=../images/DayIcon.gif class=Icon
   alt="View Today" ></a>
  <a href='javascript:SelectView("1");'>
  <img src=../images/WeekIcon.gif class=Icon 
   alt="View This Week"></a>
  <a href='javascript:SelectView("2");'>
  <img src=../images/MonthIcon.gif class=Icon 
   alt="View This Month"></a>
</td></tr>
</table>
</form>
</div>
<div id=TableLocation></div>
<script type="text/javascript">
function AddTableRows() {
%OPRWEB03.01.019.oprweb01.03.003
}
document.getElementById('displayrecovery').innerHTML="";
if(SelectPeriod.surgtype.value!="ALL") {
  if(SelectPeriod.surgtype.value.substr(14,1)=="F") {
    document.getElementById('displayrecovery').innerHTML="RECOVERY FULL";
  }
}
RecoveryClosed="%OPRWEB03.01.020";
if(RecoveryClosed == "1") {
  document.getElementById('recoveryclosed').innerHTML="RECOVERY CLOSED";
  document.getElementById('recoveryclosed').className="Red Bold Large";
} else if(RecoveryClosed == "2") {
  document.getElementById('recoveryclosed').innerHTML="RECOVERY CLOSED";
  document.getElementById('recoveryclosed').className="Orange Bold Large";
}

</script>

