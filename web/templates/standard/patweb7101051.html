<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script  type="text/javascript">

function UpdPayerInv() {

   document.UpdateForm.redirect.value="patweb71.pbl?reportno=01&template=050"
   + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
   + "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+")
   + "&chngdate=" + document.UpdateForm.chngdate.value.replace(/ /g,"+")
   + "&invtodat=" + document.UpdateForm.chngdate.value.replace(/ /g,"+")
   + "&showpayr=1"
   + "&nextpage=5"

  document.UpdateForm.updatety.value="1";
  document.UpdateForm.submit();
}

function TotalsMax(theForm,maxamnt,dayamnt,counter,itemcode,invamnt) {

    if ((dayamnt!=undefined) && (maxamnt!=undefined)) {
      if ((!checkNumber(maxamnt,maxamnt.title)) &&
          (!checkNumber(dayamnt,dayamnt.title))) { return };
    }

    var total1 = 0.00 ;

  for(var e = 0; e < theForm.elements.length; e++) {
    var el=theForm.elements[e] ;
    if(!isWhitespace(el.value) && !isNaN(el.value)) {
      if(el.id.match(/mxbil/)) {
        total1+=(parseFloat(el.value,10));
      }
    }
  }

  theForm.totalmax.value=total1
  RoundNumber(theForm.totalmax,2);

  if (!isWhitespace(dayamnt.value)) {
      if (parseFloat(dayamnt.value)>parseFloat(maxamnt.value)) {
    alert("Maximum Billing Period can not be Less than Per Day Amount.");
        maxamnt.value=0.00;
        document.UpdateForm[maxamnt.name].blur()
        document.UpdateForm[maxamnt.name].select()
        return false
      } 

      maxday=parseFloat(dayamnt.value)*100;
      maxbil=parseFloat(maxamnt.value)*100;
      divided=maxbil.toFixed(0)%maxday.toFixed(0);
      if (divided>0) {
        alert("Maximum Billing Period must be Multiple of Per Day Amount.");
        maxamnt.value=0.00;
        document.UpdateForm[maxamnt.name].blur()
        document.UpdateForm[maxamnt.name].select()
        return false
      }

   }

  RoundNumber(maxamnt,2);
  RoundNumber(dayamnt,2);

  ThisInvoice(theForm,maxamnt,dayamnt,counter,itemcode,invamnt);

  return true
}


function TotalsDay(theForm,maxamnt,dayamnt,counter,itemcode,invamnt) {

    if ((dayamnt!=undefined) && (maxamnt!=undefined)) {
      if ((!checkNumber(maxamnt,maxamnt.title)) &&
          (!checkNumber(dayamnt,dayamnt.title))) { return };
    }

    var total1 = 0.00 ;

  for(var e = 0; e < theForm.elements.length; e++) {
    var el=theForm.elements[e] ;
    if(!isWhitespace(el.value) && !isNaN(el.value)) {
      if(el.id.match(/mxday/)) {
        total1+=(parseFloat(el.value,10));
      }
    }
  }
  theForm.totalpday.value=total1
  RoundNumber(theForm.totalpday,2);

   if (!isWhitespace(maxamnt.value)) {
    if (maxamnt.value!=0.00) {
      if (parseFloat(dayamnt.value)>parseFloat(maxamnt.value)) {
    alert("Per Day Amount can not be greater than Maximum Billing Period.");
        dayamnt.value=0.00;
        document.UpdateForm[dayamnt.name].blur()
        document.UpdateForm[dayamnt.name].select()
        return false
      } 
     }

      maxday=parseFloat(dayamnt.value)*100;
      maxbil=parseFloat(maxamnt.value)*100;
      divided=maxbil.toFixed(0)%maxday.toFixed(0);
      if (divided>0) {
        alert("Per Day Amount must be Multiple of Maximum Billing Period.");
        dayamnt.value=0.00;
        document.UpdateForm[dayamnt.name].blur()
        document.UpdateForm[dayamnt.name].select()
        return false
      }

   }

 RoundNumber(maxamnt,2);
 RoundNumber(dayamnt,2);

 ThisInvoice(theForm,maxamnt,dayamnt,counter,itemcode,invamnt);

 return true
}

function ThisInvoice(theForm,maxamnt,dayamnt,counter,itemcode,invamnt) {

  if (checkNumber(document.UpdateForm.totalinva.value)) {
    document.UpdateForm.totalinva.value = 
         parseFloat(document.UpdateForm.totalinva.value) -
         parseFloat(invamnt.value)
  }

  var serverURL = "../cgi-bin/patweb71.pbl?reportno=17" +
            "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+")
          + "&maxibill=" + maxamnt.value
          + "&maxidayb=" + dayamnt.value
          + "&itemcode=" + itemcode.value
          + "&linenumb=" + counter
          + "&pmpyr003=" + document.UpdateForm.pmpyr003.value.replace(/ /g,"+")
          + "&pmpyr018=" + document.UpdateForm.pmpyr018.value.replace(/ /g,"+");

  var returnValue = RSExecute(serverURL);    //Remote Script To get inv.amount

  if (returnValue.status==0) {
   ReturnValue=returnValue.return_value.split("|")
   invamnt.value=ReturnValue[0];
  }
  RoundNumber(invamnt,2);

   document.UpdateForm.totalinva.value = 
         parseFloat(document.UpdateForm.totalinva.value) +
         parseFloat(invamnt.value)
   RoundNumber(theForm.totalinva,2);

}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">

<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Payer Breakdown
</span>

<form name=UpdateForm method=post action=patweb71.pbl style="margin:0">
    <input type=hidden name=reportno value="18">
    <input type=hidden name=template value="051">
    <input type=hidden name=updttype value="B">
    <input type=hidden name=urnumber value="%PATWEB71.01.003">
    <input type=hidden name=admissno value="%PATWEB71.01.081">
    <input type=hidden name=pmpyr001 value="%PATWEB71.01.003">
    <input type=hidden name=pmpyr003 value="%PATWEB71.01.391.1.1">
    <input type=hidden name=pmpyr018 value="%PATWEB71.01.391.2">
    <input type=hidden name=ptrgm001 value="%PATWEB71.01.391.4">
    <input type=hidden name=nextpage value=5>
    <input type=hidden name=showpayr value="%PATWEB71.01.393">
    <input type=hidden name=redirect value="">
    <input type=hidden name=updatety value="">
    <input type=hidden name=chngdate value="%PATWEB71.01.327">

<table align=center width=100% border=0>
<tr><td>
<table align=center cellspacing=2 cellpadding=1 width=90% border=0>

<tr><td width=25% class=DataLabel>Name</td>
    <td width=40%class=DataField>%PATWEB71.01.391.3</td>
    <td width=10% class=DataLabel>Default</td>
    <td class=DataField>%PATWEB71.01.391.5</td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td class=DataField>%PATWEB71.01.391.1.0</td>
    <td width=10% class=DataLabel>Counter</td>
    <td class=DataField>%PATWEB71.01.391.6</td></tr>

<tr><td colspan=5><hr></td></tr>
</table>

<table align=center cellspacing=2 cellpadding=1 width=90% border=0>
%PATWEB71.01.392
</table>

<table cellspacing=2 cellpadding=1 width=90% border=0>
<tr><td align=center  colspan=2><br>
    <input type=button value="Update" class="button" name=updbuttn
     onclick="tempDisable(this);UpdPayerInv();">
    <input type=button value="Cancel" class="button" 
     onclick="DFrameClose();"></td></tr>
</table>

</td></tr>
</table>
</form>

