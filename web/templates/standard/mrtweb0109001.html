<meta name="TemplateVersion" content="V12.00.01">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/mrtweb01.js"></script>
<script type="text/javascript" src="../js/mrtweb0109.js"></script>
<script type="text/javascript" src="../js/MrtLocations.js"></script>
<script type="text/javascript" src="../js/MrtMultiLocations.js"></script>
<script type="text/javascript" src="../js/MrtHomeLocns.js"></script>
<script type="text/javascript" src="../js/MrtMultiHomeLocns.js"></script>
<script type="text/javascript" src="../js/mrtweb0109001.js"></script>
<script type="text/javascript">
function OutputTable(ReturnCode) {
  p=document.AddForm;
  if(!ValidateRetention(p.URNumber,p.mrtme019,p.mrtme003)){
     document.AddForm.URNumber.value="";
     document.AddForm.URNumber.focus();
     return;
  }
  if (isWhitespace(AddForm.mrtme003.value)) {
    c=c+1
    if (c==1) {
    alert("Destination is required !");
    c=c+1
    }
    AddForm.mrtme003.focus();
    AddForm.URNumber.value="";
    return;
  }
  if (ItemCnt>=99) {
    alert("Page Limit Reached");
    return;
  }
  var MrKeyRecord="";
  var PatientName="";
  var CurrentHosp="";
  var CurrentLoct="";
  var LastMovDate="";
  var Description="";
//
  var patname=new Object();
  var Merged=new Object();
  var Mergedur=new Object();
  var mrrecord=new Object();
  var mrtscanur=new Object();
  mrtscanur.value=ReturnCode.value.substring(0,8);
  validateCodeMerge(28,mrtscanur,patname,Merged,Mergedur,mrrecord);
  if (patname.value!="") {
    if (Merged.value=="1") {
      alert("Warning : This U/R Number is merged with " + Mergedur.value);
      ReturnCode.value="";
      return
    }
  }
//
  var Flag=0;
  if(parseInt(AddForm.mrcntday.value,10)>0) {
     DisplayTrackingAlert(AddForm.mrtme019,AddForm.mrtme003.value,ReturnCode,AddForm.osreqtxt,AddForm.osreqcls);
  }

  var visitnop = "";
  if (VariableNameExists('MRTVisitNoonBulkRecMovement')) {
    if (MRTVisitNoonBulkRecMovement == true) {
      if (p.visitnum !=undefined) {
        visitnop = "&visitnum=" + p.visitnum.value.replace(/ /g,"+")
      }
    }
  }

  var serverURL = "../cgi-bin/mrtweb01.pbl?reportno=14" +
                  "&mrkeyarr=" + ReturnCode.value.replace(/ /g,"+") +
                  "&docmtype=" + AddForm.mrtme010.value.replace(/ /g,"+") +
                  "&volumeno=" + AddForm.mrtme011.value.replace(/ /g,"+") +
                  "&mrtme001=" + AddForm.mrtme001.value.replace(/ /g,"+") +
                  "&mrtme002=" + AddForm.mrtme002.value.replace(/ /g,"+") +
                  "&mrtme019=" + AddForm.mrtme019.value.replace(/ /g,"+") +
                  "&mrtme003=" + AddForm.mrtme003.value.replace(/ /g,"+") +
                  "&homehosp=" + AddForm.mrtme020.value.replace(/ /g,"+") +
                  "&location=" + AddForm.mrtme017.value.replace(/ /g,"+") +
                  "&disamrec=" + AddForm.disamrec.value.replace(/ /g,"+") +
                  visitnop
  if(p.fullflag.value=="1"){
    var serverURL = "../cgi-bin/mrtweb01.pbl?reportno=14" +
                  "&mrkeyarr=" + ReturnCode.value.replace(/ /g,"+") +
                  "&volumeno=" + AddForm.mrtme011.value.replace(/ /g,"+") +
                  "&mrtme001=" + AddForm.mrtme001.value.replace(/ /g,"+") +
                  "&mrtme002=" + AddForm.mrtme002.value.replace(/ /g,"+") +
                  "&mrtme019=" + AddForm.mrtme019.value.replace(/ /g,"+") +
                  "&mrtme003=" + AddForm.mrtme003.value.replace(/ /g,"+") +
                  "&homehosp=" + AddForm.mrtme020.value.replace(/ /g,"+") +
                  "&location=" + AddForm.mrtme017.value.replace(/ /g,"+") +
                  "&disamrec=" + AddForm.disamrec.value.replace(/ /g,"+") +
                  visitnop
  }
  var returnValue = RSExecute(serverURL);
  ReturnValue=returnValue.return_value.split("|");
  if (returnValue.status==0) {

    if (ReturnValue[0]=="allmedicalrecords") {return;}

    ItemCnt++
//
//  Check for an already entered U/R
//
   barcodeInput = false;
   if (document.AddForm.RecordKey != undefined) {
     if (!isWhitespace(document.AddForm.RecordKey.value)) {
       barcodeInput = true;
     }
   }
   if (barcodeInput == false){
    for (var i=0; i < document.AddForm.length; i++) {
      if (document.AddForm.elements[i].name.match(/mrkeyarr/)) {
        enterur=ReturnValue[0].substring(0,8);
        checkey=document.AddForm.elements[i].value.substring(0,8);
        if (enterur == checkey) {
          alert("Warning: U/R already entered!");
          document.AddForm.URNumber.value="";
          document.AddForm.URNumber.focus();
          break; } } }
    }

//  Check for an already scanned medical record barcode
//
    if (barcodeInput == true){
    for (var i=0; i < document.AddForm.length; i++) {
      if (document.AddForm.elements[i].name.match(/mrkeyarr/)) {
        enterbarcode=ReturnValue[0];
        checkey=document.AddForm.elements[i].value;
        if (trim(enterbarcode) == trim(checkey)) {
          alert("Warning: Barcode already entered!");
          document.AddForm.RecordKey.value="";
          document.AddForm.RecordKey.focus();
          break; } } }
    }

//
//  Check for an already entered Visit Number
//
  for (var i=0; i < document.AddForm.length; i++) {
    if (document.AddForm.elements[i].name.match(/volumenu/)) {
      entervol=ReturnValue[30];                   //Entered Visit Number
      checkey=document.AddForm.elements[i].value; //V/N for retrived Docs
      if (entervol == checkey) {
        alert("Warning: Record already entered!");
        document.AddForm.URNumber.value="";
        document.AddForm.URNumber.focus();
        return; } } }
//
// Note CheckLoc accepts first parameter as an object so using obj mrtkey!!
//
    var mrtkey=new Object();
    mrtkey.value=ReturnValue[0].replace(/\+/g," ");
    filreqed=ReturnValue[18];
    if(parseInt(AddForm.mrcntday.value,10)>0) {

      if (document.AddForm.locatype.value == 'V') {
        AddOutputArrayReq(ReturnValue[0],ReturnValue[1],ReturnValue[2],
                        ReturnValue[3],ReturnValue[4],ReturnValue[5],
                        AddForm.osreqtxt,AddForm.osreqcls,ReturnValue[30],
                        ReturnValue[28],ReturnValue[32])
      } else {
        if (document.AddForm.locatype.value == 'M') {
          AddOutputArrayReq(ReturnValue[0],ReturnValue[1],ReturnValue[2],
                        ReturnValue[3],ReturnValue[4],ReturnValue[5],
                        AddForm.osreqtxt,AddForm.osreqcls,ReturnValue[30],
                        ReturnValue[29],ReturnValue[32])
        } else {
          AddOutputArrayReq(ReturnValue[0],ReturnValue[1],ReturnValue[2],
                        ReturnValue[3],ReturnValue[4],ReturnValue[5],
                        AddForm.osreqtxt,AddForm.osreqcls,ReturnValue[30],
                        null,ReturnValue[32])
        }
      }
      var Volmlist = ReturnValue[31].split(",");
      for (var i=0;i<Volmlist.length;i++) {
         if(Volmlist[i].trim().length>0) {
           if (document.AddForm.locatype.value == 'V') {
              AddOutputArrayReq(ReturnValue[0],ReturnValue[1],ReturnValue[2],
                              ReturnValue[3],ReturnValue[4],ReturnValue[5],
                              AddForm.osreqtxt,AddForm.osreqcls,ReturnValue[30],
                              ReturnValue[28],Volmlist[i].trim(),
                              ReturnValue[32]);
           } else {
              if (document.AddForm.locatype.value == 'M') {
                AddOutputArrayReq(ReturnValue[0],ReturnValue[1],ReturnValue[2],
                             ReturnValue[3],ReturnValue[4],ReturnValue[5],
                             AddForm.osreqtxt,AddForm.osreqcls,ReturnValue[30],
                             ReturnValue[29],Volmlist[i].trim(),
                             ReturnValue[32])
           } else {
                AddOutputArrayReq(ReturnValue[0],ReturnValue[1],ReturnValue[2],
                             ReturnValue[3],ReturnValue[4],ReturnValue[5],
                             AddForm.osreqtxt,AddForm.osreqcls,ReturnValue[30],
                             null,Volmlist[i].trim(),
                             ReturnValue[32])
            }
          }
        }
      }
      OutputDivisionReq()

    } else {

      if (document.AddForm.locatype.value == 'V') {
         AddOutputArray(ReturnValue[0],ReturnValue[1],ReturnValue[2],
                  ReturnValue[3],ReturnValue[4],ReturnValue[5],
                  ReturnValue[30],ReturnValue[28],ReturnValue[32])
      } else {
        if (document.AddForm.locatype.value == 'M') {
          AddOutputArray(ReturnValue[0],ReturnValue[1],ReturnValue[2],
                  ReturnValue[3],ReturnValue[4],ReturnValue[5],
                  ReturnValue[30],ReturnValue[29],ReturnValue[32])
        } else {
         AddOutputArray(ReturnValue[0],ReturnValue[1],ReturnValue[2],
                     ReturnValue[3],ReturnValue[4],ReturnValue[5],
                     ReturnValue[30],null,ReturnValue[32])
        }
      }
      OutputDivision()
    }

    AlertErrors(ReturnValue[6],ReturnValue[8],ReturnValue[9],ReturnValue[10],
                ReturnValue[11],ReturnValue[12],ReturnValue[13],ReturnValue[14],
                ReturnValue[15],ReturnValue[16],ReturnValue[0],ReturnValue[17],
                ReturnValue[20],ReturnValue[21],ReturnValue[22],ReturnValue[23],
                ReturnValue[24],ReturnValue[25],ReturnValue[26]);

    if (filreqed=="Y") {
      CheckLoc(mrtkey,AddForm);   // Check for Outstanding Filing?
    }
    ReturnCode.value="";
    ReturnCode.focus();
    if (!isWhitespace(document.AddForm.mrtme011.value)){
      document.AddForm.mrtme011.value=""; }
  }
  else {
    ReturnCode.focus();
    ReturnCode.value="";
    if (!isWhitespace(document.AddForm.mrtme011.value)){
      document.AddForm.mrtme011.value=""; }
    ReturnCode.select();  }
}
function SetReq() {
  SetHospital(AddForm);
  SetDestination(AddForm);
  SetHomeHosp(AddForm);
  SetHomeLocn(AddForm);
  if (document.AddForm.requtype.value=="1") {
    RequestType.innerHTML=ReqFree.innerHTML;
  } else {
    RequestType.innerHTML=ReqSelect.innerHTML;
  }

  if (document.AddForm.superlev.value=="2" &&
      document.AddForm.ibcnmhos.value=="1") {
    var option = document.createElement("option");
    option.text = "All";
    option.value= "   ";
    document.AddForm.mrtme020.add(option);
  }

}
function doMove()                                                   
{                                                                   
  if (!verifyDueDate()) return  false;                              
  AddMovRecord();
} 
function doCont()                                                   
{                                                                   
  if (!verifyDueDate()) return  false;                              
  ConMovRecord();
} 

function getMedicalRecord() {
  if (isWhitespace(document.AddForm.mrtme020.value) &&
      document.AddForm.ibcnmhos.value=="1") {
    getAllMedicalRecords();
  } else {
    SetUrEvent();
  }
}


function getAllMedicalRecords() {

  var defaulturnumber = " ";

  if (event.keyCode!=13 && event.keyCode!=9) {
    return;
  }

  if (isWhitespace(document.AddForm.URNumber.value)) {
    return;
  }

  defaulturnumber = document.AddForm.URNumber.value;

  for (x=0; x<document.AddForm.mrtme020.length; x++) {
    document.AddForm.mrtme020.selectedIndex=x;
    if (!isWhitespace(document.AddForm.mrtme020.value)) {
      SetHomeLocn(AddForm);
      for (y=0; y<document.AddForm.mrtme017.length; y++) {
        document.AddForm.mrtme017.selectedIndex=y;
        if (!isWhitespace(document.AddForm.mrtme017.value)) {
          SetUrEvent();
          document.AddForm.URNumber.value = defaulturnumber;
//          alert();
        }
      }
    }
  }

//
  twoforloops:
  for (x=0; x<document.AddForm.mrtme020.length; x++) {
    if (!isWhitespace(document.AddForm.mrtme020[x].value)) {
      document.AddForm.mrtme020.selectedIndex=x;
      SetHomeLocn(AddForm);
      for (y=0; y<document.AddForm.mrtme017.length; y++) {
        if (!isWhitespace(document.AddForm.mrtme017[y].value)) {
          document.AddForm.mrtme017.selectedIndex=y;
          break twoforloops;
        }
      }
    }
  }
//
}
function SearchPatient() {
  if (!isWhitespace(document.AddForm.mrtme020.value)) {
    if (!validateMandatory(AddForm)) {return;}
  }
  PatientSearchFrame(AddForm.d1,AddForm.URNumber,AddForm.d2,SendFormWait);
}
function SendFormWait() {
//  setInterval('OutputTable(AddForm.URNumber)',600);

  var defaulturnumber = " ";

  if (!isWhitespace(document.AddForm.mrtme020.value) ||
       document.AddForm.ibcnmhos.value!="1") {
//    document.AddForm.disamrec.value=" ";
    OutputTable(AddForm.URNumber);
  } else {

//    document.AddForm.disamrec.value="1";
    defaulturnumber = document.AddForm.URNumber.value;

    for (x=0; x<document.AddForm.mrtme020.length; x++) {
      document.AddForm.mrtme020.selectedIndex=x;
      if (!isWhitespace(document.AddForm.mrtme020.value)) {
        SetHomeLocn(AddForm);
        for (y=0; y<document.AddForm.mrtme017.length; y++) {
          document.AddForm.mrtme017.selectedIndex=y;
          if (!isWhitespace(document.AddForm.mrtme017.value)) {
            OutputTable(AddForm.URNumber);
            document.AddForm.URNumber.value = defaulturnumber;
//            alert();
          }
        }
      }
    }

    twoforloops:
    for (x=0; x<document.AddForm.mrtme020.length; x++) {
      if (!isWhitespace(document.AddForm.mrtme020[x].value)) {
        document.AddForm.mrtme020.selectedIndex=x;
        SetHomeLocn(AddForm);
        for (y=0; y<document.AddForm.mrtme017.length; y++) {
          if (!isWhitespace(document.AddForm.mrtme017[y].value)) {
            document.AddForm.mrtme017.selectedIndex=y;
            break twoforloops;
          }
        }
      }
    }
  }
}

function VisitNoChange() {
  f = document.AddForm;
  if (isWhitespace(f.visitnum.value)) {return;}
  if (!validateMandatory(f)) {
    f.visitnum.value = "";
    return;
  }

  var serverURL = "../cgi-bin/comweb81.pbl?reportno=42" +
                  "&valdcode=" + f.visitnum.value.replace(/ /g,"+");
  var returnValue = RSExecute(serverURL);
  if (returnValue.status!=0) {
    f.visitnum.value = "";
    return;
  }

  ReturnValue=returnValue.return_value.split("|");
  f.URNumber.value = ReturnValue[0]
//  if(f.fullflag!=undefined){
//    f.fullflag.value="1";
//  }
  FormatURScan(f.URNumber);
  FormatURScanMrtLf(f.URNumber);
  validateRecordID();
  setTimeout('document.AddForm.URNumber.focus()',100);
  f.visitnum.value = ""; 
}

</script>

</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitPageLayout();setTimeout('SetReq()',100);">

<div id=HeadingDivision>
  <table border=0 align=center width=100% cellpadding=0 cellspacing=0
         style="table-layout:fixed">
    <tr><td class=HeadingCell align=center>Record Movement</td></tr>
  </table>
</div>

<div id=BodyDivision>
<form name=AddForm method=post action=mrtweb01.pbl style="margin:0">
<input type=hidden name=reportno value="9">
<input type=hidden name=template value="001">
<input type=hidden name=updttype value="A">
<input type=hidden name=nextpage value="">
<input type=hidden name=urnumber value="%MRTWEB01.09.111">
<input type=hidden name=Mergedur value="">
<input type=hidden name=Merged value="">
<input type=hidden name=mrrecord value="">
<input type=hidden name=requtype value="%MRTWEB01.09.129">
<input type=hidden name=mrcnwnhl value="%MRTWEB01.09.305">
<input type=hidden name=mrcnibap value="%STANDARD.01.025.097.165.0.1">
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=wbsehosp value="%STANDARD.01.032">
<input type=hidden name=mrcnlzer value="%STANDARD.01.025.097.168.0.1">
<input type=hidden name=mrcntday value="%STANDARD.01.025.097.170.0.2">
<input type=hidden name=osreqtxt value="">
<input type=hidden name=osreqcls value="">
<input type=hidden name=locatype value="">
<input type=hidden name=desthosp value="%MRTWEB01.09.137.0">
<input type=hidden name=destlocn value="%MRTWEB01.09.137.1">
<input type=hidden name=dflthosp value="%MRTWEB01.09.137.0">
<input type=hidden name=defllocn value="%MRTWEB01.09.137.1">
<input type=hidden name=dfltlocn value="%MRTWEB01.09.137.1">
<input type=hidden name=superlev value="%MRTWEB01.09.207">
<input type=hidden name=disamrec value=" ">

<table border=0 align=center width=90% cellpadding=1 style="table-layout:fixed">
    <tr><td class=DataLabel>Movement Date</td>
        <td><input type=text size=12 name=mrtme001 id=mrtme001
                   class="Mandatory Date" title="Movement Date"
                   value="%STANDARD.01.015" onblur='AlertDate(this);'>
              <img notab src="../images/DateLookup.gif" border=0 hspace=4
                   align=absmiddle onclick="DateLookupFrame(mrtme001);">
            <input class=Mandatory type=text name=mrtme002 id=mrtme002
                   size=8 value="%STANDARD.01.016" title="Time">
              <img notab src="../images/DateTimeStamp.gif" class=Icon
                   onclick="SetCurrentDateTime(mrtme001,mrtme002);">
              <img notab src="../images/TimeLookup.gif" class=Icon
                   onclick="TimeLookupFrame(mrtme002);"></td>
        <td>Requested By</td>
        <td><div id=RequestType></div></td></tr>

    <tr><td class=DataLabel><div id=HospitalTitle></div></td>
        <td><div id=Hospital></div></td>
        <td>Destination</td>
        <td><input type=hidden name=d_mrtme003 id=d_mrtme003
             value="%MRTWEB01.09.201.3">
            <select name=mrtme003 id=mrtme003 class="Mandatory"
             title="Destination"
             onchange="CheckLocType();">
              <option></option>
            </select></td></tr>

    <tr><td>Reason</td>
        <td><select name=mrtme005 id=mrtme005 title="Reason" class=Mandatory
                    onchange='DueDateMand(this);'>
             <option></option>
              %MRTWEB01.09.204.2
            </select></td>
        <td>Due Date</td>
        <td><input type=text name=mrtme007 id=mrtme007 size=12
                   class="Mandatory Date" title="Due Date" value=""
                   onblur="TextBlurHandler(this);verifyDueDate();">
              <img notab src="../images/DateLookup.gif" class=Icon
                   onclick="DateLookupFrame(mrtme007);"></td></tr>
    <tr><td>Document Type</td>
        <td><select name=mrtme010 id=mrtme010 class=Mandatory
              title="Document Type">
             <option></option>
              %MRTWEB01.09.202.2
            </select></td>
        <td>Ignore Incomplete Coding</td>
        <td><input type=checkbox name=ignorcod id=ignorcod
                   title="Ignore Icomplete Coding"></td></tr>

    <tr><td class=DataLabel>Extension #</td>
        <td><input type=text name=mrtme013 id=mrtme013 size=15 maxlength=20
                   title="Extension"></td>
        <td class=DataLabel>Pager #</td>
        <td><input type=text name=mrtme014 id=mrtme014 size=15 maxlength=20
                   title="Pager Number"></td></tr>

    <tr><td class=DataLabel>Movement Comments</td>
        <td><input type=text name=mrtme018 id=mrtme018 size=50 maxlength=50
                   title="Movement Comments"></td>
        <td colspan=2>&nbsp;</td></tr>

    <tr><td colspan=4 align=center><hr></td></tr>

    <tr><td class=DataLabel><div id=HomeHospTitle></div></td>
        <td><div id=HomeHosp></div></td>
        <td>Home Location</td>
        <td><select name=mrtme017 id=mrtme017 class=Mandatory
             title="Home Location"
                    onchange="ResetHomeLocn(AddForm);">
              <option></option>
            </select></td></tr>

    <tr><td>U/R Number</td>
        <td><input type=text name=URNumber id=URNumber title="UR"
                   onkeydown="getMedicalRecord();">
            <input type=hidden name=d1 id=d1>
            <input type=hidden name=d2 id=d2>
            <input type=hidden name=mrtme011 id=mrtme011>
              <img src="../images/SearchIcon.gif" class=Icon notab
                   onclick="SearchPatient();">
        <td>Medical Record Scan</td>
        <td><input type=text name=RecordKey id=RecordKey maxlength=22 size=30
                   onfocus="CheckMaxLength(this);"
                   onkeydown="SetMedEvent();" title="Record Key">
            <input type=hidden name=fullflag id=fullflag></td></tr>
    <tr id=VistNumber><td>Visit Number</td>
        <td><input type=text name=visitnum id=visitnum
             title="Visit Number" maxlength=8
             onchange="VisitNoChange();">
        </td>
    </tr>

    <tr><td><div id=locationtype></div></td>
        <td><div id=locationdesc></div></td>
        <td><div id=clearlocation></div></td>
    </tr>

  </table>
  <div id=Results></div>
  <table border=0 align=center width=90% cellspacing=1>
    <tr><td align=center><br>
            <input type=button name=movebutn id=movebutn value="Move"
                   class="button" onclick="tempDisable(this);doMove()">
            <input type=button name=contbutn id=contbutn value="Continue"
                   class="button" onclick="tempDisable(this);doCont()">
            <input type=button value="Clear" class="button"
                   onclick="location.reload()">
            <input type=button value="Cancel" class="button"
                   onclick="history.go(-1)"></td></tr>
  </table>
 </form>
</div>

<span id=ReqFree style="display:none">
   <input type=text name=mrtme016 id=mrtme016 size=35 maxlength=35
          title="Requested By" value="%STANDARD.01.009">
</span>

<span id=ReqSelect style="display:none">
   <select name=mrtme016 id=mrtme016 title="Requested By">
     <option></option>
      %MRTWEB01.09.130
   </select>
</span>

<span id=ShowHospitalTitle style="display:none">
  Hospital
</span>

<span id=ShowHospital style="display:none">
   <select name=mrtme019 id=mrtme019 title="Hospital" class="Mandatory"
           onchange="SetDestination(AddForm);">
    %MRTWEB01.09.307
   </select>
</span>

<span id=ShowNoHospital style="display:none">
   <input type=hidden name=mrtme019 id=mrtme019 value="    ">
</span>

<span id=ShowHomeHospTitle style="display:none">
  Home Hospital
</span>

<span id=ShowHomeHosp style="display:none">
   <select name=mrtme020 id=mrtme020 title="Home Hospital" class="Mandatory"
           onchange="SetHomeLocn(AddForm);">
     %MRTWEB01.09.309
   </select>
</span>

<span id=ShowNoHomeHosp style="display:none">
   <input type=hidden name=mrtme020 id=mrtme020 value="    ">
</span>

<span id=InputVol style="display:none">
   <input type=text size=20 maxlength=20 name=volmcomm id=volmcomm
     value="" title="Volume Comments" onchange="Clearbox();">
</span>

<span id=InputFilm style="display:none">
   <input type=text size=25 maxlength=25 name=micrfilm id=micrfilm
     value="" title="Microfilm" onchange="Clearbox();">
</span>

<span id=InputClear style="display:none">
    <input type=checkbox name=clearcom id=clearcom value="1"
     title="Clear Comments" onblur="ClearComm();">
    Clear Comments
</span>

<script type="text/javascript">
if (VariableNameExists('MRTVisitNoonBulkRecMovement')) {
  if (MRTVisitNoonBulkRecMovement == true) {
    document.getElementById('VistNumber').style.display = "";
  }
  else {
    document.getElementById('VistNumber').style.display = "none";
  }
}
</script>
