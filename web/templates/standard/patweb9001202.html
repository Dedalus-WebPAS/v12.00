<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript" src="../js/patweb90.js"></script>
<script type="text/javascript" src="../js/patweb69.js"></script>
<style type=text/css>
#HeadingDivision {
 overflow:hidden;
}
#HeadingDivision TABLE {
  border:0;
}
#BodyDivision TABLE {
  border:0;
}
#HeadingDivision TABLE TD{
  border:0;
  border-right:1px solid silver;
}
#BodyDivision {
  overflow:auto;
}
#BodyDivision TABLE TD{
  border:0;
  padding:0;
  border-right:1px solid silver;
  border-bottom:1px solid silver;
  background-color:white;
}
#BodyDivision TABLE TD TD{
  border:0;
  padding:0;
}
</style>

<script type="text/javascript">

function getPortalCookie() {
  if (GetCookieData("sjogwaPortalCOOKIE") != 'unknown') {
    ExpireCookiePath("sjogwaPortalCOOKIE");
    sjogprtl = "1";
  }
}

var sjogprtl = "";
getPortalCookie();

function checkUR() {
  if (document.search.aisearch.value > 1) {
    return; 
  }
  if (!isWhitespace(search.urnumber.value)) {
    validateCode(8,search.urnumber,search.patfname);
    linkForm.template.value="1";
    linkForm.urnumber.value=search.urnumber.value;
    linkForm.admissno.value="";
    linkForm.target="content";
    linkForm.submit();
  }
}
function ProcessSubmit() {
  var p = document.search;
  if (p.ptcnuepm.value == "1") {
    p.showblhd.value = "1";  // show LHD search button on submit return
  }

  var admisnid = getQueryString('admisnid');
  p.admisnid.value=admisnid.replace(/\+/g," ");
  Registration.admisnid.value=admisnid.replace(/\+/g," ");

  var erefrlid = getQueryString('erefrlid');
  p.erefrlid.value=erefrlid.replace(/\+/g," ");
  Registration.erefrlid.value=erefrlid.replace(/\+/g," ");

  setUR();

  if (sjogprtl == "1") {
    SetCookie("sjogwaPortalCOOKIE","");
  }

  if (p.aisearch.value > 1) {
    return true;
  }

  if (!isWhitespace(document.search.srchmedi.value)) {
    if (document.search.srchmedi.value.replace(/ /g,"").length < "8") {
        alert("First 8 characters of Medicare No. must be entered");
        return false;
  }}

  if (!isWhitespace(p.urnumber.value)) {
    checkUR();
    return false;
  } else {
    p.srchsnam.value.replace(/\'/g,"~");
    checkDate(p.srchpdob,'Date of Birth');
    setBirth(p.srchpdob);
    setMedicare(p.srchmedi);
    return true;
  }
}
function UpCase(str) {
  str.value=str.value.toUpperCase();
}
function newreg() {
  Registration.srchsnam.value=document.search.srchsnam.value;
  Registration.srchgnam.value=document.search.srchgnam.value;
  Registration.srchpage.value=document.search.srchpage.value;
  Registration.srchpdob.value=document.search.srchpdob.value;
  Registration.srchmedi.value=document.search.srchmedi.value;
  var admisnid = getQueryString('admisnid');
  Registration.admisnid.value=admisnid.replace(/\+/g," ");
  var erefrlid = getQueryString('erefrlid');
  Registration.erefrlid.value=erefrlid.replace(/\+/g," ");
  for (var i =0 ; i < document.search.srchpsex.length; i++) {
    if (document.search.srchpsex[i].checked=="1" ) {
      Registration.srchpsex.value=document.search.srchpsex[i].value;
    }
  }

  if (sjogprtl == "1") {
    SetCookie("sjogwaPortalCOOKIE","");
  }

  Registration.target="content";
  Registration.submit();
}
function updateParent(fpatname,urnumber,admissno) {
  linkForm.urnumber.value=urnumber;
  linkForm.admissno.value="";
  linkForm.target="content";
  
  DFrameExit();
  var admisnid = getQueryString('admisnid');
  var erefrlid = getQueryString('erefrlid');

  if (sjogprtl == "1") {
    SetCookie("sjogwaPortalCOOKIE","");
  }

  setTimeout(function() {
    top.content.location.href = "patweb89.pbl?reportno=1&template=2"
                                +"&urnumber="+urnumber
                                +"&admisnid="+admisnid 
                                +"&erefrlid="+erefrlid; }, 100);
}
function existingPatient(urn) {
  var admisnid = getQueryString('admisnid');
  var erefrlid = getQueryString('erefrlid');
  var xhr = createHttpObject();
  if(!isWhitespace(erefrlid)) {
    var url = "comweb10.pbl?reportno=3&remoteno=1"
              +"&urnumber="+urn.replace(/ /g,"+")
              +"&statcode=5"
              +"&erefrlid="+erefrlid
  } else {
    var url = "patweb14.pbl?reportno=07&websrvno=2"
              +"&urnumber="+urn.replace(/ /g,"+")
              +"&statcode=5&admisnid="+admisnid
  }
  xhr.open('GET',url,false);
  xhr.send();
  return xhr.responseText;
}
function NewPatient() {
  linkForm.template.value="3";
  linkForm.urnumber.value="        ";
  linkForm.admissno.value="";
  linkForm.submit();
}
function LHDSearch() {
  var p = document.search;
  var admisnid = getQueryString('admisnid');
  var erefrlid = getQueryString('erefrlid');

  p.admisnid.value = admisnid.replace(/\+/g," ");
  p.erefrlid.value = erefrlid.replace(/\+/g," ");
  
  var sReturnURL = 'patweb90.pbl?reportno=1&template=202&srchtype=1' +
     '&norecord=' + p.norecord.value +
     '&srchsnam=' + p.srchsnam.value.toUpperCase() +
     '&srchgnam=' + p.srchgnam.value.toUpperCase() +
     '&srchpdob=' + SetDateYYYYMMDD(p.srchpdob.value) +
     '&admisnid=' + admisnid +
     '&erefrlid=' + erefrlid;

  LHDSearchFrame('RegOption','NewReg',sReturnURL,SRCH_MODE_EA);
}
function FinaliseReset() {
  document.getElementById('spLHDSrchBtn').innerHTML = "";
}
function setMCvalue() {
  if (!isWhitespace(document.search.srchmedi.value)) {
    if (document.search.srchmedi.value.replace(/ /g,"").length < "8") {
        alert("First 8 characters of Medicare No. must be entered");
        return false;
  }}
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);setUR();checkType();"
 style="background-color:#ccc;background-image:url()">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
<script type="text/javascript">document.write(self.document.title);</script>
</span>

<form name=search method=get action=patweb90.pbl style="margin:0"
 onsubmit="return ProcessSubmit();">
<input type=hidden name=reportno value="1">
<input type=hidden name=template value="202">
<input type=hidden name=norecord value=5>
<input type=hidden name=patfname value=10>
<input type=hidden name=srchadmn value="%PATWEB90.01.013">
<input type=hidden name=ptcnualt value="%PATWEB90.01.023">
<input type=hidden name=alternid value="">
<input type=hidden name=aisearch value="">
<input type=hidden name=admisnid id=admisnid value="">
<input type=hidden name=erefrlid id=erefrlid value="">
<input type=hidden name=ptcnuepm value="%STANDARD.01.025.125.155.0.1">
<input type=hidden name=showblhd value="%PATWEB90.01.036">

<table align="center" width=100% border=0 cellspacing=1 cellpadding=1>
<tr><td>
  <table width=100% border=0 cellpadding=0 cellspacing=0>
  <tr>
    <td class=DataLabel>Surname<br>
      <input type=text name=srchsnam onblur="UpCase(this)" size=15>
    </td>
    <td class=DataLabel colspan=2>Given Name<br>
      <input type=text name=srchgnam onblur="UpCase(this)" size=15>
    </td>
    <td class=DataLabel>U/R Number<br>
      <input type=text name=urnumber onblur="setUR()" size=10
       maxlength=8 style="text-align:right">
    </td>
    <td class=DataLabel>Medicare No.<br>
    <input type=text name=srchmedi maxlength=17 size=12
     onblur="setMCvalue();setMedicare(this);"></td>
    <td rowspan=2>
      <input type=radio name=srchpsex value=" " checked> All <br>
      <input type=radio name=srchpsex value="M"> Male <br>
      <input type=radio name=srchpsex value="F"> Female</td>
    <td align=center valign=middle rowspan=2>
      <input type=submit class="button" value=Search name=SearchButton ><br> 
      <span id=spLHDSrchBtn></span>
      <input type=button class="button" value="Close" onclick="DFrameExit();">
      <br>
      <input type=reset class="button" value="Reset" onclick="FinaliseReset();">
    </td>
  </tr>
  <tr>
    <td class=DataLabel>Date of Birth<br>
      <input type="text" size="12" name="srchpdob"
       onblur="checkDate(this,'Date of Birth')" >
    </td>
    <td class=DataLabel>Age<br>
      <input type=text name=srchpage size=4>
    </td>
    <td class=DataLabel>Range<br>
      <select name=srcharan>
        <option value=2 selected>2 years</option>
        <option value=4>4 years</option>
        <option value=6>6 years</option>
        <option value=8>8 years</option>
        <option value=10>10 years</option>
      </select>
    </td>
    <td class=DataLabel>Search Type<br>
      <select name=srchtype onchange="checkType();">
        <option value=1>Surname</option>
        <option value=2>Sound-Ex</option>
        <option value=3>Date of Birth</option>
        <option value=4>U/R Number</option>
        <option value=5>Medicare No</option>
      </select>
    </td>
  </tr>
  </table>

  %PATWEB90.01.011.100.0

  <table width=100% cellspacing=0 cellpadding=0 border=0>
  <tr>
    <td align=left style='padding-left:5px;'>
      <input type=button id="prevbutn" value="<< Previous" class="button"
       onclick='ClickPrev();'>
    </td>
    <td width=20% align=center><div id=RegOption></td>
    <td align=right style='padding-right:12px;'>
      <input type=button id="nextbutn" value="Next >>" class="button"
       onclick='ClickNext();'>
    </td>
  </tr>
  <tr><td colspan=3>&nbsp;</td></tr>
  </table>

</td></tr>
</table>
</form>

<span id=spLHDSrch style="display:none">
  <input type=button value="%PATWEB90.01.035" class="button"
   onclick="LHDSearch()"><br>
</span>

<span id=NewReg style="display:none">
  <input type=button value="New Registration" class="Bigbutton"
   onclick="newreg();">
</span>

<form name=Registration method=get action="patweb89.pbl">
<input type=hidden name=reportno value=05>
<input type=hidden name=template value=001>
<input type=hidden name=srchsnam value="">
<input type=hidden name=srchgnam value="">
<input type=hidden name=srchpdob value="">
<input type=hidden name=srchpage value="">
<input type=hidden name=srchpsex value="">
<input type=hidden name=admisnid value="">
<input type=hidden name=erefrlid value="">
<input type=hidden name=srchmedi value="">
</form>

<form name=linkForm action="patweb89.pbl" method=get>
<input type=hidden name=reportno value="1">
<input type=hidden name=template value="2">
<input type=hidden name=urnumber>
<input type=hidden name=admissno>
<input type=hidden name=casekeys>
</form>

<script type="text/javascript">
function init() {
  if (document.search.ptcnuepm.value == "1") {
    document.getElementById('spLHDSrchBtn').innerHTML = document.getElementById('spLHDSrch').innerHTML;

    if (isWhitespace(document.search.srchsnam.value)) {
      RegOption.innerHTML="";
    }
    else {
      RegOption.innerHTML=NewReg.innerHTML;
    }
  }
  else {
    RegOption.innerHTML=NewReg.innerHTML;
  }

  if (document.getElementById("BodyDivision") != undefined) {
    bd = document.getElementById("BodyDivision");
    bd.style.height = document.body.clientHeight - 60 - bd.offsetTop;
  }
  if (document.search.ptcnualt.value=="1"){
    document.search.urnumber.maxLength=20;
    document.search.urnumber.size=20;
  }

  document.search.srchsnam.value="%PATWEB90.01.003";
  document.search.srchgnam.value="%PATWEB90.01.004";
  document.search.srchpage.value="%PATWEB90.01.006";
  document.search.srchpdob.value="%PATWEB90.01.007";
  document.search.srchmedi.value="%PATWEB90.01.016";

  for (var i =0 ; i < document.search.srcharan.length; i++) {
    if (document.search.srcharan.options[i].value==trim("%PATWEB90.01.008")) {
      document.search.srcharan.selectedIndex=i;
    }
  };
  for (var i =0 ; i < document.search.srchtype.length; i++) {
    if (document.search.srchtype.options[i].value=="%PATWEB90.01.009.2") {
      document.search.srchtype.selectedIndex=i;
    }
  };
  for (var i =0 ; i < document.search.srchpsex.length; i++) {
    if (document.search.srchpsex[i].value=="%PATWEB90.01.005") {
      document.search.srchpsex[i].checked="1";
    }
  };
}
function ClickPrev() {
  var admisnid = getQueryString('admisnid');
  var erefrlid = getQueryString('erefrlid');

  if (sjogprtl == "1") {
    SetCookie("sjogwaPortalCOOKIE","");
  }

  location.href=trim('%PATWEB90.01.002.202') + 
                "&admisnid=" + admisnid.replace(/ /g,"+") +
                "&erefrlid=" + erefrlid.replace(/ /g,"+");
}
function ClickNext() {
  var admisnid = getQueryString('admisnid');
  var erefrlid = getQueryString('erefrlid');

  if (sjogprtl == "1") {
    SetCookie("sjogwaPortalCOOKIE","");
  }

  location.href=trim('%PATWEB90.01.001.202') +
                "&admisnid=" + admisnid.replace(/ /g,"+") +
                "&erefrlid=" + erefrlid.replace(/ /g,"+");
}
</script>
