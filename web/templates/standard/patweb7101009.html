<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="CrossBrowser" content="true">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript">
function checkamnt(patpor,rebpor) {
   if(ItemForm.mschg004.value!=0) {
   patpor.value=(ItemForm.mschg004.value*ItemForm.patportn.value);
   rebpor.value=(ItemForm.mschg004.value*ItemForm.rebportn.value);
   justifyLeft(patpor)
   justifyLeft(rebpor)  
   } else {
     if(document.getElementById('ptcnisbz').value != "1") {
        alert("Quantity Must be Greater Than or = 1");
     }
   }
 }

function UpdateItm() {
   if (document.ItemForm.isblflag!=undefined) {
    if((document.ItemForm.isblflag.value=="1") &&
      (document.ItemForm.commbill.value=="1")) {

     if(document.getElementById('ptcnisbz').value != "1") {
      alert("Items from Independence Services Billing Can not be Changed."); 
      return;
     }

    }
   }

  if (!isWhitespace(ItemForm.mschg008.value)) {
     time1 = ItemForm.mschg008.value.replace(/:/g,"");
     time2 = ItemForm.mschg009.value.replace(/:/g,"");
     if (time2<time1) {
       alert ("End Time cannot be less than Start Time");
       return;
     }
  }
  if (validateMandatory(ItemForm)) 
      ItemForm.updttype.value = "U";
      ItemForm.submit(); 
 }

function DeleteItm() {
   if (document.ItemForm.isblflag!=undefined) {
    if((document.ItemForm.isblflag.value=="1") &&
      (document.ItemForm.commbill.value=="1")) {

     if(document.getElementById('ptcnisbz').value != "1") {
      alert("Items from Independence Services Billing must be deleted from Billing Template."); 
      return;
     }
    }
   }

   ans=confirm("Are you sure you want to Delete ?")
   if (ans)  {
      if (validateMandatory(ItemForm)) {

        if(document.ItemForm.d_defrthal.checked==false) {
          document.ItemForm.defrthal.value="0";
        } else {
          document.ItemForm.defrthal.value="1";
        }

        ItemForm.updttype.value = "D";
        ItemForm.submit(); 
      }
   }
}
function setTimes() {
  checkTime(ItemForm.mschg008,'Start Time');
  checkTime(ItemForm.mschg009,'End Time');
  if (!isWhitespace(ItemForm.mschg008.value)) {
    ItemForm.mschg008.className="Time Mandatory";
    ItemForm.mschg009.className="Time Mandatory";
  } else {
    ItemForm.mschg008.className="";
    ItemForm.mschg009.className="";
  }

  if (document.ItemForm.isblflag!=undefined) {
    if((document.ItemForm.isblflag.value=="1") &&
      (document.ItemForm.commbill.value=="1")) {
     if(document.getElementById('ptcnisbz').value == "1") {
       ItemForm.delebut.disabled=true;
     }
   }
  }

}
</script>
%START.OF.PAGE
<body onload="PageLoad(event);setTimes();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
Update/Delete MBS/Miscellaneous Item
</span>

<div id=PageBodySection>

<form name=ItemForm action="patweb71.pbl" method=post style="margin:0">
<input type=hidden name=reportno value="1">
<input type=hidden name=template value=009>
<input type=hidden name=updttype value=" ">
<input type=hidden name=nextpage value="0">
<input type=hidden name=urnumber value="%PATWEB71.01.003">
<input type=hidden name=admissno value="%PATWEB71.01.081">
<input type=hidden name=transnum value="%PATWEB71.01.323">
<input type=hidden name=patportn value="%PATWEB71.01.706">
<input type=hidden name=rebportn value="%PATWEB71.01.707">
<input type=hidden name=patamoun value="%PATWEB71.01.743">
<input type=hidden name=rebamoun value="%PATWEB71.01.744">
<input type=hidden name=commbill value="%PATWEB71.01.739">
<input type=hidden name=isblflag value="%PATWEB71.01.740">
<input type=hidden name=redirect value="%PATWEB71.01.001.patweb71.01.001">
<input type=hidden name=defrthal value=" ">
<input type=hidden name=recrdtyp value="%PATWEB71.01.712">
<input type=hidden name=patiflag value="%PATWEB71.01.758">
<input type=hidden name=ptcnisbz id=ptcnisbz 
       value="%STANDARD.01.025.088.248.0.1">

<table border=0 width=100% cellspacing=1 cellpadding=0>
  <tr><td width=30% class=DataLabel>Date</td>
      <td width=40% class=DataField>
    <input type=text name=mschg001 size=12 maxlength=12 class=Readonly readonly 
           value="%PATWEB71.01.701" title="Date">
    </td></tr>

  <tr><td class=DataLabel>Item</td>
      <td class=DataField>
      <input type=text name=mschg002 class=Readonly readonly
   title="Item" value="%PATWEB71.01.702"></td></tr>

  <tr><td class=DataLabel>Description</td>
      <td class=DataField>
      <input type=text name=mschg003 size=34 maxlength=30 
           value="%PATWEB71.01.703" title="Description" ></td>
      <td><b>&nbsp;%PATWEB71.01.741</b></td>
      </tr>

  <tr><td class=DataLabel>Quantity</td>
     <td class=DataField>
     <input type=text name=mschg004 size=5 maxlength=5  min="0"
           class="Integer Mandatory" onblur="checkamnt(mschg006,mschg007);"
           value="%PATWEB71.01.704" title="Quantity"></td></tr>

  <tr><td class=DataLabel>Reference</td>
      <td class=DataField>
      <input type=text name=mschg005 size=13 maxlength=12 
           value="%PATWEB71.01.705" title="Reference"></td></tr>

  <tr><td class=DataLabel>Patient Portion</td>
    <td class=DataField>
    <input type=text name=mschg006 size=10 maxlength=10 class=Number
           max=999999.99 title="Patient Amount" value="%PATWEB71.01.710"
           onblur="RoundNumber(this,2);">
    </td>
    <td class="DataLabel"><div id="AmountMsgDiv"></div></td>
    </tr>

  <tr><td class=DataLabel>Rebate Portion</td>
    <td class=DataField>
    <input type=text name=mschg007 size=10 maxlength=10 class=Number
           max=999999.99 title="Rebate Amount" value="%PATWEB71.01.711"
           onblur="RoundNumber(this,2);">
    </td>
    <td class="DataLabel"><div id="AmountMsgDiv1"></div></td>
    </tr>

  <tr><td class=DataLabel>Start Time</td>
    <td class=DataField>
    <input type=text name=mschg008 size=10 maxlength=8 title="Start Time"
           value="%PATWEB71.01.717" onblur="setTimes();">
    <img src="../images/TimeLookup.gif" class=Icon
           onclick="TimeLookupFrame(mschg008);">
    <img src="../images/erase.gif" class=Icon
          onclick="clrFields(mschg008,mschg009);setTimes();">
    </td></tr>

  <tr><td class=DataLabel>End Time</td>
    <td class=DataField>
    <input type=text name=mschg009 size=10 maxlength=8 title="End Time"
           value="%PATWEB71.01.718" onblur="setTimes();">
    <img src="../images/TimeLookup.gif" class=Icon
           onclick="TimeLookupFrame(mschg009);">
    </td></tr>

<tr><td class=DataLabel>Delete from Theatre Also</td>
    <td class=DataItem><input type=checkbox name=d_defrthal
     title="Delete from Theatre Also" value="1" checked>
    </td></tr>

<tr><td class="DataLabel">&nbsp;</td>
    <td colspan=2><div id="PatInvMsgDiv"></div></td></tr>


<tr><td colspan=3 align=center>
  <input type=button value="Update" class="button" name=updtbut id=updtbut
   onclick="UpdateItm();">
  <input type=button value="Delete" class="button" name=delebut id=delebut
   onclick="DeleteItm();">
  <input type=button value="Close" class="button" onclick="DFrameCloseRefresh();">
  </td></tr>
</table>
</form>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB71.01.003">
<input type=hidden name=admissno value="%PATWEB71.01.081">
<input type=hidden name=MenuType value="%PATWEB71.01.088">
</form>

<span id=PatInvMsgSpan style="display:none">
    <font color=red><b>Patient Portion Invoice has been raised</b></font>
</span>

<span id=AmountMsgSpan style="display:none">
    <font color=black><b>(Warning: Recalculated</b></font>
</span>

<span id=AmountMsgSpan1 style="display:none">
    <font color=black><b>rate showing on Invoice)</b></font>
</span>

<script type="text/javascript">

  cdes="%PATWEB71.01.708";
  if (cdes=="0") {
     ItemForm.mschg003.disabled=true;
    }
  else {
     ItemForm.mschg003.disabled=false;
  }

  camt="%PATWEB71.01.709";
  if (camt=="0") {
     ItemForm.mschg006.className="";
     ItemForm.mschg007.className="";
     ItemForm.mschg006.disabled=true;
     ItemForm.mschg007.disabled=true;
    }
  else {
     ItemForm.mschg006.className="";
     ItemForm.mschg007.className="";
     ItemForm.mschg006.disabled=false;
     ItemForm.mschg007.disabled=false;
  }

  if ((document.ItemForm.patamoun.value != document.ItemForm.patportn.value) ||
      (document.ItemForm.rebamoun.value  != document.ItemForm.rebportn.value))
     {
    document.getElementById('AmountMsgDiv').innerHTML = document.getElementById('AmountMsgSpan').innerHTML;

    document.getElementById('AmountMsgDiv1').innerHTML = document.getElementById('AmountMsgSpan1').innerHTML;
     }

  // Miscellaneous Item?
  if (ItemForm.recrdtyp.value == '3') {
    ItemForm.mschg008.disabled = true;  // disable Start Time
    ItemForm.mschg009.disabled = true;  // disable End Time
  }

  if (ItemForm.patiflag.value == "1") {
    document.getElementById('PatInvMsgDiv').innerHTML = document.getElementById('PatInvMsgSpan').innerHTML;
      ItemForm.updtbut.disabled = true;
      ItemForm.delebut.disabled = true;
  }


</script>
