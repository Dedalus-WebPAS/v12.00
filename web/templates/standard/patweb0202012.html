%START.OF.PAGE
<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3&key=%STANDARD.01.044.124.161.050"></script>
<script type="text/javascript" src="../js/GoogleLibrary.js"> </script>
<style type=text/css>
.InformationIcon {
  background: url("../images/AlertSprite.png") -0px -140px no-repeat;
  width:20px;
  height:20px;
}
</style>
<script type="text/javascript">
function InitTable() {
  el=document.getElementById("MapLocation");
  el.innerHTML="<span style='font-size:12px;background-color:#111;color:eee;"+
               "border:1px solid grey;position:absolute;"+
               "text-align:center;height:50px;width:300px;"+
               "margin-left:200px;margin-top:100px;padding:50px;'>"+
               "<img src='../images/loading.gif'><br><br>Geo Coding in Progress<br>Please Wait</span>";
  setTimeout(function(){ DisplayTable(); }, 100);
}
function DisplayTable() {
 t = new Table();    // Create New Table Object
 el=document.DisplayForm;
 if (el.webpd002.options.length<=0) {
   alert("You currently have no patient lists.\nPlease create your list before using this facility.");
   el=document.getElementById("MapLocation");
   el.innerHTML="";
   return;
 }
 webpd002=el.webpd002.options[el.webpd002.selectedIndex].value;
 theURL="geocod01.php?reportno=2&webpd002="+webpd002
 var xmlHttp = createHttpObject();
 xmlHttp.open("GET", theURL, false);
 xmlHttp.send();
 if (xmlHttp.responseText!=""&&xmlHttp.status == 200) {
    h = document.getElementsByTagName("head")[0];
    s = document.createElement("script");
    s.type="text/javascript";
    h.appendChild(s);
    s.text=xmlHttp.responseText;
    AddRows();
    ShowList();
    DisplayMap();
 } else {
   alert("No Patient Found");
   el=document.getElementById("MapLocation");
   el.innerHTML="";
 }
}
function StringSort(a,b) {
  if (a[SortOrderBy] < b[SortOrderBy] ) { x = -1 }
  if (a[SortOrderBy] == b[SortOrderBy] ) { x = 0  }
  if (a[SortOrderBy] > b[SortOrderBy] ) { x = 1  }
  return x ;
}
function ShowList() {
 SortOrderBy=11;
 t.rows.sort(StringSort);
 var OS = "<dl>";
 LinkFlag=false;
 for(var i = 0; i < t.rows.length; i++) {
   sAlpha=getMarkerColor(i);
   OS += "<dt onclick='LinkPatient(\""+i+"\");'>" + 
         "<span style='padding:5px;display:inline-block;vertical-align:top'><img "+
         "src='https://maps.gstatic.com/mapfiles/marker"+sAlpha+".png'></span>"+
         "<span style='width:80%;padding:5px;display:inline-block;vertical-align:top'>"+t.rows[i][2] + 
         "<br>"+t.rows[i][3]  
   if (t.rows[i][6]=="1") {
      OS += "<span class=InformationIcon title='Partial Address Match\n"+t.rows[i][7]+"'></span>"
   }
   if (!isWhitespace(t.rows[i][8])) {
      OS += " ("+t.rows[i][8]+")"
   }
   if (!isWhitespace(t.rows[i][9])) OS += "<br>Status   : "+t.rows[i][9];
   if (!isWhitespace(t.rows[i][10])) OS += "<br>Comment  : "+t.rows[i][10];
   if (!isWhitespace(t.rows[i][11])) OS += "<br>" + t.rows[i][11];
   OS += "</span><dt>"

 }
 if (t.rows.length==0) {
    OS+="<dt style='text-align:center;color:darkred;'>"+
        "No Patients this List."+
        "</dt>";
 }
 OS += "</dl>";
 document.getElementById("TableLocation").innerHTML=OS;
}
function FormatPatientIconSpan(Indicators) {
  ImageStr="<span class=PatientFolder"+ Indicators.substr(0,3) + "></span>"
  return ImageStr;
}
function LinkPatient(rowNo) {
   alert(t.rows[rowNo][2]+"\n"+t.rows[rowNo][3]);
}
function EditList() {
  if (isWhitespace(DisplayForm.webpd002.value)) {
    alert("Select List Before Editing Details") 
  } else {
    LinkUrl="patweb02.pbl?reportno=1&template=1&webpd002="+
            document.DisplayForm.webpd002.value
    DFrameLink(LinkUrl,20,100,500,200)
  }
}
function AddPatient() {
  if (isWhitespace(DisplayForm.webpd002.value)) {
    alert("Select List Before Adding Patients") 
  } else {
    LinkUrl="patweb02.pbl?reportno=2&template=2&webpd002="+
            document.DisplayForm.webpd002.value
    DFrameLink(LinkUrl,20,60,700,420)
  }
}
function UpdateItem(listno,urno) {
  LinkUrl="patweb02.pbl?reportno=2&template=3&webpd002="+listno+"&webpt003="+urno
  DFrameLink(LinkUrl,20,120,500,220)
}
</script>
</head>
<body onload=PageLoad(event);InitTable()>
<form name=DisplayForm action=patweb02.pbl method=get style="margin:0">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=12>
<input type=hidden name=updttype value=" ">
<table cellspacing=0 border=0 cellpadding=0 width=100%>
<tr><td class=HeadingCell style='width:90px;'>Select List</td>
  <td class=HeadingCell>
   <select name=webpd002 onchange=document.DisplayForm.submit()>
   %PATWEB02.02.011
   </select>
   <input type=button class="button" value="Edit List"
   onclick="EditList();">
   <input type=button class="button" value="Add List"
   onclick='DFrameLink("patweb02.pbl?reportno=1&template=2",20,100,500,220)'>
  </td>
  <td class=HeadingCell align=right>
   <input type=button class="button" value="Add Patient" onclick="AddPatient();">
</td></tr>
</table>
<table width=100% border=1 cellpadding=0 cellspacing=0 style='border:1px solid #ccc;'>
<tr valign=top><td width=30%><div id="TableLocation"></div></td>
    <td><div id=MapLocation style='width:100%;height:600px;'></div></td>
</table>
</form>
</body>
</html>
