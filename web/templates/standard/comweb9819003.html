<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function SubmitUpd(){
  if(!validateMandatory(UpdateForm)){
     return;
  }
  if(document.UpdateForm.cmpar005.value=="  1") {   // Format date
     document.UpdateForm.cmpar004.value=
     SetDateYYYYMMDD(document.UpdateForm.d_cmpar004.value);
  } else if (document.UpdateForm.cmpar005.value=="  4") {  // Cat Code
    document.UpdateForm.cmpar004.value=document.UpdateForm.d_category.value +
                                       document.UpdateForm.d_cmpar004.value;
  } else if (document.UpdateForm.cmpar005.value=="  6") {  // Numeric
    justifyRight(document.UpdateForm.d_cmpar004);
    document.UpdateForm.cmpar004.value=document.UpdateForm.d_cmpar004.value;
  } else if (document.UpdateForm.cmpar005.value=="  7") {
    if (document.UpdateForm.exceptpb.checked==true) {a="1"}else{a="0"}
    if (document.UpdateForm.exceptmo.checked==true) {b="1"}else{b="0"}
    if (document.UpdateForm.excepttu.checked==true) {c="1"}else{c="0"}
    if (document.UpdateForm.exceptwe.checked==true) {d="1"}else{d="0"}
    if (document.UpdateForm.exceptth.checked==true) {e="1"}else{e="0"}
    if (document.UpdateForm.exceptfr.checked==true) {f="1"}else{f="0"}
    if (document.UpdateForm.exceptsa.checked==true) {g="1"}else{g="0"}
    if (document.UpdateForm.exceptsu.checked==true) {h="1"}else{h="0"}
    document.UpdateForm.d_cmpar004.value=a+b+c+d+e+f+g+h;
    document.UpdateForm.cmpar004.value=document.UpdateForm.d_cmpar004.value;
  } else {
    document.UpdateForm.cmpar004.value=document.UpdateForm.d_cmpar004.value;
  }
  if(document.UpdateForm.d_cmpar006.checked==true) {
     document.UpdateForm.cmpar006.value="0";
  } else {
     document.UpdateForm.cmpar006.value="1";
  }
  document.UpdateForm.updttype.value="U";
  UpdateForm.submit();
}
function SubmitDel(){
  setFormactn('D');
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Update Hospital Parameter
</span>
<form name=UpdateForm action="comweb98.pbl" method=post style="margin:0">
<input type=hidden name=reportno value=19>
<input type=hidden name=template value=3>
<input type=hidden name=updttype value=" ">
<input type=hidden name=cmpar001 value="%COMWEB98.19.101.1">
<input type=hidden name=cmpar002 value="%COMWEB98.19.102">
<input type=hidden name=cmpar004 value="">
<input type=hidden name=cmpar005 value="%COMWEB98.19.105.1">
<input type=hidden name=cmpar006 value="">
<input type=hidden name=ibcnmhos id=ibcnmhos
 value="%STANDARD.01.025.000.043.1.1">
<input type="hidden" name="usrsvrsl" value="%STANDARD.01.042.PATWEB99">
<input type=hidden name=d_category value="">

<table width=100% cellpadding="1" cellspacing="1" border=0>
<tr><td class=DataLabel><div id="HospLabel"></div></td>
    <td class=DataField><div id="HospField"></div></td></tr>

<tr><td class=DataLabel width=16%>Parameter</td>
    <td class=DataField>%COMWEB98.19.102</td></tr>

<tr><td class=DataLabel>Description</td>
    <td class=DataField>%COMWEB98.19.103</td></tr>

<tr><td class=DataLabel>Value</td>
    <td class=DataField><div id="ParameterValue"></div>
    </td></tr>

<tr><td class=DataLabel>Active</td>
    <td class=DataField><input type=checkbox name=d_cmpar006
     title="Active" value="0">
    </td></tr>

<tr><td align=center colspan="2"><hr>
    </td></tr>

<tr><td class=DataLabel>Created By</td>
    <td class=DataField>%COMWEB98.19.109<td></tr>

<tr><td class=DataLabel>Created Date/Time</td>
    <td class=DataField>%COMWEB98.19.107 %COMWEB98.19.108<td></tr>


<tr><td class=DataLabel>Updated By</td>
    <td class=DataField>%COMWEB98.19.112<td></tr>

<tr><td class=DataLabel>Updated Date/Time</td>
    <td class=DataField>%COMWEB98.19.110 %COMWEB98.19.111<td></tr>

<tr><td align=center colspan="2"><hr>
    </td></tr>

<tr><td colspan=4 align=center>
    <input type=button class="button" value="Update" id="com98add"
     onclick="tempDisable(this);SubmitUpd();">

    <span id=ShowDeleteButton style="display: none">
    <input type=button class="button" value="Delete" id="com98del"
     onclick="tempDisable(this);SubmitDel();">
    </span>
    <input type=button value="Cancel" class="button"
     onclick="DFrameExit();">
    </td></tr>
</table>
</form>

<div id="ShowHospLabel" style="display: none">
 Hospital
</div>

<div id="ShowHospField" style="display: none">
%COMWEB98.19.101.2
</div>

<div id="ShowTextValue" style="display: none">
 <input type=text size=100 maxlength=256 name=d_cmpar004 
 class="Mandatory" title="Value" value="%COMWEB98.19.104.0">
</div>

<div id="ShowDateValue" style="display: none">
 <input type="text" size="12" name="d_cmpar004"
 class="Mandatory Date" title="Date" value="%COMWEB98.19.104.0">
 <img notab src="../images/DateLookup.gif" class=Icon
  onclick="DateLookupFrame(UpdateForm.d_cmpar004);" >
</div>

<div id="ShowTimeValue" style="display: none">
 <input type=text name="d_cmpar004" size=8  class="Mandatory Time"
  value="%COMWEB98.19.104.0" title="Time">
 <img notab src=../images/TimeLookup.gif class=Icon
  onclick="TimeLookupFrame(UpdateForm.d_cmpar004);">
</div>

<div id="ShowHCPValue" style="display: none">
 <input type=text name="d_cmpar004" size=10 maxlength=10 title="HCP Code"
 class=Mandatory value="%COMWEB98.19.104.0"
 onchange="ValidateHCP(18,0,UpdateForm.d_cmpar004,UpdateForm.n_cmpar004);">
 <input type=text name=n_cmpar004 size=35 readonly title="HCP Name"
 class=Readonly tabindex=-1 value="%COMWEB98.19.104.1">
 <img src="../images/SearchIcon.gif" class=Icon
  onclick="HCPSearchFrame(UpdateForm.d_cmpar004,UpdateForm.n_cmpar004,0);">
</div>

<div id="ShowCatCodeValue" style="display: none">
 <select name=d_cmpar004 class="Mandatory" title="Selection">
 </select>
</div>

<div id="ShowYesNoValue" style="display: none">
 <select name=d_cmpar004 class="Mandatory" title="Yes/No">
 <option value="   "></option>
 <option value="0">No</option>
 <option value="1">Yes</option>
 </select>
</div>

<div id="ShowNumericValue" style="display: none">
 <input type="text" size="14" maxlength="12" class="Mandatory Integer"
  min=0 max=99999999 title="Number" name=d_cmpar004
  onblur="checkInteger(this,this.title);">
</div>

<div id="ShowDaysOfWeekValue" style="display: none">
  Exclude Pub Holidays <input type=checkbox value=1 name=exceptpb>
  Exclude Mon-Sun<input type=checkbox value=1 name=exceptmo>
  <input type=checkbox value=1 name=excepttu>
  <input type=checkbox value=1 name=exceptwe>
  <input type=checkbox value=1 name=exceptth>
  <input type=checkbox value=1 name=exceptfr>
  <input type=checkbox value=1 name=exceptsa>
  <input type=checkbox value=1 name=exceptsu>
  <input type=hidden name=d_cmpar004 value="%COMWEB98.19.104.0">
</div>

<script type="text/javascript">
if(document.UpdateForm.ibcnmhos.value=="1") {
   document.getElementById('HospLabel').innerHTML=
   document.getElementById('ShowHospLabel').innerHTML;
   document.getElementById('HospField').innerHTML=
   document.getElementById('ShowHospField').innerHTML;
}

ParameterType="%COMWEB98.19.105.1";
ParameterV=document.getElementById('ParameterValue');
if(ParameterType =="  0") {
  ParameterV.innerHTML=document.getElementById('ShowTextValue').innerHTML;
} else if( ParameterType =="  1") {
  ParameterV.innerHTML=document.getElementById('ShowDateValue').innerHTML;
} else if( ParameterType =="  2") {
  ParameterV.innerHTML=document.getElementById('ShowTimeValue').innerHTML;
} else if( ParameterType =="  3") {
  ParameterV.innerHTML=document.getElementById('ShowHCPValue').innerHTML;
} else if( ParameterType =="  4") {
  ParameterV.innerHTML=document.getElementById('ShowCatCodeValue').innerHTML;
  var catcode="%COMWEB98.19.104.0"
  document.UpdateForm.d_category.value=catcode.substr(0,2);
  document.UpdateForm.cmpar002.value.substr(8,2);
  SelectOptionsHospCatCode1(UpdateForm.d_category,UpdateForm.cmpar001,
                            UpdateForm.d_cmpar004)
  for (var i=0; i < document.UpdateForm.d_cmpar004.length; i++) {
   if (document.UpdateForm.d_cmpar004.options[i].value.substr(0,3)==
       catcode.substr(2,3)){
       document.UpdateForm.d_cmpar004.selectedIndex=i;
   }
  }

} else if( ParameterType =="  5") {
  ParameterV.innerHTML=document.getElementById('ShowYesNoValue').innerHTML;
  for (var i=0; i < document.UpdateForm.d_cmpar004.length; i++) {
  if (document.UpdateForm.d_cmpar004.options[i].value==
      trim("%COMWEB98.19.104.0")){
      document.UpdateForm.d_cmpar004.selectedIndex=i;
  }
 }
} else if( ParameterType =="  6") {
  ParameterV.innerHTML=document.getElementById('ShowNumericValue').innerHTML;
   document.UpdateForm.d_cmpar004.value=trim("%COMWEB98.19.104.0");
} else if( ParameterType =="  7") {
  ParameterV.innerHTML=document.getElementById('ShowDaysOfWeekValue').innerHTML;
   document.UpdateForm.d_cmpar004.value=trim("%COMWEB98.19.104.0");
   if (document.UpdateForm.d_cmpar004.value.substr(0,1)=="1") {
     document.UpdateForm.exceptpb.checked=true;
   }
   if (document.UpdateForm.d_cmpar004.value.substr(1,1)=="1") {
     document.UpdateForm.exceptmo.checked=true;
   }
   if (document.UpdateForm.d_cmpar004.value.substr(2,1)=="1") {
     document.UpdateForm.excepttu.checked=true;
   }
   if (document.UpdateForm.d_cmpar004.value.substr(3,1)=="1") {
     document.UpdateForm.exceptwe.checked=true;
   }
   if (document.UpdateForm.d_cmpar004.value.substr(4,1)=="1") {
     document.UpdateForm.exceptth.checked=true;
   }
   if (document.UpdateForm.d_cmpar004.value.substr(5,1)=="1") {
     document.UpdateForm.exceptfr.checked=true;
   }
   if (document.UpdateForm.d_cmpar004.value.substr(6,1)=="1") {
     document.UpdateForm.exceptsa.checked=true;
   }
   if (document.UpdateForm.d_cmpar004.value.substr(7,1)=="1") {
     document.UpdateForm.exceptsu.checked=true;
   }
}

Active="%COMWEB98.19.106"
if(Active!="1") {
  document.UpdateForm.d_cmpar006.checked=true;
}
if(document.UpdateForm.usrsvrsl.value > 95) {
  document.getElementById("ShowDeleteButton").style.display="";
}
</script>
