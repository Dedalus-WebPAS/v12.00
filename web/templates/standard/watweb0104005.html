<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome"    content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript">
function SendSMS() {
  if(!validateMandatory(UpdateForm)) {
    return;
  }
  document.UpdateForm.PrintButton.disabled=true;
  setTimeout('document.UpdateForm.PrintButton.disabled=false',2000);

  if (ValidPhoneNum()) {
    document.UpdateForm.submit();
  }
}
function ValidPhoneNum() {
  var mobile = trim(document.UpdateForm.d_mobile.value);

  // No mobile number stored?
  if (isWhitespace(mobile)) {
    alert("Cannot send message - there is no mobile number recorded for this patient");
    return false;
  }

  //
  // Check mobile number pattern...
  //
  // Only contain numbers and spaces.
  // Can (optionally) start with a + followed by country code (up to 3 digits).
  // Number without country code can be up to 13 digits long.
//var regex = new RegExp('^(?:\\+[0-9]{1,3})?(?:[0-9]\\s*){10,13}$');
  var regex = new RegExp('^(?:\\+[0-9]{1,3})?((?:[0-9]\\s*){10,13}|(?:[0-9]\\s*){9,13})$');

  if (!regex.test(mobile)) {
    alert("Cannot send message - invalid mobile number: " + mobile);
    return false;
  }

  return true;
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Send Waiting List SMS
</span>

<form name=UpdateForm action="watweb01.pbl" method=post style="margin:0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=1>
<input type=hidden name=casekeys value="%WATWEB01.04.101">
<input type=hidden name=updttype value="A">
<input type=hidden name=watlh003 value="   ">
<input type=hidden name=waitlett value="1">
<input type=hidden name=selprint value="%STANDARD.01.025.124.105.0.6">
<input type=hidden name=schdcopy value="1">
<input type=hidden name=schdtype value="3">
<input type=hidden name=d_mobile value="%WATWEB01.04.343">
<input type=hidden name="ptcnsmso" id="ptcnsmso"
 value="%STANDARD.01.025.128.106.0.1">

<table border=0 width=60% cellspacing=0 align=center>
<tr><td class=DataLabel>SMS Message</td>
    <td class=DataField>
    <select name=watlh002 class="Mandatory" title="SMS Message">
    <option></option>
    %WATWEB01.04.203.4
    </select></td></tr>
</tr>

<tr><td>&nbsp;</td></tr>

<tr><td colspan=2 align=center>
    <input type=button class="button" value="Send SMS"
     onclick="SendSMS();" name="PrintButton">
    <input type=button value="Cancel" class="button" onClick='DFrameClose()'>
</td></tr>
</table>
</form>

<script type="text/javascript">
if(document.getElementById("ptcnsmso").value=="1") {
  sortSelectionList(document.UpdateForm.watlh002);
}
</script>
