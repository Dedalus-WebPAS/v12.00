<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script language=javascript src="../js/TableSort.js"></script>
<script language="Javascript">
function ReferralLink(ReferralKey) {
  var uno=PatientLinks.urnumber.value.replace(/ /g,"+");
  var rno=ReferralKey.replace(/ /g,"+");
  Location="../cgi-bin/allweb02.pbl?reportno=02&template=002&urnumber=" + uno +
           "&admissno="+rno;
  location.href=Location
}

function ShowResidentialAdm(ReferralKey) {
  var uno=PatientLinks.urnumber.value.replace(/ /g,"+");
  var rno=ReferralKey.replace(/ /g,"+");
  Location="../cgi-bin/allweb03.pbl?reportno=01&template=008&urnumber=" + uno +
           "&admissno=" + rno;
  location.href=Location
}

function OPReferralLink(Referral,BStatus) {
  SaveAdmission=PatientLinks.admissno.value;
  PatientLinks.admissno.value=Referral;
  if (BStatus == 0)
     PatientLinkTo("outweb01.pbl",4,2,1,700,550);
  else
     PatientLinkTo("outweb01.pbl",4,4,1,750,550);
  PatientLinks.admissno.value=SaveAdmission;
}
function LinkedReferral(ReferralKey) {
  var uno=PatientLinks.urnumber.value.replace(/ /g,"+");
  var rno=ReferralKey.replace(/ /g,"+");
  Location="../cgi-bin/allweb02.pbl?reportno=07&template=001&urnumber=" + uno +
           "&admissno="+rno;
  location.href=Location
}
function FilterReferral() {
  document.PatientLinks.filtdept.value=document.AddReferral.d_filtdept.value;
  document.PatientLinks.filtstat.value=document.AddReferral.d_filtstat.value;
  document.PatientLinks.ptcolumn.value=document.AddReferral.ptcolumn.value;
  PatientLinkTo('allweb02.pbl',2,22,0,0,0);
}
function AddNewReferral() {
   Left=(document.body.clientWidth-900)/2;
   DFrameSubmit(AddReferral,50,Left,900,900);
}
function AddCombinedReferral() {
   linkurl="allweb02.pbl?reportno=03&template=701" +
           "&allrf001=" + AddReferral.combdept.value.replace(/ /g,"+") +
           "&urnumber=" + AddReferral.urnumber.value.replace(/ /g,"+");
   Left=(document.body.clientWidth-900)/2;
   DFrameLink(linkurl,0,Left,900,900);
}
function MyDepartment() {
  if(isWhitespace(document.PatientLinks.wbsedall.value)) {
    document.AddReferral.d_filtdept.value="";
  } else {
    for(var i =0 ; i < document.AddReferral.d_filtdept.length; i++) {
     if(document.AddReferral.d_filtdept.options[i].value==
        document.PatientLinks.wbsedall.value) {
        document.AddReferral.d_filtdept.selectedIndex=i } };
  }
  FilterReferral();
}
function AddUserReferral() {
   if(isWhitespace(document.PatientLinks.wbsedall.value)) {
     alert("User does not have a default department.");
     return;
   }
   document.AddReferral.allrf001.value=document.PatientLinks.wbsedall.value;
   Left=(document.body.clientWidth-900)/2;
   DFrameSubmit(AddReferral,50,Left,900,900);
}
function SACSView() {
   InitTable(1);
}
function StandardView() {
  document.PatientLinks.deftview.value="0";
  FilterReferral();
}
function VINAHView() {
  document.PatientLinks.deftview.value="1";
  FilterReferral();
}
function StatusView() {
  document.PatientLinks.deftview.value="2";
  FilterReferral();
}
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
// 0. Referral Link
// 1. Department Description
// 2. Referral Date
// 3. Status Description
// 4. Referred By
// 5. Problem Description
// 6. Referral/Visit Number
// 7. Last Encounter Date
// 8. Priority
// 9. Compensation
//---------------------------------------------------------------------------
function InitTable(TableView) {
  var p = document.AddReferral;

  document.PatientLinks.deftview.value=TableView;
  document.title="OP/RF Referral List";

  switch (TableView) {
    case 0: {
      t = new Table(1,0,2,"100%","center",35);

      if (p.ptcolumn.value == "1") {
        t.addColumn("Date","Date",2,2,"left","EditIcon.gif","0",70);
        t.addColumn("System","String",29,29,"left","","",40);
        t.addColumn("Department","String",1,1,"left","","",80);
        t.addColumn("Problem","String",5,5,"left","","",80);
        t.addColumn("Presenting Complaint","String",10,10,"left","","",100)
        t.addColumn("Referred By","String",4,4,"left","","",70);
        t.addColumn("Responsible HCP","String",26,26,"left","","",110);
      }
      else {
        t.addColumn("Date","Date",2,2,"left","EditIcon.gif","0",90);
        t.addColumn("System","String",29,29,"left","","",50);
        t.addColumn("Department","String",1,1,"left","","",90);
        t.addColumn("Problem","String",5,5,"left","","",80);
        t.addColumn("Referred By","String",4,4,"left","","",80);
        t.addColumn("Responsible HCP","String",26,26,"left","","",110);
      }
      t.addColumn("Case Team","String",24,24,"left","","",80);
      t.addColumn(PatientLinks.claimcode.value,"String",22,22,"left","","",30);
      if (document.AddReferral.alcndtrg.value=="1") {
        t.addColumn("Triage Status","String",40,40,"left","","",50)
      }
      t.addColumn("Priority","String",8,8,"left","","",50)
      t.addColumn("Type/Link","ImageText",21,21,"left","UpdateLink","27",80,28);
      t.addColumn("Status","String",3,3,"left","","",50);
      AddTableRows();
      t.sortTable(1,1);    // By Department
      TableOutput(0,2);    // By Date Order Column,Asc Dsc
      break;
    }

    case 1: {
      t = new Table(1,0,2,"100%","center",35);

      if (p.ptcolumn.value == "1") {
        t.addColumn("Date","Date",2,2,"right","EditIcon.gif","0",70,"","","",32);
        t.addColumn("System","String",29,29,"left","","",40);
        t.addColumn("Department","String",1,1,"left","","",80);
        t.addColumn("Problem","String",5,5,"left","","",80);
        t.addColumn("Presenting Complaint","String",10,10,"left","","",110)
        t.addColumn("Referred By","String",4,4,"left","","",70);
        t.addColumn("Responsible HCP","String",26,26,"left","","",110);
      }
      else {
        t.addColumn("Date","Date",2,2,"right","EditIcon.gif","0",100,"","","",32);
        t.addColumn("System","String",29,29,"left","","",50);
        t.addColumn("Department","String",1,1,"left","","",80);
        t.addColumn("Problem","String",5,5,"left","","",80);
        t.addColumn("Referred By","String",4,4,"left","","",80);
        t.addColumn("Responsible HCP","String",26,26,"left","","",110);
      }
      t.addColumn("Case Team","String",24,24,"left","","",80);
      t.addColumn(PatientLinks.claimcode.value,"String",22,22,"left","","",30);
      if (document.AddReferral.alcndtrg.value=="1") {
        t.addColumn("Triage Status","String",40,40,"left","","",50)
      }
      t.addColumn("Priority","String",8,8,"left","","",50)
      t.addColumn("Type/Link","ImageText",21,31,"left","UpdateLink","27",80,28);
      t.addColumn("Status","String",3,3,"left","","",50);
      AddTableRows();
      TableOutput(8,0);    // By Date Order Column,Asc Dsc
      break;
    }

    case 2: {
      t = new Table(1,0,2,"100%","center",35);
      t.addColumn("Date","Date",2,2,"right","EditIcon.gif","0",100,"","","",32);
      t.addColumn("Department","String",1,1,"left","","",100);
      t.addColumn("Clinic Type","String",12,12,"left","","",50);
      t.addColumn("Comments","String",36,36,"left","","",80);
      t.addColumn("Referred By","String",4,4,"left","","",90);
      t.addColumn("Responsible HCP","String",26,26,"left","","",110);
      t.addColumn(PatientLinks.claimcode.value,"String",22,22,"left","","",30);
      if (document.AddReferral.alcndtrg.value=="1") {
        t.addColumn("Triage Status","String",40,40,"left","","",50)
      }
      t.addColumn("Priority","String",8,8,"left","","",50)
      t.addColumn("Type/Link","ImageText",21,31,"left","UpdateLink","27",90,28);
      t.addColumn("Status","String",3,3,"left","","",50);
      AddTableRows();
      TableOutput(7,0);    // By Date Order Column,Asc Dsc
      break;
    }
  }
}
</script>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(%ALLWEB02.02.521);">
<div id="HeadingSection"> 
<div id="PageHeadingSection">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%ALLWEB02.02.003";
PatientVIS="%ALLWEB02.02.081";
PatientNAM="%ALLWEB02.02.002";
PatientSTA="%ALLWEB02.02.086.078";
PatientALT="%ALLWEB02.02.084";
PatientSEX="%ALLWEB02.02.019";
PatientDOB="%ALLWEB02.02.020";
PatientAGE="%ALLWEB02.02.021";
PatientLOC="%ALLWEB02.02.083";
PatientPRI="%ALLWEB02.02.086.066.1";
PatientUNT="%ALLWEB02.02.066.0";
DoctorCOD="%ALLWEB02.02.082.003";
DoctorNAM="%ALLWEB02.02.082.002";
PatientAID="%ALLWEB02.02.086.090";
PatientIND="%ALLWEB02.02.086.091";
PatientCUR="%ALLWEB02.02.086.092";
PatientCLC="%ALLWEB02.02.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%ALLWEB02.02.086.094";
PatientCDM="%ALLWEB02.02.086.095";
PatientVDH="%ALLWEB02.02.086.099.015";
InsertPatientHeader()
</script>
<div id="PatientMenu"></div> 
</div>

<form name=AddReferral method=get action=allweb02.pbl style="margin:0">
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%ALLWEB02.02.003">
<input type=hidden name=ptcndcdm value="%STANDARD.01.025.116.214.0.1">
<input type=hidden name=ptcolumn id=ptcolumn value="%ALLWEB02.02.272">
<input type=hidden name=alcndtrg id=alcndtrg value="%ALLWEB02.02.279">

<table cellspacing=0 cellpadding=0 border=1 width=100% class=HeadingCell>
<tr><td>
    <table cellspacing=0 cellpadding=0 border=0 width=100% >
    <tr><td align=left class=HeadingCell>Department
        <select name=d_filtdept onchange="FilterReferral();">
        <option value=" ">All</option>
        %ALLWEB02.02.223
        </select>
        <input type=button class=Button value="My Department"
         title="My Department" onclick="MyDepartment();">
        <input type=button class=Button value="Standard View"
         title="Standard View" onclick="StandardView();">
        <input type=button class=Button value="SACS View"
         id=SACSbutton title="SACS View" onclick="SACSView();">
        <input type=button class=Button value="Status View"
         id=VINAHButton2 title="VINAH View" onclick="StatusView();">
        </td>
        <td align=left class=HeadingCell>Status
        <select name=d_filtstat onchange="FilterReferral();">
        <option value=" ">All</option>
        <option value="0">Waiting</option>
        <option value="1">Active</option>
        <option value="2">Closed</option>
        <option value="3">Inactive</option>
        <option value="4">Cancelled</option>
        <option value="5">Rejected</option>
        <option value="7">Waiting & Active</option>
        <option value="8">Closed & Rejected</option>
        <option value="9">Inactive & Cancelled</option>
        </select>
        </td>
        %ALLWEB02.02.245
        <td align=right colspan=2 class=HeadingCell>Add Referral
        <input type=button class=SlimButton value="Add"
         title="Add referral for users department" onclick="AddUserReferral();">
        <select class=PMenuSelectList name=allrf001 
              onmouseover='MenuOver(event,this)' 
              onchange="AddNewReferral();">
       <option></option>
       %ALLWEB02.02.208
       </select></td></tr>
    </table>
</td></tr>
</table>
</form>
</div>

<div id=TableLocation></div>

<script language="Javascript">
function AddTableRows() {
%ALLWEB02.02.226
}
</script>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value="2">
<input type=hidden name=template value="022">
<input type=hidden name=urnumber value="%ALLWEB02.02.003">
<input type=hidden name=admissno value="%ALLWEB02.02.081">
<input type=hidden name=MenuType value="%ALLWEB02.02.088">
<input type=hidden name=wbsedall value="%STANDARD.01.028">
<input type=hidden name=filtstat value="">
<input type=hidden name=filtdept value="">
<input type=hidden name=claimcode value="%STANDARD.01.017.CL">
<input type=hidden name=bookflag value="">
<input type=hidden name=deftview value="%ALLWEB02.02.521">
<input type=hidden name=ptcolumn value="%ALLWEB02.02.272">
</form>

<script language="Javascript">
 stat="%ALLWEB02.02.222";
 for (var i =0 ; i < document.AddReferral.d_filtstat.length; i++) {
  if (document.AddReferral.d_filtstat.options[i].value==stat.substr(0,3)) {
       document.AddReferral.d_filtstat.selectedIndex=i } };

  document.AddReferral.SACSbutton.value = MasterReferralDescription + " View";
  document.AddReferral.SACSbutton.title = MasterReferralDescription + " View";
  document.AddReferral.VINAHButton2.value = MasterReferralDescription + " View 2";
  document.AddReferral.VINAHButton2.title = MasterReferralDescription + " View 2";
</script>
