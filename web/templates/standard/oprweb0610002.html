<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src=../js/TableSort.js></script>
<script type="text/javascript" src=../js/oprweb06.js></script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Columns Available
//  0 - Patient     
//  1 - U/R
//  2 - Theatre
//  3 - Surgeon
//  4 - Time into Recovery
//  5 - Date Time Stamp Link
//  6 - Ready to Depart   
//  7 - Exit Recovery Time
//  8 - Date Time Stamp Link
//  9 - Post Ward/Bed
//---------------------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
t = new Table(1,0,2,"100%","center",0,40);
t.addColumn("Patient","ImageText",0,0,"left","PatientFolder","12",150,11,"","",22)
t.addColumn("U/R","String",1,1,"left","","",40)
t.addColumn(SelectPeriod.d_catoc.value,"String",20,21,"center","","",70)
t.addColumn(SelectPeriod.d_catod.value,"Image",18,18,"center","ConditionIcon_","",70)
t.addColumn("Theatre","String",2,2,"left","","",90)
t.addColumn("Surgeon","String",3,3,"left","","",100)
t.addColumn("Time into Recovery","String",4,4,"left","DateTimeStamp.gif","5",60)
t.addColumn("Review","DateTime",17,17,"center","","",70)
t.addColumn("Delay","String",19,19,"center","","",40)
t.addColumn("Ready to Depart","String",6,6,"left","DateTimeStamp.gif","24",50)
t.addColumn("Estimated Discharge Time","String",10,10,"left","","",50)
t.addColumn("Exit Recovery Time","String",7,7,"left","DateTimeStamp.gif","8",60)
t.addColumn("Post Op Ward/Bed","String",23,23,"left","","",50)
 AddTableRows()
 TableOutput(0,1);
 break; }
 }
}
 function CaseLink(casekeys) {
  LinkForm.casekeys.value=casekeys;
  Left=(document.body.clientWidth-985)/2
  DFrameSubmit(LinkForm,0,Left,985,650);
}
function UpdatePACU(casekeys) {
  PACULinkForm.casekeys.value=casekeys;
  Left=(document.body.clientWidth-500)/2
  DFrameSubmit(PACULinkForm,0,Left,500,250);
}
function SubmitPage() {
  SelectPeriod.submit();
}
function RecoveryClosedFrame() {
    linkurl="../cgi-bin/oprweb06.pbl?reportno=19&template=001"
    if(SelectPeriod.surgtype.value!="ALL") {
      linkurl+="&filtlocn=" + SelectPeriod.surgtype.value.replace(/ /g,"+")
    }
    Left=(document.body.clientWidth-850)/2;
    DFrameLink(linkurl,50,Left,850,600);
}
function UpdTIDP(oprecovid){
  var serverURL = "../cgi-bin/oprweb06.pbl?reportno=16&updatety=D" +
                  "&oprarkey=" + oprecovid.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);

  location.reload();
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);SetCookiePath('Recovery');refreshPage();SetCookiePath('CasePath');">
<div id=HeadingSection>
<form name=SelectPeriod action=oprweb06.pbl method=get style="margin:0">
<input type=hidden name=reportno value=10>
<input type=hidden name=template value=2>
<input type=hidden name=updatety value="E">
<input type=hidden name=viewtype value="%OPRWEB06.10.510">
<input type=hidden name=d_catoc value="%STANDARD.01.017.oc">
<input type=hidden name=d_catod value="%STANDARD.01.017.od">
<input type=hidden name=dlyrsnrc value="%OPRWEB06.10.520">
<input type=hidden name=d_opcnvrrd value="%STANDARD.01.025.113.017.0.2">

<table cellpadding=3 cellspacing=0 bgcolor=#CCCCCC border=0 width=100%>
<tr><td>
   <input type=button value="<<" class=SmallButton
   onclick='location.href="%OPRWEB06.10.502"'>
   %OPRWEB06.10.507
   <input type=button value=">>" class=SmallButton
   onclick='location.href="%OPRWEB06.10.501"'>
   &nbsp;&nbsp;
    %STANDARD.01.017.YD
   <select class=PMenuSelectList name=surgtype 
    onchange='SelectPeriod.submit();'>
    <option value="ALL">All</option>
     %OPRWEB06.10.513.2
   </select>
   &nbsp;&nbsp;
    Show Admitted Theatre Patients
   <input type=checkbox name=showadmt value="1"
    onclick="SubmitPage();">
   &nbsp;&nbsp;
   Include Exit Patients
   <input type=checkbox name=inclexit value="1"
    onclick="SubmitPage();">
</td>
<td align=right id="recoveryclosed" class="Red Bold Large"></td>
<td><input type=button value="Close Recovery" class=button
     onclick="RecoveryClosedFrame();"></td>
<td align=right>
  <a href='javascript:SelectDateFrame();'>
  <img src="../images/DateLookup.gif" 
   alt="Select Date" class=Icon></a>
  <a href='javascript:SelectView("0");'>
  <img src=../images/DayIcon.gif 
   alt="View Today" class=Icon></a>
  <a href='javascript:SelectView("1");'>
  <img src=../images/WeekIcon.gif 
   alt="View This Week" class=Icon></a>
  <a href='javascript:SelectView("2");'>
  <img src=../images/MonthIcon.gif 
   alt="View This Month" class=Icon></a>
</td></tr>
</table>
</form>
</div>

<div id=TableLocation></div>

<form name=LinkForm method=get action=oprweb06.pbl>
<input type=hidden name=reportno value=10>
<input type=hidden name=template value=3>
<input type=hidden name=casekeys >
</form>
<form name=PACULinkForm method=get action=oprweb06.pbl>
<input type=hidden name=reportno value=10>
<input type=hidden name=template value=005>
<input type=hidden name=casekeys >
</form>
<script type="text/javascript">
function AddTableRows() {
 %OPRWEB06.10.511.oprweb06.10.003
}
RecoveryClosed="%OPRWEB06.10.517";
if(RecoveryClosed == "1") {
  document.getElementById('recoveryclosed').innerHTML="RECOVERY CLOSED";
  document.getElementById('recoveryclosed').className="Red Bold Large"; 
} else if(RecoveryClosed == "2") {
  document.getElementById('recoveryclosed').innerHTML="RECOVERY CLOSED";
  document.getElementById('recoveryclosed').className="Orange Bold Large"; 
}
InclueExit="%OPRWEB06.10.518";
if(InclueExit=="1") {
 SelectPeriod.inclexit.checked=true;
}
ShowAdmitted="%OPRWEB06.10.519";
if(ShowAdmitted=="1") {
 SelectPeriod.showadmt.checked=true;
}
</script>
