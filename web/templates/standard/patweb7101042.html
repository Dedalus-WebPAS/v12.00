<meta name="TemplateVersion" content="V12.00.02">
<meta name="TemplateHome" content="standard">
<meta name="CrossBrowser" content="true">
<meta name="HelpFileName"    content="NoContextSet.html">
<link rel="stylesheet" href="../html/postcode.css" type="text/css">
<script type="text/javascript" src=../js/AutoPostCode.js>  </script>
<script type="text/javascript" src=../js/Comp_MV.js>  </script>
<!-- Motor Vehicle -->

<script type="text/javascript">
function init() {
  var statusInc = document.UpdateForm.pmext055.value.substr(3,1);
  if (statusInc != "C" || document.UpdateForm.ccvistyp.value !== "3") {
    document.getElementById('ReasonForChange').style.display="none";
    RemoveClassName(document.UpdateForm.reasonchange,"Mandatory");
  } else {
    document.getElementById('ReasonForChange').style.display="";
    AddClassName(document.UpdateForm.reasonchange,"Mandatory");
  }
}

function setInsurance() {
  document.getElementById('InsuranceDIV').innerHTML=
                document.getElementById('InsuranceSPAN1').innerHTML;
  if (InsuranceKeywordSearch){
    document.getElementById('InsuranceDIV').innerHTML=
                document.getElementById('InsuranceSPAN2').innerHTML;
  }
}

function SubmitClaim() {
 if (valDateRespICWA(true)) {
   if(validateMandatory(UpdateForm)){
     if(document.UpdateForm.d_pmext138.checked==true) {
       document.UpdateForm.pmext138.value="1"
     } else {
       document.UpdateForm.pmext138.value="0";
     }

     if(document.UpdateForm.d_ffaddr.checked==true) {
       document.UpdateForm.pmext080.value=document.UpdateForm.d_pmext080.value;
     } else {
       document.UpdateForm.pmext080.value="";
     }

     if (document.UpdateForm.pmext055.value.substr(3,1) == "C") {
       var AltElection = document.UpdateForm.pmext140.options[document.UpdateForm.pmext140.selectedIndex].text;
       var str1 = "ICWA Claim Confirmed, Primary Claim Type for the Visit will be updated to ";
       var str2 = " and Insurance Company will be updated to the first code connected to ";
       var str3 = " if one exists.";
       if(confirm(str1 + AltElection + str2 + AltElection + str3) == false) {
         return;
       }
     }

     var statusInc = document.UpdateForm.pmext055.value.substr(3,1);
     if (statusInc=="C") {
       UpdateForm.reaschng.value=document.UpdateForm.reasonchange.value.substr(0,3);
     }

     UpdateForm.updatety.value="1";
     document.UpdateForm.submit();
   }
 }
}

</script>
%START.OF.PAGE
<body onLoad="PageLoad(event);setInsurance();GetDefaultIns();init();
              prtFormCheckType();">

<div id=PageHeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB71.01.003";
PatientVIS="%PATWEB71.01.081";
PatientNAM="%PATWEB71.01.002";
PatientSTA="%PATWEB71.01.086.078";
PatientALT="%PATWEB71.01.084";
PatientSEX="%PATWEB71.01.019";
PatientDOB="%PATWEB71.01.020";
PatientAGE="%PATWEB71.01.021";
PatientLOC="%PATWEB71.01.083";
PatientPRI="%PATWEB71.01.086.066.1";
PatientUNT="%PATWEB71.01.066.0";
DoctorCOD="%PATWEB71.01.082.003";
DoctorNAM="%PATWEB71.01.082.002";
PatientAID="%PATWEB71.01.086.090";
PatientIND="%PATWEB71.01.086.091";
PatientCUR="%PATWEB71.01.086.092";
PatientCLC="%PATWEB71.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB71.01.086.094";
PatientCDM="%PATWEB71.01.086.095";
PatientVDH="%PATWEB71.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
</div>
<div id=PageBodySection>
<form name=UpdateForm action="patweb98.pbl" method=get style="margin:0">
  <input type=hidden name=reportno value="05">
  <input type=hidden name=template value="042">
  <input type=hidden name=urnumber value="%PATWEB71.01.003">
  <input type=hidden name=admissno value="%PATWEB71.01.081">
  <input type=hidden name=updatety value=" ">
  <input type=hidden name=claimtyp value="X">
  <input type=hidden name=redirect value="%PATWEB71.01.001.patweb98.01.001">
  <input type=hidden name=nextpage value=1>
  <input type=hidden name=schdcopy value="1">
  <input type=hidden name=addeflag value="%PATWEB71.01.380">
  <input type=hidden name=finanelc value="%PATWEB71.01.365.1">
  <input type=hidden name=pmext001 value="%PATWEB71.01.081">
  <input type=hidden name=pmext002 value="%PATWEB71.01.365.1">
  <input type=hidden name=claimcod value="%PATWEB71.01.365.3">
  <input type=hidden name=pmext017 value="%PATWEB71.01.003">
  <input type=hidden name=pmext080 value="%PATWEB71.01.484.080">
  <input type=hidden name=pmext138 value="%PATWEB71.01.484.099.040">
  <input type=hidden name=statncod value="%PATWEB71.01.379.0">
  <input type=hidden name=statndes value="%PATWEB71.01.379.1">
  <input type=hidden name=faxnumbr value=" ">
  <input type=hidden name=dummy value="">
  <input type=hidden name=ccvistyp value="%PATWEB71.01.762">
  <input type=hidden name=ccvissta value="%PATWEB71.01.763">
  <input type=hidden name=pmext049 value="%PATWEB71.01.764">
  <input type=hidden name=reaschng value=" ">
  <input type=hidden name=admnstat value="%PATWEB71.01.199.020">
  <input type=hidden name=chngdsta value="">
  <input type=hidden name=visitty value="%PATWEB71.01.766.0">
  <input type=hidden name=visitst value="%PATWEB71.01.766.1">

<table border=0 width=100% cellspacing=0 cellpadding=0>
<tr><td class=HeadingCell align=center>
    Motor Vehicle Details</td></tr>
<tr><td>
</table>

<table cellspacing=0 cellpadding=1 border=0 align=center width=100%>

<tr><td class=DataLabel>Medicare Number</td>
    <td class="DataField">%PATWEB71.01.027 %PATWEB71.01.085.049</td>
    <td class=DataLabel>Solicitor Address Details</td>
    <td><input type="text" size="35" maxlength="35" name=pmext065 tabindex=13
      value="%PATWEB71.01.484.065" title="Solicitor Address 1">
    </td>
</tr>

<tr><td class=DataLabel>Claim Number</td>
    <td><input type="text" size="21" name="pmext013" 
         title="Claim Number" tabindex=1 value="%PATWEB71.01.484.013">
         <img src="../images/SearchIcon.gif" class=Icon
         onclick="lookUpMVI();">
    </td>
    <td class=DataLabel>&nbsp;</td>
    <td><input type="text" size="35" maxlength="35" name=pmext066 tabindex=14
      value="%PATWEB71.01.484.066" title="Solicitor Address 2">
    </td>
</tr>

<tr><td class=DataLabel>Alternate Election</td>
    <td><select name="pmext140" title="Alternate Election" tabindex=2
         class=Mandatory value="%PATWEB71.01.484.099.042.1">
        <option> </option>
         %PATWEB71.01.484.099.042.9.1.12.1.A
        </select></td>
    <td class=DataLabel>Suburb<br></td>
    <td><input type="text" size="35" maxlength="35" name=pmext067 tabindex=15
      value="%PATWEB71.01.484.067" title="Solicitor Address 3"
      onblur="valSolicitorPostCode();">
    </td>
</tr>

<tr><td class=DataLabel>Settled MVIT</td>
    <td><input type=checkbox tabindex=3
         title="Settled MVIT" name="d_pmext138"></td>
    <td class=DataLabel>State<br></td>
    <td><input type="text" size="35" maxlength="35" name=pmext068 tabindex=16
      value="%PATWEB71.01.484.068" title="Solicitor Address 4">
    </td>
<tr>

<tr><td class=DataLabel>Date of Accident</td>
    <td><input type=text name=pmext010 tabindex=4 class="PastDate Mandatory"
     title="Date of Accident" Size=12
     value="%PATWEB71.01.484.010">
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.pmext010>
    </td>
    <td class=DataLabel>Post Code</td>
    <td><input type="text" size="8" maxlength="8" name=pmext069 tabindex=17
      value="%PATWEB71.01.484.069" title="Solicitor Postcode"
      onchange="SetPostCode02();LookupSuburb(pmext069.value);">
    </td>
</tr>

<tr><td class=DataLabel>Accident Type</td>
    <td><select name="pmext139" title="Accident Type" tabindex=5
         class=Mandatory value="%PATWEB71.01.484.099.041.1" >
        <option> </option>
         %PATWEB71.01.484.099.041.2
        </select></td>
   <td class=DataLabel>Solicitor Contact Name</td>
    <td><input type="text" size="55" maxlength="50" name="pmext071" tabindex=18
        value="%PATWEB71.01.484.071" title="Solicitor Contact Name"></td>
</tr>

<tr><td class=DataLabel>Acc.Location</td>
    <td><input type="text" size="60" maxlength="50" tabindex=6
         class=Mandatory title="Accident Location" name="pmext095"
         value="%PATWEB71.01.484.087"></td>
    <td class=DataLabel>Solicitor Contact Phone</td>
    <td><input type="text" size="25" maxlength="20" name="pmext070" tabindex=19
        value="%PATWEB71.01.484.070" title="Solicitor Contact Phone"></td>
</tr>

<tr><td class=DataLabel>Insurance Company</td>
    <td><div id="InsuranceDIV"></div></td>
    <td class=DataLabel>Other Address</td>
    <td><input type=checkbox name=d_ffaddr tabindex=20
     title="Other Address"
     onclick="DispFFAddr();BillMand();"></td>
</tr>

<tr><td>Insurance Address</td>
    <td><input type="text" size="35" maxlength="35" name=insadd1
        class=ReadOnly readonly title="Insurance Address"></td>
    <td><div id=LContactAdd1></div></td>
    <td><div id=FContactAdd1></div></td></tr>

<tr><td>&nbsp;</td>
    <td><input type="text" size="35" maxlength="35" name=insadd2
        class=ReadOnly readonly title="Insurance Address"></td>
    <td><div id=LContactAdd2></div></td>
    <td><div id=FContactAdd2></div></td></tr>

<tr><td>Suburb</td>
    <td><input type="text" size="35" maxlength="35" name=insadd3
        class=ReadOnly readonly title="Insurance Address"></td>
    <td><div id=LContactAdd3></div></td>
    <td><div id=FContactAdd3></div></td></tr>

<tr><td>&nbsp;</td>
    <td><input type="text" size="35" maxlength="35" name=insadd4
        class=ReadOnly readonly title="Insurance Suburb"></td>
    <td><div id=LContactAdd4></div></td>
    <td><div id=FContactAdd4></div></td></tr>
 
<tr><td>Post Code</td>
    <td><input type="text" size="8" maxlength="8" name=inspcode
        class=ReadOnly readonly title="Insurance Postcode"></td>
    <td><div id=LContactPCode></div></td>
    <td><div id=FContactPCode></div></td></tr> 

<tr><td>Contact Name</td>
    <td><input type="text" size="50" maxlength="50" name=inscname
        class=ReadOnly readonly title="Insurance Contact Name"></td>
    <td><div id=LContactPName></div></td>
    <td><div id=FContactPName></div></td></tr>

<tr><td>Contact Phone</td>
    <td><input type="text" size="20" maxlength="20" name=insctelp
        class=ReadOnly readonly title="Insurance Contact Phone"></td>
    <td><div id=LContactPhone></div></td>
    <td><div id=FContactPhone></div></td></tr>

<tr><td class=DataLabel>Date Sent to ICWA</td>
    <td><input type=text name=pmext039 tabindex=30 class="PastDate"
     title="Date Sent to ICWA" Size=12 value="%PATWEB71.01.484.039" 
     onblur="valDateSentICWA()">
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.pmext039></td>
    <td class=DataLabel>Comments</td>
    <td><input type="text" size="55" maxlength="50" name=pmext059 tabindex=30
        value="%PATWEB71.01.484.059" title="Comments"></td>
</tr>

<tr><td class=DataLabel>Date ICWA Responded</td>
    <td><input type=text name=pmext040 tabindex=31 class="PastDate"
     title="Date ICWA Responded" Size=12 value="%PATWEB71.01.484.040" 
     onblur="valDateRespICWA()">
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.pmext040></td>
    <td class=DataLabel>&nbsp;</td>
    <td><input type="text" size="55" maxlength="50" name=pmext060 tabindex=31
        value="%PATWEB71.01.484.060" title="Comments"></td>
</tr>

<tr><td class=DataLabel>Status</td>
    <td><select name=pmext055 id=pmext055 title="Status" tabindex=34 class="Mandatory" onchange="valStatus()">
        %STANDARD.01.021.Vh
        </select></td>
    <td class=DataLabel>&nbsp;</td>
    <td><input type="text" size="55" maxlength="50" name=pmext061 tabindex=32
         value="%PATWEB71.01.484.061" title="Comments"></td>
</tr>

<tr id=ReasonForChange>
    <td class=DataLabel>%STANDARD.01.035.IZ</td>
    <td><select name=reasonchange id=reasonchange title="Reason for Change" tabindex=33 class="Mandatory">
        <option></option>
        %STANDARD.01.007.IZ
        </select></td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataLabel>&nbsp;</td>
</tr>

</table>

<span id="prntclmform"></span>

<table cellspacing=0 cellpadding=1 border=0 align=center width=100%>
<tr><td align=center colspan=4>
    <input type=button value="Update" id=updbtn class="button" 
         onclick="tempDisable(this);SubmitClaim();">
        <input type=button value="Cancel" class="button" 
         onclick="SetClose();"></td>
    </tr>
</table>

</form>
</div>

<div id=SelectHeading></div>
<div id=SelectLocation></div>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB71.01.003">
<input type=hidden name=admissno value="%PATWEB71.01.081">
<input type=hidden name=MenuType value="%PATWEB71.01.088">
</form>

<span id="prntclmforms" style="display: none">
<table cellspacing=0 cellpadding=1 border=0 align=center width=100%>
<tr><td class=DataLabel width=15%>Print %STANDARD.01.017.CL Form</td>
    <td><input type=checkbox name=prtform1 value="1" tabindex=33
         onclick="SetPrinterAlt();">
    </td>
    <td class=DataLabel>Stationery Code</td>
    <td><input type=text name=d_statncod size=30
     class=ReadOnly readonly>
    <input type=hidden name=schform1 value="%PATWEB71.01.379.0">
    <input type=hidden name=sfrmdes1></td>
    <td class=DataLabel>Printer</td>
    <td><select name=schdprt1 title="Printer" tabindex=34 disabled>
        <option></option>
         %STANDARD.01.001.ELECTFRM.0X
        </select>
    </td>
</tr>
<tr><td class=DataLabel width=15%>Print Alternate %STANDARD.01.017.CL Form</td>
    <td><input type=checkbox name=prtform2 value="1" tabindex=33
         onclick="SetPrinterAltMVIT();">
    </td>
    <td class=DataLabel>Stationery Code</td>
    <td><select name=schform2 title="Form" tabindex=34 disabled>
        <option></option>
        %STANDARD.01.020.  5
        </td>
    <td class=DataLabel>Printer</td>
    <td><select name=schdprt2 title="Printer" tabindex=34 disabled>
        <option></option>
         %STANDARD.01.001.ELECTFRM.1X
        </select>
    </td>
</tr>
</table>
</span>

<span id="InsuranceSPAN1" style="display:none">
  <select name="pmext012" id="pmext012" title="Insurance Company" tabindex=7
         value="%PATWEB71.01.484.012.0"
         onchange="DisplayIns();">
        <option> </option>
         %PATWEB71.01.383.0
   </select>
</span>

<span id="InsuranceSPAN2" style="display:none">
  <input type="text" size="6" name="pmext012" id="pmext012" tabindex=7
      value="%PATWEB71.01.484.012.0" title="Insurance"
    onchange="DisplayIns();">

  <input type="text" size="35" name="d_pmext012" id="d_pmext012"
         maxlength="30" value="%PATWEB71.01.484.012.1"
      title="Insurance">
    <img src="../images/SearchIcon.gif" class=Icon
        onclick="InsuranceSearchFrame(pmext012,d_pmext012);">
        <img src="../images/ClearIcon.gif" class=Icon
        onclick="clrFields(pmext012,d_pmext012,insadd1,insadd2,insadd3,
                    insadd4,inspcode,inscname,insctelp,faxnumbr);">
</span>

<span id=LFAdd1 style="display:none">
     Address
</span>
<span id=LFAdd3 style="display:none">
     Suburb
</span>
<span id=LFAdd4 style="display:none">
     State
</span>
<span id=LFPostCode style="display:none">
     Post Code
</span>
<span id=LFCName style="display:none">
     Contact Name
</span>
<span id=LFCPhone style="display:none">
     Contact Phone
</span>

<span id=FFAdd1 style="display:none">
       <input type="text" size="35" maxlength="35" name=d_pmext080 tabindex=21
      class=Mandatory value="%PATWEB71.01.484.080" title="Free format Address">
</span>

<span id=FFAdd2 style="display:none">
      <input type="text" size="35" maxlength="35" name=pmext081 tabindex=22
      value="%PATWEB71.01.484.081" title="Free format Address">
</span>

<span id=FFAdd3 style="display:none">
      <input type="text" size="35" maxlength="35" name=pmext082 tabindex=23
      value="%PATWEB71.01.484.082"
      onblur="valPostCode();">
</span>

<span id=FFAdd4 style="display:none">
      <input type="text" size="35" maxlength="35" name=pmext083 tabindex=24
      value="%PATWEB71.01.484.083" title="Free format Address">
</span>

<span id=FFPCode style="display:none">
      <input type="text" size="8" maxlength="8" name=pmext084 tabindex=25
      value="%PATWEB71.01.484.084" title="Free format Address"
      onchange="SetPostCode03();LookupSuburb(pmext084.value);">
</span>

<span id=FFCName style="display:none">
      <input type="text" size="50" maxlength="50" name=pmext085 tabindex=26
      value="%PATWEB71.01.484.085" title="Free format Contact Name">
</span>

<span id=FFCPhone style="display:none">
      <input type="text" size="20" maxlength="20" name=pmext086 tabindex=27
      value="%PATWEB71.01.484.086" title="Free format Contact Phone">
</span>


<script LANGUAGE=javascript>
function SetClose() {
var urnumber ="%PATWEB71.01.003";
var admissno ="%PATWEB71.01.081";
var link = "patweb98.pbl?reportno=01&template=001&urnumber="+urnumber+"&admissno="+admissno;
  location.href= link;
}

if(document.UpdateForm.pmext138.value=="1"){
   document.UpdateForm.d_pmext138.checked=true;
 } else {
   document.UpdateForm.d_pmext138.checked=false;
 }

 address="%PATWEB71.01.484.080";
 if(!isWhitespace(address)) {
   document.UpdateForm.d_ffaddr.checked=true;
 } else {
   document.UpdateForm.d_ffaddr.checked=false;
 }

 ffadd="%PATWEB71.01.484.080";
  if (!isWhitespace(ffadd)) {
    DispFFAddr();
  }
 mandfield=document.UpdateForm.claimcod.value.substr(34,1);
  if (mandfield!="B") {
     if(isWhitespace(address)) {
       document.getElementById('pmext012').className="Mandatory";
     }
  }

function valDateSentICWA() {
  var dateAcc = SetDateYYYYMMDD(document.UpdateForm.pmext010.value);
  var dateSentIC = SetDateYYYYMMDD(document.UpdateForm.pmext039.value);
  var dateRespIC = SetDateYYYYMMDD(document.UpdateForm.pmext040.value);
  if (isWhitespace(dateSentIC)) return;
  if (dateSentIC < dateAcc) {
    alert("'Date Sent to ICWA' cannot be before 'Date of Accident'.");
    document.UpdateForm.pmext039.value = "";
    return;
  }
  if (!isWhitespace(dateRespIC) && dateRespIC < dateSentIC) {
    alert("'Date ICWA Responded' cannot be before 'Date Sent to ICWA'.");
    document.UpdateForm.pmext040.value = "";
    return;
  }
}

function valDateRespICWA(isSubmit) {
  var dateAcc = SetDateYYYYMMDD(document.UpdateForm.pmext010.value);
  var dateSentIC = SetDateYYYYMMDD(document.UpdateForm.pmext039.value);
  var dateRespIC = SetDateYYYYMMDD(document.UpdateForm.pmext040.value);
  if (isWhitespace(dateSentIC) & !isSubmit) {
    alert("'Date Sent to ICWA' cannot be blank.");
    document.UpdateForm.pmext039.focus();
    return false;
  } else if (isWhitespace(dateSentIC) && !isWhitespace(dateRespIC)) {
    alert("'Date ICWA Responded' cannot be entered if" +
          "'Date Sent to ICWA' is blank'.");
    document.UpdateForm.pmext039.focus();
    return false;
  } else if (!isWhitespace(dateRespIC) && dateRespIC < dateSentIC) {
    alert("'Date ICWA Responded' cannot be before 'Date Sent to ICWA'.");
    document.UpdateForm.pmext040.value = "";
    return false;
  }
  if (isSubmit) {
    if (!isWhitespace(dateSentIC) && dateSentIC < dateAcc) {
      alert("'Date Sent to ICWA' cannot be before 'Date of Accident'.");
      document.UpdateForm.pmext039.value = "";
      return false;
    }
  }
  return true;
}

function valStatus() {
  var statusInc = document.UpdateForm.pmext055.value.substr(3,1);
  var dateSentIC = document.UpdateForm.pmext039.value;
  var dateRespIC = document.UpdateForm.pmext040.value;
  var visType = document.UpdateForm.ccvistyp.value;
  var visStat = document.UpdateForm.ccvissta.value;
  var admnStat = document.UpdateForm.admnstat.value;
  var visitTy = document.UpdateForm.visitty.value;
  var visitSt = document.UpdateForm.visitst.value;
  var currentStatus="%PATWEB71.01.484.055.3"
  var status = document.UpdateForm.pmext055;

  if (statusInc == "C" & visitTy == "3" & visitSt == "1") {
    alert("Pre-admission visit cannot have a Confirmed Status");
    for (var i=0; i < status.options.length; i++) {
      if (currentStatus.substr(3,1) == status.options[i].value.substr(3,1)) {
        status.value = status.options[i].value;
        document.UpdateForm.pmext055.focus();
        return;
      }
    }
  }

  if (statusInc == "C" & visitTy == "2" & visitSt != "4") {
    alert("A non-attended Outpatient visit cannot have a Confirmed Status");
    for (var i=0; i < status.options.length; i++) {
      if (currentStatus.substr(3,1) == status.options[i].value.substr(3,1)) {
        status.value = status.options[i].value;
        document.UpdateForm.pmext055.focus();
        return;
      }
    }
  }

  if (statusInc == "C" & visitTy == "1" & visitSt == "1") {
    alert("A non-discharged Emergency visit cannot have a Confirmed Status");
    for (var i=0; i < status.options.length; i++) {
      if (currentStatus.substr(3,1) == status.options[i].value.substr(3,1)) {
        status.value = status.options[i].value;
        document.UpdateForm.pmext055.focus();
        return;
      }
    }
  }

  if (statusInc == "C" & visitTy == "1" & visitSt == "4") {
    alert("A non-discharged Emergency visit cannot have a Confirmed Status");
    for (var i=0; i < status.options.length; i++) {
      if (currentStatus.substr(3,1) == status.options[i].value.substr(3,1)) {
        status.value = status.options[i].value;
        document.UpdateForm.pmext055.focus();
        return;
      }
    }
  }

  if (statusInc == "A") {
    if (isWhitespace(dateSentIC)) {
      alert("'Date Sent to ICWA' cannot be blank.");
      focusOnCL("P");
      document.UpdateForm.pmext039.focus();
      return;
    }
    if (visType !== "3") {
      alert("Patient must have an inpatient visit type.");
      focusOnCL("P");
      return;
    }
  }

  if (statusInc == "D") {
    if (isWhitespace(dateSentIC)) {
      alert("'Date Sent to ICWA' cannot be blank.");
      focusOnCL("P");
      document.UpdateForm.pmext039.focus();
      return;
    }
    if (visType !== "3") {
      alert("Patient must have a visit type of Inpatient.");
      focusOnCL("P");
      return;
    }
    if (visStat !== "3") {
      alert("Patient must be discharged.");
      focusOnCL("P");
      return;
    }
  }

  if (statusInc != "P") {
    if (isWhitespace(dateRespIC)) {
      alert("'Date ICWA Responded' cannot be blank.");
      focusOnCL("P");
      return;
    }
  }

  if (statusInc != "C" || document.UpdateForm.ccvistyp.value !== "3") {
    document.getElementById('ReasonForChange').style.display="none";
    RemoveClassName(document.UpdateForm.reasonchange,"Mandatory");
  } else {
    document.getElementById('ReasonForChange').style.display="";
    AddClassName(document.UpdateForm.reasonchange,"Mandatory");
  }

  document.UpdateForm.chngdsta.value = statusInc;
}

function focusOnCL(clCode) {
  selectedCL="%PATWEB71.01.484.055.3"
  var statusCode = selectedCL.substring(0,3);
  var ICWAStatus = document.UpdateForm.pmext055;
  if (!isWhitespace(selectedCL.substr(3,1))) {
    clCode = selectedCL.substr(3,1);
  }

  if (!isWhitespace(document.UpdateForm.chngdsta.value)) {
     clCode = document.UpdateForm.chngdsta.value;
  }

  for (var i = 0; i < document.UpdateForm.pmext055.options.length; i++) {
    if (ICWAStatus.options[i].value.substr(3,1) == clCode) {
      if(isWhitespace(statusCode)) {
        ICWAStatus.value = ICWAStatus.options[i].value;
      } else {
        if(ICWAStatus.options[i].value.substring(0,3)== statusCode) {
          ICWAStatus.value = ICWAStatus.options[i].value;
        }
      }
    }
  }
}

function focusOnCLCode(clCode) {
  selectedCL="%PATWEB89.01.999.125.055.3"
  if (!isWhitespace(selectedCL.substr(0,3))) {
    clCode = selectedCL.substr(0,3);
  }

  if (!isWhitespace(document.UpdateForm.chngdsta.value)) {
    clCode = document.UpdateForm.chngdsta.value;
  }

  for (var i = 0; i < document.UpdateForm.pmext055.options.length; i++) {
    if (document.UpdateForm.pmext055.options[i].value.substr(0,3) == clCode) {
      document.UpdateForm.pmext055.value =
      document.UpdateForm.pmext055.options[i].value;
    }
  }
}

function checkMVITForm() {
  if (document.UpdateForm.statncod.value = ".0" ||
      isWhitespace(document.UpdateForm.statncod.value)) {
    document.UpdateForm.schform1.value = "FIN   ";
    var schForm2 = document.UpdateForm.schform2;
    schForm2.value = "FIN   ";
    var schForm2Text = schForm2.options[schForm2.selectedIndex].text;
    document.UpdateForm.d_statncod.value = schForm2Text;
    document.UpdateForm.sfrmdes1.value = schForm2Text;
  } else {
    document.UpdateForm.schform1.value = document.UpdateForm.statncod.value;
  }
  document.UpdateForm.schform2.value = "ICWA  ";
  document.UpdateForm.prtform1.checked = true;
  document.UpdateForm.prtform2.checked = true;
  SetPrinterAlt();
  SetPrinterAltMVIT();
}

function prtFormCheckType() {
  if (document.UpdateForm.ccvistyp.value == "3") {
    document.getElementById("prntclmform").innerHTML =
    document.getElementById("prntclmforms").innerHTML;
    document.getElementById("prntclmforms").innerHTML = "";
    checkMVITForm(); 
  }
}

focusOnCL("P");
for (var i=0;i<document.UpdateForm.pmext140.length;i++) {
  if (isWhitespace(document.UpdateForm.pmext140[i].value)) continue;
  var codeSingle = document.UpdateForm.pmext140[i].value.substr(3, 5);
  if (codeSingle.match(/M/g) == null) {
    document.UpdateForm.pmext140.options[i].remove(i);
    i--;
  }
}
ReasonForChange="%PATWEB71.01.765";
for (var i=0;i<document.UpdateForm.reasonchange.options.length;i++) {
  if (document.UpdateForm.reasonchange.options[i].value.substr(0,3)
      == ReasonForChange) {
    document.getElementById('reasonchange').value =
    document.getElementById('reasonchange').options[i].value;
  }
}
</script>
