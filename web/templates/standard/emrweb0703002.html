<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function AddRecord()
{
  f=document.AddForm;
  // if off date is not blank and off time is blank
  if(!isWhitespace(f.embps006.value) && isWhitespace(f.embps007.value)) {
    alert("Can't enter Off Pre/By-Pass date without time.");
    f.embps007.focus();
    return;
  }
  // if off date is blank and off time is not blank
  if(isWhitespace(f.embps006.value) && !isWhitespace(f.embps007.value)) {
    alert("Can't enter Off Pre/By-Pass time without date.");
    f.embps006.focus();
    return;
  }
  // check if off date/time is before on date/time
  if(!CheckDateTimeRange(f.embps003,f.embps004,f.embps006,f.embps007)) {
    alert("Off Pre/By-Pass date/time can't be before " +
          "On Pre/By-Pass date/time.");
    f.embps006.focus();
    return;
  }
  if (validateMandatory(AddForm))
  {
    if (!Validateresontxt()) { return; }
    SubmitHiddenNew(AddForm);
  }
}

function Validateresontxt()
{
  onblurHandler();
  var formatedtext=formateText(AddForm.resontxt,'100');
  if ((formatedtext.split(/[\r\n]/).length>5) ||
      (AddForm.resontxt.value.length > 500))
  {
    alert("Reason for Pre/By-Pass comments - Max 5 lines." +
          "\nPlease remove extra rows to continue.");
    document.AddForm.resontxt.focus();
    return false;
  }
  return true;
}

function validatePrinterCheckBox()
{
  if (document.AddForm.chkprint != undefined)
  {
    if (document.AddForm.chkprint.checked == true)
    {
      document.AddForm.printchk.value = "1";
      document.AddForm.schdprnt.className = "Mandatory";
    }
    else
    {
      document.AddForm.printchk.value = "0";
      document.AddForm.schdprnt.className = " ";
    }
  }
}
 
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);validatePrinterCheckBox();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
Add Pre By-Pass/By-Pass Details
</span>

<form name=AddForm method=post action=emrweb07.pbl style="margin:0">
 <input type=hidden name=reportno value="3">
 <input type=hidden name=template value="002">
 <input type=hidden name=updttype value="A">
 <input type=hidden name=nextpage value="3">
 <input type=hidden name=printchk value=" ">
 <input type=hidden name=embps001 value="%EMRWEB07.03.029">
 
<table align=center width=100% border=0 cellspacing=1 cellpadding=1>
<tr>
  <td class=DataLabel>By-Pass Type</td>
  <td colspan=5>
    <select name=embps002 title="Type" onchange="changeTitle();"
     class=Mandatory>
      <option value="0">Pre By-Pass</option>
      <option value="1">By-Pass</option>
    </select>
  </td>
</tr>

<tr>
  <td class=DataLabel nowrap>
    <span id="onDateTime">On Pre By-Pass Date/Time&nbsp;</span>
  </td>
  <td>
    <input type="text" name=embps003 size=12
     value="%STANDARD.01.015" class="Mandatory PastDate" title="Date">
    <img src=../images/DateLookup.gif class="Icon"
     onclick="DateLookupFrame(AddForm.embps003);">
    <input type="text" name=embps004 size=8 class=Mandatory title="Time"
     value="%STANDARD.01.016">
    <img src="../images/DateTimeStamp.gif" class="Icon"
     onclick="SetCurrentDateTime(AddForm.embps003,AddForm.embps004);">
    <img src="../images/TimeLookup.gif" class="Icon"
     onclick="TimeLookupFrame(AddForm.embps004);">
  </td>

  <td class=DataLabel nowrap align=center>
    <span id="prtlabel">Print Pre By-Pass Report</span>
  </td>
  <td>
    <input class="checkbox" type="checkbox" name="chkprint"
     title="By-Pass Type" onclick="validatePrinterCheckBox();" checked>
  </td>
  <td class=DataLabel style="text-align:right">Printer&nbsp;</td>
  <td>
    <select name="schdprnt" title="Printer" class="Mandatory">
      <option></option>
      %STANDARD.01.001.IBAEMR23.01
    </select>
  </td>
</tr>

<tr>
  <td class=DataLabel nowrap>
    <span id="offDateTime">Off Pre By-Pass Date/Time&nbsp;</span>
  </td>
  <td>
    <input type="text" name=embps006 size=12 class="PastDate" title="Date">
    <img src=../images/DateLookup.gif  class="Icon"
     onclick="DateLookupFrame(AddForm.embps006);">
    <input type="text" name=embps007 size=8 title="Time">
    <img src="../images/DateTimeStamp.gif" class="Icon"
     onclick="SetCurrentDateTime(AddForm.embps006,AddForm.embps007);">
    <img src="../images/TimeLookup.gif" class="Icon"
     onclick="TimeLookupFrame(AddForm.embps007);">
  </td>
  <td class=DataLabel style="text-align:center">Number of Ambulances</td>
  <td colspan=3>
    <input type=text name=embps013 title="Ambulances" size=3 maxlength=3>
  </td>
</tr>
    
<tr>
  <td class=DataLabel>
    <span id ="reason">Reason for Pre By-Pass</span>
  </td>
  <td colspan=5>
    <select name=embps005 title="Reason" class="Mandatory">
      <option></option>
      %EMRWEB07.03.015.2
    </select>
  </td>
</tr>

<tr>
  <td class=DataLabel>Doctor</td>
  <td nowrap>
    <input type="text" name=embps020 class=Mandatory title="Doctor Code"
     size="8" maxlength="6" 
     onblur="ValidateHCP(18,0,AddForm.embps020,AddForm.doctname);"/>
    <input type="text" readonly class="ReadOnly" size="25"
     title="Doctor Name" name="doctname" tabindex="-1"
     onfocus="this.blur();AddForm.embps020.focus();" />
    <img src="../images/SearchIcon.gif" class="Icon"
     onclick="HCPSearchFrame(AddForm.embps020,AddForm.doctname,0);" />
    <img src="../images/erase.gif" class="Icon"
     onclick="clrDoc(AddForm.embps020,AddForm.doctname);" />
  </td>
  <td class=DataLabel style="text-align:right">Nurse&nbsp;&nbsp;&nbsp;</td>
  <td>
    <input type="text" name=embps021 size="20" maxlength="45"
     title="Nurse (Authorisation)" class="Mandatory"/>
  </td>
  <td class=DataLabel nowrap style="text-align:right">Co-ordinator&nbsp;</td>
  <td>
    <input type="text" name=embps022 size="20" maxlength="45"
     title="Co-ordinator (Authorisation)" class="Mandatory"/>
  </td>
</tr>

<tr>
  <td class=DataLabel>&nbsp;</td>
  <td colspan=5>
    <textarea type="text" name=resontxt wrap=hard cols=100 rows=5
     onkeydown="LimitText(this,5,500);" onblur="Validateresontxt();">
    </textarea>
  </td>
</tr>

<tr>
  <td colspan=6 align=center><br>
    <input type=button value="Add" class="button"
     onclick="AddRecord();"/>
    <input type=button value="Close" class="button"
     onclick="DFrameCloseRefresh();"/>
  </td>
</tr>
</table>

</form>

<script type="text/javascript">
function changeTitle()
{
  var d = document;

  if (d.AddForm.embps002.value=="0") {
     d.getElementById("onDateTime").innerText="On Pre By-Pass Date/Time";
     d.getElementById("offDateTime").innerText="Off Pre By-Pass Date/Time";
     d.getElementById("reason").innerText="Reason for Pre By-Pass";
     d.getElementById("prtlabel").innerText="Print Pre By-Pass Report";
  }
  else {
     d.getElementById("onDateTime").innerText="On By-Pass Date/Time";
     d.getElementById("offDateTime").innerText="Off By-Pass Date/Time";
     d.getElementById("reason").innerText="Reason for By-Pass";
     d.getElementById("prtlabel").innerText="Print By-Pass Report";
  }
}
</script>
