<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
var ItemNo=100;

function SelectDeselectAllRows() {
  if (document.AddForm.markall.checked) {
    SelectAllRows();
  }
  else {
    DeselectAllRows();
  }
}
function SelectAllRows() {
  for (x=101;x<900;x++) {
    if (document.getElementById('crkey'+x) == null) {
      return;
    }
    else {
      fld='crchr' + x;
      if (document.getElementById(fld).type=="checkbox") {
        if (!document.getElementById(fld).disabled) {
          if (!document.getElementById(fld).checked) {
            document.getElementById(fld).checked=true;
          }
        }
      }
    }
  }
}
function DeselectAllRows() {

  for (x=101;x<900;x++) {
    if (document.getElementById('crkey'+x) == null) {
      return;
    }
    else {
      fld='crchr' + x;
      if (document.getElementById(fld).type=="checkbox") {
        if (!document.getElementById(fld).disabled) {
          if (document.getElementById(fld).checked) {
            document.getElementById(fld).checked=false;
          }
        }
      }
    }
  }
}
function displayNzFields() {
  f = document.AddForm;
  if (f.ptcnhdps.value == "1") {
    document.getElementById('ShowInclTypeNZ').style.display = "";
    document.getElementById('ShowProcCodeSearchNZ').style.display = "";
    document.getElementById('ShowProcDescNZ').style.display = "";
    document.getElementById('ShowInclTypeAUS').style.display = "none";
    document.getElementById('ShowProcCodeSearchAUS').style.display = "none";
    document.getElementById('ShowProcDescAUS').style.display = "none";
  }
  else {
    document.getElementById('ShowInclTypeNZ').style.display = "none";
    document.getElementById('ShowProcCodeSearchNZ').style.display = "none";
    document.getElementById('ShowProcDescNZ').style.display = "none";
    document.getElementById('ShowInclTypeAUS').style.display = "";
    document.getElementById('ShowProcCodeSearchAUS').style.display = "";
    document.getElementById('ShowProcDescAUS').style.display = "";
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);
              GetItemInfo();
              SelectDeselectAllRows();
              displayNzFields();">
<span class=DFrameTitleBar>
<img border=0 align=right src="../images/ExitIcon.gif" class=MenuIcon
     onclick="DFrameExitRefresh();">
<script type="text/javascript">
document.write('Charge Requisitions');
</script>
</span>

<div id=PageBodySection style="overflow:auto;">

<form name=AddForm method=post action=patweb75.pbl style="margin:0"
   onsubmit='return validateMandatory();'>
   <input type=hidden name=reportno value="1">
   <input type=hidden name=template value="007">
   <input type=hidden name=updatety value="A">
   <input type=hidden name=urnumber value='%OPRWEB06.14.003'>
   <input type=hidden name=admissno value='%OPRWEB06.14.081'>
   <input type=hidden name=casekeys value="%OPRWEB06.14.101">
   <input type=hidden name=uniqueky value="%OPRWEB06.14.110">
   <input type=hidden name=teamnumb value="%OPRWEB06.14.301">
   <input type=hidden name=opreq001 value="%OPRWEB06.14.110">
   <input type=hidden name=opreq002 value="%OPRWEB06.14.301">
   <input type=hidden name=opreq007 value="%OPRWEB06.14.303.003">
   <input type=hidden name=preftype value="%OPRWEB06.14.305">
   <input type=hidden name=opcnptmc value="%STANDARD.01.025.113. 66.0.1">
   <input type=hidden name=multhosp value="%STANDARD.01.032">
   <input type=hidden id=mdate000 name=mdate000 value="%OPRWEB06.14.316">
   <input type=hidden name=uniqu000 value="">
   <input type=hidden name=nextpage value="0">
   <input type=hidden name=dummy value="">
   <input type=hidden name=cfeetyp value="%STANDARD.01.025.019.212.0.1">
   <input type=hidden name=postflag value="0">
   <input type=hidden name=keynflag value="0">
   <input type=hidden name=submitfl value="0">
   <input type=hidden name=ptcnhdps id=ptcnhdps
    value="%STANDARD.01.025.080.250.0.1">

<table align=center width=98% border=0>
<tr><td class=DataLabel align=left width=20%>
    Theatre Team No. &nbsp;&nbsp;&nbsp;</td>
    <td><select name=teamnumb onchange="ChangeTeamPref();">
    %OPRWEB06.14.148
    </select></td>
    <td class=DataLabel align=left width=20%>Operating Surgeon</td>
    <td><b>%OPRWEB06.14.303.002</b></td>
    <td class=DataLabel align=left width=20%>Anaesthetist</td>
    <td><b>%OPRWEB06.14.315.002</b></td>
</tr>
<tr>
    <td><b>Requisitions</b></td>
</tr>
</table>

<table align=center width=98% border=0>
<tr>
    <td id=ShowInclTypeNZ width=30%>Incl type &nbsp;&nbsp;
      <select name=incty000 title='Inclusion Type' class='NoAutoFocus'>
        <option value='0'>Included in Contract</option>
        <option value='1'>Bill to Patient</option>
        <option value='2'>Extra to Contract</option>
      </select>
    </td>
    <td id=ShowInclTypeAUS width=30%>&nbsp;</td>
    <td id=ShowProcCodeSearchNZ width=50%>Procedure &nbsp;
        <img src="../images/SearchIcon.gif" class='Icon'
         onclick="LookupProc(AddForm.admissno,
                             AddForm.uniqu000,
                             AddForm.proce000,
                             AddForm.incty000,
                             AddForm.procdesc,
                             ItemNo);">
        <input type=text size=9 name=proce000 value="%OPRWEB06.14.318"
         maxlength=9 title='Procedure' class=readonly
         readonly=true ></td>
    <td id=ShowProcCodeSearchAUS width=50%>&nbsp;</td>
    <td>Mark All
        <input type=checkbox name=markall title="Mark All" value="0"
         onclick="SelectDeselectAllRows();">
    </td>
</tr>
</table>

<table align=center width=98% border=0>
<tr>
    <td class=DataLabel width=50%><td>
    <td id=ShowProcDescNZ>Description &nbsp;&nbsp;
       <input type=text size=80 name=procdesc id=procdesc
         class="Readonly" readonly
         value="%OPRWEB06.14.328">
    </td>
    <td id=ShowProcDescAUS width=50%>&nbsp;</td>
</tr>

</table>

<table align=center cellspacing=0 cellpadding=1 width=100% border=0>
     %OPRWEB06.14.329
</table>

<table align=center width=100% border=0>
<tr><td colspan=2 align=center><br>
    <input type=button id="opr06sub" value="Add Charges" class="button" 
     onclick="tempDisable(this);ChargeRequisitions();">
    <input type=button value="Cancel" class="button" 
     onclick='DFrameCloseRefresh()'>
</td></tr>
</table>

</form>
</div>

<script type="text/javascript">

 FilterInc="%OPRWEB06.14.317";
 for (var i =0 ; i < document.AddForm.incty000.length; i++) {
   if (document.AddForm.incty000.options[i].value==trim(FilterInc)) {
       document.AddForm.incty000.selectedIndex=i;
   }
 }

 if (isWhitespace(document.AddForm.uniqu000.value)){
   unique="%OPRWEB06.14.319";
   document.AddForm.uniqu000.value=unique;
 }

function ChangeTeamPref() {
   urllink="oprweb06.pbl?reportno=14&template=001" +
           "&casekeys=" + AddForm.casekeys.value.replace(/ /g,"+") +
           "&uniqueky=" + AddForm.uniqueky.value.replace(/ /g,"+") +
           "&teamnumb=" + AddForm.teamnumb.value;
   location.href=urllink;
}
function LookupProc(admissno,RETuniq,RETproc,IncTy,RETprocd,RETitem){
  var PopUpFrameDoc = DFrameStart();
  window.admissno=admissno;
  window.RETproc=RETproc;
  window.RETuniq=RETuniq;
  window.RETitem=RETitem;
  window.RETprocd=RETprocd;
  PopUpFrameDoc.location.href = "../lookups/NZProcedureSearchFrame.html";
  SearchFrameShow();
}
function UpdateReq(reqkey) {
  teamnumb=reqkey.substr(10,1);
  doctcode=reqkey.substr(11,6);
  reqclass=reqkey.substr(17,3);
  itemtype=reqkey.substr(20,1);
  itemcode=reqkey.substr(21,15);
  linkurl="oprweb06.pbl?reportno=14&template=003" +
          "&casekeys=" + AddForm.casekeys.value.replace(/ /g,"+") +
          "&uniqueky=" + AddForm.uniqueky.value.replace(/ /g,"+") +
          "&opreq001=" + AddForm.uniqueky.value.replace(/ /g,"+") +
          "&opreq002=" + teamnumb +
          "&opreq007=" + doctcode.replace(/ /g,"+") +
          "&opreq003=" + reqclass.replace(/ /g,"+") +
          "&opreq004=" + itemtype.replace(/ /g,"+") +
          "&opreq005=" + itemcode.replace(/ /g,"+");
  Left=(document.body.clientWidth-500)/2
  DFrameLink(linkurl,0,Left,500,300)
}
function zeroFill( number, width )
{
  width -= number.toString().length;
  if ( width > 0 )
  {
    return new Array( width + (/\./.test( number ) ? 2 : 1) ).join( '0' ) + number;
  }
  return number + ""; // always return a string
}
function ChargeRequisitions() {
  AssignUniquIncty();

  if (document.AddForm.submitfl.value == 1) {
    alert('Update is in progress. Please wait.');
    return;
  }
 
  document.AddForm.submitfl.value = 1;
  document.AddForm.submit();
}
function GetItemInfo() {

  for (x=101;x<900;x++) {
    y = zeroFill(x-100,3)
    if (document.getElementById('crkey'+x) == null){break;}

    document.getElementById('mdate'+x).value=
    document.getElementById('mdate000').value;

    document.getElementById('qunty'+x).value=
    trim(document.getElementById('qunty'+x).value);

    if (isWhitespace(document.getElementById('itemn'+x).value)) {
      if (document.getElementById('crchl'+x)!=undefined) {
        if (document.getElementById('crchl'+x).value!="charged") {
          document.getElementById('crchr'+x).checked=false;
          document.getElementById('crchr'+x).disabled=true;
        }
      }

      document.getElementById('crqua'+x).className="ReadOnly";
      document.getElementById('crqua'+x).readOnly=true;
    }

    if (document.getElementById('crchl'+x)!=undefined) {
      if (document.getElementById('crchl'+x).value=="charged") {
        document.getElementById('itemn'+x).value="";
      }
    }
  }
//alert('crkey'+x);
}
function AssignUniquIncty() {
  for (x=101;x<900;x++) {
    y = zeroFill(x-100,3)
    if (document.getElementById('crkey'+x) == null){break;}

    document.getElementById('uniqu'+x).value = document.AddForm.uniqu000.value;
    document.getElementById('incty'+x).value = document.AddForm.incty000.value;

  }
}

</script>
