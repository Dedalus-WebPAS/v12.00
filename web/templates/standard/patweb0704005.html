<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>

<script type="text/javascript">
function isDVA() {

  var cTitlePanel = document.getElementById('DVAColorTitlePanel');
  var cTitle = document.getElementById('DVAColorTitle');
  var cSelectPanel = document.getElementById('DVAColorSelectPanel');
  var cSelect = document.getElementById('DVAColorSelect');
  var expireDate = document.getElementById("pmccd004");

  var expireMandatory = document.getElementById('cardIndicator');
  var cardType = document.getElementById('cardIndicator');

  expireMandatory = expireMandatory.value.substring(6,7);


  if(typeof cardType != 'undefined' &&
     typeof cTitlePanel != 'undefined' &&
     typeof cTitle != 'undefined' &&
     typeof cSelect != 'undefined' &&
     typeof cSelectPanel != 'undefined' ) {

     if(cardType.value.substr(3,1) == "3") {

       cSelectPanel.innerHTML = cSelect.innerHTML;
       cTitlePanel.innerHTML = cTitle.innerHTML;
       isExpireDateMandatory(expireMandatory,expireDate);
          
     }else {
       cSelectPanel.innerHTML = "";
       cTitlePanel.innerHTML = "";
     isExpireDateMandatory(expireMandatory,expireDate);
   
     }
  }
}

function isExpireDateMandatory(value,obj) {
       if(value == 1){
           obj.className = "FutureDate"
       }else {
           obj.className = "Mandatory FutureDate";
       }
}

function ValidateCardType() {
  p=document.UpdateForm
  var cardType     = document.getElementById('cardIndicator');
  var flag         = 0;
  if(cardType.value.substr(3,1) == "3") {
    var cardnumber=trim(document.UpdateForm.pmccd003.value);
    if(cardnumber && (cardnumber.substr(1,1)==" "))
    {
      flag=1;
      var dData=p.pmccd003.value.replace(/ /g,"");
      p.pmccd003.value=[dData.slice(0, 1), " ", dData.slice(1)].join('');
    }
  }
  if(flag==0){
    p.pmccd003.value=p.pmccd003.value.replace(/ /g,"");
  }
  UpCase(p.pmccd003);
  p.ccardno.value=p.pmccd003.value.replace(/\+/g,"@");
  p.ccardno.value=p.ccardno.value.replace(/\%/g,"@");
  var serverURL = "../cgi-bin/comweb80.pbl?reportno=76" +
                  "&valdcode="+p.pmccd002.value.replace(/ /g,"+") +
                  "&valdcod2="+p.ccardno.value.replace(/&/g,"@")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status!=0){
     p.pmccd003.select();
     p.pmccd003.focus();
     return false;
  }
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);isDVA();ValidateCardType();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
Update Concession Card
</span>
<form name=UpdateForm method=post action=patweb07.pbl>
<input type=hidden name=reportno value="4">
<input type=hidden name=template value="003">
<input type=hidden name=updttype value="U">
<input type=hidden name=nextpage value="0">
<input type=hidden name=redirect value="patweb07.pbl?reportno=04&template=001">
<input type=hidden name=urnumber value="%PATWEB07.04.003">
<input type=hidden name=admissno value="%PATWEB07.04.081">
<input type=hidden id="pmccd002" name=pmccd002 value="%PATWEB07.04.102.1">
<input type=hidden name=ccardno>
<input type=hidden id="cardIndicator" name="cardIndicator" value="%PATWEB07.04.102.3">
<input type=hidden name=oldccddt value="%PATWEB07.04.104">
<input type=hidden name=oldcolor value="%PATWEB07.04.106.1">

<table align=center width=100% border=0>
<tr valign=top><td class=DataLabel>Card Type</td>
    <td><input type=text name=d_pmccd002 class=Readonly title="Card Type" 
         size=25 maxlength=20 readonly value="%PATWEB07.04.102.0">
    </td>
</tr>

<tr valign=top><td class=DataLabel>Card Number</td>
    <td><input type=text name=pmccd003 class=Readonly title="Card Number" 
         size=25 maxlength=20 readonly value="%PATWEB07.04.103">
    </td>
</tr>

<tr><td><span id="DVAColorTitlePanel"></span></td>
    <td><span id="DVAColorSelectPanel"></span></td>
</tr>


<tr><td class=DataLabel>Card Expiry Date</td>
    <td><input type=text name=pmccd004 id=pmccd004 size=12 maxlength=11
         class="Mandatory FutureDate" title="Card Expiry Date"
         value="%PATWEB07.04.104">
        <img notab src="../images/DateLookup.gif" class="Icon"
         alt="Show Calendar" date="UpdateForm.pmccd004">
    </td>
</tr>

<tr><td class=DataLabel>Update Reason</td>
    <td><select name=pmccd006 class=Mandatory title="Update Reason">
        <option></option>
         %PATWEB07.04.112.2
        </select>
    </td>
</tr>

<tr><td colspan=2 align=center><br>
       <input type=button name=updtbutt value="Update" class="button" 
        onclick='setFormactn("U");'>
       <input type=button value="Cancel" class="button" 
        onclick='DFrameCloseRefresh();'>
    </td>
</tr>
</table>
</form>

<span id="DVAColorTitle" style="display:none">DVA Card Colour</span>

<span id="DVAColorSelect" style="display:none">
    <select name=pmccd005 id=pmccd005 maxlength=20 class="Mandatory"
     title="DVA Card Colour">
    <option></option>
     %PATWEB07.04.106.2
    </select>
</span>

