<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src=../js/TableSort.js></script>
<script type="text/javascript" src=../js/oprweb03.js></script>
<script type="text/javascript">
function PatientAlerts(urnumber,admissno) {
  linkurl="patweb98.pbl?reportno=1&template=003" +
          "&urnumber=" + urnumber + "&admissno=" + admissno
  location.href=linkurl
}
function frmSubmit() {
  if(document.getElementById('d_exclexit').checked==false) {
     document.SelectPeriod.exclexit.value="0";
  } else {
     document.SelectPeriod.exclexit.value="1";
  }
 SelectPeriod.submit()
}
//----------------------------------------------------------------------------
// Columns Available
//  0 - HTML Link
//  1 - Theatre
//  2 - Date & Time
//  3 - Duration
//  4 - Surgeon
//  5 - Anaesthetist
//  6 - Patient Name
//  7 - U/R
//  8 - Operation Desc
//  9 - Anaesthetic Type
// 10 - Unit
// 11 - Primary CMBS 
// 12 - Procedure Description
// 13 - Current Status
// 14 - Nursing Status Ext
// 15 - Time
// 16 - Ward
//---------------------------------------------------------------------------
function InitTable(TableView) {
document.SelectPeriod.deftview.value=TableView
switch (TableView) {
case 0: {
 t = new Table(1,0,2,"100%","center",0,50);
 t.addColumn("Patient","ImageText",6,6,"left","PatientFolder","0",130,21)
 t.addColumn("U/R","String",7,7,"left","","",40)
 t.addColumn("Theatre","String",1,1,"left","","",70)
 t.addColumn("Unit","String",10,10,"left","","",40)
 t.addColumn("Surgeon","String",4,4,"left","","",60)
 t.addColumn("1st MBS","String",11,11,"left","","",40)
 t.addColumn("Procedure Description","String",12,12,"left","","",120)
 t.addColumn("Current Status","String",13,13,"left","","",70)
 t.addColumn("Estimated Discharge Time","String",17,17,"left","","",45)
 t.addColumn("Time","String",15,15,"left","","",30)
 t.addColumn("Alerts","String",22,-1,"left","","",40)
 AddTableRows()
 TableOutput(0,1);
 break; }
case 1: {
 t = new Table(1,0,2,"100%","center",0,35);
 t.addColumn("Date Time","DateTime",2,2,"left","AppointmentIcon.gif","0",150)
 t.addColumn("U/R","String",7,7,"left","","",40)
 t.addColumn("Patient","ImageText",6,6,"left","PatientFolder","0",150,21)
 t.addColumn("Anaesthetist","String",5,5,"left","","",120)
 t.addColumn("Anaesthetic","String",9,9,"left","","",150)
 AddTableRows()
 TableOutput(2,1);
 break; }
case 2: {
 t = new Table(1,0,2,"100%","center",0,50);
 t.addColumn("Patient","ImageText",6,6,"left","PatientFolder","0",130,21)
 t.addColumn("Adm. Point","String",43,43,"left","","",60)
 t.addColumn("Ward","String",44,44,"left","","",30)
 t.addColumn("Bed","String",45,45,"left","","",30)
 t.addColumn("Theatre","String",1,1,"left","","",60)
 t.addColumn("Surgeon","String",4,4,"left","","",60)
 t.addColumn("Status","String",13,13,"left","","",30)
 t.addColumn("Admission Date/Time","DateTime",46,46,"left","","",50)
 t.addColumn("Arrival Time","String",37,37,"left","","",30)
 t.addColumn("Anaes. Prep.","String",38,38,"left","","",30)
 t.addColumn("Surg. Start","String",41,41,"left","","",40)
 t.addColumn("Surg. End","String",42,42,"left","","",40)
 t.addColumn("Time to Rec","String",39,39,"left","","",40)
 t.addColumn("Time Exited","String",40,40,"left","","",40)
 t.addColumn("Discharge Date/Time","DateTime",47,47,"left","","",50)
 AddTableRows()
 TableOutput(0,1);
 }
 }
}
//========================================================================
// Display Additional fields
//========================================================================
function dispxtrafield() {
  if((document.getElementById('xtrafltr') != undefined)  &&
     (document.getElementById('xtrafltr').value=="1")) {
       document.getElementById('divParams').innerHTML =
       document.getElementById('t4').innerHTML
     + document.getElementById('t1').innerHTML
     + document.getElementById('t5').innerHTML;
  }
}
function dispDayCmt(){
  if((document.getElementById('opcnscom') != undefined) &&
     (document.getElementById('opcnscom').value=="1")){
    if(document.getElementById('dispdayc').value=="1"){
        document.getElementById('divParams').innerHTML =
        document.getElementById('t1').innerHTML
      + document.getElementById('t2').innerHTML;
    } else{
        if(document.getElementById('dispdayc').value=="2"){
            document.getElementById('divParams').innerHTML =
            document.getElementById('t1').innerHTML
          + document.getElementById('t3').innerHTML;
            if(document.getElementById('daycmcnt').value > 1){
               document.getElementById('daycmtbutton').className="Red";
            }
        }
    }
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="InitTable(%OPRWEB03.03.027);PageLoad(event);dispexcanc();
      dispDayCmt();dispxtrafield();checkChecks();">
<div id=HeadingSection>
<form name=SelectPeriod action=oprweb03.pbl method=get style="margin:0">
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=3>
<input type=hidden name=viewtype value="%OPRWEB03.03.010">
<input type=hidden name=exclexit value=" ">
<input type=hidden name=deftview value="">
<input type=hidden name=dispdayc id=dispdayc value="%OPRWEB03.03.030.023">
<input type=hidden name=daycmcnt id=daycmcnt value="%OPRWEB03.03.030.024">
<input type=hidden name=xtrafltr id=xtrafltr value="%OPRWEB03.03.030.025">
<input type=hidden name=currdate id=currdate value="%STANDARD.01.015">
<input type=hidden name=opcnscom id=opcnscom value="%STANDARD.01.025.042.241.0.1">
     
<table cellpadding=3 cellspacing=0 bgcolor=#CCCCCC border=0 width=100%>
<tr>
  <td width=32%>
    <a href=javascript:InitTable(0)>
    <img src=../images/TableViewIcon.gif class=Icon 
     alt="Default View" ></a>
    <a href=javascript:InitTable(1)>
    <img src=../images/TableViewIcon.gif class=Icon 
     alt="Anaesthetic Details" ></a>
    <a href=javascript:InitTable(2)>
    <img src=../images/TableViewIcon.gif class=Icon 
     alt="Time Details" ></a>
    <input type=button value="<<" class=SmallButton
     onClick='location.href="%OPRWEB03.03.002" +
                 "&deftview=" + document.SelectPeriod.deftview.value'>
     %OPRWEB03.03.007
    <input type=submit value="Go" class=SmallButton>
    <input type=button value=">>" class=SmallButton
     onClick='location.href="%OPRWEB03.03.001" +
                 "&deftview=" + document.SelectPeriod.deftview.value'>
     &nbsp;&nbsp;

     %STANDARD.01.017.YD
    <select class=PMenuSelectList name=surgtype onchange="frmSubmit()">
    <option value="ALL">All</option>
     %OPRWEB03.03.018.2
    </select>
     &nbsp;&nbsp;
  </td>

  <td align=left>
    <div id="divParams"></div>
  </td>

  <td align=right>
    <a href='javascript:SelectDateFrame();'>
    <img src="../images/DateLookup.gif" 
     alt="Select Date" class=Icon></a>
    <a href='javascript:SelectView("0");'>
    <img src=../images/DayIcon.gif 
     alt="View Today" class=Icon></a>
    <a href='javascript:SelectView("1");'>
    <img src=../images/WeekIcon.gif 
     alt="View This Week" class=Icon></a>
    <a href='javascript:SelectView("2");'>
    <img src=../images/MonthIcon.gif 
     alt="View This Month" class=Icon></a>
  </td>
</tr>
</table>
</form>
</div>


<span id="t1" style="display:none">
  Exclude Cancelled/Transferred Patients
   <input type="checkbox" name="exclcanc" id="exclcanc" value="1"
    onclick="frmSubmit();">
</span>

<span id="t2" style="display:none">
  <b>Comments for today: </b>
   %OPRWEB03.03.030.022
</span>

<span id="t3" style="display:none">
  <b>Comments for today: </b>
   %OPRWEB03.03.030.022
    &nbsp;&nbsp;
   <input type=button name=daycmtbutton id=daycmtbutton class=button 
    value="Day Comments" onClick="DayCommentsUpd(currdate);">
</span>

<span id="t4" style="display:none">
  Admitting Point
   <select class=SelectMed name=admpoint onchange="frmSubmit()">
   <option value="ALL">All</option>
    %OPRWEB03.03.032.2
   </select>
    &nbsp;
  Ward
   <select class=SelectMed name=wardcode onchange="frmSubmit()">
   <option value="   ">All</option>
    %OPRWEB03.03.033.2
   </select>
</span>

<span id="t5" style="display:none">
  Exclude Exited Patients
   <input type="checkbox" name=d_exclexit id=d_exclexit value="1" onclick="frmSubmit();">
</span>

<div id=TableLocation></div>
<script type="text/javascript">
function AddTableRows() {
  %OPRWEB03.03.012.oprweb01.04.001
}

function checkChecks() {
  ExcludeCancelled="%OPRWEB03.03.025";
  if(ExcludeCancelled=="1") {
    document.getElementById('exclcanc').checked=true;
  }

  ExcludeExit="%OPRWEB03.03.031";
  if(ExcludeExit=="1") {
    document.getElementById('d_exclexit').checked=true;
  }
}

function dispexcanc() {
    document.getElementById('divParams').innerHTML = 
    document.getElementById('t1').innerHTML;
}
</script>
