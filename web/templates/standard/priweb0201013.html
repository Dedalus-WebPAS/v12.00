<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="CrossBrowser" content="true">
<meta name="HelpFileName" content="NoContextSet.html">
<link rel="stylesheet" href="../html/postcode.css" type="text/css">
<script type="text/javascript" src="../js/AutoPostCode.js"></script>
<script type="text/javascript">
function SetFields() {
 state = document.UpdateForm.dummy;
 suburb = document.UpdateForm.pmclt010;
 postcode = document.UpdateForm.pmclt012;
}
function UpdDelItem(htr001,htr002,htr003,htr004,htr005,htr006,htr007,htr008,htr009,htr010,htr011) {
  if (document.UpdateForm.d_dummyoth != undefined &&
      document.UpdateForm.d_dummyoth.checked==true) {
    SetCookie("OtherClaimantDetailsCOOKIE",
              document.UpdateForm.pmclt003.value + "|" +
              document.UpdateForm.pmclt004.value + "|" +
              document.UpdateForm.pmclt006.value + "|" +
              document.UpdateForm.pmclt007.value + "|" +
              document.UpdateForm.pmclt005.value + "|" +
              document.UpdateForm.pmclt008.value + "|" +
              document.UpdateForm.pmclt009.value + "|" +
              document.UpdateForm.pmclt010.value + "|" +
              document.UpdateForm.pmclt012.value);
  }

  document.ItemForm.prhtr001.value=htr001;
  document.ItemForm.prhtr002.value=htr002;
  document.ItemForm.prhtr003.value=htr003;
  document.ItemForm.prhtr004.value=htr004;
  document.ItemForm.prhtr005.value=htr005;
  document.ItemForm.prhtr006.value=htr006;
  document.ItemForm.prhtr007.value=htr007;
  document.ItemForm.prhtr008.value=htr008;
  document.ItemForm.prhtr009.value=htr009;
  document.ItemForm.prhtr010.value=htr010;
  document.ItemForm.prhtr011.value=htr011;
  var linkUrl="priweb02.pbl?reportno=01&template=021" +
              "&urnumber=" + document.ItemForm.urnumber.value.replace(/ /g,"+") +
              "&uniqnumb=" + document.ItemForm.uniqnumb.value.replace(/ /g,"+") +
              "&prhre001=" + document.ItemForm.prhre001.value.replace(/ /g,"+") +
              "&prhre002=" + document.ItemForm.prhre002.value.replace(/ /g,"+") +
              "&prhre003=" + document.ItemForm.prhre003.value.replace(/ /g,"+") +
              "&prhtr001=" + document.ItemForm.prhtr001.value.replace(/ /g,"+") +
              "&prhtr002=" + document.ItemForm.prhtr002.value.replace(/ /g,"+") +
              "&prhtr003=" + document.ItemForm.prhtr003.value.replace(/ /g,"+") +
              "&prhtr004=" + document.ItemForm.prhtr004.value.replace(/ /g,"+") +
              "&prhtr005=" + document.ItemForm.prhtr005.value.replace(/ /g,"+") +
              "&prhtr006=" + document.ItemForm.prhtr006.value.replace(/ /g,"+") +
              "&prhtr007=" + document.ItemForm.prhtr007.value.replace(/ /g,"+") +
              "&prhtr008=" + document.ItemForm.prhtr008.value.replace(/ /g,"+") +
              "&prhtr009=" + document.ItemForm.prhtr009.value.replace(/ /g,"+") +
              "&prhtr010=" + document.ItemForm.prhtr010.value.replace(/ /g,"+") +
              "&prhtr011=" + document.ItemForm.prhtr011.value.replace(/ /g,"+");
  var Left=(document.body.clientWidth-500)/2;
  DFrameLink(linkUrl,100,Left,500,650);
}

function SubmitPrtRC() {

  if (document.getElementById("ptcnpciw").value == "1" &&
      document.UpdateForm.pmclt003 == undefined) {
    alert("Claimant Data must be entered.");
    return;
  }

  SubmitPrt();

}

function SubmitPrt() {
   if (document.UpdateForm.invtotal.value<0) {
     ans= confirm("This invoice will be raised with a credit balance." +
          " \n\n Click OK to continue with raising an invoice or " +
          " Cancel to go back.")
     if (!ans) { return }
   }

     if (document.UpdateForm.prhtr030 != undefined) {
       if (!validateMandatory(UpdateForm)) {return;}
     }

     if (IEBrowser) {
       if (!validateItemDatesAdmAndDisc()) {return;}

       if (!validateIMCPCSVouchersandServices()) {return;}

       if (!validateDBSDVAVouchersandServices()) {return;}

       if (!validateClaimantDOB()) {return;}

       SubmitHidden(UpdateForm);
     } else {
       validateItemDatesAdmAndDisc().then(function (validDate) {
         if (!validDate) {return;}

         if (!validateIMCPCSVouchersandServices()) {return;}

         if (!validateDBSDVAVouchersandServices()) {return;}

         if (!validateClaimantDOB()) {return;}

         SubmitHidden(UpdateForm);
       });
     }
}
function validateClaimantDOB() {

  var birthday;

  if (document.UpdateForm.pmclt005 != undefined)  {

    birthday = new Date(document.UpdateForm.pmclt005.value); 
    
    var ageDifMs = Date.now() - birthday.getTime();
    var ageDate = new Date(ageDifMs);
    var agenumberofyears = Math.abs(ageDate.getUTCFullYear() - 1970);

//alert(agenumberofyears);

    if (agenumberofyears < 12) {
      alert("Claimant cannot be under 12 years of age.");
      return false;
    } 
  }

  return true;
}
function loopThruItems(returnValue) {
  if (returnValue.return_value !== "") {
    var ReturnValue=returnValue.return_value.split("|");
    var admissionDate = ReturnValue[0].replace("\n", "").split("/")
                        .reverse().join("");
    var dischargeDate = ReturnValue[1].replace("\n", "").split("/")
                        .reverse().join("");
    var tableHTML = document.getElementById("priprinv");
    var tableDataHTML = tableHTML.getElementsByTagName("td");
    for (var i=0; i < tableDataHTML.length; i=i+6) {
      if (i==0) {
        continue;
      }
      if ((i >= tableDataHTML.length-12) &&
           (tableDataHTML[i+2].innerHTML == "<b>Invoice Total</b>" ||
            tableDataHTML[i+2].innerHTML == "<b>Balance Payable</b>")) {
        continue;
      }
      var dateForItem = SetDateYYYYMMDD(tableDataHTML[i].innerHTML);
      if (dateForItem < admissionDate && admissionDate !== ' ') {
        alert("Error Message\nDate must be after Admission Date - " +
               SetDateDDMMMYYYY(admissionDate));
        return false;
      } else if (dateForItem > dischargeDate && dischargeDate !== ' ') {
        alert("Error Message\nDate must be before Discharge Date - " +
               SetDateDDMMMYYYY(dischargeDate));
        return false;
      }
    }
  }
  return true;
}
function validateItemDatesAdmAndDisc() {
  var serverURL = "../cgi-bin/emrweb08.pbl?reportno=51&valdcode=" +
                    document.getElementById('prhtr030').value.replace(/ /g,"+");
  if (IEBrowser) {
    var returnValue = RSExecute(serverURL);
    if (returnValue.status===0) {
      return loopThruItems(returnValue);
    }
  } else {
    var fetchPromise = RSExecuteFetch(serverURL);
    return fetchPromise.then(function (returnValueObj) {
      var returnValue = ParseFetchData(returnValueObj);
      if (returnValue.status===0) {
        return loopThruItems(returnValue);
      }
    });
  }
}
function validateIMCPCSVouchersandServices() {

  if (document.ItemForm.ecliindc.value!="1" &&
      document.ItemForm.ecliuesf.value!="1") {return true;}

  var vchsrvarray = new Array();

  vchsrvarray[0] = new Array();
  vchsrvarray[0][0] = document.ItemForm.vchseg26.value;
  vchsrvarray[0][1] = document.ItemForm.vchseg05.value.substr(3,1);
  vchsrvarray[0][2] = document.ItemForm.prhdclam.value;

  var elements = document.getElementsByTagName("input")
  for (var i = 0; i < elements.length; i++) {
      if(elements[i].name.substr(0,5) == "srvpr") {
//          alert(elements[i].name);
        
        itemfound = 0;
        
        for (var x = 0; x < vchsrvarray.length; x++) {
          if (vchsrvarray[x][0] == elements[i].value &&
              vchsrvarray[x][1] == elements[i+1].value &&
              vchsrvarray[x][2] == elements[i+2].value) {
              
            vchsrvarray[x][vchsrvarray[x].length] = elements[i+3].value 
            itemfound = 1;
          }
        }

        if (itemfound == 0) {
          al = vchsrvarray.length;
          vchsrvarray[al] = new Array();
          vchsrvarray[al][0] = elements[i].value;
          vchsrvarray[al][1] = elements[i+1].value;
          vchsrvarray[al][2] = elements[i+2].value;
          vchsrvarray[al][3] = elements[i+3].value;
        }


      }
  }

//alert(vchsrvarray);

  if (vchsrvarray.length > 17) {
    alert("Number of Vouchers cannot exceed 16.");
    return false;
  }

  for (x=0; x < vchsrvarray.length; x++) {
    if (vchsrvarray[x].length > 17) {
      alert("Number of services for Voucher " + 
            vchsrvarray[x][0] + " " + 
            vchsrvarray[x][1] + " " +
            vchsrvarray[x][2] + " cannot exceed 14.");
      return false;
    }
  }

  return true;

}

//------------------------------------------------------------
// Function : Visit Search Frame
//------------------------------------------------------------
function VisitSearchFrame(Urnumber,ReturnCode)
{
  if (isWhitespace(Urnumber.value))
  {
     alert("Patient Not Identified");
     return;
  }
  var PopUpFrameDoc = DFrameStart();
  window.ReturnCode=ReturnCode ;
  PopUpFrameDoc.location.href = "patweb98.pbl?reportno=1&template=251"+
                                "&srchview=1" +
                                "&filtvtyp=2" +
                                "&urnumber=" + Urnumber.value.replace(/ /g,"+")
  SearchFrameShow();
}
function ShowEclipse() {
 var showOther=false;
 if(document.getElementById("d_prhre028").value.substr(3,1) == "5" &&
    document.getElementById("ptcnuesf").value == "1") {
   showOther=true;
 }
 var showSearch=document.getElementById("ptcnnewc").value;
 if(!showOther) {
   OtherClaimantTitleDIV.innerHTML="";
   OtherClaimantOptionDIV.innerHTML="";
 } else {
   OtherClaimantTitleDIV.innerHTML=OtherClaimantTitleSPAN.innerHTML;
   OtherClaimantOptionDIV.innerHTML=OtherClaimantOptionSPAN.innerHTML;

   document.getElementById("lnkvisnumtitleDIV").innerHTML="";
   document.getElementById("lnkvisnumfieldDIV").innerHTML="";
 }
 if(showSearch==false || showOther==false) {
   OtherClaimantSearchDIV.innerHTML="";
 } else {
   OtherClaimantSearchDIV.innerHTML=OtherClaimantSearchSPAN.innerHTML;
 }

 if (showOther == true &&
     document.getElementById("ptcnpciw").value == "1") {
   OtherClaimantUPDDIV.innerHTML=OtherClaimantUPDSPAN.innerHTML;
   document.getElementById("d_dummyoth").checked=true;
   EclipseStoreForward();
 } else {
   OtherClaimantUPDDIV.innerHTML="";
 }
}
function EclipseStoreForward() {
  if(document.getElementById("d_dummyoth").checked==true) {
    document.getElementById("EclipseClaimant").innerHTML=
    document.getElementById("ShowEclipseClaimant").innerHTML;
    SetFields();
    InitPostCodes();
  } else {
    document.getElementById("EclipseClaimant").innerHTML="";
  }
}
function selectContact() {
  if (document.getElementById("d_dummyoth").checked==false) { 
    document.getElementById("d_dummyoth").checked=true;
    EclipseStoreForward();
  }
  linkurl="patweb07.pbl?reportno=06&template=009" +
          "&urnumber=" + document.ItemForm.urnumber.value.replace(/ /g,"+");
  Left=(document.body.clientWidth-780)/2;
  DFrameLink(linkurl,50,Left,780,450);
}
function validateClaimantMandatory() {
  if (isWhitespace(document.UpdateForm.pmclt008.value) && 
      isWhitespace(document.UpdateForm.pmclt010.value) &&
      isWhitespace(document.UpdateForm.pmclt012.value)) {
    document.UpdateForm.pmclt008.className="";
    document.UpdateForm.pmclt010.className="";
    document.UpdateForm.pmclt012.className=""; 
  } else {
    document.UpdateForm.pmclt008.className="Mandatory";
    document.UpdateForm.pmclt010.className="Mandatory";
    document.UpdateForm.pmclt012.className="Mandatory";
  }
}
function getOCDCookie() {

  var OCDArray = "";

  if (GetCookieData("OtherClaimantDetailsCOOKIE") != "unknown") {
    OCDArray = GetCookieData("OtherClaimantDetailsCOOKIE").split("|");
    ExpireCookiePath("OtherClaimantDetailsCOOKIE");

    document.UpdateForm.d_dummyoth.checked=true; 
    EclipseStoreForward();

    document.UpdateForm.pmclt003.value=OCDArray[0]; 
    document.UpdateForm.pmclt004.value=OCDArray[1];
    document.UpdateForm.pmclt006.value=OCDArray[2];
    document.UpdateForm.pmclt007.value=OCDArray[3];
    document.UpdateForm.pmclt005.value=OCDArray[4];
    document.UpdateForm.pmclt008.value=OCDArray[5];
    document.UpdateForm.pmclt009.value=OCDArray[6];
    document.UpdateForm.pmclt010.value=OCDArray[7];
    document.UpdateForm.pmclt012.value=OCDArray[8];

  }  else {
    checkAgeClaimant();
  }
//alert(OCDArray);
}
function validateDBSDVAVouchersandServices() {

  if (document.ItemForm.ecliuebb.value!="1" &&
      document.ItemForm.ecliudva.value!="1") {return true;}

  var vchsrvarray = new Array();

  vchsrvarray[0] = new Array();
//  vchsrvarray[0][0] = document.ItemForm.vchseg26.value;
//  vchsrvarray[0][1] = document.ItemForm.vchseg05.value.substr(3,1);
//  vchsrvarray[0][2] = document.ItemForm.prhdclam.value;

  var elements = document.getElementsByTagName("input")
  for (var i = 0; i < elements.length; i++) {

      if (elements[i].name == "srvpr001") {
        vchsrvarray[0][0] = elements[i+4].value;
      } else {

      if(elements[i].name.substr(0,5) == "srvpr") {
//          alert(elements[i].name);
//          alert(elements[i+4].value);
        itemfound = 0;

        for (var x = 0; x < vchsrvarray.length; x++) {
          if (vchsrvarray[x][0] == elements[i+4].value) {

            vchsrvarray[x][vchsrvarray[x].length] = elements[i+3].value
            itemfound = 1;
          }
        }

        if (itemfound == 0) {
          al = vchsrvarray.length;
          vchsrvarray[al] = new Array();
          vchsrvarray[al][0] = elements[i+4].value;
          vchsrvarray[al][1] = elements[i+3].value;
        }


      }

      }
  }

//alert(vchsrvarray.length);

  if (vchsrvarray.length > 80) {
    alert("Number of Vouchers cannot exceed 80.");
    return false;
  }

  for (x=0; x < vchsrvarray.length; x++) {
//alert(vchsrvarray[x].length);
    if (vchsrvarray[x].length > 14) {
      alert("Number of services for Voucher " +
            vchsrvarray[x][0].substr(6,2) + "/" +
            vchsrvarray[x][0].substr(4,2) + "/" +
            vchsrvarray[x][0].substr(0,4) +
            " cannot exceed 14.");
      return false;
    }
  }

  return true;

}
function UsePatientDetails() {
  if (document.getElementById("d_dummyoth").checked==false) {
    document.getElementById("d_dummyoth").checked=true;
    EclipseStoreForward();
  }

  document.UpdateForm.pmclt003.value = trim(document.UpdateForm.patsname.value);
  document.UpdateForm.pmclt004.value = trim(document.UpdateForm.patgname.value);
  document.UpdateForm.pmclt006.value = trim(document.UpdateForm.patmedcn.value);
  document.UpdateForm.pmclt007.value = trim(document.UpdateForm.patmedce.value);
  document.UpdateForm.pmclt005.value = trim(document.UpdateForm.patdtofb.value);

  checkDate(document.UpdateForm.pmclt005,'Claimant Date of Birth');

}
</script>
</head>
<body onload="PageLoad(event);setTimeout('AddItemsScreen()',100);
              assignrefEclipseDIV();ShowEclipse();
              getOCDCookie();">
%START.OF.PAGE
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PRIWEB02.01.003";
PatientVIS="%PRIWEB02.01.081";
PatientNAM="%PRIWEB02.01.002";
PatientSTA="%PRIWEB02.01.086.078";
PatientALT="%PRIWEB02.01.084";
PatientSEX="%PRIWEB02.01.019";
PatientDOB="%PRIWEB02.01.020";
PatientAGE="%PRIWEB02.01.021";
PatientLOC="%PRIWEB02.01.083";
PatientPRI="%PRIWEB02.01.086.066.1";
PatientUNT="%PRIWEB02.01.066.0";
DoctorCOD="%PRIWEB02.01.082.003";
DoctorNAM="%PRIWEB02.01.082.002";
PatientAID="%PRIWEB02.01.086.090";
PatientIND="%PRIWEB02.01.086.091";
PatientCUR="%PRIWEB02.01.086.092";
PatientCLC="%PRIWEB02.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PRIWEB02.01.086.094";
PatientCDM="%PRIWEB02.01.086.095";
PatientVDH="%PRIWEB02.01.086.099.015";
InsertPatientHeader()
</script>
<div id="PatientMenu"></div>
<div id="PageBodySection">

<form name=ItemForm action="priweb02.pbl" method=post style="margin:0">
  <input type=hidden name=reportno value="1">
  <input type=hidden name=template value=013>
  <input type=hidden name=updttype value=" ">
  <input type=hidden name=nextpage value="1">
  <input type=hidden name=prcnrdoc value="%PRIWEB02.01.206">
  <input type=hidden name=urnumber value="%PRIWEB02.01.003">
  <input type=hidden name=uniqnumb value="%PRIWEB02.01.207">
  <input type=hidden name=prhre001 value="%PRIWEB02.01.208">
  <input type=hidden name=prhre002 value="%PRIWEB02.01.209">
  <input type=hidden name=prhre003 value="%PRIWEB02.01.210">
  <input type=hidden name=prhtr001 value="%PRIWEB02.01.701">
  <input type=hidden name=prhtr002 value="%PRIWEB02.01.702">
  <input type=hidden name=prhtr003 value="%PRIWEB02.01.703">
  <input type=hidden name=prhtr004 value="%PRIWEB02.01.704">
  <input type=hidden name=prhtr005 value="%PRIWEB02.01.705">
  <input type=hidden name=prhtr006 value="%PRIWEB02.01.706">
  <input type=hidden name=prhtr007 value="%PRIWEB02.01.707">
  <input type=hidden name=prhtr008 value="%PRIWEB02.01.708">
  <input type=hidden name=prhtr009 value="%PRIWEB02.01.709">
  <input type=hidden name=prhtr010 value="%PRIWEB02.01.710">
  <input type=hidden name=prhtr011 value="%PRIWEB02.01.711">
  <input type=hidden name=prhtr012 value="%PRIWEB02.01.712">
  <input type=hidden name=prhtr013 value="%PRIWEB02.01.713">
  <input type=hidden name=redirect value="%PRIWEB02.01.001.priweb02.01.013">
  <input type=hidden name=redirec2>
  <input type="hidden" name="ptcnuimc" id="ptcnuimc"
   value="%STANDARD.01.025.124.111.0.1">
  <input type="hidden" name=ecliindc value="%PRIWEB02.01.237">
  <input type="hidden" name=ecliuesf value="%PRIWEB02.01.251">
  <input type="hidden" name=ecliuebb value="%PRIWEB02.01.253">
  <input type="hidden" name=ecliudva value="%PRIWEB02.01.258">
  <input type=hidden name=vchseg26 value="%PRIWEB02.01.242">
  <input type=hidden name=vchseg05 value="%PRIWEB02.01.133.3">
  <input type=hidden name=prhdclam value="%PRIWEB02.01.243">
  <input type=hidden name=frmpplst value="%PRIWEB02.01.737">

<table border=0 cellspacing=0 cellpadding=2 width=100% bgcolor=#CCCCCC>
%PRIWEB02.01.211
</table>
</form>

<table cellspacing=0 cellpadding=1 border=0 width=100%>
  <tr><td align=center class=HeadingCell>
    Private Practice Invoice</td>
    </tr>
</table>
<table id=priprinv border=1 cellspacing=0 cellpadding=2 width=100%>
%PRIWEB02.01.212
</table>

<form name=UpdateForm action="priweb02.pbl" method=post
 onsubmit="return validateMandatory(this);">
    <input type=hidden name=reportno value=4>
    <input type=hidden name=template value=013>
    <input type=hidden name=nextpage value="7">
    <input type=hidden name=urnumber value="%PRIWEB02.01.003">
    <input type=hidden name=uniqnumb value="%PRIWEB02.01.207">
    <input type=hidden name=prhre001 value="%PRIWEB02.01.208">
    <input type=hidden name=prhre002 value="%PRIWEB02.01.209">
    <input type=hidden name=prhre003 value="%PRIWEB02.01.210">
    <input type=hidden name=progflag value="2">
    <input type=hidden name=additmsc value="%PRIWEB02.01.228">
    <input type=hidden name=invtotal value="">
    <input type=hidden name=redirect value="%PRIWEB02.01.001.patweb76.01.021">
    <input type="hidden" name=healthfd id=healthfd value="%PRIWEB02.01.236.0">
    <input type="hidden" name=prhre028 id=prhre028 value="%PRIWEB02.01.128.1">
    <input type="hidden" name=d_prhre028 id=d_prhre028
     value="%PRIWEB02.01.128.3">
    <input type="hidden" name=raclindc id=raclindc value="0">
    <input type="hidden" name=racluesf id=racluesf value="0">
    <input type="hidden" name=racluebb id=racluebb value="0">
    <input type="hidden" name=racludva id=racludva value="0">
    <input type="hidden" name=typeacct id=typeacct value="%PRIWEB02.01.128.3">

    <input type="hidden" name=ptcnnewc id=ptcnnewc
     value="%STANDARD.01.025.118.138.0.1">
    <input type=hidden name="ptcnuesf" id="ptcnuesf"
     value="%STANDARD.01.025.124.222.0.1">
    <input type=hidden name="ptcnuebb" id="ptcnuebb"
     value="%STANDARD.01.025.127.122.0.1">
    <input type="hidden" name=dummy id=dummy value=" ">
    <input type=hidden name="ptcnpciw" id="ptcnpciw"
     value="%STANDARD.01.025.129.091.0.1">
<input type="hidden" name=patsname value="%PRIWEB02.01.009">
<input type="hidden" name=patgname value="%PRIWEB02.01.010">
<input type="hidden" name=patmedcn value="%PRIWEB02.01.027">
<input type="hidden" name=patmedce value="%PRIWEB02.01.085.049">
<input type="hidden" name=patdtofb value="%PRIWEB02.01.020">
<input type=hidden name=inviactv id=inviactv value="%PRIWEB02.01.255">
    <input type=hidden name="ptcndvaw" id="ptcndvaw"
     value="%STANDARD.01.025.129.249.0.1">

<table border=0 cellpadding=2 cellspacing=0 width=95% align=center>
     <tr>
     <td class="DataLabel"><div id=lnkvisnumtitleDIV></div></td>
     <td><div id=lnkvisnumfieldDIV></div></td>
     <td><div id=admDateDIV></div></td>
     <td><div id=disDateDIV></div></td>
     </tr>

<tr><td class=DataLabel width=15%>Printer</td>
    <td><select name=selprint class=Mandatory tabindex=1>
        %STANDARD.01.001.PRIWEB02.04
        </select></td>
    <td class=DataLabel>Copies</td>
    <td><select name=nocopies tabindex=1>
        <option value=" 1">1</option>
        <option value=" 2">2</option>
        <option value=" 3">3</option>
        <option value=" 4">4</option>
        <option value=" 5">5</option>
        <option value=" 6">6</option>
        <option value=" 7">7</option>
        <option value=" 8">8</option>
        <option value=" 9">9</option>
        <option value=" 10">10</option>
        </select></td></tr>

</table>

<table border=0 cellpadding=2 cellspacing=0 width=95% align=center>
<tr><td class="DataLabel" width=15%><div id=OtherClaimantTitleDIV></div></td>
    <td class=DataField width=1%><div id=OtherClaimantOptionDIV></div></td>
    <td width=2% align=left><div id=OtherClaimantSearchDIV></div></td>
    <td width=5%><div id="OtherClaimantUPDDIV"></div></td>
    <td class=DataLabel></td>
    <td class=DataField></td>
    </tr>
</table>

<table border=0 cellpadding=2 cellspacing=0 width=95% align=center>
<tr><td colspan=4 align=center><div id="EclipseClaimant"></div></td></tr>

<tr><td align=center colspan=4>
    <input type=button value="Raise" class="button" name=printinv
     id="raisebutton" onclick='tempDisable(this);SubmitPrt();'>
    <div id="RaiseClaimBDIV" style="display: inline"></div>
    <div id="RaiseClaimPCSDIV" style="display: inline"></div>
    <div id="RaiseClaimDBSDIV" style="display: inline"></div>
    <div id="RaiseClaimDVADIV" style="display: inline"></div>
    <input type=button value="Add Items" name=addmbs
     class="button" onclick="AddItem();">
 <input type=button class="Bigbutton" value="Change Insurance" 
  onclick="ChangeClaim();" id="changeInsuranceBUTTON">

 <!-- <input type=button class="button" value="Ref. Override"
  onclick="ReferralOverride();" id="referraloverrideBUTTON"> -->

    <input type=button value="Close" class="button"
     onclick="SetClose();">
  </td></tr>
</table>
</form>
</div>

<span id=RaiseClaimBSPAN style="display:none">
    <input type=button value="Raise and Claim" class="button" name=printinvc
     id="raiseandcbutton" onclick='tempDisable(this);
                               document.UpdateForm.raclindc.value="1";
                               SubmitPrt();'>
</span>

<span id=RaiseClaimPCSSPAN style="display:none">
    <input type=button value="Raise and Claim" class="button" name=printinvpcs
     id="raiseandcbutton" onclick='tempDisable(this);
                               document.UpdateForm.racluesf.value="1";
                               SubmitPrtRC();'>
</span>

<span id=RaiseClaimDBSSPAN style="display:none">
    <input type=button value="Raise and Claim" class="button" name=printinvdbs
     id="raiseandcbutton" onclick='tempDisable(this);
                               document.UpdateForm.racluebb.value="1";
                               SubmitPrt();'>
</span>

<span id=RaiseClaimDVASPAN style="display:none">
    <input type=button value="Raise and Claim" class="button" name=printinvdva
     id="raiseandcbutton" onclick='tempDisable(this);
                               document.UpdateForm.racludva.value="1";
                               SubmitPrt();'>
</span>

<form name="PatientLinks" method="get" style="margin:0">
<input type="hidden" name="reportno" value="1">
<input type="hidden" name="template" value="004">
<input type="hidden" name="urnumber" value="%PRIWEB02.01.003">
<input type="hidden" name="admissno" value="%PRIWEB02.01.081">
<input type=hidden name=uniqnumb value="%PRIWEB02.01.207">
<input type=hidden name=prhre001 value="%PRIWEB02.01.208">
<input type=hidden name=prhre002 value="%PRIWEB02.01.209">
<input type=hidden name=prhre003 value="%PRIWEB02.01.210">
<input type=hidden name=prhtr005 value="%PRIWEB02.01.705">
<input type=hidden name=prhtr006 value="%PRIWEB02.01.706">
<input type=hidden name=prhtr011 value="%PRIWEB02.01.711">
<input type="hidden" name="MenuType" value="%PRIWEB02.01.088">
</form>

<script type="text/javascript">

function checkAgeClaimant() {
  if(document.getElementById("d_prhre028").value.substr(3,1) == "5" &&
     document.getElementById("ptcnuesf").value == "1") {
    if ("%PRIWEB02.01.252"=="1") {
       document.getElementById('d_dummyoth').checked=true;
       EclipseStoreForward();
      }
    else {
//       document.getElementById('d_dummyoth').checked=false;
    }
  }
}


function ChangeClaim() {
  if (document.UpdateForm.d_dummyoth != undefined &&
      document.UpdateForm.d_dummyoth.checked==true) {
    SetCookie("OtherClaimantDetailsCOOKIE",
              document.UpdateForm.pmclt003.value + "|" +
              document.UpdateForm.pmclt004.value + "|" +
              document.UpdateForm.pmclt006.value + "|" +
              document.UpdateForm.pmclt007.value + "|" +
              document.UpdateForm.pmclt005.value + "|" +
              document.UpdateForm.pmclt008.value + "|" +
              document.UpdateForm.pmclt009.value + "|" +
              document.UpdateForm.pmclt010.value + "|" +
              document.UpdateForm.pmclt012.value);
  }

  LinkURL="priweb02.pbl?reportno=01&template=016&urnumber=" +
             document.UpdateForm.urnumber.value.replace(/ /g,"+")
           + "&uniqnumb=" + document.UpdateForm.uniqnumb.value
           + "&prhre001=" + document.UpdateForm.prhre001.value
           + "&prhre002=" + document.UpdateForm.prhre002.value
           + "&prhre003=" + document.UpdateForm.prhre003.value
           + "&prhtr005=" + document.ItemForm.prhtr005.value
           + "&prhtr006=" + document.ItemForm.prhtr006.value
           + "&prhtr011=" + document.ItemForm.prhtr011.value
           + "&progflag=" + document.UpdateForm.progflag.value;

  Left=(document.body.clientWidth-700)/2
  DFrameLink(LinkURL,180,150,700,290);
}

function AddItem() {
  if (document.UpdateForm.d_dummyoth != undefined &&
      document.UpdateForm.d_dummyoth.checked==true) {
    SetCookie("OtherClaimantDetailsCOOKIE",
              document.UpdateForm.pmclt003.value + "|" +
              document.UpdateForm.pmclt004.value + "|" +
              document.UpdateForm.pmclt006.value + "|" +
              document.UpdateForm.pmclt007.value + "|" +
              document.UpdateForm.pmclt005.value + "|" +
              document.UpdateForm.pmclt008.value + "|" +
              document.UpdateForm.pmclt009.value + "|" +
              document.UpdateForm.pmclt010.value + "|" +
              document.UpdateForm.pmclt012.value);
//alert(GetCookieData('OtherClaimantDetailsCOOKIE'));
  }
  Left=(document.body.clientWidth-1150)/2
  LinkURL="priweb02.pbl?reportno=06&template=001&urnumber=" +
             document.UpdateForm.urnumber.value.replace(/ /g,"+")
           + "&uniqnumb=" + document.UpdateForm.uniqnumb.value
           + "&prhre001=" + document.UpdateForm.prhre001.value
           + "&prhre003=" + document.UpdateForm.prhre003.value
           + "&prhre002=" + document.UpdateForm.prhre002.value
           + "&prhre028=" + document.UpdateForm.prhre028.value
           + "&prhtr005=" + document.ItemForm.prhtr005.value
           + "&prhtr006=" + document.ItemForm.prhtr006.value
           + "&prhtr011=" + document.ItemForm.prhtr011.value;
  DFrameLink(LinkURL,50,Left,1150,650);
}

function SetClose() {
  if (document.ItemForm.frmpplst.value=="1") {
    Path=GetContentCookie("PPPendingListURL");
    if (isWhitespace(Path) || Path=="unknown") {
      linkURL = "priweb04.pbl?reportno=05&template=001&showflag=";
    }
    else {
      linkURL = Path;
    }

    location.href= linkURL;
    return;
  }

  if (document.ItemForm.prcnrdoc.value=="1") {
    linkURL = "priweb02.pbl?reportno=01&template=020&urnumber=" +
             document.UpdateForm.urnumber.value.replace(/ /g,"+")
           + "&uniqnumb=" + document.UpdateForm.uniqnumb.value
           + "&prhre001=" + document.UpdateForm.prhre001.value
           + "&prhre003=" + document.UpdateForm.prhre003.value
           + "&prhre002=" + document.UpdateForm.prhre002.value;
  } else {
    linkURL = "priweb02.pbl?reportno=01&template=001&urnumber=" +
             document.UpdateForm.urnumber.value.replace(/ /g,"+");
  }
  location.href= linkURL;
}

function AddItemsScreen() {
  if (document.UpdateForm.additmsc.value == 1)
    AddItem();
}

//T0859743-start - Remove Ref.Override button
//function ReferralOverride() {
//  if (document.UpdateForm.d_dummyoth != undefined &&
//      document.UpdateForm.d_dummyoth.checked==true) {
//    SetCookie("OtherClaimantDetailsCOOKIE",
//              document.UpdateForm.pmclt003.value + "|" +
//              document.UpdateForm.pmclt004.value + "|" +
//              document.UpdateForm.pmclt006.value + "|" +
//              document.UpdateForm.pmclt007.value + "|" +
//              document.UpdateForm.pmclt005.value + "|" +
//              document.UpdateForm.pmclt008.value + "|" +
//              document.UpdateForm.pmclt009.value + "|" +
//              document.UpdateForm.pmclt010.value + "|" +
//              document.UpdateForm.pmclt012.value);
//  }
//
//  LinkURL="priweb02.pbl?reportno=15&template=001&urnumber=" +
//             document.UpdateForm.urnumber.value.replace(/ /g,"+")
//           + "&uniqnumb=" + document.UpdateForm.uniqnumb.value
//           + "&prhre001=" + document.UpdateForm.prhre001.value
//           + "&prhre002=" + document.UpdateForm.prhre002.value
//           + "&prhre003=" + document.UpdateForm.prhre003.value;
//
//  Left=(document.body.clientWidth-700)/2
//  DFrameLink(LinkURL,180,150,700,290);
//}
//T0859743-end

MPActive="%PRIWEB02.01.231";
if ( MPActive =="1" ) {
  document.UpdateForm.addmbs.disabled=true;
  document.UpdateForm.printinv.disabled=true;
}

document.UpdateForm.invtotal.value="%PRIWEB02.01.234";

if (document.getElementById("ptcnuimc").value!="1") {
  document.getElementById("changeInsuranceBUTTON").value="Change Claim Type";   
}

if (document.ItemForm.ecliindc.value==1) {
  RaiseClaimBDIV.innerHTML=RaiseClaimBSPAN.innerHTML;
}

if (document.ItemForm.ecliuesf.value==1) {
  RaiseClaimPCSDIV.innerHTML=RaiseClaimPCSSPAN.innerHTML;
}

if (document.ItemForm.ecliuebb.value==1) {
  RaiseClaimDBSDIV.innerHTML=RaiseClaimDBSSPAN.innerHTML;
}

if (document.ItemForm.ecliudva.value==1) {
  RaiseClaimDVADIV.innerHTML=RaiseClaimDVASPAN.innerHTML;
}

//T0859743-start - Removed Ref.Override button
//if (document.getElementById("ptcnuimc").value!="1") {
//  document.getElementById("referraloverrideBUTTON").disabled=true;
//} else {
//
//  if (!isWhitespace("%PRIWEB02.01.239.1")) {
//    document.getElementById("referraloverrideBUTTON").className="RedButton";
//  }
//}
//T0859743-end

if (UpdateForm.inviactv.value == "1") {
  UpdateForm.printinv.disabled = true;
  if (document.getElementById('raiseandcbutton') != undefined) {
    document.getElementById('raiseandcbutton').disabled = true;
  }
}

function ValidateVisit(ValidateV,ValidateUR,ReturnName) {
  ReturnFunction="" ;
  ReturnName.value="";
  document.getElementById('admDateDIV').innerHTML="";
  document.getElementById('disDateDIV').innerHTML="";
  for (var i=3; i < ValidateVisit.arguments.length; i++) {
    if (typeof(ValidateVisit.arguments[i]) == 'function') {
      ReturnFunction=ValidateVisit.arguments[i] }
    else {
      ValidateVisit.arguments[i].value=""; }  }
  if (isWhitespace(ValidateV.value)) return;;
  var serverURL = "../cgi-bin/emrweb08.pbl?reportno=18&valdcode=" +
                    ValidateV.value.replace(/ /g,"+") +
                    "&valdurno=" + ValidateUR.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    ReturnName.value=ReturnValue[0];
    j=0
    for (var i=3; i < ValidateVisit.arguments.length; i++) {
       if (typeof(ValidateVisit.arguments[i]) != 'function') {
         j++
         ValidateVisiValidateVisit.arguments[i].value=ReturnValue[j] } }
    if (typeof(ReturnFunction) == 'function') {
       ReturnFunction() } }
  else {
    ValidateV.value="";
    ValidateV.focus();;
    return false;}
}
function validateAdmDis() {
  var serverURL = "../cgi-bin/emrweb08.pbl?reportno=51&valdcode=" +
                    document.getElementById('prhtr030').value.replace(/ /g,"+");
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    document.getElementById('admDateDIV').innerHTML=
    "&nbsp;<b>Adm Date:</b>&nbsp;" + ReturnValue[0] +
                         "&nbsp;";
    document.getElementById('disDateDIV').innerHTML=
    "&nbsp;<b>Dis Date:</b>&nbsp;" + ReturnValue[1] +
                         "&nbsp;";
    validateLinkedVisitNumber();
  }
}
function assignrefEclipseDIV() {

  if (((document.UpdateForm.ptcndvaw.value == "1") &&
      (document.ItemForm.ecliudva.value == "1"))) {

    lnkvisnumtitleDIV.innerHTML=lnkvisnumtitleSPAN.innerHTML;
    lnkvisnumfieldDIV.innerHTML=lnkvisnumfieldSPAN.innerHTML;

    ValidateVisit(UpdateForm.prhtr030,UpdateForm.urnumber,
                  UpdateForm.dummy,validateAdmDis);

    return;
  } 

  if (isWhitespace(document.getElementById('typeacct').value)) {return;}

  if (document.getElementById('typeacct').value.substr(3,1)=="1" ||
      document.getElementById('typeacct').value.substr(3,1)=="2" ||
      document.getElementById('typeacct').value.substr(3,1)=="6" ||
      document.getElementById('typeacct').value.substr(3,1)=="7") {

    lnkvisnumtitleDIV.innerHTML=lnkvisnumtitleSPAN.innerHTML;
    lnkvisnumfieldDIV.innerHTML=lnkvisnumfieldSPAN.innerHTML;

    ValidateVisit(UpdateForm.prhtr030,UpdateForm.urnumber,
                  UpdateForm.dummy,validateAdmDis);
  }
}
function validateLinkedVisitNumber() {
  var serverURL = "../cgi-bin/comweb81.pbl?reportno=2&valdcode=" +
                  document.getElementById('prhtr030').value.replace(/ /g,"+") +
                  "&valdcod2=" + 
                  document.ItemForm.uniqnumb.value.replace(/ /g,"+") + 
                  "&valdcod3=" +
                  document.ItemForm.prhre001.value.replace(/ /g,"+") +
                  "&valdcod4=" +
                  document.ItemForm.prhre002.value.replace(/ /g,"+") +
                  "&valdcod5=" +
                  document.ItemForm.prhre003.value.replace(/ /g,"+");

  var returnValue = RSExecute(serverURL);
}
</script>

    <span id="OtherClaimantTitleSPAN" style="display:none">
    Other Claimant Details
    </span>

    <span id="OtherClaimantOptionSPAN" style="display:none">
    <input type=checkbox name=d_dummyoth value="1" id="d_dummyoth"
     onclick="EclipseStoreForward();" tabindex=2>
    </span>

    <span id="OtherClaimantSearchSPAN" style="display:none">
    <input type=button class=button name=othrbutton
     value="Search" onclick="selectContact();" tabindex=3>
    </span>

   <span id="OtherClaimantUPDSPAN" style="display:none">
    <input type=button class=largebutton name=updbutton
     value="Use Patient Details" onclick="UsePatientDetails();">
    </span>


<span id="lnkvisnumtitleSPAN" style="display:none">
Linked Visit Number
</span>

<span id="lnkvisnumfieldSPAN" style="display:none">
     <input type=text maxlength=8 class="Mandatory" Title="Link Visit Number"
     name=prhtr030 id=prhtr030 value="%PRIWEB02.01.734"
     size=12 onblur="justifyRight(this);
     ValidateVisit(UpdateForm.prhtr030,UpdateForm.urnumber,
                   UpdateForm.dummy,validateAdmDis);">
     <img src="../images/SearchIcon.gif" class=Icon
      onclick="VisitSearchFrame(UpdateForm.urnumber,UpdateForm.prhtr030);">
     <img src="../images/erase.gif" align=absmiddle
      class=Icon onclick="clrFields(UpdateForm.prhtr030);
               document.getElementById('admDateDIV').innerHTML='';
               document.getElementById('disDateDIV').innerHTML='';">
</span>

<span id="ShowEclipseClaimant" style="display:none">
<table cellspacing=0 cellpadding=1 border=0 width=70%>
<tr><td class="DataLabel">Claimant Family Name</td>
    <td class="DataField">
    <input type=hidden name=pmclt001 value="2">
    <input type=text size=42 name=pmclt003 class="Mandatory" tabindex=4
     title="Claimant Family Name" maxlength=40 onchange="UpCase(this);">
    </td>
    <td class="DataLabel">Claimant Address Line 1</td>
    <td class="DataField">
    <input type=text size=37 name=pmclt008 tabindex=9
     onblur="this.value=this.value.toUpperCase();
             validateClaimantMandatory();"
     title="Claimant Address Line 1" maxlength=35>
    </td></tr>

<tr><td class="DataLabel">Claimant First Name</td>
    <td class="DataField">
    <input type=text size=42 name=pmclt004 class="Mandatory" tabindex=5
     title="Claimant First Name" maxlength=40 onchange="UpCase(this);">
    </td>
    <td class="DataLabel">Claimant Address Line 2</td>
    <td class="DataField">
    <input type=text size=37 name=pmclt009 tabindex=10
     onblur="this.value=this.value.toUpperCase();"
     title="Claimant Address Line 2" maxlength=35>
    </td></tr>

<tr><td class="DataLabel">Claimant Medicare Number</td>
    <td class="DataField">
    <input type=text size=12 maxlength=10 name=pmclt006 id=pmclt006
     title="Claimant Medicare Number" class="Mandatory" tabindex=6
     onblur="checkMedicare(pmclt006,pmclt007);">
    <input type=text size=3 maxlength=2 name=pmclt007 id=pmclt007
     title="Claimant Medicare IRN" class="Mandatory" tabindex=7
     onblur="checkIRN(pmclt007);">
    </td>
    <td class="DataLabel">Claimant Suburb</td>
    <td class="DataField">
    <input type=text size=37 name=pmclt010 tabindex=11
     onchange="validateClaimantMandatory();
               LookupPostCode(UpdateForm.pmclt010.value);"
     title="Claimant Suburb" maxlength=35>
    </td></tr>

<tr><td class="DataLabel">Claimant Date of Birth</td>
    <td class="DataField">
    <input type=text size=12 name=pmclt005 title="Claimant Date of Birth"
     class="Mandatory PastDate" tabindex=8>
    <img notab src=../images/DateLookup.gif class="Icon"
     align=absmiddle onclick="DateLookupFrame(pmclt005);">
    <img notab src=../images/DateTimeStamp.gif class="Icon"
     align=absmiddle onclick="SetCurrentDateTime(pmclt005,null);">
    </td>
    <td class="DataLabel">Claimant Post Code</td>
    <td class="DataField">
    <input type=text size=5 name=pmclt012 tabindex=12
     onchange="validateClaimantMandatory();
             LookupSuburb(pmclt012.value)"
     title="Claimant Post Code" maxlength=4>
    </td></tr>

<tr><td class="DataLabel">&nbsp;</td>
    <td class="DataField">&nbsp;</td>
    <td class="DataLabel">&nbsp;</td>
    <td class="DataField">&nbsp;</td>
    </tr>
</table>
</span>
