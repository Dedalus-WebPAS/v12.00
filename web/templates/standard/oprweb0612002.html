<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link
//  1 - Staff
//  2 - Name
//  3 - Start Time
//  4 - End Time
//  5 - Supervisor/Level
//---------------------------------------------------------------------------
function InitTable(TableView) {
    switch (TableView) {
      case 0: {
       document.title="Staff Members"
       t = new Table(1,0,2,"100%","center",25,30);
       t.addColumn("Staff","String",6,6,"left","MaintenanceIcon.gif","0",160)
       t.addColumn("Name","String",2,2,"left","","",150)
       t.addColumn("Count","String",7,7,"left","","",40)
       t.addColumn("Start Time","String",3,3,"left","","",80)
       t.addColumn("End Time","String",4,4,"left","DateTimeStamp.gif","8",80)
       AddTableRows();
       TableOutput(0,2);    // Order Column,Asc Dsc
       break; }
    }
}

// Link To Add Staff
function goToStaff() {
    temp=document.UpdateForm.teamnumb.value;
    supr=document.UpdateForm.suprlevl.value;
    Left=(document.body.clientWidth-600)/2
    linkurl="oprweb06.pbl?reportno=12&template=3&casekeys="+
    UpdateForm.casekeys.value+"&teamnumb="+temp+"&suprlevl="+supr+"&jmphflag="+
    UpdateForm.jmphflag.value;
    Left=(document.body.clientWidth-750)/2
    DFrameLink(linkurl,100,Left,750,350)
}
//  Update Staff End Time and Date
function UpdateEndTime(linkkeys) {
   casekey=UpdateForm.casekeys.value.substr(0,26);
   casekey=casekey.replace(/ /g,"+");
   uniqkey=UpdateForm.uniqueky.value
   uniqkey=uniqkey.replace(/ /g,"+");
   document.UpdateForm.redirect.value="oprweb06.pbl?reportno=12&template=002&"+
                             "uniqueky="+uniqkey +
                             "&jmphflag="+document.UpdateForm.jmphflag.value;

   document.UpdateForm.opdunqid.value=linkkeys;
   document.UpdateForm.nextpage.value=1;
   document.UpdateForm.updatety.value="E";
   formSubmit();
}
function UpdateEndTimeFF(linkkeys) {
   casekey=UpdateForm.casekeys.value.substr(0,26);
   casekey=casekey.replace(/ /g,"+");
   uniqkey=UpdateForm.uniqueky.value
   uniqkey=uniqkey.replace(/ /g,"+");
   document.UpdateForm.redirect.value="oprweb06.pbl?reportno=12&template=002&"+
                             "uniqueky="+uniqkey +
                             "&jmphflag="+document.UpdateForm.jmphflag.value;
   document.UpdateForm.opdunqff.value=linkkeys;
   document.UpdateForm.nextpage.value=1;
   document.UpdateForm.updatety.value="N";
   formSubmit();
}
// Link to Update Staff
function UpdateLink(scasekey,staftype,stafcode,stardate,startime) {
   temp=document.UpdateForm.teamnumb.value;
   supr=document.UpdateForm.suprlevl.value;
   Left=(document.body.clientWidth-600)/2
   linkurl="oprweb06.pbl?reportno=12&template=4&casekeys="+
   scasekey+"&teamnumb="+temp+"&optsm001="+
   staftype+"&optsm002="+stafcode+"&optsm003="+
   stardate+"&optsm004="+startime+
   "&suprlevl="+supr+
   "&jmphflag="+document.UpdateForm.jmphflag.value;
   Left=(document.body.clientWidth-750)/2
   DFrameLink(linkurl,100,Left,750,350)
}
function UpdateLinkFF(scasekey,staftype,stafcode,stardate,startime) {
   temp=document.UpdateForm.teamnumb.value;
   supr=document.UpdateForm.suprlevl.value;
   linkurl="oprweb06.pbl?reportno=12&template=4&casekeys="+
   scasekey+"&teamnumb="+temp+"&optsm001="+
   staftype+"&optsm002="+stafcode+"&optsm003="+
   stardate+"&optsm004="+startime+
   "&suprlevl="+supr+
   "&opsdt001="+document.UpdateForm.uniqueky.value+
   "&opsdt002="+document.UpdateForm.teamnumb.value+
   "&opsdt003="+staftype+
   "&opsdt004="+stafcode+
   "&opsdt005="+stardate+
   "&opsdt006="+startime+
   "&jmphflag="+document.UpdateForm.jmphflag.value;
   Left=(document.body.clientWidth-750)/2
   DFrameLink(linkurl,100,Left,750,350)
}
// Form Submit
function formSubmit() {
   if(validateMandatory(UpdateForm)) {
      casekey=UpdateForm.casekeys.value.substr(0,26);
      casekey=casekey.replace(/ /g,"+");
      uniqkey=UpdateForm.uniqueky.value
      uniqkey=uniqkey.replace(/ /g,"+");
      if (isWhitespace(UpdateForm.redirect.value)) {
        UpdateForm.redirect.value="oprweb06.pbl?reportno=12&template=002&"+
                            "jmphflag="+document.UpdateForm.jmphflag.value;
                                  "&uniqueky="+uniqkey+"&teamnumb="; 

      }
      document.UpdateForm.submit();
    }
}
function getaddStaffCOOKIE() {
  if (GetCookieData("addStaffCOOKIE") != "unknown") {
    ExpireCookiePath("addStaffCOOKIE");
    UpdateForm.jmphflag.value="1";
    StaffHeading.innerHTML = JMPHHead.innerHTML;
    return;
  } else {
    if (document.UpdateForm.jmphflag!="undefined") {
      if (document.UpdateForm.jmphflag.value=="1") {
          StaffHeading.innerHTML = JMPHHead.innerHTML;
          return;
      }
    }
  }
  StaffHeading.innerHTML = StdHead.innerHTML;
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);getaddStaffCOOKIE();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OPRWEB06.12.003";
PatientVIS="%OPRWEB06.12.081";
PatientNAM="%OPRWEB06.12.002";
PatientSTA="%OPRWEB06.12.086.078";
PatientALT="%OPRWEB06.12.084";
PatientSEX="%OPRWEB06.12.019";
PatientDOB="%OPRWEB06.12.020";
PatientAGE="%OPRWEB06.12.021";
PatientLOC="%OPRWEB06.12.083";
PatientPRI="%OPRWEB06.12.086.066.1";
PatientUNT="%OPRWEB06.12.066.0";
DoctorCOD="%OPRWEB06.12.082.003";
DoctorNAM="%OPRWEB06.12.082.002";
PatientAID="%OPRWEB06.12.086.090";
PatientIND="%OPRWEB06.12.086.091";
PatientCUR="%OPRWEB06.12.086.092";
PatientCLC="%OPRWEB06.12.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OPRWEB06.12.086.094";
PatientCDM="%OPRWEB06.12.086.095";
PatientVDH="%OPRWEB06.12.086.099.015";
InsertPatientHeader()
</script>
<div id="PatientMenu"></div>

<div id=PageBodySection>
<form name=UpdateForm method=post action="oprweb06.pbl">
<input type=hidden name=reportno value=12>
<input type=hidden name=template value=2>
<input type=hidden name=updatety value="">
<input type=hidden name=urnumber value='%OPRWEB06.12.003'>
<input type=hidden name=casekeys value="%OPRWEB06.12.101">
<input type=hidden name=uniqueky value='%OPRWEB06.12.110'>
<input type=hidden name=redirect value="">
<input type=hidden name=nextpage value=1>
<input type=hidden name=jmphflag value="%OPRWEB06.12.361">
<input type=hidden name=suprlevl value="%OPRWEB06.12.313">
<input type=hidden name=opdunqid value="">
<input type=hidden name=opdunqff value="">
<input type=hidden name=rdirflag value="%OPRWEB06.12.314">
<input type=hidden name=teamnumb value="%OPRWEB06.12.334">

<table border="0" cellpadding="2" cellspacing="0" width="100%" align=center>
<tr>
   <td align=center width=85% class=HeadingCell><div id=StaffHeading></div></td>
   <td align=right class=HeadingCell><font color=red>
     %OPRWEB06.12.208</font></td></tr>

</table>
<table border="0" cellpadding="2" cellspacing="0" width="100%" align=center>
<tr><td class=DataLabel>Consultant</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB06.12.404.003")'>
     %OPRWEB06.12.404.002 </a></td>
    <td class=DataLabel>Operating Surgeon</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB06.12.311.003")'>
     %OPRWEB06.12.311.002 </a></td>
</tr>

<tr><td class=DataLabel>Unit</td>
    <td class=DataField>%OPRWEB06.12.413.0</td>
    <td class=DataLabel>Theatre</td>
    <td class=DataField>%OPRWEB06.12.302</td>
</tr>

<tr><td class=DataLabel>Date </td>
    <td class=DataField>%OPRWEB06.12.406 %OPRWEB06.12.402</td>
    <td class=DataLabel>Time </td>
    <td class=DataField>%OPRWEB06.12.403</td>
</tr>

<tr><td colspan=4 align=center>
    <input type=button id="opr06sub" value="Add Staff" class="button"
     onclick="tempDisable(this);goToStaff();">
    <input type=button value="Close" class="button" 
     onclick="closeStaff();">
</td></tr>
</table>
</form>


<div id=HeadingSection></div>
<div id=TableLocation></div>
<script type="text/javascript">
function AddTableRows() {
  %OPRWEB06.12.329
  %OPRWEB06.12.360
}
function closeStaff() {
  if (document.UpdateForm.rdirflag.value=="2") {
    PatientLinkTo("oprweb06.pbl",12,7,0,0);
  }
  else if (document.UpdateForm.rdirflag.value=="1") {
    PatientLinkTo("oprweb06.pbl",12,6,0,0);
  }
  else {
    PatientLinkTo("oprweb06.pbl",12,1,0,0);
  }
}

</script>

<span id=JMPHHead style="display:none">
    Jessie McPherson In - Theatre Details - Staff Maintenance
</span>

<span id=StdHead style="display:none">
    Day Procedures - Staff Maintenance
</span>

<form  name=PatientLinks method=get>
<input type=hidden name=reportno value=12>
<input type=hidden name=template value=002>
<input type=hidden name=urnumber value='%OPRWEB06.12.003'>
<input type=hidden name=admissno value='%OPRWEB06.12.081'>
<input type=hidden name=MenuType value='%OPRWEB06.12.088'>
<input type=hidden name=casekeys value='%OPRWEB06.12.101'>
<input type=hidden name=uniqueky value='%OPRWEB06.12.110'>
<input type=hidden name=teamnumb value='%OPRWEB06.12.334'>
<input type=hidden name=jmphflag value="%OPRWEB06.12.361">
</form>
</div>
