<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb06.js"> </script>
<script type="text/javascript" src="../js/TheatreScreensHoverInfo.js"> </script>
<script type="text/javascript">
function validateNurse(code,name) {
  var hcpnurse = chkHcpOTNurse();
  if  (hcpnurse==true){
      validateCode('18',code,name);
  }
  else {
      validateCode('17',code,name,document.UpdateForm.gnm);
      SetNurseName(name);
  }
}
function SetNurseName(name) {
  name.value=UpdateForm.gnm.value.replace(/\s*$/g,"") + " " +
             name.value.replace(/\s*$/g,"")
}

function chkTime(field){
  if(isWhitespace(field.value)) {
    return;
  }

  if (document.UpdateForm.d_opsrg074.checked==true) {
    return;
  }

  endTime=UpdateForm.opsrg006.value.replace(/:/g,"");
  if(isWhitespace(endTime)){
     alert("Surgery End Time must be entered first");
     field.value=""
     return;
  }
  OperDate=document.UpdateForm.casekeys.value.substring(3,11);
  if(document.UpdateForm.currdate.value > OperDate) {
    return;
  }
  if(field.value.replace(/:/g,"")<=endTime){
    if(!confirm(""+field.title+" must be after Surgery End Time." +
                "\n Do you want to override?")) {
      field.value="";
    }
  }
}

function ChgSurgeon() {
  UpdateForm.target="PopUpFrame"
  if (UpdateDayProc()) {
    setTimeout('showChgSur()',100);
  }
  UpdateForm.target="";
}

function showChgSur() {
   setTimeout(function(){document.getElementById("chgthebutt").disabled=false;},2000);
  caseKeys=UpdateForm.casekeys.value.replace(/ /g,"+");
  teamNumb=UpdateForm.teamnumb.value;
  linkurl="oprweb06.pbl?reportno=12&template=005&casekeys="+caseKeys+
          "&teamnumb="+teamNumb;
  Left=(document.body.clientWidth-750)/2
  DFrameLink(linkurl,100,Left,750,350)
}

// Change Theatre
function ChgOpr() {
  UpdateForm.target="PopUpFrame"
  if (UpdateDayProc()) {
    setTimeout('showChgOpr()',100);
  }
  UpdateForm.target="";
}

function showChgOpr() {
   setTimeout(function(){document.getElementById("chgsrgbutt").disabled=false;},2000);
  linkurl="oprweb01.pbl?reportno=4&template=014&casekeys="
           +UpdateForm.casekeys.value; 
  Left=(document.body.clientWidth-350)/2
  DFrameLink(linkurl,100,Left,350,180)
}

function AddItem() {
  if(document.UpdateForm.opsrg005.value=="") {
    alert("Surgery Start Time must be entered first.");
    return;
  }
  if(UpdateForm.opcncomb.value=="1") {
    caseKeys=UpdateForm.casekeys.value.replace(/ /g,"+");
    teamNumb=UpdateForm.teamnumb.value;

    if(document.UpdateForm.d_opsrg076.checked == true){
      UpdateForm.redirect.value="oprweb06.pbl?reportno=03&template=004"+
               "&casekeys="+caseKeys+"&teamnumb="+teamNumb+"&nowarnfl=1"
    }else {
      UpdateForm.redirect.value="oprweb06.pbl?reportno=03&template=004"+
               "&casekeys="+caseKeys+"&teamnumb="+teamNumb
    }

    UpdateDayProc();
  } else {
    UpdateForm.target="PopUpFrame"
    if (UpdateDayProc()) {
        setTimeout('showItem()',100);
    }
    UpdateForm.target="";
  }
}

function showItem() {
  caseKeys=UpdateForm.casekeys.value.replace(/ /g,"+");
  teamNumb=UpdateForm.teamnumb.value;
  Left=(document.body.clientWidth-800)/2
  DFrameLink("oprweb06.pbl?reportno=02&template=003&casekeys="+caseKeys +
             "&teamnumb="+teamNumb,100,Left,850,350);
}

function SetPrinter(SelectList) {
 if (SelectList.className=="SelectBig") {
     SelectList.className="SelectBig" }
 else {
     SelectList.className="SelectBig" }
}

// Update Day Procedure Details
function UpdateDayProc() {

   if (!checkVisitDatesTimes()) {return;}

   document.UpdateForm.updatety.value="U";

   // Set Anaesthetic Prep Time to be equal to Anaesthetic Start Time.  
//   document.UpdateForm.opard041.value = document.UpdateForm.opard042.value;

   // Set Prep Time to be equal to Surgery Start Time. This is required
   // for calculation of Actual Operation Minutes.
   document.UpdateForm.opsrg003.value = document.UpdateForm.opsrg005.value;

   // Set Dressing Time to be equal to Surgery End Time. This is required
   // for calculation of Actual Operation Minutes.
   document.UpdateForm.opsrg004.value = document.UpdateForm.opsrg006.value;

   // Set Ready To Depart Time to be equal to the Exit Theatre Complex Time.
   //This is needed as opard085 is not displayed on the screen
   //Only update Ready to Depart if is is blank, or currently the same as the
   //Exit Theatre Complex Time
//   if(isWhitespace(document.UpdateForm.opard085.value)) {
//     document.UpdateForm.opard085.value = document.UpdateForm.opard080.value;
//   }
//   if(document.UpdateForm.old_opard080.value==
//                document.UpdateForm.opard085.value) {
//     document.UpdateForm.opard085.value = document.UpdateForm.opard080.value;
//   }
   if(document.UpdateForm.old_opard077.value==
                document.UpdateForm.opard071.value) {
     document.UpdateForm.opard071.value = document.UpdateForm.opard077.value;
   }
   if(document.UpdateForm.old_opard077.value==
                document.UpdateForm.opard074.value) {
     document.UpdateForm.opard074.value = document.UpdateForm.opard077.value;
   }

// if (document.UpdateForm.ptcnpros.value == 1) {
//    document.UpdateForm.opdea043.value=document.UpdateForm.d_opdea043.value;
// }
   if (UpdateForm.ovrnight.checked == true)
     UpdateForm.opsrg071.value = "1";

   return(formSubmit());

}

function ChkBirth() {
 if (UpdateForm.oldtbrth.value != "1") {
  if (UpdateForm.theabrth.checked == true) {
    caseKeys=UpdateForm.casekeys.value.replace(/ /g,"+");
    Admnumb=PatientLinks.admissno.value.replace(/ /g,"+");
    SetCookie("birthCookie", 
         "oprweb06.pbl?reportno=18&template=001&casekeys="+
         caseKeys + "&admissno="+Admnumb);
  }
 }
}
function GetBirth() {
 if (GetCookieData("birthCookie") != "unknown") {
   document.UpdateForm.brthcook.value=GetCookieData("birthCookie");
   ExpireCookiePath("birthCookie");

  caseKeys=UpdateForm.casekeys.value.replace(/ /g,"+");
  Admnumb=PatientLinks.admissno.value;
  linkurl="oprweb06.pbl?reportno=18&template=001&casekeys="+caseKeys+
          "&admissno="+Admnumb;
  Left=(document.body.clientWidth-1000)/2
  DFrameLink(linkurl,100,Left,1000,500)
 }
}

function chkAnaesTime() {
  if(!isWhitespace(UpdateForm.opard042.value)) {
    if(isWhitespace(UpdateForm.opard002.value)) {
      alert("Arrival Time must be entered first.");
      UpdateForm.opard042.value="";
      UpdateForm.opard002.focus();
      return;
    }
    ArrivT= UpdateForm.opard002.value.replace(/:/g,"");
    AnaesT= UpdateForm.opard042.value.replace(/:/g,"");
    if(AnaesT < ArrivT) {
      if(confirm("Anaesthetic Administration should be greater than Arrival Time."
                 + "\n Do you want to override?")) {
        return;
      }
      UpdateForm.opard042.value="";
      UpdateForm.opard042.focus();
    }
  }
}

// Validate Surgery Start Time
function chkSurgStart() {
  f = document.UpdateForm;
  i = f.opdea003.selectedIndex;
  ind1 = f.opdea003.options[i].value.substr(3,1);
  if(!isWhitespace(UpdateForm.opsrg005.value)) {
    if(isWhitespace(UpdateForm.opard042.value)) {
      if (ind1 == '5') {
        return true;
      }
      alert("Anaesthetic/Prep Time must be entered first.");
      UpdateForm.opsrg005.value="";
      UpdateForm.opard042.focus(); 
      return false;
    }
    var anaeTime = trim(UpdateForm.opard042.value.replace(/:/g,""))
    var surgStrt = trim(UpdateForm.opsrg005.value.replace(/:/g,""))
    anaeTime=anaeTime.substr(0,4)
    surgStrt=surgStrt.substr(0,4)
    anaeTime=anaeTime - 0;
    surgStrt=surgStrt - 0;
    if(anaeTime > surgStrt) {
      if(!confirm("Surgery Start Time should be greater than Anaesthetic/Prep"+
                  " Time.\n Do you want to override?")) {
        UpdateForm.opsrg005.value="";
        UpdateForm.opsrg005.focus()
        return false;
      }
    }
  }
  return true;
}

// Validate Surgery End Time
function chkSurgEnd() {
  if(!isWhitespace(UpdateForm.opsrg006.value)) {
    if(isWhitespace(UpdateForm.opsrg005.value)) {
      alert("Surgery Start Time must be entered first.");
      UpdateForm.opsrg006.value="";
      UpdateForm.opsrg005.focus(); 
      return;
    }
    valPrepDress();
  }
}

function setETTime(extime) {
  if (!isWhitespace(extime.value)) {
     document.UpdateForm.opard080.value=extime.value; }
}
function setRTDTime(extime) {
  if(!isWhitespace(extime.value)) {
     if(isWhitespace(document.UpdateForm.opard085.value)) {
       document.UpdateForm.opard085.value=extime.value; 
     }
  }
}

// Validate Admitting Nurse Start Time/End Time/Anaesthetic Cannulation
function chkAdmStartTimeEndTimeAneaCannTime() {
  f = document.UpdateForm;
  if (isWhitespace(f.opard115.value) &&
      isWhitespace(f.opard116.value) &&
      isWhitespace(f.opard041.value)) {
    return true;
  }

  if (!isWhitespace(f.opard116.value)) {
    if (isWhitespace(f.opard115.value)) {
      alert(f.opard115.title + " must be entered before " +
            f.opard116.title + ".");
      return false;
    }
    else {
      if (f.opard116.value == f.opard115.value) {
        alert(f.opard116.title + " must be after the " +
              f.opard115.title + " and must be prior to " +
              f.opard041.title)
        return false;
      }
      else {
        if (!checkTimes(f.opard115,f.opard116)) {
          alert(f.opard116.title + " must be after the " +
                f.opard115.title + " and must be prior to " +
                f.opard041.title)
          return false;
        }
      }
    }
  }

  if (!isWhitespace(f.opard041.value) &&
      !isWhitespace(f.opard116.value)) {
    if (f.opard041.value == f.opard116.value) {
      alert(f.opard116.title + " must be after the " +
            f.opard115.title + " and must be prior to " +
            f.opard041.title)
      return false;
    }
    else {
      if (!checkTimes(f.opard116,f.opard041)) {
        alert(f.opard116.title + " must be after the " +
              f.opard115.title + " and must be prior to " +
              f.opard041.title)
        return false;
      }
    }
  }

  return true;
}
function chkAdmNurseStartTimePatAdmTime() {
  f = document.UpdateForm;

  if (isWhitespace(f.opard115.value)) {return true;}

  if (f.admntime.value == f.opard115.value) {
    alert("Admitting Nurse Start Time must be after the Patient Admission Time.")
    return false;
  }

  if (!checkTimes(f.admntime,f.opard115)) {
    alert("Admitting Nurse Start Time must be after the Patient Admission Time.")
    return false;
  }

  return true;
}
// Validate Arrival Time/Wheels In Time
function chkArrivalTimeWheelsInTime() {
  f = document.UpdateForm;

  if (isWhitespace(f.opsrg080.value)) {return true;}
  if (isWhitespace(f.opard002.value)) {
    alert(f.opard002.title + " must be entered before " +
          f.opsrg080.title + ".");
    if (f.opsrg080.readOnly == false ) {
      f.opsrg080.value = "";
    }
    return false;
  }

  if (f.opard002.value == f.opsrg080.value) {
    alert(f.opsrg080.title + " must be after " + f.opard002.title)
    return false;
  }
  else {
    if (!checkTimes(f.opard002,f.opsrg080)) {
      alert(f.opsrg080.title + " must be after " + f.opard002.title)
      return false;
    }
  }

  return true;
}

function checkTimes (field1,field2) {
  var value1 = trim(field1.value.replace(/:/g,""))
  var value2 = trim(field2.value.replace(/:/g,""))
  value1 = value1.substr(0,6)
  value2 = value2.substr(0,6)
  if (value1 > value2) {
    return false;
  }
  else {
    return true;
  }
}

// Validate Wheels Out Time/Time in Recovery-Day Procedure/Surgery End
function chkWheelsOutTimeInRecoverySurgeryEnd() {
  f = document.UpdateForm;

  // Wheel out is blank
  if (isWhitespace(f.opsrg081.value)) {
    if (isWhitespace(f.opard077.value)) {
      return true;
    }
    else {
      if (isWhitespace(f.opsrg006.value)) {
        alert(f.opsrg006.title + " must be entered before " +
              f.opard077.title + ".");
        return false;
      }
      else {
        if (!checkTimes(f.opsrg006,f.opard077)) {
          var SurgeryEndTime=trim(document.UpdateForm.opsrg006.value.replace(/:/g,""))
          var RecoveryTime=trim(document.UpdateForm.opard077.value.replace(/:/g,""))
          SurgeryEndTime=SurgeryEndTime.substr(0,4)
          RecoveryTime=RecoveryTime.substr(0,4)
          if (f.ovrnight.checked == true && SurgeryEndTime <= 2359 && RecoveryTime > 0000) {}
          else {
            alert(f.opsrg006.title + " cannot be greater than " +
                  f.opard077.title + ".")
            return false;
          }
        }
      }
    }
  }
  // Wheel out is not blank
  else {
    if (isWhitespace(f.opard077.value)) {
      return true;
    }
    else {
      if (!checkTimes(f.opsrg081,f.opard077)) {
        alert(f.opsrg081.title + " cannot be greater than " +
              f.opard077.title + ".")
        return false;
      }
    }
  }

  return true;
}

// Validate time field before update
function chkTimesBeforeUpdate() {

  if (!checkTime(document.UpdateForm.opard042,
                 document.UpdateForm.opard042.title))
    {return;}

  if (!chkAdmNurseStartTimePatAdmTime()) { return false;}
  if (!chkAdmStartTimeEndTimeAneaCannTime()) { return false;}
  if (!chkArrivalTimeWheelsInTime()) { return false;}
  if (!chkWheelsOutTimeInRecoverySurgeryEnd()) { return false;}
  if (!chkSurgStart()) { return false;}

  return true;
}

// Refresh Page
function RefreshPage() {
   if(UpdateForm.d_opsrg074.checked == true){
      UpdateForm.opsrg074.value = "1";
   }

   document.UpdateForm.method="get"
   document.UpdateForm.updatety.value="";
   document.UpdateForm.submit();
}
// Link To Staff List
function goToStaff() {
  caseKey=UpdateForm.casekeys.value.replace(/ /g,"+")
  temp=document.UpdateForm.teamnumb.value;
  supr=document.UpdateForm.suprlevl.value;
  UpdateForm.redirect.value="oprweb06.pbl?reportno=12&template=2&casekeys="+
                             caseKey+"&teamnumb="+temp+"&suprlevl="+supr;
  UpdateDayProc();
}
// Link To Implant List
function goToImplant() {
  caseKey=UpdateForm.casekeys.value.replace(/ /g,"+")
  temp=document.UpdateForm.teamnumb.value;
  supr=document.UpdateForm.suprlevl.value;
  UpdateForm.redirect.value="oprweb06.pbl?reportno=7&template=1&casekeys="+
                             caseKey+"&teamnumb="+temp+"&suprlevl="+supr;
  SetCookie("addimplantCOOKIE","1");
  UpdateDayProc();
}

function formSubmit(){

  var timeThrExit = UpdateForm.opard080.value;
  if (!isWhitespace(timeThrExit)) {
    if (isWhitespace(document.UpdateForm.opard077.value) &&
        isWhitespace(document.UpdateForm.opard083.value) &&
        document.UpdateForm.d_opsrg076.checked == false) {
      alert("A Recovery Time must be Entered.");
      return;
    }
  }

  if(document.UpdateForm.d_opsrg072.checked==false) {
     document.UpdateForm.opsrg072.value="0";
  } else {
     document.UpdateForm.opsrg072.value="1";
  }

  if(document.UpdateForm.d_opsrg073.checked==false) {
     document.UpdateForm.opsrg073.value="0";
  } else {
     document.UpdateForm.opsrg073.value="1";
  }

  if(document.UpdateForm.d_opsrg076.checked==false) {
     document.UpdateForm.opsrg076.value="0";
  } else {
     document.UpdateForm.opsrg076.value="1";
  }

   if(validateMandatory(UpdateForm)){
      casekey=UpdateForm.casekeys.value.substr(0,26);
      casekey=casekey.replace(/ /g,"+");
      uniqkey=UpdateForm.uniqueky.value;
      uniqkey=uniqkey.replace(/ /g,"+");
      if(isWhitespace(UpdateForm.redirect.value)){
         UpdateForm.redirect.value="oprweb06.pbl?reportno=12&template=008&uniqueky="+uniqkey+"&teamnumb="; 
      }
      if(UpdateForm.d_opsrg074.checked == true){
         UpdateForm.opsrg074.value = "1";
      }
      document.UpdateForm.submit();
      return true;
   }
   else{
      return false;
   }
}
// Set Team no.
function setTeamNumber(){
 PatientLinks.teamnumb.value=UpdateForm.teamnumb.value;
}

// Procedure Description to be made Mandatory
function ProcMan() {
  if(!isWhitespace(UpdateForm.opard077.value))  
     UpdateForm.opdea014.className="";
  else{
     UpdateForm.opdea014.className="";
  }
}

// Validate Prep Start/Surgery Start and Dressing/Surgery End Times
function valPrepDress() {
  var prepTime = trim(document.UpdateForm.opsrg005.value.replace(/:/g,""));
  var dressTime = trim(document.UpdateForm.opsrg006.value.replace(/:/g,""));
  if (isWhitespace(dressTime) || isWhitespace(prepTime))
    return;

  if ((dressTime < prepTime) && (UpdateForm.ovrnight.checked != true)) {
    if(confirm("Is Surgery End the day after Surgery Start time?"))
      UpdateForm.ovrnight.checked=true;
    else
      UpdateForm.opsrg006.focus();
      return;
  }

  if ((dressTime >= prepTime) && (UpdateForm.ovrnight.checked == true)) {
    if(!confirm("Warning: The Overnight Indicator is set - Time difference " +
       "between\nSurgery Start time and Surgery End time is greater than " +
       "24 hours!")) {
      UpdateForm.ovrnight.focus();
      return;
    }
  }

}
function displayReasonOvernight() {
  if (UpdateForm.ovrnight.checked == true) {
    ReasonForOvernightTitleDIV.innerHTML=
    ReasonForOvernightTitleSPAN.innerHTML;
    ReasonForOvernightFieldDIV.innerHTML=
    ReasonForOvernightFieldSPAN.innerHTML;
  } else {
    ReasonForOvernightTitleDIV.innerHTML="";
    ReasonForOvernightFieldDIV.innerHTML=
    NoReasonForOvernightFieldSPAN.innerHTML;
  }
}
function AnaestheticMand() {
  if(!isWhitespace(UpdateForm.opsrg006.value)) {
    UpdateForm.opdea003.className="";
  } else {
    UpdateForm.opdea003.className="";
  }
}

//C-0825792 - Check parameter to Use pmshcpaf/oprnuraf for OT Nurse
function chkHcpOTNurse(){
  if (document.getElementById('opcnurse')) {
      if (document.getElementById('opcnurse').value == "1") {
        return true;
      }
      else {
        return false;
      }
  }
  else {
      return false;
  }
}
//C-0825792 - Search Nurse from pmshcpaf/oprnuraf for OT Nurse
function SearchOTNurse(NurseId,ReturnNurseName) {
  var hcpnurse = chkHcpOTNurse();
  if (hcpnurse==true){
     HCPSearchFrame(NurseId,ReturnNurseName,20);
  }
  else {
     NurseSearchFrame(NurseId,ReturnNurseName);
  }
}
function displayPACU() {
  if (document.UpdateForm.opcnpacu.value=="1") {
    ReasonForRecoveryDIV.innerHTML=ReasonForRecoverySPAN1.innerHTML; 
    return;
  }
  if (document.UpdateForm.opcnpacu.value=="2") {
    ReasonForRecoveryDIV.innerHTML=ReasonForRecoverySPAN2.innerHTML;
    return;
  }
  if (document.UpdateForm.opcnpacu.value=="3") {
    ReasonForRecoveryDIV.innerHTML=ReasonForRecoverySPAN3.innerHTML;
    return;
  }
  if (document.UpdateForm.opcnpacu.value=="4") {
    ReasonForRecoveryDIV.innerHTML=ReasonForRecoverySPAN4.innerHTML;
    return;
  }
  if (document.UpdateForm.opcnpacu.value=="5") {
    ReasonForRecoveryDIV.innerHTML=ReasonForRecoverySPAN5.innerHTML;
    return;
  }
}

/******************************************************************************
 * adverse Event code
 *****************************************************************************/
function checkTimeToICUExist()
{
  var opard083 = document.getElementById("opard083");
  var adverseEventDiv = document.getElementById("adverseEventDiv");

  if(opard083.value.replace(/ /g,"").length != 0)
  {
    adverseEventDiv.style.display = "";
  }
}
function setReadyDepartTimeICU(opard083)
{
  SetCurrentDateTime(null,opard083);
  checkTimeToICUExist();

}
function checkReadyToDepartExist()
{
  var opard085 = document.getElementById("opard085");
  var adverseEventDiv = document.getElementById("adverseEventDiv");

  if(opard085.value.replace(/ /g,"").length != 0)
  {
    adverseEventDiv.style.display = "";
  }
}

function setReadyDepartTime(opard085)
{
  SetCurrentDateTime(null,opard085);
  checkReadyToDepartExist();

}

function changeTextForAdverseEvent()
{
 var adverseText = document.getElementById("adverseText");

 if(EventExist.replace(/ /g,"").length != 0 )
 {
    if(EventExist == 1) {
        adverseText.innerHTML = "<b>Would you like to modify the adverse events?</b>";
        return true;
   }else {
        adverseText.innerHTML = "<b>Did an adverse event occur?</b>";
        return false;
   }
 }else {
    adverseText.innerHTML = "<b>Did an adverse event occur?</b>";
    return false;
 }
}

function checkAdverseResponse()
{
 var adverseDropDown = document.getElementById("adverseDropDown");
 var adverseEventDiv = document.getElementById("adverseEventDiv");
 var casekeys = document.getElementById("casekeys");

 var bool = changeTextForAdverseEvent();

 if(adverseDropDown.value == "Yes" && !bool)
 {
   var url = "oprweb06.pbl?reportno=10&template=010";

   url += "&urnumber="+PatientURN;
   url += "&admissno="+PatientVIS;
   url += "&nodressg=1";
   url += "&casekeys="+casekeys.value;

   adverseEventDiv.style.display = "none";
   ShowDetail01(url);
 }
 else if(adverseDropDown.value == "Yes" && bool)
 {
   var url = "oprweb06.pbl?reportno=10&template=011";

   url += "&urnumber="+PatientURN;
   url += "&admissno="+PatientVIS;
   url += "&nodressg=1";
   url += "&casekeys="+casekeys.value;

   adverseEventDiv.style.display = "none";

   ShowDetail01(url);
 }
 else
 {
   adverseEventDiv.style.display = "none";
 }

}

function ShowDetail01(linkurl)
{
  Left=(document.body.clientWidth-900)/2
  var frame = document.getElementById("PopUpFrame");
  frame.style.overflow = "auto";
  frame.style.height = 700 +"px";

  DFrameLink(linkurl,0,Left,900,700)
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);UpdateForm.opard039.focus();
             setTeamNumber();ProcMan();
             AnaestheticMand();LoadDefTeam();GetBirth();
             ChkDelay();ChkDelayAnaes();ChkDelaySurg();
             displayReasonOvernight();displayPACU();ChkRecoveryInDelay();
             ChkRecoveryExitDelay();changeTextForAdverseEvent();
             setTimeout('ChkReg()',100);
             SetAbandonCaseFlag();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OPRWEB06.12.003";
PatientVIS="%OPRWEB06.12.081";
PatientNAM="%OPRWEB06.12.002";
PatientSTA="%OPRWEB06.12.086.078";
PatientALT="%OPRWEB06.12.084";
PatientSEX="%OPRWEB06.12.019";
PatientDOB="%OPRWEB06.12.020";
PatientAGE="%OPRWEB06.12.021";
PatientLOC="%OPRWEB06.12.083";
PatientPRI="%OPRWEB06.12.086.066.1";
PatientUNT="%OPRWEB06.12.066.0";
DoctorCOD="%OPRWEB06.12.082.003";
DoctorNAM="%OPRWEB06.12.082.002";
PatientAID="%OPRWEB06.12.086.090";
PatientIND="%OPRWEB06.12.086.091";
PatientCUR="%OPRWEB06.12.086.092";
PatientCLC="%OPRWEB06.12.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OPRWEB06.12.086.094";
PatientCDM="%OPRWEB06.12.086.095";
PatientVDH="%OPRWEB06.12.086.099.015";
InsertPatientHeader()
EventExist="%OPRWEB06.12.843";
</script>
<div id="PatientMenu"></div>

<div id=PageBodySection>
<form name=UpdateForm method=post action="oprweb06.pbl" style="margin:0">
<input type=hidden name=reportno value=12>
<input type=hidden name=template value=8>
<input type=hidden name=updatety value="">
<input type=hidden name=urnumber value='%OPRWEB06.12.003'>
<input type=hidden name=casekeys value="%OPRWEB06.12.101">
<input type=hidden name=uniqueky value='%OPRWEB06.12.110'>
<input type=hidden name=redirect value="">
<input type=hidden name=nextpage value=1>
<input type=hidden name=gnm id=gnm>
<input type=hidden name=suprlevl value="%OPRWEB06.12.313">
<input type=hidden name=opdunqid value="">
<input type=hidden name=teamnumb value="%OPRWEB06.12.334">
<input type=hidden name=currdate value="%STANDARD.01.013">
<input type=hidden name=opard071 value="%OPRWEB06.12.571">
<input type=hidden name=opard074 value="%OPRWEB06.12.574">
<input type=hidden name=old_opard077 value="%OPRWEB06.12.577">
<input type=hidden name=opsrg003>
<input type=hidden name=opsrg004>
<input type=hidden name=opsrg071 value=" ">
<input type=hidden name=old_opard080 value="%OPRWEB06.12.580">
<input type=hidden name=opcncomb value="%STANDARD.01.025.113.003.0.1">
<input type=hidden name=ptcnpros value="%STANDARD.01.025.118.115.0.1">
<input type=hidden name=opdea043 value="%OPRWEB06.12.174">
<input type=hidden name=opsedtcm id=opsedtcm value="%OPRWEB06.12.483">
<input type=hidden name=brthcook value="">
<input type=hidden name=oldtbrth value="%OPRWEB06.12.350">
<input type=hidden name=opsrg074>
<input type=hidden name=opsework id=opsework value='%OPRWEB06.12.402'
 title="Session Date">
<input type=hidden name="admndate" id="admndate" value="%OPRWEB06.12.351"
 title="Admission Date">
<input type=hidden name="admntime" id="admntime" value="%OPRWEB06.12.352">
<input type=hidden name="discdate" id="discdate" value="%OPRWEB06.12.353"
 title="Discharge Date">
<input type=hidden name="disctime" id="disctime" value="%OPRWEB06.12.354">
<input type=hidden name=opcnurse id=opcnurse
       value="%STANDARD.01.025.113.051.0.1">
<input type=hidden name="mindelay" id="mindelay" value="%STANDARD.01.025.042.133.1.5">
<input type=hidden name="opcntopa" id="opcntopa" value="%STANDARD.01.025.113.053.0.2">
<input type=hidden name="opcnacss" id="opcnacss" value="%STANDARD.01.025.113.055.0.2">
<input type=hidden name="opcnpacu" id="opcnpacu" value="%STANDARD.01.025.113.059.0.1">
<input type=hidden name="opcnsetr" id="opcnsetr" value="%STANDARD.01.025.113.057.0.2">
<input type=hidden name="opcnvrrd" id="opcnvrrd" value="%STANDARD.01.025.113.017.0.2">
<input type=hidden name=d_opsrg022 id=d_opsrg022 value="%OPRWEB06.12.365">
<input type=hidden name=d_opsrg028 id=d_opsrg028 value="%OPRWEB06.12.366">
<input type=hidden name=errcode  value="0">
<input type=hidden name=distimes id=distimes value="0">

<table border="0" cellpadding="0" cellspacing="0" width="100%" align=center>
<tr><td class=HeadingCell align=left>
    <img src=../images/ListIcon.gif class=Icon onclick='SessCaseList();'></td>
    <td align=center class=HeadingCell width=85%>
      Theatre Usage Supervisor
    </td>
    <td align=right class=HeadingCell><font color=red>
     %OPRWEB06.12.208</font></td></tr>

</table>
<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr><td class=DataLabel>Consultant</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB06.12.404.003")'>
    %OPRWEB06.12.404.002 </a></td>
    <td class=DataLabel>Operating Surgeon</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB06.12.311.003")'>
    %OPRWEB06.12.311.002 </a></td>
    <td class=DataField>
    <input type=button value="Change Surgeon" class="button"
     id="chgsrgbutt" onclick="tempDisable(this,2);ChgSurgeon();"></td>
</tr>

<tr><td class=DataLabel>Unit</td>
    <td class="DataField">
       <select name=opses012 title="Unit" class=SelectBig>
        <option></option>
         %OPRWEB06.12.413.2
        </select></td>
    <td class=DataLabel>Theatre</td>
    <td class=DataField>%OPRWEB06.12.302</td>
    <td class=DataField>
       <input type=button value="Change Theatre" class="button" 
        id="chgthebutt" onclick="tempDisable(this,2);ChgOpr();"></td></tr> 

<tr><td class=DataLabel>Date </td>
    <td class=DataField>%OPRWEB06.12.406 %OPRWEB06.12.402</td>
    <td class=DataLabel>Time </td>
    <td class=DataField>%OPRWEB06.12.403</td></tr>
</table>

<hr>

<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr><td class=DataLabel>Procedure&nbsp;</td>
    <td> <input type=text size=116 name=opdea014 maxlength=80 tabindex=1
          title="Procedure Description" value="%OPRWEB06.12.305"></td></tr>
<tr><td class=DataLabel>&nbsp;&nbsp;</td>
    <td> <input type=text size=116 name=opdea015 maxlength=80 tabindex=1
     title="Procedure Description" value="%OPRWEB06.12.343"></td></tr> 
<tr><td class=DataLabel>&nbsp;&nbsp;</td>
    <td> <input type=text size=116 name=opdea016 maxlength=80 tabindex=1
         title="Procedure Description" value="%OPRWEB06.12.344">
    </td></tr>
</table>

<br>
<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr><td width=2%><img src="../images/HelpIcon.gif" class=Icon
     onmouseover='showPopUp(TimeCalledForInfo);'></td>
    <td width=11%>Time Called For</td>
    <td width=11%> 
    <input type=text name=opard039 id=opard039 size=8 maxlength=8
     title="Time Called For" value="%OPRWEB06.12.539" tabindex=2
     onchange="checkTime(this,this.title);ChkDelay();">
    <img src="../images/DateTimeStamp.gif" class=Icon 
     onclick="SetCurrentDateTime(null,opard039);">
    <img src=../images/TimeLookup.gif class=Icon 
     onclick="TimeLookupFrame(opard039);"></td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
</tr>

<tr><td width=2%><img src="../images/HelpIcon.gif" class=Icon
     onmouseover='showPopUp(TimeOfArrivalInfo);'></td>
    <td class=DataLabel width=11%>Time of Arrival</td>
    <td class=DataField width=11%>
    <input type=text name=opard002 id=opard002 size=8 maxlength=8
     title="Time of Arrival" value="%OPRWEB06.12.502" tabindex=3
     onchange="checkTime(this,this.title);
               chkAnaesTime();
               ChkDelay();
               chkArrivalTimeWheelsInTime();">
    <img src="../images/DateTimeStamp.gif" class=Icon 
     onclick="SetCurrentDateTime(null,opard002);">
    <img src=../images/TimeLookup.gif class=Icon 
     onclick="TimeLookupFrame(opard002);"></td>
    <td width=11%><div id="ArrivalLateReasonTitleDIV"></div></td>
    <td width=18%><div id="ArrivalLateReasonFieldDIV"></div></td>
    <td class=DataLabel width=9%>Admitting Nurse</td>
    <td class=DataField width=15%>
      <input type=text name=opard003 title="Admitting Nurse Code" size=6
       class=DataField  maxlength=6 value="%OPRWEB06.12.503.1" tabindex=5
       id=opard003 onchange="validateNurse(opard003,name_opard003);">
      <input type=text name=name_opard003 title="Admitting Nurse" tabindex=-1
       class=ReadOnly readonly size=20 maxlength=30 value="%OPRWEB06.12.503.0"
       id=name_opard003>
      <img src="../images/SearchIcon.gif" class=icon
       onclick="SearchOTNurse(opard003,name_opard003);"></td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
</tr>  

<tr><td width=2%><img src="../images/HelpIcon.gif" class=Icon
     onmouseover='showPopUp(AnaestheticCannulationInfo);'></td>
    <td class=DataLabel>Anaesthetic Cannulation</td>
    <td class=DataField>
      <input type=text name=opard041 id=opard041 size=8 maxlength=8
       title="Anaesthetic Cannulation" value="%OPRWEB06.12.541" tabindex=8
       onchange="checkTime(this,this.title);
                 chkAdmStartTimeEndTimeAneaCannTime();">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,opard041);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opard041);"></td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    <td class=DataLabel width=9%>Start Time</td>
    <td class=DataField width=15%>
      <input type=text name=opard115 id=opard115 size=8 maxlength=8
       title="Admitting Nurse Start Time"
       value="%OPRWEB06.12.599.015" tabindex=6
       onchange="checkTime(this,this.title);
                 chkAdmNurseStartTimePatAdmTime();
                 chkAdmStartTimeEndTimeAneaCannTime();">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,UpdateForm.opard115);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(UpdateForm.opard115);"></td>
    <td class=DataLabel>End Time</td>
    <td class=DataField>
      <input type=text name=opard116 id=opard116 size=8 maxlength=8
       title="Admitting Nurse End Time"
       value="%OPRWEB06.12.599.016" tabindex=7
       onchange="checkTime(this,this.title);
                 chkAdmStartTimeEndTimeAneaCannTime();">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,UpdateForm.opard116);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(UpdateForm.opard116);"></td>
</tr>

<tr><td width=2%><img src="../images/HelpIcon.gif" class=Icon
     onmouseover='showPopUp(AnaestheticTimeOutInfo);'></td>
    <td class=DataLabel>Anaesthetic Time Out</td>
    <td class=DataField><input type=text name=opard061 id=opard061
       size=8 maxlength=8 title="Anaesthetic Time Out" 
       value="%OPRWEB06.12.561" tabindex=9
       onchange="checkTime(this,this.title);ChkDelayAnaes();">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,opard061);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opard061);"></td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
</tr>

<tr><td width=2%><img src="../images/HelpIcon.gif" class=Icon
     onmouseover='showPopUp(AnaestheticAdministrationInfo);'></td>
    <td class=DataLabel>Anaesthetic Administration</td>
    <td class=DataField>
      <input type=text name=opard042 id=opard042 size=8 maxlength=8
       title="Anaesthetic Administration" value="%OPRWEB06.12.542" tabindex=10
       onchange="checkTime(this,this.title);
                 chkSurgStart();
                 chkAnaesTime();
                 ChkDelayAnaes();
                 ChkDelaySurg();">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,opard042);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opard042);"></td>
    <td><div id="AnaestheticDelayReasonTitleDIV"></div></td>
    <td><div id="AnaestheticDelayReasonFieldDIV"></div></td>
    <td class=DataLabel>Anaesthetic</td>
    <td class=DataField>
      <select name=opdea003 title="Anaesthetic" tabindex=12>
        <option></option>
         %OPRWEB06.12.113.2
      </select></td>
    <td class=DataLabel width=8%>%STANDARD.01.035.ok </td>
    <td class=DataField>
      <select name=opard045 title="%STANDARD.01.035.ok " tabindex=13>
        <option></option>
         %OPRWEB06.12.545.2
      </select></td></tr>

<tr><td width=2%><img src="../images/HelpIcon.gif" class=Icon
     onmouseover='showPopUp(WheelsInTimeInfo);'></td>
    <td class=DataLabel>Wheels In</td>
    <td class=DataField><input type=text name=opsrg080 id=opsrg080 size=8
       maxlength=8 title="Wheels In Time" value="%OPRWEB06.12.680"
       tabindex=14
       onchange="checkTime(this,this.title);
                 chkArrivalTimeWheelsInTime();">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,UpdateForm.opsrg080);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(UpdateForm.opsrg080);"></td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
</tr>

<tr><td width=2%><img src="../images/HelpIcon.gif" class=Icon
     onmouseover='showPopUp(SurgicalTimeOutInfo);'></td>
    <td class=DataLabel>Surgical Time Out</td>
    <td class=DataField><input type=text name=opard029 id=opard029 size=8 
       maxlength=8 title="Surgical Time Out" value="%OPRWEB06.12.529" 
       tabindex=15
       onchange="checkTime(this,this.title);">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,opard029);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opard029);"></td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
</tr>

<tr><td width=2%><img src="../images/HelpIcon.gif" class=Icon
     onmouseover='showPopUp(SurgeryStartInfo);'></td>
    <td class=DataLabel>Surgery Start</td>
    <td class=DataField>
      <input type=text name=opsrg005 id=opsrg005 size=8 maxlength=8
       title="Surgery Start Time" value="%OPRWEB06.12.337" tabindex=16
       onchange="checkTime(this,this.title);
                 chkSurgStart();
                 ChkDelaySurg();">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,opsrg005);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opsrg005);"></td>
    <td><div id="SurgeryStartLateReasonTitleDIV"></div></td>
    <td><div id="SurgeryStartLateReasonFieldDIV"></div></td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
</tr>

<tr><td width=2%><img src="../images/HelpIcon.gif" class=Icon
     onmouseover='showPopUp(SurgeryEndInfo);'></td>
    <td class=DataLabel>Surgery End</td>
    <td class=DataField>
      <input type=text name=opsrg006 id=opsrg006 size=8 maxlength=8
       title="Surgery End Time" value="%OPRWEB06.12.338" tabindex=18
       onchange="checkTime(this,this.title);chkSurgEnd();AnaestheticMand();
                 ChkRecoveryInDelay();
                 chkWheelsOutTimeInRecoverySurgeryEnd();">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,opsrg006);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opsrg006);"></td>
    <td></td>
    <td></td>
    <td class=DataLabel>Overnight Indicator</td>
    <td><input type=checkbox name=ovrnight id=ovrnight 
         title="Overninght Indicator"
         value="1" onclick="displayReasonOvernight();valPrepDress();"
         tabindex=19></td>
    <td><div id="ReasonForOvernightTitleDIV"></div></td>
    <td><div id="ReasonForOvernightFieldDIV"></div></td></tr>
</table>

<div id="ReasonForRecoveryDIV"></div>

<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr><td width=2%><img src="../images/HelpIcon.gif" class=Icon
     onmouseover='showPopUp(WheelsOutTimeInfo);'></td>
    <td class=DataLabel width=11%>Wheels Out</td>
    <td class=DataField><input type=text name=opsrg081 id=opsrg081 size=8
       maxlength=8 title="Wheels Out Time" value="%OPRWEB06.12.681"
       tabindex=22
       onchange="checkTime(this,this.title);
                 chkWheelsOutTimeInRecoverySurgeryEnd();">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,UpdateForm.opsrg081);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(UpdateForm.opsrg081);"></td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
</tr>

<tr><td width=2%><img src="../images/HelpIcon.gif" class=Icon
     onmouseover='showPopUp(TimeInRecoveryDayInfo);'></td>
    <td class=DataLabel width=11%>Time in Recovery-Day Procedure</td>
    <td class=DataField width=11%>
      <input type=text name=opard077 id=opard077 size=8 maxlength=8 tabindex=23
       title="Time in Recovery - Day Procedure" value="%OPRWEB06.12.577"
       onchange="checkTime(this,this.title);
                 ProcMan();
                 ChkRecoveryInDelay();
                 chkWheelsOutTimeInRecoverySurgeryEnd();">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,opard077);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(opard077);"></td>
    <td width=11%><div id="RecoveryInDelayReasonTitleDIV"></div></td>
    <td width=18%><div id="RecoveryInDelayReasonFieldDIV"></div></td>
    <td class=DataLabel width=9%>Recovery Nurse 1 Day</td>
    <td class=DataField width=15%>
      <input type=text name=opard078 size=6 value="%OPRWEB06.12.578.1"
       title="RecoveryNurse 1 Day Code" tabindex=25 id=opard078
       onblur="validateNurse(opard078,name_opard078);">
      <input type=text readonly name=name_opard078 class=Readonly size=20
       title="Recovery Nurse 1 Day" tabindex=-1 value="%OPRWEB06.12.578.0"
       id=name_opard078>
      <img src="../images/SearchIcon.gif" class=Icon
       onclick="SearchOTNurse(opard078,name_opard078);"></td>
    <td class=DataLabel width=8%>%STANDARD.01.017.oc</td>
    <td class=DataField colspan=2>
      <select name=opard016 title="%STANDARD.01.017.oc" tabindex=26>
      <option></option>
       %OPRWEB06.12.516.2
      </select></td></tr>

<tr><td width=2%><img src="../images/HelpIcon.gif" class=Icon
     onmouseover='showPopUp(ReadyToDepartInfo);'></td>
    <td class=DataLabel>Ready to Depart Time</td>
    <td class=DataField>
      <input type=text name=opard085 id=opard085 size=8 maxlength=8
       title="Ready to Depart Time" value="%OPRWEB06.12.585" tabindex=27
       onblur="checkTime(this,this.title);ChkRecoveryExitDelay();"
       onchange="checkReadyToDepartExist();">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="setReadyDepartTime(opard085);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opard085,checkReadyToDepartExist);"></td>
    <td></td>
    <td></td>
    <td class=DataLabel>Recovery Nurse 2 Day</td>
    <td class=DataField>
      <input type=text name=opard079 size=6 value="%OPRWEB06.12.579.1"
       title="Recovery Nurse 2 Day Code" id=opard079 tabindex=28
       onblur="validateNurse(opard079,name_opard079);">
      <input type=text readonly name=name_opard079 class=Readonly size=20
       title="Nurse Attend Pat 2" tabindex=-1 value="%OPRWEB06.12.579.0"
       id=name_opard079>
      <img src="../images/SearchIcon.gif" class=Icon
       onclick="SearchOTNurse(opard079,name_opard079);"></td>
    <td class=DataLabel>%STANDARD.01.017.od</td>
    <td class=DataField>
      <select name=opard017 title="%STANDARD.01.017.od" tabindex=29>
      <option></option>
       %OPRWEB06.12.517.2
      </select></td></tr>

<tr><td width=2%>
    <img src="../images/HelpIcon.gif" class=Icon
     onmouseover='showPopUp(ExitTheatreComplexInfo);'></td>
    <td class=DataLabel>Exit Theatre Complex</td>
    <td class=DataField>
      <input type=text name=opard080 id=opard080 size=8 maxlength=8 tabindex=30
       title="Exit Theatre Complex Time" value="%OPRWEB06.12.580"
       onchange="checkTime(this,this.title);chkTime(this);
                 ChkRecoveryExitDelay();ChkReg();">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,opard080);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(opard080);"></td>
  <td><div id="RecoveryExitDelayReasonTitleDIV"></div></td>
  <td><div id="RecoveryExitDelayReasonFieldDIV"></div></td>
  <td></td>
  <td></td>
  <td>Fast Post Recovery</td>
  <td><input type=hidden name=opsrg072 value=" ">
      <input type=checkbox name=d_opsrg072 value="1" tabindex=32></td></tr>

<tr><td width=2%><img src="../images/HelpIcon.gif" class=Icon
     onmouseover='showPopUp(TimeToICUInfo);'></td>
    <td class=DataLabel>Time to ICU</td>
    <td class=DataField>
      <input type=text name=opard083 id=opard083 size=8 maxlength=8
       title="Time to ICU" value="%OPRWEB06.12.583" tabindex=33
       onchange="checkTime(this,this.title);chkTime(this);setETTime(this);
                 setRTDTime(this);checkTimeToICUExist();">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="setReadyDepartTimeICU(opard083);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(opard083);checkTimeToICUExist();"></td>
    <td></td>
    <td></td>
    <td class="DataLabel">Blood Loss (mml)</td>
    <td><input type=text size=6 name=opard034 maxlength=6 
         min=0 max=999999 tabindex=34
         class="Number" title="Blood Loss (mml)" value="%OPRWEB06.12.534"></td>
    <td>Admit Post Procedure</td>
    <td><input type=hidden name=opsrg073 value=" ">
        <input type=checkbox name=d_opsrg073 value="1" tabindex=35></td></tr>

<tr><td width=2%><img src="../images/HelpIcon.gif" class=Icon
     onmouseover='showPopUp(TimePatientDiedInfo);'></td>
    <td class=DataLabel>Time Patient Died</td>
    <td class=DataField>
      <input type=text name=opard082 id=opard082 size=8 maxlength=8
       title="Time Patient Died" value="%OPRWEB06.12.582" tabindex=36
       onchange="checkTime(this,this.title);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(opard082);"></td>
    <td></td>
    <td></td>
    <td class=DataLabel>Birth in Theatre</td>
    <td class=DataField><input type=checkbox name=theabrth tabindex=37
        title="Birth in Theatre"></td>
    <td>No Recovery</td>
    <td><input type=hidden name=opsrg076 value=" ">
        <input type=checkbox name=d_opsrg076 value="1" tabindex=38></td></tr>

</table>

<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr valign=top><td class=DataLabel width=13%>Comments</td>
    <td class=DataField tabindex=40 rowspan=3 width=40%>
        <div id=CommentText></div></td>
    <td class=DataLabel width=9%>MBS Items</td>
    <td width=15%><input type=text size=15 class=Readonly readonly name=mbsitem
         tabindex=-1 value="%OPRWEB06.12.202"></td> 
    <td><input class="button" type=button name="itembutton" value="Add Items"
         id="itembutton"
         tabindex=41 onclick="tempDisable(this);AddItem();"></td></tr>

<tr><td></td>
    <td class=DataLabel>Implant Items</td>
    <td><input type=text size=15 readonly tabindex=-1 class=Readonly
         value="%OPRWEB06.12.204"></td>
    <td><input class="button" type=button value="Staff Members"
         name="staffbutton" tabindex=42 id="staffbutton"
         onclick="tempDisable(this);goToStaff();"></td></tr>

<tr><td></td>
    <td class=DataLabel>Expensive Items</td>
    <td><input type=text size=15 readonly tabindex=-1 class=Readonly
         value="%OPRWEB06.12.206"></td>
    <td><input class="button" type=button value="Add Implant"
         name="Implantbutton" tabindex=43 id="Implantbutton"
         onclick="tempDisable(this);goToImplant();"></td></tr>

<tr><td class=DataLabel>Case Abandoned</td>
    <td><input type=checkbox name=d_opsrg074 title="Case Abandoned" 
         value="1" tabindex=44></td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
</tr>
</table>

<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr><td width=26%><div id=Print1></div></td><td width=12%></td>
    <td width=15%></td><td width=9%></td></tr>

<tr><td><div id=Print3></div></td>
    <td class="DataLabel">%STANDARD.01.035.Ti </td>
    <td ><select name=opsrg053 class=SelectMed title="%STANDARD.01.035.Ti "
          tabindex=52>
            <option></option>
            %OPRWEB06.12.653.2
            </select> </td>
    <td class="DataLabel">
    <script type="text/javascript">document.write(SiteIntact1);</script></td>
    <td ><select name=opsrg022 id=opsrg022 class=SelectMed tabindex=53>
            <option></option>
            <option value="0">Not Applicable</option>
            <option value="1">No</option>
            <option value="2">Yes</option>
            </select></td>
    <td class="DataLabel">
    <script type="text/javascript">document.write(EqItemUsed1);</script></td>
    <td><input type=text name=opsrg020 id=opsrg020 size=16
        maxlength=15 value="%OPRWEB06.12.620.1" tabindex=54
        onchange="GetItemDesc(this,errcode);" onblur="chkErr(this);"   >
        <input type=text readonly name=name_opsrg020 id=name_opsrg020
         class="Readonly" title="Number" size=25 value="%OPRWEB06.12.620.0" 
         tabindex=-1>
        <img src="../images/SearchIcon.gif" class=Icon
        onclick="ItemSearchFrame(opsrg020,name_opsrg020,1);"></td></tr>

<tr><td><div id=Print2></div></td>
    <td class="DataLabel">%STANDARD.01.035.Ti </td>
    <td ><select name=opsrg054 class=SelectMed title="%STANDARD.01.035.Ti "
          tabindex=61>
            <option></option>
            %OPRWEB06.12.654.2
            </select> </td>
    <td class="DataLabel">
    <script type="text/javascript">document.write(SiteIntact2);</script></td>
    <td ><select name=opsrg028 id=opsrg028 class=SelectMed tabindex=62>
            <option></option>
            <option value="0">Not Applicable</option>
            <option value="1">No</option>
            <option value="2">Yes</option>
            </select></td>
    <td class="DataLabel">
    <script type="text/javascript">document.write(EqItemUsed2);</script></td>
    <td><input type=text name=opsrg026 id=opsrg026 size=16
        maxlength=15 value="%OPRWEB06.12.626.1" tabindex=63
        onchange="GetItemDesc(this,errcode);" onblur="chkErr(this);"   >
        <input type=text readonly name=name_opsrg026 id=name_opsrg026
         class="Readonly" title="Number" size=25 value="%OPRWEB06.12.626.0" 
         tabindex=-1>
        <img src="../images/SearchIcon.gif"  class=Icon
        onclick="ItemSearchFrame(opsrg026,name_opsrg026,1);"></td></tr>

<tr><td><div id=Print4></div></td></tr>

</table>

<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr><td colspan=2 align=center><br>
    <input type=button value=Update class="button" tabindex=70 id="opr06sub"
     onclick="tempDisable(this);
              CheckDefaultTeamCompleted();
              ChkBirth();
              if(chkTimesBeforeUpdate()) {
                UpdateDayProc();}">
    <input type=button value=Cancel class="button" tabindex=71
     onclick="RefreshPage();">
</td></tr>
</table>
</form>
</div>

<form  name=PatientLinks method=get>
<input type=hidden name=reportno value=12>
<input type=hidden name=template value=008>
<input type=hidden name=urnumber value='%OPRWEB06.12.003'>
<input type=hidden name=admissno value='%OPRWEB06.12.081'>
<input type=hidden name=MenuType value='%OPRWEB06.12.088'>
<input type=hidden name=casekeys value='%OPRWEB06.12.101'>
<input type=hidden name=sesskeys value='%OPRWEB06.12.102.oprweb01.03.003'>
<input type=hidden name=uniqueky value='%OPRWEB06.12.110'>
<input type=hidden name=teamnumb value='%OPRWEB06.12.334'>
</form>
<span id=ThtrCom style="display:none">
  <textarea wrap=hard cols=70 rows=3 name=opcom008> 
%OPRWEB06.12.143.008
  </textarea>
</span>

<span id=BookCom style="display:none">
  <textarea wrap=hard cols=70 rows=3 name=opcom008> 
%OPRWEB06.12.143.009
  </textarea>
</span>

<span id=ProsCompDesc style="display:none">
    Prosthetic Input Complete
</span>

<span id=ProsCompField style="display:none">
    <select name=d_opdea043 title="Prosthetic Input Complete">
     <option></option>
     <option value="0">No</option>
     <option value="1">Yes</option>
     <option value="2">N/A</option>
     </select>
</span>
<span id=Blank style="display:none">
  <input type=hidden name=opdea043 value="0">
</span>

<script type="text/javascript">
if ("%OPRWEB06.12.671" == "Yes") {
  document.UpdateForm.ovrnight.checked=1;
}
if ("%OPRWEB06.12.350" == "1") {
  document.UpdateForm.theabrth.checked=1;
  document.UpdateForm.theabrth.readOnly=true;
  document.UpdateForm.theabrth.disabled=true;
}
// Default MBS Item from Booking
if (isWhitespace(document.UpdateForm.mbsitem.value))
  document.UpdateForm.mbsitem.value="%OPRWEB06.12.345";

// Default Comment from Booking
if (%OPRWEB06.12.211 == 0)                       // First display of this page?
  CommentText.innerHTML = BookCom.innerHTML;     // Yes, default from booking
else
  CommentText.innerHTML = ThtrCom.innerHTML;     // No, use Day Proc comments

function SetAbandonCaseFlag() { 
  if("%OPRWEB06.12.674" == "Yes") {
    document.UpdateForm.d_opsrg074.checked = true;
  }
}

function ChkDelay() {
if(isWhitespace(document.UpdateForm.opard039.value) || 
   (parseInt(document.UpdateForm.mindelay.value)=="0") ||
   isWhitespace(document.UpdateForm.opard002.value)) {
   ArrivalLateReasonTitleDIV.innerHTML="";
   ArrivalLateReasonFieldDIV.innerHTML=NoArrivalLateReasonFieldSPAN.innerHTML;
 return;
}

var TimeCald=trim(document.UpdateForm.opard039.value.replace(/:/g,""))
var ArrvTime=trim(document.UpdateForm.opard002.value.replace(/:/g,""))
TimeCald=TimeCald.substr(0,4)
ArrvTime=ArrvTime.substr(0,4)
TimeCald=TimeCald - 0;
ArrvTime=ArrvTime - 0;
if(TimeCald>ArrvTime) {
  if (confirm("Time Called for cannot be after the Arrival Time." +
     "\n Do you want to override?")) {

      ArrvTime = ArrvTime + 2400;

  } else {
    document.UpdateForm.opard002.value="";
    return;
  }
}
var MaxDelay=(parseInt(TimeCald) + parseInt(document.UpdateForm.mindelay.value))
var Minutes=parseInt(MaxDelay) % 100
var Hour=parseInt(MaxDelay) / 100
if (Minutes>=60) {
   Minutes=Minutes - 60
   Hour=parseInt(Hour) + 1
   MaxDelay = (Hour*100) + Minutes
}
if (MaxDelay <= ArrvTime) {
   ArrivalLateReasonTitleDIV.innerHTML=ArrivalLateReasonTitleSPAN.innerHTML;
   ArrivalLateReasonFieldDIV.innerHTML=ArrivalLateReasonFieldSPAN.innerHTML;
   }
   else {
   ArrivalLateReasonTitleDIV.innerHTML="";
   ArrivalLateReasonFieldDIV.innerHTML=NoArrivalLateReasonFieldSPAN.innerHTML; 
   }
}

function ChkDelayAnaes() {
if(isWhitespace(document.UpdateForm.opard061.value) ||
   isWhitespace(document.UpdateForm.opard042.value)) {
   AnaestheticDelayReasonTitleDIV.innerHTML="";
   AnaestheticDelayReasonFieldDIV.innerHTML=NoAnaestheticDelayReasonFieldSPAN.innerHTML;
 return;
}

var TimeOut=trim(document.UpdateForm.opard061.value.replace(/:/g,""))
var AnaeAdm=trim(document.UpdateForm.opard042.value.replace(/:/g,""))
TimeOut=TimeOut.substr(0,4)
AnaeAdm=AnaeAdm.substr(0,4)
TimeOut=TimeOut - 0;
AnaeAdm=AnaeAdm - 0;
if(TimeOut>AnaeAdm) {
  if (confirm("Anaesthetic Time Out cannot be after Anaesthetic Administration." +
     "\n Do you want to override?")) {

      AnaeAdm = AnaeAdm + 2400;

  } else {
    document.UpdateForm.opard042.value="";
    return;
  }
}
if ((parseInt(document.UpdateForm.opcntopa.value)) != 0) {
var MaxDelay=(parseInt(TimeOut) + parseInt(document.UpdateForm.opcntopa.value))
var Minutes=parseInt(MaxDelay) % 100
var Hour=parseInt(MaxDelay) / 100
if (Minutes>=60) {
   Minutes=Minutes - 60
   Hour=parseInt(Hour) + 1
   MaxDelay = (Hour*100) + Minutes
}
if (MaxDelay <= AnaeAdm) {
   AnaestheticDelayReasonTitleDIV.innerHTML=
   AnaestheticDelayReasonTitleSPAN.innerHTML;
   AnaestheticDelayReasonFieldDIV.innerHTML=
   AnaestheticDelayReasonFieldSPAN.innerHTML;
   }
   else {
   AnaestheticDelayReasonTitleDIV.innerHTML="";
   AnaestheticDelayReasonFieldDIV.innerHTML=NoAnaestheticDelayReasonFieldSPAN.innerHTML;
   }
}
}
function ChkDelaySurg() {
if(isWhitespace(document.UpdateForm.opard042.value) ||
   isWhitespace(document.UpdateForm.opsrg005.value)) {
   SurgeryStartLateReasonTitleDIV.innerHTML="";
   SurgeryStartLateReasonFieldDIV.innerHTML=NoSurgeryStartLateReasonFieldSPAN.innerHTML;
 return;
}

var AnaeAdm=trim(document.UpdateForm.opard042.value.replace(/:/g,""))
var SurgStr=trim(document.UpdateForm.opsrg005.value.replace(/:/g,""))
AnaeAdm=AnaeAdm.substr(0,4)
SurgStr=SurgStr.substr(0,4)
AnaeAdm=AnaeAdm - 0;
SurgStr=SurgStr - 0;
if(AnaeAdm>SurgStr) {
  if (confirm("Anaesthetic Administration cannot be after Surgery Start." +
     "\n Do you want to override?")) {

      SurgStr = SurgStr + 2400;

  } else {
    document.UpdateForm.opsrg005.value="";
    return;
  }
}
if ((parseInt(document.UpdateForm.opcnacss.value)) != 0) {
var MaxDelay=(parseInt(AnaeAdm) + parseInt(document.UpdateForm.opcnacss.value))
var Minutes=parseInt(MaxDelay) % 100
var Hour=parseInt(MaxDelay) / 100
if (Minutes>=60) {
   Minutes=Minutes - 60
   Hour=parseInt(Hour) + 1
   MaxDelay = (Hour*100) + Minutes
}
if (MaxDelay <= SurgStr) {
   SurgeryStartLateReasonTitleDIV.innerHTML=
   SurgeryStartLateReasonTitleSPAN.innerHTML;
   SurgeryStartLateReasonFieldDIV.innerHTML=
   SurgeryStartLateReasonFieldSPAN.innerHTML;
   }
   else {
   SurgeryStartLateReasonTitleDIV.innerHTML="";
   SurgeryStartLateReasonFieldDIV.innerHTML=NoSurgeryStartLateReasonFieldSPAN.innerHTML;
   }
}
}
function checkReadyForRec(RFRfield) {

  if (isWhitespace(RFRfield.value)) { return; }
  if (!checkTime(RFRfield,RFRfield.title)) { return; }

  if (!isWhitespace(document.UpdateForm.opsrg006.value)) {
    if (RFRfield.value < document.UpdateForm.opsrg006.value) { 
      alert("Ready for Recovery cannot be before Surgery End.");
      RFRfield.value = "";
      RFRfield.focus();
      return;
    }
  }

  if (!isWhitespace(document.UpdateForm.opard077.value)) {
    if (RFRfield.value > document.UpdateForm.opard077.value) {
      alert("Ready for Recovery cannot be after Time in Recovery - Day Procedure");
      RFRfield.value = "";
      RFRfield.focus();
      return;
    }
  }

}

function ChkRecoveryInDelay() {
if(isWhitespace(document.UpdateForm.opsrg006.value) ||
   isWhitespace(document.UpdateForm.opard077.value)) {
   RecoveryInDelayReasonTitleDIV.innerHTML="";
   RecoveryInDelayReasonFieldDIV.innerHTML=NoRecoveryInDelayReasonFieldSPAN.innerHTML;
 return;
}

var SurgEnd=trim(document.UpdateForm.opsrg006.value.replace(/:/g,""))
var TimInRc=trim(document.UpdateForm.opard077.value.replace(/:/g,""))
SurgEnd=SurgEnd.substr(0,4)
TimInRc=TimInRc.substr(0,4)
SurgEnd=SurgEnd - 0;
TimInRc=TimInRc - 0;
if(SurgEnd>TimInRc && (UpdateForm.ovrnight.checked != true)) {
  if (confirm("Surgery End cannot be after Time In Recovery - Day Procedure." +
     "\n Do you want to override?")) {
      TimInRc = TimInRc + 2400;
      UpdateForm.ovrnight.checked = true;
  } else {
    document.UpdateForm.opard077.value="";
    return;
  }
}
if ((parseInt(document.UpdateForm.opcnsetr.value)) != 0) {
var MaxDelay=(parseInt(SurgEnd) + parseInt(document.UpdateForm.opcnsetr.value))
var Minutes=parseInt(MaxDelay) % 100
var Hour=parseInt(MaxDelay) / 100
if (Minutes>=60) {
   Minutes=Minutes - 60
   Hour=parseInt(Hour) + 1
   MaxDelay = (Hour*100) + Minutes
}
if (MaxDelay <= TimInRc) {
   RecoveryInDelayReasonTitleDIV.innerHTML=
   RecoveryInDelayReasonTitleSPAN.innerHTML;
   RecoveryInDelayReasonFieldDIV.innerHTML=
   RecoveryInDelayReasonFieldSPAN.innerHTML;
   }
   else {
   RecoveryInDelayReasonTitleDIV.innerHTML="";
   RecoveryInDelayReasonFieldDIV.innerHTML=NoRecoveryInDelayReasonFieldSPAN.innerHTML;
   }
}
}

function ChkRecoveryExitDelay() {
if(isWhitespace(document.UpdateForm.opard085.value) ||
   (parseInt(document.UpdateForm.opcnvrrd.value)=="0") ||
   isWhitespace(document.UpdateForm.opard080.value)) {
   RecoveryExitDelayReasonTitleDIV.innerHTML="";
   RecoveryExitDelayReasonFieldDIV.innerHTML=NoRecoveryExitDelayReasonFieldSPAN.innerHTML;
 return;
}

var ReadDep=trim(document.UpdateForm.opard085.value.replace(/:/g,""))
var ExitTht=trim(document.UpdateForm.opard080.value.replace(/:/g,""))
ReadDep=ReadDep.substr(0,4)
ExitTht=ExitTht.substr(0,4)
ReadDep=ReadDep - 0;
ExitTht=ExitTht - 0;
if(ReadDep>ExitTht) {
  if (confirm("Ready To Depart cannot be after Exit Theatre Complex." +
     "\n Do you want to override?")) {

      ExitTht = ExitTht + 2400;

  } else {
    document.UpdateForm.opard080.value="";
    return;
  }
}
var MaxDelay=(parseInt(ReadDep) + parseInt(document.UpdateForm.opcnvrrd.value))
var Minutes=parseInt(MaxDelay) % 100
var Hour=parseInt(MaxDelay) / 100
if (Minutes>=60) {
   Minutes=Minutes - 60
   Hour=parseInt(Hour) + 1
   MaxDelay = (Hour*100) + Minutes
}
if (MaxDelay <= ExitTht) {
   RecoveryExitDelayReasonTitleDIV.innerHTML=
   RecoveryExitDelayReasonTitleSPAN.innerHTML;
   RecoveryExitDelayReasonFieldDIV.innerHTML=
   RecoveryExitDelayReasonFieldSPAN.innerHTML;
   }
   else {
   RecoveryExitDelayReasonTitleDIV.innerHTML="";
   RecoveryExitDelayReasonFieldDIV.innerHTML=NoRecoveryExitDelayReasonFieldSPAN.innerHTML;
   }
}

if ("%OPRWEB06.12.672" == "Yes") {
  document.UpdateForm.d_opsrg072.checked="true";
}

if ("%OPRWEB06.12.673" == "Yes") {
  document.UpdateForm.d_opsrg073.checked="true";
}

if ("%OPRWEB06.12.676" == "Yes") {
  document.UpdateForm.d_opsrg076.checked="true";
}

function ChkReg() {
  if(isWhitespace(document.UpdateForm.opard080.value)) {
    Print1.innerHTML="";
    Print1.style.display="none";
    Print2.innerHTML="";
    Print2.style.display="none";
    Print3.innerHTML="";
    Print3.style.display="none";
    Print4.innerHTML="";
    Print4.style.display="none";
  } else {
     Print1.style.display="";
     Print1.innerHTML=ShowPrint1.innerHTML;
     Print2.style.display="";
     Print2.innerHTML=ShowPrint2.innerHTML;
     Print3.style.display="";
     Print3.innerHTML=ShowPrint3.innerHTML;
     Print4.style.display="";
     Print4.innerHTML=ShowPrint4.innerHTML;

    DefForm3Code="%STANDARD.01.033.THETFORM.03";
    for(i=0; i<document.UpdateForm.statncod.length; i++){
      if(document.UpdateForm.statncod.options[i].value.replace(/ /g,"")==
         DefForm3Code.replace(/ /g,"")){
        document.UpdateForm.statncod.selectedIndex = i;
      }
    }

    DefForm3Copies="%STANDARD.01.034.THETFORM.03";
    for(i=0; i<document.UpdateForm.schdcopy.length; i++){
      if(document.UpdateForm.schdcopy.options[i].value.replace(/ /g,"")==
         DefForm3Copies.replace(/ /g,"")){
        document.UpdateForm.schdcopy.selectedIndex = i;
      }
    }

  }

}

function SetSelectSizeBig(SelectList) {
  if (SelectList.className=="SelectBig") {
    SelectList.className="SelectBig"
  } else {
    SelectList.className="SelectBig"
  }
}
function SetSelectSizeSml(SelectList) {
  if (SelectList.className=="SelectSml") {
    SelectList.className="SelectSml"
  } else {
    SelectList.className="SelectSml"
  }
}

for (x=0; x<document.getElementById("opsrg022").length; x++) {
  if (document.getElementById("d_opsrg022").value ==
      document.getElementById("opsrg022")[x].value) {
    document.getElementById("opsrg022").selectedIndex=x;
  }
}

for (x=0; x<document.getElementById("opsrg028").length; x++) {
  if (document.getElementById("d_opsrg028").value ==
      document.getElementById("opsrg028")[x].value) {
    document.getElementById("opsrg028").selectedIndex=x;
  }
}



  function chkErr(fieldCode) {
    errCode = UpdateForm.errcode.value;
    if (errCode == "1") {
      UpdateForm.errcode.value = "0";
      fieldCode.select();
    }
  }

</script>

<span id="ArrivalLateReasonTitleSPAN" style="display:none;">
%STANDARD.01.035.Os
</span>

<span id="ArrivalLateReasonFieldSPAN" style="display:none;">
    <select name=opard004 id="opard004" title="%STANDARD.01.035.Os "
     tabindex=4>
     <option></option>
     %OPRWEB06.12.504.2
    </select>
</span>

<span id="NoArrivalLateReasonFieldSPAN" style="display:none;">
<input type="hidden" name="opard004" value=" ">
</span>

<span id="AnaestheticDelayReasonTitleSPAN" style="display:none;">
%STANDARD.01.035.ol
</span>

<span id="AnaestheticDelayReasonFieldSPAN" style="display:none;">
    <select name=opard046 id="opard046" title="%STANDARD.01.035.ol "
     tabindex=11>
     <option></option>
     %OPRWEB06.12.546.2
    </select>
</span>

<span id="NoAnaestheticDelayReasonFieldSPAN" style="display:none;">
<input type="hidden" name="opard046" value=" ">
</span>

<span id="SurgeryStartLateReasonTitleSPAN" style="display:none;">
%STANDARD.01.035.TV
</span>

<span id="SurgeryStartLateReasonFieldSPAN" style="display:none;">
    <select name=opsrg007 id="opsrg007" title="%STANDARD.01.035.TV "
     tabindex=17>
     <option></option>
    %OPRWEB06.12.339.2
    </select>
</span>

<span id="NoSurgeryStartLateReasonFieldSPAN" style="display:none;">
<input type="hidden" name="opsrg007" value=" ">
</span>

<span id="ReasonForOvernightTitleSPAN" style="display:none;">
Reason for Overnight
</span>

<span id="ReasonForOvernightFieldSPAN" style="display:none;">
      <select name=opard086 title="Reason for Overnight" tabindex=20>
        <option></option>
         %OPRWEB06.12.586.2
      </select>
</span>

<span id="NoReasonForOvernightFieldSPAN" style="display:none;">
<input type="hidden" name="opard086" value=" ">
</span>

<span id="ReasonForRecoverySPAN1" style="display:none">
<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr><td width=2%><img src="../images/HelpIcon.gif" class=Icon
     onmouseover='showPopUp(ReadyForRecoveryInfo);'></td>
  <td width=11%>Ready for Recovery</td>
  <td><input type=text name=opard060 size=8 maxlength=8
     title="Ready for Recovery" value="%OPRWEB06.12.560" tabindex=21
     onchange="checkReadyForRec(this);">
    <img src="../images/DateTimeStamp.gif" class=Icon 
     onclick="SetCurrentDateTime(null,opard060);">
    <img src=../images/TimeLookup.gif class=Icon 
     onclick="TimeLookupFrame(opard060);"></td></tr>
</table>
</span>

<span id="ReasonForRecoverySPAN2" style="display:none">
<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr><td width=2%></td>
    <td>"opard061 already in use. Select another field (PACU parameter)."
       <input type="hidden" name="opard061" value=" "></td></tr>
</table>
</span>

<span id="ReasonForRecoverySPAN3" style="display:none">
<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr><td width=2%><img src="../images/HelpIcon.gif" class=Icon
     onmouseover='showPopUp(ReadyForRecoveryInfo);'></td>
  <td width=11%>Ready for Recovery</td>
  <td><input type=text name=opard062 id=opard062 size=8 maxlength=8
     title="Ready for Recovery" value="%OPRWEB06.12.562" tabindex=21
     onchange="checkReadyForRec(this);">
    <img src="../images/DateTimeStamp.gif" class=Icon 
     onclick="SetCurrentDateTime(null,opard062);">
    <img src=../images/TimeLookup.gif class=Icon 
     onclick="TimeLookupFrame(opard062);"></td></tr>
</table>
</span>

<span id="ReasonForRecoverySPAN4" style="display:none">
<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr><td width=2%><img src="../images/HelpIcon.gif" class=Icon
     onmouseover='showPopUp(ReadyForRecoveryInfo);'></td>
  <td width=11%>Ready for Recovery</td>
  <td><input type=text name=opard063 id=opard063 size=8 maxlength=8
     title="Ready for Recovery" value="%OPRWEB06.12.563" tabindex=21
     onchange="checkReadyForRec(this);">
    <img src="../images/DateTimeStamp.gif" class=Icon 
     onclick="SetCurrentDateTime(null,opard063);">
    <img src=../images/TimeLookup.gif class=Icon 
     onclick="TimeLookupFrame(opard063);"></td></tr>
</table>
</span>

<span id="ReasonForRecoverySPAN5" style="display:none">
<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr><td width=2%><img src="../images/HelpIcon.gif" class=Icon
     onmouseover='showPopUp(ReadyForRecoveryInfo);'></td>
  <td width=11%>Ready for Recovery</td>
  <td><input type=text name=opard064 id=opard064 size=8 maxlength=8
     title="Ready for Recovery" value="%OPRWEB06.12.564" tabindex=21
     onchange="checkReadyForRec(this);">
    <img src="../images/DateTimeStamp.gif" class=Icon 
     onclick="SetCurrentDateTime(null,opard064);">
    <img src=../images/TimeLookup.gif class=Icon 
     onclick="TimeLookupFrame(opard064);"></td></tr>
</table>
</span>

<span id="RecoveryInDelayReasonTitleSPAN" style="display:none;">
%STANDARD.01.035.Ou
</span>

<span id="RecoveryInDelayReasonFieldSPAN" style="display:none;">
  <select name=opard084 title="Recovery In Delay Reason" 
   tabindex=24>
   <option></option>
    %OPRWEB06.12.584.2
  </select>
</span>

<span id="NoRecoveryInDelayReasonFieldSPAN" style="display:none;">
<input type="hidden" name="opard084" value=" ">
</span>

<span id="RecoveryExitDelayReasonTitleSPAN" style="display:none;">
%STANDARD.01.035.Tk
</span>

<span id="RecoveryExitDelayReasonFieldSPAN" style="display:none;">
    <select name=opsrg055 title="%STANDARD.01.017.Tk" tabindex=31>
        <option></option>
         %OPRWEB06.12.655.2
      </select>
</span>

<span id="NoRecoveryExitDelayReasonFieldSPAN" style="display:none;">
<input type="hidden" name="opsrg055" value=" ">
</span>

<div id="adverseEventDiv" name="adverseEventDiv"
     style="background-color:white;position:absolute;width:600px;height:100px;top:100px;right:10%;
            border:3px outset grey;display:none">
 <table width="100%" cellpadding="0" cellspacing="0">
   <tr class="DFrameTitleBar"><td colspan="2">Recovery Event</td></tr>
   <tr><td>&nbsp;</td></tr>
   <tr align="center" width="100%">
      <td width="60%">
         <span id="adverseText"><b>Did an adverse event occur?</b></span>
       </td>
       <td>
         <select id="adverseDropDown" name="adverseDropDown" >
           <option value="No">No</option>
           <option value="Yes">Yes</option>
         </select>
       </td>
   </tr>
   <tr></tr>
 </table>
 <br />
 <table width="100%">
   <tr width="100%" align="center">
     <td><input type="button" value="Ok" class="button"
         onclick="checkAdverseResponse();"/></td>
   </tr>
 </table>
</div>

<div id="ShowPrint1" style="display:none;">
<table border=0 cellpadding=0 cellspacing=0 width="100%" align=center >
<tr><td class=DataLabel width=50%>IntraOperative Report</td>
    <td class=DataField><input type=checkbox name=schdprin value="1"
        tabindex=50
        onclick="SetSelectSizeBig(UpdateForm.schdprnt);
                 SetSelectSizeBig(UpdateForm.statncod);
                 SetSelectSizeSml(UpdateForm.schdcopy);"></td></tr>
</table>
</div>

<div id="ShowPrint2" style="display:none;">
<table border=0 cellpadding=0 cellspacing=0 width="100%" align=center >
<tr><td class=DataLabel width=50%>Printer</td>
    <td><input type=hidden name=setdefpn value="THETFORM03">
        <select name=schdprnt title="Printer" class="SelectBig"
         tabindex=60>
        <option></option>
        %STANDARD.01.001.THETFORM.03
        </select></td></tr>
</table>
</div>

<div id="ShowPrint3" style="display:none;">
<table border=0 cellpadding=0 cellspacing=0 width="100%" align=center >
<tr><td class=DataLabel width=50%>Stationery Code</td>
    <td><select name=statncod colspan=2 class="SelectBig"
         title="Stationery Code" tabindex=51>
         <option></option>
         %STANDARD.01.020. 18
        </select></td></tr>
</table>
</div>

<div id="ShowPrint4" style="display:none;">
<table border=0 cellpadding=0 cellspacing=0 width="100%" align=center >
<tr><td class=DataLabel width=50%>Number of Copies</td>
    <td><select name=schdcopy class="SelectSml" title="Number of Copies"
         tabindex=64>
        <option value=" 1">1</option>
        <option value=" 2">2</option>
        <option value=" 3">3</option>
        <option value=" 4">4</option>
        <option value=" 5">5</option>
        <option value=" 6">6</option>
        <option value=" 7">7</option>
        <option value=" 8">8</option>
        <option value=" 9">9</option>
        <option value=" 10">10</option>
        </select></td></tr>
</table>
</div>
