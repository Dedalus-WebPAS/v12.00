<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="CrossBrowser" content="true">
<meta name="HelpFileName"    content="NoContextSet.html">
<script language=javascript src="../js/ReportStandard.js"></script>
<script language=javascript>
function PatientSearch() {
  PatientSearchFrame(ReportForm.dummyadm,
                     ReportForm.eystr03,
                     ReportForm.dummyadm);
}
function PatientReturn() {
  validateCode(8,
               ReportForm.eystr03,
               ReportForm.gname,
               ReportForm.selsex,
               ReportForm.dummydb);
}
function ProcessReport() {
 SubmitPage=true
     var keyoption=ReportForm.keystr01.value;
     hosid=(document.ReportForm.ibcnmhos.value);
     switch(keyoption) {
     case "1" :
       ReportForm.keystr02.value=ReportForm.eystr02.value
       ReportForm.keystr03.value=ReportForm.userid.value;
       break;
     case "2" :
       ReportForm.keystr02.value=ReportForm.eystr26.value
       ReportForm.keystr03.value=ReportForm.userid.value;
       break;
     case "3" :
       ReportForm.keystr02.value=ReportForm.eystr03.value
       ReportForm.keystr04.value=ReportForm.userid.value;
       ReportForm.keystr03.value=ReportForm.eystr17.value
       break;
     case "4" :
       if (!CheckDateRange(ReportForm.eystr04,ReportForm.eystr05)) {
         ReportForm.eystr04.focus();
         return;
       }
       if (!CheckRange(ReportForm.eystr06,ReportForm.eystr07)) {
         ReportForm.eystr06.focus();
         return;
       }
       ReportForm.keystr02.title="From Date"
       ReportForm.keystr03.title="To Date"
       ReportForm.keystr02.value=ReportForm.eystr04.value
       ReportForm.keystr03.value=ReportForm.eystr05.value
       ReportForm.keystr04.value=ReportForm.eystr06.value
       ReportForm.keystr05.value=ReportForm.eystr07.value
       if (hosid==1) {
         ReportForm.keystr06.value=ReportForm.eystr08.value 
         ReportForm.keystr07.value=ReportForm.userid.value;
         ReportForm.keystr08.value=ReportForm.eystr09.value
         ReportForm.keystr09.value=ReportForm.eystr10.value
         ReportForm.keystr10.value=ReportForm.eystr16.value
       } else {
         ReportForm.keystr06.value=ReportForm.userid.value;
         ReportForm.keystr07.value=ReportForm.eystr09.value
         ReportForm.keystr08.value=ReportForm.eystr10.value
         ReportForm.keystr09.value=ReportForm.eystr16.value
       }
       break;
     case "5" :
       if (!CheckRange(ReportForm.eystr11,ReportForm.eystr12)) {
         ReportForm.eystr11.focus();
         return;
       }
       ReportForm.keystr02.value=ReportForm.eystr10.value
       ReportForm.keystr03.value=ReportForm.eystr11.value
       ReportForm.keystr04.value=ReportForm.eystr12.value
       if (hosid==1) {
         ReportForm.keystr05.value=ReportForm.eystr13.value 
         ReportForm.keystr06.value=ReportForm.userid.value;
         ReportForm.keystr07.value=ReportForm.eystr14.value
         ReportForm.keystr08.value=ReportForm.eystr15.value
         ReportForm.keystr09.value=ReportForm.eystr16.value;
         ReportForm.keystr10.value=ReportForm.eystr17.value
       } else {
         ReportForm.keystr05.value=ReportForm.userid.value;
         ReportForm.keystr67.value=ReportForm.eystr14.value
         ReportForm.keystr07.value=ReportForm.eystr15.value
         ReportForm.keystr08.value=ReportForm.eystr16.value;
         ReportForm.keystr09.value=ReportForm.eystr17.value
       }
       break;
     case "6" :
       if (ReportForm.schdrdat.value=="") {

//       if (!CheckRange(ReportForm.eystr06,ReportForm.eystr07)) {
//         ReportForm.eystr06.focus();
//         return;
//       }
         ReportForm.keystr02.title="From Date"
         ReportForm.keystr03.title="To Date"
         ReportForm.keystr02.value=ReportForm.datran01.value
         ReportForm.keystr03.value=ReportForm.datran02.value
//         ReportForm.keystr02.value=ReportForm.eystr04.value
//         ReportForm.keystr03.value=ReportForm.eystr05.value
         if (hosid==1) {
           ReportForm.keystr04.value=ReportForm.eystr08.value 
           ReportForm.keystr05.value=ReportForm.userid.value
           ReportForm.keystr06.value=ReportForm.eystr09.value
           ReportForm.keystr07.value=ReportForm.eystr10.value;
         } else {
           ReportForm.keystr04.value=ReportForm.userid.value
           ReportForm.keystr05.value=ReportForm.eystr09.value
           ReportForm.keystr06.value=ReportForm.eystr10.value;
         }
         SubmitPage=CheckDateRange(ReportForm.keystr02,ReportForm.keystr03)
         break;
       } else {

         ReportForm.keystr02.title="From Schedule"
         ReportForm.keystr03.title="To Schedule"
//         ReportForm.keystr02.value=ReportForm.eystr04.value
//         ReportForm.keystr03.value=ReportForm.eystr05.value
//       ReportForm.keystr04.value=ReportForm.eystr06.value
//       ReportForm.keystr05.value=ReportForm.eystr07.value
         if (hosid==1) {
           ReportForm.keystr04.value=ReportForm.eystr08.value 
           ReportForm.keystr05.value=ReportForm.userid.value
           ReportForm.keystr06.value=ReportForm.eystr09.value
           ReportForm.keystr07.value=ReportForm.eystr10.value;
         } else {
           ReportForm.keystr04.value=ReportForm.userid.value
           ReportForm.keystr05.value=ReportForm.eystr09.value
           ReportForm.keystr06.value=ReportForm.eystr10.value;
         }
         break;
       } 
  }
  if (SubmitPage) {
    SubmitReport(ReportForm)
  }
}
//------------------------------------------------------------
// Function : Validate Visit Remote Script
//------------------------------------------------------------
function validateVisit(admissno) {
  if (isWhitespace(admissno.value)) return;;
  var serverURL = "../cgi-bin/patweb80.pbl?reportno=56" +
                  "&valdcode=" + admissno.value.replace(/ /g,"+") +
                  "&valdtype=1";  // EMR
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
  }
  else {
    admissno.value="";
    admissno.focus();
  }
}
</script>
</head>
<body onload=PageLoad();ReportLoad();singleEMR();document.ReportForm.schddate.focus();>
%START.OF.PAGE
  <form name=ReportForm method=post action=rshweb02.pbl style="margin:0">
  <input type=hidden name=reportno value=4>
  <input type=hidden name=ibcnmhos value="%RSHWEB02.01.118.000.043.1.1">
  <input type=hidden name=template value=001>
  <input type=hidden name=updttype value="A">
  <input type=hidden name=setdfprg value="IBAAAE20">
  <input type=hidden name=setdfrep value="01">
  <input type=hidden name=schdpgid value="IBAAAE20">    
  <input type=hidden name=schddesc value="Emergency Invoice Print">    
  <input type=hidden name=nextpage value="1">
  <input type=hidden name=redirect value="rshweb02.pbl?reportno=1&template=1">
  <input type=hidden name=ptcnuabf id=ptcnuabf
   value="%STANDARD.01.025.128.105.0.1">
  <input type=hidden name=userid value="%STANDARD.01.008">

<table width=100% align=center border=0 cellspacing=0>
<tr><td class=HeadingCell align=center colspan=2>
  Emergency Invoice Print</td>
</tr>
</table>
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Schedule Date</td>
    <td class=DataLabel>
    <input type=text name=schddate size=12 title="Schedule Date"
    value="%STANDARD.01.015" onblur="checkDate(this,'Schedule Date');">
    <img src=../images/DateLookup.gif class=Icon
     onclick="DateLookupFrame(schddate);">
    Time
    <input type=text name=schdtime size=12 title="Schedule Time" value="%STANDARD.01.016">
    <img src=../images/DateTimeStamp.gif class=Icon
      alt="Schedule Time"
     onclick="SetCurrentDateTime(schddate,schdtime);">
    <img src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(schdtime);">
    </td></tr>

<tr><td class=DataLabel>Printer</td>
    <td><select name=schdprnt title="Printer" class=Mandatory>
        <option></option>
        %STANDARD.01.001.IBAAAE20.01
        </select>
    </td></tr>
 
<tr><td class=DataLabel>Number of Copies</td>
    <td><select name=schdcopy title='Number of Copies' class=Mandatory>
        </select>
    </td></tr>
 
<tr><td class=DataLabel>Re-schedule Type</td> 
    <td class=DataLabel colspan=3> 
    <select name=schdrdat title="Schedule Type" onchange=SetReportDates()> 
    <option></option> 
    </select> 
    </td></tr> 
 
<tr><td class=DataLabel>Re-schedule Until Date</td> 
    <td class=DataLabel colspan=3> 
    <input type=text name=schdrend size=12 
     onblur="checkDate(this,'Re-schedule Until Date');"> 
    <img src=../images/DateTimeStamp.gif class=Icon
       onclick="SetCurrentDateTime(schdrend,null);"> 
    <img src=../images/DateLookup.gif class=Icon
     onclick="DateLookupFrame(schdrend);">
    </td></tr>

<!-- Emergency Invoice print -->

<tr><td colspan=2 align=center><hr width=80%></td></tr>
<tr><td class=DataLabel width=25%>Invoices</td>
  <td>
  <div id="ABFDIV" style="display: inline"></div>
  </td>
  </tr>
</table>
  <input type=hidden name=keystr02>
  <input type=hidden name=keystr03>
  <input type=hidden name=keystr04>
  <input type=hidden name=keystr05>
  <input type=hidden name=keystr06>
  <input type=hidden name=keystr07>
  <input type=hidden name=keystr08>
  <input type=hidden name=keystr09>
  <input type=hidden name=keystr10>
  <input type=hidden name=keystr11>
  <input type=hidden name=keystr12>
<span id=RangeOption></span>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<!--<tr><td class=DataLabel width=25%>From Date</td>
<td>
<input type=text size=15 maxlength=12 name=eystr04
    onblur="checkDate(this,'Date')"
    class="Mandatory PastDate" title="From Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.eystr04">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.eystr04">
   </td></tr>
<tr><td class=DataLabel width=25%>To Date</td>
<td><input type=text size=15 maxlength=12 name=eystr05
    onblur="checkDate(this,'Date')" class="Mandatory PastDate" title="To Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.eystr05">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.eystr05">
    </td></tr>-->

<tr><td class=DataLabel>Date Range</td>
    <td><span id=DateRange></span>
    </td></tr>

<tr><td class=DataLabel width=25%><div id=HospTitleDIV>Hospital ID</div></td>
<td><div id=HospFieldDIV><select name=eystr08 title="Hospital ID "></div>
    <option value="">All</option>
    %RSHWEB02.01.122
    </select>
    </td></tr>

<input type=hidden name=eystr09 value="Y">
<input type=hidden name=eystr10 value=" ">
<input type=hidden name=eystr16 value=" ">
</table>

<table width=80% align=center border=0 cellspacing=0>
<tr><td align=center colspan=2><br>
    <input type=button value=Ok class="button" onclick='ProcessReport();'>
    <input type=button value=Cancel class="button"
     onclick='location.href="../lookups/blank.html"' >
    </td></tr>
</table>

</form>

<span id=LineUp style="display:none">
<input type=hidden name=eystr02 value="Y">
</span>

<span id=ByEmergency style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Emergency</td>
<td><input type=text size=11 maxlength=8 name=eystr26
    class="Mandatory" title="Emergency" 
    onblur="justifyRight(eystr26);validateVisit(eystr26);">
    </td></tr>
</table>
</span>

<span id=ByUR style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>U/R Number</td>
<td>
<input type=text size=10 maxlength=8 name=eystr03 tabindex=4
       class="Mandatory" title="U/R Number"
        onblur="justifyRight(this);PatientReturn();">
        <img src=../images/SearchIcon.gif class=Icon onclick="PatientSearch();">
    </td>

  <input type=hidden name=selsex>
  <input type=hidden name=gname>
  <input type=hidden name=dummyadm>
  <input type=hidden name=dummydb>
</tr>
<input type=hidden name=eystr17 value="Y">
</table>
</span>

<span id=ByDateRange style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>From Date</td>
<td>
<input type=text size=15 maxlength=12 name=eystr04
    onblur="checkDate(this,'Date')"
    class="Mandatory PastDate" title="From Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.eystr04">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.eystr04">
   </td></tr>
<tr><td class=DataLabel width=25%>To Date</td>
<td><input type=text size=15 maxlength=12 name=eystr05
    onblur="checkDate(this,'Date')" class="Mandatory PastDate" title="To Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.eystr05">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.eystr05">
    </td></tr>

<tr><td class=DataLabel width=25%>Starting Name</td>
<td><input type=text size=8 maxlength=6 name=eystr06
    class="Mandatory" title="Starting Name">
    </td></tr>
<tr><td class=DataLabel width=25%>Ending Name</td>
<td><input type=text size=8 maxlength=6 name=eystr07
    class="Mandatory" title="Ending Name">
    </td></tr>
<input type=hidden name=eystr08 value=" ">
<input type=hidden name=eystr09 value="Y">
<input type=hidden name=eystr10 value=" ">
<input type=hidden name=eystr16 value=" ">
</span>


<span id=ByDateRange1 style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>From Date</td>
<td>
<input type=text size=15 maxlength=12 name=eystr04
    onblur="checkDate(this,'Date')"
    class="Mandatory PastDate" title="From Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.eystr04">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.eystr04">
   </td></tr>
<tr><td class=DataLabel width=25%>To Date</td>
<td><input type=text size=15 maxlength=12 name=eystr05
    onblur="checkDate(this,'Date')" class="Mandatory PastDate" title="To Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.eystr05">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.eystr05">
    </td></tr>

<tr><td class=DataLabel width=25%>Starting Name</td>
<td><input type=text size=8 maxlength=6 name=eystr06
    class="Mandatory" title="Starting Name">
    </td></tr>
<tr><td class=DataLabel width=25%>Ending Name</td>
<td><input type=text size=8 maxlength=6 name=eystr07
    class="Mandatory" title="Ending Name">
    </td></tr>

<tr><td class=DataLabel width=25%>Hospital ID</td>
<td><select name=eystr08 title="Hospital ID ">
    <option value="">All</option>
    %RSHWEB02.01.122
    </select>
    </td></tr>
</table>

<input type=hidden name=eystr09 value="Y">
<input type=hidden name=eystr10 value=" ">
<input type=hidden name=eystr16 value=" ">

</span>


<span id=XDollars style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Minimum Amount Owing</td>
<td><input type=text size=12 maxlength=10 min=0 name=eystr10
    class="Mandatory Number" title="Minimum Amount Owing"
    onchange="RoundNumber(this,2);">
    </td></tr>
<tr><td class=DataLabel width=25%>Starting Name</td>
<td><input type=text size=8 maxlength=6 name=eystr11
    class="Mandatory" title="Starting Name">
    </td></tr>
<tr><td class=DataLabel width=25%>Ending Name</td>
<td><input type=text size=8 maxlength=6 name=eystr12
    class="Mandatory" title="Ending Name">
    </td></tr>
<input type=hidden name=eystr13 value=" ">
<input type=hidden name=eystr14 value="Y">
<input type=hidden name=eystr15 value=" ">
<input type=hidden name=eystr16 value=" ">
<input type=hidden name=eystr17 value=" ">
</table>
</span>

<span id=XDollars1 style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Minimum Amount Owing</td>
<td><input type=text size=12 maxlength=10 min=0 name=eystr10
    class="Mandatory Number" title="Minimum Amount Owing"
    onchange="RoundNumber(this,2);">
    </td></tr>
<tr><td class=DataLabel width=25%>Starting Name</td>
<td><input type=text size=8 maxlength=6 name=eystr11
    class="Mandatory" title="Starting Name">
    </td></tr>
<tr><td class=DataLabel width=25%>Ending Name</td>
<td><input type=text size=8 maxlength=6 name=eystr12
    class="Mandatory" title="Ending Name">
    </td></tr>

<tr><td class=DataLabel width=25%>Hospital ID</td>
<td><select name=eystr13 title="Hospital ID ">
    <option value="">All</option>
    %RSHWEB02.01.122
    </select>
    </td></tr>

<input type=hidden name=eystr14 value="Y">
<input type=hidden name=eystr15 value=" ">
<input type=hidden name=eystr16 value=" ">
<input type=hidden name=eystr17 value=" ">
</table>
</span>

<span id=ABFSPAN style="display:none">
  <select name=keystr01 id=keystr01 title="Invoices" onchange="singleEMR();"> 
  <option value="2">Single Patient by Emergency No.</option>
  <option value="3">Single Patient by U/R Number</option>
  <option value="6" selected>Bulk ABF Invoices for a given date range</option>
  <option value="4">All Emergency in a given date range</option>
  <option value="5">All Emergency owing at least X dollars</option>
  </select>
</span>

<span id=NOABFSPAN style="display:none">
  <select name=keystr01 id=keystr01 title="Invoices" onchange="singleEMR();"> 
  <option value="2">Single Patient by Emergency No.</option>
  <option value="3">Single Patient by U/R Number</option>
  <option value="4">All Emergency in a given date range</option>
  <option value="5">All Emergency owing at least X dollars</option>
  </select>
</span>

<div id=SetDateRange style="display:none;">
    <input type=text size=15 maxlength=12 name=datran01
    onblur="checkDate(this,'Date')"
    class="Mandatory PastDate" title="From Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.datran01">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.datran01">
    To
    <input type=text size=15 maxlength=12 name=datran02
    onblur="checkDate(this,'Date')" class="Mandatory PastDate" title="To Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.datran02">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.datran02">
</div>

<div id=SetScheduleRange style="display:none;">
    <select name=datsch01 title="Schedule Range" class=Mandatory
    onblur=UpReportSchedule(this,ReportForm.keystr02,ReportForm.keystr03)>
    <option></option></select>
    Sample Range
    <input type=text name=SampleFrom size=12> To
    <input type=text name=SampleTo size=12>
</div>

<script language=javascript>
function singleEMR() {
   if (document.getElementById('keystr01').value=="1") {
//     document.getElementById('RangeOption').innerHTML=document.getElementById('LineUp').innerHTML;

   SetCookie("InvoicesSelectCookie","1");
   location.href = "rshweb02.pbl?reportno=1&template=2&reportid=ibaaae20";

   } 
   if (document.getElementById('keystr01').value=="2") {
//     document.getElementById('RangeOption').innerHTML=document.getElementById('ByEmergency').innerHTML;

   SetCookie("InvoicesSelectCookie","2");
   location.href = "rshweb02.pbl?reportno=1&template=2&reportid=ibaaae20";

   }
   if (document.getElementById('keystr01').value=="3") {
//     document.getElementById('RangeOption').innerHTML=document.getElementById('ByUR').innerHTML;

   SetCookie("InvoicesSelectCookie","3");
   location.href = "rshweb02.pbl?reportno=1&template=2&reportid=ibaaae20";

   }
   if (document.getElementById('keystr01').value=="4") {
//     if (ReportForm.ibcnmhos.value=="1") {
//       document.getElementById('RangeOption').innerHTML=document.getElementById('ByDateRange1').innerHTML; }
//     else {
//       document.getElementById('RangeOption').innerHTML=document.getElementById('ByDateRange').innerHTML; }

   location.href = "rshweb02.pbl?reportno=1&template=3&reportid=ibaaae20";

   }
   if (document.getElementById('keystr01').value=="5") {
//     if (ReportForm.ibcnmhos.value=="1") {
//       document.getElementById('RangeOption').innerHTML=document.getElementById('XDollars1').innerHTML; }
//     else {
//       document.getElementById('RangeOption').innerHTML=document.getElementById('XDollars').innerHTML; }

   SetCookie("InvoicesSelectCookie","5");
   location.href = "rshweb02.pbl?reportno=1&template=2&reportid=ibaaae20";

   }
   if (document.getElementById('keystr01').value=="6") {
//     if (ReportForm.ibcnmhos.value=="1") {
//       document.getElementById('RangeOption').innerHTML=document.getElementById('ByDateRange1').innerHTML; }
//     else {
//       document.getElementById('RangeOption').innerHTML=document.getElementById('ByDateRange').innerHTML; }

     if (ReportForm.ibcnmhos.value=="1") {
     } else {
       HospTitleDIV.innerHTML="";
       HospFieldDIV.innerHTML="";
     }

   }
}
if(document.getElementById('ptcnuabf').value == "1") {
      ABFDIV.innerHTML=ABFSPAN.innerHTML;
    } else {
      ABFDIV.innerHTML=NOABFSPAN.innerHTML;
    }

</script>
