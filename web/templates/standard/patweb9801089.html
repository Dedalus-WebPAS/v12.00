<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link                   
//  1 - Visit Number
//  2 - Visit Date
//  3 - Discharge Date
//  4 - Visit Desc
//  5 - Ward
//  6 - Doctor
//  7 - Admission Type (CMBS Class)
//  8 - Claim Type
//---------------------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
 t = new Table(1,0,2,"100%","center",23,30);
 t.addColumn("Visit Date","DateTime",2,2,"left","AppointmentIcon.gif","52",155)
 t.addColumn("Discharged","Date",3,3,"center","","",70)
 t.addColumn("Visit Type","String",4,4,"left","","",60)
 t.addColumn("Ward","String",5,5,"left","","",80)
 t.addColumn("Unit","String",10,10,"left","","",70)
 t.addColumn("Doctor","String",6,6,"left","","",110)
 t.addColumn("Insurance Class","String",8,8,"left","","",90)
 AddTableRows()
 TableOutput(0,2);    // Order Column,Asc Dsc
 break; }
 }
}
</script>

<script type="text/javascript">
function updParentLink(Urnumber,VisitNo,aclss,ptmipdrg,ptmicmxp,pmvxidus,
                       pmvxudin,pmvxpacc,pmvxcadm,pmvxrhc1,pmvxingp,ptmipcmx) {
  if (parent.UpdateForm.ptmis011!=undefined) {
    for(var i =0 ; i < parent.UpdateForm.ptmis011.length; i++) {
      if(parent.UpdateForm.ptmis011.options[i].value.substr(0,3)==aclss){
         parent.UpdateForm.ptmis011.selectedIndex=i } };
  }
  if (parent.UpdateForm.ptmis066!=undefined) {
    parent.UpdateForm.ptmis066.value=ptmipdrg;
    validateCode(5,parent.UpdateForm.ptmis066,parent.UpdateForm.drgdesc1);
  }
  if (parent.UpdateForm.ptmis075!=undefined) {
    if(ptmicmxp=="N") { parent.UpdateForm.ptmis075.value="0" }
    if(ptmicmxp=="Y") { parent.UpdateForm.ptmis075.value="1" }
  }
  if (parent.UpdateForm.ptmis073!=undefined) {
    parent.UpdateForm.ptmis073.value=ptmipcmx;
    validateCode(35,parent.UpdateForm.ptmis073,parent.UpdateForm.cmixdesc1,parent.UpdateForm.ptmis030);
  }
  if (parent.UpdateForm.ptvis043!=undefined) {
    for(var i =0 ; i < parent.UpdateForm.ptvis043.length; i++) {
      if(parent.UpdateForm.ptvis043.options[i].value.substr(0,3)==pmvxidus){
         parent.UpdateForm.ptvis043.selectedIndex=i } };
  }
  if (parent.UpdateForm.ptvis076!=undefined) {
    for(var i =0 ; i < parent.UpdateForm.ptvis076.length; i++) {
      if(parent.UpdateForm.ptvis076.options[i].value.substr(0,3)==pmvxudin){
         parent.UpdateForm.ptvis076.selectedIndex=i } };
  }
  if (parent.UpdateForm.ptvis093!=undefined) {
    for(var i =0 ; i < parent.UpdateForm.ptvis093.length; i++) {
      if(parent.UpdateForm.ptvis093.options[i].value.substr(0,3)==pmvxpacc){
         parent.UpdateForm.ptvis093.selectedIndex=i } };
  }
  if (parent.UpdateForm.ptvis041!=undefined) {
    for(var i =0 ; i < parent.UpdateForm.ptvis041.length; i++) {
      if(parent.UpdateForm.ptvis041.options[i].value.substr(0,3)==pmvxcadm){
         parent.UpdateForm.ptvis041.selectedIndex=i } };
  }
  if (parent.UpdateForm.ptvis028!=undefined) {
    parent.UpdateForm.ptvis028.value=pmvxrhc1;
    ValidateHCP(18,0,parent.UpdateForm.ptvis028,parent.UpdateForm.genpname);
  }
  if (parent.UpdateForm.ptvis022!=undefined) {
    parent.UpdateForm.ptvis022.value=pmvxingp;
  }

  if (isWhitespace(VisitNo)) {DFrameExit();return;}
  if (parent.UpdateForm.ptcnhdps==undefined) {DFrameExit();return;}
  if (parent.UpdateForm.ptcnhdps.value!="4") {DFrameExit();return;}

  var serverURL = "../cgi-bin/comweb81.pbl?reportno=7&admissno=" +
                  VisitNo.replace(/ /g,"+");

  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {

    ReturnValue=returnValue.return_value.split("|");

    parent.UpdateForm.ptmis007.value=trim(ReturnValue[0]);
    parent.UpCase(parent.UpdateForm.ptmis007);
    parent.UpdateForm.qldmhdoc.value='';
    parent.valDoctorUnit();

    if (isWhitespace(ReturnValue[2])) {
      parent.UpdateForm.ptqmh002.selectedIndex=0;
    } else {
    for(var i =0 ; i < parent.UpdateForm.ptqmh002.length; i++) {
      if(parent.UpdateForm.ptqmh002.options[i].value==ReturnValue[2]){
         parent.UpdateForm.ptqmh002.selectedIndex=i } };
    }

    if (isWhitespace(ReturnValue[3])) {
      parent.UpdateForm.ptqmh003.selectedIndex=0;
    } else {
    for(var i =0 ; i < parent.UpdateForm.ptqmh003.length; i++) {
      if(parent.UpdateForm.ptqmh003.options[i].value==ReturnValue[3]){
         parent.UpdateForm.ptqmh003.selectedIndex=i } };
    }

    if (isWhitespace(ReturnValue[4])) {
      parent.UpdateForm.ptqmh004.selectedIndex=0;
    } else {
    for(var i =0 ; i < parent.UpdateForm.ptqmh004.length; i++) {
      if(parent.UpdateForm.ptqmh004.options[i].value==ReturnValue[4]){
         parent.UpdateForm.ptqmh004.selectedIndex=i } };
    }

    if (isWhitespace(ReturnValue[5])) {
      parent.UpdateForm.ptqmh005.selectedIndex=0;
    } else {
    for(var i =0 ; i < parent.UpdateForm.ptqmh005.length; i++) {
      if(parent.UpdateForm.ptqmh005.options[i].value==ReturnValue[5]){
         parent.UpdateForm.ptqmh005.selectedIndex=i } };
    }

    if (isWhitespace(ReturnValue[6])) {
      parent.UpdateForm.ptqmh006.selectedIndex=0;
    } else {
    for(var i =0 ; i < parent.UpdateForm.ptqmh006.length; i++) {
      if(parent.UpdateForm.ptqmh006.options[i].value==ReturnValue[6]){
         parent.UpdateForm.ptqmh006.selectedIndex=i } };
    }

    if (isWhitespace(ReturnValue[7])) {
      parent.UpdateForm.ptqmh007.selectedIndex=0;
    } else {
    for(var i =0 ; i < parent.UpdateForm.ptqmh007.length; i++) {
      if(parent.UpdateForm.ptqmh007.options[i].value==ReturnValue[7]){
         parent.UpdateForm.ptqmh007.selectedIndex=i } };
    }

    if (isWhitespace(ReturnValue[8])) {
      parent.UpdateForm.ptqmh008.selectedIndex=0;
    } else {
    for(var i =0 ; i < parent.UpdateForm.ptqmh008.length; i++) {
      if(parent.UpdateForm.ptqmh008.options[i].value==ReturnValue[8]){
         parent.UpdateForm.ptqmh008.selectedIndex=i } };
    }

  }

  DFrameExit();
}
</script>

</head>
%START.OF.PAGE
<body onload=PageLoad(event);InitTable(0)>
<div id=HeadingSection>
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Link Patient Visits
</span>
</div>
<div id=TableLocation></div>
<script type="text/javascript">
function AddTableRows() {
%PATWEB98.01.301.patweb98.01.001.3.0.2.0.0.1
}
</script>
