<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript">
function SessionLink(SessionKey,FinalDate) {
 if (!isWhitespace(FinalDate)) {
   alert("ERROR - Session is finalized - No new bookings can be made.\n" +
         "Please reset to Provisional to make changes to this session.");
 } else {
 if (parent.LinkForm.datelist.value>SessionKey.substr(3,8)) {
    alert("Booking Date cannot be less than Date on List");
   }
 else {
    setWaitingListBookingCookie();
    parent.LinkForm.sesskeys.value=SessionKey;
    parent.LinkForm.submit();
    DFrameExit();
   }
 }
}
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link   
//  1 - Session Date & Time
//  2 - Surgeon
//  3 - Anaesthetist
//  4 - Theatre
//  5 - Session Type
//  6 - Status
//  7 - Booking Graph 0 - 120
//  8 - Available Min
//  9 - Booked Min
// 10 - Actual Min
//---------------------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
 t = new Table(1,0,2,"100%","center",25,25);
 t.addColumn("Session","DateTime",1,1,"left","TheatreSessionIcon.gif","0",140)
 t.addColumn("Surgeon","String",2,2,"left","","",150)
 t.addColumn("Anaesthetist","String",3,3,"left","","",150)
 t.addColumn("Theatre","String",4,4,"left","","",150)
 t.addColumn("Status","Graph",7,7,"left","bar1.gif","",120)
 AddTableRows()
 TableOutput(1,2);
 break; }
case 1: {
 t = new Table(1,0,2,"100%","center",35,25);
 t.addColumn("Session","DateTime",1,1,"left","TheatreSessionIcon.gif","0",140)
 t.addColumn("Anaesthetist","String",3,3,"left","","",150)
 t.addColumn("Theatre","String",4,4,"left","","",150)
 t.addColumn("Avail. Op Min","String",8,8,"right","","",45)
 t.addColumn("Booked Op Min","String",9,9,"right","","",45)
 t.addColumn("Actual Op Min","String",10,10,"right","","",45)
 AddTableRows()
 TableOutput(1,2);
 break; }
 }
}
function getWaitingListBookingCookie() {
  document.getElementById("walibkck").value=
  GetCookieData("WaitingListBookingCookie");
  ExpireCookiePath("WaitingListBookingCookie");

  if (document.getElementById('lastdate') != null) {
   document.getElementById('lastdate').
   setAttribute("onchange",
   function(){setWaitingListBookingCookie();this.form.submit();});
//   alert(document.getElementById('lastdate').onchange);
  }

  if (document.getElementById('vyearmth') != null) {
   document.getElementById('vyearmth').
   setAttribute("onchange",
   function(){setWaitingListBookingCookie();this.form.submit();});
//   alert(document.getElementById('vyearmth').onchange);
  }

//alert(document.getElementById("walibkck").value);
}
function setWaitingListBookingCookie() {
  if (document.getElementById("walibkck").value != "unknown" &&
      !isWhitespace(document.getElementById("walibkck").value)) {
    SetCookie("WaitingListBookingCookie",
               document.getElementById("walibkck").value);
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);
              getWaitingListBookingCookie();
              DisplaySurgTypeFilterDefaults();">
<div id=HeadingSection>
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Theatre Session Search
</span>
<form name=SelectPeriod action=oprweb01.pbl method=get style="margin:0">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=004>
<input type=hidden name=viewtype value="%OPRWEB01.02.011">
<input type=hidden name=wattrkey id=wattrkey value="%OPRWEB01.02.201">
<input type=hidden name=walibkck id=walibkck value="">
<table border=0 cellpadding=3 cellspacing=0 width=100% bgcolor=#cccccc>
<tr>
  <td width=6%>
    <a href=javascript:InitTable(0)>
     <img src="../images/TableViewIcon.gif" class=Icon
      alt="Default View" title="Default View"></a>
    <a href=javascript:InitTable(1)>
     <img src="../images/TableViewIcon.gif" class=Icon
      alt="Show Times" title="Show Times"></a>
  </td>
  <td width=25%>
    Unit&nbsp;
    <select id=docttype name=docttype title="Unit"
     onchange="setWaitingListBookingCookie();SelectPeriod.submit(this);">
     <option value=" "> </option>
     %OPRWEB01.02.015
    </select>
  </td>
  <td width=20%>
    Doctor&nbsp;
    <select id=doctcode name=doctcode title="Doctor"
     onchange="setWaitingListBookingCookie();SelectPeriod.submit(this);">
     <option value="  "> </option>
     %OPRWEB01.02.016
    </select>
  </td>
  <td width=25%>
    <div id='DisplaySurgTypeDIV'></div>
  </td>
  <td align=right>
    <a href='javascript:SelectDateFrame();'>
     <img src="../images/DateLookup.gif" class=Icon
      alt="Select Date" title="Select Date"></a>
    <a href='javascript:SelectView("0");'>
     <img src="../images/DayIcon.gif" class=Icon
      alt="View Today" title="View Today"></a>
    <a href='javascript:SelectView("1");'>
     <img src="../images/WeekIcon.gif" class=Icon
      alt="View This Week" title="View This Week"></a>
    <a href='javascript:SelectView("2");'>
     <img src="../images/MonthIcon.gif" class=Icon
      alt="View This Month" title="View This Month"></a>
  </td>
</tr>
<tr>
  <td colspan=5 align=right>
    <input type=button value="<<" class=SmallButton title="Previous"
     onclick='setWaitingListBookingCookie();location.href="%OPRWEB01.02.002"'>
     %OPRWEB01.02.007
    <input type=button value=">>" class=SmallButton title="Next"
     onclick='setWaitingListBookingCookie();location.href="%OPRWEB01.02.001"'>
  </td>
</tr>
</table>
</form>
</div>

<div id=TableLocation></div>

<!-- Surgery Type/Cat YD -->
<span id="DisplaySurgType" style="display:none;">
  %STANDARD.01.017.YD&nbsp;
  <select name=filtlocn id=filtlocn title="%STANDARD.01.017.YD"
   onchange="setWaitingListBookingCookie();SelectPeriod.submit(this);">
   <option value="  ">All</option>
   %OPRWEB01.02.022.2
  </select>
</span>

<script type="text/javascript">
function AddTableRows() {
%OPRWEB01.02.014.oprweb01.03.003
}

function DisplaySurgTypeFilterDefaults() {
  if (typeof DisplaySurgTypeFilter != "undefined" &&
                DisplaySurgTypeFilter == true) {
    document.getElementById('DisplaySurgTypeDIV').innerHTML=
      document.getElementById('DisplaySurgType').innerHTML;
  } else {
    document.getElementById('DisplaySurgTypeDIV').innerHTML='';
  }
}
</script>
