<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function Validate() {

  var bValidated = false;
  var bClose = false;
  var theForm = document.UpdateForm;

  var sURL = "../cgi-bin/patweb98.pbl?reportno=12&remoteno=1" +
             "&secureid=" + encodeURIComponent(theForm.secureid.value) +
             "&securepw=" + encodeURIComponent(theForm.securepw.value);

  var returnValue = RSExecute(sURL);

  if (returnValue.status == 0) {
    resVal = returnValue.return_value;

    switch (resVal) {
      case '0':
        bValidated = true;
        break;
      case '1':
        alert("Invalid User Id and/or Password");
        break;
      case '2':
        alert("User Id must not be a Generic User ID");
        break;
      case '3':
        alert("The User Id used does not have a Doctor Code recorded.\n" +
              "Radiology tests can only be ordered by authorised Doctors.\n" +
              "Please remove any Radiology tests to complete the order.");
        bClose = true;
        break;
      case '4':
        alert("Linked Doctor Code not found");
        break;
      case '5':
        alert("The Doctor Code used does not have a Provider Number recorded.\n" +
              "Radiology tests can only be ordered by Doctors with a registered Provider Number.\n" +
              "Please remove any Radiology tests to complete the order.");
        bClose = true;
        break;
      case '6':
        alert("The Doctor Code used has an expired Accreditation Date recorded.\n" +
              "Please contact a System Administrator to have this rectified.\n" +
              "Please remove any Radiology tests to complete the order.");
        bClose = true;
        break;
      default:
        break;
    }
  }
  else {
    alert("Web Service (PATWEB98) Not Available. " +
          "Please check your connection and Try Again.");
  }
  
  if (bValidated) {
    if (parent.UpdateForm && parent.UpdateForm.requsrid != undefined) {
      // set the User Id for the (parent) request form
      parent.UpdateForm.requsrid.value = theForm.secureid.value;
    }
    DFrameExit();     // close this window
    parent.DoSave();  // submit order (parent page)
    return true;
  }

  if (bClose) {
    DFrameExit();
  }

  return false;
}
</script>
%START.OF.PAGE
<body onload="PageLoad(event);UpdateForm.securepw.focus();">
<span class=DFrameTitleBar>
 <img align="right" alt="Exit" class="MenuIcon" src="../images/ExitIcon.gif"
     onclick="DFrameExit();">
 Password Validation
</span>

<form name=UpdateForm method=post action="patweb98.pbl" style="margin:0">
<input type=hidden name=reportno value="1">
<input type=hidden name=template value="216">

  <table align=center width=95% border=0 cellspacing=0 cellpadding=2>
  <tr><td class=DataField width=30%>User Id</td>
      <td class=DataLabel>
        <input type=text name=secureid id=secureid size=12 maxlength=10
         class=Mandatory title="User ID" value="%STANDARD.01.008">
      </td>
  </tr>

  <tr><td class=DataField>Password</td>
      <td class=DataField>
        <input type=password name=securepw id=securepw size=12 class=Mandatory
         title="Password">
      </td>
  </tr>

  <tr><td colspan=2 align=center>
        <input type=button value="Ok" class="button" onclick="Validate();">
        <input type=button value="Cancel" class="button"
         onclick="DFrameClose();">
      </td>
  </tr>
  </table>
</form>
