<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript" src="../js/comweb12.js"> </script>
%START.OF.PAGE
<script type="text/javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HL7 Created Date & Time                   
//  1 - HL7 Message Type             
//  2 - HL7 Message Status
//  3 - HL7 Message ID
//  4 - HL7 Delivered Date & Time
//---------------------------------------------------------------------------
  function InitTable() { 
     t = new Table(1,0,2,"100%","center",35,35);
     t.addColumn("Created Date/Time","DateTime",0,0,"left","MaintenanceIcon.gif","6",90)
     t.addColumn("Message Detail","String",5,5,"right","","",40)
     t.addColumn("Type","String",1,1,"left","","",20)
     t.addColumn("Status","String",2,2,"left","","",60)
     t.addColumn("Message ID","String",3,3,"left","","",70)
     t.addColumn("Delivered Date/Time","DateTime",4,4,"left","","",90)
     if ("%COMWEB12.01.116" === "1") {
       t.addColumn("Reset","String",11,11,"left","EditIcon.gif","8",30)
       t.addColumn("Delete","String",12,12,"left","DeleteIcon.gif","9",30)
     }
     AddTableRows()
     TableOutput(0,0);    // Order Column,Asc Dsc
  }

  function SelectSubmit() {
    if (document.SelectView.unitcode.value=='') {
      document.SelectView.unitcode.focus();
      return;
    }
    document.SelectView.submit();
  }

  function LinkReset(msgId, msgStatus) {
    var newStatus=(msgStatus==="W" ? "Rejected" : "Waiting");
    var newStatusL=(msgStatus==="W" ? "R" : "W");
    var outcome=confirm("Do you want to set the Status to '" + newStatus + "?'");
    if (outcome) {
      alert("You are setting the status to " + newStatus);
      var updForm=document.UpdateForm;
      updForm.uph7stat.value=newStatusL;
      updForm.updttype.value="U";
      updForm.hl7cimes.value=msgId;
      updForm.submit();
    }
  }

  function LinkDelete(msgId) {
    var outcome=confirm("Are you sure you want to delete this record?");
    if (outcome) {
      alert("You have deleted the record!")
      var updForm=document.UpdateForm;
      updForm.updttype.value="D";
      updForm.hl7cimes.value=msgId;
      updForm.submit();
    }
  }
</script>
</head>
<body onload=PageLoad(event);InitTable()>
<div id=HeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%COMWEB12.01.003";
PatientVIS="%COMWEB12.01.081";
PatientNAM="%COMWEB12.01.002";
PatientSTA="%COMWEB12.01.086.078";
PatientALT="%COMWEB12.01.084";
PatientSEX="%COMWEB12.01.019";
PatientDOB="%COMWEB12.01.020";
PatientAGE="%COMWEB12.01.021";
PatientLOC="%COMWEB12.01.083";
DoctorCOD="%COMWEB12.01.082.003";
DoctorNAM="%COMWEB12.01.082.002";
PatientAID="%COMWEB12.01.086.090";
PatientIND="%COMWEB12.01.086.091";
PatientCUR="%COMWEB12.01.086.092";
PatientCLC="%COMWEB12.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%COMWEB12.01.086.094";
PatientCDM="%COMWEB12.01.086.095";
PatientVDH="%COMWEB12.01.086.099.015";
PatientUNT="%COMWEB12.01.066.0";
PatientPRI="%COMWEB12.01.086.066.1";
InsertPatientHeader()
</script>

<div id=PatientMenu></div>
<form name=SelectView action=comweb12.pbl method=get style=margin:0>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value="%COMWEB12.01.003">
<input type=hidden name=admissno value="%COMWEB12.01.081">
<input type=hidden name=superlev value="%COMWEB12.01.116">
<table width=100% cellspacing=0 cellpadding=0 bgcolor=#cccccc>
<tr><td>
    <td align=left >&nbsp;Status&nbsp;
    <select name=statushl onchange=SelectView.submit(this)>
      <option value=" ">All</option>
      <option value="W">Waiting</option>
      <option value="R">Rejected</option>
      <option value="D">Delivered</option>
    </select></td>
    </tr>
</table>
</form>
</div>
<div id=TableLocation> </div>

<form name=UpdateForm action=comweb12.pbl method=post style=margin:0>
  <input type=hidden name=reportno value=1>
  <input type=hidden name=template value=001>
  <input type=hidden name=superlev value="%COMWEB12.01.116">
  <input type=hidden name=urnumber value="%COMWEB12.01.003">
  <input type=hidden name=statushl value="%COMWEB12.01.120">
  <input type=hidden name=hl7cimes value="">
  <input type=hidden name=uph7stat value="">
  <input type=hidden name=updttype value="">
</form>

<script type="text/javascript">
  document.getElementsByName("statushl")[0].value = "%COMWEB12.01.104";
  function AddTableRows() {
    %COMWEB12.01.101
  }
</script>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value="%COMWEB12.01.003">
<input type=hidden name=admissno value="%COMWEB12.01.081">
<input type=hidden name=MenuType value="%COMWEB12.01.088">
<input type=hidden name=priocat value="%STANDARD.01.017.TP">
</form>
