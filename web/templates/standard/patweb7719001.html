<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">

function validateItemCode(OptionNumber,ReturnCode,ReturnName) {
  ReturnFunction="" ;
  ReturnName.value="";
  ArgCount=3;
  for (var i=ArgCount; i < validateItemCode.arguments.length; i++) {
    if (typeof(validateItemCode.arguments[i]) == 'function') {
      ReturnFunction=validateItemCode.arguments[i] }
    else {
      validateItemCode.arguments[i].value=""; }  }
  if (isWhitespace(ReturnCode.value)) return;;

  if (document.AddForm.ibcnmhos.value != "1") {
    document.AddForm.fvgrp001.value="";
  }
    var serverURL   = "../cgi-bin/patweb80.pbl?reportno=" + OptionNumber +
              "&valdhosp=" + document.AddForm.fvgrp001.value.replace(/ /g,"+") +
              "&valdcode=" + ReturnCode.value.replace(/ /g,"+") +
              "&valdtype=4"

  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|")
    ReturnName.value=trim(ReturnValue[0])
    j=0
    for (var i=ArgCount; i < validateItemCode.arguments.length; i++) {
       if (typeof(validateItemCode.arguments[i]) != 'function') {
         j++
         validateItemCode.arguments[i].value=ReturnValue[j] } }
    if (typeof(ReturnFunction) == 'function') {
       ReturnFunction() }
    return true;
    }
  else {
    ReturnCode.value="";
    ReturnCode.select();
    ReturnCode.focus();
    return false;
     }
}

function AddFavItem() {
  f = document.AddForm;
  if(f.d_fvgrp005.checked == true) {
    f.fvgrp005.value="Yes";
  }
  else {
    f.fvgrp005.value="No";
  }
  if (f.ibcnmhos.value != "1") {
    f.fvgrp001.value="";
  }
  if(!validateMandatory(AddForm)) { return; }

  f.fvgrp008.value = parseInt(f.fvgrp008.value,10);
  f.fvgrp009.value = f.d_fvgrp007.value;

  if (f.d_fvgrp005.checked == true) {
    var serverURL  = "../cgi-bin/patweb77.pbl?reportno=6&valdtype=4" +
                     "&fvgrp001=" + f.fvgrp001.value.replace(/ /g,"+") +
                     "&fvgrp002=" + f.fvgrp002.value.replace(/ /g,"+") +
                     "&fvgrp003=" + f.fvgrp003.value.replace(/ /g,"+") +
                     "&fvgrp004=" + f.fvgrp004.value.replace(/ /g,"+");

    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      if (returnValue.return_value==1) {
        alert("Error: Default Group Already Set.");
        return;
      }
    }

  }

  SetPageCookies(AddForm,"patweb7719001");
  SubmitFormNew();
}
function AddFavItemFinish() {
  f = document.AddForm;
  if(f.d_fvgrp005.checked == true) {
    f.fvgrp005.value="Yes";
  }
  else {
    f.fvgrp005.value="No";
  }
  if (f.ibcnmhos.value != "1") {
    f.fvgrp001.value="";
  }

  if(validateMandatory(AddForm)) {

    f.fvgrp009.value = f.d_fvgrp007.value;
    if (f.d_fvgrp005.checked == true) {

      var serverURL  = "../cgi-bin/patweb77.pbl?reportno=6&valdtype=4" +
                       "&fvgrp001=" + f.fvgrp001.value.replace(/ /g,"+") +
                       "&fvgrp002=" + f.fvgrp002.value.replace(/ /g,"+") +
                       "&fvgrp003=" + f.fvgrp003.value.replace(/ /g,"+") +
                       "&fvgrp004=" + f.fvgrp004.value.replace(/ /g,"+");

      var returnValue = RSExecute(serverURL);
      if (returnValue.status==0) {
        if (returnValue.return_value==1) {
          alert("Error: Default Group Already Set.");
          return;
        }
      }

    }

    AddForm.submit();
  }
}
function checkUser(userId,userName) {
  if (isWhitespace(userId.value)) {
    userName.value = "";
    return;
  }
  var serverURL = "../cgi-bin/patweb80.pbl?reportno=61" +
                  "&valdcode=" + userId.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|")
    userName.value=trim(ReturnValue[0])
  }
  else {
    userId.value="";
    userName.value="";
    userId.focus();
  }
}
function UserIdSearchFrame(ReturnCode,ReturnName) {
  var PopUpFrameDoc = DFrameStart();
  window.ReturnCode=ReturnCode;
  window.ReturnName=ReturnName;
  PopUpFrameDoc.location.href = "../cgi-bin/websec01.pbl?reportno=03" +
                                "&template=011"
  SearchFrameShow(); 
}
function DisplayHospIdDetail() {
  f = document.AddForm;
  if (f.ibcnmhos.value == "1") {
    document.getElementById('HospIdDetail').style.display = "";
  } else {
    document.getElementById('HospIdDetail').style.display = "none";
  }
}
function LoadSaveCookie() {
  LoadPageCookies(AddForm,"patweb7719001");
  ExpireCookiePath("patweb7719001");
  document.AddForm.fvgrp007.value="";
  document.AddForm.d_fvgrp007.value="";
  document.AddForm.fvgrp008.value="";
}

</script>
%START.OF.PAGE
<body onload="PageLoad(event);LoadSaveCookie();
              DisplayHospIdDetail();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
<script type="text/javascript">
  document.write("Group/User Favourites Maintenance"); 
</script>
</span>
<form name=AddForm action=patweb77.pbl method=post>
<input type=hidden name=reportno value=19>
<input type=hidden name=template value=1>
<input type=hidden name=updatety value="A">
<input type=hidden name=fvgrp005 id=fvgrp005 value="">
<input type=hidden name=fvgrp009 id=fvgrp009 value="">
<input type=hidden id=multhosp name=multhosp value="%STANDARD.01.032">
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">

<table width="95%" cellpadding=1 cellspacing=1 border=0 align=center>
<tr id=HospIdDetail>
  <td class=DataLabel>Hospital</td>
  <td><select name=fvgrp001 title="Hospital" tabindex=1>
      <option></option>
        %PATWEB77.19.001
      </select>
  </td>
</tr>

<tr>
  <td class=DataLabel>Occupational Group</td>
  <td><select name=fvgrp002 class=Mandatory title="Occupational Group">
      <option></option>
        %PATWEB77.19.002.9.2
      </select>
  </td>
</tr>

<tr>
  <td class=DataLabel>User ID</td>
  <td class=DataField>
    <input type=text name=fvgrp003 size=12 maxlength=10
      title="User ID" value="" 
      onblur="checkUser(document.AddForm.fvgrp003,document.AddForm.d_fvgrp003);">
    <input type=text name=d_fvgrp003 size=40 
      title="User Name"
      class=Readonly readonly notab value="">
    <img src="../images/SearchIcon.gif" class=Icon notab
      onclick="UserIdSearchFrame(document.AddForm.fvgrp003,
                                 document.AddForm.d_fvgrp003);">
    <img src="../images/erase.gif" class=Icon
      onclick="clrFields(fvgrp003,d_fvgrp003);">
  </td>
</tr>

<tr>
  <td class=DataLabel>Favourite Group</td>
  <td><select name=fvgrp004 class=Mandatory title="Favourite Group">
      <option></option>
        %PATWEB77.19.004.9.2
      </select>
  </td>
</tr>

<tr>
  <td class=DataLabel>Default Group</td>
  <td class=DataiField><input type=checkbox name=d_fvgrp005
    title="Default Group" value="0">
  </td>
</tr>

<tr>
  <td class=DataLabel>Sub-Group Heading</td>
  <td><select name=fvgrp006 class=Mandatory title="Sub-Group Heading">
      <option></option>
        %PATWEB77.19.006.9.2
      </select>
  </td>
</tr>

<tr align=left>
  <td align=center colspan="8">
    <hr>
  </td>
</tr>

<tr>
  <td class=DataLabel>Charge Item</td>
  <td>
    <input type=text id=fvgrp007 name=fvgrp007 size=9 maxlength=9
      title="Charge Item" class=Mandatory
      onblur="validateItemCode(40,fvgrp007,d_fvgrp007);">
    <input type=text size=90 id=d_fvgrp007 name=d_fvgrp007 
      title="Charge Item Description"
      class=Readonly readonly>
    <img src="../images/SearchIcon.gif" class=Icon notab
      onclick="DefMiscChargeSearchFrame(fvgrp007,d_fvgrp007,multhosp);">
    <img src="../images/erase.gif" class=Icon notab
      onclick="clrFields(fvgrp007,d_fvgrp007);">
    </td>
</tr>

<tr>
  <td class=DataLabel>Quantity</td>
  <td>
    <input type=text name=fvgrp008 size=4 maxlength=3 
      title="Quantity" class="Integer Mandatory" min=1 max=999>
  </td>
</tr>

<tr>
  <td colspan=3 align=center><br>
    <input type=button name=btnAdd id=btnAdd value=Add class="button" 
      onclick="AddFavItem();">
    <input type=button name=btnAddFn id=btnAddFn value="Add and Finish"
      class="button" 
      onclick="AddFavItemFinish();">
    <input type=button name=btnCan id=btnCan value=Cancel class="button" 
      onclick="DFrameCloseRefresh()">
  </td>
</tr>

</table>
</form>

<script type="text/javascript">
  f = document.AddForm;
  if (f.ibcnmhos.value == "1") {
    f.fvgrp001.className="Mandatory";
  }
  else {
    f.fvgrp001.className="";
  }
</script>
