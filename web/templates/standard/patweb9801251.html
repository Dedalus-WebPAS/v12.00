<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="CrossBrowser" content="true">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src="../js/TableSort.js"></script>
<script type="text/javascript">
function linkPatient(Urnumber,VisitNo,VisitType,SecOpt){
  if(isWhitespace(VisitNo)){
     alert("Invalid Visit No");
     return;
  }
  parent.ReturnCode.value=VisitNo;
  parent.ReturnCode.focus();
  if (parent.ReturnFromVisitSearch != undefined) {
    parent.ReturnFromVisitSearch(VisitNo);
  }

  DFrameExit();
}

function ShowVisits(){
  document.UpdateForm.submit();
}

function ResetSearch(){
  serverURL = "../cgi-bin/patweb98.pbl?reportno=01&template=251" +
  "&filtvtyp=" + UpdateForm.filtvtyp.value + 
  "&norecord=" + UpdateForm.norecord.value +
  "&admissno=" + UpdateForm.admissno.value.replace(/ /g,"+") +
  "&urnumber=" + UpdateForm.urnumber.value.replace(/ /g,"+") 
  location.href=serverURL;
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ShowNoVisitChbx();">
<div id=HeadingSection>

<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
 Patient Visit Search
</span>

<form name=UpdateForm action=patweb98.pbl style="margin:0">
<input type=hidden name=reportno value="1">
<input type=hidden name=template value="251">
<input type=hidden name=urnumber value="%PATWEB98.01.003">
<input type=hidden name=admissno value="%PATWEB98.01.081">
<input type=hidden name=norecord value="9">
<input type=hidden name=srchview value="1">
<input type=hidden name=alcnlkvm id=alcnlkvm
       value="%STANDARD.01.025.121.128.0.1">
<input type=hidden name=giclcode id=giclcode 
       value="%PATWEB98.01.399.030">

<table cellspacing=0 cellpadding=0 border=1 width=100% class=HeadingCell>
  <tr>
    <td align=right class=HeadingCell>Visit Type
      <select class=PMenuSelectList name=filtvtyp onchange='ShowVisits();'>
      <option></option>
      <option value="1">All</option>     
      <option value="2">Inpatient</option>
      <option value="3">Outpatient</option>
      <option value="4">Emergency</option>
      <option value="6">Referrals</option> 
      <option value="7">Events</option>
      </select>
    </td>
  </tr>
</table>
</form>
</div>

<div id="PageBodySection">
<table cellspacing=0 cellpadding=2 border=1 width=100%>
  <tr>
    <td class=HeadingCell width=25%>Admission/Visit Date</td>
    <td class=HeadingCell width=5%>Day</td>
    <td class=HeadingCell width=5%>Type</td>
    <td class=HeadingCell width=5%>Unit</td>
    <td class=HeadingCell width=15%>HCP</td>
    <td class=HeadingCell width=10%>Location</td>
    <td class=HeadingCell width=5%>Ins Class</td>
    <td class=HeadingCell width=15%>Status</td>
    <td class=HeadingCell width=10%>Visit No</td>
    <td class=HeadingCell width=5%>Med Rec</td>
  </tr>
  %PATWEB98.01.327.0.0.0.0.0
</table>

<table cellspacing=0 cellpadding=0 border=0 width=100% bgcolor=#CCCCCC>
  <tr>
    <td align=center>
      <br>
      <input type=button value="Previous" class="button"
       onclick='location.href="%PATWEB98.01.328.251"'>
      <input type=button value="Start" class="button"
       onclick="ResetSearch();">
      <input type=button value="Next" class="button"
       onclick='location.href="%PATWEB98.01.329.251"'>
      <br>
      <br>
    </td>
  </tr>
</table>
</div>

<div id=NoVisitChbx style="display: none">
    No Appropriate Visit Available &nbsp;
    <input type=checkbox name=novisit id=novisit value="1"
     title="No Appropriate Visit available"
     onclick='checkCloseSearch();'> &nbsp;
</div>


<script type="text/javascript">
FilterVis="%PATWEB98.01.330";
for(var i=0; i<document.UpdateForm.filtvtyp.length; i++) {
    if(document.UpdateForm.filtvtyp.options[i].value==trim(FilterVis)) {
       document.UpdateForm.filtvtyp.selectedIndex=i; 
    }
}
//T0881801-start
function ShowNoVisitChbx(){
 if (document.getElementById('alcnlkvm').value == "1"  ||
     document.getElementById('giclcode').value == "B") {
    if (document.getElementById('InsertNoVisitChbx')!=undefined) {
       InsertNoVisitChbx.innerHTML=NoVisitChbx.innerHTML;
    }
 } 
 else {
    if (document.getElementById('InsertNoVisitChbx')!=undefined) {
       InsertNoVisitChbx.innerHTML="";
    }
 }
}
function checkCloseSearch(){
 if (document.getElementById('novisit').checked==true){
    parent.ReturnCode.className=""; //set field as non-mandatory
    parent.ReturnCode.focus();

    DFrameExit();
 }
}
//T0881801-start
</script>
