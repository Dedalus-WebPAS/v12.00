<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src=../js/TableSort.js></script>
<script type="text/javascript">

function ChechBoxReports() {
  var c = new Array();
  c = document.getElementsByTagName('INPUT');
  for (var i = 0; i < c.length; i++) {

   if (c[i].type == 'checkbox') {
    if (c[i].name.substring(0,3) == 'rpt' && c[i].checked==true) {
        return true;
    }
   }
  }
  alert('No Reports selected.');
  return false;
}

function TickAll() {
  var c = new Array();
  c = document.getElementsByTagName('INPUT');

  for (var i = 0; i < c.length; i++) {
    if (c[i].type == 'checkbox') {
      if (c[i].name.substring(0,3) == 'rpt') {
        if (document.SelectPeriod.checkall.checked==true) {
          c[i].checked=true;
        } else {
          c[i].checked=false;
        }
      }
    }
  }
}

function NotCheck() {
  document.SelectPeriod.checkall.checked=false;
}

function RemoveReports() {

  var reportstat = ChechBoxReports();

  if (reportstat==true) {
    document.SelectPeriod.reportno.value="2";
    document.SelectPeriod.updttype.value="B";
    SubmitHidden(SelectPeriod);
  }
}

function showFutureDates(){
  if (document.SelectPeriod.showfutr.checked==true) {
    document.SelectPeriod.showfutr.value="1";  
    document.SelectPeriod.submit();
  } else {
    document.SelectPeriod.showfutr.value="";
    document.SelectPeriod.submit();
  }
}

function ViewReport(ScheduleNo,type) {
ViewForm.schdcode.value=ScheduleNo
if(type=="1"){
  ViewForm.template.value=3
}
if(PHPViewSpool && ViewForm.template.value=="001") {
 ViewForm.viewtype.value="1";
}
ViewWin=window.open("","ViewWindow",
"top=0,left=0,width=790,height=auto,directories=no,location=no," +
"scrollbars=yes,menubar=yes,status=no,toolbar=yes,resizable=yes")
ViewForm.target="ViewWindow"
ViewForm.submit()
ViewWin.focus();
}

function EditSchedule(ScheduleNo) {
SCHDCODE=ScheduleNo.replace(/ /g,"+")
LinkUrl="rshweb02.pbl?reportno=2&template=1&schdcode="+SCHDCODE
DFrameLink(LinkUrl,20,50,700,430)
}

function EditReport(ScheduleNo) {
SCHDCODE=ScheduleNo.replace(/ /g,"+")
LinkUrl="rshweb02.pbl?reportno=2&template=2&schdcode="+SCHDCODE
DFrameLink(LinkUrl,20,50,700,400)
}

function EditProcess(ScheduleNo) {
SCHDCODE=ScheduleNo.replace(/ /g,"+")
LinkUrl="rshweb02.pbl?reportno=2&template=3&schdcode="+SCHDCODE
DFrameLink(LinkUrl,20,50,700,400)
}

function TableSort(OrderColumn) {
 if ( lastOrderColumn == OrderColumn ) {
   if (AscDsc==1) {AscDsc=2;} else {AscDsc=1;} }
 else {
   AscDsc=1; }
 TableOutput(OrderColumn,AscDsc);
}

function InitialiseForms() {
    //no needed to set focus here!
}

//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link  
//  1 - Schedule No
//  2 - Description
//  3 - User
//  4 - Schedule Date & Time
//  5 - Started Date & Time
//  6 - Status
//---------------------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
 t = new Table(1,0,2,"100%","center",35,35);
 t.addColumn("Schedule No","String",2,2,"left","ReportIcon.gif","1",60,
             "","","",12)
 t.addColumn("Description","String",3,3,"left","EditIcon.gif","0",170,
             "","","",12)
 t.addColumn("User","String",4,4,"left","","",70,
             "","","",12)
 t.addColumn("Scheduled","DateTime",5,5,"left","","",100,
             "","","",12)
 t.addColumn("Started","DateTime",6,6,"left","","",100,
             "","","",12)
 t.addColumn("Status","String",7,7,"left","","",70,
             "","","",12)
 t.addColumn("Printer","String",9,9,"left","","",70,
             "","","",12)
 t.addColumn("Mark","String",14,14,"left","","",70,
             "","","",12) 
 AddTableRows()
 TableOutput(3,2);    // Order Column,Asc Dsc
 break; } }
}
function disCancelbtn(){
  if (document.getElementById("discancl").value=="1") {
       document.getElementById("cancbtn").disabled=false;
       document.getElementById("disCancbtn").innerHTML=
       document.getElementById("displayCanclSPAN").innerHTML;
  }
}
function getCancelCookie(){
  if (GetCookieData("rshweb0201009") != "unknown") {
    location.href=GetCookieData("rshweb0201009");
    ExpireCookiePath("rshweb0201009");
  } else {
    location.href="websec01.pbl?reportno=3&template=1"
  }
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);disCancelbtn();">
<form name=SelectPeriod id=SelectPeriod action=rshweb02.pbl method=get 
                        style="margin:0">
<div id=HeadingSection>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=9>
<input type=hidden name=delterep value=1>
<input type=hidden name=updttype value="">
<input type=hidden name=discancl id=discancl value="%RSHWEB02.01.199.010">
<input type=hidden name=showqued id=showqued value="%RSHWEB02.01.199.011">
<input type=hidden name=viewtype value="%RSHWEB02.01.006">
<table cellspacing=0 border=0 cellpadding=0 width=100% bgcolor=#cccccc>
<tr><td>
    <a href=javascript:InitTable(0)>
    <img src=../images/TableViewIcon.gif class=Icon
     alt="Default View" border=0></a>
    </td>
<td width=20%>
   User ID
  <input type=text name=fltusrid size=12 onchange="SelectPeriod.submit()"
   value="%RSHWEB02.01.163">
  </td>
  <td width=25% align=right>
  <div id=disCancbtn></div>

  <span id=NextPage></span>
  </td>

<td align=right>
  <input type=checkbox name=checkall value="0" onclick="TickAll();">
  Select all to Remove Selected Reports
  &nbsp;&nbsp;&nbsp;&nbsp;

  <input type=button value="Remove" class=button onclick="RemoveReports();">
  &nbsp;&nbsp;&nbsp;&nbsp;

  <input type=checkbox name=showfutr value="1"
     onclick="showFutureDates();">
  All Future Dates   
 
  &nbsp;&nbsp;  

  <input type=button value="<<"  class=smallbutton
  onclick='%RSHWEB02.01.008'>

  %RSHWEB02.01.005

  <input type=button value=">>" class=smallbutton 
  onclick='%RSHWEB02.01.007'>

  <a href='javascript:SelectDateFrame();'>
  <img src="../images/DateLookup.gif" border=0
   alt="Select Date" class=Icon></a>
  <a href='javascript:SelectView("0");'>
  <img src=../images/DayIcon.gif border=0
   alt="View Today" class=Icon></a>
  <a href='javascript:SelectView("1");'>
  <img src=../images/WeekIcon.gif border=0
   alt="View This Week" class=Icon></a>
  <a href='javascript:SelectView("2");'>
  <img src=../images/MonthIcon.gif border=0
   alt="View This Month" class=Icon></a>
</td></tr>
</table>
</div>
<div id=TableLocation></div>
</form>

 <span id=displayCanclSPAN style="display:none">
 <input class="button" type=button name="cancbtn" id="cancbtn"
        value="Cancel" 
        onclick="getCancelCookie();">
 </span>

<script type="text/javascript">
function AddTableRows() {
%RSHWEB02.01.002
}



ShowFutureDates="%RSHWEB02.01.022"
if(ShowFutureDates == "1") {
  document.SelectPeriod.showfutr.checked=true;
}
</script>
<form name=ViewForm method=get action=rshweb02.pbl>
<input type=hidden name=reportno value="5">
<input type=hidden name=template value="001">
<input type=hidden name=schdcode value="">
<input type=hidden name=viewtype value="0">
</form>

