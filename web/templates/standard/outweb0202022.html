<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html"> 
<meta name="CrossBrowser" content="true">
<style type="text/css">
td { vertical-align: text-top;}
img.ListIcon {
      border:0px;
      cursor:hand;
      margin-top:0px; 
      margin-bottom:2px; 
      margin-left:0px; 
      margin-right:3px; 
      vertical-align: text-top;}
</style>
<script type="text/javascript" src="../js/outweb0202.js"></script>
<script type="text/javascript" src="../js/outweb02.js"></script>
<link rel="stylesheet" media="print" href="../html/printWithHeader.css" type="text/css">
<script type="text/javascript" src="../js/outweb0202004.js"></script>
<script type="text/javascript" src="../js/outweb0202022.js"></script>
<script type="text/javascript">
function SummaryPage() {
  location.href="outweb02.pbl?reportno=1&template=5" +
                "&frstdate=" + UpdateStatus.sesskeys.value.substr(12,8) +
                "&lastdate=" + UpdateStatus.sesskeys.value.substr(12,8) 
}
function UpdateSlot(A,B,C) {
   UpdateStatus.casekeys.value=A
   LinkURL='patweb90.pbl?reportno=1&template=200'
   DFrameLink(LinkURL,25,50,700,420)
}
function InitTable(TableView) {
switch (TableView) {
  case "0": {
   t = new Table(1,0,2,"100%","center",40,45);
   t.addColumn("Time","Time",1,1,"left","AppointmentIcon.gif","Slot",50)
   t.addColumn("Type","String",34,34,"left","","",35)
   t.addColumn("U/R","String",6,6,"left","","",50)
   t.addColumn("Patient","StringPatient",5,5,"left","PatientFolder","Patient",170)
   if(document.UpdateStatus.othecpmi.value=="1") {
     t.addColumn("Confirm PMI","ButtonLinkWide",65,66,"left","","ConfirmPMI",50,"","","",91)
   }
   t.addColumn("Check- In","ButtonLink",15,-1,"left","","CheckIn",50)
   t.addColumn("Time Seen","ButtonLink",14,-1,"left","","TimeSeen",50)
   t.addColumn("Departure","ButtonLink",16,-1,"left","","Departure",50)
   t.addColumn("Follow Up","ButtonLink",20,-1,"left","","FollowUp",50)
   t.addColumn("Non Attend","ButtonLink",21,-1,"left","","NonAttend",50)
   if(document.UpdateStatus.othecenc.value=="1") {
     t.addColumn("Contacts","String",79,79,"center","","",30)
   }
   t.addColumn("Series","String",80,80,"center","","",30)
   t.addColumn("Mark","String",78,78,"left","","",30)
   AddTableRows();
   TableOutput(0,1);    // Order Column,Asc Dsc
   break; }
  }
  var bdiv = document.getElementById('BodyDivision');
  var bdivtable = bdiv.getElementsByTagName('table')[0];
  var bdivtable_height=bdivtable.clientHeight + 2;
  bdiv.style.height = bdivtable_height + "px";
}
function getClinicSearchCookie() {
  document.UpdateStatus.clinsrch.value=GetCookieData("clinicSearchPath");
  document.cookie="clinicSearchPath=;"
}
function GoClinicSearchPath() {
  if (document.UpdateStatus.clinsrch.value != "unknown" &&
      !isWhitespace(document.UpdateStatus.clinsrch.value)) {
    location.href = document.UpdateStatus.clinsrch.value;
  } else {
    GoOutpatientListSTV();
  }
}
function GetAppointmentTypeCookie() {
  var aptyckie = "";
  if (GetCookieData("AppointmentTypeCookie") != "unknown" &&
      !isWhitespace(GetCookieData("AppointmentTypeCookie"))) {
    aptyckie=GetCookieData("AppointmentTypeCookie");
    ExpireCookiePath("AppointmentTypeCookie");
    Left=(document.body.clientWidth-900)/2
    DFrameLink(aptyckie,100,Left,920,550);
  }
}
function setScannedMR() {
  if(!VariableNameExists('SetSMRFlag')) {
    return;
  }
  if(SetSMRFlag==true) {
    if(document.getElementById("scannedm")) {
      document.getElementById("scannedm").value="1";
      document.getElementById("scannedm1").value="1";
      document.getElementById("scannedm2").value="1";
      document.getElementById("scannedm3").value="1";
      document.getElementById("scannedm4").value="1";
    }
  }
}

</script>
</head>
%START.OF.PAGE
<body onload='PageLoad(event);InitTable("0");SetPageRefreshOut(90);
              getClinicSearchCookie();ShowBulkContact();
              GetAppointmentTypeCookie();setScannedMR();
              showTodayButton();'>
<div id=HeadingSection>
<form name=UpdateStatus action=outweb02.pbl method=post style="margin:0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=22>
<input type=hidden name=redirect value="">
<input type=hidden name=updatety value="">
<input type=hidden name=casekeys value="">
<input type=hidden name=sesskeys value="%OUTWEB02.02.004">
<input type=hidden name=sessupdt value="">
<input type=hidden name=bookstat value="">
<input type=hidden name=urnumber value="">
<input type=hidden name=admissno value="">
<input type=hidden name=patfname value="">
<input type=hidden name=dummyadm value="">
<input type=hidden name=dummyclm value="%STANDARD.01.017.CL">
<input type=hidden name=othecenc value="%OUTWEB02.02.051">
<input type=hidden name=othedurn value="%OUTWEB02.02.053">
<input type=hidden name=xocadoct value="%OUTWEB02.02.054">
<input type=hidden name=xocahcp1 value="%OUTWEB02.02.140.056 ">
<input type=hidden name=xocahcp2 value="%OUTWEB02.02.140.057 ">
<input type=hidden name=xocahcp3 value="%OUTWEB02.02.140.058 ">
<input type=hidden name=xocahcp4 value="%OUTWEB02.02.140.059 ">
<input type=hidden name=clinsrch value="">
<input type=hidden name=othecpmi value="%OUTWEB02.02.058">
<input type=hidden name=scannedm id=scannedm value="">
</form>

<form name=SelectPeriod action=outweb02.pbl method=get style="margin:0">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=22>
<input type=hidden name=contview value="%OUTWEB02.02.057">
<input type=hidden name=tablview value="%OUTWEB02.02.044">
<input type=hidden name=xocadoct value="%OUTWEB02.02.054">
<input type=hidden name=sesskeyt value="%OUTWEB02.02.071">
<input type=hidden name=loctoday value="%OUTWEB02.02.072">
<input type=hidden name=otcndtdy id=otcndtdy
       value="%STANDARD.01.025.032.148.1.1">

<table cellspacing=0 cellpadding=1 bgcolor=#CCCCCC border=0 width=100%>
<tr><td class=HeadingCell width=10%>
    <img src="../images/ListIcon.gif" class=Icon
     onclick='GoClinicSearchPath();'>
    <img src="../images/RefreshIcon.gif" class=Icon
     onclick='document.cookie="clinicSearchPath="+escape(document.UpdateStatus.clinsrch.value)+";";location.reload();'></td>
    <td class=HeadingCell align=center>
    Clinic for %OUTWEB02.02.014 </td>
    <td class=HeadingCell width=10%></td></tr>
</table>

<table cellspacing=0 cellpadding=1 bgcolor=#CCCCCC border=0 width=100%>
<tr><td width=10% class=DataLabel>Clinic Views</td>
    <td width=35% class=DataField>
     <select name=viewlink onchange="ViewLink(this.value);" >
      <option value=0>Bookings Details</option>
      <option value=20 selected>Bulk Process</option>
     </select></td>
    <td class=DataLabel>Date & Start Time</td>
    <td align=right>
    <span id=TodayButSpan style="display:none">
      <input type=button name=btnToday id=btnToday value="Today" class=button
       title="Switch to today's clinic"
       onclick='setTodayDate();'>
    </span>
    <input type=button value="<<" class=SmallButton
     onclick='location.href="%OUTWEB02.02.002"'>
     <select name=sesskeys onchange='document.SelectPeriod.submit();'>
      %OUTWEB02.02.003
     </select>
    <input type=button value=">>" class=SmallButton
     onclick='location.href="%OUTWEB02.02.001"'>
    </td></tr>

<tr><td class=DataLabel>Clinic Type</td>
    <td class=DataField>%OUTWEB02.02.027.0</td>
    <td class=DataLabel>Location</td>
    <td class=DataField>%OUTWEB02.02.029.0</td></tr>

<tr><td class=DataLabel>Session Status</td>
    <td class=DataField>%OUTWEB02.02.020.0</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td></tr>

<tr valign=top>
    <td class=DataLabel>Comments</td>
    <td class=DataField>
    %OUTWEB02.02.026
    <td class=DataLabel>Instructions
    </td> <td> 
    <b> %OUTWEB02.02.028</b> <br></td> </tr> 

<tr><td></td><td>
    <b>%OUTWEB02.02.021<br>
    %OUTWEB02.02.022 </b> 
    </td></tr>

</table>
</form>
</div>

<div id=TableLocation></div>

<form name=CheckInForm action=outweb02.pbl method=post style="margin:0">
<input type=hidden name=reportno value=8>
<input type=hidden name=template value=022>
<input type=hidden name=updatety value=13>
<input type=hidden name=redirect value="">
<input type=hidden name=sesskeys value='%OUTWEB02.02.004'>
<input type=hidden name=d_sessdate value='%OUTWEB02.02.063'>
<input type=hidden name=currdate value=''>
<input type=hidden name=currtime value=''>
<input type=hidden name=newsltyp value="">
<input type=hidden name=nextpage value=1>
<input type=hidden name=redirflg value="%OUTWEB02.02.136">
<input type=hidden name=wacpmich value="%OUTWEB02.02.195">
<input type=hidden name=scannedm id=scannedm1 value="">

<table cellspacing=0 cellpadding=0 border=0 width=100%>
<tr><td colspan=3><hr></td><td>
    </tr>
<tr><td class=DataLabel width=10%>Check in Time</td>
    <td class=DataField width=10%>
     <input type=text name=outbb032 id=outbb032 value="" size=8
      title="Check In Time" class="Time"
      onblur="checkTime(this,this.title);">
     <img src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTimeMin(null,CheckInForm.outbb032);">
     <img src="../images/TimeLookup.gif" class=Icon
      onclick="TimeLookupFrameMin(CheckInForm.outbb032);">
    </td>
    <td class=DataField>
     <input type=button class=button value="Bulk Check In" id=btnCheckIn
      onclick="tempDisable(this);ProcessBulkCheckIn();">
    </td></tr>
</table>

</form>

<form name=TimeSeenForm action=outweb02.pbl method=post style="margin:0">
<input type=hidden name=reportno value=8>
<input type=hidden name=template value=022>
<input type=hidden name=updatety value=18>
<input type=hidden name=redirect value="">
<input type=hidden name=sesskeys value='%OUTWEB02.02.004'>
<input type=hidden name=d_sessdate value='%OUTWEB02.02.063'>
<input type=hidden name=currdate value=''>
<input type=hidden name=currtime value=''>
<input type=hidden name=newsltyp value="">
<input type=hidden name=nextpage value=1>
<input type=hidden name=redirflg value="%OUTWEB02.02.136">
<input type=hidden name=othecenc value="%OUTWEB02.02.051">
<input type=hidden name=wacpmich value="%OUTWEB02.02.195">
<input type=hidden name=scannedm id=scannedm2 value="">
<span id=InsertTimeSeenButton>
<table cellspacing=0 cellpadding=0 border=0 width=100%>
<tr><td class=DataLabel width=10%>Time Seen</td>
    <td class=DataField width=10%>
    <input type=text name=outbb033 id=outbb033 value="" size=8
     title="Time Seen" class="Time"
     onblur="checkTime(this,this.title);">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTimeMin(null,TimeSeenForm.outbb033);">
    <img src="../images/TimeLookup.gif" class=Icon
     onclick="TimeLookupFrameMin(TimeSeenForm.outbb033);">
    </td>
    <td class=DataField>
    <input type=button class=button value="Bulk Time Seen" id=btnTimeSeen
     onclick="tempDisable(this);ProcessBulkTimeSeen();">
    </td></tr>
</table>
</span>
</form>

<form name=UpdateForm action=outweb02.pbl method=post style="margin:0">
<input type=hidden name=reportno value=8>
<input type=hidden name=template value=022>
<input type=hidden name=sesskeys value='%OUTWEB02.02.004'>
<input type=hidden name=newsltyp value="">
<input type=hidden name=otheadep value="%OUTWEB02.02.050">
<input type=hidden name=othecenc value="%OUTWEB02.02.051">
<input type=hidden name=othedurn value="%OUTWEB02.02.053">
<input type=hidden name=wacpmich value="%OUTWEB02.02.195">
<input type=hidden name=scannedm id=scannedm3 value="">
<span id=InsertContactButton style="display: none">
<table cellspacing=0 cellpadding=0 border=0 width=100% valign=top>
<tr><td class=DataLabel width=10%>&nbsp;</td>
    <td class=DataField width=10%>&nbsp;</td>
    <td class=DataField>
    <input type=button class=button value="Bulk Time Seen" id=btnEncounter
     onclick="tempDisable(this);ProcessBulkEncounter();">
    </td></tr>
</table>
</span>
</form>

<form name=DepartureForm action=outweb02.pbl method=post style="margin:0">
<input type=hidden name=reportno value=8>
<input type=hidden name=template value=022>
<input type=hidden name=updatety value=14>
<input type=hidden name=redirect value="">
<input type=hidden name=sesskeys value='%OUTWEB02.02.004'>
<input type=hidden name=newsltyp value="">
<input type=hidden name=nextpage value=1>
<input type=hidden name=redirflg value="%OUTWEB02.02.136">
<input type=hidden name=outbb034 value=" ">
<input type=hidden name=wacpmich value="%OUTWEB02.02.195">
<input type=hidden name=scannedm id=scannedm4 value="">
<table cellspacing=0 cellpadding=0 border=0 width=100% valign=top>
<tr><td class=DataLabel width=10%>&nbsp;</td>
    <td class=DataField width=10%>&nbsp;</td>
    <td class=DataField>
    <input type=button class=button value="Bulk Depart" id=btnDepart
     onclick="tempDisable(this);ProcessBulkDepart();">
    </td></tr>
</table>
</form>

<form name=BulkDNA action=outweb02.pbl method=post style="margin:0">
<input type=hidden name=reportno value=8>
<input type=hidden name=template value=022>
<input type=hidden name=updatety value=9>
<input type=hidden name=sesskeys value='%OUTWEB02.02.004'>
<input type=hidden name=redirect value=''>
<input type=hidden name=wacpmich value="%OUTWEB02.02.195">
<table cellspacing=0 cellpadding=0 border=0 width=100% valign=top>
<tr><td class=DataLabel width=10%>&nbsp;</td>
    <td class=DataField width=10%>&nbsp;</td>
    <td class=DataField>
    <input type=button class=button value="Bulk DNA" id=btnDna
     onclick="tempDisable(this);ProcessBulkDNA();">
    </td></tr>
<tr><td colspan=3><hr></td><td>
    </tr>
<tr><td colspan=4>
    Re-Appoint to New Session<br></td></tr>
</table>
</form>

<form name=FollowUpForm action=outweb02.pbl method=post style="margin:0">
<input type=hidden name=reportno value=8>
<input type=hidden name=template value=014>
<input type=hidden name=updatety value=15>
<input type=hidden name=redirect value="">
<input type=hidden name=sesskeys value='%OUTWEB02.02.004'>
<input type=hidden name=newsltyp value="">
<input type=hidden name=nextpage value=1>
<input type=hidden name=redirflg value="%OUTWEB02.02.136">
<input type=hidden name=othendps value="">
<input type=hidden name=currdate value="%STANDARD.01.015">
<input type=hidden name=d_outbb047 value="">
<input type=hidden name=cat_CV value="CV">
<input type=hidden name=d_outbb047_des value="">
<input type=hidden name=d_outbb047_ind value="">
<input type=hidden name=srchclid id=srchclid value="%OUTWEB02.02.064">
<input type=hidden name=srchclty id=srchclty value="%OUTWEB02.02.065">
<input type=hidden name=defvisty id=defvisty value="">
<input type=hidden name=srchrefn id=srchrefn value="~~~~~~~~">
<input type=hidden name=deftovrd id=deftovrd value="">
<input type=hidden name=wacpmich value="%OUTWEB02.02.195">
<input type=hidden name=d_bulkprocess value="">
<table cellspacing=0 cellpadding=0 border=0 width=100% valign=top>
<tr><td class=DataLabel>Clinic</td>
    <td><input type=text title=Clinic name=clindesc id=clindesc
         readonly size=30 class=Mandatory>
    </td></tr>
<tr><td>Session Date & Time</td>
    <td><input type=hidden name=newskeys id=newskeys>
        <input type=text name=clindate id=clindate
         title="Session date & time"
         readonly size=30 class=Mandatory>
    <img src="../images/LookupIcon.gif" class=Icon
     onclick="ResetLetter(FollowUpForm);
              ClinicSearchFrame(FollowUpForm.newskeys,
                                FollowUpForm.clindesc,
                                FollowUpForm.clindate,
                                FollowUpForm.srchclty,
                                FollowUpForm.srchclid,
                                FollowUpForm.defvisty,
                                FollowUpForm.deftovrd,
                                FollowUpForm.srchrefn);">
    </td></tr>
<tr><td class=DataLabel>Visit Type</td>
    <td class=DataField >
    <select name=outbb047 title="Visit Type" class="SelectBig Mandatory"
     onchange="SendLetter(FollowUpForm);">
    <option></option>
    </select></td>
<tr><td class=DataLabel>Print Follow Up Letter</td>
    <td><input type=checkbox name=letprt01 id=letprt01 value="1" checked
         onclick="setPrinter(this,FollowUpForm.letpsl01);">
    <td class=DataLabel>Printer</td>
    <td><select name=letpsl01 id=letpsl01 class="SelectBig Mandatory"
         title="Printer">
        <option></option>
        %STANDARD.01.001.LETTROUT.01
        </select></td></tr>
<tr><td class=DataLabel>Send Letter</td>
    <td><select name=outbb067 title="Send Letter"
         onchange="SendLetterDate(FollowUpForm);">
        <option></option>
        <option value="0">No</option>
        <option value="1">Yes</option>
        <option value="2">N/A</option>
        </select>
    </td>
    <td class=DataLabel>Generate Letter date</td>
    <td><input type=text name=outbb066 id=outbb066 size=12
         onblur="checkDate(this,'Date')" value=""
         class="Date" title="Generate Letter Date">
         <img src="../images/DateLookup.gif" class=Icon
          onclick="DateLookupFrame(FollowUpForm.outbb066);">
         <img src="../images/DateTimeStamp.gif" class=Icon
          onclick="SetCurrentDateTime(FollowUpForm.outbb066,null);">
    </td>
</tr>
<tr><td class=DataLabel>Link Referral Details</td>
    <td><input type=checkbox checked value=1 name=linkrefr
         title="Link referral details"></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    </tr>
<tr><td colspan=2 align=center>
    <input type=button value="Bulk Reappoint" class="button"
     id="brbutton" onclick="tempDisable(this);submitFoll();">
    <input type=button value=Cancel class="button" onclick="cancelFoll();">
</td></tr>
</table>
</form>

<script type="text/javascript">
function AddTableRows(){
%OUTWEB02.02.009.outweb02.03.001
}
</script>
