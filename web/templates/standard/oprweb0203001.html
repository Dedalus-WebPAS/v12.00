<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript">
function updateParent(admision,adate,atime,aclaim,acare,acarehdp,astay,
                      admpoint,expward,asrce,aclss,atype,atypin15,pthvflag,ambs,
                      expbed,postward,postbed,adstat,intdstay,disinten,
                      diagno,peaindic,emeradm,hlthfnd,hlthftbl,hlthfnmn,
                      oecbox,presill,tsrce,diagno2,clindocs,mhVisit){

   if(parent.parent.AddForm.ptcnhdps.value=="1"){
     if(atypin15=="X"){
        alert("ERROR\n\n"+document.getElementById('atypdesc').value+
              "Code not valid for Theatre Bookings")
        return;
     }
   }
   if(parent.parent.AddForm.ptcnhdps.value=="3"){
     acarehdp=acarehdp.substr(0,1).replace(/ /g,"");
     if(acarehdp!="4"&& acarehdp!="5"&& acarehdp!="8"&& acarehdp!="10"&&
        acarehdp!="6"){
        alert("Unable to use the current admission, invalid care type.")
        return;
     }
   }
  if (parent.parent.AddForm.bkrec028!=undefined) {
   for (var i =0 ; i < parent.parent.AddForm.bkrec028.length; i++) {
     if (parent.parent.AddForm.bkrec028.options[i].value.substr(0,3)==acare) {
         parent.parent.AddForm.bkrec028.selectedIndex=i } };
  }
    parent.parent.AddForm.admisnum.value=admision;
    parent.parent.AddForm.patadmdt.value=adate;
    parent.parent.AddForm.bkrec005.value=atime;
    parent.parent.AddForm.bkrec033.value=astay;
    for (var i =0 ; i < parent.parent.AddForm.patclaim.length; i++) {
     if (parent.parent.AddForm.patclaim.options[i].value.substr(0,3)==aclaim) {
         parent.parent.AddForm.patclaim.selectedIndex=i } };

    for (var i =0 ; i < parent.parent.AddForm.bokrx003.length; i++) {
     if (parent.parent.AddForm.bokrx003.options[i].value.substr(0,3)==admpoint){
         parent.parent.AddForm.bokrx003.selectedIndex=i } };

///////////////////////

   if(parent.parent.AddForm.ptcndwaw==undefined) {
     for(var i =0 ; i < parent.parent.AddForm.bokrx002.length; i++) {
      if(parent.parent.AddForm.bokrx002.options[i].value.substr(0,3)==expward){
          parent.parent.AddForm.bokrx002.selectedIndex=i } };
   } else if(parent.parent.AddForm.svhamatr!=undefined) {
       fillExpWardBed(expward,expbed);
       fillPostOpWardBed(postward,postbed);
   } else if(parent.parent.AddForm.ptcndwaw.value=="1"){
     if(parent.parent.AddForm.bkrec015!=undefined) {
       for(var i =0 ; i < parent.parent.AddForm.bkrec015.length; i++) {
       if(parent.parent.AddForm.bkrec015.options[i].value.substr(0,3)==expward){
          parent.parent.AddForm.bkrec015.selectedIndex=i 
          if(parent.parent.AddForm.bkrec018!=undefined) {
            selectOptions2('31',parent.parent.AddForm.bkrec015,parent.parent.AddForm.bkrec018);
            parent.parent.AddForm.bkrec018.value=expbed
          }
       }}
     } else {
     for(var i =0 ; i < parent.parent.AddForm.bokrx002.length; i++) {
      if(parent.parent.AddForm.bokrx002.options[i].value.substr(0,3)==postward){
         parent.parent.AddForm.bokrx002.selectedIndex=i 
        if(parent.parent.AddForm.bokrx038!=undefined) {
          selectOptions2('31',parent.parent.AddForm.bokrx002,parent.parent.AddForm.bokrx038);
            parent.parent.AddForm.bokrx038.value=postbed}
        }
      }
     }
   } else {
     for(var i =0 ; i < parent.parent.AddForm.bokrx002.length; i++) {
      if(parent.parent.AddForm.bokrx002.options[i].value.substr(0,3)==expward){
          parent.parent.AddForm.bokrx002.selectedIndex=i
        if(parent.parent.AddForm.bokrx038!=undefined) {
        selectOptions2('31',parent.parent.AddForm.bokrx002,parent.parent.AddForm.bokrx038);
          parent.parent.AddForm.bokrx038.value=expbed 
        }
      } 
     }
     if (parent.parent.AddForm.sjogpowb!=undefined) {
       for(var i =0 ; i < parent.parent.AddForm.bokrx002.length; i++) {
         if(parent.parent.AddForm.bokrx002.options[i].value.substr(0,3)==
            postward){
           parent.parent.AddForm.bokrx002.selectedIndex=i
           if(parent.parent.AddForm.bokrx038!=undefined) {
             selectOptions2('31',parent.parent.AddForm.bokrx002,
                                 parent.parent.AddForm.bokrx038);
             parent.parent.AddForm.bokrx038.value=postbed
           }
         }
       }
     }
   }

   for (var i =0 ; i < parent.parent.AddForm.opdea037.length; i++) {
     if (parent.parent.AddForm.opdea037.options[i].value.substr(0,3)==asrce) {
         parent.parent.AddForm.opdea037.selectedIndex=i
         if(parent.parent.setTransferSource!=undefined) {
            parent.parent.setTransferSource(tsrce);
         }
     } };

  if (parent.parent.AddForm.bkrec019!=undefined) {
   for (var i =0 ; i < parent.parent.AddForm.bkrec019.length; i++) {
     if (parent.parent.AddForm.bkrec019.options[i].value.substr(0,3)==aclss) {
         parent.parent.AddForm.bkrec019.selectedIndex=i } };
  }

   if (parent.parent.AddForm.operprv1!=undefined) {
      if(!isWhitespace(ambs)) {
        parent.parent.AddForm.operprv1.value=ambs
        parent.parent.AddForm.operprv1.focus();
        parent.parent.AddForm.operprv1.blur();
      }
   }

   if (parent.parent.AddForm.adstat!=undefined) {
     parent.parent.AddForm.adstat.value=adstat;
   }

   if (parent.parent.AddForm.intdstay!=undefined) {
     parent.parent.AddForm.intdstay.value=intdstay;
   }

   if (parent.parent.AddForm.disinten!=undefined) {
     parent.parent.AddForm.disinten.value=disinten;
   }

   if (parent.parent.AddForm.diagno!=undefined) {
     parent.parent.AddForm.diagno.value=diagno;
   }
   if(parent.parent.AddForm.ptcnubap!=undefined) {
     if(parent.parent.AddForm.ptcnubap.value=='5') {
        parent.parent.AddForm.operdes1.value=diagno;
        parent.parent.AddForm.operdes2.value=diagno2;
     }
   }

   if (parent.parent.AddForm.peaindic!=undefined) {
     parent.parent.AddForm.peaindic.value=peaindic;
   }

   if (parent.parent.AddForm.emeradm!=undefined) {
     parent.parent.AddForm.emeradm.value=emeradm;
   }

   if (parent.parent.AddForm.hlthfnd!=undefined) {
     parent.parent.AddForm.hlthfnd.value=hlthfnd;
   }

   if (parent.parent.AddForm.hlthftbl!=undefined) {
     parent.parent.AddForm.hlthftbl.value=hlthftbl;
   }

   if (parent.parent.AddForm.hlthfnmn!=undefined) {
     parent.parent.AddForm.hlthfnmn.value=hlthfnmn;
   }

   if (parent.parent.AddForm.ploastay!=undefined) {
     parent.parent.AddForm.ploastay.value=astay;
   } 

   if (parent.parent.AddForm.presill!=undefined) {
     parent.parent.AddForm.presill.value=presill;
   }

   if (parent.parent.AddForm.d_opdea041!=undefined) {
     if(clindocs.substr(0,1)=="1") {
       parent.parent.AddForm.d_opdea041.checked=true;
     }
   }

   if (parent.parent.AddForm.d_opdea038!=undefined) {
     if(clindocs.substr(1,1)=="1") {
       parent.parent.AddForm.d_opdea038.checked=true;
     }
   }

   if (parent.parent.AddForm.d_opdea042!=undefined) {
     if(clindocs.substr(2,1)=="1") {
       parent.parent.AddForm.d_opdea042.checked=true;
     }
   }

   if (parent.parent.AddForm.oecchbox!=undefined) {
     if (parent.parent.AddForm.bokrx039!=undefined) {
       parent.parent.AddForm.bokrx039.value=oecbox;
       if (parent.parent.AddForm.bokrx039.value=="1") {
         parent.parent.AddForm.oecchbox.checked=true;
       }
//     parent.parent.OECFields.innerHTML=parent.parent.oecfields.innerHTML;
//     parent.parent.defaultOECFields();
       parent.parent.CheckAdmis();

     } 
   }

   if (parent.parent.validateDateBookingRules!=undefined) {
     parent.parent.validateDateBookingRules();
   }
 
   if (parent.parent.AddForm.mh_visit != undefined) {
     parent.parent.setFilterMentalHealth(mhVisit);

     if (parent.parent.AddForm.bkrec019!=undefined) {
       for (var i =0 ; i < parent.parent.AddForm.bkrec019.length; i++) {
         if (parent.parent.AddForm.bkrec019.options[i].value.substr(0,3)==aclss) {
           parent.parent.AddForm.bkrec019.selectedIndex=i } };
     }

     for (var i =0 ; i < parent.parent.AddForm.opdea037.length; i++) {
       if (parent.parent.AddForm.opdea037.options[i].value.substr(0,3)==asrce) {
           parent.parent.AddForm.opdea037.selectedIndex=i
           if(parent.parent.setTransferSource!=undefined) {
             parent.parent.setTransferSource(tsrce);
           }
       }
     };

   }   

   if (parent.parent.AddForm.opdausr1==undefined) {
    SearchFrameExit();
    return;}
   if (pthvflag!="1") {
    parent.parent.AddForm.opdausr1.className="readonly";
    parent.parent.AddForm.opdausr1.disabled=true;
    }

    SearchFrameExit();
}


function fillExpWardBed(ward,bed) {

  expWard = parent.parent.AddForm.bkrec015;
  expBed = parent.parent.AddForm.bkrec018;

  for(var i =0 ; i < expWard.length; i++) {
    if(expWard.options[i].value.substr(0,3)==ward){
       expWard.selectedIndex=i;
       selectOptions2('31',expWard,expBed);
       expBed.value=bed;
    }
  }
}

function fillPostOpWardBed(ward,bed) {

  postWard = parent.parent.AddForm.bokrx002;
  postBed = parent.parent.AddForm.bokrx038;

  for(var i =0 ; i < postWard.length; i++) {
    if(postWard.options[i].value.substr(0,3)==ward){
       postWard.selectedIndex=i;
       selectOptions2('31',postWard,postBed);
       postBed.value=bed;
    }
  }
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<input type=hidden name=atypdesc id=atypdesc value="%STANDARD.01.017.A ">
<table cellspacing=0 colspan=4 border=1 width=100%>
<tr><td class=HeadingCell>Admission Date</td>
    <td class=HeadingCell>Status</td>
    <td class=HeadingCell>Doctor</td>
    <td class=HeadingCell>Care Type</td>
    <td class=HeadingCell>%STANDARD.01.017.CL</td>
    <td class=HeadingCell>%STANDARD.01.017.A </td></tr>
%OPRWEB02.03.003
</table>
