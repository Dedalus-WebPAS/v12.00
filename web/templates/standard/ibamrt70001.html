<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
// Global Vars
var ItemCnt=0;
OutputArray = new Array();
//
function ProcessReport() {
  SubmitReport(ReportForm); 
}
function SetUrEvent() {
  if (event.keyCode == 13) {  // Carriage Return
    ValidateUR();
  } else if (event.keyCode == 9) {  // Tab
    ValidateUR();
    setTimeout('document.ReportForm.URNumber.focus()',100);
  }
}
function SearchPatient() {
  p=document.ReportForm;
  PatientSearchFrame(p.d1,p.URNumber,p.d2,SendFormWait);
}
function SendFormWait() {
  p=document.ReportForm;
  URList(p.URNumber,p.d1);
  p.URNumber.value="";
  p.URNumber.focus();
}
function ValidateUR() {
  p=document.ReportForm;
  if (isWhitespace(p.URNumber.value)) { return }
  if (p.URNumber.value!="") {
    LenUR=p.URNumber.value.length
    if (LenUR < 9) {
      Count= 8 - LenUR ;
      Blanks="";
      for (i=0; i < Count;i++) { Blanks+=" ";}
      p.URNumber.value=Blanks + p.URNumber.value
    }
    validateCode(13,p.URNumber,p.d1)
  }
  if (p.d1.value!="") {
    URList(p.URNumber,p.d1);
    p.URNumber.value="";
    p.URNumber.focus();
  }
}
function RemoveRecord(RecordNo){
  OldArray=OutputArray
  OutputArray = new Array();  // Create Array to Store Rows of Table
  j=0;
  for (i=0;i<OldArray.length;i++) {
    if (i!=RecordNo) {
      repStr=new RegExp("RemoveRecord.'" + i + "'.;>")
      newStr="RemoveRecord('" + j + "');>"
      OutputArray[j]=OldArray[i].replace(repStr,newStr)
      j++
    }
  }
  OutputDivision()
}
//
//  Note don't have to increment the name of keystrNN as RSHWEB02 reads
//  the template top down and does not use the keystrNN number. It just grabs
//  every instance of the cgi on the page and save to a KEYSTR array in RSHWEB02
//
function URList(urnum,ptname) {
  if (ItemCnt>=99) {
    alert("Page Limit Reached");
    return;
  }
  for (var i=0; i < document.ReportForm.length; i++) {
    if (document.ReportForm.elements[i].name.match(/keystr01/)) {
      enterur=urnum.value.substring(0,8);
      checkey=document.ReportForm.elements[i].value.substring(0,8);
      if (enterur == checkey) {
        alert("Warning: U/R already entered!");
        document.ReportForm.URNumber.value="";
        document.ReportForm.URNumber.focus();
        return;
        break; } } }

  OutputArray[OutputArray.length] = "<tr>" +
  "<td class=DataLabel><img src=../images/DeleteIcon.gif class=Icon " +
  " onclick=RemoveRecord('" +  OutputArray.length + "');>" +
  urnum.value + "</td>" +
  "<td class=DataLabel>" + ptname.value + 
  "<input type=hidden name=keystr01 value='" + urnum.value + "'></td></tr>" 

  // See comment for keystr01 above

  OutputDivision()
}
function OutputDivision() {
  OutputString="<table width=40% align=center cellspacing=0 " +
               "cellpadding=0 border=1>" +
               "<tr><td class=HeadingCell>U/R</td>" +
               "<td class=HeadingCell>Name</td></tr>" 

  for (i=OutputArray.length - 1; i >= 0; i--) {
    OutputString+=OutputArray[i]
  }
  OutputString+="</table>"
  Results.innerHTML=OutputString;
  ItemCnt++;
}
function init() {
  setTimeout('document.ReportForm.URNumber.focus();',400);
}
</script>
</head>
<body onload="PageLoad(event);ReportLoad();">
%START.OF.PAGE
<form name=ReportForm method=post action=rshweb02.pbl style="margin:0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=001>
<input type=hidden name=updttype value="A">
<input type=hidden name=setdfprg value="IBAMRT70">
<input type=hidden name=setdfrep value="01">
<input type=hidden name=schdpgid value="IBAMRT70">    
<input type=hidden name=schddesc value="Med. Record Current Location Report">    
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="rshweb02.pbl?reportno=1&template=1">

<table width=100% align=center border=0 cellspacing=0>
<tr><td class=HeadingCell align=center colspan=2>Medical Record Current Location Report</td></tr>
<tr><td><br></td></tr>
</table>

<table width=85% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=13%>Schedule Date</td>
    <td class=DataLabel>
    <input type=text name=schddate size=12 title="Schedule Date"
    value="%STANDARD.01.015"
    onblur="checkDate(this,'Schedule Date');">
    <img notab src="../images/DateLookup.gif" class="Icon" 
     alt="Show Calendar" date="ReportForm.schddate">
    Time
    <input type=text name=schdtime size=12 title="Schedule Time"
    value="%STANDARD.01.016">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schddate" time="ReportForm.schdtime">
    <img notab src="../images/TimeLookup.gif" class="Icon" 
     alt="Time Select" time="ReportForm.schdtime">
    </td>

    <td class=DataLabel>Printer</td>
    <td><select name=schdprnt title="Printer" class=Mandatory>
        <option></option>
        %STANDARD.01.001.IBAMRT70.01
        </select>
    </td>
 
    <td class=DataLabel>Number of Copies</td>
    <td><select name=schdcopy title='Number of Copies' class=Mandatory>
        </select>
    </td>
</tr>
 
<tr><td class=DataLabel>Re-schedule Type</td> 
    <td class=DataLabel> 
    <select name=schdrdat title="Schedule Type" onchange="SetReportDates();"> 
    <option></option> 
    </select> 
    </td>
 
    <td class=DataLabel>Re-schedule Until Date</td> 
    <td class=DataLabel colspan=3> 
    <input type=text name=schdrend size=12 
     onblur="checkDate(this,'Re-schedule Until Date');"> 
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schdrend">
    <img notab src="../images/DateLookup.gif" class="Icon" 
     alt="Show Calendar" date="ReportForm.schdrend">
    </td>
</tr>

<tr><td colspan=6 align=center><hr></td></tr>

<tr><td>U/R Number</td>
    <td><input type=text name=URNumber id=URNumber size=8 maxlength=8 
         title="UR" onKeyDown="SetUrEvent();">
        <input type=hidden name=d1>
        <input type=hidden name=d2>
        <img src=../images/SearchIcon.gif class=Icon notab
         onclick="SearchPatient();">
        <img src="../images/erase.gif" class=Icon
         onClick="clrFields(URNumber);document.ReportForm.URNumber.focus();">
         
</td></tr>
</table>

<div id=Results></div>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td align=center colspan=2><br>
    <input type=hidden name=keystr04 value=" ">           
    <input type=hidden name=keystr05 value="P">
    <input type=button value=Ok class="button" onclick='ProcessReport();'>
    <input type=button value=Cancel class="button" 
     onclick='location.href="../lookups/blank.html"' >
    </td></tr>
</table>
</form>
