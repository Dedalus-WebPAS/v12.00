<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome"    content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript" src="../js/TableSort.js"></script>
<script type="text/javascript" src="../js/OutpatientTypeClinic.js"></script>
<script language=javascript>
function SetLists1() {
 p=Filter
 p.saveclin.value=p.fltrclid.value;
 p.fltrclid.options.length=1;
 SetTypeClinic(p.fltrclid,p.deftclid.value,p.usersite.value,p.fltrctyp.value);
 for (var i=0; i < p.fltrclid.length; i++) {
  if (p.fltrclid.options[i].value==p.saveclin.value){
      p.fltrclid.selectedIndex=i;
  }
 }
}
function SetLists2() {
 p=Filter
 p.fltrclid.options.length=1;
 SetTypeClinic(p.fltrclid,p.deftclid.value,p.usersite.value,p.fltrctyp.value);
}
function InitTable() {
 document.title="Referral Letter List"
//
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//

 t = new Table(1,0,1,"100%","center",25);

//
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
//

 t.addColumn("Book","String",9,9,"left","DocumentIcon.gif","0",60)
 t.addColumn("Patient","String",1,1,"left","","",110)
 t.addColumn("Date","Date",2,2,"left","","",65)
 t.addColumn("Referring Doctor","String",3,3,"left","","",100)
 t.addColumn("Clinic Type","String",4,4,"left","","",80)
 t.addColumn("Clinic","String",5,5,"left","","",80)
 t.addColumn("Priority","String",6,6,"left","","",75)
 t.addColumn("Reason","String",7,7,"left","","",70)

//
// Add Rows to Table (Output from Web Server)
//

 AddTableRows();

 t.sortTable(1,1);   // Sort in Patient order
 t.sortTable(2,0);   // Sort in reverse Date order
 TableOutput(0,0);   // Sort in Status (Unbooked/Booked) order
}

function ReferralLink(PatUR, Referral, BStatus) {
  PatientLinks.urnumber.value=PatUR;
  PatientLinks.admissno.value=Referral;
  if (BStatus == 0)  // Unbooked referral
     PatientLinkTo("outweb01.pbl",4,2,1,700,550);
  else
     PatientLinkTo("outweb01.pbl",4,4,1,750,550);
}

function FilterSubmit() {
  if (Filter.fltrclid.value > " " || Filter.fltrctyp.value > " ") {
document.Filter.clinicid.value=
document.Filter.fltrclid.options[document.Filter.fltrclid.selectedIndex].value
    Filter.submit();
  } else {
    alert("Please Enter Clinic Id or Clinic Type");
  }
}

function SetRefListPathCookie() {
  document.cookie = "RefListPath=" + escape(location.href) + ";"
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);SetRefListPathCookie();SetLists2();">
<div id=HeadingSection>
<form name=Filter action=outweb01.pbl method=get style="margin:0">
<input type=hidden name=reportno value=5>
<input type=hidden name=template value=1>
<input type=hidden name=deftclid value="%OUTWEB01.05.144.1">
<input type=hidden name=usersite value="%STANDARD.01.023">
<input type=hidden name=clinicid id=clinicid>
<input type=hidden name=saveclin id=saveclin value="">

<table cellspacing=0 cellpadding=0 border=0 width=100% bgcolor=#cccccc>
<tr><td class=DataField width=8%>Clinic Type</td>
    <td><select name=fltrctyp id=fltrctyp class=SelectBig
         onchange="SetLists1();">
         <option></option>
         %OUTWEB01.05.143.2 
        </select></td>

    <td class=DataField>Clinic Id</td>
    <td><select name=fltrclid id=fltrclid class=SelectBig title="Clinic Id">
        <option></option>
        </select></td>
    <td class=DataField>Priority</td>
    <td><select name=fltrprio id=fltrprio class=SelectBig>
        <option></option>
         %OUTWEB01.05.145.2  
        </select></td>

    <td><input type=button class="button" value="Search" 
         onclick="FilterSubmit();"></td></tr>

<tr><td class=DataField>Doctor</td>
    <td><input type=hidden name=fltrdcde id=fltrdcde title="Doctor Code" 
         value="%OUTWEB01.05.146.003">     
        <input type=text name=name_fltrdcde id=name_fltrdcde 
         readonly size=30 maxlength=30 value="%OUTWEB01.05.146.002">
        <img src="../images/SearchIcon.gif" class=Icon title="Doctor Search"
         onclick="DoctorSearchFrame(fltrdcde,name_fltrdcde);">
        <img src="../images/ClearIcon.gif" class=Icon title="Clear"
         onclick="clrFields(fltrdcde,name_fltrdcde);"></td>

    <td class=DataField>Status</td>
    <td><select class=SelectBig name=fltrstat id=fltrstat>
        <option value=" "> </option>
         %OUTWEB01.05.147
        </select></td></tr>
</table>
</form>
</div>

<div id=TableLocation></div>

<script type="text/javascript">
function AddTableRows() {
%OUTWEB01.05.142.0
}
</script>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=5>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value="">
<input type=hidden name=admissno value="">
<input type=hidden name=bookflag value="">
</form>
