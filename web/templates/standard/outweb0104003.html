<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientTypeClinic.js"></script>
<script type="text/javascript">
function SetList() {
  p=UpdateForm
  p.otrfl027.options.length=1;
  SetClinicType(p.otrfl027,p.defctype.value,p.otrfl003.value);
//
  SetList2();
}
function SetList2() {
  p=UpdateForm
  p.otrfl004.options.length=1;
  SetTypeClinic(p.otrfl004,p.deftclid.value,p.otrfl003.value,p.otrfl027.value);
}
function AddReferral() {
 Submitpage=true;
 if(!isWhitespace(UpdateForm.otrfl030.value)) {
 if (SetDateYYYYMMDD(UpdateForm.otrfl001.value) > SetDateYYYYMMDD(UpdateForm.otrfl030.value)) {
 Submitpage=false;
 alert("Date Letter Recieved must be greater than or equal to Date of Letter");
  }
 }
 if(!isWhitespace(UpdateForm.otrfl031.value)) {
 if (SetDateYYYYMMDD(UpdateForm.otrfl001.value) > SetDateYYYYMMDD(UpdateForm.otrfl031.value)) {
 Submitpage=false;
 alert("Date of Priority must be greater than or equal to Date of Letter");
  }
 }
 if(Submitpage){
  var Admissno = document.PatientLinks.admissno.value.replace(/ /g,"+");
  var Urnumber = document.PatientLinks.urnumber.value.replace(/ /g,"+");
  document.UpdateForm.redirect.value = "outweb01.pbl?reportno=4&template=7" +
           "&urnumber=" + Urnumber + "&eocrdind=0"
  document.UpdateForm.submit();
 }
}
function init()
{
  checkTextFieldStringLength(document.getElementById("otrfl006"));
}
</script>
%START.OF.PAGE
<body onload=PageLoad(event);>
<span class=DFrameTitleBar>
<img border=0 align=right src=../images/ExitIcon.gif onclick=DFrameExit()>
Add Referral
</span>
<div id=PageBodySection style="overflow: auto;">
<form name=UpdateForm action=outweb01.pbl method=post style="margin:0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value="%OUTWEB01.04.003">
<input type=hidden name=updttype value="A">
<input type=hidden name=nextpage value=5>
<input type=hidden name=defctype value="">
<input type=hidden name=deftclid value="">
<input type=hidden name=redirect value="">

<table border=0 width="100%" cellspacing="0" cellpadding="2">
<tr><td class=DataLabel>Date of Letter</td>
    <td><input name=otrfl001 type=text title="Date of Letter" size=12 
         value="%STANDARD.01.015" class="BackDate" >
        <img src=../images/DateTimeStamp.gif class="Icon"
         onclick="SetCurrentDateTime(UpdateForm.otrfl001,null);">
        <img src=../images/CalendarLookup.gif class="Icon"
         onclick="DateLookupFrame(UpdateForm.otrfl001);"></td></tr>

<tr><td class=DataLabel>Date Letter Received   </td>
    <td><input name=otrfl030 type=text title="Date Letter Received" size=12
         class="BackDate" >
        <img src=../images/DateTimeStamp.gif class="Icon"
         onclick="SetCurrentDateTime(UpdateForm.otrfl030,null);">
        <img src=../images/CalendarLookup.gif class="Icon"
         onclick="DateLookupFrame(UpdateForm.otrfl030);"></td></tr>

<tr><td class=DataLabel>Referring HCP</td>
    <td><input type=text name=otrfl002 size=12 maxlength=10
         onblur="ValidateHCP(18,0,UpdateForm.otrfl002,
                             UpdateForm.name_otrfl002);">
        <input type=text name=name_otrfl002 size=22 maxlength=30>
     <img src="../images/SearchIcon.gif" class=Icon 
     onclick="HCPSearchFrame(UpdateForm.otrfl002,UpdateForm.name_otrfl002,0);">
        <img src="../images/ViewIcon.gif" class=Icon 
         onclick="HCPViewFrame(UpdateForm.otrfl002.value);">
        <img src="../images/erase.gif" class=Icon
         onclick="clrDoc(UpdateForm.otrfl002,UpdateForm.name_otrfl002);"> 
        </td></tr>

<tr><td class=DataLabel>Preferred Site</td>
    <td class=DataField><select name=otrfl003 title="Preferred Site"
                         onchange="SetList();">
                         <option></option>
              %OUTWEB01.04.103.2 </select></td></tr>

<tr><td class=DataLabel>Clinic Type</td>
    <td class=DataField><select name=otrfl027 title="Clinic Type"
                         onchange="SetList2();">
                        <option></option>
                        </select></td></tr>

<tr><td class=DataLabel>Clinic ID</td>
    <td class=DataField><select name=otrfl004 title="Clinic ID">
                        <option></option>
                        </select></td></tr>

<tr><td class=DataLabel>Diagnosis/Problem</td>
    <td><input type=text name=otrfl006 size=50 maxlength="50" class="MaxLength"
        id="otrfl006"></td></tr>

<tr><td class=DataLabel>Priority</td> 
    <td><select name=otrfl007 class=select150 
         onchange="SetCurrentDateTime(UpdateForm.otrfl031,null);">
                         <option></option>
              %OUTWEB01.04.107.2 </select></td></tr>

<tr><td class=DataLabel>Date of Priority</td>
    <td><input name=otrfl031 type=text  size=12 title=Date class=BackDate
         onblur="checkDate(this,'Date of Priority')">
        <img src=../images/DateTimeStamp.gif class="Icon"
         onclick="SetCurrentDateTime(UpdateForm.otrfl031,null);">
        <img src=../images/CalendarLookup.gif class="Icon"
         onclick="DateLookupFrame(UpdateForm.otrfl031);"></td></tr>

<tr><td colspan=2 align=center>
    <input class="button"  type="button" value="Ok" onclick="AddReferral();">
    <input class="button"  type="button" value="Cancel"
     onclick="DFrameExit();"></td></tr>
</table>
</form>
</div>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%OUTWEB01.04.003">
<input type=hidden name=admissno value="%OUTWEB01.04.081">
<input type=hidden name=MenuType value="%OUTWEB01.04.088">
</form>
<script type="text/javascript">
 UserSite="%STANDARD.01.023";
 for (var i =0 ; i < document.UpdateForm.otrfl003.length; i++) {
  if (document.UpdateForm.otrfl003.options[i].value==UserSite.substr(0,6)) {
       document.UpdateForm.otrfl003.selectedIndex=i } };
  SetList();
</script>
