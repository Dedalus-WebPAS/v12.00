<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome"    content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript" src="../js/outweb0202.js"></script>
<script type="text/javascript">
function submitFoll() {
  if (validateMandatory(UpdateForm)) {
    ShowWaitScreen();
    setTimeout('HideWaitScreen();',5000);         // 5 seconds
    UpdateForm.redirect.value="outweb02.pbl?reportno=2&template=14" +
    "&sesskeys=" + UpdateForm.sesskeys.value.replace(/ /g,"+") +
    "&redirflg=" + UpdateForm.redirflg.value.replace(/ /g,"+");
    UpdateForm.submit();
  }
}
function cancelFoll() {
   if(UpdateForm.redirflg.value=="1") {
     location.href="../cgi-bin/outweb02.pbl?reportno=2&template=011&sesskeys="+
                      UpdateForm.sesskeys.value.replace(/ /g,"+");
   } else {
     location.href="../cgi-bin/outweb02.pbl?reportno=2&template=4&sesskeys="+
                      UpdateForm.sesskeys.value.replace(/ /g,"+");
   }
}
function ViewLink(OptionLink) {
 switch (OptionLink) {
  case "0":
   {
   if(UpdateForm.redirflg.value=="1") {
     location.href="../cgi-bin/outweb02.pbl?reportno=2&template=011&sesskeys="+
                      UpdateForm.sesskeys.value.replace(/ /g,"+");
   } else {
     location.href="../cgi-bin/outweb02.pbl?reportno=2&template=4&sesskeys="+
                      UpdateForm.sesskeys.value.replace(/ /g,"+");
   }
   break;
   }
  case "1":
   {
   location.href="../cgi-bin/outweb02.pbl?reportno=2&template=12&sesskeys="+
                    SelectPeriod.sesskeys.value.replace(/ /g,"+");
   break;
   }
 }
}
function setPrinter(CheckBox,SelectList) {
  if (CheckBox.checked) {
    SelectList.className="SelectBig Mandatory"; }
  else {
    SelectList.className="SelectBig"; }
}
function SendLetterDate(theForm) {
  if(theForm.outbb067.value=="1") {                // Yes Send Letter
    theForm.outbb066.className="Mandatory FutureDate";
    theForm.outbb066.readOnly=false;
    if(isWhitespace(theForm.outbb066.value)) {     // Calculate Letter Date
      CalculateLetterDate(theForm)
    }
  } else {
    theForm.outbb066.className="Readonly Date";
    theForm.outbb066.value="";
    theForm.outbb066.readOnly=true;
  }
}
function CalculateLetterDate(theForm) {
  theForm.outbb066.value=theForm.clindate.value.substr(4,11);
  if(isWhitespace(theForm.clindate.value.substr(4,11))) {
    return;
  }
  AddSubtractDate(theForm.outbb066,theForm.othendps.value,"S");
  if(SetDateYYYYMMDD(theForm.outbb066.value) <=
     SetDateYYYYMMDD(theForm.currdate.value)) {
     theForm.outbb066.value=theForm.currdate.value;
  }
}
function ResetLetter(theForm) {
    theForm.outbb067.selectedIndex=0;
    theForm.outbb066.value="";
    theForm.outbb066.readOnly=false;
    theForm.outbb066.className="Date";
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);showTodayButton();">
<form name=SelectPeriod action=outweb02.pbl method=get style="margin:0">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=14>
<input type=hidden name=redirflg value="%OUTWEB02.02.136">
<input type=hidden name=sesskeyt value="%OUTWEB02.02.071">
<input type=hidden name=loctoday value="%OUTWEB02.02.072">
<input type=hidden name=otcndtdy id=otcndtdy
       value="%STANDARD.01.025.032.148.1.1">

<table cellspacing=0 cellpadding=1 bgcolor=#CCCCCC border=0 width=100%>
<tr><td class=HeadingCell align=center colspan=4>
    Clinic for %OUTWEB02.02.006  </td></tr>

<tr><td width=10% class=DataLabel>Views</td>
    <td width=35% class=DataField>
     <select onchange="ViewLink(this.value);" class=SelectMed>
      <option value=0>Bookings Details</option>
      <option value=1 selected>Bulk Follow Up</option>
     </select>
    </td>
    <td class=DataLabel>
    Date & Start Time</td>
    <td align=right>
    <span id=TodayButSpan style="display:none">
      <input type=button name=btnToday id=btnToday value="Today" class=button
       title="Switch to today's clinic"
       onclick="setTodayDate();">
    </span>
    <input type=button value="<<" class=SmallButton
     onclick='location.href="%OUTWEB02.02.002"'>
    <select name=sesskeys onchange='document.SelectPeriod.submit();'>
     %OUTWEB02.02.003
    </select>
    <input type=button value=">>" class=SmallButton
     onclick='location.href="%OUTWEB02.02.001"'>
    </td>
</tr>

<tr><td width=10% class=DataLabel>Clinic Type</td>
    <td width=35% class=DataField>%OUTWEB02.02.027.0</td>
    <td class=DataLabel>Location</td>
    <td class=DataField>%OUTWEB02.02.029.0</td>
</tr>

<tr><td class=DataLabel>Session Status</td>
    <td class=DataField>%OUTWEB02.02.020.0</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td></tr>

<tr valign=top>
    <td class=DataLabel>Comments</td>
    <td class=DataField>
    %OUTWEB02.02.026
    <td class=DataLabel>Instructions
    </td> <td>
    <b> %OUTWEB02.02.028</b> <br></td> </tr>

    <tr><td></td><td>
    <b>%OUTWEB02.02.021<br>
    %OUTWEB02.02.022 </b>
    </td></tr>

</table>
</form>

<div id=PageBodySection>

<form name=UpdateForm action=outweb02.pbl method=post style="margin:0">
<input type=hidden name=reportno value=8>
<input type=hidden name=template value=014>
<input type=hidden name=updatety value=15>
<input type=hidden name=redirect value="">
<input type=hidden name=sesskeys value="%OUTWEB02.02.004">
<input type=hidden name=newsltyp value="">
<input type=hidden name=nextpage value=1>
<input type=hidden name=redirflg value="%OUTWEB02.02.136">
<input type=hidden name=othendps value="">
<input type=hidden name=currdate value="%STANDARD.01.015">
<input type=hidden name=d_outbb047 value="">
<input type=hidden name=cat_CV value="CV">
<input type=hidden name=d_outbb047_des value="">
<input type=hidden name=d_outbb047_ind value="">
<input type=hidden name=srchclid id=srchclid value="%OUTWEB02.02.064">
<input type=hidden name=srchclty id=srchclty value="%OUTWEB02.02.065">
<input type=hidden name=defvisty id=defvisty value="">
<input type=hidden name=srchrefn id=srchrefn value="~~~~~~~~">
<input type=hidden name=deftovrd id=deftovrd value="">

<table width=100% border=1 cellspacing=0 >
<tr><td align=right class=HeadingCell>Slot</td>
    <td align=center class=HeadingCell>Time</td>
    <td class=HeadingCell>Visit Type</td>
    <td class=HeadingCell>Patient</td>
    <td class=HeadingCell>Special Arrangement</td>
    <td class=HeadingCell>Check-In</td>
    <td class=HeadingCell>Time-Seen</td>
    <td class=HeadingCell>Departure</td>
    <td align=center class=HeadingCell>Mark</td></tr>
%OUTWEB02.02.048
</table>

<table width=100% border=0 cellspacing=0 >
<tr><td colspan=2 class=HeadingCell align=center>
    Re-Appoint to New Session</td></tr>
</table>
<table width=90% align=center border=0 cellspacing=0 >
<tr><td class=DataLabel>Clinic</td>
    <td><input type=text title=Clinic name=clindesc id=clindesc 
         readonly size=30 class=Mandatory>
    </td></tr>
<tr><td>Session Date & Time</td>
    <td><input type=hidden name=newskeys id=newskeys>
        <input type=text name=clindate id=clindate title="Session date & time" 
         readonly size=30 class=Mandatory>
    <img src="../images/LookupIcon.gif" class=Icon
     onclick="ResetLetter(UpdateForm);
              ClinicSearchFrame(UpdateForm.newskeys,
                                UpdateForm.clindesc,
                                UpdateForm.clindate,
                                UpdateForm.srchclty,
                                UpdateForm.srchclid,
                                UpdateForm.defvisty,
                                UpdateForm.deftovrd,
                                UpdateForm.srchrefn);">
     </td></tr>
<tr><td class=DataLabel>Print Follow Up Letter</td>
    <td><input type=checkbox name=letprt01 id=letprt01 value="1" checked 
         onclick="setPrinter(this,UpdateForm.letpsl01);">
    <td class=DataLabel>Printer</td>
    <td><select name=letpsl01 id=letpsl01 class="SelectBig Mandatory"
          title="Printer">
        <option></option>
        %STANDARD.01.001.LETTROUT.01
        </select></td></tr>
<tr><td class=DataLabel>Send Letter</td>
    <td><select name=outbb067 title="Send Letter"
         onchange="SendLetterDate(UpdateForm);">
         <option></option>
         <option value="0">No</option>
         <option value="1">Yes</option>
         <option value="2">N/A</option>
        </select>
    </td>
    <td class=DataLabel>Generate Letter date</td>
    <td><input type=text name=outbb066 id=outbb066 size=12
          onblur="checkDate(this,'Date')" value=""
          class="Date" title="Generate Letter Date">
         <img src="../images/DateLookup.gif" class=Icon
          onclick="DateLookupFrame(UpdateForm.outbb066);">
         <img src="../images/DateTimeStamp.gif" class=Icon
          onclick="SetCurrentDateTime(UpdateForm.outbb066,null);">
    </td>
</tr>
<tr><td class=DataLabel>Link Referral Details</td>
    <td><input type=checkbox checked value=1 name=linkrefr
         title="Link referral details"></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    </tr>
<tr><td colspan=2 align=center>
    <input type=button value="Ok" class=button id=btnOk 
     onclick="submitFoll();">
    <input type=button value=Cancel class="button" onclick="cancelFoll();">
</td></tr>
</table>
</form>
</div>

<span id=WaitBoxDisplay class=WaitBox style="display:none">
<img class=WaitImage src="../images/wait.gif">
<p>Please Wait ...</p>
</span>

<div id=PageLayer class=DimmedLayer style="display:none"></div>
