<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script language=javascript src="../js/TableSort.js"></script>
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientTypeClinic.js"></script>
<script type="text/javascript" src="../js/outweb0808.js"></script>
<script language="Javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//---------------------------------------------------------------------------
function InitTable(TableView) {
  document.title="Appointment Action List";

  var p = document.SelectPeriod;

  switch (TableView) {
    case 0: {
      t = new Table(1,0,2,"100%","center",35,45);

      if (p.ptcolumn.value == "1") {
        t.addColumn("Action Date","Date",12,12,"left","","",30)
        t.addColumn("Referral Date","Date",1,1,"left","","",30)
        t.addColumn("Clinic Type","String",3,3,"left","","",50)
        t.addColumn("Clinic Id","String",4,4,"left","","",50)
        t.addColumn("Visit Type","String",5,5,"left","","",40)
        t.addColumn("Presenting Complaint","String",13,13,"left","","",50)
        t.addColumn("Priority","String",6,6,"left","","",30)
        t.addColumn("List Days","String",7,7,"left","","",20)
        t.addColumn("Preferred Date","Date",11,11,"left","","",30)
        t.addColumn("Appt. Status","String",9,9,"left","AppointmentIcon.gif","10",50)
      } else {
        t.addColumn("Action Date","Date",12,12,"left","","",50)
        t.addColumn("Referral Date","Date",1,1,"left","","",60)
        t.addColumn("Clinic Type","String",3,3,"left","","",50)
        t.addColumn("Clinic Id","String",4,4,"left","","",50)
        t.addColumn("Visit Type","String",5,5,"left","","",50)
        t.addColumn("Priority","String",6,6,"left","","",50)
        t.addColumn("List Days","String",7,7,"left","","",30)
        t.addColumn("Preferred Date","Date",11,11,"left","","",50)
        t.addColumn("Appt. Status","String",9,9,"left","AppointmentIcon.gif","10",50)
      }

      AddTableRows()
      TableOutput(1,1);    // By Date Order Column,Asc Dsc
      break;
    }
  }
}
function PageSubmit() {
  if(validateMandatory(SelectPeriod)) {
    document.SelectPeriod.searchfl.value="1";
    SelectPeriod.submit();
  }
}
function SetList() {
  p=SelectPeriod
  p.filtctyp.options.length=1;

  if(isWhitespace(p.filtdept.value)) {
    SetClinicType(p.filtctyp,p.defctype.value,p.filtsite.value);
  } else {
    DeptClinicType(p.filtdept,p.filtsite,p.filtctyp,p.defctype)
  }
//
  SetList2();
}
function SetList2() {
  p=SelectPeriod
  p.filtclid.options.length=1;
  SetTypeClinic(p.filtclid,p.deftclid.value,p.filtsite.value,p.filtctyp.value);
}
function switchOffMultHosp() {
    var multiHospParam = document.SelectPeriod.ibcnmhos.value;
    var filthosp = document.getElementById('filthosp');
    var n_filthosp = document.getElementById('n_filthosp');
    var blankHospital=true;
    if(VariableNameExists('OPActionListUsesHospital')) {
      if(OPActionListUsesHospital==true) {
        blankHospital=false;  // Retain default hospital
      }
    }
    if ( multiHospParam.replace(/ /g,"")  != "1" ) {
        filthosp.style.display = "none";
        filthosp.className = "";
        if(blankHospital) {
          filthosp.selectedIndex=0;
        }
        n_filthosp.style.display = "none";
    }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);SetList(); switchOffMultHosp();">
<div id="HeadingSection">
<div id="PageHeadingSection">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OUTWEB08.08.003";
PatientVIS="%OUTWEB08.08.081";
PatientNAM="%OUTWEB08.08.002";
PatientSTA="%OUTWEB08.08.086.078";
PatientALT="%OUTWEB08.08.084";
PatientSEX="%OUTWEB08.08.019";
PatientDOB="%OUTWEB08.08.020";
PatientAGE="%OUTWEB08.08.021";
PatientLOC="%OUTWEB08.08.083";
PatientPRI="%OUTWEB08.08.086.066.1";
PatientUNT="%OUTWEB08.08.066.0";
DoctorCOD="%OUTWEB08.08.082.003";
DoctorNAM="%OUTWEB08.08.082.002";
PatientAID="%OUTWEB08.08.086.090";
PatientIND="%OUTWEB08.08.086.091";
PatientCUR="%OUTWEB08.08.086.092";
PatientCLC="%OUTWEB08.08.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OUTWEB08.08.086.094";
PatientCDM="%OUTWEB08.08.086.095";
PatientVDH="%OUTWEB08.08.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
</div>

<form name=SelectPeriod method=get action=outweb08.pbl style="margin:0">
<input type=hidden name=reportno value=8>
<input type=hidden name=template value=005>
<input type=hidden name=urnumber value="%OUTWEB08.08.003">
<input type=hidden name=admissno value="%OUTWEB08.08.081">
<input type=hidden name=showflag value="1">
<input type=hidden name=searchfl value="0">
<input type=hidden name=defctype value="%OUTWEB08.08.308">
<input type=hidden name=deftclid value="%OUTWEB08.08.310">
<input type=hidden name=ptcolumn id=ptcolumn value="%OUTWEB08.08.327">
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">

<table width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td class=HeadingCell id="n_filthosp">Hospital<br>
    <select name=filthosp id="filthosp"title="Hospital"
     class="Mandatory SelectBig">
    <option></option>
    %OUTWEB08.08.305
    </select>
    </td>
    <td class=HeadingCell>Department<br>
    <select name=filtdept title="Department" class=" SelectBig"
     onchange="SetList();">
    <option></option>
    %OUTWEB08.08.307
    </select>
    </td>
    <td class=HeadingCell>Preferred Site<br>
    <select name=filtsite title="Preferred Site" class="Mandatory"
     onchange="SetList();">
    %OUTWEB08.08.306
    </select>
    </td>
    <td class=HeadingCell>Clinic Type<br>
    <select name=filtctyp title="Clinic Type"
     onchange="SetList2();">
    <option></option>
    </select>
    </td>
    <td class=HeadingCell colspan=2>Clinic Id<br>
    <select name=filtclid title="Clinic ID">
    <option></option>
    </select>
    </td>
    </tr>

<tr><td class=HeadingCell>Priority<br>
    <select name=filtprty title="Priority" class="SelectBig">
    <option></option>
    %OUTWEB08.08.309.2
    </select>
    </td>
    <td class=HeadingCell>Appointment Action Status<br>
    <select class=SelectBig name=filtstat>
    <option value=" ">All</option>
    <option value="0">Requested</option>
    <option value="1">Pending Reschedule</option>
    <option value="2">Booked</option>
    <option value="3">Cancelled</option>
    </select>
    </td>
    <td class=HeadingCell>Include Suspended Appointments<br>
    <input type=checkbox name=inclsusp value="1">
    </td>
    <td class=HeadingCell>Include Waiting Referrals<br>
    <input type=checkbox name=inclwait value="1">
    </td>
    <td class=HeadingCell>
    <input type=button class=button value="Search"
     onclick="PageSubmit();"></td>
    </tr>
</table>
</form>
</div>

<div id=TableLocation></div>
<script language="Javascript">
function AddTableRows() {
%OUTWEB08.08.323
%OUTWEB08.08.324
%OUTWEB08.08.325
}
</script>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=01>
<input type=hidden name=template value=002>
<input type=hidden name=urnumber value="%OUTWEB08.08.003">
<input type=hidden name=admissno value="%OUTWEB08.08.081">
</form>

<script type="text/javascript">
//
 StatusFilter="%OUTWEB08.08.302";
 for(var i =0 ; i < document.SelectPeriod.filtstat.length; i++) {
  if(document.SelectPeriod.filtstat.options[i].value==StatusFilter.substr(0,1)){
       document.SelectPeriod.filtstat.selectedIndex=i } };
//
 IncSuspended="%OUTWEB08.08.304";
 if(IncSuspended=="1") {
   document.SelectPeriod.inclsusp.checked=true;
 }
//
 IncWait="%OUTWEB08.08.311";
 if(IncWait=="1") {
   document.SelectPeriod.inclwait.checked=true;
 }
//
</script>
