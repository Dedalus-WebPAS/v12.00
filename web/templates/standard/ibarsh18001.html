<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js">
<script type="text/javascript">

function ProcessReport(){
  SubmitReport(rf);
}
</script>
</head>

%START.OF.PAGE
<body onload="PageLoad(event);ReportLoad();">

<form name="ReportForm" method="post" action="rshweb02.pbl" 
 enctype="multipart/form-data">
<input type="hidden" name="reportno" value="4">
<input type="hidden" name="template" value="001">
<input type="hidden" name="updttype" value="A">
<input type="hidden" name="setdfprg" value="IBARSH18">
<input type="hidden" name="schdpgid" value="IBARSH18">    
<input type="hidden" name="schddesc" value="Create Storage Location">
<input type="hidden" name="nextpage" value="1">
<input type="hidden" name="redirect" value="rshweb02.pbl?reportno=1&template=1">
<input type="hidden" name="setdfrep" value="01">
<input type=hidden name=keystr01 value="1">
<input type=hidden name=keystr02 value="Y">

<table width=100% align=center border=0 cellspacing=0>

  <tr>
    <td class=HeadingCell align=center colspan=2>
      Create Storage Location
    </td>
  </tr>
  <tr>
    <td>

      <table width=80% align=center border=0 cellspacing=2 cellpadding=1>
        <tr>
          <td class=DataLabel width=18%>Schedule Date</td>
          <td class=DataLabel>
            <input type=text name=schddate id=schddate
             size=12 title="Schedule Date"
             value="" onblur="checkDate(this,'Schedule Date');setSubDir();">
            <img notab src="../images/DateLookup.gif" date="ReportForm.schddate" 
             alt="Show Calendar" style="position:relative;top:2;" class="Icon">
            <font style="position:relative;top:-2;">
              &nbsp;&nbsp;&nbsp; Time &nbsp;&nbsp;&nbsp;
            </font>
            <input type=text name=schdtime id=schdtime
             size=8 title="Schedule Time"
             value="">
            <img notab src="../images/DateTimeStamp.gif" alt="Current" 
             class="Icon" date="ReportForm.schddate" time="ReportForm.schdtime">
            <img notab src="../images/TimeLookup.gif" class="Icon" 
             alt="Time Select" time="ReportForm.schdtime">
          </td>
        </tr>

        <tr>
          <td class=DataLabel>Printer</td>
          <td>
            <select name=schdprnt id=schdprnt title="Printer" class=Mandatory>
              <option></option>
               %STANDARD.01.001.IBARSH18.01
            </select>
            <input type="hidden" name="schdcopy" id="schdcopy" value="">
          </td>
        </tr>


        <tr>
          <td class=DataLabel>Re-schedule Type</td> 
          <td class=DataLabel> 
            <select name=schdrdat id=schdrdat title="Schedule Type" 
             onchange="SetReportDates();"> 
              <option></option> 
            </select> 
          </td>
        </tr> 
 
        <tr>
          <td class=DataLabel>Re-schedule Until Date</td> 
          <td class=DataLabel> 
            <input type=text name=schdrend size=12 id="schdrend"
             onblur="checkDate(this,'Re-schedule Until Date');"> 
            <img notab src="../images/DateLookup.gif" class="Icon" 
             alt="Show Calendar" date="ReportForm.schdrend">
            <img notab src="../images/DateTimeStamp.gif" class="Icon"
             alt="Current" date="ReportForm.schdrend">
          </td>
        </tr>

        <tr>
          <td colspan=2 align=center>
            <hr width=100%>
          </td>
        </tr>
 
        <tr>
          <td class=DataLabel>Default Storage Location</td>
          <td>
            <input name=defstloc title="Default Storage Location" type=text 
             class="ReadOnly" value="%STANDARD.01.025.091.219.0.4" readonly 
             size=51 id=defstloc>
          </td>
        </tr>

        <tr>
          <td class=DataLabel>Default Path for the Storage Location</td>
          <td>
            <input name=pthstloc title="Default Path for the Storage Location"
             type=text class="ReadOnly" value="%RSHWEB02.01.017"  readonly
             size=51 id=pthstloc>
          </td>
        </tr>

        <tr>
          <td class=DataLabel align=right>
            Year &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          </td>
          <td>
            <input name=yearpath title="Year" value="" type=text 
             class="ReadOnly" id="yearpath"
             size=4 readonly>
                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Month &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input name=mnthpath title="Month" value="" type=text
             class="ReadOnly" id=mnthpath
             size=2 readonly>
          </td>
        </tr>

        <tr>
          <td colspan=2>
            <br>
            <hr width=100% size=5px color="#A60000">            
            This report will create a new storage location in increments of 
            (001,002,003 ... n) based upon the schedule date. This report can
            be run for the first day of a month to create the path. This report
            will execute a commandline call which will create the directories
            based on the year and month added as variables to the default 
            storage path. The controlf file will be updated to reflect the new 
            storage location.
            <br>
            <hr width=100% size=5px color="A60000">
          </td>
        </tr>

        <tr>
          <td align=center colspan=2>
            <br>
            <br>
            <input type=button value=Ok class="button" 
             onclick='SubmitReport(ReportForm);'>
            <input type=button value=Cancel class="button" 
             onclick='location.href="../lookups/blank.html"' >
          </td>
        </tr>

      </table>

    </td>
  </tr>
</table>

</form>

<div id=SetDateRange style="display:none;">
  <input type=text size=15 maxlength=12 name=datran02 title="Date"
   id=datran02
   onblur="checkDate(this,'Date')" class="Mandatory PastDate">
  <img notab src="../images/DateTimeStamp.gif" class="Icon" alt="Current"
   date="ReportForm.datran02">
  <img notab src="../images/DateLookup.gif" class="Icon" alt="Calendar" 
   date="ReportForm.datran02">
</div>

<div id=SetScheduleRange style="display:none;">
  <select name=datsch01 title="Schedule Range" class=Mandatory
   id=datsch01
   onblur="UpReportSchedule(this,ReportForm.SampleFrom,ReportForm.keystr01)">
    <option></option>
  </select>

  Sample 
  <input type=hidden name=SampleFrom id=SampleFrom size=12> 
  <input type=text name=SampleTo id=SampleTo size=12>
</div>

<script type="text/javascript">
rf = document.ReportForm;

function setSubDir(){

  var m = new Date(rf.schddate.value).getMonth();

  if(rf.schddate.value!="" && !isNaN(m)){
    rf.yearpath.value = rf.schddate.value.substring(7);
    rf.mnthpath.value = m + 1; // Jan=0, Dec=11 so add 1
  }
}
</script>
