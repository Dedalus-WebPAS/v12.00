<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src=../js/cliweb08.js></script>
<script type="text/javascript">
function SetDSS() {
    if (isWhitespace(AddForm.corsp003.value.substr(14,4))) {
      AddForm.corsp003.value=""
      alert("Document Type not Valid for Result") }
    else {
      AddForm.reslnk03.value=AddForm.corsp003.value.substr(14,4) }
}
function SetProvider() {
    if (isWhitespace(AddForm.reslnk06.value)) {
      AddForm.reslnk06.value=AddForm.corsp009.value }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
<script language=javascript>document.write("<i>Patient : %CLIWEB08.01.002 (%CLIWEB08.01.019 Age"+
"%CLIWEB08.01.021 U/R %CLIWEB08.01.003)</i>");</script>
</span>
<form name=AddForm enctype="multipart/form-data" 
 method=post action="cliweb08.pbl">
  <input type=hidden name=reportno value="1">
  <input type=hidden name=template value="1">
  <input type=hidden name=urnumber value="%CLIWEB08.01.003">
  <input type=hidden name=admissno value="%CLIWEB08.01.103">
  <input type=hidden name=nextpage value="0">
  <input type=hidden name=updttype value="I">

<table align=center width=100% border=0>
<tr><td class=DataLabel>Result Date</td>
    <td><input type="text" name="corsp002" size="12" value="%CLIWEB08.01.104"
         maxlength="11" onblur="checkDate(this,'Date')" 
         class="Mandatory PastDate">
       <img notab src="../images/DateLookup.gif" class="Icon"
        alt="Calendar" date="AddForm.corsp002"></td>

<tr><td class=DataLabel>Result Time</td>
    <td><input type="text" name="corsp004" size="08"
         onblur="checkTime(this,'Time')" class="Mandatory" title="Result Time">
       <img notab src="../images/DateTimeStamp.gif" class="Icon"
        alt="Current" date="AddForm.corsp002" time="AddForm.corsp004">
       <img notab src="../images/TimeLookup.gif" class="Icon"
        alt="Select Time" time="AddForm.corsp004"></td>

<tr><td class=DataLabel>Document Type</td>
    <td><select name=corsp003 title="Document Type" onchange="SetDSS();"
        class="Mandatory select150">
        <option></option>
        %CLIWEB08.01.107.2
        </select></td></tr>

<input type=hidden name=reslnk03 title="Diagnostic Service" >
<input type=hidden name=reslnk04 title="Result Status" value="F     ">
<!-- DSS to default from Document Type HCS Equiv Field.
<tr><td class=DataLabel>Diagnostic Service</td>
    <td><select name=reslnk03 title="Diagnostic Service" 
        class="Mandatory select150">
        <option></option>
        CLIWEB08.01.128.0074
        </select></td></tr>

<tr><td class=DataLabel>Result Status</td>
    <td><select name=reslnk04 title="Result Status" 
        class="Mandatory select150">
        <option></option>
        CLIWEB08.01.128.0123
        </select></td></tr>
-->

<tr><td class=DataLabel>Result Outcome </td>
    <td><select name=reslnk05 title="Result Outcome" 
        class="Mandatory select150">
        <option value=2>Undefined</option>
        <option value=1>Normal</option>
        <option value=0>Abnormal</option>
        </select></td></tr>
<!--
<tr><td class=DataLabel>From</td>
    <input type=hidden name=dummycod>
    <td><input type=text name=corsp009 size=35>
         <img src=../images/SelectLink.gif border=0 
         onclick="LookupPage(dummycod,corsp009,'Lookup_corr0000_000')">
    </td></tr>

<tr><td class=DataLabel>To</td>
    <td><input type=text name=corsp010 size=35>
         <img src=../images/SelectLink.gif border=0 
         onclick="LookupPage(dummycod,corsp010,'Lookup_corr0000_000')">
    </td></tr>
-->

<tr valign=top id="cmrcheck">
<tr>

<tr valign=top><td class=DataLabel>Reference </td>
    <td><input type=text name=reslnk07 size=20 class=Mandatory
         title="Reference" id="reslnk07"></td></tr>

<tr valign=top><td class=DataLabel>Comment</td>
    <td><input type=text name=corsp007 size=50 
         title="Result Description"></td></tr>

<tr><td class=DataLabel>Result Document</td>
    <td><input type=file size=35 name=corsp001 class=Mandatory
         title="Document File Name"></td></tr>

<tr><td colspan=2 align=center>
    <input type=button value="Add" class="button" onclick="SubmitForm()">
    <input type=button value="Close" class="button"
     onclick="DFrameCloseRefresh()"></td></tr>

</table>
</form>
<table style="display:none">
<tr id="cMRL" style="display: none;"><td class="DataLabel">Laboratory </td>
    <td><select  name="reslnk08" id="reslnk08" title="Laboratory">
        <option value=" ">All</option>
        %CLIWEB08.01.202
    </td>
</tr>
<table>
<script>
for (var i =0; i < document.AddForm.corsp003.length; i++) {
  if (document.AddForm.corsp003.options[i].value.substr(8,1)=='D') {
       document.AddForm.corsp003.selectedIndex=i }
}
function cliManualResultCheck()
{
  if((!VariableNameExists('CLIManualResultProviderLaboratory'))||
     (!VariableNameExists('CLIManualResultReferenceMand'))
    ){
    return;
  }
  var cMRPL=document.getElementById('cmrcheck');
  if(CLIManualResultProviderLaboratory=='P' )
  {
    var cMRPLBody='<td class="DataLabel">Provider </td>'+
                  '<td><input type="text" name="reslnk06"'+
                       'size="25" class="Mandatory" title="Reference">'+
                  '</td>';
    cMRPL.innerHTML=cMRPLBody;
  }
  if(CLIManualResultProviderLaboratory=='L')
  {
    var cMRL=document.getElementById('cMRL').innerHTML;
    cMRPL.innerHTML=cMRL;
    document.getElementById('reslnk08').classList.add("Mandatory");
  }
  if(CLIManualResultReferenceMand==false) {
    document.getElementById('reslnk07').className=
    document.getElementById('reslnk07').className.replace("Mandatory",""); 
  } else { 
    document.getElementById('reslnk07').classList.add("Mandatory");
  }
}
cliManualResultCheck();
</script>
