<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"></script>
<script type="text/javascript" src="../js/MrtLocations.js"></script>
<script type="text/javascript" src="../js/MrtMultiLocations.js"></script>
<script type="text/javascript" src="../js/MrtLocationsAll.js"></script>
<script type="text/javascript" src="../js/MrtMultiLocationsAll.js"></script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link
//  1 - Patient Name (UR) Age Sex
//  2 - Movement Date & Time
//  3 - Due Date
//  4 - Home Location
//  5 - Destination
//  6 - Receiver
//  7 - Movement Reason
//  8 - Operator Id
//  9 -
// 10 - Movement Comment
// 11 - Patient Folder Link
// 12 - Receipt Status
// 13 - Receipt Date
// 14 - Received by
// 15 - Requested by
//---------------------------------------------------------------------------
function LimitReached() {
 alert("Limit Reached")
}
function InitTable(TableView) {
document.title="Medical Record Movements"
switch (TableView) {
case 0: {
 if(SelectPeriod.mrcntrec.value!=1) {   // Display receipt status fields
   t = new Table(1,0,2,"100%","center",25,45);
   t.addColumn("Patient","ImageText",1,1,"left","PatientFolder","11",180,"9")
   t.addColumn("Movement #","String",16,16,"left","","",60)
   t.addColumn("Movement","DateTime",2,2,"left","","",90)
   t.addColumn("Home/Type/Vol","String",17,17,"left","","",80)
   t.addColumn("Due Date","Date",3,3,"left","","",65)
   t.addColumn("Destination","String",5,5,"left","","",130)
   t.addColumn("Movement Comment","String",10,10,"left","","",150)
   t.addColumn("Reason","String",7,7,"left","","",120)
   t.addColumn("Operator ID","String",8,8,"left","","",75)
   AddTableRows()
   TableOutput(1,2);    // Order Column,Asc Dsc
 } else {
   t = new Table(1,0,2,"100%","center",35,45);
   t.addColumn("Patient","ImageText",1,1,"left","PatientFolder","11",180,"9")
   t.addColumn("Movement #","String",16,16,"left","","",70)
   t.addColumn("Movement","DateTime",2,2,"left","","",100)
   t.addColumn("Home/Type/Vol","String",17,17,"left","","",80)
   t.addColumn("Due Date","Date",3,3,"left","","",65)
   t.addColumn("Destination","String",5,5,"left","","",100)
   t.addColumn("Receipt Status","String",12,12,"left","","",55)
   t.addColumn("Receipt Date","DateTime",13,13,"left","","",100)
   t.addColumn("Received By","String",14,14,"left","","",55)
   t.addColumn("Requested By","String",15,15,"left","","",60)
   t.addColumn("Movement Comment","String",10,10,"left","","",100)
   t.addColumn("Reason","String",7,7,"left","","",80)
   t.addColumn("Operator ID","String",8,8,"left","","",55)
   AddTableRows()
   TableOutput(1,2);    // Order Column,Asc Dsc
 }
 break; }
 }
}
function SelectSubmit() {
  setInactCheckbox();
  document.SelectPeriod.submit();
}
function SetHospital() {
 if (SelectPeriod.ibcnmhos.value=="1") {
    HospDest01.innerHTML=ShowHospDesc.innerHTML;
    HospDest02.innerHTML=ShowHospital.innerHTML;
    Destinat01.innerHTML=ShowDestDesc.innerHTML;
    Destinat02.innerHTML=ShowDestination.innerHTML;
    if (document.SelectPeriod.superlev.value!="1") {
       document.SelectPeriod.filthosp.remove(0); }
 } else {
    HospDest01.innerHTML=ShowDestDesc.innerHTML;
    HospDest02.innerHTML=ShowDestination.innerHTML;
    Destinat01.innerHTML="";
    Destinat02.innerHTML="";
 }
 setInactCheckbox();
 SetLocation();
}
function SetLocation() {
  p=SelectPeriod;
  p.filtdest.options.length=1;
  p.filtdest.options[p.filtdest.options.length]=new Option(" "," ");
//  p.filtdest.value = p.selcdest.value;
  if (p.d_inactvds.checked == "1") {
     if (p.ibcnmhos.value=="1") {
        MrtMultiLocationsAll(p.filtdest,p.selcdest.value,p.filthosp.value)
     } else {
        MrtLocationsAll(p.filtdest,p.selcdest.value)
     }
  } else {
     if (p.ibcnmhos.value=="1") {
        MrtMultiLocations(p.filtdest,p.selcdest.value,p.filthosp.value)
     } else {
        MrtLocations(p.filtdest,p.selcdest.value)
     }
  }
  document.SelectPeriod.filtdest.remove(1);     // remove extra blank option
}
function setInactCheckbox() {
//  if (document.SelectPeriod.d_inactvop.checked==true) {
//     document.SelectPeriod.inactvop.value="1";
//  } else {
//     document.SelectPeriod.inactvop.value="0"; }
  if (document.SelectPeriod.d_inactvds.checked==true) {
     document.SelectPeriod.inactvds.value="1";
  } else {
     document.SelectPeriod.inactvds.value="0"; }
}
function UserIdSearchFrame(ReturnCode,ReturnName) {
  var PopUpFrameDoc = DFrameStart();
  window.ReturnCode=ReturnCode;
  window.ReturnName=ReturnName;
  PopUpFrameDoc.location.href = "../cgi-bin/websec01.pbl?reportno=03" +
                                "&template=011"
  SearchFrameShow();
}
function checkUser(userId,userName) {
  if (isWhitespace(userId.value)) {
    userName.value = "";
    return;
  }
  var serverURL = "../cgi-bin/patweb80.pbl?reportno=61" +
                  "&valdcode=" + userId.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|")
    userName.value=trim(ReturnValue[0])
  }
  else {
    userId.value="";
    userName.value="";
    userId.focus();
  }
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);SetHospital();">
<div id=HeadingSection>
<form name=SelectPeriod action=mrtweb01.pbl method=get style="margin:0">
<input type=hidden name=reportno value=8>
<input type=hidden name=template value=1>
<input type=hidden name=redirect value=1>
<input type=hidden name=viewtype value="%MRTWEB01.08.010">
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=dummy    value=" ">
<input type=hidden name=superlev value="%MRTWEB01.08.021">
<input type=hidden name=selcdest value="%MRTWEB01.08.022">
<input type=hidden name=mrcntrec value="%STANDARD.01.025.097.176.0.1">
<input type=hidden name=inactvds value="" />
<input type=hidden name=inactvop value="" />

  <table cellpadding=1 cellspacing=1 bgcolor=#CCCCCC border=0 width=100%>
    <tr><td class=DataLabel width=10%>Destination Type</td>
        <td><select name="filttype" id=filttype title="Destination Type"
                    tabindex=1 class=SelectMed>
             <option value="0">All</option>
             <option value="1">Internal</option>
             <option value="2">External</option>
            </select></td>
        <td>Bulk Record Movement Number</td>
        <td><input type=text size=10 maxlength=10 SearchColumn=16
             title='Bulk Record Movement Number'
             onkeyup="onSearchList(event);">
        </td>
        <td class=DataLabel align=right width=8%>Patient U/R</td>
        <td align=right width=35%>
            <input type=text name=filturno id=filturno size=10 maxlength=8
                   tabindex=2 title="Patient U/R" value="%MRTWEB01.08.014.0"
                   onblur="UpCase(this);justifyRight(this);
                   validateCode(8,SelectPeriod.filturno,SelectPeriod.patname);
                   SelectSubmit();">
            <input type=text name=patname id=patname size=38 maxlength=8 notab
                   readonly class=Readonly value="%MRTWEB01.08.014.1">
            <input type=hidden name=dummy id=dummy>
            <img src="../images/SearchIcon.gif" class=Icon
                 onclick="PatientSearchFrame(SelectPeriod.patname,
                 SelectPeriod.filturno,SelectPeriod.dummy,SelectSubmit);">
            <img src="../images/ClearIcon.gif" class=Icon
                 onclick="clrFields(filturno,patname,SelectSubmit);"></td></tr>

    <tr><td><div id=HospDest01></div></td>
        <td><div id=HospDest02></div></td>
        <td><div id=Destinat01></div></td>
        <td><div id=Destinat02></div></td>
        <td colspan="2">&nbsp;</td></tr>

  <tr><td class=DataLabel>Operator ID</td>
  <td class=DataField colspan=3>
    <input type=text name=filtusid id=filtusid size=12 maxlength=10
      value="%MRTWEB01.08.025.0" 
      onblur="checkUser(filtusid,filtname);"> 
    <input type=text name=name_filtusid id=filtname size=40
     readonly class="Readonly" value="%MRTWEB01.08.025.1">
    <img src="../images/SearchIcon.gif" class=Icon
      onclick="UserIdSearchFrame(filtusid,filtname);">
    <img src="../images/erase.gif" class=Icon
      onclick="clrFields(filtusid,filtname);">
  </td>

        <td>&nbsp;</td>
        <td align=right>
            <input type=button value="Go" class=SmallButton
                   onclick='SelectSubmit();'>
            <input type=button value="<<" class=SmallButton
                   onclick='%MRTWEB01.08.002'>
            %MRTWEB01.08.007
            <input type=button value=">>" class=SmallButton
                   onclick='%MRTWEB01.08.001'>
            <a href='javascript:SelectDateFrame();'>
               <img src="../images/DateLookup.gif" border=0
                    alt="Select Date" align=absmiddle></a>
            <a href='javascript:SelectView("0");'>
               <img src="../images/DayIcon.gif" border=0
                    alt="View Today" align=absmiddle></a>
            <a href='javascript:SelectView("1");'>
               <img src="../images/WeekIcon.gif" border=0
                    alt="View This Week" align=absmiddle></a>
            <a href='javascript:SelectView("2");'>
               <img src="../images/MonthIcon.gif" border=0
                    alt="View This Month" align=absmiddle></a></td></tr>
  </table>
 </form>
</div>

<div id=TableLocation></div>

<span id=ShowHospDesc style="display:none">
         Hospital
</span>

<span id=ShowHospital style="display:none">
      <select name="filthosp" id=filthosp title="Hospital" tabindex="3"
              onchange="SetLocation();">
        <option value="          ">All</option>
          %MRTWEB01.08.020
      </select>
</span>

<span id=ShowDestDesc style="display:none">
      Destination
</span>

<span id=ShowDestination style="display:none">
      <select name="filtdest" id=filtdest title="Destination" tabindex=4
              class=SelectMed>
        <option value="          ">All</option>
      </select>
      &nbsp;&nbsp;Show Inactive
      <input type="checkbox" name="d_inactvds" id=d_inactvds
             title="Inactive Destinations" onclick="SetLocation();" />
</span>

<script type="text/javascript">
 function AddTableRows() {
   %MRTWEB01.08.011.patweb98.01.001
 }
//
 Type="%MRTWEB01.08.015";
 for (var i =0 ; i < document.SelectPeriod.filttype.length; i++) {
  if (document.SelectPeriod.filttype.options[i].value==Type.substr(0,1)) {
       document.SelectPeriod.filttype.selectedIndex=i } };
//
// if ("%MRTWEB01.08.024" == "1") {
//    document.SelectPeriod.d_inactvop.checked="1"; }
 if ("%MRTWEB01.08.023" == "1") {
    var x=document.getElementById('d_inactvds');
    x.checked=true;
 }
</script>
