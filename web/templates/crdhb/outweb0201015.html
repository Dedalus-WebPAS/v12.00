<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="crdhb">
<meta name="HelpFileName"    content="NoContextSet.html">
<script type="text/javascript" src="../js/ClinicList.js"></script>
<script type="text/javascript" src=../js/IBA_Category_CT.js>  </script>
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientClinicId.js"></script>
<!-- <script type="text/javascript" src="../js/outweb02.js"></script> -->
<script type="text/javascript" src="../custom-js/outweb02.js"></script>
<script type="text/javascript" src="../js/outweb0202004.js"></script>
<script type="text/javascript">
function init() {
 SetClinicType(SelectPeriod.srchclty,SelectPeriod.defctype.value,SelectPeriod.usersite.value);

  if(SelectPeriod.ibcnmhos.value=="1") {
    SelectOptionsHospCatCode(SelectPeriod.ctcode,SelectPeriod.wbsehosp,SelectPeriod.srchltyp);
    SelectPeriod.srchltyp.options[0]=new Option("Select Location","  ");

    SelectPeriod.srchltyp.selectedIndex=0;
    if (!isWhitespace(SelectPeriod.defltype.value)) {
      for (var i =0 ; i < SelectPeriod.srchltyp.length; i++) {
        if (SelectPeriod.srchltyp.options[i].value.substr(0,3)==SelectPeriod.defltype.value) {
          SelectPeriod.srchltyp.selectedIndex=i;
        }
      }
    }
  } else
  {
    SetCategoryCT(SelectPeriod.srchltyp,SelectPeriod.defltype.value);
  }

 if(isWhitespace(SelectPeriod.srchclid.value)) {
   if(!isWhitespace(SelectPeriod.deftclid.value)) {
     SelectPeriod.srchclid.value=SelectPeriod.deftclid.value;
     validateCode(25,SelectPeriod.srchclid,SelectPeriod.clindesc);
   }
 }
 if(document.SelectPeriod.d_showempt.value=="1") {
   document.SelectPeriod.showempt.checked=true;
 }
}
function onClinicID(){
  validateCode(25,SelectPeriod.srchclid,SelectPeriod.clindesc);
}
function SubmitPage() {
  SelectPeriod.searchfl.value="1";
  SelectPeriod.submit();
}
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link
//  1 - date/time
//  2 - slot
//  3 - visit type code
//  4 - visit type desc
//  5 - formatted name
//  6 - ur
//  7 - outpatient visit number
//  8 - sex
//  9 - age
//  10- space
//  11- space
//  12- space
//  13- space
//  14- time actually seen
//  15- check in time
//  16- time of departure
//  17- slot status
//  18- space
//  19- space
//  20- follow up appointment made
//  21- DNA or spaces
//  22- visit extension user defined free format 1
//  23- diagnosis comments
//  24- alerts string
//  25- home phone
//  26- business phone
//  27- mobile phone
//  28- casekeys
//  29- language
//  30- special arrangements
//  31- status
//  32- patient folder extension
//  33- outcome code
//  34- coloured visit number
//  35- coloured visit type
//  36- diagnosis comments
//  37- claim code
//  38- claim comment flag
//  39- highlight colours
//  40- referral expiry
//  41- claim status
//  42- cmbs item
//  43- batch number
//  44- print checkbox disabled
//  45- print checkbox ticked
//  46- print checkbox unticked
//  47 - Referral Number
//  48 - Referral Number
//  49 - Referral Dept
//  50 - Using med claim
//  51 - A/H Departmetn
//  52 - Collect Enc
//  53 - Linked Enc
//  54 - source of ref
//  55 - update array javascript
//----------------------------------------------------------------------------
// 01 : 275315 Add Apptmade column 20 to table Case 0 and Patient column to 175 wide 
function InitTable(TableView) {
document.title="Patient List"
switch (TableView) {
  case "0": {
   t = new Table(1,0,2,"100%","center",45,50);
   if(document.SelectPeriod.viewtype.value == "1" ) {
     t.addColumn("Time","DateTime",1,1,"nowrap left","AppointmentIcon.gif","Slot","10%")
   } else {
     t.addColumn("Time","Time",1,1,"left","AppointmentIcon.gif","Slot",45)
   }
   t.addColumn("Type","String",34,34,"left","","",25)
   t.addColumn("U/R","String",6,6,"left","","",50)
   t.addColumn("Patient","StringPatient",5,5,"left","PatientFolder","Patient",175)
// 02 : Merge task 0859728
	if(document.SelectPeriod.showcpmi.value=="1") {
     t.addColumn("Confirm Demographics","ButtonLinkWide",65,66,"left","","ConfirmPMI",55)
   }
// 04 : Add Mode of Delivery
   t.addColumn("Mode of Delivery","String",72,72,"left","","",45)
   t.addColumn("Check- In","ButtonLink",15,-1,"left","","CheckIn",45)
   t.addColumn("Time Seen","ButtonLink",14,-1,"left","","TimeSeen",45)
   t.addColumn("Departure","ButtonLink",16,-1,"left","","Departure",45)
   t.addColumn("Follow Up/ Outcome","ButtonLink",33,-1,"left","","FollowUp",45)
   t.addColumn("Appt Made","String",20,-1,"left","","ApptMade",50)
   t.addColumn("Non Attend","ButtonLink",21,-1,"left","","NonAttend",45)
// 03 : Add Telehelth link
   t.addColumn("Telehealth","TeleLink",10,-1,"left","LinkIcon.gif","Telehealth",45)  
   t.addColumn("Alerts","Image",22,-1,"left","alert","",35)
   t.addColumn(SelectPeriod.dummyclm.value,"String",37,37,"left","","",25)
   t.addColumn("Clinic Type","String",56,56,"left","","",30)
   t.addColumn("Clinic","String",55,55,"left","","",40)
   t.addColumn("Visit","String",53,53,"left","","",35)
   t.addColumn("Confirmed","String",57,57,"left","","",30)
   AddTableRows();
   t.sortTable(6,1);    // By Clinic Type
   t.sortTable(5,1);    // By Clinic Date
   TableOutput(0,1);    // Order Column,Asc Dsc
   break; }
 }
}
function UpdateConf(CheckBox){
  var UpdateConf=0
  if(CheckBox.checked) {
     UpdateConf=1
  }
    var serverURL   = "../cgi-bin/outweb02.pbl?reportno=9&updatety=8" +
                      "&casekeys=" + CheckBox.value.replace(/ /g,"+") +
                      "&confappt=" + UpdateConf
  var returnValue = RSExecute(serverURL);
}
function ShowUnavil() {
  if (VariableNameExists('OPMultiSessionShowUnavail')) {
    if (OPMultiSessionShowUnavail == false) {
        SelectPeriod.shwunavl.value="1";
    }
  }
}
</script>
</head>
%START.OF.PAGE
<body onload='PageLoad(event);InitTable("0");SetOutpatientList();
              getScrollPosition();ShowUnavil();'
      onunload="saveScrollPosition();">
<div id=HeadingSection>
<form id=SelectPeriod name=SelectPeriod action=outweb02.pbl method=get 
 style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=15>
<input type=hidden name=defctype value="%OUTWEB02.01.025">
<input type=hidden name=deftclid value="%OUTWEB02.01.036">
<input type=hidden name=defltype value="%OUTWEB02.01.037">
<input type=hidden name=viewtype value="%OUTWEB02.01.011">
<input type=hidden name=usersite value="%STANDARD.01.023">
<input type=hidden name=searchfl value="0">
<input type=hidden name=d_showempt value="%OUTWEB02.01.048">
<input type=hidden name=dummyclm value="%STANDARD.01.017.CL">
<!-- 02 : Merge task 0859728 -->
<input type=hidden name=showcpmi value="%OUTWEB02.01.049">
<!-- 02 : End of change -->													  
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=wbsehosp value="%STANDARD.01.032">
<input type=hidden name=ctcode value="CT">
<input type=hidden name=occGroup id=occGroup value="%STANDARD.01.012.1">
<input type=hidden name=shwunavl id=shwunavl value="">

<table width="100%" bgcolor=#cccccc align=center border=0 cellpadding=2
 cellspacing=0 border=0 >
<tr><td class=DataLabel>Clinic Type</td>
  <td class=DataField>
  <select name=srchclty class=SelectBig>
  <option value="  ">Select Clinic Type</option>
  </select></td>

  <td class=DataLabel>Location</td>
  <td class=DataField>
  <select name=srchltyp class=SelectBig>
  <option value="  ">Select Location</option>
  </select></td>

  <td class=DataLabel>Visit Type</td>
  <td class=DataField>
  <select name=filtvtyp class=SelectBig>
  <option value="  ">Select Visit Type</option>
  %OUTWEB02.01.057.2
  </select></td>

  <td align=right>
  <input type=button value="<<" class=SmallButton
  onClick='location.href="%OUTWEB02.01.002"'>
  %OUTWEB02.01.007
  <input type=button value=">>" class=SmallButton
 onClick='location.href="%OUTWEB02.01.001"'>
  <a href='javascript:SelectDateFrame();'>
  <img src="../images/DateLookup.gif" border=0
   alt="Select Date" align=absmiddle></a>
  <a href='javascript:SelectView("0");'>
  <img src=../images/DayIcon.gif border=0
   alt="View Today" align=absmiddle></a>
  <a href='javascript:SelectView("1");'>
  <img src=../images/WeekIcon.gif border=0
   alt="View This Week" align=absmiddle></a>
  </td></tr>

<tr>
  <td class=DataLabel>Clinic Indicator</td>
  <td class=DataField>
  <select name=srchcind class=SelectBig>
  <option value="  ">Select Clinic Indicator</option>
  %OUTWEB02.01.039.2
  </select></td>
  <td class=DataLabel>Clinic ID</td>
  <td class=DataField>
  <input type=text maxlength=6 name=srchclid size=6 title="Clinic ID"
          value="%OUTWEB02.01.022.1" onblur=UpCase(this);onClinicID();>
    <input type=text maxlength=25 name=clindesc size=25 
          value="%OUTWEB02.01.022.0" class=Readonly readonly>
    <img src="../images/SearchIcon.gif"
    onClick="ClinicSessionSearchFrame(srchclid,clindesc,onClinicID);">
    <img src="../images/erase.gif" 
     onClick="clrFields(srchclid,clindesc);">
  </td>
  <td class=DataLabel>Show Empty Slots</td>
  <td class=DataField><input type=checkbox name=showempt value="1">
  </td>
  <td class=Field align=right><input type=button value=Search class="button"
                   onclick='SubmitPage();'>
  </td>
</tr>
</table>
 </form>
</div>

<div id=TableLocation></div>

<script type="text/javascript">
function AddTableRows() {
%OUTWEB02.01.047.outweb02.03.001
}
</script>

<form name=UpdateStatus action=outweb02.pbl method=post>
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=1>
<input type=hidden name=casekeys value="">
<input type=hidden name=xocadoct value="">
</form>
