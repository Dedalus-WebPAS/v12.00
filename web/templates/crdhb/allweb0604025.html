<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="crdhb">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src=../js/TableSort.js></script>
<script type="text/javascript">
// 02 : TAS : Task 0851673 : remove setType function, replace with new version
//function setType(thefield,type) {
//  if(document.AddReferral.graphtype.value==""){
//     document.AddReferral.graphtype.value=type
//     return;}
//  if(document.AddReferral.graphtype.value!=type){
//    alert("Only those Assessments of the same Type can be graphed")
//    thefield.checked=false}
//}
// New version of function below
function setType(thefield,type) {
  // Checkbox unchecked
  if(!thefield.checked){
    document.AddReferral._checkno.value--;
    if(document.AddReferral._checkno.value==0){
      document.AddReferral.graphtype.value="";
    }
  }

  // Checkbox checked
  else{
    if((document.AddReferral.graphtype.value!=type)&&(document.AddReferral.graphtype.value!="")){
      alert("Only those Assessments of the same Type can be graphed");
      thefield.checked=false;
      return;
    }
    // Handle single element case
    document.AddReferral.graphtype.value=type;
    document.AddReferral._checkno.value++;
  }
}
// 02 : End of change
function GraphMultiple() {
  var uno=PatientLinks.urnumber.value.replace(/ /g,"+");
  var adm=PatientLinks.admissno.value.replace(/ /g,"+");
  var temp="011";
  if(document.AddReferral.graphtype.value=="005"){
      temp="012";}
  else if(document.AddReferral.graphtype.value=="007"){
      temp="013";}
  else if(document.AddReferral.graphtype.value=="019"){
      temp="021";}
  else if(document.AddReferral.graphtype.value=="023"){
      temp="024";}

  linkurl="../cgi-bin/allweb06.pbl?reportno=04&template="+temp+
          "&urnumber="+uno+"&admissno="+adm+"&mhhon001="+adm;
 n=0;
 for (var e = 0; e < document.all.length; e++) {
   if(document.all[e].name!=undefined) {
     var el=document.all[e] ;
     if (el.name.match(/prc/)) {
       if(el.checked==true){
         n++;
       }
     }
   }
 }

 a=0;
 for (var e = 0; e < document.all.length; e++) {
   if(document.all[e].name!=undefined) {
    var el=document.all[e] ;
    if (el.name.match(/prc/)) {
      if(el.checked==true){
        el.value.replace(/ /g,"+");
        n--;
        linkurl+="&dataset" + n  + "="+el.value;
        a++;}
    }
   }
 }
// 03 : TAS : Merge task 0858390 
//  var NewWindow=window.open(linkurl,"ScreenLink",
//    "width=1024,height=768,location=no,resizable=yes,scrollbars=yes,titlebar=no");
if(document.AddReferral.graphtype.value=="023"){
     var NewWindow=window.open(linkurl,"ScreenLink",
     "width=1024,height=768,location=no,resizable=yes,scrollbars=yes,titlebar=no");
  }
  else{
     Left=(document.body.clientWidth-1200)/2
     DFrameLink(linkurl,100,Left,1200,680);
  }
}
function HONOSLink(ur,adm,uniq,temp) {
  var uno=ur.replace(/ /g,"+");
  var adm=adm.replace(/ /g,"+");
  var unq=uniq.replace(/ /g,"+");
  linkurl="../cgi-bin/allweb06.pbl?reportno=04&template="+temp+
          "&urnumber="+uno+"&admissno="+adm+"&mhhon002="+unq+"&mhhon001="+adm;
  Left=(document.body.clientWidth-1000)/2
  DFrameLink(linkurl,0,Left,1000,1200);
}
// 03 : TAS : Merge task 0858390 						  
function SupplConsumer() {
  var uno=PatientLinks.urnumber.value.replace(/ /g,"+");
  var adm=PatientLinks.admissno.value.replace(/ /g,"+");
  var temp="001";
  linkurl="../cgi-bin/mehweb02.pbl?reportno=03&template="+temp+
          "&urnumber="+uno+"&admissno="+adm;
  location.href=linkurl;
}
// End of change														
function AddHONOS(honostyp,honostype,admissno) {
  if(document.AddReferral.honavail.value!="1"){
     alert("Invalid visit selected");
     return;
  }
  var temp="002";
  hontype=honostype;
  if(hontype=="C"){
     temp="004";}
  if(hontype=="L"){
     temp="006";}
  if(hontype=="S"){
     temp="018";}
  if(hontype=="M"){
     temp="022";}

  linkurl="allweb06.pbl?reportno=04&template=" + temp +
           "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+") +
           "&admissno=" + admissno.replace(/ /g,"+") +
           "&honostyp=" + honostyp.replace(/ /g,"+");
  Left=(document.body.clientWidth-900)/2
  DFrameLink(linkurl,0,Left,900,640);
}
function SingleGraphLink(ur,adm,uniq,temp) {
  var uno=ur.replace(/ /g,"+");
  var adm=adm.replace(/ /g,"+");
  var unq=uniq.replace(/ /g,"+");
  var template="008"
  if(temp=="005"){
     template="009"}
  else if(temp=="007"){
     template="010"}
  else if(temp=="019"){
     template="020"}
  else if(temp=="023"){
     template="024"}

  linkurl="../cgi-bin/allweb06.pbl?reportno=04&template="+template+
          "&urnumber="+uno+"&mhhon002="+unq+"&mhhon001="+adm+
          "&admissno="+adm;
  if(temp=="023"){
     linkurl = linkurl+"&dataset0="+adm+uniq;
  }
// 03 : TAS : Merge task 0858390  
//  var NewWindow=window.open(linkurl,"ScreenLink",
//    "width=1024,height=768,location=no,resizable=yes,scrollbars=yes,titlebar=no");
  if(temp=="023"){
     var NewWindow=window.open(linkurl,"ScreenLink",
     "width=1024,height=768,location=no,resizable=yes,scrollbars=yes,titlebar=no");
  }
  else{
     Left=(document.body.clientWidth-1000)/2
     DFrameLink(linkurl,100,Left,1000,680);
  }
}
// End of change
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
// 0. Link
// 1. HONOS collection date
// 2. Service Setting
// 3. HONOS Type
// 4. Responsible HCP
// 5. Sent          
// 6. Completed
// 7. Single Graph Link
// 8. Multiple Graph
// 9. Add Template No.
//10. Honos activity
//11. Total Score
//12. Collection Reason
//
//17. Conditional display of Single Graph Link
//18. Conditional display of Multiple Graph checkbox
//---------------------------------------------------------------------------

function InitTable(TableView) {
switch (TableView) {
case 0: {
 t = new Table(1,0,2,"100%","center",40,30);
 t.addColumn("Collection Date","Date",1,1,"left","AppointmentIcon.gif","0",85)
 t.addColumn("Visit","String",14,14,"left","","",100)
 t.addColumn("Service Setting","String",2,2,"left","","",100)
 t.addColumn("Collection Reason","String",12,12,"left","","",100)
 t.addColumn("Outcome Measure","String",3,3,"left","","",100)
 t.addColumn("Responsible HCP","String",4,4,"left","","",100)
 t.addColumn("Performing HCP","String",13,13,"left","","",90)
 t.addColumn("Total Score","String",11,11,"center","","",40)
 t.addColumn("Completed","String",6,6,"left","","",50)
 // 03 : TAS : Merge task 0858390  
 //t.addColumn("Graph","String",16,1,"left","Column1GraphIcon.gif","7",40)
 //t.addColumn("Multiple Graph","String",8,8,"center","","",40)
 t.addColumn("Graph","String",17,1,"left","","",40)
 t.addColumn("Multiple Graph","String",18,18,"center","","",40)
 t.addColumn("Add New Outcome to Visit","String",16,1,"center","EditIcon.gif","15",100)
 AddTableRows()
 TableOutput(0,2);    // Order Column,Asc Dsc
 break; }
 }
}
// End of Change
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);SetCookiePath('RefList');">
<div id="HeadingSection"> 
<div id="PageHeadingSection">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%ALLWEB06.04.003";
PatientVIS="%ALLWEB06.04.081";
PatientNAM="%ALLWEB06.04.002";
PatientSTA="%ALLWEB06.04.086.078";
PatientALT="%ALLWEB06.04.084";
PatientSEX="%ALLWEB06.04.019";
PatientDOB="%ALLWEB06.04.020";
PatientAGE="%ALLWEB06.04.021";
PatientLOC="%ALLWEB06.04.083";
PatientPRI="%ALLWEB06.04.086.066.1";
PatientUNT="%ALLWEB06.04.066.0";
DoctorCOD="%ALLWEB06.04.082.003";
DoctorNAM="%ALLWEB06.04.082.002";
PatientAID="%ALLWEB06.04.086.090";
PatientIND="%ALLWEB06.04.086.091";
PatientCUR="%ALLWEB06.04.086.092";
PatientCLC="%ALLWEB06.04.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%ALLWEB06.04.086.094";
PatientCDM="%ALLWEB06.04.086.095";
PatientVDH="%ALLWEB06.04.086.099.015";
InsertPatientHeader()
</script>

<div id="PatientMenu"></div>
</div>

<form name=AddReferral method=get action=allweb06.pbl style="margin:0;">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%ALLWEB06.04.003">
<input type=hidden name=admissno value="%ALLWEB06.04.081">
<input type=hidden name=dataset0>
<input type=hidden name=dataset1>
<input type=hidden name=dataset2>
<input type=hidden name=dataset3>
<input type=hidden name=dataset4>
<input type=hidden name=graphtype>
<input type=hidden name=honavail value="%ALLWEB06.04.213">
<!-- 02 : TAS : 0851673 -->
<input type=hidden name=_checkno value=0>
<!-- 02 : End of change -->
<table cellspacing=0 cellpadding=0 border=1 width=100% class=HeadingCell>
  <tr>
    <td>
    <table cellspacing=0 cellpadding=0 border=0 width=100%>
      <tr align=right bgcolor=#CCCCCC>
        <td>
<!-- 03 : TAS : Merge task 0858390 -->
          <input type=button class=LargeButton value="Suppl Consumer Record" onclick="SupplConsumer();">																										
          <input type=button class=Button value="Graph Multiple" onclick="GraphMultiple();">
         </td>
      </tr>
    </table>
    </td>
  </tr>
</table>
</form>
</div>

<div id=TableLocation></div>
<script type="text/javascript">
function AddTableRows() {
%ALLWEB06.04.219.0
}
</script>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value="1">
<input type=hidden name=template value="009">
<input type=hidden name=urnumber value="%ALLWEB06.04.003">
<input type=hidden name=admissno value="%ALLWEB06.04.081">
<input type=hidden name=MenuType value="%ALLWEB06.04.088">
</form>
