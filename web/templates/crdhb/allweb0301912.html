<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="crdhb">
<meta name="HelpFileName" content="NoContextSet.html">
<script language="javascript" src="../js/allweb03.js"></script>
<script type="text/javascript">
//------------------------------------------------------------
// Set Link ACC Redirect and Return program after link ACC
//------------------------------------------------------------
function SetLinkACC(CurForm,ReturnCd) {
  i=document.UpdateForm.alenc010.selectedIndex;
  VacsFlag=document.UpdateForm.alenc010.options[i].value.substring(6,7)
  if (VacsFlag!=0){
    if ((CurForm.ptcnueoc.value==1)&&(CurForm.alenc115.value.substr(5,1)=='A')){
       CurForm.redirect.value="eocweb01.pbl?reportno=01&template=006"
             + "&urnumber=" + CurForm.urnumber.value.replace(/ /g,"+")
             + '&returncd=' + ReturnCd
             + "&admissno=" + CurForm.admissno.value.replace(/ /g,"+")
    }
  }
} //end SetLinkACC
function AddEncounter(theForm){

  if (document.getElementById('otptcnck').value == "1") {
    SetRedirectOutpatientContact();
    return;
  }

  SetRedirect()
  theForm.target="PopUpFrame1";
  if (validateMandatory(theForm)) {
//
    if(document.UpdateForm.checkbx2.checked==true) {
      if(!CheckFutureBookings(UpdateForm.admissno,UpdateForm.alenc005)) {
        return;
      }
    }
//
    if(document.UpdateForm.checkappt.value==0 &&
       document.UpdateForm.checkbx2.checked==true) {
       CheckLinkedBookings(UpdateForm.admissno,UpdateForm.urnumber,UpdateForm.checkappt)
        if(document.UpdateForm.checkappt.value==0) {
          return;
        }
    }
    SetLinkACC(theForm,"AL2");
	// 07 : TAS : don't overwrite contact time
	// 01 : CTAS : automatically set Contact Time upon submit
	//SetCurrentDateTime(null,document.UpdateForm.alenc006);
	// end of change
    theForm.submit() }
}
function AddAndFinish(theForm){
  DFrameClear();
  if (validateMandatory(theForm)) {
//
    if(document.UpdateForm.checkbx2.checked==true) {
      if(!CheckFutureBookings(UpdateForm.admissno,UpdateForm.alenc005)) {
        return;
      }
    }
//
    if(document.UpdateForm.checkappt.value==0 &&
       document.UpdateForm.checkbx2.checked==true) {
       CheckLinkedBookings(UpdateForm.admissno,UpdateForm.urnumber,UpdateForm.checkappt)
        if(document.UpdateForm.checkappt.value==0) {
          return;
        }
    }
    document.UpdateForm.redirect.value=parent.location.href;
    document.UpdateForm.nextpage.value="6";
    theForm.target="PopUpFrame1";
	// 07 : TAS : don't overwrite contact time
	// 01 : CTAS : automatically set Contact Time upon submit
	//SetCurrentDateTime(null,document.UpdateForm.alenc006);
	// end of change
    theForm.submit() }
}
function ToggleCombo(){
  if(UpdateForm.checkbx2.checked==false){
    UpdateForm.checkbx1.disabled=false;
    UpdateForm.alref006.className=" ";
    UpdateForm.alref072.className=" ";
    CloseReason.style.display='none';
  } else{
    UpdateForm.checkbx1.disabled=true; // disable Waiting List
    UpdateForm.checkbx1.checked=false;
    UpdateForm.alref006.className="Mandatory SelectBig";
    UpdateForm.alref072.className="Mandatory SelectBig";
    CloseReason.style.display='';
  }
}

/*
function SetRedirect() {

  UpdateForm.nextpage.value="6";
  var showUpdate = "1";
  var indicator9 = UpdateForm.deptcinc.value.substr(11,1);
  if(indicator9=="X")
  {
    showUpdate = "3";
  }
  UpdateForm.redirect.value=UpdateForm.DEFDIRCT.value +
                            "&shwupdat=" + showUpdate;
  PatientType=UpdateForm.alenc009.value.substr(4,1);
  isBillable=UpdateForm.billablef.value;
  if(isBillable==1&&(PatientType==1 || PatientType==2)) {
    checkInd=document.UpdateForm.alenc115.value.substr(3,5)
    if(checkInd.search(/W/g) >= 0) {
      UpdateForm.nextpage.value="5";
      UpdateForm.redirect.value="allweb03.pbl?reportno=1&template=5";
    } else
    if(checkInd.search(/V/g) >= 0) {
      UpdateForm.nextpage.value="5";
      UpdateForm.redirect.value="allweb03.pbl?reportno=1&template=6";
    } else
    if(checkInd.search(/M/g) >= 0) {
      UpdateForm.nextpage.value="5";
      UpdateForm.redirect.value="allweb03.pbl?reportno=1&template=4";
    }
  }
}
*/
//03 : TAS : new redirect for add contact form
/*06 : TAS : WU-1406 Update redirect to work with new functionality from 
 task 0845330	 
function SetRedirect() {
  UpdateForm.nextpage.value="6";
  var showUpdate = "1";
  UpdateForm.redirect.value="allweb03.pbl?reportno=1&template=1";
}
*/
//06 : TAS : WU-1406 Update redirect to work with new functionality from 
 //task 0845330
function SetRedirect() {
	var showUpdate = "1";
	if (trim(document.getElementById('otptcnck').value) == "1") {
	document.UpdateForm.nextpage.value="1";
	UpdateForm.redirect.value="allweb03.pbl?reportno=1&template=003" +
	"&shwupdat=" + showUpdate;
    }   
	else {
	document.UpdateForm.nextpage.value="6";	
	UpdateForm.redirect.value=UpdateForm.DEFDIRCT.value;
	}
}
// 06: WU-1406 Update redirect to work with new functionality from 
 //task 0845330
function SetRedirectOutpatientContact() {

  var indicator9 = UpdateForm.deptlcod.value.substr(11,1);
//  var indicator9 = "X"

  if(indicator9=="X")
  {
    if (validateMandatory(UpdateForm)) {
//
      if(document.UpdateForm.checkbx2.checked==true) {
        if(!CheckFutureBookings(UpdateForm.admissno,UpdateForm.alenc005)) {
          return;
        }
      }
//
      if(document.UpdateForm.checkappt.value==0 &&
         document.UpdateForm.checkbx2.checked==true) {
         CheckLinkedBookings(UpdateForm.admissno,UpdateForm.urnumber,UpdateForm.checkappt)
          if(document.UpdateForm.checkappt.value==0) {
            return;
          }
      }

      SetCookie("OutpatientContactCookie",'1');

      document.UpdateForm.redirect.value=location.href;
      document.UpdateForm.nextpage.value="1";
      UpdateForm.target="PopUpFrame1";
      UpdateForm.submit();
    }
  } else {
    UpdateForm.nextpage.value="6";
    var showUpdate = "1";
    UpdateForm.redirect.value=UpdateForm.DEFDIRCT.value +
                              "&shwupdat=" + showUpdate;
    PatientType=UpdateForm.alenc009.value.substr(4,1);
    isBillable=UpdateForm.billablef.value;
    if(isBillable==1&&(PatientType==1 || PatientType==2)) {
      checkInd=document.UpdateForm.alenc115.value.substr(3,5)
      if(checkInd.search(/W/g) >= 0) {
        UpdateForm.nextpage.value="5";
        UpdateForm.redirect.value="allweb03.pbl?reportno=1&template=5";
      } else
      if(checkInd.search(/V/g) >= 0) {
        UpdateForm.nextpage.value="5";
        UpdateForm.redirect.value="allweb03.pbl?reportno=1&template=6";
      } else
      if(checkInd.search(/M/g) >= 0) {
        UpdateForm.nextpage.value="5";
        UpdateForm.redirect.value="allweb03.pbl?reportno=1&template=4";
      }
    }
// 06: new condition for WU-1406	
    if (trim(document.getElementById('otptcnck').value) == "1") {
	document.UpdateForm.nextpage.value="5";
	UpdateForm.redirect.value="allweb03.pbl?reportno=1&template=003" +
	"&shwupdat=" + showUpdate;
	}
//end of change	
    UpdateForm.target="PopUpFrame1";
    if (validateMandatory(UpdateForm)) {
//
      if(document.UpdateForm.checkbx2.checked==true) {
        if(!CheckFutureBookings(UpdateForm.admissno,UpdateForm.alenc005)) {
          return;
        }
      }
//
      if(document.UpdateForm.checkappt.value==0 &&
         document.UpdateForm.checkbx2.checked==true) {
         CheckLinkedBookings(UpdateForm.admissno,UpdateForm.urnumber,UpdateForm.checkappt)
          if(document.UpdateForm.checkappt.value==0) {
            return;
          }
      }
      SetLinkACC(UpdateForm,"AL2");
// 07 : TAS : don't overwrite contact time
// 01 : CTAS : automatically set Contact Time upon submit
	  //SetCurrentDateTime(null,document.UpdateForm.alenc006);
      SetCookie("OutpatientContactCookie", parent.location.href);
//alert(parent.location.href);
     UpdateForm.submit()
    }
  }
}


function ShowHideWaitingList(status){
if(status==0)
  Wait.style.display='';
else
  Wait.style.display='none';

//T0868976-Start
 if(status==2){
   document.getElementById('checkbx2').disabled=true
   document.getElementById('checkbx2').checked=false;
 }
 else {
   document.getElementById('checkbx2').disabled=false;
 }
 ToggleCombo();
//T0868976-End
}
//
function CheckAddHCP() {
  if(document.UpdateForm.addithcp.checked==true) {
     AdditionalHCP.style.display="";
     AdditionalHCP.innerHTML=ShowAdditionalHCP.innerHTML;
  } else {
     AdditionalHCP.innerHTML="";
     AdditionalHCP.style.display="none";
  }
}
function ShowDIVS() {
  LinkedHeading.innerHTML=DisplayLinkedHeading.innerHTML;
  Linked.innerHTML=DisplayLinked.innerHTML;
}
function defaultFieldValues() {

  if (isWhitespace(document.getElementById('defldate').value)) {return;}

//  if (!isWhitespace(document.getElementById('defldate').value)) {
  document.UpdateForm.alenc005.value =
  document.getElementById('defldate').value;
//  }
// 07 : TAS : set default contact time if it exists
  if (!isWhitespace(document.getElementById('defltime').value)) {
	document.UpdateForm.alenc006.value =
		document.getElementById('defltime').value;
  }
// end of change
//  if (!isWhitespace(document.getElementById('defldoct').value)) {
  document.UpdateForm.alenc004.value =
  trim(document.getElementById('defldoct').value);
  ValidateHCP(18,0,document.UpdateForm.alenc004,
                   document.UpdateForm.SProvider);
//  }


}
function getOutpatientContactCookie() {
  if (GetCookieData("OutpatientContactCookie")!="unknown") {
    document.getElementById('otptcnck').value="1";
    ExpireCookiePath("OutpatientContactCookie");
  }
//alert(document.getElementById('otptcnck').value);
}
</script>
</head>

%START.OF.PAGE
<body onload="PageLoad(event);ShowDIVS();ShowHideWaitingList(%ALLWEB03.01.303);
              DisplayTrnSrc();
              ListOptionsCatLD(UpdateForm.deptlcod,UpdateForm.alenc007);
			  defaultFieldValues();getOutpatientContactCookie();
              setUserDoc(UpdateForm.deptlcod,UpdateForm.d_websecdoc,
              UpdateForm.alenc004,UpdateForm.SProvider,UpdateForm.d_websechcp);">
<span class=DFrameTitleBar>
<img border=0 align=right src=../images/ExitIcon.gif onclick="DFrameExit();">
Add Contact for %ALLWEB03.01.125.0
</span>

<div id=PageBodySection>
<form name=UpdateForm action="allweb03.pbl" method=post
 onsubmit='return validateMandatory(this)'>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=001>
<input type=hidden name=nextpage value=0>
<input type=hidden name=redirect value="">
<input type=hidden name=DEFDIRCT value='%ALLWEB03.01.001.allweb03.01.001'>
<input type=hidden name=urnumber value='%ALLWEB03.01.003'>
<input type=hidden name=admissno value='%ALLWEB03.01.081'>
<input type=hidden name=alenc001 value='%ALLWEB03.01.081'>
<input type=hidden name=updatety value="A">
<input type=hidden name=dummyret value="">
<input type=hidden name=dummysit value="">
<input type=hidden name=dummydat value="">
<input type=hidden name=dummy1 id=dummy1>
<input type=hidden name=mbs value="M">
<input type=hidden name=billablef value='%ALLWEB03.01.302'>
<input type=hidden name=ptcnueoc value="%ALLWEB03.01.309">
<input type=hidden name=deptcinc value="%ALLWEB03.01.901.3">
<input type=hidden name=checkappt value="0">
<input type=hidden name=admnsrce id=admnsrce value="">
<input type=hidden name=desttype id=desttype value="">
<input type=hidden name=deptlcod value="%ALLWEB03.01.125.3">

<input type=hidden name=defldate id=defldate  value="%ALLWEB03.01.920">
<input type=hidden name=defltime id=defltime value="%ALLWEB03.01.921">
<input type=hidden name=defldoct id=defldoct value="%ALLWEB03.01.922">
<input type=hidden name=otptcnck id=otptcnck value="">
<input type=hidden name=d_websecdoc id=d_websecdoc value="%STANDARD.01.010">
<input type=hidden name=d_websechcp id=d_websechcp value="%STANDARD.01.046">

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td class=DataLabel width=15%>Contact Date</td>
    <td width=38%>
      <input type=text name=alenc005 value='%STANDARD.01.015' title="Date"
       class='PastDate Mandatory' Size=9 onblur="checkDate(this,'Date')">
      <img src=../images/DateLookup.gif border=0 hspace=4
       align=absmiddle onclick="DateLookupFrame(alenc005);">
    Time
    <input type=text size=8 class=Mandatory title="Time"
     name=alenc006 value='%STANDARD.01.016'>
    <a href='javascript:SetCurrentDateTime(null,UpdateForm.alenc006)'>
    <img src=../images/DateTimeStamp.gif  border=0 hspace=4 align=absmiddle></a>
    <a href='javascript:TimeLookupFrame(UpdateForm.alenc006)'>
    <img src=../images/TimeLookup.gif border=0 hspace=4 align=absmiddle></a>
	</td>
   <td class=DataLabel width=15%>Entered by</td>
   <td><input type=text name=userid value="%ALLWEB03.01.168"
        class=ReadOnly readonly></td></tr>

<tr><td class=DataLabel width=15%>Health Care Provider</td>
    <td colspan=3>
    <input type=text name=alenc004 size=10 maxlength=8 class=Mandatory
     onblur="ValidateHCP(18,0,alenc004,SProvider);" 
     title="Health Care Provider"
     value="%ALLWEB03.01.138.1">
    <input type=text name=SProvider size=24 class=Readonly readonly
      title="Health Care Provider" value="%ALLWEB03.01.138.0">

    <img src=../images/SearchIcon.gif class=Icon
     onclick="HCPSearchFrame(alenc004,SProvider,0);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(alenc004,SProvider);">
    <td></tr>

<tr>
<!-- 01 : CTAS : Rename field to "Activity"
<td class=DataLabel width=15%>Occasion of Service</td>
    <td><select class="Mandatory SelectBig" name=alenc010 
         title="Occasion of Service">
    <option></option>
     ALLWEB03.01.210.2.0
    </select></td>
-->
<td class=DataLabel width=15%>Activity</td>
    <td><select class="Mandatory SelectBig" name=alenc010 
         title="Activity">
    <option></option>
     %ALLWEB03.01.210.2.0
    </select></td>
<!-- end of change -->

    <td><div id=LinkedHeading></div></td>
    <td><div id=Linked></div></td></tr>

<tr>
	<!-- 01 : CTAS : Move type of Contact below,
	Move Service Setting and Direct Minutes here
	<td class=DataLabel>STANDARD.01.017.za</td>
    <input type=hidden name=alenc009 value="">
    <td><select class="SelectBig" name=alenc047
         title="STANDARD.01.017.za">
        <option></option>
        ALLWEB03.01.247. 1.2
        </select></td>
    <td class=DataLabel>&nbsp;</td>
    <td>&nbsp;</td>
	-->
	<td class=DataLabel>%ALLWEB03.01.207.8</td>
    <td><select class="Mandatory SelectBig"
         name=alenc007  title="%ALLWEB03.01.207.8">
    <option></option>
    %ALLWEB03.01.207.2
    </select></td>
	<!-- 04 : Make Direct minutes mandatory -->
	<td class=DataLabel>Direct Minutes</td>
    <td class=DataField>
	<input type=text size=12 class=Mandatory maxsize=5 name=alenc011 
	title="Direct Minutes" min=0 onblur=checkInteger(this,this.title)></td>
	<!-- end of change -->
</tr>

<tr>
	<!-- 01 : CTAS : Move Direct Minutes up
	Type of Contact here
	<td class=DataLabel>Direct Minutes</td>
    <td class=DataField>
  <input type=text size=12 maxsize=5 name=alenc011 title="Direct Minutes" min=0
    onblur=checkInteger(this,this.title)></td>
	-->
	<td class=DataLabel>%STANDARD.01.017.za</td>
    <input type=hidden name=alenc009 value="">
    <td><select class="SelectBig" name=alenc047
         title="%STANDARD.01.017.za">
        <option></option>
        %ALLWEB03.01.247. 1.2
        </select></td>
	<!-- end of change -->
    <td class=DataLabel>Indirect Minutes</td>
    <td class=DataField>
    <input type=text size=12 maxsize=5 name=alenc013 title="Indirect Minutes" 
     min=0 onblur=checkInteger(this,this.title)></td></tr>

<tr>
	<!-- 01 : CTAS : Move Travel Time below Mileage
	Move Claim Type here
	<td class=DataLabel>Travel Time</td>
    <td class=DataField>
    <input type=text size=12 maxsize=5 name=alenc097 title="Travel" min=0
    onblur=checkInteger(this,this.title)></td>
	-->
	<td class=DataLabel>%ALLWEB03.01.135.8</td>
    <td><select class="Mandatory SelectBig"
         name=alenc115  title="%ALLWEB03.01.135.8">
    <option></option>
    %ALLWEB03.01.135.2
    </select></td>
	<!-- end of change -->
    <td class=DataLabel>Mileage</td>
    <td class=DataField>
    <input type=text size=12 maxsize=5 name=alenc098 title="Mileage"
     min=0 onblur=checkInteger(this,this.title)></td></tr>

<tr>
	<!-- 01 : CTAS : Move Service Setting above Type of Contact
	Move Claim Type up, Move HP here
	<td class=DataLabel>ALLWEB03.01.135.8</td>
    <td><select class="Mandatory SelectBig"
         name=alenc115  title="ALLWEB03.01.135.8">
    <option></option>
    ALLWEB03.01.135.2
    </select></td>
    <td class=DataLabel>ALLWEB03.01.207.8</td>
    <td><select class="SelectBig"
         name=alenc007  title="ALLWEB03.01.207.8">
    <option></option>
    ALLWEB03.01.207.2
    </select></td>
	-->
	<td class=DataLabel>%ALLWEB03.01.199.011.8</td>
    <td><select class="SelectBig"
         name=alenc120  title="%ALLWEB03.01.199.011.8">
    <option></option>
    %ALLWEB03.01.199.011.2
    </select></td>
	<td class=DataLabel>Travel Time</td>
    <td class=DataField>
    <input type=text size=12 maxsize=5 name=alenc097 title="Travel" min=0
    onblur=checkInteger(this,this.title)></td>
	<!-- end of change -->
    </tr>

<tr>
	<!-- 01 : CTAS : Move HP up
	<td class=DataLabel>ALLWEB03.01.199.011.8</td>
    <td><select class="SelectBig"
         name=alenc120  title="ALLWEB03.01.199.011.8">
    <option></option>
    ALLWEB03.01.199.011.2
    </select></td>
	end of change -->
    <td class=DataLabel>%ALLWEB03.01.199.013.8</td>
    <td><select class="SelectBig"
         name=alenc121  title="%ALLWEB03.01.199.013.8">
    <option></option>
    %ALLWEB03.01.329
    </select></td>
	<!-- 01 : CTAS : Add School -->
	<td class=DataLabel>%ALLWEB03.01.140.34.8</td>
    <td class=DataField>
		<select class="SelectBig"
         name=alref073 title="%ALLWEB03.01.140.34.8">
			<option></option>
			%ALLWEB03.01.140.34.2
		</select>
	</td>
	<!-- end of change -->
    </tr>
<!-- 01 : CTAS : Add School Year -->
<tr>
	<td colspan=2></td>
    <td class=DataLabel>%ALLWEB03.01.140.35.8</td>
    <td class=DataField>
		<select class="SelectBig"
         name=alref074 title="%ALLWEB03.01.140.35.8">
			<option></option>
			%ALLWEB03.01.140.35.2
		</select>
	</td>
<tr>
<!-- end of change -->
</table>

<div id="Wait" style="display:none;">
<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td class=DataLabel width=15%>Stay as Waiting Referral</td>
    <td class=DataField>
    <input type=checkbox name=checkbx1 value="1"></td>
    <td></td>
    <td></td>
    </tr>
</table>
</div>

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td class=DataLabel width=15%>Outcome</td>
    <td class=DataField width=38%>
      <select name=outbb035 id=outbb035 title="Outcome" class="SelectBig"
       onchange="OutcomeChange(this);">
        <option></option>
        %ALLWEB03.01.914.2
      </select>
    </td>
    <td width=15%><div id=divTransDestLbl></div></td>
    <td><div id=divTransDestFld></div></td>
</tr>
</table>

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td class=DataLabel width=15%>Last Contact</td>
    <td class=DataField colspan=3>
      <input type=checkbox name=checkbx2 id=checkbx2 value="1" onclick="ToggleCombo();">
    </td>
</tr>
</table>

<span id=CloseReason style="display: none">
<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td class=DataLabel width=15%>Reason for Closure </td>
    <td class=DataField colspan=3>
    <select name=alref006 title="Reason For Closure" class="">
    <option></option>
    %STANDARD.01.007.LL
    </select></td></tr>
<tr><td class=DataLabel width=15%>Referral To</td>
    <td class=DataField colspan=3>
    <select name=alref072 title="Referral To" class="">
    <option></option>
    %STANDARD.01.007.lG
    </select></td></tr>
<tr><td class=DataLabel width=15%>Date of Next Review</td>
    <td class=DataField colspan=3>
      <input type=text name=alref037 title="Date of Next Review"
       Size=12 onblur="checkDate(this,'Date of Next Review')">
    <a href='javascript:SetCurrentDateTime(UpdateForm.alref037)'>
    <img src=../images/DateTimeStamp.gif  border=0 hspace=4 align=absmiddle></a>
      <img src=../images/DateLookup.gif border=0 hspace=4
       align=absmiddle onclick="DateLookupFrame(alref037);">
</td></tr></table>
</span>

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td class=DataLabel width=15%>Additional HCP</td>
    <td><input type=checkbox name=addithcp value="1"
         onclick="CheckAddHCP();"></td>
    </tr>
</table>

<div id=AdditionalHCP></div>

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td colspan=4 align=center><br>
    <input type=button name=formactn value="Add" class="button" id=all03sub
     onclick="tempDisable(this,4);AddEncounter(UpdateForm);">
<!-- 05 : wp-1345 remove add and finish	button  
 <input type=button name=formactn value="Add and Finish" class="button"
     id=all03sub2
     onclick="tempDisable(this,4);AddAndFinish(UpdateForm);"> 
-->
    <input type=button Value="Cancel" class="button"
     onclick="DFrameClose();">
    </td>
</tr>
</table>
</form>
</div>

<span id="DisplayLinkedHeading" style="display:none;">
    <td class=DataLable>Linked Visit</td>
</span>
<span id="ReadOnlyLinked" style="display:none;">
    <td class=DataField>
    <input type=text size=10 name=alenc008 id=alenc008
     class="Readonly JustifyRight" value="%ALLWEB03.01.305" readonly>
    </td></tr>
</span>
<span id="DisplayLinked" style="display:none;">
    <td class=DataField>
    <input type=text size=10 maxlength=8 name=alenc008 id=alenc008
     value="%ALLWEB03.01.305"
     class="JustifyRight" onblur="justifyRight(this);
     ValidateVisit(UpdateForm.alenc008,UpdateForm.urnumber,dummy1);">
    <img src=../images/SearchIcon.gif class=Icon
    onclick="VisitSearchFrame(UpdateForm.urnumber,UpdateForm.alenc008);">
    </td></tr>
</span>

<span id="ShowAdditionalHCP" style="display:none;">
<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td class=DataLabel width=15%>Additional HCP 1</td>
    <td><input type=text name=alenc025 size=10 maxlength=10
         title="Additional HCP 1" 
         onblur="ValidateHCP(18,0,alenc025,d_alenc025);">
        <input type=text name=d_alenc025 size=20 class=Readonly readonly
         title="Additional HCP 1">
        <img src=../images/SearchIcon.gif class=Icon
         onclick="HCPSearchFrame(alenc025,d_alenc025,0);">
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(alenc025,d_alenc025);">
    </td>
    <td class=DataLabel width=15%>Additional HCP 2</td>
    <td><input type=text name=alenc026 size=10 maxlength=10
         title="Additional HCP 2"
         onblur="ValidateHCP(18,0,alenc026,d_alenc026);">
        <input type=text name=d_alenc026 size=20 class=Readonly readonly
         title="Additional HCP 2">
        <img src=../images/SearchIcon.gif class=Icon
         onclick="HCPSearchFrame(alenc026,d_alenc026,0);">
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(alenc026,d_alenc026);">
    </td></tr>

<tr><td class=DataLabel width=15%>Additional HCP 3</td>
    <td><input type=text name=alenc027 size=10 maxlength=10
         title="Additional HCP 3"
         onblur="ValidateHCP(18,0,alenc027,d_alenc027);">
        <input type=text name=d_alenc027 size=20 class=Readonly readonly
         title="Additional HCP 3">
        <img src=../images/SearchIcon.gif class=Icon
         onclick="HCPSearchFrame(alenc027,d_alenc027,0);">
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(alenc027,d_alenc027);">
    </td>
    <td class=DataLabel width=15%>Additional HCP 4</td>
    <td><input type=text name=alenc028 size=10 maxlength=10
         title="Additional HCP 4"
         onblur="ValidateHCP(18,0,alenc028,d_alenc028);">
        <input type=text name=d_alenc028 size=20 class=Readonly readonly
         title="Additional HCP 4">
        <img src=../images/SearchIcon.gif class=Icon
         onclick="HCPSearchFrame(alenc028,d_alenc028,0);">
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(alenc028,d_alenc028);">
    </td></tr>
</table>
</span>

<span id=spTransDest style="display:none">
   <input type="text" size=7 maxlength=5 name=trnsfsrc id=trnsfsrc
    class=Mandatory title="Transfer Destination"
    onblur="validateTransSrc(trnsfsrc,dummy1,trandesc,desttype);">
   <input type=text size=27 name=trandesc id=trandesc notab
    class=Readonly readonly>
   <img src="../images/SearchIcon.gif" class=Icon
    onclick="TransferSourceFrameOutcome2(trnsfsrc,trandesc,admnsrce);">
</span>

<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc id=trnsfsrc>
</span>

<script type="text/javascript">
var closureReason = "%ALLWEB03.01.106.1";
for (var i=0; i<document.UpdateForm.alref006.length; i++) {
  if (document.UpdateForm.alref006.options[i].value.substring(0,3) ==
      closureReason) {
    document.UpdateForm.alref006.selectedIndex=i;
  } 
}
var referralTo = "%ALLWEB03.01.172.1";
for (var i=0; i<document.UpdateForm.alref072.length; i++) {
  if (document.UpdateForm.alref072.options[i].value.substring(0,3) ==
      referralTo) {
    document.UpdateForm.alref072.selectedIndex=i;
  } 
}</script>
