<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="crdhb">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src="../js/preadmission.js"></script>
<script type="text/javascript" src="../js/CaseTeamSelect.js"></script>
<script type="text/javascript">
function SetWardBed() {
  if (document.UpdateForm.admitbox.checked == true) {
    document.UpdateForm.admitbox.value="1";
    if (document.UpdateForm.ibcnmhos.value!="1") {
       document.UpdateForm.ptmis068.className="Mandatory"; }
   } else {
     document.UpdateForm.admitbox.value="0";
     if (document.UpdateForm.ibcnmhos.value!="1") {
       UpdateForm.ptmis068.className=""; }
  }
}
function SubmitAdm() {
  p=document.UpdateForm
  if(!checkSiteOpBooking(p.urnumber,p.ptmis001)) {
    return;
  }
  validateSuspension(p.urnumber,p.ptmis001,p.datefrom,p.dateto);
  if (p.datefrom.value!='0') {
    if (p.admitbox.value=="1") {
      document.UpdateForm.admitbox.value="0";
      ans=confirm("Warning : Patient has a Suspension record for period \n" +
                  "\t" + p.datefrom.value  + " - " + p.dateto.value + "\n" +
                  "\tPatient will not be admitted");
    } else {
      ans=confirm("Warning : Patient has a Suspension record for period \n" +
                  "\t" + p.datefrom.value  + " - " + p.dateto.value);}
       if (ans!=true) { return; } 
  }
  document.UpdateForm.ptmis004.value = document.UpdateForm.ptmis068.value;
  document.UpdateForm.ptmis005.value = document.UpdateForm.ptmis076.value;
//  if (document.UpdateForm.admitbox.value == "1") {
//    document.UpdateForm.admitbox.value;
    document.UpdateForm.redirect.value="patweb98.pbl?reportno=01&template=043"
         + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
         + "&admissno=";
//  } else {
//    document.UpdateForm.redirect.value="patweb98.pbl?reportno=01&template=001"
//         + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
//         + "&admissno=";
//  }
  if (document.UpdateForm.admitbox.checked == true) {
    if(checkMultipleAdmission(UpdateForm)) { return; }
  }
  SetLinkACC(UpdateForm,"PRE");
  SubmitHidden(UpdateForm);
}
function valClaimCode() {
  if (document.UpdateForm.nwbclaim.value!="") {
     return; }
  validateCode(41,UpdateForm.urnumber,UpdateForm.claimc);
  for (var i =0 ; i < document.UpdateForm.ptmis027.length; i++) {
    if (document.UpdateForm.claimc.value==
            trim(document.UpdateForm.ptmis027.options[i].value.substr(0,3))){
      document.UpdateForm.ptmis027.selectedIndex=i;
    }
  }
}
function validateCodeOnChange(num,trnsfsrc,trndesc,ptmis009) {
  if (validateCode(num,trnsfsrc,trndesc)) {
    validateTransSrcWithRef(trnsfsrc,ptmis009,trndesc); }
}
function getLOSDefault() {
  UpdateForm.ptmis030.value="0";
  var serverURL = "../cgi-bin/comweb80.pbl?reportno=99&remoteno=1" +
                  "&valdcode="+UpdateForm.ptmis011.value.replace(/ /g,"+");
  var returnValue = RSExecute(serverURL);
  if (returnValue.status!=0) {
    return true;
  }
  ReturnValues=returnValue.return_value.split("|")
  UpdateForm.ptmis030.value=ReturnValues[0];
  if (trim(UpdateForm.ptmis030.value)=="") { UpdateForm.ptmis030.value="0"; }
}
//------------------------------------------------------------
// Display Div
//------------------------------------------------------------
function displayDiv(OptionType,Field) {
  if (Field == "AT") {
    if (OptionType.value.substr(0,3) == "WL ") {
      WaitingListHD.innerHTML = waitLsthd.innerHTML;
      WaitingListDT.innerHTML = waitLstdt.innerHTML;
      DateConsultHD.innerHTML = dateClthd.innerHTML;
      DateConsultDT.innerHTML = dateCltdt.innerHTML;
    } else
      if (OptionType.value.substr(0,3) == "ZW ") {
        WaitingListHD.innerHTML = waitLsthd.innerHTML;
        WaitingListDT.innerHTML = waitLstdt.innerHTML;
        DateConsultHD.innerHTML = dateClthd.innerHTML;
        DateConsultDT.innerHTML = dateCltdt.innerHTML;
      } else {
        WaitingListHD.innerHTML = blanklabel.innerHTML;
        WaitingListDT.innerHTML = blanklabel.innerHTML;
        DateConsultHD.innerHTML = blanklabel.innerHTML;
        DateConsultDT.innerHTML = blanklabel.innerHTML;
     }
  }

  if (Field == "PT") {
    if (OptionType.value.substr(6,1) == "B") {
      NewBornHD.innerHTML = newBornhd.innerHTML;
      NewBornDT.innerHTML = newBorndt.innerHTML;
      if (document.UpdateForm.ptmis077 != undefined) {
        document.UpdateForm.ptmis077.className="Mandatory";
      }
      document.UpdateForm.newbmand.value=1;
    } else {
      NewBornHD.innerHTML = blanklabel.innerHTML;
      NewBornDT.innerHTML = blanklabel.innerHTML;
      if(document.UpdateForm.ptmis077!=undefined) {
        document.UpdateForm.ptmis077.className="";
      }
      document.UpdateForm.newbmand.value=0;
    }
  }
}
//
function ShowAdmissionWeight(theForm) {
  BabyAgeHD.innerHTML = babyagehd.innerHTML;
  BabyAgeDT.innerHTML = babyagedt.innerHTML;
  document.UpdateForm.ptmis051.className="";
  document.UpdateForm.ptmis051.min="0";
  document.UpdateForm.agebmand.value=0;

  if(isWhitespace(theForm.ptcnbage.value) ||
     isWhitespace(theForm.pbdate.value) ||
     isWhitespace(theForm.ptmis001.value)) {
     return;
  }

  Bday = new Date();
  Bday.setFullYear(theForm.pbdate.value.substring(6,11));
  monstr= theForm.pbdate.value.substring(3,6)
  if (monstr=="Jan" || monstr=="JAN" || monstr=="jan") mon=00
  if (monstr=="Feb" || monstr=="FEB" || monstr=="feb") mon=01
  if (monstr=="Mar" || monstr=="MAR" || monstr=="mar") mon=02
  if (monstr=="Apr" || monstr=="APR" || monstr=="apr") mon=03
  if (monstr=="May" || monstr=="MAY" || monstr=="may") mon=04
  if (monstr=="Jun" || monstr=="JUN" || monstr=="jun") mon=05
  if (monstr=="Jul" || monstr=="JUL" || monstr=="jul") mon=06
  if (monstr=="Aug" || monstr=="AUG" || monstr=="aug") mon=07
  if (monstr=="Sep" || monstr=="SEP" || monstr=="sep") mon=08
  if (monstr=="Oct" || monstr=="OCT" || monstr=="oct") mon=09
  if (monstr=="Nov" || monstr=="NOV" || monstr=="nov") mon=10
  if (monstr=="Dec" || monstr=="DEC" || monstr=="dec") mon=11
  Bday.setMonth(mon);
  Bday.setDate(theForm.pbdate.value.substring(0,2));

  Adat = new Date();
  Adat.setFullYear(theForm.ptmis001.value.substring(6,11));
  monstr= theForm.ptmis001.value.substring(3,6)
  if (monstr=="Jan" || monstr=="JAN" || monstr=="jan") mon=00
  if (monstr=="Feb" || monstr=="FEB" || monstr=="feb") mon=01
  if (monstr=="Mar" || monstr=="MAR" || monstr=="mar") mon=02
  if (monstr=="Apr" || monstr=="APR" || monstr=="apr") mon=03
  if (monstr=="May" || monstr=="MAY" || monstr=="may") mon=04
  if (monstr=="Jun" || monstr=="JUN" || monstr=="jun") mon=05
  if (monstr=="Jul" || monstr=="JUL" || monstr=="jul") mon=06
  if (monstr=="Aug" || monstr=="AUG" || monstr=="aug") mon=07
  if (monstr=="Sep" || monstr=="SEP" || monstr=="sep") mon=08
  if (monstr=="Oct" || monstr=="OCT" || monstr=="oct") mon=09
  if (monstr=="Nov" || monstr=="NOV" || monstr=="nov") mon=10
  if (monstr=="Dec" || monstr=="DEC" || monstr=="dec") mon=11
  Adat.setMonth(mon);
  Adat.setDate(theForm.ptmis001.value.substring(0,2));

  if (Adat.getTime() >= Bday.getTime()) {
    daysold = Adat.getTime() - Bday.getTime();
    daysold = Math.floor(daysold / (1000 * 60 * 60 * 24));
  } else {
    return;
  }
  CheckBabyWeight(theForm);
}

function CheckBabyWeight(theForm) {
  if (daysold <= theForm.ptcnbage.value) {
    document.UpdateForm.ptmis051.className="Mandatory Number";
    document.UpdateForm.ptmis051.min="1";
    document.UpdateForm.agebmand.value=1;
  } else {
    BabyAgeHD.innerHTML = blanklabel.innerHTML;
    BabyAgeDT.innerHTML = blanklabel.innerHTML;
  }
}
function ValCaseTeam(CaseTeamFld, CaseTeamDesc) {
  if (validateCode2(7,CaseTeamFld, CaseTeamDesc)) {
    var p = document.UpdateForm;
    getHCPbyCaseTeam(p.pmsvx146,p.ptmis007,p.doctnam2,p.ptmis001);
    if (!ValCaseTeamMember()) {
      CaseTeamFld.value = "";
      CaseTeamDesc.value = "";
      CaseTeamFld.focus();
    }
  }
}
function ValCaseTeamMember() {
  if (!isWhitespace(document.UpdateForm.ptmis001.value)&&
      !isWhitespace(document.UpdateForm.ptmis007.value)&&
      !isWhitespace(document.UpdateForm.pmsvx146.value)) {
    var serverURL = "../cgi-bin/allweb01.pbl?reportno=8&functype=7"+
          "&valddate=" + document.UpdateForm.ptmis001.value.replace(/ /g,"+")+
          "&valdhcpc=" + document.UpdateForm.ptmis007.value.replace(/ /g,"+")+
          "&valdteam=" + document.UpdateForm.pmsvx146.value.replace(/ /g,"+")+
          "&valdmode=1";
    var returnValue = RSExecute(serverURL);
    if (returnValue.status != 0) {
      return false;
    }
  }
  return true;
}
// 06 : TAS : Merge Task 0889495					   
function FilterDietList() {
  filterCatCodeList(UpdateForm.ptmis028,"ACTIVE","I","5");
}														  
</script>
%START.OF.PAGE
<!-- 06 : Merge Task 0889495 add FilterDietList to onload -->
<body onload="PageLoad(event); valClaimCode();
              createSpecialtyArray();getHCPSpecialtySelectList();
              defaultSpecialty();FilterMentalHealth(0);FilterDietList();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.03.003";
PatientVIS="%PATWEB89.03.081";
PatientNAM="%PATWEB89.03.002";
PatientSTA="%PATWEB89.03.086.078";
PatientALT="%PATWEB89.03.084";
PatientSEX="%PATWEB89.03.019";
PatientDOB="%PATWEB89.03.020";
PatientAGE="%PATWEB89.03.021";
PatientLOC="%PATWEB89.03.083";
PatientPRI="%PATWEB89.03.086.066.1";
PatientUNT="%PATWEB89.03.066.0";
DoctorCOD="%PATWEB89.03.082.003";
DoctorNAM="%PATWEB89.03.082.002";
PatientAID="%PATWEB89.03.086.090";
PatientIND="%PATWEB89.03.086.091";
PatientCUR="%PATWEB89.03.086.092";
PatientCLC="%PATWEB89.03.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.03.086.094";
PatientCDM="%PATWEB89.03.086.095";
PatientVDH="%PATWEB89.03.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<form name=UpdateForm method=post onsubmit='return validateMandatory(this);'>
<input type=hidden name="urnumber" value="%PATWEB89.03.003">
<input type=hidden name="admissno" value="%PATWEB89.03.101">
<input type=hidden name="updatety" value="1">
<input type=hidden name="reportno" value="2">
<input type=hidden name="redirect">
<input type=hidden name="allocate" value="1">
<input type=hidden name="chckname" value="0">
<input type=hidden name="emradmit" value="0">
<input type=hidden name="emradmis" value="0">
<input type=hidden name="newbmand" value="0">
<input type=hidden name="agebmand" value="0">
<input type=hidden name="ptcnueoc" value="%PATWEB89.03.925">
<input type=hidden name="claimc">
<input type=hidden name="nwbclaim" value="%PATWEB89.03.126.1">
<input type=hidden name="datefrom">
<input type=hidden name="dateto">
<input type=hidden name="exstward" value="%PATWEB89.03.449.1">
<input type=hidden name="ptcnhpcd" value="%PATWEB89.03.930">
<input type=hidden name="residadm" value="%PATWEB89.03.959">
<input type=hidden name="refvisno" value="%PATWEB89.03.960">
<input type=hidden name="refrdate" value="%PATWEB89.03.999.101">
<input type=hidden name="ptcnbage" value="%STANDARD.01.025.021.046.1.3">
<input type=hidden name="pbdate"   value="%PATWEB89.03.020">
<input type=hidden name="ibcnmhos" value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name="contmult" value="1">
<input type=hidden name="contmupt">
<input type=hidden name="leavhosp">
<input type=hidden name="leavadmn">
<input type=hidden name="leavtype">
<input type=hidden name="dontcurr" value="1">
<input type=hidden name="c_ptmis010" id="c_ptmis010"
 value="%PATWEB89.03.111.1">
<input type=hidden name=ptvis029 value="">
<input type=hidden name=ptvis030 value="">
<input type=hidden name=genpprov>
<input type=hidden name=dummy1 value="">
<input type=hidden name=bedstat1>
<input type=hidden name=ptmis004>
<input type=hidden name=ptmis005 title="Bed">
<input type=hidden name=warddesc>
<input type=hidden name=admiscat value="A ">

  <table border=1 colspan=1 width=100% cellspacing=1 cellpadding=1 >
   <tr><td class=HeadingCell align=center colspan=2>
           Patient Pre-Admission Details (New)</td>
	</tr>
</table>
  <table width=95% border=0 cellpadding=0 cellspacing=0 align=center>
<tr><td>
   <table width=100% border=0 class=TableBody cellpadding=1 cellspacing=0>
   <tr><td class=DataLabel>Admission Date </td>
       <td><input type=text size=12 name=ptmis001 id=ptmis001 tabindex=1
                  class=Mandatory title="Admission Date" value="%STANDARD.01.015"
                  onblur="checkDate(this,'AdmissionDate');
                          ShowAdmissionWeight(UpdateForm);
                          getHCPSpecialtySelectList();
                          defaultSpecialty();">
             <img src=../images/CalendarLookup.gif class=Icon 
			 onclick="DateLookupFrame(ptmis001);">  Time
           <input type=text name=ptmis002 size=8 tabindex=2
                  value="%STANDARD.01.016" class="Mandatory"
                  title="Admission Time"
                  onblur="checkTime(this,'AdmissionTime');">
             <img src=../images/DateTimeStamp.gif class=Icon 
                  onclick="SetCurrentDateTime(null,ptmis002);">
		<img src=../images/TimeLookup.gif class=Icon
                  onclick="TimeLookupFrame(ptmis002);"></td>
       <td class=DataLabel>Reason For Admission </td>
		<!-- 04 : Jira WP2-207 Make Reason for Admission -->
	   <td><input tabindex=30 type=text name="ptmis020"
	              title="Reason For Admission" class=Mandatory size=80 
				  maxlength=80>
           </td></tr>
	<!-- End of Change -->
   <tr><td class=DataLabel>%STANDARD.01.017.P </td>
       <td><select name=ptmis011 tabindex=3 class=Mandatory
                   title="%STANDARD.01.017.P "
                   onchange="displayDiv(ptmis011,'PT');
                             getLOSDefault();">
            <option> </option>
             %PATWEB89.03.112.2
            </select></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td class=DataLabel>Referral Source</td>
       <td><select name=ptmis009 tabindex=4 class="Mandatory"
                   title="Referral Source"
                   onchange="DisplayTrnSrc()"
                   onblur="validateCodeOnChange(9,trnsfsrc,trandesc,ptmis009);">
            <option> </option>
             %PATWEB89.03.110.2
           </select></td>
       <td>&nbsp;</td>
       <td><input tabindex=31 type=text name="ptmis021" size=80 maxlength=80>
           </td></tr>

   <tr><td class=DataLabel><div id=TranSrcHeading></div></td>
       <td colspan=3><div id=TranSrc></div></td>

   <tr><td class=DataLabel>Referring HCP</td>
       <td><input type="text" size=10 maxlength=10 name=ptvis028 tabindex=6
			title="Referring HCP"
            onchange="if (checkAlphanumDesc(event,this) != false) {
                        ReadDoc(18,0,ptvis028,genpname,ptvis029,
                                genpprac,ptvis030,genpprov);
                      }">			 
           <input type=text size=25 readonly name=genpname>
           <img src="../images/SearchIcon.gif" class=Icon 
		   onclick="GPHCPSearchFrame(ptvis028,genpname,genpprov,
                                                ptvis029,genpprac,ptvis030,0)">
           <img src="../images/erase.gif" class=Icon
            onclick="clrFields(ptvis028,genpname);"></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td class=DataLabel>Practice</td>
       <td><input type=text name=genpprac size=35 readonly tabindex=7 >
           <img src="../images/SearchIcon.gif" class=Icon  class=Icon 
		   onclick="GPHCGSearchFrame(ptvis028,genpname,genpprov,
                                               ptvis029,genpprac,ptvis030)">
           <img src="../images/erase.gif" class=Icon
            onclick="clrFields(ptvis029,genpprac,ptvis030,genpprov);"></td>
       <td class=DataLabel>%STANDARD.01.017.HP</td>
       <td><select name="ptmis060" tabindex=32 class="Mandatory"
                   title="%STANDARD.01.017.HP">
            <option> </option>
             %PATWEB89.03.151.2
           </select></td></tr>

   <tr><td class="DataLabel">Inform GP</td>
   <td colspan=3><select name="ptvis022" tabindex="8">
        <option value="0">No</option>
        <option value="1" selected>Yes</option>
       </select></td></tr>

   <tr><td class=DataLabel>Readmission Indicator</td>
       <td><select name=ptmis042 tabindex=9>
            <option> </option>
             %PATWEB89.03.138.2
          </select></td>
       <td class=DataLabel>Health Agency</td>
       <td><select name="ptmis061" tabindex=33 class="Mandatory"
                   title="Health Agency">
            <option> </option>
             %PATWEB89.03.152.4
           </select></td></tr>

   <tr><td class=DataLabel>Admission Type</td>
       <td colspan=3><select name=ptmis012 tabindex=10 class="Mandatory"
                   title="Admission Type"
                   onchange="displayDiv(ptmis012,'AT');">
             <option> </option>
             %PATWEB89.03.113.2
           </select></td></tr>

   <tr><td class=DataLabel>Admitting Doctor</td>
       <td><input type="text" size=11 maxlength=6 name=ptmis007 id=ptmis007
            tabindex=11 class="Mandatory" title="Admitting Doctor"
            value="%PATWEB89.03.108.003"
		    onblur="UpCase(this);
                    if (checkAlphanumDesc(event,this) != false) {
                      validateCode(31,ptmis007,doctnam2);
                      getHCPSpecialtySelectList();defaultSpecialty();
                    }"
            onchange="if (checkAlphanumDesc(event,this) != false) {
                        getCaseTeamByHCP(ptmis007,pmsvx146,n_pmsvx146,ptmis001);
                      }">
           <input type=text readonly size=25 name=doctnam2
                  value="%PATWEB89.03.108.002">
           <img src="../images/SearchIcon.gif" class=Icon
            class=Icon onclick="HCPSelectOnClick(ptmis007,doctnam2,pmsvx146,
                                                 n_pmsvx146,dummy1);">
		<img src="../images/erase.gif" class=Icon
            onclick="clrFields(ptmis007,doctnam2,pmsvx146,n_pmsvx146);">
       <td class=DataLabel>Admitting Point</td>
       <td><select name=ptvis046 tabindex=34 title="Admitting Point"
                   onchange="defaultWard()">
            <option></option>
             %PATWEB89.03.290.2
           </select></td></tr>

   <tr><td class=DataLabel>Case Team</td>
       <td><input type=text name=pmsvx146 id=pmsvx146 size=11 maxlength=10 
            title="Case Team" tabindex=12
			onchange="if (checkAlphanumDesc(event,this) != false) {
                        ValCaseTeam(pmsvx146,n_pmsvx146);
                      }">
           <input type=text name=n_pmsvx146 size=42 readonly
            class=Readonly tabindex=-1 title="Team Description">
           <img src="../images/SearchIcon.gif" class=Icon
       onclick="CaseTeamOnClick(pmsvx146,n_pmsvx146,ptmis007,doctnam2,dummy1);">
           <img src="../images/erase.gif" class=Icon
            onclick="clrFields(pmsvx146,n_pmsvx146);">
       </td></tr>
            
   <tr><td class=DataLabel>%STANDARD.01.017.A </td>
       <td>
           <select name=ptmis010 id=ptmis010 tabindex=13
            title="%STANDARD.01.017.A " class="Mandatory">
            <option></option>
              %PATWEB89.03.111.2
           </select>
       </td>
       <td class=DataLabel>Ward / Bed </td>
       <td><select name=ptmis068 tabindex=35 title="Ward">
            <option value=""> </option>
             %PATWEB89.03.449.2
          </select>
          <input type=text name=ptmis076 maxlength=3 size=3 title="Bed"
                 onchange="UpCase(this);">
          <img src=../images/SearchIcon.gif class=Icon
           class=Icon onclick="WardBedSearchFrame(ptmis068,warddesc,
                                                  ptmis076,bedstat1);"></td>
   </tr>

   <tr><td class=DataLabel>%STANDARD.01.017.CL</td>
       <td><select name=ptmis027 title="%STANDARD.01.017.CL" class="Mandatory"
                   tabindex=14 onchange="showACC();">
            <option> </option>
             %PATWEB89.03.126.2
           </select></td>
		 <!-- 03 : TAS : Add Visiting options field
	   <td colspan=2>&nbsp;</td> -->
	   <td class=DataLabel>%STANDARD.01.017.P8</td>
      <td><select name="pmpmi073" title="%STANDARD.01.017.P8" tabindex=36>
          <option></option>
           %PATWEB89.03.873.2
          </select></td>
   </tr>
										 
       <td colspan=2>&nbsp;</td></tr>
     <tr><td><div id=ACCHeading></div></td>
         <td><div id=ACCId></div></tr>


   <tr><td class=DataLabel> Planned Length of Stay</td>
       <td><input type=text size=5 maxlength=5 name=ptmis030 tabindex=15
                   title='Expected Length of Stay' class=Integer value="0"
                   onblur="checkInteger(this,this.value);"></td>
       <td class=DataLabel>Diet</td>
       <td><select name=ptmis028 tabindex=36>
            <option></option>
             %PATWEB89.03.065.2
           </select></td></tr>

<!-- 01 : CTAS : place Admit Now checkbox at bottom right of template 
   <tr><td class=DataLabel>Admit Now</td>
       <td><input type=checkbox value="0" name="admitbox" tabindex=16
                  onclick="SetWardBed();"></td>
       <td colspan=2>&nbsp;</td></tr>
-->
<!-- end of change -->		   

   <tr><td colspan=2></td>
       <td class=DataLabel><div id=BabyAgeHD></div></td>
       <td><div id=BabyAgeDT></div></td></tr>

   <tr><td colspan=2></td>
       <td class=DataLabel><div id=NewBornHD></div></td>
       <td><div id=NewBornDT></div></td></tr>

   <tr><td colspan=2></td>
       <td class=DataLabel><div id=WaitingListHD></div></td>
       <td><div id=WaitingListDT></div></td></tr>

   <tr><td colspan=2></td>
       <td class=DataLabel><div id=DateConsultHD></div></td>
       <td><div id=DateConsultDT></div></td></tr>
	   
<!-- 01 : CTAS : place Admit Now checkbox at bottom right of template -->
   <tr>
	   <td colspan=2>&nbsp;</td>
	   <td class=DataLabel>Admit Now</td>
       <td><input type=checkbox value="0" name="admitbox" tabindex=16
                  onClick="SetWardBed();"></td>
       </tr>
<!-- end of change -->	   

   <tr align=center>
       <td colspan=4>
           <input type=button value="Ok" class="button" tabindex=100
                  id="pat89sub"
                   onclick="tempDisable(this);
					if(checkAdmissionDate()){
             checkBedStatus(ptmis068.value,ptmis076.value,
                            ptmis001.value,ptmis030.value,
                            SubmitAdm);}";></td></tr>
   </table>
</td></tr>

<tr><td><hr></td></tr>

</table>
</form>
</div>

<form name=PatientLinks method=get>
 <input type=hidden name=reportno value=1>
 <input type=hidden name=template value=004>
 <input type=hidden name=urnumber value="%PATWEB89.03.003">
 <input type=hidden name=admissno value="%PATWEB89.03.101">
 <input type=hidden name=MenuType value="%PATWEB89.03.088">
</form>

<form name=linkForm action=patweb89.pbl method=post>
 <input type=hidden name=reportno value=1>
 <input type=hidden name=template value=1>
 <input type=hidden name=urnumber value="%PATWEB89.03.003">
 <input type=hidden name=admissno value="%PATWEB89.03.101">
</form>

<form name=Lookup action=patweb94.pbl method=post>
 <input type=hidden name=reportno value=9>
 <input type=hidden name=template value=1>
 <input type=hidden name=valcateg>
 <input type=hidden name=valdtype>
 <input type=hidden name=valdcode>
</form>


<span id=transferhd style="display:none">Transfer Source</span>

<span id=transfersrc style="display:none">
 <input type="text" size=7 maxlength=5 name=trnsfsrc class=Mandatory
        title="Transfer Source" tabindex=5
        onblur="validateCodeOnChange(9,trnsfsrc,trandesc,ptmis009);">
 <input type=text size=27 name=trandesc class=Readonly readonly>
   <img src="../images/SearchIcon.gif" class=Icon
        class=Icon onclick="TransferSourceFrame(trnsfsrc,trandesc,ptmis009)">
</span>

<span id=transferblank style="display:none">
 <input type=hidden name=trnsfsrc>
</span>

<span id=blanklabel style="display:none">&nbsp;</span>

<span id=newBornhd style="display:none">Gestation Period</span>

<span id=newBorndt style="display:none">
  <input type=hidden name=userdef5 value="U5">
  <select name=ptmis077 title="Gestation Period"tabindex=38>
   <option></option>
     %PATWEB89.03.199.006.2
  </select>
</span>

<span id=waitLsthd style="display:none">Date of Referral</span>
<span id=waitLstdt style="display:none">
  <input type=text size=12 name=ptmis058 tabindex=39 value=""
         onblur="checkDate(this,'ReferralDate')">
    <img src=../images/CalendarLookup.gif class=Icon
         onclick="DateLookupFrame(ptmis058);">
</span>

<span id=dateClthd style="display:none">Date of 1st Spec Consult</span>
<span id=dateCltdt style="display:none">
  <input type=text size=12 name=ptmis059 tabindex=40 value=""
         onblur="checkDate(this,'SpecConDate')">
    <img src=../images/CalendarLookup.gif class=Icon
         onclick="DateLookupFrame(ptmis059);">
</span>

<span id=babyagehd style="display:none">Admission Weight</span>
<span id=babyagedt style="display:none">
  <input type=text name=ptmis051 size=8 maxlength=6 value="" tabindex=37
         title="Admission Weight"
         onblur="justifyRight(this);">
  grams
</span>

<span id=acchd style="display:none">
ACC Purchase Order Number
</span>

<span id=accorderid style="display:none">
  <input type=text name=accpordn id=accpordn title="ACC Purchase Order Number" 
         maxlength=20 size=25>
</span>


<script type="text/javascript">
for (var i=0;i<document.UpdateForm.ptmis060.length;i++){
if (document.UpdateForm.ptmis060.options[i].value.substr(0,3)==
    document.UpdateForm.ptcnhpcd.value){
    document.UpdateForm.ptmis060.selectedIndex=i}};
//
ShowAdmissionWeight(UpdateForm);
//
</script>

<script type="text/javascript">
for (var i=0;i<document.UpdateForm.ptmis060.length;i++){
  if (document.UpdateForm.ptmis060.options[i].value.substr(0,3)==
             document.UpdateForm.ptcnhpcd.value){
    document.UpdateForm.ptmis060.selectedIndex=i}};
//
ShowAdmissionWeight(UpdateForm);
//
if ("%PATWEB89.03.466.1" == "BED" ) { var site="4711" } else { var site="4712" }
//
 if ("%PATWEB89.03.903" == "1") {
   alert("Warning: Patient has a Waiting List Procedure");
 }
 if ("%PATWEB89.03.904" == "1") {
   alert("Warning: Patient has a Booking");
 }
 if ("%PATWEB89.03.905" == "1") {
   alert("Warning: Patient is currently admitted");
 }
 if ("%PATWEB89.03.908" == "1") {
   alert("Warning: Patient has a pre-admission record");
 }
ibcnmhos="%STANDARD.01.025.000.043.1.1"
if (ibcnmhos=="1") { UpdateForm.ptmis068.className="Mandatory" }
</script>

