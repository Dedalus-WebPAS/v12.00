<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="crdhb">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript">
// WU-1322 Merge task 0879217
function enableAdm() {
  var Status=UpdateForm.wattr005.value

  if (Status==1) {
    UpdateForm.wattr049.readOnly = true;
    UpdateForm.wattr049.className = "ReadOnly";
    return;
  } else {
    UpdateForm.wattr049.readOnly = false;
  }
}
// WU-1322 Merge task 0879217
function ValidateAdm(){
  var Status=UpdateForm.wattr005.value

  if (Status==1) {
    UpdateForm.wattr049.readOnly = true;
    UpdateForm.wattr049.className = "ReadOnly";
    return;
  } else {
    UpdateForm.wattr049.readOnly = false;
  }

  if (Status==6 || Status==7 || Status==8 ) {
    UpdateForm.wattr049.className="";
    return;
    }
  else {
    if (Status==1) {
      UpdateForm.wattr049.className="";
    } else {
      UpdateForm.wattr049.className="Mandatory"; 
    }
  }
  if(trim(UpdateForm.wattr049.value)==""){
   return;
  }

  var Urno=UpdateForm.casekeys.value.substring(0,8);
  var serverURL   = "../cgi-bin/watweb01.pbl?reportno=10" +
                    "&liststat=" + UpdateForm.wattr005.value +
                    "&admissno=" + UpdateForm.wattr049.value.replace(/ /g,"+") +
                    "&urnumber=" + Urno.replace(/ /g,"+") +
                    "&casekeys=" + UpdateForm.casekeys.value.replace(/ /g,"+")

  var returnValue = RSExecute(serverURL);
  ReturnValue=returnValue.return_value.split("|");
  if (returnValue.status==0) {
  }
  else {
    UpdateForm.wattr049.value=" "
    UpdateForm.wattr049.focus();
    }

}
function ValChange(OldStatus) {
  NewStatus=UpdateForm.wattr005.value;
  if(OldStatus!=6 && NewStatus == 6) {
    alert("Invalid Status - use remove option");
    for (var i =0 ; i < document.UpdateForm.wattr005.length; i++) {
    if (document.UpdateForm.wattr005.options[i].value==OldStatus) {
        document.UpdateForm.wattr005.selectedIndex=i } };
  }
}
//	 03 : TAS : Merge task 0878880							
function ChangeUR() {
  Left=(document.body.clientWidth-600)/2
  linkurl="watweb01.pbl?reportno=2&template=16" + 
          "&casekeys=" + UpdateForm.casekeys.value.replace(/ /g,"+") +
          "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+") +
		  "&admissno=" + UpdateForm.wattr049.value.replace(/ /g,"+")
  DFrameLink(linkurl,0,Left,600,370)
}
function UpdateDetails() {
  if (validateMandatory(UpdateForm)) {
    document.UpdateForm.submit();
  }
  return;
}
function ShowDateListReason() {
  if(!checkDate(UpdateForm.wattr006,'Date')) {
    return;
  }
  if(UpdateForm.d_wattr006.value!=UpdateForm.wattr006.value) {
     ReasonForChangeTagDIV.innerHTML=ReasonForChangeDefaultTagSPAN.innerHTML;  
     UpdateForm.updfld01.disabled=false;
     UpdateForm.reasfc01.disabled=false;
     UpdateForm.reasfc01.className="Mandatory";
  } else { 
    ReasonForChangeTagDIV.innerHTML=ReasonForChangeTagSPAN.innerHTML;
    UpdateForm.updfld01.disabled=true;
    UpdateForm.reasfc01.selectedIndex=0;
    UpdateForm.reasfc01.disabled=true;
    UpdateForm.reasfc01.className="";
  } 
} 
function EnablePriorityReason() {
  if(UpdateForm.d_wattr014.value!=UpdateForm.wattr014.value.substr(0,3)) {
     UpdateForm.updfld02.disabled=false;
     UpdateForm.reasfc02.disabled=false;
  } else {
    UpdateForm.updfld02.disabled=true;
    UpdateForm.reasfc02.value="";
    UpdateForm.reasfc02.disabled=true;
  }
}
function EnableStatusReason() {
  if(UpdateForm.d_wattr005.value!=UpdateForm.wattr005.value) {
     UpdateForm.updfld09.disabled=false;
     UpdateForm.reasfc09.disabled=false;
  } else {
    UpdateForm.updfld09.disabled=true;
    UpdateForm.reasfc09.value="";
    UpdateForm.reasfc09.disabled=true;
  }
}
function SetAuditReason() {
  if(UpdateForm.reasfc02.disabled==false) {
     UpdateForm.reasfc02.value=UpdateForm.wathi001.value;
  }
  if(UpdateForm.reasfc09.disabled==false) {
     UpdateForm.reasfc09.value=UpdateForm.wathi001.value;
  }
}
// WU-1322 Merge task 0879217
function ChangePPP() {
   if(UpdateForm.oldstat.value!="1"){
     alert("Invalid status to change procedure.");
     return;}
   CASEKEYS=PatientLinks.casekeys.value.replace(/ /g,"+")
   URNUMBER=PatientLinks.urnumber.value.replace(/ /g,"+")
   WATTRKEY=PatientLinks.wattrkey.value.replace(/ /g,"+")
   LinkUrl="watweb01.pbl?reportno=02&template=020&casekeys="+CASEKEYS +
           "&urnumber=" + URNUMBER +
           "&casekeys=" + CASEKEYS
   DFrameLink(LinkUrl,0,0,710,370)
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);enableAdm();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Waiting List Procedure Supervisor Update
</span>

<div id=PageBodySection style="overflow: auto;">

<form name=UpdateForm action="watweb01.pbl" method=post 
 onsubmit='return validateMandatory(this);'>
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=1>
<input type=hidden name=casekeys value="%WATWEB01.02.101">
<input type=hidden name=updttype value="S">
<input type=hidden name=oldstat value="%WATWEB01.02.175">
<input type=hidden name=dummy>
<input type=hidden name=d_wattr005 value="%WATWEB01.02.175">
<input type=hidden name=d_wattr006 value="%WATWEB01.02.109">
<input type=hidden name=d_wattr014 value="%WATWEB01.02.117.1">

<table border=0 width=90% cellspacing=0 align=center>
<tr valign=top><td class=DataLabel>Date on List</td>
    <td class=DataField>
    <input type=text name=wattr006 size=12 
     class=Mandatory title="Date on List" onblur="ShowDateListReason();"
     value="%WATWEB01.02.109">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.wattr006
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.wattr006>
    </td>
    <td class=DataLabel align=right>Reason for Change</td>
    <input type=hidden name=updfld01 value="01" disabled>
    <td width=25% align=right>
       <div id=ReasonForChangeTagDIV>
       <select name=reasfc01 title="Date on List Reason for Change" disabled>
       <option></option>
       %STANDARD.01.007.FW
       </select>
       </div>
    </td></tr>

<tr valign=top><td class=DataLabel>Proposed Admission Date </td>
    <td class=DataField colspan=3>
    <input type=text name=wattr008 size=12
     title="Proposed Admission Date"
     value="%WATWEB01.02.111"  onblur="checkDate(this,'Date')">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.wattr008
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.wattr008>
    </td></tr>


<tr valign=top><td class=DataLabel>Proposed Procedure Date </td>
    <td class=DataField colspan=3>
    <input readonly type=text size=12 name=bokrx023
     class=Readonly title="Proposed Procedure Date"
     value="%WATWEB01.02.423"  onblur="checkDate(this,'Date')">
    </td></tr>

<tr valign=top><td class=DataLabel>Consultant</td>
    <td class=DataField colspan=3>
    <input type=text name=wattr012 size=8 maxlength=8 readonly
     title="Consultant" class=Mandatory value="%WATWEB01.02.115.003"
     onblur="ValidateCat();">
    <input type=text name=n_wattr012 size=40 readonly
    title="Consultant Name" value="%WATWEB01.02.115.002">
    <a href="javascript:WaitConSearchFrame
(UpdateForm.wattr012,UpdateForm.n_wattr012,UpdateForm.wattr011)">
    <img src=../images/SearchIcon.gif class=Icon border=0></a></td></tr>


<tr><td class=DataLabel>Unit</td>
    <td class=DataField colspan=3>
    <select name=wattr011 title="Unit" class=Mandatory 
     onchange="ValidateCat();">
    <option></option>
    %WATWEB01.02.114.2
    </select></td></tr>

<tr><td class=DataLabel>Procedure</td>
    <td class=DataLabel colspan=3>
    <input type=text size=12 name=wattr001 value="%WATWEB01.02.103  "
     readonly title="Procedure Code" class=Readonly >
    <input readonly type=text name=wattr003 size=60 
     maxlength=50 value="%WATWEB01.02.106">
    </td></tr>

<tr valign=top><td class=DataLabel>Planned Length Of Stay </td>
    <td class=DataField colspan=3>
    <input type=text name=wattr013 size=5 maxlength=5 
     title="Planned Length Of Stay" value="%WATWEB01.02.116">(days)
    </td></tr>

<tr valign=top><td class=DataLabel>Status</td>
    <td class=DataLabel colspan=3>
    <input type=hidden name=updfld09 value="09" disabled>
    <input type=hidden name=reasfc09 value="" disabled>
    <select name=wattr005 title="Waiting List Status" class=Mandatory
     title="Status" onchange="ValidateAdm();ValidateCat();
                             ValChange(%WATWEB01.02.175);EnableStatusReason();">
    <option value=1>Unscheduled</option>
    <option value=2>Scheduled</option>
    <option value=3>Pre-Admitted</option>
    <option value=4>Admitted</option>
    <option value=5>Discharged</option>
    <option value=6>Removed</option>
    </select>
    <class=DataLabel>&nbsp;&nbsp;&nbsp;Visit Number
    <class=DataField align=left colspan=4>
    <input type=text name=wattr049 size=10 maxlength=8 value="%WATWEB01.02.125" 
     title="Visit Number" onblur="justifyRight(this);ValidateAdm();">
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.TP    </td>
    <td Class=DataField colspan=3>
    <input type=hidden name=updfld02 value="02" disabled>
    <input type=hidden name=reasfc02 value="" disabled>
    <select name=wattr014 tabindex=4 class=Mandatory readonly 
     title="%STANDARD.01.017.TP"
     onchange="ValidateCat();EnablePriorityReason();">
     <option></option>
     %WATWEB01.02.117.2
     </select></td></tr>

<tr valign=top><td class=DataLabel>Effective Date </td>
    <td class=DataField colspan=3>
    <input type=text name=wathi002 size=12
     class=ReadOnly title="Effective Date"
     value="%WATWEB01.02.315"  onblur="checkDate(this,'Date')">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.wathi002
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.wathi002>
    </td></tr>

<tr><td class=DataLabel>Reason for Change</td>
    <td class=DataLabel colspan=3>
    <select name=wathi001 title="Reason for Change" disabled class=ReadOnly
    onchange="SetAuditReason();">
    <option></option>
    %WATWEB01.02.314.2
    </select>
    </td></tr>

<tr><td class=DataLabel>Certainty Date</td>
    <td class=DataField colspan=3>
    <input type=text name=wattr025 size=12 
     value="%WATWEB01.02.132"  onblur="checkDate(this,'Date');"
     title="Decision to Admit Date" tabindex=55>
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.wattr025
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.wattr025>
    </td></tr>

<tr><td colspan=4 align=center>
    <input type=button class="button" value="Ok" onclick="UpdateDetails();">
    <input type=button value="Cancel" class="button" onclick='DFrameExit()'>
    <input type=button class="button" value="Change U/R"
     onclick='ChangeUR();'>
	<!-- 02 : TAS : WU-1322 Merge task 0879217 -->
	<input type=button class="button" value="Change Proc."
     onclick='ChangePPP();'>
    </td></tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%WATWEB01.02.003">
<input type=hidden name=admissno value="%WATWEB01.02.081">
<input type=hidden name=MenuType value="%WATWEB01.02.088">
<input type=hidden name=casekeys value="%WATWEB01.02.101">
<input type=hidden name=wattrkey value="%WATWEB01.02.101">
<input type=hidden name=sesskeys value="">
</form>

<script type="text/javascript">
function init(){
  var Status=UpdateForm.wattr005.value
  if (Status==1 || Status==6 || Status==7 || Status==8 ) {
    UpdateForm.wattr049.className="";
    }
  else {
    UpdateForm.wattr049.className="Mandatory";
  }
}

function ValidateCat() {
  ConsCode="%WATWEB01.02.115.003";
  Category="%WATWEB01.02.117.1";
  if((ConsCode!= document.UpdateForm.wattr012.value) || 
     (Category != document.UpdateForm.wattr014.value.substr(0,3))) {
    document.UpdateForm.wathi002.className="Mandatory";
    document.UpdateForm.wathi001.className="Mandatory";
    document.UpdateForm.wathi002.readonly= false;
    document.UpdateForm.wathi001.readonly= false;
    document.UpdateForm.wathi001.disabled= false;
    SetCurrentDateTime(document.UpdateForm.wathi002);
  }
  Status="%WATWEB01.02.175";
  Unit="%WATWEB01.02.114.1";
  if((Status!=UpdateForm.wattr005.value) || 
     (Unit!=UpdateForm.wattr011.value.substr(0,3))) {
    document.UpdateForm.wathi001.className="Mandatory";
    document.UpdateForm.wathi001.readonly= false; 
    document.UpdateForm.wathi001.disabled= false;
   }
}
//
Status="%WATWEB01.02.175";
 for (var i =0 ; i < document.UpdateForm.wattr005.length; i++) {
  if (document.UpdateForm.wattr005.options[i].value==Status.substr(0,1)) {
       document.UpdateForm.wattr005.selectedIndex=i } };
//
</script>

<span id=ReasonForChangeTagSPAN style="display:none">
<select name=reasfc01 title="Date on List Reason for Change" disabled>
       <option></option>
       %STANDARD.01.007.FW
       </select>
</span>

<span id=ReasonForChangeDefaultTagSPAN style="display:none">
<select name=reasfc01 title="Date on List Reason for Change">
       <option></option>
       %STANDARD.01.021.FW
       </select>
</span>
