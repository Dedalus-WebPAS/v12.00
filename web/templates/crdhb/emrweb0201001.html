<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="crdhb">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<link rel="stylesheet" href="../html/postcode.css" type="text/css">
<script type="text/javascript" src="../js/IBA_Category_C_.js"></script>
<script type="text/javascript" src="../js/IBA_Category_LA.js"></script>
<script type="text/javascript" src="../js/EmrRegistration.js"></script>
<script type="text/javascript" src="../js/emrweb0201102.js"></script>
<!-- 01 : CTAS : added link to CTAS custom javascript file -->
<script type="text/javascript" src="../js/ctascustom.js"></script>
<!-- end of change -->
<script type="text/javascript">
// 01 : CTAS : constant values section
var DHB_FUNDED = "35";	// DHB-funded option in purchaser list (HP)
var RESIDENT = "R";		// Resident indicator value in type of residency list (T)
var ISACC = "R02";		// Yes option in ACC? list (ep)
var ISACCIDENT = "R01";	// Accident option in claim type list (CL)
var NONACCIDENT = "R02";// Non-Accident option in claim type list (CL)
// end of change

function ReadDocOnly(OptionNumber,OptionType,ReturnCode,ReturnName) {
  ReturnName.value="";
  if (isWhitespace(ReturnCode.value)) return;;
  var serverURL  = "../cgi-bin/patweb80.pbl?reportno=" + OptionNumber +
               "&returnfm=2" + "&valdtype=" + OptionType +
               "&valdcode=" + ReturnCode.value.replace(/ /g,"+")

  var returnValue = RSExecute(serverURL);

  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    ReturnName.value=trim(ReturnValue[0]); }
 else {
    ReturnCode.value="";
    ReturnCode.select();
    return false; }
}
// Copy of HCPSearchFrame without all clears that effect GPHCGSearchFrame //
function HCPSearchFrame(ReturnCode,ReturnName,ReturnProv,ReturnPrac,ReturnDesc,ReturnCntr) {
  DFrameStart()
  SearchType="" ;
  window.ReturnFunction="" ;
  for (var i=6; i < HCPSearchFrame.arguments.length; i++) {
    if (typeof(HCPSearchFrame.arguments[i]) == 'function') {
      window.ReturnFunction=HCPSearchFrame.arguments[i] }
    else {
      SearchType=HCPSearchFrame.arguments[i]
    } }

  window.ReturnCode=ReturnCode ;
  window.ReturnName=ReturnName ;
  window.ReturnProv=ReturnProv ;
  window.ReturnPrac=ReturnPrac ;
  window.ReturnDesc=ReturnDesc ;
  window.ReturnCntr=ReturnCntr ;
  document.getElementById('PopUpFrame').src="../lookups/HCPSearchFrame"+SearchType+".html"
  SearchFrameShow()
}

function init() {
  SetFields();
  if (isWhitespace(top.menu.location.search)) { }
  else {
  PageLocation="?reportno=1&template=4" +
               "&urnumber=" + PatientURN.replace(/ /g,"+") +
               "&admissno=" + PatientVIS.replace(/ /g,"+") 
  if (top.content.location.search!=PageLocation) {
    top.content.location.href="emrweb02.pbl" + PageLocation }
  }
  checkReferred();
  CheckAmbType();
  // 01 : CTAS : From emrweb0201002.html
  // to search for patient if there is no UR
   if(document.UpdateForm.urnumber.value=="       0"){
   linkUrl="patweb90.pbl?reportno=1&template=103"
   DFrameLink(linkUrl,0,25,getClientWidth()-40,getClientHeight()-40)
   }
  // end of change
}
function valClaimCode() {
// Do not default the claim code if one has already been entered
  if(!isWhitespace(document.UpdateForm.deftclam.value)) {
    return;                      
  }
  validateCode(41,UpdateForm.urnumber,UpdateForm.claimc);
  for (var i =0 ; i < document.UpdateForm.emvis008.length; i++) {
    if (document.UpdateForm.claimc.value==
        trim(document.UpdateForm.emvis008.options[i].value.substr(0,3))){
          document.UpdateForm.emvis008.selectedIndex=i;
    }
  }
}

function setNotForResus() {
  if (document.UpdateForm.nfresusc.checked == true)
    document.UpdateForm.pmpxi064.value = 1;
  else
    document.UpdateForm.pmpxi064.value = 0;
}
function updateNHI01() {
  if (validateMandatory(UpdateForm)) {
    setACCEmerFlag();
    document.UpdateForm.redirect.value="nhiweb99.pbl?reportno=01&template=002" +
    "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+")  +
    "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+") +
    "&emerflag=" + document.UpdateForm.emerflag.value.replace(/ /g,"+") ;
    UpdatePageNZ();
  }
}
function setACCEmerFlag() {
  ind1=document.UpdateForm.emvis008.value.substr(3,1)
  ind2=document.UpdateForm.emvis008.value.substr(4,1)
  ind3=document.UpdateForm.emvis008.value.substr(5,1)
  ind4=document.UpdateForm.emvis008.value.substr(6,1)
  ind5=document.UpdateForm.emvis008.value.substr(7,1)
  if((ind1=="W")||(ind2=="W")||(ind3=="W")||(ind4=="W")||(ind5=="W")) {
    document.UpdateForm.emerflag.value="4";       // flag for ACC
  } else {
    document.UpdateForm.emerflag.value="1";
  }
}

// 01 : CTAS : add custom javascript
function SearchDoctor() {
	if (UpdateForm.emcndoct.value==1) {
		DoctorEmrSearchFrame(UpdateForm.emvis020,UpdateForm.dummy3);
	} else {
		DoctorSearchFrame(UpdateForm.emvis020,UpdateForm.dummy3);
	}
}

function getPresentCom(SearchField,ReturnSelect,CatCode) {
  var serverURL   = "../cgi-bin/patweb80.pbl?reportno=32" +
                    "&valdcode=" + SearchField.value.replace(/ /g,"+") +
                    "&valdcatc=" + CatCode.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnSelect.options.length=0
    ReturnValue=returnValue.return_value.split("|");
    for (var j=0; j < ReturnValue.length; j++) {
       if (!isWhitespace(ReturnValue[j])) {
         SelectValue=ReturnValue[j].split(",");
         ReturnSelect.options[ReturnSelect.options.length]=
          new Option(SelectValue[1],SelectValue[0]); } } }
}

// clear purchaser if non-resident, otherwise default to DHB-funded
function setPurchaser() {
	// do not clear if there was a previous value
	if(isWhitespace(document.UpdateForm.emvis160.value)) {
		isResident = getIndicatorValue(document.UpdateForm.ptmas020, 3);
		if (isResident != RESIDENT) {
			document.UpdateForm.emvis160.value = "";
		} else {
			var purchaserlist = document.UpdateForm.emvis160;
			if (isWhitespace(purchaserlist.value)) {
				for (j=0; j<purchaserlist.length; j++) {
					if (purchaserlist.options[j].value.substr(0,3).replace(/ /g,"") == DHB_FUNDED) {
						purchaserlist.value = purchaserlist.options[j].value;
					}
				}
			}
		}
	}
}

// default claim type based on acc status
function setClaimType() {
	var claimlist = document.UpdateForm.emvis008;
	if (claimlist.value.replace(/ /g,"") == "") {
		isacc = document.UpdateForm.accstatus.value.replace(/ /g,"");
		if (isacc == ISACC) {
			for (i=0; i<claimlist.length; i++) {
				if (claimlist.options[i].value.substr(0,3).replace(/ /g,"") == ISACCIDENT) {
					claimlist.value = claimlist.options[i].value;
				}
			}
		} else {
			for (i=0; i<claimlist.length; i++) {
				if (claimlist.options[i].value.substr(0,3).replace(/ /g,"") == NONACCIDENT) {
					claimlist.value = claimlist.options[i].value;
				}
			}		
		}
	}
}
// end of change

// 01 : CTAS : Default Inform GP to YES
function setInformGP() {
	var mySelect = document.getElementById('pmsvx010');
	// default only if nothing is selected
	if(isWhitespace(mySelect.value)) {
		for(var i, j = 0; i = mySelect.options[j]; j++) {
			if(i.value == '1') {
				mySelect.selectedIndex = j;
				break;
			}
		}
	}
}
// end of change
// 01 : CTAS : Overload checkReferred to use CAT S emvis011
// overloaded from EmrRegistration.js
function checkReferred() {
  i=document.UpdateForm.emvis011.selectedIndex;
  ind=document.UpdateForm.emvis011.options[i].value.substr(5,1)
  if(ind=="1") {
    TranSrcHeading.innerHTML=transferhd.innerHTML;
    TranSrc.innerHTML=transfersrc.innerHTML;
  } else {
    TranSrc.innerHTML=transferblank.innerHTML;
    TranSrcHeading.innerHTML="";
  }
  if(ind=="2") {
    if(document.UpdateForm.emvis019!=undefined){
      document.UpdateForm.emvis019.className="Mandatory";}
  }
}
// end of change

function displayReferralFields() {
//Display referral fields only if Eclipse Store and Forward parameter is
//turned on and the Source of Referral (cat em) has indicator4 = R
  if (document.getElementById('ptcnuesf') != null &&
      document.getElementById('ptcnuesf').value == "1" &&
      document.UpdateForm.emvis061.value.substr(6,1) == "R") {
      emvis174TitleDIV.innerHTML = emvis174TitleSPAN.innerHTML;
//    emvis175TitleDIV.innerHTML = emvis175TitleSPAN.innerHTML;
      emvis176TitleDIV.innerHTML = emvis176TitleSPAN.innerHTML;
      emvis174FieldDIV.innerHTML = emvis174FieldSPAN.innerHTML;
//    emvis175FieldDIV.innerHTML = emvis175FieldSPAN.innerHTML;
      emvis176FieldDIV.innerHTML = emvis176FieldSPAN.innerHTML;
      emvis020TitleDIV.innerHTML = emvis020TitleSPAN.innerHTML;
      emvis020FieldDIV.innerHTML = emvis020FieldSPAN.innerHTML;

      displaycatRF();
  }
  else {
       emvis174TitleDIV.innerHTML = "";
       emvis175TitleDIV.innerHTML = "";
       emvis176TitleDIV.innerHTML = "";
       emvis174FieldDIV.innerHTML = "";
       emvis175FieldDIV.innerHTML = "";
       emvis176FieldDIV.innerHTML = "";
       emvis020TitleDIV.innerHTML = "";
       emvis020FieldDIV.innerHTML = "";
  }
}
function displaycatRF() {
    if (document.UpdateForm.emvis174.value.substr(3,1) == "N") {
      emvis175TitleDIV.innerHTML = emvis175TitleSPAN.innerHTML;
      emvis175FieldDIV.innerHTML = emvis175FieldSPAN.innerHTML;
    } else {
      emvis175TitleDIV.innerHTML = "";
      emvis175FieldDIV.innerHTML = "";
    }
}
function showMobilePhoneDet() {
  if(document.getElementById("ptcnsmsn").value == "1") {
    MobilePhone.innerHTML = showMobPhoneOptOut.innerHTML;
    if(document.getElementById('ptmsx050').value=="1") {
      document.getElementById('d_ptmsx050').checked=true;
    }
  }
  else {
    MobilePhone.innerHTML = showMobPhoneOnly.innerHTML;
  }
}
// 05 : TAS : Overload of mobile field validation from Standard.js modified to accept 8-13 digits
//========================================================================
// Validate a Mobile Phone Number (basic edit) - Only contain numbers & spaces.
// Can (optionally) start with a + followed by country code (up to 3 digits).
// Number without country code can be up to 13 digits long.
// <input type=text name=xxxxxxx class=MobilePhone
//========================================================================
function checkMobilePhone(theField) {
  if (isWhitespace(theField.value))
    return true;

   //match=theField.value.match(/^\+?[0-9 ]*$/);

   var theNum = trim(theField.value);  // trim any trailing spaces

   //Regex for AU and NZ mobile phone numbers
   match=theNum.match(/^(?:\+[0-9]{1,3})?((?:[0-9]\s*){10,13}|(?:[0-9]\s*){8,13})$/);

  if (!match) {
    alert(theField.title + " is an invalid mobile phone number")

    var agentStr = window.navigator.userAgent;

    // For Chrome use Focus Delay to prevent looping
    if (agentStr.indexOf("Chrome") != -1) {
      FocusDelay(theField);
    }
    else {
      theField.focus();
    }
    return false;
  }

  return true;
}
function UpdatePageNZ() {
  if (validateMandatory(UpdateForm)) {
    validateDemographicsConfirmedDate();
    if (document.UpdateForm.preaddset.value==1) {
      ans=confirm("Do you want to update the Previous Address details?");
      if (ans) {
        document.UpdateForm.prevaddr.value="1";
      }
      document.UpdateForm.preaddset.value=1;
    }
    UpdInterpreter();
//
    if (document.UpdateForm.aliasset.value==1) {
      ans=confirm("Save as an Alias ?");
      if (ans) {
        document.UpdateForm.savealia.value="1";
      }
      document.UpdateForm.aliasset.value="1";
    }
    if (document.UpdateForm.redirect.value.substr(0,12)!=="nhiweb99.pbl") {
      setRedirectAdmNZ();
    }
    document.UpdateForm.UpdateButton.disabled=true;
    document.UpdateForm.formactn.value="C1"
    document.UpdateForm.updttype.value="TRIAG"
    document.UpdateForm.target="PopUpFrame";

// this checks to see if it is being used outside the MAPVIEW
    if (isWhitespace(top.menu.location.search)) {
      document.UpdateForm.nextpage.value=9
    }
    SetOptOutSMS();
    setTimeout('document.UpdateForm.UpdateButton.disabled=false',1000);
    document.UpdateForm.submit()
  }
}
function validateDemographicsConfirmedDate() {
  f = document.UpdateForm;
  if (f.ptcnavcd.value == "1") {
    f.ptmas086.value = f.currdate.value;
    return;
  }
  else {
    if (f.ptcnavcd.value == "2") {
      if (!isWhitespace(f.ptmas086.value)) {
        if (f.ptmas086.value !=
            f.currdate.value ) {
          alert("Warning: Confirm Demographics date has not been updated");
          f.ptmas086.value = f.ptmas086.defaultValue;
        }
      }
      return;
    }
  }
}
</script>
%START.OF.PAGE
<!-- 01 : CTAS : add calls to default-setting functions
<body onLoad="PageLoad(event);valClaimCode();DisplayResidency();
	displayReferralFields();">
-->
<body onLoad="PageLoad(event);valClaimCode();DisplayResidency();
        DispPrefGivenName();
	setPurchaser();setClaimType();setInformGP();displayReferralFields();
	showMobilePhoneDet();ChkIdentifyGenderPronounTitle(document.UpdateForm);">
<!-- end of change -->
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%EMRWEB02.01.003";
PatientVIS="%EMRWEB02.01.081";
PatientNAM="%EMRWEB02.01.002";
PatientSTA="%EMRWEB02.01.086.078";
PatientALT="%EMRWEB02.01.084";
PatientSEX="%EMRWEB02.01.019";
PatientDOB="%EMRWEB02.01.020";
PatientAGE="%EMRWEB02.01.021";
PatientLOC="%EMRWEB02.01.083";
PatientPRI="%EMRWEB02.01.086.066.1";
PatientUNT="%EMRWEB02.01.066.0";
PatientIND="%EMRWEB02.01.086.091";
GpCOD="%EMRWEB02.01.086.084.001";
GpNAM="%EMRWEB02.01.086.084.081";
GpPRAC="%EMRWEB02.01.086.085.001";
GpPRACCNT="%EMRWEB02.01.086.085.002";
GpPRACNAM="%EMRWEB02.01.086.085.005";
PatientARR="%EMRWEB02.01.101.0 %EMRWEB02.01.102";
PatientSEE="%EMRWEB02.01.130.0 %EMRWEB02.01.131";
PatientTRI="%EMRWEB02.01.103.3";
PatientECLC="%EMRWEB02.01.484.1";
PatientCLH="%STANDARD.01.017.CL";
PatientEHFT="%EMRWEB02.01.485";
InsertEmergencyHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<form name=UpdateForm action="emrweb02.pbl" method=post>
  <input type=hidden name=reportno value="01">
  <input type=hidden name=updatety value="4">
  <input type=hidden name=formactn value="C1">
  <input type=hidden name=updttype value="TRIAG">
  <input type=hidden name=histtype value="REGIS">
  <input type=hidden name=updateky value="%EMRWEB02.01.404">
  <input type=hidden name=admissno value="%EMRWEB02.01.146">
  <input type=hidden name=urnumber value="%EMRWEB02.01.003">
  <input type=hidden name=emvis118 value="%EMRWEB02.01.003">
  <input type=hidden name=dummyadm>
  <input type=hidden name=fpatname>
  <input type=hidden name=chckname>
  <input type=hidden name=redirflg value="1">
  <input type=hidden name=mvmedrec>
  <input type=hidden name=emerflag value="1">
  <input type=hidden name=dontchec value=1>
  <input type=hidden name=nextpage value="11">
  <input type=hidden name=redirect>
  <input type=hidden name=ptcnueoc value="%EMRWEB02.01.454">
  <input type=hidden name=pmpxi064 value="%EMRWEB02.01.664">
  <input type="hidden" name="savealia" value="0">
  <input type="hidden" name="aliasset" value="0">
  <input type="hidden" name="prevaddr" value="0">
  <input type="hidden" name="preaddset" value="0">
  <input type="hidden" name="claimc">
  <input type="hidden" name=deftclam value="%EMRWEB02.01.108.1">
  <input type="hidden" name="ptcnrerd" value="%STANDARD.01.025.118.250.0.1">
 <!-- 03 : TAS : 12-MAR-2018 : Add department/specialty field --> 
	<input type=hidden name=emvis009 value="%EMRWEB02.01.109.0"> 
 <!-- 01 : CTAS : add custom hidden fields to UpdateForm -->
	<input type=hidden name=accstatus value="%EMRWEB02.01.224.1">
	<input type=hidden name=emcndoct value="%EMRWEB02.01.455">
  <!-- end of change -->
  <!-- 01 : CTAS : add custom fields for patient search pop-up -->
	<input type=hidden name=searchgn value="%EMRWEB02.01.010">
	<input type=hidden name=searchsn value="%EMRWEB02.01.009">
	<input type=hidden name=searchps value="%EMRWEB02.01.019">
	<input type=hidden name=searchpd value="%EMRWEB02.01.020">
  <!-- end of change -->
    <input type="hidden" name="stfrefin" id="stfrefin"
   value="%EMRWEB02.01.919">
  <input type=hidden name=dummx value="">
  <input type="hidden" name="ptcnuesf" id="ptcnuesf"
   value="%STANDARD.01.025.124.222.0.1">
  <input type=hidden name=ptcnsmsn id=ptcnsmsn
         value="%STANDARD.01.025.120.243.0.1">
  <input type=hidden name=ptmsx050 id=ptmsx050
         value="%EMRWEB02.01.085.066.1">
<!-- TAS : 06 : Merge task 0893679 -->
  <input type=hidden name=ptcnnewc id=ptcnnewc
         value="%STANDARD.01.025.118.138.0.1">
<input type=hidden name=pchgdte id=pchgdte value="%EMRWEB02.01.085.070">
  <input type=hidden name=ptmautim id=ptmautim value="%EMRWEB02.01.085.071">
  <input type=hidden name=ptmauuid id=ptmauuid value="%EMRWEB02.01.085.072.0">
  <input type=hidden name=d_ptmauuid id=d_ptmauuid
   value="%EMRWEB02.01.085.072.1">
  <input type=hidden name=sjogaudt value="1">
  <input type=hidden name=sjogaudi value="1">
  <input type=hidden name=currdate value="%STANDARD.01.015">
  <input type=hidden name=ptcnavcd value="%STANDARD.01.025.125.183.0.1">
  <input type=hidden name=ptcnnmpr value="%STANDARD.01.025.128.226.1.1">
  <input type=hidden name=ptcndfgn value="%STANDARD.01.025.120.182.0.1">
  <input type=hidden name=nhmas002 value="%EMRWEB02.01.070.004">
  <input type=hidden name=nhmas003 value="%EMRWEB02.01.070.005">
  <input type=hidden name=nhmas004 value="%EMRWEB02.01.070.006">
  <input type=hidden name=nhmas005 value="%EMRWEB02.01.070.007">

<table align=center width=100% border=0 cellspacing=0 cellpadding=0>
  <tr><td colspan=6 class=HeadingCell align=center>
          Demographic Details</td></tr>

  <tr><td class=DataLabel width=11%>Title</td>
	  <td width=20%>
		<select title="Patient Title" name=ptmas001 id=ptmas001 tabindex=1 
	       class=Mandatory>
           <option></option>
            %STANDARD.01.029
          </select></td>
       <td class=DataLabel width=11%>Address Line 1</td>
       <td width=20%><input type=text size=25 maxlength=25 name="ptmas008" 
	   tabindex=6	
                  title="Address Line 1" class=Mandatory value="%EMRWEB02.01.012"
                  onClick="updateNHI01()"
                  onKeyUp="if (IsEditKeyPress(event)) updateNHI01();"></td>
      <td width=11% class=DataLabel>Private Phone</td>
      <td width=27%><input type=text size=23 maxlength=20 name=ptmas012
	  tabindex=11
            title="Private Phone No" value="%EMRWEB02.01.017"
			class="Phone"></td></tr>			

  <tr><td class=DataLabel>Surname</td>
      <td><input type=text size=40 name=ptmas005 title="Patient Surname"
                 maxlength=40 class=Mandatory value="%EMRWEB02.01.009" tabindex=2
                 onClick="updateNHI01()"
                 onKeyUp="if (IsEditKeyPress(event)) updateNHI01();"></td>
      <td class=DataLabel>&nbsp;</td>
      <td><input type=text size=25 maxlength=25 name=ptmas009
                 title="Address Line 2" tabindex=7 value="%EMRWEB02.01.013"
                 onClick="updateNHI01()"
                 onKeyUp="if (IsEditKeyPress(event)) updateNHI01();"></td>
      <td class=DataLabel>Business Phone</td>
      <td><input type=text size=23 maxlength=20 name=ptmas013 tabindex=12
            title="Business Phone No" value="%EMRWEB02.01.018"
			class="Phone"></td></tr>

  <tr><td class=DataLabel>Given Names</td>
      <td><input tabindex=3 name=ptmas006 maxlength=25 
	  title="Patient Given Names"
                size=25 value="%EMRWEB02.01.010" type=text class=Mandatory
                onClick="updateNHI01()" 
                onKeyUp="if (IsEditKeyPress(event)) updateNHI01();"></td>
      <td class=DataLabel>&nbsp;</td>
      <td><input type=text size=25 maxlength=25 title="Address Line 3" 
		tabindex=8 value="%EMRWEB02.01.014" readonly name=ptmas010
                 onClick="updateNHI01()"
                 onKeyUp="if (IsEditKeyPress(event)) updateNHI01();"></td>
      <td class=DataLabel>Mobile Phone</td>
      <td><div id=MobilePhone></div></td>
 </tr>

   <tr id=PrefGivenName style="display:none">
    <td class=DataLabel>Preferred Given Name</td>
    <td><input type=text size=25 maxlength=25 name=pmpxi083
         title="Preferred Given Name" value="%EMRWEB02.01.698"
         tabindex=3 onchange="UpCase(this);checkPrefGivenName('%EMRWEB02.01.698');"></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td></tr>


   <tr><td class=DataLabel>%STANDARD.01.017.G </td>
       <td><select name="ptmas014" title="%STANDARD.01.017.G " 
            class=Mandatory tabindex=4
            onClick="updateNHI01()"
            onKeyUp="if(IsEditKeyPress(event)) updateNHI01();"
			onchange="ChkIdentifyGenderPronounTitle(document.UpdateForm);">
           <option></option>
           %EMRWEB02.01.086.099.061.9.1.19.3.H
          </select></td>
      <td class=DataLabel>&nbsp;</td>
      <td><input type=text size=25 maxlength=25 name=ptmas011 
			title="Address Line 4"
                 tabindex=9 value="%EMRWEB02.01.015"
                 onClick="updateNHI01()"
                 onKeyUp="if(IsEditKeyPress(event)) updateNHI01();"></td>
</tr>

   <tr><td class=DataLabel>Date of Birth</td>
       <td><input type=text size=12 name=ptmas016 title="Date of Birth" tabindex=5
                  value="%EMRWEB02.01.020" class=Mandatory
                  onClick="updateNHI01()"
                  onKeyUp="if(IsEditKeyPress(event)) updateNHI01();"></td>     
      <td class=DataLabel>Domicile</td>
      <td><input type=text maxlength=4 name=ptmas011 title="Domicile" tabindex=10
                 value="%EMRWEB02.01.070.015" class=Mandatory size=5
                 onClick="updateNHI01()"
                 onKeyUp="if(IsEditKeyPress(event)) updateNHI01();">
          <input readonly class="Readonly" value="%EMRWEB02.01.070.024" tabindex=-1></td>
	  <td>&nbsp;</td>
      <td>&nbsp;</td>
   </tr>

<tr id=GenderExtra>
  <td><div id=IdenGenLbl></div></td>
  <td><div id=IdenGenDetail></div></td>
  <td><div id=IdenProLbl></div></td>
  <td><div id=IdenProDetail></div></td>
</tr>
</table>
<table align=center width=100% border=0 cellspacing=0 cellpadding=0>
   <tr> 
     <td width=31%>&nbsp;</td>
     <td width=24% id=lstuptdg></td>
     <td width=7%>&nbsp;</td>
     <td class=DataLabel width=11%
       id=DemogDateLbl>Demographics Confirmed Date</td>
     <td class=DataLabel width=11% id=DemogDateLblBlue>
       <font color=#1E90FF>Demographics Confirmed Date</td>
     <td width=20%>
       <input type=text name=ptmas086 id=ptmas086
        title="Demographics Confirmed Date" 
        tabindex=14 value="%EMRWEB02.01.085.059">
       <img src="../images/DateTimeStamp.gif" class=Icon
        onclick="SetCurrentDateTime(UpdateForm.ptmas086,null);">
       <img src="../images/DateLookup.gif" class=Icon
        onclick="DateLookupFrame(UpdateForm.ptmas086);"></td>
      <td width=7%>&nbsp;</td>
  </tr>
</table>

<table align=center width=100% border=0 cellspacing=0 cellpadding=0>
  <tr><td colspan=6 class=HeadingCell align=center>PMI Details</td></tr>

  <tr><td class=DataLabel>Previous Name</td>
      <td width=20%><input type="text" name="ptmas007" title="Previous Name"
                 value="%EMRWEB02.01.011" tabindex=15></td>
	<!-- Occupation -->
	<td class=DataLabel>%STANDARD.01.017.P6</td>
    <td><select name=ptmas043 tabindex=16 class=select120>
        <option></option>
         %EMRWEB02.01.048.9.2
        </select></td>				 
      <td class=DataLabel>Religion</td>
      <td><select name=ptmas019 tabindex=17 class=select120>
           <option></option>
            %EMRWEB02.01.023.2
          </select></td></tr>

  <tr><td class=DataLabel>Ethnicity 1</td>
      <td><select name=ethncty1 tabindex=18 readonly title="Ethnicity 1"
                  onClick="updateNHI01()"
                  onKeyUp="if(IsEditKeyPress(event)) updateNHI01();">
           <option></option>
            %EMRWEB02.01.070.020.2
          </select></td>      
      <td class=DataLabel>Ethnicity 2</td>
      <td><select name=dummy tabindex=19 readonly title="Ethnicity 2"
                  onClick="updateNHI01()"
                  onKeyUp="if(IsEditKeyPress(event)) updateNHI01();">
           <option></option>
            %EMRWEB02.01.070.021.2
          </select></td>      
      <td class=DataLabel>Ethnicity 3</td>
      <td><select name=dummy tabindex=20 readonly title="Ethnicity 3"
                  onClick="updateNHI01()"
                  onKeyUp="if(IsEditKeyPress(event)) updateNHI01();">
           <option></option>
            %EMRWEB02.01.070.022.2
          </select></td></tr>

  <tr><td class=DataLabel>Iwi 1</td>
      <td><select title="Iwi 1" name=pmpxi078 tabindex=21>
           <option></option>
            %EMRWEB02.01.686.2
          </select></td>
      <td class=DataLabel>Iwi 2</td>
      <td><select title="Iwi 2" name=pmpxi079 tabindex=22>
           <option></option>
            %EMRWEB02.01.687.2
          </select></td>
      <td class=DataLabel>Iwi 3</td>
      <td><select title="Iwi 3" name=pmpxi080 tabindex=23>
           <option></option>
            %EMRWEB02.01.688.2
          </select></td></tr>

  <tr><td class=DataLabel>Local GP</td>
      <td><input type="text" size=8 maxlength=10 name=pmpxi059 tabindex=24  
                 value="%EMRWEB02.01.684.001" title="Local GP"
                 onblur="ReadDoc(18,0,pmpxi059,genpname,pmpxi060,genpprac,
                                 pmpxi061,genpprov);">
          <input type=text size=25 readonly name=genpname
                 value="%EMRWEB02.01.684.081" title="Local GP Name">
            <img class=Icon src="../images/SearchIcon.gif"
                 onClick="GPHCPSearchFrame(pmpxi059,genpname,genpprov,pmpxi060,
                                           genpprac,pmpxi061,3)">
            <img class=Icon src="../images/erase.gif" align=absmiddle 
                 onClick="clrFields(pmpxi059,genpname);"></td>
<!-- 01 : CTAS : folder selection moved
      <td class=DataLabel>Folder Selection</td>
      <td><select name=pmpxi077 tabindex=24 title="Folder Selection">
           <option></option>
            EMRWEB02.01.679.2
          </select></td>
      <td>&nbsp;</td>
      <td>&nbsp;</td></tr>
-->	 
<td class=DataLabel>Practice</td>
      <td><input type=hidden name=pmpxi060 value="%EMRWEB02.01.685.001">
          <input type=text size=25 readonly name=genpprac tabindex=25
                 value="%EMRWEB02.01.685.005" title="Practice">
          <input type=hidden name=pmpxi061 value="%EMRWEB02.01.661">
          <input type=hidden name=genpprov value="">
            <img class=Icon src="../images/SearchIcon.gif"
                 onClick="GPHCGSearchFrame(pmpxi059,genpname,genpprov,pmpxi060,
                                           genpprac,pmpxi061)">
            <img class=Icon src="../images/erase.gif" align=absmiddle
                 onClick="clrFields(pmpxi060,genpprac,pmpxi061,genpprov);"></td>
<!-- 02 : DXC : Added from NZ template and hidden to prevent IE error -->				 
<!--  <td class=DataLabel>Not for Resuscitation</td>-->
    
    <span style="display: none">
	<input type=checkbox name=nfresusc value="1" tabindex=26 class='ctasHidden'
                 onclick="setNotForResus();">
	</span>			 
<!--
      <td>&nbsp;</td>
      <td>&nbsp;</td></tr>
-->
<!-- end of change -->
	<td class=DataLabel>GP Name if Not On System</td>
    <td><input type=text name=ptmas034 tabindex=26 size=30 maxlength=30 
		value="%EMRWEB02.01.039"></td>
  </tr>

  <tr><td class=DataLabel>Inform GP</td>
      <td><select name=pmsvx010 id=pmsvx010 tabindex=27 title="Inform GP">
           <option></option>
           <option value="0">NO</option>
           <option value="1">YES</option>
          </select></td>
      <td class=DataLabel>Folder Selection</td>
      <td><select name=pmpxi077 tabindex=28 title="Folder Selection">
           <option></option>
            %EMRWEB02.01.679.2
          </select></td>
      <td>&nbsp;</td>
      <td>&nbsp;</td></tr>

  <tr><td class=DataLabel>Interpreter Required</td>
      <td><select title="Interpreter Required" name=pmpxi001 tabindex=29
		   title="Interpreter Required">
           %EMRWEB02.01.601.2
          </select></td>
      <td class=DataLabel>Pref Language 1</td>
      <td><select name=pmpxi002 class="select120" tabindex=30
                  title="Preferred Language">
           <option></option>
            %EMRWEB02.01.602.2
          </select></td>
      <td class=DataLabel>Pref Language 2</td>
      <td><select name=pmpxi003 class=select120 tabindex=31
                 title="Preferred Language">
           <option></option>
            %EMRWEB02.01.603.2
          </select></td></tr>
</table>


<table align=center width=100% border=0 cellspacing=0 cellpadding=0>
  <tr><td colspan=8 class=HeadingCell align=center>Residency Details</td></tr>

  <tr><td class=DataLabel width=11%>Country of Birth</td>
      <td width=20%><select name="ptmas018" class="select120" tabindex=32
                 title="Country of Birth">
           <option></option>
          </select>
  <script type="text/javascript">
   SetCategoryC_(document.UpdateForm.ptmas018,"%EMRWEB02.01.022.1")
  </script>

      </td>
      <td width=11% class=DataLabel><div id=CountryHeading></div></td>
      <td width=20%><div id=CountryResidence></div></td>
      <td class=DataLabel>&nbsp;</td>
      <td>&nbsp;</td>
      <td class=DataLabel>&nbsp;</td>
      <td>&nbsp;</td>
  </tr>

  <tr><td class=DataLabel>Type of Residency</td>
      <td><select name=ptmas020 tabindex=33 class=Mandatory
         title="Type of Resident" onclick="updateNHI01();"
         onKeyUp="if (IsEditKeyPress(event)) updateNHI01();">
         <option></option>
         %EMRWEB02.01.024.5
        </select></td>
      <td class=DataLabel><div id=ExpiryHeading></div></td>
      <td><div id=ExpiryDate></div></td>

      <td class=DataLabel><div id=VisaHeading></div></td>
      <td><div id=Visa></div></td>

      <td class=DataLabel><div id=NZISHeading></div></td>
      <td><div id=NZIS></div></td></tr>
</table>

<table align=center width=100% border=0 cellspacing=0 cellpadding=0>
  <tr><td class=DataLabel width=11%>Residency Comments</td>
      <td width=40%>
	    <input type="text" name="pmres004" size=145 maxlength=127
          value="%EMRWEB02.01.481" tabindex=34></td>
	  <td width=8%>&nbsp;</td>
      <td width=8%>&nbsp;</td>
      <td width=8%>&nbsp;</td>
      <td width=8%>&nbsp;</td>
      <td width=8%>&nbsp;</td>
      <td width=9%>&nbsp;</td>
</tr>
 </table>
<table align=center width=100% border=0 cellspacing=0 cellpadding=0>
<tr>
  <td class=HeadingCell colspan=6 align=center>
    Emergency Visit Details 
  </td>
</tr>
<tr>
  <td class=DataLabel>Arrival Date/Time</td>
  <td width=20%>
    <input type=text size=12 max=12 name="emvis001" tabindex=35
     value="%EMRWEB02.01.101.0" class="Mandatory BackDate"
	 title="Arrival Date" onblur="checkDate(this, 'Date');CheckAdateHCPdate(UpdateForm.emvis165.value);"> 
	<img notab src=../images/DateLookup.gif border=0 hspace=4
	   align=absmiddle onclick="DateLookupFrame(emvis001);">
    <input type=text size=8 max=8 name="emvis002" tabindex=36
     value="%EMRWEB02.01.102" class='Mandatory Time'
	 title="Arrival Time" onblur="checkTime(this,'Arrival Time');
checkTATime(UpdateForm,UpdateForm.emvis165.value,UpdateForm.emvis166.value);">
	<img notab src=../images/DateTimeStamp.gif class=Icon
	   onClick="SetCurrentDateTime(emvis001,emvis002);">
	<img notab src=../images/TimeLookup.gif class=Icon
	   onclick="TimeLookupFrame(emvis002);">	 
  </td>
   	<td class=DataLabel><label for=emvis006>Location</label></td>
    <td><select name=emvis006 tabindex=42 title="Location" 
		id=emvis006 class="SelectBig">
        <option></option>
        %EMRWEB02.01.106.2
        </select>
	</td>	
</tr>
<tr><td class=DataLabel>Responsible HCP</td>
    <td><input type="text" size=9 maxlength=10 name="emvis164" tabindex=13
              title="Responsible HCP" value="%EMRWEB02.01.285.1"
              onblur="UpCase(this);validateCode(3,emvis164,doctnam2)">
        <input type=text readonly size=25 notab name=doctnam2
               title="Responsible HCP" value="%EMRWEB02.01.285.0">
        <img notab src="../images/SearchIcon.gif" class="Icon"
             onclick="DoctorSearchFrame(UpdateForm.emvis164,
                      UpdateForm.doctnam2);">
        <img class=Icon src="../images/erase.gif"
           onClick="clrFields(emvis164,doctnam2);">
        <input type=text size=12 max=12 name="emvis165" class="NotFuturEdate"
               title="Date" onblur="checkDate(this, 'Date');CheckAdateHCPdate(this.value);"
               value="%EMRWEB02.01.286">
        <img notab src=../images/DateLookup.gif border=0 hspace=4
             align=absmiddle onclick="DateLookupFrame(emvis165);">
        <input type=text size=8 max=8 name="emvis166" title="Time"
            value="%EMRWEB02.01.287"
              onblur="checkTime(this,'Time');CheckFutureTime(UpdateForm,UpdateForm.emvis165.value,UpdateForm.emvis166);
checkTATime(UpdateForm,UpdateForm.emvis165.value,UpdateForm.emvis166.value);">
        <img notab src=../images/DateTimeStamp.gif class=Icon
           onClick="SetCurrentDateTime(emvis165,emvis166);">
        <img notab src=../images/TimeLookup.gif class=Icon
           onclick="TimeLookupFrame(emvis166);">
        <img notab src=../images/SwapIcon.gif class=Icon
           onclick="swapAdateRdate();">
    </td>
  <td class=DataLabel>Type of Visit</td>
  <td>
    <select class="Mandatory SelectMed" name=emvis053 tabindex=47
     title="Type of Visit">
      <option></option>
      %EMRWEB02.01.213.2
    </select>
  </td>
</tr>

    <tr>
      <td class=DataLabel>Department/Specialty</td>
      <td>
        <select class="Mandatory SelectMed" name=emvis009 tabindex=37
			         title="Dept/Specialty">
			    <option></option>
			    %EMRWEB02.01.109.9.1.21.2.1
			  </select>
      </td>

    <td class=DataLabel>Referring Doctor</td>
    <td><input type=text size=6 name=emvis020 id=emvis020
		title="Referring Doctor" tabindex=43 value="%EMRWEB02.01.120.001"
		onblur="UpCase(this);validateCode(3,emvis020,dummy3)" >
		<input type=text size=18 name=dummy3 title="Doctor Name"
		value="%EMRWEB02.01.120.081" readonly class=Readonly id=dummy3>
		<img src="../images/SearchIcon.gif" onclick="SearchDoctor();" tabindex=-1>
	</td>
  <td><div id=TranSrcHeading></div></td>
  <td><div id=TranSrc></div></td>
</tr>

<tr>
  <td class=DataLabel>%STANDARD.01.017.CL</td>
  <td>
    <select class="SelectMed Mandatory" name=emvis008 tabindex=38 
     title="%STANDARD.01.017.CL">
      <option></option>
      %EMRWEB02.01.108.2
    </select>
  </td>
  	<td class=DataLabel>%EMRWEB02.01.111.8</td>
    <td>
		<select class="Mandatory SelectMed" name=emvis011 tabindex=44 
		 title="%EMRWEB02.01.111.8" value="%EMRWEB02.01.111.1" onchange="checkReferred();">
		  <option></option>
		  %EMRWEB02.01.111.2
		</select>
	</td>
</tr>
<tr>
  <td class=DataLabel>Arrival Transport</td>
  <td>
    <select name=emvis013 class="Mandatory SelectMed" title="Arrival Transport"
     onchange="document.UpdateForm.emvis034.disabled=0;CheckAmbType();" tabindex=39>
      <option></option>
      %EMRWEB02.01.113.2
    </select>
  </td>
  <td class=DataLabel>Amb Case No</td>
  <td>
    <input type=text size=10 maxlength=15 name=emvis034 tabindex=45
     onFocus="CheckAmbType();" value="%EMRWEB02.01.134" title="Amb Case No"
     onblur="ValidateAmbCase();">
  </td>
  <td></td><td></td>
<!-- 01 : CTAS
  <td class=DataLabel>Clerical ID</td>
  <td>
    <input type=text size=3 maxlength=3 name=emvis062 tabindex=39 
     class=Mandatory title="Clerical ID" value="EMRWEB02.01.222.1" 
     onchange="CheckCode(emvis062,v062name)">
    <select name=v062name class="Mandatory SelectMed" 
     onchange="UpdateCode(emvis062,v062name)">
      <option></option>
      EMRWEB02.01.222.2
    </select>
  </td>
-->
</tr>
<!-- 02 : DXC : Add title -->
<tr>
  <td>%STANDARD.01.017.HP</td>
  <td>
    <select class=Mandatory name=emvis160 tabindex=40 title="%STANDARD.01.017.HP">
      <option value=""></option>
      %EMRWEB02.01.281.1.5
    </select>
  </td>
<!-- end of change -->
<!-- Alcohol Involved - CAR 312772/TSK 0817059 -->
<!-- 01 : CTAS
  <td>STANDARD.01.017.es</td>
  <td>
    <select name=emvis067>
      <option value=""></option>
      %EMRWEB02.01.227.2
    </select>
  </td>
-->
	<td class=DataLabel><label for=emvis064>%STANDARD.01.017.ep</label></td>
	<td><select name=emvis064 title="%STANDARD.01.017.ep" 
		id=emvis064 tabindex=46>
	<option></option>
	%EMRWEB02.01.224.2
	</select></td>
  <td>&nbsp;</td>
  <td>&nbsp;</td>
</tr>

<tr>
    <td class=DataLabel>Presenting Complaint</td>
    <td>
		<input type=hidden name=emrviscat value="el">
      <input type="text" size=10 tabindex=41 value="%EMRWEB02.01.220.1" id=prescomp
        onKeyUp="UpCase(this);getPresentCom(this,UpdateForm.emvis060,emrviscat);">
      <select name=emvis060 value="%EMRWEB02.01.220.0" class="SelectBig Mandatory" tabindex=-1>
    	  <option></option>
			  %EMRWEB02.01.220.2
      </select>
    </td>	
</tr>

<tr><td class=DataLabel></td>
     <td>
     </td>
     <td class=DataLabel>
       <div id="emvis174TitleDIV">
       </div>
     </td>
     <td>
       <div id="emvis174FieldDIV">
       </div>
     </td>
     <td class=DataLabel>
       <div id="emvis176TitleDIV">
       </div>
     </td>
     <td>
       <div id="emvis176FieldDIV">
       </div>
     </td>
</tr>

<tr><td class=DataLabel></td>
     <td></td>
     <td class=DataLabel>
       <div id="emvis175TitleDIV">
       </div>
     </td>
     <td>
       <div id="emvis175FieldDIV">
       </div>
     </td>
     <td class=DataLabel>
       <div id="emvis020TitleDIV">
       </div>
     </td>
     <td>
       <div id="emvis020FieldDIV">
       </div>
     </td>
</tr>
</table>

<table align=center width=100% border=0 cellspacing=0 cellpadding=0>
<tr><td>&nbsp;</td></tr>
<tr>
  <td colspan=6 align=center class=DataLabel>
    <input type=button class="button" name=UpdateButton value="Update" tabindex=50
           onclick="if (CheckPhoneFields()) {UpdatePageNZ();}">
    <input type=button class="button" value="Prev GP" name=pregpbut tabindex=51
           style="display:none"
           onclick='PatientLinkTo("patweb98.pbl",1,99,1,700,400);'>
    <input type=button class="button" value="Cancel" tabindex=52
           onclick='fnPatientLink("%EMRWEB02.01.003","%EMRWEB02.01.081");'>
  </td>
</tr>
</table>
</form>
</div>

<div id=SelectHeading></div>
<div id=SelectLocation></div>

<script type="text/javascript">
 PatientSex="%EMRWEB02.01.019"
 for (var i =0 ; i < document.UpdateForm.ptmas014.length; i++) {
   if (document.UpdateForm.ptmas014.options[i].value==PatientSex.substr(0,1)) {
       document.UpdateForm.ptmas014.selectedIndex=i } };
 for (var i=0; i < document.UpdateForm.ptmas001.length; i++) {
  if (document.UpdateForm.ptmas001.options[i].value=="%EMRWEB02.01.005.0"){
      document.UpdateForm.ptmas001.selectedIndex=i;
  }
}

if ("%EMRWEB02.01.664" == "1") {
  document.UpdateForm.nfresusc.checked = true;
}
  GPValue="%EMRWEB02.01.510"
  if(GPValue=="No"){
    GPValue="0";
  }
  else if(GPValue=="Yes"){
    GPValue="1"
  }
  for (var i =0 ; i < document.UpdateForm.pmsvx010.length; i++) {
    if (document.UpdateForm.pmsvx010.options[i].value==GPValue.substr(0,1)) {
       document.UpdateForm.pmsvx010.selectedIndex=i } };

 ChgClaim="%EMRWEB02.01.488"
 if ( ChgClaim == "1") {
   document.UpdateForm.emvis008.disabled=true;
   document.UpdateForm.emvis008.className=""; }

</script>

<form name=HiddenFields method=get>
<input type=hidden name=cob value="%EMRWEB02.01.022.1">
<input type=hidden name=pl1 value="%EMRWEB02.01.602.1">
<input type=hidden name=pl2 value="%EMRWEB02.01.603.1">
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=admissno value="%EMRWEB02.01.081">
<input type=hidden name=MenuType value="%EMRWEB02.01.088">
<input type=hidden name=emrgflag value="Y">
<input type=hidden name=nextpage value="4">
</form>

<span id=transferhd style="display:none">
<td class=DataLabel>Transfer Source</td>
</span>

<span id=transferblank style="display:none">
<input type=hidden name=emvis032 value="" notab>
</span>

<span id=transfersrc style="display:none">
  <td>
    <input type="text" size=8 maxlength=6 name="emvis032" tabindex=37
     value="%EMRWEB02.01.132.1" title="Transfer Source" class=Mandatory
     onchange='validateCode(9,emvis032,trnsfsrc);'>
    <input type=text  size=25 name=trnsfsrc value="%EMRWEB02.01.132.0"
     readonly notab>
    <img class=Icon src="../images/SearchIcon.gif"
     onClick=" TransferSourceFrame(emvis032,trnsfsrc)">
	   </td>
</span>

<span id=showMobPhoneOnly style="display:none">
  <td>
    <input type=text size=23 maxlength=20
      name=ptmsx042 title="Mobile Phone No" tabindex=13
      value="%EMRWEB02.01.085.043">
  </td>
</span>
<span id=showMobPhoneOptOut style="display:none">
  <td>
    <input type=text size=23 maxlength=20
      name=ptmsx042 class=MobilePhone title="Mobile Phone No" tabindex=13
      value="%EMRWEB02.01.085.043">
    Opt-Out SMS
    <input type=checkbox name=d_ptmsx050 id=d_ptmsx050 value=""
      onclick="checkAdd01();">
  </td>
</span>

<script type="text/javascript">
function DisplayResidency() {
  i=document.UpdateForm.ptmas020.selectedIndex;
  ind=document.UpdateForm.ptmas020.options[i].value.substring(5,6)
  if (ind=="T") {
    ExpiryHeading.innerHTML=expiryhd.innerHTML;
    ExpiryDate.innerHTML=expirydate.innerHTML;
    VisaHeading.innerHTML=visahd.innerHTML;
    Visa.innerHTML=visano.innerHTML;
    CountryResidence.innerHTML=countryblank.innerHTML;
    CountryHeading.innerHTML="";
    document.UpdateForm.pmres001.value="";
    NZISHeading.innerHTML="";
    NZIS.innerHTML=NZISblank.innerHTML;
    document.UpdateForm.pmres014.className="";
  } else if (ind=="N"){
    CountryResidence.innerHTML=countryresidence.innerHTML;
    CountryHeading.innerHTML=countryheading.innerHTML;
    ExpiryDate.innerHTML=expiryblank.innerHTML;
    ExpiryHeading.innerHTML="";
    Visa.innerHTML=visablank.innerHTML;
    VisaHeading.innerHTML="";
    document.UpdateForm.pmres005.value="";
    document.UpdateForm.pmres002.value="";
    SetCategoryC_(document.UpdateForm.pmres001,"%EMRWEB02.01.478.1")
    NZISHeading.innerHTML="";
    NZIS.innerHTML=NZISblank.innerHTML;
    document.UpdateForm.pmres014.className="";
  } else if (ind=="V"){
    ExpiryHeading.innerHTML=expiryhd.innerHTML;
    ExpiryDate.innerHTML=expirydate.innerHTML;
    VisaHeading.innerHTML=visahd.innerHTML;
    Visa.innerHTML=visano.innerHTML;
    CountryResidence.innerHTML=countryresidence.innerHTML;
    CountryHeading.innerHTML=countryheading.innerHTML;
    SetCategoryC_(document.UpdateForm.pmres001,"%EMRWEB02.01.478.1") 
    NZISHeading.innerHTML=NZIShd.innerHTML;
    NZIS.innerHTML=NZISno.innerHTML;
    document.UpdateForm.pmres014.className="Mandatory";
  } else {
    ExpiryDate.innerHTML=expiryblank.innerHTML;
    ExpiryHeading.innerHTML="";
    Visa.innerHTML=visablank.innerHTML;
    VisaHeading.innerHTML="";
    document.UpdateForm.pmres005.value="";
    document.UpdateForm.pmres002.value="";
    CountryResidence.innerHTML=countryblank.innerHTML;
    CountryHeading.innerHTML="";
    document.UpdateForm.pmres001.value="";
    NZISHeading.innerHTML="";
    NZIS.innerHTML=NZISblank.innerHTML;
    document.UpdateForm.pmres014.className="";
  }
  if(document.UpdateForm.ptcnrerd.value=="1"){
    document.UpdateForm.ptmas020.className="ReadOnly";
    document.UpdateForm.ptmas020.readOnly=true;
    document.UpdateForm.pmres001.className="ReadOnly select120";
    document.UpdateForm.pmres001.readOnly=true;
    document.UpdateForm.pmres002.className="ReadOnly Date";
    document.UpdateForm.pmres002.readOnly=true;
    document.UpdateForm.pmres004.className="ReadOnly";
    document.UpdateForm.pmres004.readOnly=true;
    document.UpdateForm.pmres005.className="ReadOnly";
    document.UpdateForm.pmres005.readOnly=true;
    document.UpdateForm.pmres014.className="ReadOnly";
    document.UpdateForm.pmres014.readOnly=true;
    document.UpdateForm.ptmas020.disabled=true;
  }
}
</script>

<span id=expiryhd style="display:none">
<td class=DataLabel>Expiry Date</td>
</span>

<span id=expirydate style="display:none">
    <td><input type=text size=12 name=pmres002 tabindex=34 
         class="Mandatory Date" title="Expiry Date" 
        value="%EMRWEB02.01.479" onblur="checkDate(this,'Expiry Date');">
        <img src=../images/DateLookup.gif border=0 hspace=4
         class=Icon onclick="DateLookupFrame(pmres002);">
        <img src=../images/DateTimeStamp.gif border=0 hspace=4 
         class=Icon onclick="SetCurrentDateTime(pmres002,null);">
    </td></tr>
</span>

<span id=expiryblank style="display:none">
    <input type=hidden name=pmres002>
</span>

<span id=countryblank style="display:none">
    <input type=hidden name=pmres001>
</span>

<span id=countryheading style="display:none">
  <td class=DataLabel>Country of Residence</td>
</span>

<span id=countryresidence style="display:none">
  <td>
    <select name="pmres001" tabindex=16 class="select120 Mandatory" 
     title="Country of Residence">
      <option></option>
    </select>
  </td>
</span>

<span id=visablank style="display:none">
    <input type=hidden name=pmres005>
</span>

<span id=visahd style="display:none">
  <td class=DataLabel>Passport/Visa Number</td>
</span>

<span id=visano style="display:none">
  <td>
    <input type=text size=12 name=pmres005 class="Mandatory" 
     title="Passport/Visa Number" value="%EMRWEB02.01.483">
  </td>
</tr>
</span>
<span id=NZISblank style="display:none">
  <input type=hidden name=pmres014>
</span>
<span id=NZIShd style="display:none">NZIS Client Number</span>
<span id=NZISno style="display:none">
  <input type=text size=20 maxlength=20 name=pmres014 class=""
   title="NZIS Client Number" value="%EMRWEB02.01.586">
</span>

<span id="emvis174TitleSPAN" style="display:none">
      %STANDARD.01.017.RF
</span>
<span id="emvis174FieldSPAN" style="display:none">
       <select name="emvis174" tabindex=38 class="SelectMed"
        title="%STANDARD.01.017.RF" onchange="displaycatRF();">
         <option></option>
         %EMRWEB02.01.293.2
         </select>
</span>
<span id="emvis176TitleSPAN" style="display:none">
         Referral Date
</span>
<span id="emvis176FieldSPAN" style="display:none">
         <input type=text size=12 name=emvis176 title="Referral Date"
          value="%EMRWEB02.01.295" tabindex=41
          onblur="checkDateSV(this,'Valid to');" >
         <img notab src="../images/DateLookup.gif" class="Icon"
           alt="Show Calendar" date="UpdateForm.emvis176">
</span>
<span id="emvis175TitleSPAN" style="display:none">
         Referral Period (Months)
</span>
<span id="emvis175FieldSPAN" style="display:none">
         <input type=text name=emvis175 title="Referral Period (Months)"
          class=Number size=15 maxlength=2 min=1 max=98
          value="%EMRWEB02.01.294">
</span>
 <span id="emvis020TitleSPAN" style="display:none">
 Referring HCP
 </span>

 <span id="emvis020FieldSPAN" style="display:none">
 <input type="text" size=8 maxlength=10 name=emvis020 tabindex=47
              value="%EMRWEB02.01.120.001"
              onchange="ReadDocOnly(18,0,emvis020,doctnam1);">
          <input type=text size=20 readonly name=doctnam1 tabindex=-1
              value="%EMRWEB02.01.120.081">
          <img src="../images/SearchIcon.gif" class=Icon
           onclick="HCPSearchFrame(UpdateForm.emvis020,doctnam1,dummx,dummx,dummx,dummx);">
          <img src="../images/erase.gif" class=Icon
           onclick="clrFields(emvis020,doctnam1);">
 </span>

<span id=idenGenLblShow style="display:none">
  <td class=DataLabel>%STANDARD.01.035.Gi</td>
</span>
<span id=idenGenDetailShow style="display:none">
  <td><select name=pmpxi125 id=pmpxi125 class=Mandatory tabindex=5
       title="%STANDARD.01.035.Gi"
       onchange="IdenGenderChange(document.UpdateForm);">
      <option></option>
       %EMRWEB02.01.086.099.063.9.2
      </select><br>
      <span id=IdenGenFreeTxt></span>
  </td>
</span>
<span id=idenGenDetailBlank style="display:none">
  <td><input type=hidden name=pmpxi125 id=pmpxi125 value=""></td>
  <td><input type=hidden name=pmpxi126 id=pmpxi126 value=""></td>
</span>
<span id=idenGenFreeTxtShow style="display:none">
  <input type=text name=pmpxi126 id=pmpxi126 size=80 maxlength=80
   class=Mandatory tabindex=5
   title="Identifying Gender Free Text"
   value="%EMRWEB02.01.086.099.065">
</span>
<span id=idenGenFreeTxtBlank style="display:none">
  <td><input type=hidden name=pmpxi126 id=pmpxi126 value=""></td>
</span>

<span id=idenProLblShow style="display:none">
  <td class=DataLabel>%STANDARD.01.035.Gp</td>
</span>
<span id=idenProDetailShow style="display:none">
  <td><select name=pmpxi127 id=pmpxi127 class=Mandatory tabindex=10
       title="%STANDARD.01.035.Gp"
       onchange="IdenPronounChange(document.UpdateForm);">
      <option></option>
       %EMRWEB02.01.086.099.064.9.2
      </select><br>
      <span id=IdenProFreeTxt></span>
  </td>
</span>
<span id=idenProDetailBlank style="display:none">
  <td><input type=hidden name=pmpxi127 id=pmpxi127 value=""></td>
  <td><input type=hidden name=pmpxi128 id=pmpxi128 value=""></td>
</span>
<span id=idenProFreeTxtShow style="display:none">
  <input type=text name=pmpxi128 id=pmpxi128 size=80 maxlength=80
   class=Mandatory tabindex=10
   title="Identifying Pronoun Free Text"
   value="%EMRWEB02.01.086.099.066">
</span>
<span id=idenProFreeTxtBlank style="display:none">
  <td><input type=hidden name=pmpxi128 id=pmpxi128 value=""></td>
</span>
<script type="text/javascript">
f = document.UpdateForm;
for(var i=0; i<document.UpdateForm.emvis160.length; i++){
  if(document.UpdateForm.emvis160.options[i].value.substring(0,3)=="%EMRWEB02.01.281.0"){
     document.UpdateForm.emvis160.selectedIndex=i;
     break;
  }
}
PrevGP="%EMRWEB02.01.571";
if ( PrevGP == "1"  ) {
   document.UpdateForm.pregpbut.style.display="";
   document.UpdateForm.pregpbut.className="RedButton";
}
if (isWhitespace(f.pchgdte.value) || isWhitespace(f.ptmauuid.value)) {
  var lstupd = "Demographics Last updated by () on "
}
else {
  var lstupd = "Demographics Last updated by " + trim(f.ptmauuid.value) +
               " (" + trim(f.d_ptmauuid.value) + ") " + 
               f.ptmautim.value.substr(0,5) + " on " + f.pchgdte.value;
}
document.getElementById('lstuptdg').innerText = lstupd;
document.getElementById('lstuptdg').className = "RedText";
document.getElementById('DemogDateLbl').style.display = "none";
document.getElementById('DemogDateLblBlue').style.display = "";

function swapAdateRdate()
{
  UpdateForm.emvis165.value=UpdateForm.emvis001.value;
  UpdateForm.emvis166.value=UpdateForm.emvis002.value;
}
function CheckAdateHCPdate(hcpDate){
  arrivalDate=UpdateForm.emvis001.value;
  if(arrivalDate==""){ return;}
  if(hcpDate==""){ return;}
  aDate = new Date(arrivalDate);
  hDate = new Date(hcpDate);

  if(hDate<aDate ){
      alert("Warning: Responsible HCP Date cannot be prior to arrival date");
      UpdateForm.emvis165.value="";
  }
}
function checkTATime(theForm,checkHdate,checkHtime)
{
 checkAdate=UpdateForm.emvis001.value;
 checkAdate=checkAdate.replace(/:/g,"");
 checkAtime=UpdateForm.emvis002.value;
 checkAtime=checkAtime.replace(/:/g,"");
 checkHtime=checkHtime.replace(/:/g,"");
 if(checkAdate==""){ return;}
 if(checkHdate==""){ return;}
 if(checkHtime==""){ return;}
 if(checkAtime==""){ return;}
 if (SetDateYYYYMMDD(checkAdate)>=SetDateYYYYMMDD(checkHdate)) {

   if(checkAtime>checkHtime){
     alert("Responsible HCP Time cannot be prior to arrival time");
     UpdateForm.emvis166.value="";
     return false;
   }
 }
 return true;
}
</script>
