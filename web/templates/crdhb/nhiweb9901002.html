<meta name="TemplateVersion" content="V12.00.02">
<meta name="TemplateHome" content="crdhb">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src="../js/nhiweb99.js"></script>
<script type="text/javascript" src="../js/nhiesam.js"></script>
<!-- The json2.js file is a gap-filler for older browsers that do not 
     natively support JSON. This will not be needed when IE is 
     finally retired. PMc 20170529 -->
<script type="text/javascript" src="../js/json2.js"></script>
<script type="text/javascript" src="../js/IBA_Category_C_.js"></script>
<script type="text/javascript">
function checkPreferred(field){
if(field=="1"){
   document.NHIUpdate.nhmas002.className="Mandatory";
   document.NHIUpdate.nhmas003.className="";
   document.NHIUpdate.nhmas004.className="";
  if(isWhitespace(document.NHIUpdate.nhmas002.value)){
   alert("Preferred name must be entered.");
   document.NHIUpdate.nhmas002.focus;}
  if(document.NHIUpdate.ptcnnmpr.value=="1") {
    document.getElementById("savvloc2").style.display="none";
    document.getElementById("savvloc3").style.display="none";
    document.NHIUpdate.saveloc2.type="hidden";
    document.NHIUpdate.saveloc2.checked=false;
    document.NHIUpdate.saveloc3.type="hidden";
    document.NHIUpdate.saveloc3.checked=false;
  }
  }
if(field=="2"){
   document.NHIUpdate.nhmas002.className="Mandatory";
   document.NHIUpdate.nhmas003.className="Mandatory";
   document.NHIUpdate.nhmas004.className="";
  if(isWhitespace(document.NHIUpdate.nhmas003.value)){
   alert("Preferred name must be entered.");
   document.NHIUpdate.nhmas003.focus;}
  if(document.NHIUpdate.ptcnnmpr.value=="1") {
    document.getElementById("savvloc2").style.display="inline";
    document.getElementById("savvloc3").style.display="none";
    document.NHIUpdate.saveloc2.type="checkbox";
    document.NHIUpdate.saveloc2.checked=false;
    document.NHIUpdate.saveloc3.type="hidden";
    document.NHIUpdate.saveloc3.checked=false;
  }
  }
if(field=="3"){
   document.NHIUpdate.nhmas002.className="Mandatory";
   document.NHIUpdate.nhmas003.className="";
   document.NHIUpdate.nhmas004.className="Mandatory";
  if(isWhitespace(document.NHIUpdate.nhmas004.value)){
   alert("Preferred name must be entered.");
   document.NHIUpdate.nhmas004.focus;}
  if(document.NHIUpdate.ptcnnmpr.value=="1") {
    document.getElementById("savvloc2").style.display="none";
    document.getElementById("savvloc3").style.display="inline";
    document.NHIUpdate.saveloc2.type="hidden";
    document.NHIUpdate.saveloc2.checked=false;
    document.NHIUpdate.saveloc3.type="checkbox";
    document.NHIUpdate.saveloc3.checked=false;
  }
  }
}
function redirecting(){
if((document.NHIUpdate.emerflag.value=="1")||
   (document.NHIUpdate.emerflag.value=="2")){
  PatientLinkTo("emrweb02.pbl",1,1,0,0,0);
} else
if(document.NHIUpdate.emerflag.value=="4"){
  linkurl="patweb89.pbl?reportno=1&template=005"+
  "&systflag=1" +
  "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+") +
  "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+") ;
  location.href=linkurl;
}
else
{
  PatientLinkTo("patweb98.pbl",1,1,0,0,0);
  }
}

function checkAddressChanged(objAddressField,objHiddenAddressField,
                             strPreviousValue)
{
  var temp1 = objAddressField.value.replace(/ /g,"");
  var temp2 = strPreviousValue.replace(/ /g,"");

  if(temp1 != temp2)
    objHiddenAddressField.value = 1;

}

function postUpdate()
{
  if(document.NHIUpdate.saveloc2.checked==true || document.NHIUpdate.saveloc3.checked==true) {
    document.NHIUpdate.savelocl.value="Y";
  }
  checkAddressChangedNHIMAS();
  document.NHIUpdate.ptmas021.value=document.NHIUpdate.dtmas021.value;
  for(var i = 0; i < 6; i++)
  {
    //if any of the address fields have changed
    if(NHIUpdate["address"+(i+1)].value == 1)
    {

     if(confirm("Do you want to update the postal address"))
     {
       // set emerflag=5 to keep redirect to ACC after postal update screen
       if(document.NHIUpdate.emerflag.value=="4"){
          document.NHIUpdate.emerflag.value="5";
       }
       if((document.NHIUpdate.emerflag.value=="1")||
          (document.NHIUpdate.emerflag.value=="2")){
           document.NHIUpdate.emerflag.value="3";
       }
// 04 : Change redirect to Extra contact screen
/* 06 : Merge task 0898364 	   
//       document.NHIUpdate.redirect.value="patweb89.pbl?reportno=1&template=022"+
	   document.NHIUpdate.redirect.value="patweb07.pbl?reportno=6&template=004"+
       "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+") +
       "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+") +
       "&emerflag=" + document.NHIUpdate.emerflag.value.replace(/ /g,"+");
// 03 : Merge task 0859728   
	   "&cpmiskey=" + document.NHIUpdate.cpmiskey.value.replace(/ /g,"+");
*/
    if(document.getElementById('ptcnnewc').value==1) {
         document.NHIUpdate.redirect.value=
         "patweb07.pbl?reportno=6&template=004" +
         "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+") +
         "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+") +
         "&emerflag=" + document.NHIUpdate.emerflag.value.replace(/ /g,"+") +
         "&cpmiskey=" + document.NHIUpdate.cpmiskey.value.replace(/ /g,"+");
       } else {
         document.NHIUpdate.redirect.value=
         "patweb89.pbl?reportno=1&template=022" +
         "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+") +
         "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+") +
         "&emerflag=" + document.NHIUpdate.emerflag.value.replace(/ /g,"+") +
							 
         "&cpmiskey=" + document.NHIUpdate.cpmiskey.value.replace(/ /g,"+");
       }
     }
     else
     {
       document.NHIUpdate.redirect.value="patweb89.pbl?reportno=1&template=002"+
       "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+") +
       "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+") ;
// 03 : Merge task 0859728	   
	   "&cpmiskey=" + document.NHIUpdate.cpmiskey.value.replace(/ /g,"+");
     }
     break;;
    }
  }
// 02 : Add value to check NHI duplicate
  document.NHIUpdate.searchpf.value="0";
  UpdateForm01();
}
// 02 : Task 0848444 : New function for task
function submitSearch(){
 linkUrl="nhiweb96.pbl?reportno=1&template=009"
 DFrameLink(linkUrl,0,50,700,650)
}
// 05 : TAS : Merge Task 0875417
function checkAddressChangedNHIMAS() {
  FormatAddress();
  checkAddressChanged(document.NHIUpdate.nhmas006,
                      document.NHIUpdate.address1,
                      document.NHIUpdate.saveadd1.value);
  checkAddressChanged(document.NHIUpdate.nhmas007,
                      document.NHIUpdate.address2,
                      document.NHIUpdate.saveadd2.value);
  checkAddressChanged(document.NHIUpdate.nhmas008,
                      document.NHIUpdate.address3,
                      document.NHIUpdate.savesubr.value);
  checkAddressChanged(document.NHIUpdate.nhmas009,
                      document.NHIUpdate.address4,
                      document.NHIUpdate.savecity.value);
  checkAddressChanged(document.NHIUpdate.nhmas010,
                      document.NHIUpdate.address5,
                      document.NHIUpdate.savectry.value);
  checkAddressChanged(document.NHIUpdate.nhmas013,
                      document.NHIUpdate.address6,
                      document.NHIUpdate.savedomc.value);

//alert(document.NHIUpdate.address1.value+"|"+
//      document.NHIUpdate.address2.value+"|"+
//      document.NHIUpdate.address3.value+"|"+
//      document.NHIUpdate.address4.value+"|"+
//      document.NHIUpdate.address5.value+"|"+
//      document.NHIUpdate.address6.value);
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);
              DisplayResidency();matchNHIResidentStatusToLocal();
              checkAddressChangedNHIMAS();
              SetAliasFlag();"
      onclick="clearEsam()">
<div id="PatientHeading"></div>
<script type="text/javascript">
PatientURN="%NHIWEB99.01.003";
PatientVIS="%NHIWEB99.01.081";
PatientNAM="%NHIWEB99.01.002";
PatientSTA="%NHIWEB99.01.086.078";
PatientALT="%NHIWEB99.01.084";
PatientSEX="%NHIWEB99.01.019";
PatientDOB="%NHIWEB99.01.020";
PatientAGE="%NHIWEB99.01.021";
PatientLOC="%NHIWEB99.01.083";
PatientPRI="%NHIWEB99.01.086.066.1";
PatientUNT="%NHIWEB99.01.066.0";
DoctorCOD="%NHIWEB99.01.082.003";
DoctorNAM="%NHIWEB99.01.082.002";
PatientAID="%NHIWEB99.01.086.090";
PatientIND="%NHIWEB99.01.086.091";
PatientCUR="%NHIWEB99.01.086.092";
PatientCLC="%NHIWEB99.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%NHIWEB99.01.086.094";
PatientCDM="%NHIWEB99.01.086.095";
PatientVDH="%NHIWEB99.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>

<!-- div for popup address panel for NHI eSAM interface-->
<div id="esamPanel"></div>

<div id=PageBodySection>

<form name=NHIUpdate action="nhiweb99.pbl" method=post>
<input type=hidden name=reportno value="1">
<input type=hidden name=template value="002">
<input type=hidden name=updttype value="U">
<input type=hidden name=nhmaslup value="%NHIWEB99.01.119">
<input type=hidden name=urnumber value="%NHIWEB99.01.003">
<input type=hidden name=admissno value="%NHIWEB99.01.081">
<input type=hidden name=override value="   ">
<input type=hidden name=addrwarn value=" ">
<input type=hidden name=updkwarn value=" ">
<input type=hidden name=duplwarn value="Y">
<!-- 02 : TAS : Add value for task 08484444 -->
<input type=hidden name=searchpf value="0">
<input type=hidden name=nextpage value="7">
<input type=hidden name=redirect value="%NHIWEB99.01.001.patweb89.01.002">
<input type=hidden name=nhmas014 value="%NHIWEB99.01.114">
<input type=hidden name=emerflag value="%NHIWEB99.01.307">
<input type="hidden" name="ptcnrerd" value="%STANDARD.01.025.118.250.0.1">
<input type=hidden name=superlev value="%NHIWEB99.01.309">
<input type=hidden name=savelocl value=" ">
<input type=hidden name=ptcnnmpr value="%STANDARD.01.025.128.226.1.1">

<!-- address field flags to indicate if values in fields have changed -->
<input type=hidden name=address1 value="0" />
<input type=hidden name=address2 value="0" />
<input type=hidden name=address3 value="0" />
<input type=hidden name=address4 value="0" />
<input type=hidden name=address5 value="0" />
<input type=hidden name=address6 value="0" />
<!-- 03 Merge task 0859728 -->														  
<input type=hidden name=cpmiskey value="%NHIWEB99.01.150">
<!-- 05 : Merge task 0875417 -->
<input type=hidden name=saveadd1 value="%NHIWEB99.01.310">
<input type=hidden name=saveadd2 value="%NHIWEB99.01.311">
<input type=hidden name=savesubr value="%NHIWEB99.01.312">
<input type=hidden name=savecity value="%NHIWEB99.01.313">
<input type=hidden name=savectry value="%NHIWEB99.01.314">
<input type=hidden name=savedomc value="%NHIWEB99.01.315">
<!-- 06 : Merge task 0898364 -->											  
<input type=hidden name="ptcnnewc" id=ptcnnewc
   value="%STANDARD.01.025.118.138.0.1">
<input type=hidden name=d_updttype value="%NHIWEB99.01.316">
   
<table border=1 width="100%" cellspacing="0" cellpadding="1">
<tr><td class=HeadingCell align=center>NHI/MWS Patient Basic Details</td>
</table>

<table cellspacing=0 cellpadding=1 border=1 width=100%>
<tr valign=top><td>

<table cellspacing=0 cellpadding=0 border=0 width=100%>
<tr><td class=DataLabel>NHI No </td>
    <td><input type=text name=nhinumbr value="%NHIWEB99.01.139" 
         size=10 maxlength=7 readonly></td></tr>
<tr><td class=DataLabel>Surname </td>
    <td><input type=text name=nhmas001 value="%NHIWEB99.01.121" 
         size=25 max=25 onchange='UpCase(this);' class=Mandatory
         title=Surname></td></tr>
<tr><td class=DataLabel>Given 1st </td>
    <td class=DataLabel><input type=text name=nhmas002 value="%NHIWEB99.01.122" 
         size=20 max=20 onchange='FormatGiven();' class=Mandatory
         title="Given 1st">
        <input type=radio name=nhmas005 value="1" onclick=checkPreferred('1');>
         Preferred</td></tr>
<tr><td class=DataLabel>Given 2nd </td>
    <td><input type=text name=nhmas003 value="%NHIWEB99.01.123" 
         size=20 max=20 onchange='FormatGiven();' 
         title="Given 2nd">
        <input type=radio name=nhmas005 value="2" 
         onclick=checkPreferred('2');>
         Preferred
        <input type=hidden name="saveloc2" value="0"
         onclick="">
        <p id=savvloc2 style="display:none">Save to Local</p></td></tr>
<tr><td class=DataLabel>Given 3rd </td>
    <td><input type=text name=nhmas004 value="%NHIWEB99.01.124" 
         size=20 max=20 onchange='FormatGiven();' 
         title="Given 3rd">
        <input type=radio name=nhmas005 value="3" 
         onclick=checkPreferred('3');>
         Preferred
        <input type=hidden name="saveloc3" value="0"
         onclick="">
        <p id=savvloc3 style="display:none">Save to Local</p></td></tr>
<tr><td class=DataLabel>Save Alias</td>
    <td><input type=checkbox name=nhmas019 value="1"></td></tr>
	
<!--  fields for the NHI eSAM interface -->                  
<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="DataLabel">Address Type</td>
<td><select name="type" onchange="esamSuggestAddress()">
      <option value="B" selected>All Address types</option>
      <option value="L">Physical (LINZ) only</option>
      <option value="P">Postal (NZPost) only</option>
    </select>
    <input type="hidden" name="esamorg" value="%NHIWEB99.01.205.026"/>
    </td>
</tr>
<tr><td class="DataLabel">Suggest Address</td>
   <td><input type="text" name="esam0" id="esam0" value="" size="60" onkeyup="esamSuggestAddress();"/></td>
</tr>
<tr><td class="DataLabel" style="vertical-align: top">or Find Address</td><td style="1px solid black">
    <input type="text" name="esam1" value="" size="60" onkeyup="esamFindAddress();"/><br />
    <input type="text" name="esam2" value="" size="60" onkeyup="esamFindAddress();"/><br />
    <input type="text" name="esam3" value="" size="60" onkeyup="esamFindAddress();"/><br />
    <input type="text" name="esam4" value="" size="60" onkeyup="esamFindAddress();"/><br />
    <input type="text" name="esam5" value="" size="60" onkeyup="esamFindAddress();"/></td>
</tr>
<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
	
<tr valign=top><td class=DataLabel>Address </td>
    <input type=hidden name=orig_nhmas006 value="%NHIWEB99.01.126">
    <td class=DataLabel><input type=text name=nhmas006 value="%NHIWEB99.01.126" 
          size=35 max=35 
          onchange='FormatAddress();
                    checkAddressChanged(this,address1,orig_nhmas006.value);
                    checkAddressChanged(document.NHIUpdate.nhmas006,
                                        document.NHIUpdate.address1,
                                        document.NHIUpdate.saveadd1.value);'
          class=Mandatory
          title=Address><br>
         <input type=hidden name=orig_nhmas007 value="%NHIWEB99.01.127">
         <input type=text name=nhmas007 value="%NHIWEB99.01.127" 
          size=30 max=30 
          onchange='FormatAddress();
                    checkAddressChanged(this,address2,orig_nhmas007.value);
                    checkAddressChanged(document.NHIUpdate.nhmas007,
                                        document.NHIUpdate.address2,
                                        document.NHIUpdate.saveadd2.value);'>
         <br>
         <input type=hidden name=orig_nhmas008 value="%NHIWEB99.01.128">
         <input type=text name=nhmas008 value="%NHIWEB99.01.128" 
          size=30 max=30 
          onchange='FormatAddress();
                    checkAddressChanged(this,address3,orig_nhmas008.value);
                    checkAddressChanged(document.NHIUpdate.nhmas008,
                                        document.NHIUpdate.address3,
                                        document.NHIUpdate.savesubr.value);'>
         Suburb<br>
         <input type=hidden name=orig_nhmas009 value="%NHIWEB99.01.129">
											 
         <input type=text name=nhmas009 value="%NHIWEB99.01.129" 
          size=30 max=30 
          onchange='FormatAddress();
                    checkAddressChanged(this,address4,orig_nhmas009.value);
                    checkAddressChanged(document.NHIUpdate.nhmas009,
                                        document.NHIUpdate.address4,
                                        document.NHIUpdate.savecity.value);'>
																										   
         City<br>
					  
         <input type=hidden name=orig_nhmas010 value="%NHIWEB99.01.130">
         <input type=text name=nhmas010 value="%NHIWEB99.01.130" 
          size=30 max=30 
          onchange='FormatAddress();
                    checkAddressChanged(this,address5,orig_nhmas010.value);
                    checkAddressChanged(document.NHIUpdate.nhmas010,
                                        document.NHIUpdate.address5,
                                        document.NHIUpdate.savectry.value);'>																			 
         Country
    </td></tr>
<tr><td class=DataLabel>Domicile&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </td>
         <input type=hidden name=orig_nhmas013 value="%NHIWEB99.01.133">
    <td colspan=3>
      <input type=text name=nhmas013 id=nhmas013
       value="%NHIWEB99.01.133" size=4 max=4
       onchange='checkAddressChanged(this,address6,orig_nhmas013.value);
                 checkAddressChanged(document.NHIUpdate.nhmas013,
                                     document.NHIUpdate.address6,
                                     document.NHIUpdate.savedomc.value);'>
            <img src="../images/SearchIcon.gif" class=Icon
         onclick="DomicileSearchFrame(nhmas013);"></td></tr>
</table>
</td>
<td>
Formatted Given Name<br>
<input type=text readonly name=fgiven size=25 tabindex=-1 value="%NHIWEB99.01.140"><br>
Formatted Address<br>
<input type=text readonly name=fadd1 size=35 tabindex=-1 value="%NHIWEB99.01.141"><br>
<input type=text readonly name=fadd2 size=35 tabindex=-1 value="%NHIWEB99.01.142"><br>
<input type=text readonly name=fadd3 size=35 tabindex=-1 value="%NHIWEB99.01.143"><br>
<input type=text readonly name=fadd4 size=35 tabindex=-1 value="%NHIWEB99.01.144"><br>
</td></tr>
<tr><td colspan=2>
<table cellspacing=0 cellpadding=0 border=0 width=100%>
<!--
<tr><td class=DataLabel>Resident </td>
    <td><input type=checkbox name=nhmas014 value="Y"></td>
-->
<tr><td class=DataLabel>Gender </td>
    <td><input type=radio name=nhmas015 value="F">Female
        <input type=radio name=nhmas015 value="M">Male
		<input type=radio name=nhmas015 value="U">Unknown
        </td>
    <td class=DataLabel>Date of Birth </td>
    <td><input type=text name=nhmas011 id=nhmas011 value="%NHIWEB99.01.131"
         size=12 max=12 onblur="checkDate(this,'Date of Birth')" 
         class="Mandatory Date" title="Date of Birth">
        <img src=../images/DateLookup.gif border=0 hspace=4 align=absmiddle
         onclick="DateLookupFrame(nhmas011);"></td>
        </td>
    <td class=DataLabel>Deceased </td>
    <td><input type=text name=nhmas012 id=nhmas012 value="%NHIWEB99.01.132"
         size=12 max=12 readonly tabindex=-1 title="Deceased">
        <img src=../images/DateLookup.gif border=0 hspace=4 align=absmiddle
         onclick="DateLookupFrame(nhmas012);"></td>
        </td></tr>
<tr><td class=DataLabel>Ethnicity</td>
    <td colspan=5><select name=nhmas016 class=Mandatory title="Ethnicity">
        <option></option>
          %NHIWEB99.01.135.2
        </select>
        <select name=nhmas017>
        <option></option>
          %NHIWEB99.01.136.2
        </select>
        <select name=nhmas018>
        <option></option>
          %NHIWEB99.01.137.2
        </select>
        </td></tr>
</table>
<tr><td colspan=2>
<table border=0 width=100% cellspacing=0 cellpadding=0>
  <tr><td colspan=8 class=HeadingCell align=center>Residency Details</td></tr>

  <tr><td class=DataLabel>Country of Birth</td>
      <td><select name="ptmas019" class="select120" tabindex=39
                 title="Country of Birth">
           <option></option>
          %NHIWEB99.01.022.2
          </select>
          </td>
      <td class=DataLabel><div id=CountryHeading></div></td>
      <td><div id=CountryResidence></div></td>
      <td class=DataLabel>&nbsp;</td>
      <td>&nbsp;</td>
      <td class=DataLabel>&nbsp;</td>
      <td>&nbsp;</td>
  </tr>

  <tr><td class=DataLabel>Type of Residency</td>
          <input type=hidden name=ptmas021>
      <td><select name=dtmas021 class=Mandatory tabindex=40 
           title="Type of Resident" onchange="DisplayResidency();">
           <option></option>
            %NHIWEB99.01.024.5
          </select></td>
      <td class=DataLabel><div id=ExpiryHeading></div></td>
      <td><div id=ExpiryDate></div></td>

      <td class=DataLabel><div id=VisaHeading></div></td>
      <td><div id=Visa></div></td>

      <td class=DataLabel><div id=NZISHeading></div></td>
      <td><div id=NZIS></div></td></tr>

  <tr><td class=DataLabel>Residency Comments</td>
      <td colspan=7><input type="text" name="pmres004" size=145 maxlength=127
          value="%NHIWEB99.01.304" tabindex=41></td></tr>
 </table>
</td></tr>
<tr><td colspan=2 align=center>
<input type=button value=Update class="button" 
onClick='postUpdate();'>
<input type=button class="button" value="Show Difference" style="width:100px"
 onclick='document.PatientLinks.updttype.value="S";PatientLinkTo("nhiweb99.pbl",1,3,0,0,0);'>
<input type=button class="button" value="Use Local"
 onClick='document.PatientLinks.updttype.value="S";PatientLinkTo("nhiweb99.pbl",1,2,0,0,0);'>
<input type=button class="button" value="Use National"
 onClick=PatientLinkTo("nhiweb99.pbl",1,2,0,0,0);>
 <!-- 01 : CTAS : hide Contact/Donor button
<input type=button class="button" value="Contact/Donor"
 onClick=PatientLinkTo("nhiweb99.pbl",2,1,0,0,0);>
-->
<!-- end of change -->
<input type=button class="button" value="Aliases"
 onClick=PatientLinkTo("nhiweb99.pbl",3,1,0,0,0);>
<input type=button class="button" value="Medical Warnings" style="width:100px"
 onclick='PatientLinkTo("nhiweb99.pbl",4,1,0,0,0);'>
<input type=button class="button" value="Cancel"
 onClick="redirecting();">
</table>
</form>

<form name=NationalName action="nhiweb99.pbl" method="post">
<input type=hidden name=nzhissur value="%NHIWEB99.01.101">
<input type=hidden name=nzhisgv1 value="%NHIWEB99.01.102">
<input type=hidden name=nzhisgv2 value="%NHIWEB99.01.103">
<input type=hidden name=nzhisgv3 value="%NHIWEB99.01.104">
<input type=hidden name=nzhispre value="%NHIWEB99.01.105">
<input type=hidden name=nzhisres value="%NHIWEB99.01.134">
<input type=hidden name=nzhissex value="%NHIWEB99.01.138">
<input type=hidden name=nzhiserr value="%NHIWEB99.01.145">
<!-- 03 : Merge task 0859728 -->
<input type=hidden name=cpmiskey value="%NHIWEB99.01.150">														  
</form>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%NHIWEB99.01.003">
<input type=hidden name=admissno value="%NHIWEB99.01.081">
<input type=hidden name=MenuType value="%NHIWEB99.01.088">
<input type=hidden name=updttype value=" ">
<!-- 03 : Merge task 0859728 -->
<input type=hidden name=cpmiskey value="%NHIWEB99.01.150">														  
</form>
</div>
<script type="text/javascript">
  Gender="%NHIWEB99.01.118"
  for ( i=0 ; i < document.NHIUpdate.nhmas015.length ; i++) {
   if (document.NHIUpdate.nhmas015[i].value==Gender) {
     document.NHIUpdate.nhmas015[i].checked=true }
  }

  PrefName="%NHIWEB99.01.105"
  for ( i=0 ; i < document.NHIUpdate.nhmas005.length ; i++) {
   if (document.NHIUpdate.nhmas005[i].value==PrefName) {
     document.NHIUpdate.nhmas005[i].checked=true }
  }
  checkPreferred(PrefName);
  document.NHIUpdate.redirect.value="patweb89.pbl?reportno=1&template=002"+
       "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+") +
       "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+") +
       "&cpmiskey=" + document.NHIUpdate.cpmiskey.value.replace(/ /g,"+");

function matchNHIResidentStatusToLocal() {
  if(document.NHIUpdate.ptcnrerd.value=="1" &&
     document.NHIUpdate.superlev.value!="1"){
     return;  // Restricted update and not supervisor
  }

  if(document.NHIUpdate.d_updttype.value == "S") {
    return;   // Using local values
  }

  NHIResidentStatus = "%NHIWEB99.01.134";
  localResidentStatusInd1 = document.NHIUpdate.dtmas021.value.substring(3,4);

  if(localResidentStatusInd1 == "1") {
    localResidentStatusYN = "Y";
  } else {
    localResidentStatusYN = "N";
  }

  if (NHIResidentStatus == localResidentStatusYN) {
    return;
  }

  for (var i=0; i < document.NHIUpdate.dtmas021.length; i++) {
    if (document.NHIUpdate.dtmas021.options[i].value.substring(7,8) ==
        NHIResidentStatus){
       document.NHIUpdate.dtmas021.selectedIndex=i;
    }
  }
}

function DisplayResidency() {
  i=document.NHIUpdate.dtmas021.selectedIndex;
  ind=document.NHIUpdate.dtmas021.options[i].value.substring(5,6)
  if (ind=="T") {
    ExpiryHeading.innerHTML=expiryhd.innerHTML;
    ExpiryDate.innerHTML=expirydate.innerHTML;
    VisaHeading.innerHTML=visahd.innerHTML;
    Visa.innerHTML=visano.innerHTML;
    CountryResidence.innerHTML=countryblank.innerHTML;
    CountryHeading.innerHTML="";
    if (document.NHIUpdate.pmres001) document.NHIUpdate.pmres001.value="";
    NZISHeading.innerHTML="";
    NZIS.innerHTML=NZISblank.innerHTML;
    if (document.NHIUpdate.pmres014) document.NHIUpdate.pmres014.className="";
  } else if (ind=="N") {
    CountryResidence.innerHTML=countryresidence.innerHTML;
    CountryHeading.innerHTML=countryheading.innerHTML;
    ExpiryDate.innerHTML=expiryblank.innerHTML;
    ExpiryHeading.innerHTML="";
    Visa.innerHTML=visablank.innerHTML;
    VisaHeading.innerHTML="";
    if (document.NHIUpdate.pmres005) document.NHIUpdate.pmres005.value="";
    if (document.NHIUpdate.pmres002) document.NHIUpdate.pmres002.value="";
    if (document.NHIUpdate.pmres001) SetCategoryC_(document.NHIUpdate.pmres001,"%NHIWEB99.01.301.1")
    NZISHeading.innerHTML="";
    NZIS.innerHTML=NZISblank.innerHTML;
    if (document.NHIUpdate.pmres014) document.NHIUpdate.pmres014.className="";
  } else if (ind=="V") {
    ExpiryHeading.innerHTML=expiryhd.innerHTML;
    ExpiryDate.innerHTML=expirydate.innerHTML;
    VisaHeading.innerHTML=visahd.innerHTML;
    Visa.innerHTML=visano.innerHTML;
    CountryResidence.innerHTML=countryresidence.innerHTML;
    CountryHeading.innerHTML=countryheading.innerHTML;
    if (document.NHIUpdate.pmres001) SetCategoryC_(document.NHIUpdate.pmres001,"%NHIWEB99.01.301.1")
    NZISHeading.innerHTML=NZIShd.innerHTML;
    NZIS.innerHTML=NZISno.innerHTML;
    if (document.NHIUpdate.pmres014) document.NHIUpdate.pmres014.className="Mandatory";
  } else {
    ExpiryDate.innerHTML=expiryblank.innerHTML;
    ExpiryHeading.innerHTML="";
    Visa.innerHTML=visablank.innerHTML;
    VisaHeading.innerHTML="";
    if (document.NHIUpdate.pmres005) document.NHIUpdate.pmres005.value="";
    if (document.NHIUpdate.pmres002) document.NHIUpdate.pmres002.value="";
    CountryResidence.innerHTML=countryblank.innerHTML;
    CountryHeading.innerHTML="";
    if (document.NHIUpdate.pmres001) document.NHIUpdate.pmres001.value="";
    NZISHeading.innerHTML="";
    NZIS.innerHTML=NZISblank.innerHTML;
    if (document.NHIUpdate.pmres014) document.NHIUpdate.pmres014.className="";
  }
  if((document.NHIUpdate.ptcnrerd.value=="1")&&(document.NHIUpdate.superlev.value!="1")){
    if (document.NHIUpdate.dtmas021) {
      document.NHIUpdate.dtmas021.className="ReadOnly";
      document.NHIUpdate.dtmas021.readOnly=true;
      document.NHIUpdate.dtmas021.disabled=true;
    }
    if (document.NHIUpdate.pmres001) {
      document.NHIUpdate.pmres001.className="ReadOnly select120";
      document.NHIUpdate.pmres001.readOnly=true;
    }
    if (document.NHIUpdate.pmres002) {
      document.NHIUpdate.pmres002.className="ReadOnly Date";
      document.NHIUpdate.pmres002.readOnly=true;
    }
    if (document.NHIUpdate.pmres004) {
      document.NHIUpdate.pmres004.className="ReadOnly";
      document.NHIUpdate.pmres004.readOnly=true;
    }
    if (document.NHIUpdate.pmres005) {
      document.NHIUpdate.pmres005.className="ReadOnly";
      document.NHIUpdate.pmres005.readOnly=true;
    }
    if (document.NHIUpdate.pmres014) {
      document.NHIUpdate.pmres014.className="ReadOnly";
      document.NHIUpdate.pmres014.readOnly=true;
    }
  }
}
</script>
<span id=expiryhd style="display:none">
<td class=DataLabel>Expiry Date</td>
</span>
<span id=expirydate style="display:none">
    <td><input type=text size=12 name=pmres002 id=pmres002
         class="Mandatory Date" title="Expiry Date" 
        value="%NHIWEB99.01.302" onblur="checkDate(this,'Expiry Date');">
        <img notab src=../images/DateLookup.gif border=0 hspace=4
         align=absmiddle onclick="DateLookupFrame(pmres002);">
        <img notab src=../images/DateTimeStamp.gif border=0 hspace=4 
         align=absmiddle onclick="SetCurrentDateTime(pmres002,null);">
    </td></tr>
</span>
<span id=expiryblank style="display:none">
   <input type=hidden name=pmres002>
</span>
<span id=countryblank style="display:none">
   <input type=hidden name=pmres001>
</span>
<span id=countryheading style="display:none">
<td class=DataLabel>Country of Residence</td>
</span>
<span id=countryresidence style="display:none">
    <td><select name="pmres001" id=pmres001 class="select120 Mandatory"
         title="Country of Residence">
        <option></option>
        </select></td>
</span>
<span id=visablank style="display:none">
   <input type=hidden name=pmres005>
</span>
<span id=visahd style="display:none">
<td class=DataLabel>Passport/Visa Number</td>
</span>
<span id=visano style="display:none">
    <td><input type=text size=12 name=pmres005 id=pmres005 
         class="Mandatory" title="Passport/Visa Number"
         value="%NHIWEB99.01.306">
    </td></tr>
</span>
<span id=NZISblank style="display:none">
  <input type=hidden name=pmres014>
</span>
<span id=NZIShd style="display:none">NZIS Client Number</span>
<span id=NZISno style="display:none">
  <input type=text size=20 maxlength=20 name=pmres014 id=pmres014 class=""
   title="NZIS Client Number" value="%NHIWEB99.01.308">
</span>
