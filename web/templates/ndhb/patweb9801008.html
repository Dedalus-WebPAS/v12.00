<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="ndhb">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
//-----------------------------------------------------------------
// Return visit type for a visit number
//-----------------------------------------------------------------
function checkVisitType(admissno,ReturnName) {
  if ((pat98ppl.admissno.value =="       0") ||
         (isWhitespace(pat98ppl.admissno.value))) {
      return;
  }
  ReturnFunction="" ;
  ReturnName.value="";

  var serverURL = "../cgi-bin/comweb80.pbl?reportno=58" +
                  "&valdcode="+admissno.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|")
    ReturnName.value=trim(ReturnValue[0]);
  }
  getOptionIndex();
}
function init() {
  if (isWhitespace(pat98ppl.admissno.value)) {
      pat98ppl.admissno.value="       0";
      getOptionIndex();
      return;
  }
  checkVisitType(pat98ppl.admissno.value,pat98ppl.visttype);
}
function PrintLabels() {
  if(validateMandatory(pat98ppl)) {
    document.pat98ppl.submit();
  }
}
function ShowComment() {
  if(document.pat98ppl.labeltyp.value=="LABELPMI05") {
     CommentHeading.innerHTML=CommentHdr1.innerHTML;
     CommentDetail.innerHTML=CommentDtl1.innerHTML;
  } else {
     CommentHeading.innerHTML=CommentHdr.innerHTML;
     CommentDetail.innerHTML=CommentDtl.innerHTML;
  }
}
</script>
</head>
%START.OF.PAGE
<body onLoad="PageLoad(event);ShowComment();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
<script type="text/javascript">document.write(self.document.title);</script>
</span>
<form name=pat98ppl action="rshweb02.pbl" method=post style="margin:0">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=001>
<input type=hidden name=updttype value="L">
<input type=hidden name=sbwindow value=1>
<input type=hidden name=outptflg value=1>
<input type=hidden name=urnumber value="%PATWEB98.01.003">
<input type=hidden name=admissno value="%PATWEB98.01.081">
<input type=hidden name=visttype value="">
<input type=hidden name=setdfprg value="PATWEB70">
<input type=hidden name=setdfrep value="01">
 
<table align=center cellspacing=0 cellpadding=3 border=0 width=95%>
<tr><td class=DataLabel>Printer </td> 
      <td><select name=schdprnt colspan=2> 
           %STANDARD.01.001.PATWEB70.01
          </select></td></tr>
<tr><td class=DataLabel>Type of Label</td>
      <td><select name=labeltyp id=labeltyp onchange="ShowComment();">
           %STANDARD.01.019
          </select></td></tr>

  <input type=hidden name=setdefp1 value="PATWEB9801">

<tr><td class=DataLabel>Number of Labels</td>
      <td><select name=schdcopy width=50%>
         %STANDARD.01.027.3.1
    </select></td></tr>

<tr><td><div id=CommentHeading></div></td>
    <td><div id=CommentDetail></div></td>
    </tr>

<tr><td colspan=2 align=center><br>
    <input type=button value="Print" class="button"
     id="printbutton" onclick="tempDisable(this);PrintLabels();">
    <input type=button Value="Cancel" class="button" onclick="DFrameExit();">
    </td></tr>
</table>
</form>

<span id=CommentHdr style="display:none">
  <td class=DataLabel>Comment</td>
</span>
<span id=CommentDtl style="display:none">
  <td><input type=text name=freetxt1 title="Comment" maxlength=38 size=40>
  </td>
</span>

<span id=CommentHdr1 style="display:none">
  <td class=DataLabel>Clinician and Department</td>
</span>
<span id=CommentDtl1 style="display:none">
  <td><input type=text name=freetxt1  maxlength=38 size=40 class="Mandatory" 
      title="Clinician and Department">
  </td>
</span>


<!--   Set Default Number of Labels  -->
<script type="text/javascript">
function getOptionIndex()
{
// Delete all label types that cannot be printed in PATWEB70
// EMR must be printed from emrweb0201003
    var x=document.getElementById("labeltyp")
      for (var i=0;i<pat98ppl.labeltyp.length;i++) {
           var V1=x.options[i].value;
           if ((V1.substr(5,3)=="EMR") ||
             (V1.substr(5,3)=="WAT") ||
             (V1.substr(5,3)=="KNX") ||
             (V1.substr(5,3)=="HEC") ||
             (V1.substr(5,3)=="AAE")) {
             x.remove(i);
             i--;
           }
      }

  if ((pat98ppl.admissno.value =="       0") ||
      (pat98ppl.visttype.value =="") ||
         (isWhitespace(pat98ppl.admissno.value))) {
    var x=document.getElementById("labeltyp")
        for (var i=0;i<pat98ppl.labeltyp.length;i++) {
             var V1=x.options[i].value;
             if ((V1.substr(5,3) !="PMI") && (V1.substr(5,3) !="PLY")) {
               x.remove(i);
               i--;
             }
        }
  return;
  }

// Inpatient and pmi only
  if ((pat98ppl.visttype.value =="INP")) {
    var x=document.getElementById("labeltyp")
        for (var i=0;i<pat98ppl.labeltyp.length;i++) {
             var V1=x.options[i].value;
             if ((V1.substr(5,3)!="INP") &&
               (V1.substr(5,3)!="PMI") && (V1.substr(5,3)!="ADD")){
               x.remove(i);
               i--;
             }
        }
  }
//
//
// Booking and pmi only
  if ((pat98ppl.visttype.value =="BOK")) {
    var x=document.getElementById("labeltyp")
        for (var i=0;i<pat98ppl.labeltyp.length;i++) {
             var V1=x.options[i].value;
             if ((V1.substr(5,3)!="BOK") &&
               (V1.substr(5,3)!="PMI") && (V1.substr(5,3)!="ADD")){
               x.remove(i);
               i--;
             }
        }
  }

// Outpatient and pmi only
  if ((pat98ppl.visttype.value =="OUT")) {
    var x=document.getElementById("labeltyp")
        for (var i=0;i<pat98ppl.labeltyp.length;i++) {
             var V1=x.options[i].value;
             if ((V1.substr(5,3)!="OUT") && (V1.substr(5,3)!="PMI") &&
               (V1.substr(5,3)!="REF")) {
               x.remove(i);
               i--;
             }
        }
  }
// Emergency ***** will show pmi only ****** PATWEB70 does not print LABELEMR
  if ((pat98ppl.visttype.value =="EMR")) {
    var x=document.getElementById("labeltyp")
        for (var i=0;i<pat98ppl.labeltyp.length;i++) {
             var V1=x.options[i].value;
             if ((V1.substr(5,3)!="PMI")){
               x.remove(i);
               i--;
             }
        }
  }
// Allied Health and pmi only
  if ((pat98ppl.visttype.value =="AH")) {
    var x=document.getElementById("labeltyp")
        for (var i=0;i<pat98ppl.labeltyp.length;i++) {
             var V1=x.options[i].value;
             if ((V1.substr(5,3)!="ALL") &&
               (V1.substr(5,3)!="ERC") && (V1.substr(5,3)!="CAR") &&
               (V1.substr(5,3)!="ASS") &&
               (V1.substr(5,3)!="PMI")) {
               x.remove(i);
               i--;
             }
        }
  }

}
//  getOptionIndex();
  LastLabelType="%STANDARD.01.036.PATWEB98.01"
  if(!isWhitespace(LastLabelType)) {
    for (var i = 0; i<document.pat98ppl.labeltyp.length; i++) {
      if (document.pat98ppl.labeltyp.options[i].value==LastLabelType) {
          document.pat98ppl.labeltyp.selectedIndex=i
      }
    }
}
</script>
