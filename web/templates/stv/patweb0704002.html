<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="stv">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/patweb07.js"></script>
<script type="text/javascript">
function AddConcessCard() {

  if (document.getElementById('d_pmccd002').value.substr(3,1)==7){

     //Checks if NDIS number matches requirements
     if (!validateNDISNumber(document.UpdateForm.pmccd003,"3")) {
        return;
     }
  }

  document.UpdateForm.pmccd002.value=document.UpdateForm.d_pmccd002.value;
  SubmitHiddenNew(UpdateForm);
}
function UpdateCCard(linkurl) {
  Left=(document.body.clientWidth-500)/2;
  DFrameLink(linkurl,0,Left,500,260);
}
function CloseConcessCard() {
  if (document.UpdateForm.newregfl.value=="1"){
           PatientLinkTo("mrtweb01.pbl",9,4,0,0);
  } else {
           PatientLinkTo("patweb98.pbl",1,1,0,0);
  }
}
function DeleteConcessCard(urnumber,exdate,ctyp) {
  if(confirm("Are you sure you want to delete?")) {
    document.UpdateForm.updttype.value="D";
    document.UpdateForm.urnumber.value=urnumber;
    document.UpdateForm.pmccd004.value=exdate;
    document.UpdateForm.pmccd002.value=ctyp;
    UpdateForm.target="PopUpFrame1"
    UpdateForm.submit();
  }
}
function DefaultDate(ctyp,cdate) {
  if(ctyp.value.substr(3,1)=="2") {
    document.UpdateForm.pmccd004.value=("31 Dec " + cdate.value.substr(0,4));
  }
}
function isDVA() {
  var cTitlePanel = document.getElementById('DVAColorTitlePanel');
  var cTitle = document.getElementById('DVAColorTitle');
  var cSelectPanel = document.getElementById('DVAColorSelectPanel');
  var cSelect = document.getElementById('DVAColorSelect');

  var expireDate = document.getElementById("pmccd004");
  var colorDefault = document.getElementById("pmccd005");

  var cardType = document.getElementById('d_pmccd002');
  var index = cardType.selectedIndex;
  var expiryIndicator = cardType[index].value.substring(6,7); //expire not mandatory if = 1


  if(typeof cTitlePanel != 'undefined' &&
     typeof cTitle != 'undefined' &&
     typeof cSelect != 'undefined' &&
     typeof cSelectPanel != 'undefined') {

     if(cardType[index].value.substr(3,1) == "3") {

       cSelectPanel.innerHTML = cSelect.innerHTML;
       cTitlePanel.innerHTML = cTitle.innerHTML;
       isExpireDateMandatory(expiryIndicator,expireDate);
     }else {
       cSelectPanel.innerHTML = "";
       cTitlePanel.innerHTML = "";
       isExpireDateMandatory(expiryIndicator,expireDate);
       ChooseType();
     }
  }
}
function isExpireDateMandatory(value,obj) {
       if(value == 1){
           obj.className = "FutureDate";
       }else {
           obj.className = "Mandatory FutureDate";
       }
}
function ChooseType() {
  if (document.UpdateForm.d_pmccd002.value == "") {
    document.UpdateForm.pmccd003.className = "Readonly";
    document.UpdateForm.pmccd004.className = "Readonly";
    document.UpdateForm.pmccd003.readOnly = true;
    document.UpdateForm.pmccd004.readOnly = true;
    document.UpdateForm.pmccd003.value = "";
    document.UpdateForm.pmccd004.value = "";
  } else {
    document.UpdateForm.pmccd003.className = "Mandatory";
    document.UpdateForm.pmccd003.readOnly = false;
    document.UpdateForm.pmccd004.readOnly = false;
    document.UpdateForm.pmccd003.value = "";
    document.UpdateForm.pmccd004.value = "";
  }
}
</script>
</head>
%START.OF.PAGE
<body onLoad="PageLoad(event);self.focus();ChooseType();">
<div id=PageHeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB07.04.003";
PatientVIS="%PATWEB07.04.081";
PatientNAM="%PATWEB07.04.002";
PatientSTA="%PATWEB07.04.086.078";
PatientALT="%PATWEB07.04.084";
PatientSEX="%PATWEB07.04.019";
PatientDOB="%PATWEB07.04.020";
PatientAGE="%PATWEB07.04.021";
PatientLOC="%PATWEB07.04.083";
PatientPRI="%PATWEB07.04.086.066.1";
PatientUNT="%PATWEB07.04.066.0";
DoctorCOD="%PATWEB07.04.082.003";
DoctorNAM="%PATWEB07.04.082.002";
PatientAID="%PATWEB07.04.086.090";
PatientIND="%PATWEB07.04.086.091";
PatientCUR="%PATWEB07.04.086.092";
PatientCLC="%PATWEB07.04.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB07.04.086.094";
PatientCDM="%PATWEB07.04.086.095";
PatientVDH="%PATWEB07.04.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>

<form name=UpdateForm action="patweb07.pbl" method=post style=margin:0>
<input type=hidden name=reportno value="4">
<input type=hidden name=template value=2>
<input type=hidden name=updttype value="A">
<input type=hidden name=nextpage value="5">
<input type=hidden name=redirect value="patweb98.pbl?reportno=1&template=001">
<input type=hidden name=pmccd002>
<input type=hidden name=newregfl value="%PATWEB07.04.105">
<input type=hidden name=urnumber value="%PATWEB07.04.003">
<input type=hidden name=currdate value="%STANDARD.01.013">

<table width=100% border=0 cellpadding=1 cellspacing=1 bgcolor=#cccccc>
<tr><td width=100% colspan=8 class=HeadingCell align=center>
     Add Concession Card</td>
    </tr>
<tr>
  <td class=DataLabel>Card Type</td>
  <td>
    <select id=d_pmccd002 name=d_pmccd002 class=Mandatory title="Card Type"
     onchange='ChooseType();DefaultDate(d_pmccd002,currdate);isDVA();'>
      <option></option>
      %STANDARD.01.007.ct
    </select>
  </td>
  <td class=DataLabel>Card Number</td>
  <td>
    <input type=text id=pmccd003 name=pmccd003 size=25 maxlength=20 
           class=Mandatory title="Card Number">
  </td>
  <td><span id="DVAColorTitlePanel"></span></td>
  <td><span id="DVAColorSelectPanel"></span></td>
  <td class=DataLabel>Card Expiry Date</td>
  <td>
    <input type=text id=pmccd004 name=pmccd004 size=12 maxlength=11 
           class="Mandatory FutureDate" title="Card Expiry Date">
    <img notab src="../images/DateLookup.gif" class="Icon" 
     alt="Show Calendar" date="UpdateForm.pmccd004">
  </td>
</tr>
<tr>
  <td colspan=8 align=center>
    <input type=button class="button" value="Add" 
     onclick='AddConcessCard();'>
    <input type=button value="Close" class="button"
     onclick='CloseConcessCard();'>
  </td>
</tr>
</table>

</form>
</div>

<span id="DVAColorTitle" style="display:none">DVA Card Colour</span>
<span id="DVAColorSelect" style="display:none">
  <select id=pmccd005 name=pmccd005 maxlength=20 class="Mandatory" 
          title="DVA Card Colour">
    <option></option>
    %PATWEB07.04.106.2
  </select>
</span>

<div id=PageBodySection>
<table width=100% border=0 cellpadding=0 cellspacing=0>
<tr>
  <td class=HeadingCell>Card Type</td>
  <td class=HeadingCell>Card Number</td>
  <td class=HeadingCell>Card Expiry Date</td>
  <td class=HeadingCell>DVA Card Colour</td>
  <td class=HeadingCell>&nbsp;</td>
</tr>
%PATWEB07.04.107.patweb07.04.005
</table>
</div>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=urnumber value="%PATWEB07.04.003">
<input type=hidden name=admissno value="%PATWEB07.04.081">
<input type=hidden name=MenuType value="%PATWEB07.04.088">
</form>

<script type="text/javascript">
document.getElementById("pmccd005").selectedIndex=0;

</script>
