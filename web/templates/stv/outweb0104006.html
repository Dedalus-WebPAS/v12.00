<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="stv">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
function InitTable() {
 document.title="Unbooked Referral Letters"
//
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//
 t = new Table(1,0,1,"100%","center",25);
//
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
//
 t.addColumn("Book","String",8,8,"left","DocumentIcon.gif","0",50)
 t.addColumn("Date","Date",1,1,"left","","",50)
 t.addColumn("Referring GP","String",9,9,"left","","",100)
 t.addColumn("Clinic Type","String",3,3,"left","","",100)
 t.addColumn("Clinic","String",4,4,"left","","",100)
 if (document.PatientLinks.alcndtrg.value=="1") {
   t.addColumn("Triage Status","String",11,11,"left","","",80)
 }
 t.addColumn("Priority","String",5,5,"left","","",80)
 t.addColumn("Reason","String",6,6,"left","","",100)
//
// Add Rows to Table (Output from Web Server)
//
 AddTableRows()
 t.sortTable(1,0)   // Sort in reverse date order
 TableOutput(0,0);
}

function PassLetterToParent(Admissno,Priority,GPCode,GPName,RDate,Problem,Clm,RefG,RefgNam,Prac,PracNam,PracCount) {

  parent.AddForm.bookflag.value=1;
  parent.AddForm.admissno.value=Admissno;
 
  if(parent.AddForm.outbb030 != undefined) {
    parent.AddForm.outbb029.value=RefG;
    parent.AddForm.genpname.value=RefgNam;
    parent.AddForm.outbb030.value=Prac;
    parent.AddForm.genpprac.value=PracNam;
    parent.AddForm.outbb037.value=PracCount;
  } else {
    parent.AddForm.outbb029.value=GPCode;
    parent.AddForm.genpname.value=GPName;
  }
 
  for(index=0; index < parent.AddForm.outbb013.length; index++) {
    if (parent.AddForm.outbb013.options[index].value.substr(0,3) == Priority)
      parent.AddForm.outbb013.selectedIndex=index;
  } 
  if (parent.AddForm.refrldte != undefined)
    parent.AddForm.refrldte.value=RDate;

  if (parent.AddForm.pmsvx052 != undefined)
    parent.AddForm.pmsvx052.value=Problem;       // Presenting Problem

  DFrameExit();
}
</script>

</head>
%START.OF.PAGE
<body onload=PageLoad(event);InitTable()>
<div id=HeadingSection>
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Referral Letter Selection
</span>
</div>
<div id=TableLocation></div>

<script type="text/javascript">
function AddTableRows() {
 %OUTWEB01.04.135
}
</script>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%OUTWEB01.04.003">
<input type=hidden name=admissno value="%OUTWEB01.04.081">
<input type=hidden name=MenuType value="%OUTWEB01.04.088">
<input type=hidden name=bookflag value="">
<input type=hidden name=alcndtrg id=alcndtrg 
 value="%STANDARD.01.025.121.125.0.1">
</form>

