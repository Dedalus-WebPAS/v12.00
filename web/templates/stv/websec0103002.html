<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="stv">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/MrtHomeLocns.js"> </script>
<script type="text/javascript" src="../js/MrtMultiHomeLocns.js"> </script>
%START.OF.PAGE
<script type="text/javascript">

var internalPassword = %WEBSEC01.03.066 ;
function init()
{
  if (internalPassword == 1) return;

  document.AddForm.wbsec012.value   = "";
  document.AddForm.wbsec014.value   = 0;
  document.AddForm.wbsec014.checked = 0;
  document.AddForm.wbsec015.value   = "000";
  
  document.getElementById('hpw00').style.display= "none";
  document.getElementById('hpw01').style.display= "none";
  document.getElementById('hpw02').style.display= "none";
  document.getElementById('hpw03').style.display= "none";
  document.getElementById('hpw04').style.display= "none";

}

function GenHomeHospital() {
  p=document.AddForm;
  p.wbsec023.options.length=0;
  p.wbsec057.options.length=1;
  i=p.wbsec031.selectedIndex;
  p.wbsec057.options[p.wbsec057.options.length]=
    new Option(p.wbsec031.options[i].text,p.wbsec031.value);
}

function SetLocations() {
  p=document.AddForm;
  p.wbsec023.options.length=0;
  if (p.ibcnmhos.value==1) {
      MrtMultiHomeLocns(p.wbsec023,p.d_wbsec023.value,p.wbsec057.value)
  } else {
      MrtHomeLocns(p.wbsec023,p.d_wbsec023.value)
  }
}

function CheckClinic() {
  p=AddForm
  if(isWhitespace(p.wbsec006.value)) {
    p.wbsec007.value="";
    p.name_wbsec007.value="";
    return;
  }
  validateClinic(p.wbsec006,p.wbsec007,p.name_wbsec007)
}
function SetDays() {
  if(document.AddForm.wbsec014.checked==true) {
    document.AddForm.wbsec015.className="Mandatory Number";
  } else {
    document.AddForm.wbsec015.className="Number";
  }
} 
function CheckForm() {
 if(trim(document.AddForm.wbsec015.value)=="0"){
   alert("Age by Number of Day Must be Greater Than Zero");
   return
 }
 checkid=document.AddForm.wbsec001.value.search('[^a-zA-Z0-9]');
 if (checkid >= 0) {
   alert("User ID can only be alphanumeric!");
   document.AddForm.wbsec001.value="";
   document.AddForm.wbsec001.focus();
   return;
 }
 checkmrt=document.AddForm.wbsec030.value.search('[^a-zA-Z0-9]');
 if (checkmrt >= 0) {
   alert("MRT Security Number can only be alphanumeric!");
   document.AddForm.wbsec030.value="";
   document.AddForm.wbsec030.focus();
   return;
 }
 SubmitForm();
}
function validateNurse() {
  validateCode('17',document.AddForm.wbsec034,
                    document.AddForm.dummy1,
                    document.AddForm.gnm,SetNurseName);
}
function SetNurseName() {
AddForm.dummy1.value=AddForm.gnm.value.replace(/\s*$/g,"")+
                              " " +
                        AddForm.dummy1.value.replace(/\s*$/g,"")
}
function defaultLogin() {
  // default the long login name to the userid value to get started. 
  if (isWhitespace(document.AddForm.wbsec063.value))  {  
    document.AddForm.wbsec063.value = document.AddForm.wbsec001.value;
  }
}
function HospitalFieldsAdd() {
  p=document.AddForm;
  SelectOptionsHospCatCode(p.ctcode,p.wbsec031,p.wbsec032);
}
</script>
</head>
<body onLoad="PageLoad(event);self.focus();document.AddForm.wbsec001.focus();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
<script type="text/javascript">document.write(self.document.title);</script>
</span>

   <form name=AddForm method=post action=websec01.pbl>
   <input type=hidden name=reportno value="3">
   <input type=hidden name=template value="002">
   <input type=hidden name=updttype value="A">
   <input type=hidden name=nextpage value="0">
   <input type=hidden name=redirect 
    value="websec01.pbl?reportno=03&template=001">
   <input type=hidden name=deftclid value="">
   <input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
   <input type=hidden name=dummy001>
   <input type=hidden name=d_wbsec023 value="">
   <input type=hidden name=ctcode value="CT">

<table width=100% border=0 cellspacing=0>
<tr><td>
<table align=center cellspacing=0 width=100% border=0>
<tr valign=top><td class=DataLabel>User ID</td>
    <td><input type=text name=wbsec001 class=Mandatory title="User ID"
     size=10 maxlength=10 onblur="defaultLogin()" /></td>

    <td class=DataLabel>User Name</td>
    <td><input type=text name=wbsec002 class=Mandatory title="User Name" 
     size=35 maxlength=35 />
</td></tr>

      <tr>
        <td class=DataLabel>Login Name</td>
        <td>
          <input type=text name=wbsec063 class="Mandatory" title="Login Name" size=40 
           maxlength=80 />
        </td>
        <td class=DataLabel>E-mail</td>
        <td>
          <input type=text name=wbsec062 title="Email" size=40 
           maxlength=80  />
        </td>
      </tr>
<tr valign=top><td class=DataLabel>Doctor Code</td>
    <td><input type=text name=wbsec003 id=wbsec003 
    title="Doctor Code" size=8 maxlength=6
    onblur="validateCode(3,wbsec003,name_wbsec003)">
    <input type=text name=name_wbsec003 readonly size=30 maxlength=30
     class=Readonly tabindex=-1 id=name_wbsec003>
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="DoctorSearchFrame(wbsec003,name_wbsec003);">
    </td>
    <td class=DataLabel>Finance Passcode</td>
    <td><input type=text name=wbsec028 title="Finance Passcode" 
     size=10 maxlength=4>
</td></tr>

<tr valign=top><td class=DataLabel>Outpatient Site</td>
    <td><select name=wbsec006 title="Outpatient Site" onchange="CheckClinic();"     id=wbsec006>
    <option></option>
    %WEBSEC01.03.006.2
    </select>
    </td>

    <td class=DataLabel>Outpatient Clinic</td>
    <td><input type=text name=wbsec007 title="Clinic ID" size=8 
         maxlength=6 value="" id=wbsec007
         onblur="UpCase(this);validateClinic(wbsec006,wbsec007,name_wbsec007)">
        <input type=text name=name_wbsec007 class="Readonly" title="Clinic Id"
         size=25 maxlength=25 readonly value="" id=name_wbsec007>
        <img class=Icon src=../images/SearchIcon.gif
       onclick="ClinicSessionSearchFrameSite(wbsec006,wbsec007,name_wbsec007);">
        <img src="../images/erase.gif" class=Icon
         onclick="clrDoc(wbsec007,name_wbsec007);"></td>
    </tr>

<tr>
<!-- Display Multi-hospital selection list when IBCNMHOS=1 -->
    %WEBSEC01.03.034.6.1

    <td class=DataLabel>Clinic Location Type</td>
    <td><select name=wbsec032 title="Clinic Location Type">
    <option></option>
    %WEBSEC01.03.035.2
    </select></td></tr>

<tr valign=top><td class=DataLabel>Ward</td>
    <td><select name=wbsec005 title="Ward" class=Mandatory>
    <option></option>
    %WEBSEC01.03.005.2
    </select>
</td>     

    <td class=DataLabel>Occupational Group</td>
    <td><select name=wbsec008 title="Occupational Group">
    <option></option>
    %WEBSEC01.03.008.2
    </select>
</td></tr>
<tr valign=top>
    <td class=DataLabel>Emergency Site Code</td>
    <td><select name=wbsec010 title="Emergency Site Code">
    <option></option>
    %WEBSEC01.03.010.2
    </select></td>

    <td class=DataLabel>Default Menu</td>
    <td><input type=text name=wbsec016 title="Default Menu"
     size=9 maxlength=8></td>
</tr>

<tr valign=top><td class=DataLabel>Log in URL</td>
    <td><input type=text name=wbsec009 class=Mandatory title="Log in URL"
     size=40 maxlength=40></td>

    <td id="hpw00" class="DataLabel">User password expiry Date</td>
        <td id="hpw01"><input type=text name=wbsec012 id=wbsec012
         size=15 maxlength=10 title="Password expiry Date"
         onblur="checkDate(this,'User password expiry Date')">
        <img src=../images/DateTimeStamp.gif class=Icon
         date=AddForm.wbsec012>
        <img class=Icon src=../images/DateLookup.gif 
         date=AddForm.wbsec012>
    </td></tr>

<tr><td class="DataLabel">User Security Active</td>
    <td class="DataLabel">
    <input type="checkbox" name="wbsec011" title="User Security Active" 
     value="1" checked="1" />
    <span id="hpw02">
    &nbsp; Auto Ageing Enabled &nbsp;
    <input type="checkbox" name="wbsec014" id="wbsec014" value="1" checked="1"
     onclick="SetDays();" /></span>
    </td>

    <td class=DataLabel><span id="hpw03">Age by Number of Days</span></td>
    <td><span id="hpw04"><input type=input name=wbsec015 title="Age by Number of Days"
     maxlength="3" size="5" class="Mandatory Number" /></span>
</td></tr>



<tr><td class=DataLabel>Referral Management Department</td>
    <td><select name=wbsec021 title="Referral Management Department">
    <option></option>
    %WEBSEC01.03.051.2
    </select></td>

    <td class=DataLabel>Department</td>
    <td><select name=wbsec017 title="Department">
    %WEBSEC01.03.020.1
    </select></td></tr>

<tr><td class=DataLabel>GP Code</td>
    <td><input type=text name=wbsec018 title="GP Code" id=wbsec018
     readonly size=10 maxlength=10 class=Readonly tabindex=-1>
    <input type=text name=name_wbsec018 readonly size=23 maxlength=21
     class=Readonly tabindex=-1 id=name_wbsec018>
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="HCPSearchFrame(wbsec018,name_wbsec018,3);">
  <img src="../images/erase.gif" class=Icon
      onclick="clrDoc(wbsec018,name_wbsec018);"></td>

<!--
  <td class=DataLabel>GP Practice</td>
    <td><input type=text name=wbsec019 title="GP Practice Code" 
     readonly size=10 maxlength=10 class=Readonly tabindex=-1>

    <input type=hidden name=wbsec020 title="GP Practice Count" >

    <input type=text name=name_wbsec019 readonly size=23 maxlength=21 
     class=Readonly tabindex=-1>
    <img src="../images/SearchIcon.gif" 
     onclick="HCPPracCntSearchFrame(wbsec019,wbsec020,name_wbsec019);">
    <img src="../images/erase.gif" align=absmiddle 
     onclick="clrFields(wbsec019,wbsec020,name_wbsec019);"></td>
-->
     </tr>
<tr valign=top><td class=DataLabel>Document Type</td>
    <td><select name=wbsec022 title="Document Type">
    <option></option>
    %WEBSEC01.03.024.2
    </select></td>

<!-- ....... if Multi hospital "MRT Home Hospital" goes here -->
    %WEBSEC01.03.068

    <td class=DataLabel>MRT Home Location</td>
    <td><select name=wbsec023 title="MRT Home Location">
    <option></option>
    </select></td></tr>

<!-- ******** Not yet implemented *********
    <td class=DataLabel>Post Security Enabled
    <input type=checkbox name=wbsec013 value=1 checked=1>
</td>-->

<tr><td class=DataLabel>View Alert Security Level</td>
    <td><select name=wbsec024 title="View Alert Security Level">
    <option></option>
    %WEBSEC01.03.026
    </select></td>
    <td class=DataLabel>Add Alert Security Level</td>
    <td><select name=wbsec025 title="ADD Alert Security Level">
    <option></option>
    %WEBSEC01.03.027
    </select>
    </td></tr>

<tr><td class=DataLabel>Day/General Surgery Ind</td>
    <td><select name=wbsec026 title="Day/General Surgery Ind">
        <option value="   ">All</option>
         %WEBSEC01.03.028.4
        </select>
    <td class=DataLabel>Cashier</td>
    <td><input type=checkbox name=wbsec027 title="Cashier" 
         value=1 > 
    </td></tr>

<tr><td class=DataLabel>Department (Free Format)</td>
    <td><input type=text name=wbsec033 title="Department (Free Format)"
         size=17 maxlength=15></td>
    <td class=DataLabel>MRT Security Number</td>
    <td><input type=text name=wbsec030 title="MRT Security Number" 
     size=16 maxlength=8></td></tr>

<tr><td class=DataLabel>Nurse Code</td>
    <td><input type=hidden name=gnm value="">
        <input type="text" name=wbsec034 size=10 id=wbsec034
     onblur="UpCase(this);validateNurse(wbsec034,dummy1);" title="Nurse"
     value="">
    <input type="text" name=dummy1 size=20 class=Readonly readonly
     value="" id=dummy1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick='NurseSearchFrame(wbsec034,dummy1);'>
    <img src="../images/erase.gif" class=Icon
     onclick="clrDoc(wbsec034,dummy1);">
    </td>
    <td class=DataLabel>Bed Board View Number</td>
    <td><select name=wbsec036 title="Bed Board View Number">
    <option></option>
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    </select></td></tr>

<tr><td colspan=4 align=center><br>
    <input type=button value="Add" class="button" 
     onclick="CheckForm()">
    <input type=button value="Close" class="button" 
     onclick="DFrameCloseRefresh();">
</td></tr>
</table>
</td></tr>
</table>
</form>
<script type="text/javascript">
 UserSite="%STANDARD.01.023";
 for (var i =0 ; i < document.AddForm.wbsec006.length; i++) {
  if (document.AddForm.wbsec006.options[i].value==UserSite.substr(0,6)) {
       document.AddForm.wbsec006.selectedIndex=i } };
  if(typeof notUsingAutoAgeing != "undefined" ) {
    if(notUsingAutoAgeing==true) {
      document.AddForm.wbsec014.checked=false;
      SetDays();
    }
  }
  filterCatCodeList(document.AddForm.wbsec021,"3"," ","1")
</script>
