<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome"    content="stv">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript" src="../js/OutpatientTypeClinic.js"></script>
<script type="text/javascript">
function SetLists1() {
 p=SelectPeriod
 p.saveclin.value=p.fltrclid.value;
 p.fltrclid.options.length=1;
 SetTypeClinic(p.fltrclid,p.deftclid.value,p.usersite.value,p.fltrctyp.value);
 for (var i=0; i < p.fltrclid.length; i++) {
  if (p.fltrclid.options[i].value==p.saveclin.value){
      p.fltrclid.selectedIndex=i;
  }
 }
}
function SetLists2() {
 p=SelectPeriod
 p.fltrclid.options.length=1;
 SetTypeClinic(p.fltrclid,p.deftclid.value,p.usersite.value,p.fltrctyp.value);
}
function InitTable() {
 document.title="Referral Letter List - By Date"
//
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//

 t = new Table(1,0,1,"100%","center",25);

//
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
//

 t.addColumn("Book","String",9,9,"left","DocumentIcon.gif","0",40)
 t.addColumn("Patient","String",1,1,"left","","",100)
 t.addColumn("Date","Date",2,2,"left","","",40)
 t.addColumn("Referring GP","String",10,10,"left","","",100)
 t.addColumn("Clinic Type","String",4,4,"left","","",70)
 t.addColumn("Clinic","String",5,5,"left","","",80)
 if (document.SelectPeriod.alcndtrg.value=="1") {
   t.addColumn("Triage Status","String",11,11,"left","","",50)
 }
 t.addColumn("Priority","String",6,6,"left","","",75)
 t.addColumn("Reason","String",7,7,"left","","",70)

//
// Add Rows to Table (Output from Web Server)
//

 AddTableRows();

 t.sortTable(1,1);   // Sort in Patient order
 t.sortTable(2,0);   // Sort in reverse Date order
 TableOutput(0,0);   // Sort in Status (Unbooked/Booked) order
}
function ReferralLink(PatUR, Referral, BStatus) {
  PatientLinks.urnumber.value=PatUR;
  PatientLinks.admissno.value=Referral;
  if (BStatus == 0)  // Unbooked referral
     PatientLinkTo("outweb01.pbl",4,2,1,700,550);
  else
     PatientLinkTo("outweb01.pbl",4,4,1,750,550);
}
function FilterSubmit() {
  if (SelectPeriod.fltrclid.value > " " || SelectPeriod.fltrctyp.value > " ") {
document.SelectPeriod.clinicid.value=
document.SelectPeriod.fltrclid.options[document.SelectPeriod.fltrclid.selectedIndex].value
    SelectPeriod.submit();
  } else {
    alert("Please Enter Clinic Id or Clinic Type"); }
}
function SetRefListPathCookie() {
  document.cookie = "RefListPath=" + escape(location.href) + ";"
}
function displayTriageStatus() {
  x=document.SelectPeriod.alcndtrg.value;
  if(x=="1") {
    TrgsHead.innerHTML=trgshead.innerHTML;
    TrgsOptn.innerHTML=trgsoptn.innerHTML;
  } else {
    TrgsHead.innerHTML="";
    TrgsOptn.innerHTML=trgsblank.innerHTML;
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);displayTriageStatus();
              SetRefListPathCookie();SetLists2();">
<div id=HeadingSection>
<form name=SelectPeriod action=outweb01.pbl method=get style="margin:0">
<input type=hidden name=reportno value=5>
<input type=hidden name=template value=2>
<input type=hidden name=viewtype value="%OUTWEB01.05.152">
<input type=hidden name=deftclid value="%OUTWEB01.05.144.1">
<input type=hidden name=usersite value="%STANDARD.01.023">
<input type=hidden name=clinicid id=clinicid>
<input type=hidden name=saveclin id=saveclin value="">
<input type=hidden name=alcndtrg id=alcndtrg value="%STANDARD.01.025.121.125.0.1">

<table cellspacing=0 cellpadding=0 border=0 width=100% bgcolor=#cccccc>
<tr>
    <td class=DataField width=8%>Clinic Type</td>
    <td><select name=fltrctyp id=fltrctyp class=SelectBig
         onchange="SetLists1();">
          <option></option>
          %OUTWEB01.05.143.2 
        </select></td>
    <td class=DataField>Clinic Id</td>
    <td><select name=fltrclid id=fltrclid class=SelectBig title="Clinic Id">
        <option></option>
        </select></td>

    <td class=DataField><div id=TrgsHead></div></td>
    <td><div id=TrgsOptn></div></td>

    <td><input type=button class="button" value="Search" 
         onclick='FilterSubmit();'></td></tr>

<tr><td class=DataField>Referring GP</td>
    <td><input type=hidden name=fltrrfgp id=fltrrfgp title="Referring GP"
         value="%OUTWEB01.05.161.001">
        <input type=hidden name=dummy id=dummy>
        <input type=text name=name_fltrrfgp id=name_fltrrfgp readonly
         size=30 maxlength=30 value="%OUTWEB01.05.161.081">
        <img src="../images/SearchIcon.gif" class=Icon title="GP Search"
         onclick="HCPSearchFrame(fltrrfgp,name_fltrrfgp,3);">
        <img src="../images/ClearIcon.gif" class=Icon title="Clear"
         onclick="clrFields(fltrrfgp,name_fltrrfgp);"></td>

    <td class=DataField>Status</td>
    <td><select class=SelectBig name=fltrstat id=fltrstat>
        <option value=" "> </option>
         %OUTWEB01.05.147
        </select></td>

    <td class=DataField>Priority</td>
    <td><select name=fltrprio id=fltrprio class=SelectBig>
        <option></option>
         %OUTWEB01.05.145.2  
        </select></td></tr>

  <tr>
    <td class=DataField>Referral Date</td>
    <td>
        <input type=button value="<<" class=SmallButton
         onclick='location.href="%OUTWEB01.05.150"'>
         %OUTWEB01.05.151
        <input type=button value=">>" class=SmallButton
         onclick='location.href="%OUTWEB01.05.149"'>
        <a href='javascript:SelectDateFrame();'>
        <img src="../images/DateLookup.gif" border=0
         alt="Select Date" title="Select Date" align=absmiddle></a>
        <a href='javascript:SelectView("0");'>
        <img src=../images/DayIcon.gif border=0
         alt="View Today" title="View Today" align=absmiddle></a>
        <a href='javascript:SelectView("1");'>
        <img src=../images/WeekIcon.gif border=0 
         alt="View This Week" title="View This Week" align=absmiddle></a>
        <a href='javascript:SelectView("2");'>
        <img src=../images/MonthIcon.gif border=0 
         alt="View This Month" title="View This Month" align=absmiddle></a>
    </td>
  </tr>

</table>
</form>
</div>

<div id=TableLocation></div>

<script type="text/javascript">
function AddTableRows() {
%OUTWEB01.05.142.1
}
</script>


<form name=PatientLinks method=get>
<input type=hidden name=reportno value=5>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value="">
<input type=hidden name=admissno value="">
<input type=hidden name=bookflag value="">
</form>

<span id=trgshead style="display:none">
Triage Status
</span>
<span id=trgsoptn style="display:none">
  <select name=fltrtrgs id=fltrtrgs class=SelectBig>
    <option></option>
    %OUTWEB01.05.165
  </select>
</span>
<span id=trgsblank style="display:none">
<input type=hidden name=fltrtrgs id=fltrtrgs value="">
</span>
