<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/EmrRegistration.js"></script>
<script type="text/javascript" src="../js/emrweb0202020.js"></script>
<script type="text/javascript">
function CancelAction() {
  if (top.TogglePanel==null) {
    top.location.reload();
  } else {
    top.TogglePanel();
  }
}
function showFundingSource() {
  i=document.UpdateForm.emvis008.selectedIndex;
  ind=document.UpdateForm.emvis008.options[i].value.substring(3,4)
  if (ind=="A") {
    FundingHeading.innerHTML=offdutyhd.innerHTML;
    FundingId.innerHTML=offdutyid.innerHTML;
  } else {
    if (ind=="P") {
      FundingHeading.innerHTML=fundinghd.innerHTML;
      FundingId.innerHTML=fundingid.innerHTML;
      document.UpdateForm.pmsvx141.className="Mandatory";
    } else {
      FundingHeading.innerHTML="";
      FundingId.innerHTML="";
    }
  }
}
function defaultDisasterCode() {

  if (document.UpdateForm.emexp018.value=="       0") {
     document.UpdateForm.dispt001.disabled=true;
     return;
  }

  if (!isWhitespace(document.UpdateForm.disacode.value)) {
  for (var i =0 ; i < document.UpdateForm.dispt001.length; i++) {
     if (document.UpdateForm.dispt001.options[i].value==
         document.UpdateForm.disacode.value) {
         document.UpdateForm.dispt001.selectedIndex=i
     }
    }
  }

  displayDisasterID();

  if (!isWhitespace(document.UpdateForm.dispt001.value)) {
    document.UpdateForm.dispt001.className = "Readonly";
    document.UpdateForm.dispt001.onfocus =
    function () {this.defaultIndex=this.selectedIndex};
    document.UpdateForm.dispt001.onchange =
    function () {this.selectedIndex=this.defaultIndex};
  }

}
function displayDisasterID() {
 p=document.UpdateForm
  if (!isWhitespace(document.UpdateForm.dispt001.value)) {
    disasteridnumbertitleDIV.innerHTML=disasteridnumbertitleSPAN.innerHTML;
    disasteridnumberDIV.innerHTML=disasteridnumberSPAN.innerHTML;
  } else {
    disasteridnumbertitleDIV.innerHTML="";
    disasteridnumberDIV.innerHTML="";
  }

  if (!isWhitespace(disasteridnumberDIV.innerHTML)) {
    var serverURL   = "../cgi-bin/patweb80.pbl?reportno=98" +
                    "&valdcode=" + UpdateForm.emexp018.value.replace(/ /g,"+") +
                    UpdateForm.dispt001.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|");
      if (!isWhitespace(ReturnValue[0])) {
        p.dispt002.value=ReturnValue;
        p.dispt002.className="Readonly";
        p.dispt002.readOnly=true;
      }
    }
  }
}
function PostAdd() {
  if(document.UpdateForm.offdutyb!=undefined){
    if(document.UpdateForm.offdutyb.checked==true){
      alert("Error: Claim Type invalid for 'Off Duty' personnel.")
      return;
    }
  }

  if(p.prevhosp.checked==true){
    document.UpdateForm.redirect.value="patweb07.pbl?reportno=15&template=001"
    SetCookie("prevhospCookie",'3');
  }

  UpdateVisit();
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);SetFields();checkReferred();defaultDisasterCode();CheckAmbType();">
<span class=DFrameTitleBar>
Register Emergency Patient
</span>
<form name=UpdateForm action="emrweb02.pbl" method=post style="margin:0">
<input type=hidden name=reportno value="02">
<input type=hidden name=template value="20">
<input type=hidden name=updatety value="4">
<input type=hidden name=formactn>
<input type=hidden name=updttype>
<input type=hidden name=urnumber value="%EMRWEB02.02.003">
<input type=hidden name=admissno value="%EMRWEB02.02.081">
<input type=hidden name=updateky value="%EMRWEB02.02.700">
<input type=hidden name=nextpage value="14">
<input type=hidden name=redirect value="emrweb02.pbl?reportno=1&template=4">
<input type=hidden name=deceased>
<input type=hidden name=selsex>
<input type=hidden name=gname>
<input type=hidden name=sname>
<input type=hidden name=dummy>
<input type=hidden name=dummyadm> 
<input type=hidden name=pfgname>
<input type=hidden name=pfsname>
<input type=hidden name=pcomdeft value="0">
<input type=hidden name=emexp001 value="">
<input type=hidden name=emexp004 value="">
<input type=hidden name=emexp007 value="">
<input type=hidden name=emexp008 value="">
<input type=hidden name=emexp009 value="">
<input type=hidden name=emexp010 value="">
<input type=hidden name=emexp011 value="">
<input type=hidden name=emexp012 value="">
<input type=hidden name=emexp013 value="">
<input type="hidden" name="disacode" value="%EMRWEB02.02.498">
<input type=hidden name=ptcnnmpr value="%STANDARD.01.025.128.226.1.1">
 
<table align=center width=95% border=0 cellspacing=0 cellpadding=2>
<tr><td class=DataLabel>User Id </td>
    <td><input type=hidden name=securety value="2">
        <input type=text size=12 name=secureid class="Mandatory NoAutoFocus" 
          tabindex=1 title="User ID" value="%STANDARD.01.043">
    Password
      <input type=password size =12 name=securepw class=Mandatory tabindex=2
        title="Password" onfocus="SetCaretPosition('securepw',-1);" 
        onblur="checkPass();">
    </td>
    </tr>
 
<tr><td class=DataLabel>U/R</td> 
   <td><input type=text size=10 maxlength=8 name=emexp018 tabindex=2
       title="U/R number" class=Mandatory 
 onblur="UpCase(this);justifyRight(this);PatientReturnWA();displayDisasterID();">
       <img src=../images/SearchIcon.gif class=Icon onclick="PatientSearchWA();">
</td>
    <td class=DataLabel>Surname </td>
    <td><input type=text size=25 max=25 name=emexp002 tabindex=-1 readOnly
         class="readOnly"></td>
    <td class=DataLabel>Given Name </td>
    <td><input type=text size=25 max=25 name=emexp003 tabindex=-1 readOnly
         class="readOnly"></td></tr>

<tr id=PrefNamesBoth style="display:none">
    <td>&nbsp;</td><td>&nbsp;</td>
    <td class=DataLabel>Preferred Surname</td>
    <td><input type=text size=20 maxlength=20 name=pmpxi82b id=pmpxi82b
         title="Preferred Surname" tabindex=3 class=Readonly></td>
    <td class=DataLabel>Preferred Given Name</td>
    <td><input type=text size=25 maxlength=25 name=pmpxi83b id=pmpxi83b
         title="Preferred Given Name" tabindex=3 class=Readonly></td>
</tr>

<tr id=PrefNamesGiven style="display:none">
    <td>&nbsp;</td><td>&nbsp;</td>
    <td>&nbsp;</td><td>&nbsp;</td>
    <td class=DataLabel>Preferred Given Name</td>
    <td><input type=text size=25 maxlength=25 name=pmpxi83g id=pmpxi83g
         title="Preferred Given Name" tabindex=3 class=Readonly></td>
</tr>

<tr id=PrefNamesSurname style="display:none">
    <td>&nbsp;</td><td>&nbsp;</td>
    <td class=DataLabel>Preferred Surname</td>
    <td><input type=text size=20 maxlength=20 name=pmpxi82s id=pmpxi82s
         title="Preferred Surname" tabindex=3 class=Readonly></td>
    <td>&nbsp;</td><td>&nbsp;</td>
</tr>

<tr><td></td>
    <td></td>
    <td class=DataLabel>Sex</td>
    <td><input type=text size=15 name=d_emexp004 tabindex=-1 readOnly
         class="readOnly">
    </td>
    <td class=DataLabel>Date of Birth </td>
    <td><input type=text size=12 max=11 name=emexp005 
         title="Date of Birth" class="readOnly" tabindex=-1 readOnly>
        </td></tr>

<tr><td colspan=6><hr></td></tr>
</table>

<table align=center width=95% border=0 cellspacing=0 cellpadding=0>
    <tr><td class=DataLabel>Arrival Date/Time </td>
    <td>
    <input type=text size=11 max=11 name="emvis001" value="%EMRWEB02.02.101.0"
     title="Arrival Date" class="Mandatory PastDate" tabindex=10>
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Show Calendar" date="UpdateForm.emvis001">
    <input type=text size=8 max=8 name="emvis002" value="%EMRWEB02.02.102"
     title="Arrival Time" class=Mandatory tabindex=11>
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="UpdateForm.emvis001" time="UpdateForm.emvis002">
    <img notab src="../images/TimeLookup.gif" class="Icon"
     alt="Time Select" time="UpdateForm.emvis002">
    </td>
    <td class=DataLabel>%STANDARD.01.017.CL</td>
     <td><select class="Mandatory SelectMed" name=emvis008 tabindex=12
          title="%STANDARD.01.017.CL"  onchange=showFundingSource();>
     <option></option>
     %EMRWEB02.02.108.2
     </select></td>
      <td><div id=FundingHeading></div></td>
      <td><div id=FundingId></div>
    </tr>

<tr><td class=DataLabel>Arrival Transport</td>
    <td><select name=emvis013 tabindex=15 class="Mandatory SelectMed"
         title="Arrival Transport"
         onchange="document.UpdateForm.emvis034.disabled=0;CheckAmbType();">
     <option></option>
     %EMRWEB02.02.113.2
     </select></td>
     <td class=DataLabel>Amb Case No</td>
     <td><input type=text size=20 maxlength=15 name=emvis034 tabindex=16
         onFocus="CheckAmbType();" value="%EMRWEB02.02.134" title="Amb Case No"
         onblur="ValidateAmbCase();"></td>
    <td class=DataLabel>Attendance Type</td>
    <td><select class="Mandatory SelectMed" name=emvis053 tabindex=17
         title="Attendance Type">
     <option></option>
     %EMRWEB02.02.213.2
     </select></td>
     </tr>

<tr><td class=DataLabel>Attendance Source</td>
    <td><select class="Mandatory SelectMed" name=emvis061 tabindex=19
         title="Attendance Source"
         onchange="checkReferred();">
         <option></option>
         %EMRWEB02.02.221.2
         </select></td>
    <td class=DataLabel>%STANDARD.01.017.cw</td>
    <td><select name=pmsvx135 class="Mandatory SelectMed" tabindex=20
       title="%STANDARD.01.017.cw">
         <option></option>
           %STANDARD.01.007.cw
      </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.eh</td>
    <td><select name=emvis056 tabindex=21 title="%STANDARD.01.017.eh"
         class="SelectBig">
        <option></option>
        %EMRWEB02.02.216.2
        </select>
    </td></tr>

<tr><td><div id=TranSrcHeading></div></td>
    <td><div id=TranSrc></div></td>
    <td class=DataLabel></td>
    <td></td>
    <td class=DataLabel></td>
    <td></td>
    </tr>

<tr><td class=DataLabel>Disaster Code</td>
    <td><select name=dispt001 title="Disaster Code"
        onchange="displayDisasterID();" tabindex=22>
        <option></option>
        %EMRWEB02.02.497
        </select>
    </td>
    <td class=DataLabel><div id=disasteridnumbertitleDIV></div></td>
    <td><div id=disasteridnumberDIV></div></td>
    <td class=DataLabel></td>
    <td></td>
    <tr>

<tr><td class=DataLabel>Location</td>
    <td><input type=hidden name=name_emvis006 title="Location">
        <select class="Mandatory" name="emvis006"
         title="Location" tabindex=24
         onchange="validateLocation(UpdateForm.emvis006,
                   UpdateForm.name_emvis006);">
        %EMRWEB02.02.106.3
        </select>
    </td>
    <td align=left>Hospital Last 7 Days</td>
    <td>
      <table>
        <tr>
        <td align=left>
          <input type="checkbox" name="prevhosp" value="1" tabindex=24>
        </td></tr>
      </table>
    </td>
    </tr>

  <tr><td></td>
      <td></td>
      <td class=DataLabel>
        %STANDARD.01.017.KD
      </td>
      <td>
        <select class="Mandatory SelectMed" name=pmsvx079 tabindex=24
         title="%STANDARD.01.017.KD">
          <option></option>
            %STANDARD.01.007.KD
        </select>
     </td>
  </tr>

<tr><td colspan=6 align=center><br>
    <input type=button value="Add" class="button" tabindex=40 name="AddButton"
     id="AddButton" onclick="tempDisable(this);PostAdd();">
    <input type=button value="Cancel" class="button" tabindex=41
     onclick="CancelAction();">
    </td></tr>
</table>
</form>

<span id=transferhd style="display:none">
<td class=DataLabel>Transfer Source</td>
</span>

<span id=transferblank style="display:none">
   <input type=hidden name=emvis032 value="" notab>
</span>

<span id=transfersrc style="display:none">
<td><input type="text" size=8 maxlength=6 name="emvis032" tabindex=19
     value="%EMRWEB02.02.132.1" title="Transfer Source" class=Mandatory
     onchange='validateCode(9,UpdateForm.emvis032,UpdateForm.trnsfsrc);'>
     <input type=text  size=25 name=trnsfsrc value="%EMRWEB02.02.132.0"
      readonly notab>
     <img src="../images/SearchIcon.gif" notab class=Icon
     onclick="TransferSourceFrame(UpdateForm.emvis032,
              UpdateForm.trnsfsrc)"></td>
</span>

<span id=fundinghd style="display:none">
&nbsp;Funding Source
</span>

<span id=fundingid style="display:none">
  <select name=pmsvx141 title="%STANDARD.01.017.cx"
          tabindex=14>
          <option> </option>
             %EMRWEB02.02.514.4
  </select>
</span>

<span id=disasteridnumbertitleSPAN style="display:none">
Disaster Identification #
</span>

<span id=disasteridnumberSPAN style="display:none">
<input type="text" name=dispt002 size=20 maxlength=19 tabindex=23
   title="Disaster Identification Number">
</span>

<span id=offdutyhd style="display:none">
 Off Duty
</span>

<span id=offdutyid style="display:none">
 <input type="checkbox" name="offdutyb" value="0" tabindex=14>
</span>
