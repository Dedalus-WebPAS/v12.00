<meta name="TemplateVersion" content="V12.00.04">
<meta name="TemplateHome"    content="wahealth">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true"> 
<script type="text/javascript" src="../js/outweb0203.js"></script>
<script type="text/javascript" src="../js/OutExtraTemplates.js"></script>
<script type="text/javascript" src="../js/outweb02.js"></script>
<script type="text/javascript" src="../js/CustomMyhrConsent.js"></script>
<script type="text/javascript">

var SlotCode;
var SlotDate;
var SlotName;
function updateParent(code,name,date,vist,clintcd,clintdes,clinind,clinbst,hic
                      ,carer,letdays,nmds,caret,servd,hrisk,isOverBooked) {
    SlotCode=code
    SlotDate=date
    SlotName=name

    //Clinic Indicator
    if (typeof(AddForm)=='object' && typeof(AddForm.clinindc)=='object') {
      AddForm.clinindc.value=clinind;
    }

    //go to the server for a new set of clinic list that
    //are overbooked

    var clinicVisitList = null;

    if(typeof UpdateForm != 'undefined') {
      if(typeof UpdateForm.outbb047 != 'undefined') {
        clinicVisitList = UpdateForm.outbb047;
      }
    }else if(typeof AddForm != 'undefined' ){
      if(typeof AddForm.outbb047 != 'undefined') {
        clinicVisitList = AddForm.outbb047;
      }
    }

    if(clinicVisitList != null) {
      var data = RSExecute("../cgi-bin/comweb80.pbl?reportno=61&valdcode=CV");
      if(typeof data  != 'undefined'){
        if(data != null) {
          patcodes = eval("("+data.return_value+")");
          //if we get this far lets recreate the clinic visit list

          clinicVisitList.innerHTML = "";
          var option = document.createElement('option');
          option.value = "                 ";
          option.innerHTML = "             ";
          clinicVisitList.appendChild(option);

          if(isOverBooked == "Z") {
            for(var i = 0; i < patcodes.length; i++) {
              if(typeof patcodes[i] != "undefined" && patcodes[i] != null) {
                if( patcodes[i].indicators.substring(2,1) == isOverBooked ) {
                  if( trim(patcodes[i].indicators.substring(6,1)) != "U" ) {
                    var option = document.createElement('option');
                    option.value = patcodes[i].acode+patcodes[i].indicators;
                    option.innerHTML = patcodes[i].tdesc;
                    clinicVisitList.appendChild(option);
                  }
                }
              }
            }
          }else {
            for(var i = 0; i < patcodes.length; i++) {
              if(typeof patcodes[i] != "undefined" && patcodes[i] != null) {
                if( trim(patcodes[i].indicators.substring(6,1)) != "U" ) {
                  var option = document.createElement('option');
                  option.value = patcodes[i].acode+patcodes[i].indicators;
                  option.innerHTML = patcodes[i].tdesc;
                  clinicVisitList.appendChild(option);
                }
              }
            }
          }
        }
      }
    }

    var sendLetter = null;

    if(typeof AddForm != 'undefined') {
      sendLetter = AddForm.outbb047;
    }else if(typeof UpdateForm != 'undefined') {
      sendLetter = UpdateForm.outbb047;
    }

    if(sendLetter != null && typeof sendLetter.onchange != 'undefined') {
     setTimeout(function(){ sendLetter.onchange();},200);
    }

    //New Slot key
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.nslotkey)=='object') {
           AddForm.nslotkey.value=code;
        }

    //visit type
     if(typeof(AddForm)=='object' && AddForm.outbb047.type=='select-one') {
         for (var i =0 ; i < AddForm.outbb047.length; i++) {
         if (trim(AddForm.outbb047.options[i].value.substr(0,3))==trim(vist)) {
           AddForm.outbb047.selectedIndex=i }
         }
        }
    //////
     if(typeof(UpdateForm)=='object' &&
        typeof(UpdateForm.outbb047)=='object') {
       if(UpdateForm.outbb047.type=='select-one') {
         for (var i =0 ; i < UpdateForm.outbb047.length; i++) {
         if (trim(UpdateForm.outbb047.options[i].value.substr(0,3))==trim(vist)) {
           UpdateForm.outbb047.selectedIndex=i }
         }
       }
     }

    /////
    // Added for diagnosis search
    //
    if (typeof(parent.AddForm)=='object' &&
       typeof(parent.AddForm.defclnty)=='object') {
           parent.AddForm.defclnty.value=clintcd;
        }
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.defclnty)=='object') {
           AddForm.defclnty.value=clintcd;
    }
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.outbb016)=='object') {
       AddForm.outbb016.value=clintcd;
    }
    if (typeof(parent.UpdateForm)=='object' &&
       typeof(parent.UpdateForm.defclnty)=='object' &&
       typeof(parent.UpdateForm.follflag)=='object') {
         parent.UpdateForm.defclnty.value=clintcd;
    }
    if (typeof(UpdateForm)=='object' &&
       typeof(UpdateForm.defclnty)=='object' &&
       typeof(UpdateForm.follflag)=='object') {
         UpdateForm.defclnty.value=clintcd;
    }
    if (typeof(UpdateForm)=='object' &&
       typeof(UpdateForm.outbb016)=='object' &&
       typeof(UpdateForm.follflag)=='object') {
         UpdateForm.outbb016.value=clintcd;
    }
    //
    // Clinic using medclaims
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.otmaumci)=='object') {
           AddForm.otmaumci.value=hic;
    }
    //
    // Collect Carer Details
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.otheccar)=='object') {
           AddForm.otheccar.value=carer;
    }
    //
    // Generate letter days
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.othendps)=='object') {
       AddForm.othendps.value=letdays;
    }
    if (typeof(UpdateStatus)=='object' &&
       typeof(UpdateStatus.othendps)=='object') {
       UpdateStatus.othendps.value=letdays;
    }

    // NMDS Code AddForm
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.outbb068)=='object') {
         for (var i =0 ; i < AddForm.outbb068.length; i++) {
             if (trim(AddForm.outbb068.options[i].value.substr(0,3))==
                 trim(nmds)) {
                 AddForm.outbb068.selectedIndex=i }
         }
    }

    // Care Type AddForm
   if (typeof(AddForm)=='object' &&
     typeof(AddForm.outbb069)=='object') {
       for (var i =0 ; i < AddForm.outbb069.length; i++) {
       if (trim(AddForm.outbb069.options[i].value.substr(0,3))==
           trim(caret)) {
           AddForm.outbb069.selectedIndex=i }
       }
   }
   // Service Delivery AddForm
   if (typeof(AddForm)=='object' &&
     typeof(AddForm.outbb070)=='object') {
     for (var i =0 ; i < AddForm.outbb070.length; i++) {
       if (trim(AddForm.outbb070.options[i].value.substr(0,3))==
         trim(servd)) {
         AddForm.outbb070.selectedIndex=i
       }
     }
   }

  // Clinical High Risk AddForm
  if (typeof(AddForm)=='object' &&
    typeof(AddForm.d_outbb071)=='object') {
      if(hrisk=="1") {
        AddForm.d_outbb071.checked=true;
        AddForm.d_outbb071.disabled=true;
      } else {
        AddForm.d_outbb071.checked=false;
        AddForm.d_outbb071.disabled=false;
      }
  }

  // Clinical High Risk UpdateForm
  if (typeof(UpdateForm)=='object' &&
    typeof(UpdateForm.outbb071)=='object') {
      if(hrisk=="1") {
        UpdateForm.outbb071.checked=true;
        UpdateForm.outbb071.disabled=true;
      } else {
        UpdateForm.outbb071.disabled=false;
      }
  }

  // Clinical High Risk UpdateForm
  if (typeof(UpdateForm)=='object' &&
   typeof(UpdateForm.d_outbb071)=='object') {
      if(hrisk=="1") {
        UpdateForm.d_outbb071.checked=true;
        UpdateForm.d_outbb071.disabled=true;
      } else {
        UpdateForm.d_outbb071.disabled=false;
      }
  }

  // Generate letter days
  if (typeof(UpdateForm)=='object' &&
    typeof(UpdateForm.othendps)=='object') {
       UpdateForm.othendps.value=letdays;
  }
  //
  // Generate letter days
  if (typeof(Reschedule)=='object' &&
   typeof(Reschedule.othendps)=='object') {
       Reschedule.othendps.value=letdays;
  }
  //
  //Dummy hidden field for visit type
  if (typeof(AddForm)=='object' &&
    typeof(AddForm.d_outbb047)=='object') {
       AddForm.d_outbb047.value=trim(vist);
  }
  //
  //Dummy hidden field for visit type
  if (typeof(UpdateForm)=='object' &&
    typeof(UpdateForm.d_outbb047)=='object') {
       UpdateForm.d_outbb047.value=trim(vist);
       if(typeof(SendLetterDNA03)== 'function'){
         ReturnDate.value=SlotDate
         SendLetterDNA03();
       }
  }
  //
  //Dummy hidden field for visit type
  if (typeof(Reschedule)=='object' &&
    typeof(Reschedule.d_outbb047)=='object') {
       Reschedule.d_outbb047.value=trim(vist);
       if(typeof(SendLetterRSH02)== 'function'){
         ReturnDate.value=SlotDate
         SendLetterRSH02();
       }
  }
  //
  //Dummy hidden field for visit type
  if (typeof(UpdateStatus)=='object' &&
    typeof(UpdateStatus.d_outbb047)=='object') {
       UpdateStatus.d_outbb047.value=trim(vist);
       if(typeof(SendLetterRSH01)== 'function'){
         ReturnDate.value=SlotDate
         SendLetterRSH01();
       }
  }
  //
  reserveSlot(code,"","","",UpdatePage)
}

function UpdatePage() {
  document.UpdateForm.newslotk.value=SlotCode
  document.UpdateForm.clindesc.value=SlotName
  document.UpdateForm.clindate.value=SlotDate
  document.getElementById('PopUpScreen').style.display="none"
}


function PrinterMandatory(CheckBox,SelectList) {
  if (CheckBox.checked) {
    SelectList.className="Mandatory SelectBig" }
  else {
    SelectList.className="SelectBig" }
}
function init() {
    UpdateForm.redirect.value="outweb02.pbl?reportno=3&template=001" +
                              "&shwprint=1" +
           "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")
}
function checkRedirect() {
  p=document.UpdateForm
  p.valddate.value=p.clindate.value.substr(4,12);
  validateSuspension(p.urnumber,p.valddate,p.datefrom,p.dateto);
  if(p.datefrom.value!='0'){
       ans=confirm("Warning : Patient has a Suspension record for period \n" +
             "\t" + p.datefrom.value  + " - " + p.dateto.value);
       if (ans!=true) {
          return; }
  } 
  if(chkExtraTempl(document.UpdateForm,"B",document.UpdateForm.newslotk.value,
                PatientLinks.urnumber.value.replace(/ /g,"+"))) {
    document.UpdateForm.nextpage.value="6";
  }
  if(!CheckRefLetter()) {
    return;
  }
  if(document.UpdateForm.d_pmsvx093.checked==true) {
    document.UpdateForm.pmsvx093.value="1";
  } else {
    document.UpdateForm.pmsvx093.value="0";
  }
  valReferralClaim();
  checkMVAccident();
  SubmitFinal();
}
function checkMVAccident() {
  if (document.UpdateForm.opwamvny.value == "1") {
    document.UpdateForm.redirect.value="patweb89.pbl?reportno=1&template=342" +
         "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+") +
         "&pmext049=" + document.UpdateForm.opwamvny.value +
         "&foupbkin=1&chckcomp="+document.UpdateForm.obacompd.value[3]+"O";
  } else {
    document.UpdateForm.redirect.value
      = setFundingRedirect(document.UpdateForm.obacompd.value[3]);
  }
}
function showFundingSource() {
  ind=document.UpdateForm.d_outbb002.value.substring(3,4)
  if (ind=="P") {
    FundingHeading.innerHTML=fundinghd.innerHTML;
    FundingId.innerHTML=fundingid.innerHTML;
  } 
}
function DefAddedSlot() {
  if(!isWhitespace(document.UpdateForm.d_addslotk.value)) {
    document.UpdateForm.newslotk.value=document.UpdateForm.d_addslotk.value
    document.UpdateForm.clindesc.value=document.UpdateForm.d_addslotk_desc.value
    document.UpdateForm.clindate.value=document.UpdateForm.d_addslotk_date.value//
    for (var i =0 ; i < document.UpdateForm.outbb047.length; i++) {
    if (document.UpdateForm.outbb047.options[i].value.substr(0,3)==
        document.UpdateForm.d_addslotk_vtype_c.value.substr(0,3)) {
        document.UpdateForm.outbb047.selectedIndex=i 
    } };
// 
    for (var i =0 ; i < document.UpdateForm.outbb072.length; i++) {
    if (document.UpdateForm.outbb072.options[i].value.substr(0,3)==
        document.UpdateForm.d_addslotk_othet2_c.value.substr(0,3)) {
        document.UpdateForm.outbb072.selectedIndex=i 
    } };
// 
    for (var i =0 ; i < document.UpdateForm.outbb068.length; i++) {
    if (document.UpdateForm.outbb068.options[i].value.substr(0,3)==
        document.UpdateForm.d_addslotk_othenm_c.value.substr(0,3)) {
        document.UpdateForm.outbb068.selectedIndex=i 
    } };
// 
    for (var i =0 ; i < document.UpdateForm.outbb069.length; i++) {
    if (document.UpdateForm.outbb069.options[i].value.substr(0,3)==
        document.UpdateForm.d_addslotk_othecc_c.value.substr(0,3)) {
        document.UpdateForm.outbb069.selectedIndex=i 
    } };
// 
    for (var i =0 ; i < document.UpdateForm.outbb070.length; i++) {
    if (document.UpdateForm.outbb070.options[i].value.substr(0,3)==
        document.UpdateForm.d_addslotk_othesd_c.value.substr(0,3)) {
        document.UpdateForm.outbb070.selectedIndex=i 
    } };
// 
    document.UpdateForm.othendps.value=document.UpdateForm.d_addslotk_othendps.value
    document.UpdateForm.otheclhr.value=document.UpdateForm.d_addslotk_otheclhr.value
  }
}
function GetAppointmentKeyCookie() {
//  alert(GetCookieData("appointmentkeycookie"));
  if (GetCookieData("appointmentkeycookie") != "unknown" &&
      !isWhitespace(GetCookieData("appointmentkeycookie"))) {
    appointmentkeycookie = GetCookieData("appointmentkeycookie").split("|");
    ExpireCookiePath("appointmentkeycookie");
    updateParent(appointmentkeycookie[0],appointmentkeycookie[1],
                 appointmentkeycookie[2],appointmentkeycookie[3],
                 appointmentkeycookie[4],appointmentkeycookie[5],
                 appointmentkeycookie[6],appointmentkeycookie[7],
                 appointmentkeycookie[8],appointmentkeycookie[9],
                 appointmentkeycookie[10],appointmentkeycookie[11],
                 appointmentkeycookie[12],appointmentkeycookie[13],
                 appointmentkeycookie[14],appointmentkeycookie[15]);
    
  }
}
function getClosedReferral() {
  if (isWhitespace(document.getElementById('alrevisn').value)) {return;}

  var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=46" +
                    "&valdcode=" +
                    document.getElementById('alrevisn').value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    if (!isWhitespace(returnValue.return_value)) {
      if(!confirm('Warning this referral was closed on ' +
       returnValue.return_value + '. Click OK to continue, Cancel to abort.')) {
        AppFrameExit();
      }
    }
  }
}
function DisplayWarning(){
  if(UpdateForm.outbb070.value.substr(3,1)=="W"){
     alert("Warning: This code is only to be used \n"
           +"when the patient or carer is not present.");
  }
}
function DisabledFields(){
  f = document.UpdateForm;
  f.outbb068.disabled = true;
  f.outbb072.disabled = true;
  f.outbb069.disabled = true;
}
function ReEnableFields(){
  f = document.UpdateForm;
  f.outbb068.disabled = false;
  f.outbb072.disabled = false;
  f.outbb069.disabled = false;
  f.outbb067.disabled = false;
}

function SetSendLetter(){
 for (var i=0 ; i<document.UpdateForm.outbb067.length; i++) {
  if (document.UpdateForm.outbb067.options[i].value == '1' ) {
       document.UpdateForm.outbb067.selectedIndex=i;
       break;
  }
 }
}

function SendLetter03(theForm) {
  if(theForm.outbb047.value.substr(10,1) == "C" ||
    (SetDateYYYYMMDD(theForm.clindate.value.substr(4,11)) <
     SetDateYYYYMMDD(theForm.currdate.value))) {   // Ind 8 - Chart Only or
    theForm.outbb067.selectedIndex=3;              // new booking less than
    theForm.outbb067.className="Readonly";         // today set send letter
    theForm.outbb067.disabled=true;                // N/A
  } else {
    if(theForm.outbb067.disabled==true) {          // Defalut send letter to
       SetSendLetter();                            // YES
    }
    theForm.outbb067.className="";
    theForm.outbb067.disabled=false;
  }
  SendLetterDate03(theForm);
}

function ResetLetter(theForm) {
    SetSendLetter();
    theForm.outbb066.value="";
    theForm.outbb066.readOnly=false;
    theForm.outbb066.className="Date";
}
function valReferralClaim() {
  var claimCodeVal = UpdateForm.d_outbb002.value.substr(0,3);
  var serverURL = "../cgi-bin/outweb02.pbl?reportno=9&updatety=19" +
                  "&admissno="+PatientLinks.admissno.value.replace(/ /g,"+") +
                  "&outbb002="+claimCodeVal +
                  "&urnumber="+PatientLinks.urnumber.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    if (ReturnValue[0] === '1') {
      var categoryName = ReturnValue[3].trim();
      var ans=confirm("The Outpatient Appointment " + categoryName +
      " does not match the Referral " + categoryName + ".\n\n" +
      "Outpatient Appointment " + categoryName + " = " + ReturnValue[2] +
      "\n" +
      "Referral " + categoryName + " = " + ReturnValue[1] + "\n\n" +
      "Press OK to update the Referral " + categoryName + " code.\n" +
      "Press Cancel to leave the Referral " +categoryName+ " code unchanged.");
      if (ans) {
        var fundingSourceVal = UpdateForm.d_pmvxfsrc.value.substr(0,3);
        var serverURL = "../cgi-bin/outweb02.pbl?reportno=9&updatety=20" +
                        "&admissno="+PatientLinks.admissno.value.replace(/ /g,"+") +
                        "&outbb002="+claimCodeVal+"&pmsvx141="+fundingSourceVal +
                        "&urnumber="+PatientLinks.urnumber.value.replace(/ /g,"+");
        var returnValue = RSExecute(serverURL);
      }
    }
  }
}
function setdeftovrd() {
 if(!isWhitespace(document.UpdateForm.alrevisn .value)) {
    document.UpdateForm.deftovrd.value="1";
 }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);
              showFundingSource(UpdateForm);
              DefAddedSlot();
              SendLetter03(UpdateForm);
              GetAppointmentKeyCookie();
              ValVisitType();
              getClosedReferral();
              DisabledFields();setdeftovrd();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="AppFrameExit();">
Make Follow Up Appointment - %OUTWEB02.03.618.1 - %OUTWEB02.03.002
</span>
<div id=PageBodySection style="overflow: auto;">
<form action=outweb02.pbl method=post name=UpdateForm id=UpdateForm>
<input type=hidden name=reportno id=reportno value="4">
<input type=hidden name=nextpage id=nextpage value="6">
<input type=hidden name=redirect id=redirect value="">
<input type=hidden name=updatety id=updatety value="4">
<input type=hidden name=urnumber id=urnumber value="%OUTWEB02.03.003">
<input type=hidden name=casekeys id=casekeys value="%OUTWEB02.03.366">
<input type=hidden name=defclnty id=defclnty value="%OUTWEB02.03.308">
<input type=hidden name=defclnid id=defclnid value="%OUTWEB02.03.303.0">
<input type=hidden name=defvisty id=defvisty value="%OUTWEB02.03.310.1">
<input type=hidden name=clinctyp id=clinctyp value="%OUTWEB02.03.605.1">
<input type=hidden name=dumdate id=dumdate value="">
<input type=hidden name=dumInput id=dumInput value="">
<input type=hidden name=clinindc id=clinindc value="%OUTWEB02.03.628">
<input type=hidden name=ptcnuebb id=ptcnuebb value="">
<input type=hidden name=obacompd id=obacompd value="%OUTWEB02.03.321.3">
<input type=hidden name=dateclin id=dateclin value="%OUTWEB02.03.304">
<input type=hidden name=refrwarn id=refrwarn value="%OUTWEB02.03.630">
<input type=hidden name=refrexpr id=refrexpr value="%OUTWEB02.03.631">
<input type=hidden name=refrdate id=refrdate value="%OUTWEB02.03.632">
<input type=hidden name=ibcnumci id=ibcnumci value="%STANDARD.01.025.000.132.0.1">
<input type=hidden name=otmaumci id=otmaumci value="%OUTWEB02.03.634">
<input type=hidden name=valddate id=valddate>
<input type=hidden name=datefrom id=datefrom>
<input type=hidden name=dateto id=dateto>
<input type=hidden name=follflag id=follflag value="1">
<input type=hidden name=othendps id=othendps value="%OUTWEB02.03.658">
<input type=hidden name=currdate id=currdate value="%STANDARD.01.015">
<input type=hidden name=d_outbb002 id=d_outbb002 value="%OUTWEB02.03.321.3">
<input type=hidden name=d_pmvxfsrc id=d_pmvxfsrc value="%OUTWEB02.03.899.009.1">
<input type=hidden name=otheclhr id=otheclhr value="%OUTWEB02.03.640.042">
<input type=hidden name=slotbtyp id=slotbtyp value="3">
<input type=hidden name=d_addslotk id=d_addslotk value="%OUTWEB02.03.674">
<input type=hidden name=d_addslotk_desc id=d_addslotk_desc
 value="%OUTWEB02.03.675.3">
<input type=hidden name=d_addslotk_date id=d_addslotk_date
 value="%OUTWEB02.03.675.2">
<input type=hidden name=d_addslotk_vtype_c id=d_addslotk_vtype_c
 value="%OUTWEB02.03.675.5.3">
<input type=hidden name=d_addslotk_othendps id=d_addslotk_othendps
 value="%OUTWEB02.03.675.6.035">
<input type=hidden name=d_addslotk_otheclhr id=d_addslotk_otheclhr
 value="%OUTWEB02.03.675.6.042">
<input type=hidden name=d_addslotk_othet2_c id=d_addslotk_othet2_c
 value="%OUTWEB02.03.675.6.047.1">
<input type=hidden name=d_addslotk_othenm_c id=d_addslotk_othenm_c
 value="%OUTWEB02.03.675.6.039.1">
<input type=hidden name=d_addslotk_othecc_c id=d_addslotk_othecc_c
 value="%OUTWEB02.03.675.6.040.1">
<input type=hidden name=d_addslotk_othesd_c id=d_addslotk_othesd_c
 value="%OUTWEB02.03.675.6.041.1">
<input type=hidden name=alrevisn id=alrevisn value="%OUTWEB02.03.646">
<input type=hidden name=deftovrd id=deftovrd value="">
<input type=hidden name=clapindc id=clapindc>
<input type=hidden name=d_followdt id=d_followdt value="%OUTWEB02.03.304">

<table cellspacing=0 cellpadding=1 border=0 width=98% align=center>
<tr><td class=DataLabel width=15%>Clinic</td>
    <td class=DataField width=35%>
    <input type=hidden  name=newslotk id=newslotk value="%OUTWEB02.03.366">
    <input type=text size=30 readonly name=clindesc id=clindesc title="Clinic" 
    class=Mandatory value="%OUTWEB02.03.327.011.1">
    <img src="../images/SearchIcon.gif" class=Icon 
     onclick="ResetLetter(UpdateForm);AppointSearch();">
    <img src="../images/LookupIcon.gif" class=Icon
     onclick="ResetLetter(UpdateForm);ClinicSearch();"></td>
    <td class=DataLabel width=15%>Date</td>
    <td class=DataField width=35%>
    <input type=text size=35  readonly name=clindate id=clindate title="date"
    class=Mandatory></td></tr>

<tr><td class=DataLabel>Visit Type</td>
    <td class=DataField >
    <select name=outbb047 id=outbb047 title="Visit Type" class="SelectBig Mandatory"
     onchange="SendLetter03(UpdateForm);ValVisitType();"> 
    <option></option>
    %OUTWEB02.03.329
    </select></td>
    <td class=DataLabel>Claim Type</td>
    <td class=DataField><input type=text size=30 readonly
     name=clmtdesc id=clmtdesc tabindex=-1
     title="Claim Type" class=Readonly value="%OUTWEB02.03.321.0">
    </td>
    </tr>

<tr><td class=DataLabel>NMDS Code</td>
    <td class=DataField><select name=outbb068 id=outbb068 class=SelectBig>
        <option></option>
        %OUTWEB02.03.327.004.2
        </select>
    </td>
    <td><div id=FundingHeading></div></td>
    <td><div id=FundingId></div></td>
    </tr>

<tr><td class=DataLabel>Tier 2 Code</td>
    <td class=DataField><select name=outbb072 id=outbb072 
        class="SelectBig" title="Tier 2 Code">
        <option></option>
        %OUTWEB02.03.327.012.2
        </select>
    </td>
    <td class=DataLabel>Referring GP</td>
    <td class=DataField>
    <input type=hidden name=outbb029 id=outbb029 value='%OUTWEB02.03.390'>
    <input type=text readonly name=genpname id=genpname class=Readonly tabindex=-1>
    </td>
    </tr>

<tr><td class=DataLabel>Care Type</td>
    <td class=DataField><select name=outbb069 id=outbb069 class=SelectBig>
        <option></option>
        %OUTWEB02.03.327.005.2
        </select>
    </td>
    <td class=DataLabel>Transport</td>
    <td><select name=outbb023 id=outbb023 class=SelectBig>
        <option value="   ">NO</option>
        %OUTWEB02.03.342.2
        </select>&nbsp;%OUTWEB02.03.659.1</td>
    </tr>

<tr><td class=DataLabel>Service Delivery Mode</td>
    <td class=DataField><select name=outbb070 id=outbb070 class=SelectBig 
     onchange="DisplayWarning();">
        <option></option>
        %OUTWEB02.03.327.006.2
        </select>
        </td>
    <td class=DataLabel>Clinical High Risk</td>
    <td><input type=checkbox value=1 name=outbb071 id=outbb071></td>
    </tr>

<tr valign=top>
    <td class=DataLabel>Presenting Complaint</td>
    <td class=DataField >
    <input type=text name=pmsvx052 id=pmsvx052 size=50 maxlength=50                        
    value="%OUTWEB02.03.852"></td>
    <td class=DataLabel>Consent MyHR upload?</td>
    <td><select name=outbb017 id=outbb017 tabindex=10 title="Consent MyHR Upload" class=DataField>
         <option></option>
         %OUTWEB02.03.336.2
         </select>&nbsp;(<a href="javascript:patientMyhrConsentForm();">form</a>)
    </td>
   </tr>

<tr valign=top>
    <td class=DataLabel>Diagnosis</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb045 id=outbb045 value="%OUTWEB02.03.364"
     onblur="validateCode(6,UpdateForm.outbb045,UpdateForm.outbb046);">
    <input type=text name=outbb046 id=outbb046 size=70 maxlength=50 tabindex=-1
    readonly  class=Readonly value="%OUTWEB02.03.365">
    <img src="../images/SearchIcon.gif" class=Icon
    onclick="Icd10DisSearchFrame(UpdateForm.outbb045,UpdateForm.outbb046);">
    <img src="../images/LookupIcon.gif" class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb045,UpdateForm.outbb046);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb055 id=outbb055 value="%OUTWEB02.03.379"
    onblur="validateCode(6,UpdateForm.outbb055,UpdateForm.outbb056);">
    <input type=text name=outbb056 id=outbb056 size=70 maxlength=50 tabindex=-1
    readonly  class=Readonly value="%OUTWEB02.03.380">
    <img src="../images/SearchIcon.gif" class=Icon
    onclick="Icd10DisSearchFrame(UpdateForm.outbb055,UpdateForm.outbb056);">
    <img src="../images/LookupIcon.gif" class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb055,UpdateForm.outbb056);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb057 id=outbb057 value="%OUTWEB02.03.381"
     onblur="validateCode(6,UpdateForm.outbb057,UpdateForm.outbb058);">
    <input type=text size=70 maxlength=50 name=outbb058 id=outbb058 tabindex=-1 
    readonly class=Readonly value="%OUTWEB02.03.382">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.outbb057,UpdateForm.outbb058);">
    <img src="../images/LookupIcon.gif" class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb057,UpdateForm.outbb058);">
    </td></tr>

<tr><td>&nbsp;</td><td class=DataField colspan=3>
    <input type=text size=15 name=outbb059 id=outbb059 value="%OUTWEB02.03.383"
     onblur="validateCode(6,UpdateForm.outbb059,UpdateForm.outbb060);">
    <input type=text size=70 maxlength=50 name=outbb060 id=outbb060 tabindex=-1
    readonly  class=Readonly value="%OUTWEB02.03.384">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.outbb059,UpdateForm.outbb060);">
    <img src="../images/LookupIcon.gif" class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb059,UpdateForm.outbb060);">
    </td></tr>

<tr>
    <td class=DataLabel>
      Has this patient been in a Motor Vehicle Accident?
    </td>
    <td>
      <select class="Mandatory" name=opwamvny tabindex=1
       title="Has this patient been in a Motor Vehicle Accident?">
        %OUTWEB02.03.699.012.099.050
      </select>
    </td>
  </tr>

<tr><td class=DataLabel>Patient Follow Up Letter</td>
    <td><input type=checkbox value=1 name=letprt01 id=letprt01
         onclick="PrinterMandatory(this,UpdateForm.letpsl01)"></td>
    <td>Printer</td>
   <td><select class="SelectBig" name=letpsl01 id=letpsl01 title="Printer">
	<option></option>
        %STANDARD.01.001.LETTROUT.01
	</select></td></tr>

<tr><td class=DataLabel>Send Letter</td>
    <td><select name=outbb067 id=outbb067 title="Send Letter"
         onchange="SendLetterDate03(UpdateForm);CheckLetterDate03(UpdateForm);">
        <option></option>
        <option value="0">No</option>
        <option value="1">Yes</option>
        <option value="2">N/A</option>
        </select>
    </td>
    <td class=DataLabel>Generate Letter date</td>
    <td><input type=text name=outbb066 id=outbb066 size=12
     onblur="checkDate(this,'Date');CheckLetterDate03(UpdateForm);" value=""
     class="Date" title="Generate Letter Date">
    <img src="../images/DateTimeStamp.gif" class=Icon date=UpdateForm.outbb066
     time=null>
    <img src="../images/DateLookup.gif" class=Icon date=UpdateForm.outbb066>
</td>
</tr>

<tr><td>Interpreter Required</td>
    <td><input type="hidden" name="pmsvx093" id="pmsvx093" value="">
        <input type="checkbox" name="d_pmsvx093" id="d_pmsvx093" value="1">
    &nbsp;
    <span class="Red">%OUTWEB02.03.086.002.0</span>
    </td>
    <td></td>
    <td></td>
    </tr>

<tr valign=top><td class=DataLabel>Appointment Comments</td>
    <td class=DataField colspan=3>
    <textarea name=outptcom id=outptcom wrap=hard 
    cols=70 rows=4></textarea></td></tr>

<tr valign=top><td class=DataLabel>Patient Instructions (Printable)</td>
    <td class=DataField colspan=3>
    <textarea name=patinstr id=patinstr wrap=hard onkeydown="LimitText(this,99,200);"
    cols=60 rows=4></textarea></td></tr>

</table>

<div id=ShowLinkRef></div>
<div id=ShowXCmbs></div>

<table border=0 width=98% cellspacing=0 cellpadding=1 align=center>
<tr><td colspan=4 align=center>
   <input type=button class="button" value="Ok" id="out02sub"
    onclick="tempDisable(this);
             checkSlot(UpdateForm.newslotk.value,
             UpdateForm.urnumber.value,checkRedirect);">
    <input type=button class="button" Value="Cancel"
     onclick="AppFrameExit();">
</table>
</form>
</div>

<span id=extracmbs style="display:none">
<table border=0 width=98% cellspacing=0 cellpadding=1 align=center>

<tr><td width=15% class=DataLabel>CMBS Code</td>
    <td class=DataField>
    <input type=hidden name=otbit001 id=otbit001 title="Item Type"
     value="%OUTWEB02.03.624. 1.0">
    <input type=text size=9 name=otbit002 id=otbit002 title="Item Code"
     value="%OUTWEB02.03.625. 1"
     onchange="validatePMBS(otbit002,mbsdesc1,otbit001,otbit003,dateclin,mbsamnt1);">
    <input type=text size=3 name=otbit003 id=otbit003 title="Sub-Item Code"
     value="%OUTWEB02.03.626. 1"
     onchange="validatePMBS(otbit002,mbsdesc1,otbit001,otbit003,dateclin,mbsamnt1);">
    <input type=text size=30 name=mbsdesc1 id=mbsdesc1 value="%OUTWEB02.03.627. 1.0"
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt1 id=mbsamnt1 value="%OUTWEB02.03.627. 1.1"
     readonly class=Readonly tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="PriMbsSearchFrame(otbit001,otbit002,otbit003,dumdate,mbsdesc1,dumInput,TypeDesc1);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(otbit002,otbit003,mbsdesc1,mbsamnt1,otbit016);">
    <input type=text maxlength=20 size=22 name=otbit016 id=otbit016 title="Provider Usage" 
     tabindex=91 value="%OUTWEB02.03.635. 1">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit004 id=otbit004 title="Item Type 2"
     value="%OUTWEB02.03.624. 2.0">
    <input type=text size=9 name=otbit005 id=otbit005 title="Item Code 2"
     value="%OUTWEB02.03.625. 2"
     onchange="validatePMBS(otbit005,mbsdesc2,otbit004,otbit006,dateclin,mbsamnt2);">
    <input type=text size=3 name=otbit006 id=otbit006 title="Sub-Item Code 2"
     value="%OUTWEB02.03.626. 2"
     onchange="validatePMBS(otbit005,mbsdesc2,otbit004,otbit006,dateclin,mbsamnt2);">
    <input type=text size=30 name=mbsdesc2 id=mbsdesc2 value="%OUTWEB02.03.627. 2.0"
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt2 id=mbsamnt2 value="%OUTWEB02.03.627. 2.1"
     readonly class=Readonly tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
    onclick="PriMbsSearchFrame(otbit004,otbit005,otbit006,dumdate,mbsdesc2,dumInput,TypeDesc2);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(otbit005,otbit006,mbsdesc2,mbsamnt2,otbit017);">
    <input type=text maxlength=20 size=22 name=otbit017 id=otbit017 title="Provider Usage 2"
     tabindex=92 value="%OUTWEB02.03.635. 2">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit007 id=otbit007 title="Item Type 3"
     value="%OUTWEB02.03.624. 3.0">
    <input type=text size=9 name=otbit008 id=otbit008 title="Item Code 3"
     value="%OUTWEB02.03.625. 3"
     onchange="validatePMBS(otbit008,mbsdesc3,otbit007,otbit009,dateclin,mbsamnt3);" >
    <input type=text size=3 name=otbit009 id=otbit009 title="Sub-Item Code 3"
     value="%OUTWEB02.03.626. 3"
     onchange="validatePMBS(otbit008,mbsdesc3,otbit007,otbit009,dateclin,mbsamnt3);" >
    <input type=text size=30 name=mbsdesc3 id=mbsdesc3 value="%OUTWEB02.03.627. 3.0"
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt3 id=mbsamnt3 value="%OUTWEB02.03.627. 3.1"
     readonly class=Readonly tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
    onclick="PriMbsSearchFrame(otbit007,otbit008,otbit009,dumdate,mbsdesc3,dumInput,TypeDesc3);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(otbit008,otbit009,mbsdesc3,mbsamnt3,otbit018);">
    <input type=text maxlength=20 size=22 name=otbit018 id=otbit018 title="Provider Usage 3"
     tabindex=93 value="%OUTWEB02.03.635. 3">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit010 id=otbit010 title="Item Type 4"
     value="%OUTWEB02.03.624. 4.0">
    <input type=text size=9 name=otbit011 id=otbit011 title="Item Code 4"
     value="%OUTWEB02.03.625. 4"
     onchange="validatePMBS(otbit011,mbsdesc4,otbit010,otbit012,dateclin,mbsamnt4);" >
    <input type=text size=3 name=otbit012 id=otbit012 title="Sub-Item Code 4"
     value="%OUTWEB02.03.626. 4"
     onchange="validatePMBS(otbit011,mbsdesc4,otbit010,otbit012,dateclin,mbsamnt4);" >
    <input type=text size=30 name=mbsdesc4 id=mbsdesc4 value="%OUTWEB02.03.627. 4.0"
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt4 id=mbsamnt4 value="%OUTWEB02.03.627. 4.1"
     readonly class=Readonly tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
    onclick="PriMbsSearchFrame(otbit010,otbit011,otbit012,dumdate,mbsdesc4,dumInput,TypeDesc4);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(otbit011,otbit012,mbsdesc4,mbsamnt4,otbit019);">
    <input type=text maxlength=20 size=22 name=otbit019 id=otbit019 title="Provider Usage 4"
     tabindex=94 value="%OUTWEB02.03.635. 4">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit013 id=otbit013 title="Item Type 5"
     value="%OUTWEB02.03.624. 5.0">
    <input type=text size=9 name=otbit014 id=otbit014 title="Item Code 5"
     value="%OUTWEB02.03.625. 5"
     onchange="validatePMBS(otbit014,mbsdesc5,otbit013,otbit015,dateclin,mbsamnt5);" >
    <input type=text size=3 name=otbit015 id=otbit015 title="Sub-Item Code 5"
     value="%OUTWEB02.03.626. 5"
     onchange="validatePMBS(otbit014,mbsdesc5,otbit013,otbit015,dateclin,mbsamnt5);" >
    <input type=text size=30 name=mbsdesc5 id=mbsdesc5 value="%OUTWEB02.03.627. 5.0"
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt5 id=mbsamnt5 value="%OUTWEB02.03.627. 5.1"
     readonly class=Readonly tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
    onclick="PriMbsSearchFrame(otbit013,otbit014,otbit015,dumdate,mbsdesc5,dumInput,TypeDesc5);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(otbit014,otbit015,mbsdesc5,mbsamnt5,otbit020);">
    <input type=text maxlength=20 size=22 name=otbit020 id=otbit020 title="Provider Usage 5"
     tabindex=95 value="%OUTWEB02.03.635. 5">
    </td>
    </tr>

<tr><td>Use CMBS Template</td>
    <td><input type=checkbox value=1 name=cmbsload id=cmbsload onclick="TemplateCmbs();">
    &nbsp;
    <select class="SelectBig" name=cmbstemp id=cmbstemp title="CMBS Template"
         onchange="TemplateCmbs();">
          <option></option>
          %OUTWEB02.03.629
          </select></td>
    </tr>

<tr><td>Print Medicare Claims</td>
    <td><input type=checkbox value=1 name=claimprt id=claimprt>
    &nbsp;
    <select class="SelectBig" name=claimpsl id=claimpsl title="Printer">
          <option></option>
          %STANDARD.01.001.OUTCLAIM.03
          </select></td>
    </tr>
</table>
</span>

<span id=linkreferral style="display:none">
<table border=0 width=98% cellspacing=0 cellpadding=1 align=center>
<tr><td class=DataLabel width=15%>Link Referral Details</td>
    <td><input type=checkbox checked value=1 name=linkrefr id=linkrefr
         title="Link referral details"></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    </tr>
</table>
</span>

<span id=fundinghd style="display:none">
Funding Source
</span>

<span id=fundingid style="display:none">
<input type=text size=30 readonly name=funddesc id=funddesc
 title="Claim Type" class=Readonly value="%OUTWEB02.03.899.009.0">
</span>

<form name=PatientLinks id=PatientLinks method=get>
<input type=hidden name=reportno id=reportno value=1>
<input type=hidden name=template id=template value=004>
<input type=hidden name=nextpage id=nextpage value="1">
<input type=hidden name=urnumber id=urnumber value="%OUTWEB02.03.003">
<input type=hidden name=admissno id=admissno value="%OUTWEB02.03.081">
<input type=hidden name=MenuType id=MenuType value="%OUTWEB02.03.088">
<input type=hidden name=casekeys id=casekeys value="%OUTWEB02.03.366">
</form>  

<script type="text/javascript">
for (var i=0;i<document.UpdateForm.outbb047.length;i++){
if (document.UpdateForm.outbb047.options[i].value==UpdateForm.defvisty.value){
    document.UpdateForm.outbb047.selectedIndex=i}};
DisplayXCmbs();
DisplayReferral();
 var title = "%OUTWEB02.03.348.003"
 var gname  = "%OUTWEB02.03.348.004"
 var surname = "%OUTWEB02.03.348.005"

 UpdateForm.genpname.value = trim(title)+" "+trim(gname)+" "+trim(surname);
 if ("%OUTWEB02.03.327.007.1" == "1") {
    UpdateForm.outbb071.checked = 1
    UpdateForm.outbb071.value = 1
    if(document.UpdateForm.otheclhr.value=="1") {
      document.UpdateForm.outbb071.disabled=true;
    }
 }
 PMIInterpreter="%OUTWEB02.03.086.001.0";
 VisitInterpreter="%OUTWEB02.03.893.0";
 if (PMIInterpreter != "1") {
    UpdateForm.d_pmsvx093.disabled=true;
 } else {
   if (VisitInterpreter == "1") {
      UpdateForm.d_pmsvx093.checked = true;
   }
 }

function ValVisitType() {
  if (UpdateForm.outbb047.value.substr(10,1) == "C") {
    // Visit Type is 'Chart Only'; disable 'Interpreter Required' checkbox
    UpdateForm.d_pmsvx093.checked=false;
    UpdateForm.d_pmsvx093.disabled=true;
  }
  else {
    UpdateForm.d_pmsvx093.disabled=false;
    PMIInterpreter="%OUTWEB02.03.086.001.0";
    if (PMIInterpreter != "1") {
      UpdateForm.d_pmsvx093.disabled=true;
    }
  }
}

MVAccident="%OUTWEB02.03.749";
for (var i=0; i<document.UpdateForm.opwamvny.length; i++) {
  if (document.UpdateForm.opwamvny.options[i].value == MVAccident) {
    document.UpdateForm.opwamvny.selectedIndex=i;
  }
}
</script>
