<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome"    content="wahealth">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/emrweb0201004.js"></script>
<script type="text/javascript">
function RemoteTreatingNurDateTime() {
  var serverURL = "../cgi-bin/emrweb08.pbl?reportno=38" +
           "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+") +
           "&doctcode=" + document.UpdateForm.emvis130.value.replace(/ /g,"+") +
           "&doctdate=" + document.UpdateForm.emvitndd.value.replace(/ /g,"+") +
           "&docttime=" + document.UpdateForm.emvitndt.value.replace(/ /g,"+");

  if (IEBrowser) {
    var returnValue = RSExecute(serverURL);
  }
  else {
    var returnValue = RSExecuteFetch(serverURL);
  }
}
function RemoteTreatingDocDateTime() {
  var serverURL = "../cgi-bin/emrweb08.pbl?reportno=37" +
           "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+") +
           "&doctcode=" + document.UpdateForm.emvis007.value.replace(/ /g,"+") +
           "&doctdate=" + document.UpdateForm.emvitrdd.value.replace(/ /g,"+") +
           "&docttime=" + document.UpdateForm.emvitrdt.value.replace(/ /g,"+");

  if (IEBrowser) {
    var returnValue = RSExecute(serverURL);
  }
  else {
    var returnValue = RSExecuteFetch(serverURL);
  }
}
function RemoteEmrAudit() {
  var serverURL = "../cgi-bin/emrweb08.pbl?reportno=36" +
           "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+") +
           "&reasonfc=+++" +
           "&doctcode=" + document.UpdateForm.emvis110.value.replace(/ /g,"+") +
           "&doctdate=" + document.UpdateForm.emvis075.value.replace(/ /g,"+") +
           "&docttime=" + document.UpdateForm.emvis085.value.replace(/ /g,"+") +
           "&webuseid=" + document.UpdateForm.webuseid.value.replace(/ /g,"+");

  if (IEBrowser) {
    var returnValue = RSExecute(serverURL);
  }
  else {
    var returnValue = RSExecuteFetch(serverURL);
  }
}
function ReturnToMap() {
  if (parent.TogglePanel==null) {
    top.location.reload();
  }
  else {
    parent.TogglePanel()
  }
}
function UpdDoctor() {
  if (UpdateForm.emcndoct.value==1) {
    UpdEmrDoc(UpdateForm.emvis007);
  }
  else {
    UpdDoc(UpdateForm.emvis007);
  }
}
function SearchDoctor() {
  if (UpdateForm.emcndoct.value==1) {
    DoctorEmrSearchFrame(UpdateForm.emvis007,UpdateForm.dummy3);
  }
  else {
    DoctorSearchFrame(UpdateForm.emvis007,UpdateForm.dummy3);
  }
}

function PageLoadExtended()
{
   PageLoad();
   setFocus("btnUpdate");
   SetDischarged();
   if (GetCookieData("TriageLabelsFormsCookie")!="unknown") {
     ExpireCookiePath("TriageLabelsFormsCookie");
     var linkurl = "../cgi-bin/emrweb02.pbl?reportno=1&template=005" +
                   "&admissno=" + UpdateForm.admissno.value.replace(/ /g,"+")+
                   "&urnumber=" + UpdateForm.urnumber.value.replace(/ /g,"+")
     Left=(document.body.clientWidth-640)/2
     DFrameLink(linkurl,100,Left,640,250);
   }
   if (document.UpdateForm.patlocot.value=="1") {
     InitialAssessorFieldDIV.innerHTML=InitialAssessorFieldSPAN.innerHTML;
     SeniorDoctorTitleDIV.innerHTML="";
     SeniorDoctorFieldDIV.innerHTML=SeniorDoctorFieldSPAN.innerHTML;
   }
}

function setFocus(id)
{
  var  object = document.getElementById(id);

  if(object)
     object.focus();

}
function Assessor() {
  if(isWhitespace(document.UpdateForm.emvis110.value)) {
     if(!isWhitespace(document.UpdateForm.emvis110.defaultValue)&&
        !isWhitespace(document.UpdateForm.emvis075.value))  {
        alert("Invalid Initial Assessor deletion - Please use the eraser icon");
        document.UpdateForm.emvis110.value=
        document.UpdateForm.emvis110.defaultValue;
        document.UpdateForm.emvis110.focus();
        return;
     }
  }
  if(!isWhitespace(UpdateForm.emvis110.value)) {
    UpCase(UpdateForm.emvis110);
    if(!validateCode(31,UpdateForm.emvis110,UpdateForm.n_emvis110)) {
      return;
    }
  }
  if (isWhitespace(UpdateForm.emvis110.defaultValue) &&
      !isWhitespace(UpdateForm.emvis110.value) &&
      isWhitespace(UpdateForm.emvis075.value) &&
      isWhitespace(UpdateForm.emvis085.value)) {
    SetCurrentDateTime(document.UpdateForm.emvis075,
                       document.UpdateForm.emvis085);
  }
  if(document.UpdateForm.emvis110.value !=
     document.UpdateForm.emvis110.defaultValue) {
    RemoteEmrHistory(UpdateForm.admissno,"INTAS");
    RemoteEmrAudit();
    document.UpdateForm.emvis110.defaultValue=
    document.UpdateForm.emvis110.value;
  }
  RemoteEmrUpdate(UpdateForm.admissno,UpdateForm.emvis110);
  ArrivalTimeButtons();
}
function AssessorDate() {
  if(!checkDate(UpdateForm.emvis075,UpdateForm.emvis075.title)) {
   return;
  }
 if(!isWhitespace(UpdateForm.emvis110.value)) {
    if(isWhitespace(UpdateForm.emvis075.value)) {
      alert(UpdateForm.emvis075.title + " is a required field.\n" +
           "Please enter it now." )
      UpdateForm.emvis075.value=UpdateForm.emvis075.defaultValue;
      UpdateForm.emvis075.focus();
      return;
    }
  }

if (!isWhitespace(document.UpdateForm.emhsarrd.value) &&
      !isWhitespace(document.UpdateForm.emvis075.value)) {
    if(SetDateYYYYMMDD(document.UpdateForm.emhsarrd.value) >
       SetDateYYYYMMDD(document.UpdateForm.emvis075.value)) {
      alert("Initial Assessor Date cannot be before Arrival Date.");
      document.UpdateForm.emvis075.value="";
      return;
    } else {
      if (SetDateYYYYMMDD(document.UpdateForm.emhsarrd.value) ==
          SetDateYYYYMMDD(document.UpdateForm.emvis075.value) &&
          !isWhitespace(document.UpdateForm.emhsarrt.value) &&
          !isWhitespace(document.UpdateForm.emvis085.value) &&
          document.UpdateForm.emhsarrt.value >
          document.UpdateForm.emvis085.value) {
        alert("Initial Assessor Time cannot be before Arrival Time.");
        document.UpdateForm.emvis085.value="";
        return;
      }
    }
  }
  if(document.UpdateForm.emvis075.value !=
     document.UpdateForm.emvis075.defaultValue) {
    RemoteEmrHistory(UpdateForm.admissno,"INTAS");
    RemoteEmrAudit();
    document.UpdateForm.emvis075.defaultValue=
    document.UpdateForm.emvis075.value
  }
  RemoteEmrUpdate(UpdateForm.admissno,UpdateForm.emvis075);
}
function AssessorTime() {
  if(!checkTime(UpdateForm.emvis085,UpdateForm.emvis085.title)) {
   return;
  }
 if(!isWhitespace(UpdateForm.emvis110.value)) {
    if(isWhitespace(UpdateForm.emvis085.value)) {
      alert(UpdateForm.emvis085.title + " is a required field.\n" +
           "Please enter it now." )
      UpdateForm.emvis085.value=UpdateForm.emvis085.defaultValue;
      UpdateForm.emvis085.focus();
      return;
    }
  }
  if (!isWhitespace(document.UpdateForm.emhsarrd.value) &&
      !isWhitespace(document.UpdateForm.emhsarrt.value) &&
      !isWhitespace(document.UpdateForm.emvis075.value) &&
      !isWhitespace(document.UpdateForm.emvis085.value)) {
    if(SetDateYYYYMMDD(document.UpdateForm.emhsarrd.value) >
       SetDateYYYYMMDD(document.UpdateForm.emvis075.value)) {
      alert("Initial Assessor Date cannot be before Arrival Date.");
      document.UpdateForm.emvis075.value="";
      return;
    } else {
      if (SetDateYYYYMMDD(document.UpdateForm.emhsarrd.value) ==
          SetDateYYYYMMDD(document.UpdateForm.emvis075.value) &&
          !isWhitespace(document.UpdateForm.emhsarrt.value) &&
          !isWhitespace(document.UpdateForm.emvis085.value) &&
          document.UpdateForm.emhsarrt.value >
          document.UpdateForm.emvis085.value) {
        alert("Initial Assessor Time cannot be before Arrival Time.");
        document.UpdateForm.emvis085.value="";
        return;
      }
    }
  }
  SetCurrentDateTimeNoFocus(document.UpdateForm.curdtvar,
                     document.UpdateForm.curtmvar);
  if (!isWhitespace(document.UpdateForm.emvis075.value) &&
      !isWhitespace(document.UpdateForm.emvis085.value)) {
    if (SetDateYYYYMMDD(document.UpdateForm.curdtvar.value) ==
        SetDateYYYYMMDD(document.UpdateForm.emvis075.value) &&
        document.UpdateForm.emvis085.value >
        document.UpdateForm.curtmvar.value) {
      alert("Initial Assessor cannot have a future time.");
      document.UpdateForm.emvis085.value="";
      return;
    }
  }
  if(document.UpdateForm.emvis085.value !=
     document.UpdateForm.emvis085.defaultValue) {
    RemoteEmrHistory(UpdateForm.admissno,"INTAS");
    RemoteEmrAudit();
    document.UpdateForm.emvis085.defaultValue=
    document.UpdateForm.emvis085.value
  }
  RemoteEmrUpdate(UpdateForm.admissno,UpdateForm.emvis085);
}
function SeniorDoctor() {
  if(isWhitespace(document.UpdateForm.emvis109.value)) {
     if(!isWhitespace(document.UpdateForm.emvis109.defaultValue)&&
        !isWhitespace(document.UpdateForm.emvis079.value))  {
        alert("Invalid Senior Doctor deletion - Please use the eraser icon");
        document.UpdateForm.emvis109.value=
        document.UpdateForm.emvis109.defaultValue;
        document.UpdateForm.emvis109.focus();
        return;
     }
  }
  if(!isWhitespace(UpdateForm.emvis109.value)) {
    UpCase(UpdateForm.emvis109);
    if(!validateCode(31,UpdateForm.emvis109,UpdateForm.n_emvis109)) {
      return;
    }
  }
  if (isWhitespace(UpdateForm.emvis109.defaultValue) &&
      !isWhitespace(UpdateForm.emvis109.value) &&
      isWhitespace(UpdateForm.emvis079.value) &&
      isWhitespace(UpdateForm.emvis089.value)) {
    SetCurrentDateTime(document.UpdateForm.emvis079,
                       document.UpdateForm.emvis089);
  }
  RemoteEmrUpdate(UpdateForm.admissno,UpdateForm.emvis109);
}
function SeniorDoctorDate() {
  if(!checkDate(UpdateForm.emvis079,UpdateForm.emvis079.title)) {
   return;
  }
 if(!isWhitespace(UpdateForm.emvis109.value) &&
    !isWhitespace(UpdateForm.emvis089.value)) {
    if(isWhitespace(UpdateForm.emvis079.value)) {
      alert(UpdateForm.emvis079.title + " is a required field.\n" +
           "Please enter it now." )
      UpdateForm.emvis079.value=UpdateForm.emvis079.defaultValue;
      UpdateForm.emvis079.focus();
      return;
    }
  }
if (!isWhitespace(document.UpdateForm.emhsarrd.value) &&
      !isWhitespace(document.UpdateForm.emvis079.value)) {
    if(SetDateYYYYMMDD(document.UpdateForm.emhsarrd.value) >
       SetDateYYYYMMDD(document.UpdateForm.emvis079.value)) {
      alert("Senior Doctor Date cannot be before Arrival Date.");
      document.UpdateForm.emvis079.value="";
      return;
    } else {
      if (SetDateYYYYMMDD(document.UpdateForm.emhsarrd.value) ==
          SetDateYYYYMMDD(document.UpdateForm.emvis079.value) &&
          !isWhitespace(document.UpdateForm.emhsarrt.value) &&
          !isWhitespace(document.UpdateForm.emvis089.value) &&
          document.UpdateForm.emhsarrt.value >
          document.UpdateForm.emvis089.value) {
        alert("Senior Doctor Time cannot be before Arrival Time.");
        document.UpdateForm.emvis089.value="";
        return;
      }
    }
  }
  RemoteEmrUpdate(UpdateForm.admissno,UpdateForm.emvis079);
}
function SeniorDoctorTime() {
  if(!checkTime(UpdateForm.emvis089,UpdateForm.emvis089.title)) {
   return;
  }
 if(!isWhitespace(UpdateForm.emvis109.value) &&
    !isWhitespace(UpdateForm.emvis079.value)) {
    if(isWhitespace(UpdateForm.emvis089.value)) {
      alert(UpdateForm.emvis089.title + " is a required field.\n" +
           "Please enter it now." )
      UpdateForm.emvis089.value=UpdateForm.emvis089.defaultValue;
      UpdateForm.emvis089.focus();
      return;
    }
  }
  if (!isWhitespace(document.UpdateForm.emhsarrd.value) &&
      !isWhitespace(document.UpdateForm.emhsarrt.value) &&
      !isWhitespace(document.UpdateForm.emvis079.value) &&
      !isWhitespace(document.UpdateForm.emvis089.value)) {
    if(SetDateYYYYMMDD(document.UpdateForm.emhsarrd.value) >
       SetDateYYYYMMDD(document.UpdateForm.emvis079.value)) {
      alert("Initial Assessor Date cannot be before Arrival Date.");
      document.UpdateForm.emvis079.value="";
      return;
    } else {
      if (SetDateYYYYMMDD(document.UpdateForm.emhsarrd.value) ==
          SetDateYYYYMMDD(document.UpdateForm.emvis079.value) &&
          !isWhitespace(document.UpdateForm.emhsarrt.value) &&
          !isWhitespace(document.UpdateForm.emvis089.value) &&
          document.UpdateForm.emhsarrt.value >
          document.UpdateForm.emvis089.value) {
        alert("Initial Assessor Time cannot be before Arrival Time.");
        document.UpdateForm.emvis089.value="";
        return;
      }
    }
  }
  SetCurrentDateTimeNoFocus(document.UpdateForm.curdtvar,
                     document.UpdateForm.curtmvar);
  if (!isWhitespace(document.UpdateForm.emvis079.value) &&
      !isWhitespace(document.UpdateForm.emvis089.value)) {
    if (SetDateYYYYMMDD(document.UpdateForm.curdtvar.value) ==
        SetDateYYYYMMDD(document.UpdateForm.emvis079.value) &&
        document.UpdateForm.emvis089.value >
        document.UpdateForm.curtmvar.value) {
      alert("Senior Doctor cannot have a future time.");
      document.UpdateForm.emvis089.value="";
      return;
    }
  }
  RemoteEmrUpdate(UpdateForm.admissno,UpdateForm.emvis089);
}
function readOnlyTreatingDocDateTime() {
  if (isWhitespace(document.UpdateForm.emvis007.value)) {
    document.UpdateForm.emvitrdd.className="readonly";
    document.UpdateForm.emvitrdd.readOnly=true;
    document.UpdateForm.emvitrdd.disabled=true;
    document.UpdateForm.emvitrdt.className="readonly";
    document.UpdateForm.emvitrdt.readOnly=true;
    document.UpdateForm.emvitrdt.disabled=true;
  }
}
function readOnlyTreatingNurDateTime() {
  if (isWhitespace(document.UpdateForm.emvis130.value)) {
    document.UpdateForm.emvitndd.className="readonly";
    document.UpdateForm.emvitndd.readOnly=true;
    document.UpdateForm.emvitndd.disabled=true;
    document.UpdateForm.emvitndt.className="readonly";
    document.UpdateForm.emvitndt.readOnly=true;
    document.UpdateForm.emvitndt.disabled=true;
  }
}
function TreatingDoctorDate() {
  if(!checkDate(UpdateForm.emvitrdd,UpdateForm.emvitrdd.title)) {
   return;
  }
  if(!isWhitespace(UpdateForm.emvis007.value)) {
    if(isWhitespace(UpdateForm.emvitrdd.value)) {
      alert(UpdateForm.emvitrdd.title + " is a required field.\n" +
           "Please enter it now." )
      UpdateForm.emvitrdd.value=UpdateForm.emvitrdd.defaultValue;
      UpdateForm.emvitrdd.focus();
      return;
    }
  }
  if (!isWhitespace(document.UpdateForm.emhsarrd.value) &&
      !isWhitespace(document.UpdateForm.emvitrdd.value)) {
    if(SetDateYYYYMMDD(document.UpdateForm.emhsarrd.value) >
       SetDateYYYYMMDD(document.UpdateForm.emvitrdd.value)) {
      alert("Treating Doctor Date cannot be before Arrival Date.");
      document.UpdateForm.emvitrdd.value="";
      return;
    } else {
      if (SetDateYYYYMMDD(document.UpdateForm.emhsarrd.value) ==
          SetDateYYYYMMDD(document.UpdateForm.emvitrdd.value) &&
          !isWhitespace(document.UpdateForm.emhsarrt.value) &&
          !isWhitespace(document.UpdateForm.emvitrdt.value) &&
          document.UpdateForm.emhsarrt.value >
          document.UpdateForm.emvitrdt.value) {
        alert("Treating Doctor Time cannot be before Arrival Time.");
        document.UpdateForm.emvitrdt.value="";
        return;
      }
    }
  }
  if (!isWhitespace(document.UpdateForm.emviprdd.value) &&
    !isWhitespace(document.UpdateForm.emvitrdd.value)) {
    if(SetDateYYYYMMDD(document.UpdateForm.emviprdd.value) >
       SetDateYYYYMMDD(document.UpdateForm.emvitrdd.value)) {
      alert("Treating Doctor Date cannot be before Previous Doctor Handover Date.");
      document.UpdateForm.emvitrdd.value="";
      return;
    } else {
      if (SetDateYYYYMMDD(document.UpdateForm.emviprdd.value) ==
          SetDateYYYYMMDD(document.UpdateForm.emvitrdd.value) &&
          !isWhitespace(document.UpdateForm.emviprdt.value) &&
          !isWhitespace(document.UpdateForm.emvitrdt.value) &&
          document.UpdateForm.emviprdt.value >
          document.UpdateForm.emvitrdt.value) {
        alert("Treating Doctor Time cannot be before Previous Doctor Handover  Time.");
        document.UpdateForm.emvitrdt.value="";
        return;
      }
    }
  }
  if(document.UpdateForm.emvitrdd.value !=
     document.UpdateForm.emvitrdd.defaultValue) {
    RemoteTreatingDocDateTime();
     document.UpdateForm.emvitrdd.defaultValue=
     document.UpdateForm.emvitrdd.value
  }
}
function TreatingDoctorTime() {
  if(!checkTime(UpdateForm.emvitrdt,UpdateForm.emvitrdt.title)) {
   return;
  }
  if(!isWhitespace(UpdateForm.emvis007.value)) {
    if(isWhitespace(UpdateForm.emvitrdt.value)) {
      alert(UpdateForm.emvitrdt.title + " is a required field.\n" +
           "Please enter it now." )
      UpdateForm.emvitrdt.value=UpdateForm.emvitrdt.defaultValue;
      UpdateForm.emvitrdd.focus();
      return;
    }
  }
  if (!isWhitespace(document.UpdateForm.emhsarrd.value) &&
      !isWhitespace(document.UpdateForm.emhsarrt.value) &&
      !isWhitespace(document.UpdateForm.emvitrdd.value) &&
      !isWhitespace(document.UpdateForm.emvitrdt.value)) {
    if(SetDateYYYYMMDD(document.UpdateForm.emhsarrd.value) >
       SetDateYYYYMMDD(document.UpdateForm.emvitrdd.value)) {
      alert("Treating Doctor Date cannot be before Arrival Date.");
      document.UpdateForm.emvitrdd.value="";
      return;
    } else {
      if (SetDateYYYYMMDD(document.UpdateForm.emhsarrd.value) ==
          SetDateYYYYMMDD(document.UpdateForm.emvitrdd.value) &&
          !isWhitespace(document.UpdateForm.emhsarrt.value) &&
          !isWhitespace(document.UpdateForm.emvitrdt.value) &&
          document.UpdateForm.emhsarrt.value >
          document.UpdateForm.emvitrdt.value) {
        alert("Treating Doctor Time cannot be before Arrival Time.");
        document.UpdateForm.emvitrdt.value="";
        return;
      }
    }
  }
  if (!isWhitespace(document.UpdateForm.emviprdd.value) &&
      !isWhitespace(document.UpdateForm.emviprdt.value) &&
      !isWhitespace(document.UpdateForm.emvitrdd.value) &&
      !isWhitespace(document.UpdateForm.emvitrdt.value)) {
    if(SetDateYYYYMMDD(document.UpdateForm.emviprdd.value) >
       SetDateYYYYMMDD(document.UpdateForm.emvitrdd.value)) {
      alert("Treating Doctor Date cannot be before Previous Doctor Handover Date.");
      document.UpdateForm.emvitrdd.value="";
      return;
    } else {
      if (SetDateYYYYMMDD(document.UpdateForm.emviprdd.value) ==
          SetDateYYYYMMDD(document.UpdateForm.emvitrdd.value) &&
          !isWhitespace(document.UpdateForm.emviprdt.value) &&
          !isWhitespace(document.UpdateForm.emvitrdt.value) &&
          document.UpdateForm.emviprdt.value >
          document.UpdateForm.emvitrdt.value) {
        alert("Treating Doctor Time cannot be before Previous Doctor Handover Time.");
        document.UpdateForm.emvitrdt.value="";
        return;
      }
    }
  }
  SetCurrentDateTimeNoFocus(document.UpdateForm.curdtvar,
                     document.UpdateForm.curtmvar);
  if (!isWhitespace(document.UpdateForm.emvitrdd.value) &&
      !isWhitespace(document.UpdateForm.emvitrdt.value)) {
    if (SetDateYYYYMMDD(document.UpdateForm.curdtvar.value) ==
        SetDateYYYYMMDD(document.UpdateForm.emvitrdd.value) &&
        document.UpdateForm.emvitrdt.value >
        document.UpdateForm.curtmvar.value) {
      alert("Treating Doctor cannot have a future time.");
      document.UpdateForm.emvitrdt.value="";
      return;
    }
  }
  if(document.UpdateForm.emvitrdt.value !=
     document.UpdateForm.emvitrdt.DefaultValue) {
    RemoteTreatingDocDateTime();
    document.UpdateForm.emvitrdt.DefaultValue=
    document.UpdateForm.emvitrdt.value
  }
}
function TreatingNurseDate() {
  if(!checkDate(UpdateForm.emvitndd,UpdateForm.emvitndd.title)) {
   return;
  }
  if(!isWhitespace(UpdateForm.emvis130.value)) {
    if(isWhitespace(UpdateForm.emvitndd.value)) {
      alert(UpdateForm.emvitndd.title + " is a required field.\n" +
           "Please enter it now." )
      UpdateForm.emvitndd.value=UpdateForm.emvitndd.defaultValue;
      UpdateForm.emvitndd.focus();
      return;
    }
  }
  if (!isWhitespace(document.UpdateForm.emhsarrd.value) &&
      !isWhitespace(document.UpdateForm.emvitndd.value)) {
    if(SetDateYYYYMMDD(document.UpdateForm.emhsarrd.value) >
       SetDateYYYYMMDD(document.UpdateForm.emvitndd.value)) {
      alert("Treating Nurse Date cannot be before Arrival Date.");
      document.UpdateForm.emvitndd.value="";
      return;
    } else {
      if (SetDateYYYYMMDD(document.UpdateForm.emhsarrd.value) ==
          SetDateYYYYMMDD(document.UpdateForm.emvitndd.value) &&
          !isWhitespace(document.UpdateForm.emhsarrt.value) &&
          !isWhitespace(document.UpdateForm.emvitndt.value) &&
          document.UpdateForm.emhsarrt.value >
          document.UpdateForm.emvitndt.value) {
        alert("Treating Nurse Time cannot be before Arrival Time.");
        document.UpdateForm.emvitndt.value="";
        return;
      }
    }
  }
  if (!isWhitespace(document.UpdateForm.emviprnd.value) &&
    !isWhitespace(document.UpdateForm.emvitndd.value)) {
    if(SetDateYYYYMMDD(document.UpdateForm.emviprnd.value) >
       SetDateYYYYMMDD(document.UpdateForm.emvitndd.value)) {
      alert("Treating Nurse Date cannot be before Previous Nurse Handover Date.");
      document.UpdateForm.emvitndd.value="";
      return;
    } else {
      if (SetDateYYYYMMDD(document.UpdateForm.emviprnd.value) ==
          SetDateYYYYMMDD(document.UpdateForm.emvitndd.value) &&
          !isWhitespace(document.UpdateForm.emviprnt.value) &&
          !isWhitespace(document.UpdateForm.emvitndt.value) &&
          document.UpdateForm.emviprnt.value >
          document.UpdateForm.emvitndt.value) {
        alert("Treating Nurse Time cannot be before Previous Nurse Handover Time.");
        document.UpdateForm.emvitndt.value="";
        return;
      }
    }
  }
  if(document.UpdateForm.emvitndd.value !=
     document.UpdateForm.emvitndd.defaultValue) {
    RemoteTreatingNurDateTime();
    document.UpdateForm.emvitndd.defaultValue=
    document.UpdateForm.emvitndd.value
  }
}
function TreatingNurseTime() {
  if(!checkTime(UpdateForm.emvitndt,UpdateForm.emvitndt.title)) {
   return;
  }
  if(!isWhitespace(UpdateForm.emvis130.value)) {
    if(isWhitespace(UpdateForm.emvitndt.value)) {
      alert(UpdateForm.emvitndt.title + " is a required field.\n" +
           "Please enter it now." )
      UpdateForm.emvitndt.value=UpdateForm.emvitndt.defaultValue;
      UpdateForm.emvitndt.focus();
      return;
    }
  }
  if (!isWhitespace(document.UpdateForm.emhsarrd.value) &&
      !isWhitespace(document.UpdateForm.emhsarrt.value) &&
      !isWhitespace(document.UpdateForm.emvitndd.value) &&
      !isWhitespace(document.UpdateForm.emvitndt.value)) {
    if(SetDateYYYYMMDD(document.UpdateForm.emhsarrd.value) >
       SetDateYYYYMMDD(document.UpdateForm.emvitndd.value)) {
      alert("Treating Nurse Date cannot be before Arrival Date.");
      document.UpdateForm.emvitndd.value="";
      return;
    } else {
      if (SetDateYYYYMMDD(document.UpdateForm.emhsarrd.value) ==
          SetDateYYYYMMDD(document.UpdateForm.emvitndd.value) &&
          !isWhitespace(document.UpdateForm.emhsarrt.value) &&
          !isWhitespace(document.UpdateForm.emvitndt.value) &&
          document.UpdateForm.emhsarrt.value >
          document.UpdateForm.emvitndt.value) {
        alert("Treating Nurse Time cannot be before Arrival Time.");
        document.UpdateForm.emvitndt.value="";
        return;
      }
    }
  }
  if (!isWhitespace(document.UpdateForm.emviprnd.value) &&
      !isWhitespace(document.UpdateForm.emviprnt.value) &&
      !isWhitespace(document.UpdateForm.emvitndd.value) &&
      !isWhitespace(document.UpdateForm.emvitndt.value)) {
    if(SetDateYYYYMMDD(document.UpdateForm.emviprnd.value) >
       SetDateYYYYMMDD(document.UpdateForm.emvitndd.value)) {
      alert("Treating Nurse Date cannot be before Previous Nurse Handover Date.");
      document.UpdateForm.emvitndd.value="";
      return;
    } else {
      if (SetDateYYYYMMDD(document.UpdateForm.emviprnd.value) ==
          SetDateYYYYMMDD(document.UpdateForm.emvitndd.value) &&
          !isWhitespace(document.UpdateForm.emviprnt.value) &&
          !isWhitespace(document.UpdateForm.emvitndt.value) &&
          document.UpdateForm.emviprnt.value >
          document.UpdateForm.emvitndt.value) {
        alert("Treating Nurse Time cannot be before Previous Nurse Handover Time.");
        document.UpdateForm.emvitndt.value="";
        return;
      }
    }
  }
  SetCurrentDateTimeNoFocus(document.UpdateForm.curdtvar,
                     document.UpdateForm.curtmvar);
  if (!isWhitespace(document.UpdateForm.emvitndd.value) &&
      !isWhitespace(document.UpdateForm.emvitndt.value)) {
    if (SetDateYYYYMMDD(document.UpdateForm.curdtvar.value) ==
        SetDateYYYYMMDD(document.UpdateForm.emvitndd.value) &&
        document.UpdateForm.emvitndt.value >
        document.UpdateForm.curtmvar.value) {
      alert("Treating Nurse cannot have a future time.");
      document.UpdateForm.emvitndt.value="";
      return;
    }
  }
  if(document.UpdateForm.emvitndt.value != 
     document.UpdateForm.emvitndt.defaultValue) {
    RemoteTreatingNurDateTime();
    document.UpdateForm.emvitndt.defaultValue=
    document.UpdateForm.emvitndt.value
  }
}
function defArrivalTime(datefield,timefield,doctortype) {
  if(datefield.readOnly==true || timefield.readOnly==true) {
    return;
  }
//
  datefield.value=document.UpdateForm.d_emvitrdt.value;
  timefield.value=document.UpdateForm.d_emvitrtm.value;
//
  if(doctortype == "IA") {        // Initial Assessor
    AssessorDate();
    AssessorTime();
  } else if(doctortype == "SD") { // Senior Doctor
    SeniorDoctorDate();
    SeniorDoctorTime();
  } else if(doctortype == "TD") { // Treating Doctor
    TreatingDoctorDate();
    TreatingDoctorTime();
  } else if(doctortype == "TN") { // Treating Nurse
    TreatingNurseDate();
    TreatingNurseTime();
  }
}
function ArrivalTimeButtons() {
  if(isWhitespace(document.UpdateForm.d_emvitrdt.value) ||
     isWhitespace(document.UpdateForm.d_emvitrtm.value)) { 
    return;
  }
//
  IA_Button=document.getElementById("initialasstim");
  SD_Button=document.getElementById("seniordoctim");
  TD_Button=document.getElementById("treatingdoctim");
  TN_Button=document.getElementById("treatingnurtim");
//
  if(!isWhitespace(document.UpdateForm.emvis110.value)) {
    IA_Button.disabled=false;
  }
//
  if(!isWhitespace(document.UpdateForm.emvis109.value)) {
    SD_Button.disabled=false;
  }
//
  doctor_date_time=document.UpdateForm.emvitrdd.value +
                   document.UpdateForm.emvitrdt.value

  if(!isWhitespace(document.UpdateForm.emvis007.value) &&
    trim(document.UpdateForm.emvis007.value)==
    trim(document.HiddenFields.d_frstdoct.value.substr(0,10))) {
    if(doctor_date_time==document.HiddenFields.d_frstdoct.value.substr(10,19)){
       TD_Button.disabled=false;
    }
  }
//
  nurse_date_time=document.UpdateForm.emvitndd.value +
                  document.UpdateForm.emvitndt.value

  if(!isWhitespace(document.UpdateForm.emvis130.value) &&
    trim(document.UpdateForm.emvis130.value)==
    trim(document.HiddenFields.d_frstnurs.value.substr(0,10))) {
    if(nurse_date_time==document.HiddenFields.d_frstnurs.value.substr(10,19)){
       TN_Button.disabled=false;
    }
  }
//
}
//
// Copied from emrweb0201004.js to change all references of 
// emrweb0201004 to emrweb0201013 
//
function init(){
  PageDirty = false;
  var strg1= trim(HiddenFields.Pres01.value)
      if(!isWhitespace(strg1)) { strg1+="\n"}
  var strg2= trim(HiddenFields.Pres02.value)
      if(!isWhitespace(strg2)) { strg2+="\n"}
  var strg3= trim(HiddenFields.Pres03.value)
      if(!isWhitespace(strg3)) { strg3+="\n"}
  var strg4= trim(HiddenFields.Pres04.value)
      if(!isWhitespace(strg4)) { strg4+="\n"}
  var strg5= trim(HiddenFields.Pres05.value)
      if(!isWhitespace(strg5)) { strg5+="\n"}
  var strg6= trim(HiddenFields.Pres06.value)
  UpdateForm.prcom001.value=strg1+strg2+strg3+strg4+strg5+strg6
  UpdateForm.savdesc1.value=strg1+strg2+strg3+strg4+strg5+strg6
  if (HiddenFields.CheckUr.value == "1") { checkurno(); }
  savePrcom001=GetCookieData("emrweb0201013.prcom001");
  SetCookie("emrweb0201013.prcom001","");
  ExpireCookiePath("emrweb0201013.prcom001");
  if (savePrcom001!="unknown") {
    if (!isWhitespace(savePrcom001)) {
      if (confirm("Comments Saved\n\n"+savePrcom001+"\n\nClick Ok to Restore."))
      {
        UpdateForm.prcom001.value=savePrcom001;
        prcom001TopFrame();
      }
    }
  }

  var p = document.UpdateForm;
  // Select Telehealth Site Code
  telesite = p.d_telesit.value;
  for (var i =0 ; i < p.emvis132.length; i++) {
    if (p.emvis132.options[i].value == telesite) {
      p.emvis132.selectedIndex=i;
    }
  }

  // Select Telehealth Location
  telelocn = p.d_teleloc.value;
  for (var i =0 ; i < p.emvis006.length; i++) {
    if (p.emvis006.options[i].value == telelocn) {
      p.emvis006.selectedIndex=i;
    }
  }
}

function onUpdate(){
  document.PatientLinks.checksub.value=1;
  var docchk=chkdoct();
  var nurchk=chknurse();
  var prcomupd = document.getElementById("prcomupd");

  if (docchk){
    if(nurchk){
       url = "emrweb02.pbl?reportno=1&template=13&urnumber=" +
             document.UpdateForm.urnumber.value.replace(/ /g,"+") +
            "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+");
       document.UpdateForm.redirect.value=url;

       var locachk=chkLoc();

      if (locachk)
      {
          if(prcomupd)
          {
             if(prcomupd.value==1)
               setFormactn('PRCOM');
             else
               setFormactn('UPDAT');
           }
           else {
             setFormactn('UPDAT');
           }
      }
    }
  }
}
function valOGroup() {
 site = document.UpdateForm.emvis132.value.substr(0,3);
 hosp = document.UpdateForm.emvis132.value.substr(3,3);
  if (ValidOG()) {  // validate Occupational Group
    if (!isWhitespace(hosp)) {
      if (!ChangeHospSite(hosp,site)) {
        alert("Failed to change user Hospital and Site");
        return;
      }
    }
    else {
      if (!ChangeSite(site)) {
        alert("Failed to change user Site");
        return;
      }
    }

    if (ChangeLogin()) {
      // reload top frame
      getTop().menu.location.href = getTop().menu.location.href;
    }
  }
}
function RemoteEmrLocation(valdcode,valdrtyp,ReturnSelect) {
  ReturnFunction="" ;
  for (var i=1; i < RemoteEmrLocation.arguments.length; i++) {
  if (typeof(RemoteEmrLocation.arguments[i]) == 'function') {
     ReturnFunction=RemoteEmrLocation.arguments[i] } }
  var serverURL = "../cgi-bin/emrweb08.pbl?reportno=30" +
                  "&valdcode=" + valdcode.value.replace(/ /g,"+") +
                  "&valdrtyp=" + valdrtyp.value.replace(/ /g,"+")

  if (IEBrowser) {
    var returnValue = RSExecute(serverURL);

    ReturnValue=returnValue.return_value.split("|");
    if (returnValue.status==0) {
      ReturnSelect.options.length=0;
      ReturnValue=returnValue.return_value.split("|");
      for (var j=0; j < ReturnValue.length; j++) {
         if (!isWhitespace(ReturnValue[j])) {
           SelectValue=ReturnValue[j].split(",");
           ReturnSelect.options[ReturnSelect.options.length]=
            new Option(SelectValue[1],SelectValue[0]);
         }
       }
    }
  }
  else {
    var returnValue = RSExecuteFetch(serverURL);

    returnValue.then(
      function (returnValue) {
        returnValue = ParseFetchData(returnValue);  // parse fetch() result

        ReturnValue=returnValue.return_value.split("|");
        if (returnValue.status==0) {
          ReturnSelect.options.length=0;
          ReturnValue=returnValue.return_value.split("|");
          for (var j=0; j < ReturnValue.length; j++) {
             if (!isWhitespace(ReturnValue[j])) {
               SelectValue=ReturnValue[j].split(",");
               ReturnSelect.options[ReturnSelect.options.length]=
                new Option(SelectValue[1],SelectValue[0]);
             }
           }
        }
      }
    );
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoadExtended();readOnlyTreatingDocDateTime();
              readOnlyTreatingNurDateTime();ArrivalTimeButtons();"
              onunload="valOGroup();submitFormRedirect();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%EMRWEB02.01.003";
PatientVIS="%EMRWEB02.01.081";
PatientNAM="%EMRWEB02.01.002";
PatientSTA="%EMRWEB02.01.086.078";
PatientALT="%EMRWEB02.01.084";
PatientSEX="%EMRWEB02.01.019";
PatientDOB="%EMRWEB02.01.020";
PatientAGE="%EMRWEB02.01.021";
PatientLOC="%EMRWEB02.01.083";
PatientPRI="%EMRWEB02.01.086.066.1";
PatientUNT="%EMRWEB02.01.066.0";
PatientIND="%EMRWEB02.01.086.091";
GpCOD="%EMRWEB02.01.086.084.001";
GpNAM="%EMRWEB02.01.086.084.081";
GpPRAC="%EMRWEB02.01.086.085.001";
GpPRACCNT="%EMRWEB02.01.086.085.002";
GpPRACNAM="%EMRWEB02.01.086.085.005";
PatientARR="%EMRWEB02.01.101.0 %EMRWEB02.01.102";
PatientSEE="%EMRWEB02.01.130.0 %EMRWEB02.01.131";
PatientTRI="%EMRWEB02.01.103.3";
PatientECLC="%EMRWEB02.01.484.1";
PatientCLH="%STANDARD.01.017.CL";
PatientEHFT="%EMRWEB02.01.485";
InsertEmergencyHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection style="height:98%;overflow: auto;">
<form name=UpdateForm action="emrweb02.pbl" method=post
 onsubmit='return validateMandatory(this);'>
 <input type=hidden name=reportno value="01">
 <input type=hidden name=resavail value="0">
 <input type=hidden name=template value="001">
 <input type=hidden name=admissno value="%EMRWEB02.01.081">
 <input type=hidden name=urnumber value="%EMRWEB02.01.003">
 <input type=hidden name=formactn value="C1">
 <input type=hidden name=redirect value="emrweb02.pbl?reportno=1&template=4">
 <input type=hidden name=updateky value="%EMRWEB02.01.404">
 <input type=hidden name=updttype value="UPDAT">
 <input type=hidden name=nextpage value=17>
 <input type=hidden name=pmpxi067 value="%EMRWEB02.01.667.0">
 <input type=hidden name=username>
 <input type=hidden name=password>
 <input type=hidden name=dummy1>
 <input type=hidden name=dummy2>
 <input type=hidden name=emvis004>
 <input type=hidden name=emvis005>
 <input type=hidden name=emvis135>
 <input type=hidden name=emvis136>
 <input type=hidden name=emvis137>
 <input type=hidden name=emvis138>
 <input type=hidden name=emvis147>
 <input type=hidden name=emvis118 value="%EMRWEB02.01.003">
 <input type=hidden name=savdesc1>
 <input type=hidden name=savmanag>
 <input type=hidden name=searchgn value="%EMRWEB02.01.009">
 <input type=hidden name=searchsn value="%EMRWEB02.01.010">
 <input type=hidden name=searchps value="%EMRWEB02.01.019">
 <input type=hidden name=searchpd value="%EMRWEB02.01.020">
 <input type=hidden name=discstat value="%EMRWEB02.01.147">
 <input type=hidden name=emcndoct value="%EMRWEB02.01.455">
 <input type=hidden name=webuseid value="%STANDARD.01.008">
 <input type=hidden name=updflag1 value="1" />
 <input type=hidden name=current_precom id=current_precom
  value="%EMRWEB02.01.220.1" />
 <input type=hidden name=mntnotes value="%EMRWEB02.01.471.002.0" />
 <input type=hidden name=curdtvar value="">
 <input type=hidden name=curtmvar value="">
 <input type=hidden name=emhsarrd value="%EMRWEB02.01.101.0">
 <input type=hidden name=emhsarrt value="%EMRWEB02.01.102">
 <input type=hidden name=emviprdd value="%EMRWEB02.01.575.1">
 <input type=hidden name=emviprdt value="%EMRWEB02.01.575.2">
 <input type=hidden name=emviprnd value="%EMRWEB02.01.577.1">
 <input type=hidden name=emviprnt value="%EMRWEB02.01.577.2">
 <input type=hidden name=patlocot value="%EMRWEB02.01.580">
 <input type=hidden name=nurupind value="1">
 <input type=hidden name=d_emvitrdt value="%EMRWEB02.01.162.0">
 <input type=hidden name=d_emvitrtm value="%EMRWEB02.01.163">
 <input type=hidden name=valdrtyp value="E">
 <input type=hidden name=d_wbsedoc value="%EMRWEB02.01.924">
 <input type=hidden name=d_telecnt value="%EMRWEB02.01.926">
 <input type=hidden name=d_telesit value="%EMRWEB02.01.927">
 <input type=hidden name=d_teleloc value="%EMRWEB02.01.928">
 <input type=hidden name=wbsecocg value="%STANDARD.01.012.3">

<table width=100% align=center border=0 cellspacing=0 cellpadding=1>
<tr><td class=HeadingCell align=center>
    ETS Patient Maintenance Screen</td>
    </tr>
</table>
<table width=100% align=center border=0 cellspacing=0 cellpadding=1>
<tr valign=top><td class=DataLabel width=15%>Presenting Complaint </td>
    <td>
    <input type=hidden name=emrviscat value="el">
      <input type="text" size=10 name=test value="%EMRWEB02.01.220.1"
        readonly class="NoAutoFocus Readonly"/>
      <input type=text name=v060name readonly class="Readonly"
        value="%EMRWEB02.01.220.0">
    </td>
    <td colspan=4>
    <textarea name=prcom001 wrap=hard cols=50 rows=2 readonly class=Readonly>
    </textarea> 
    </td>
  <td class=DataLabel>Site ID</td>
  <td><input type=hidden name=name_emvis132 title="Site ID">
    <select class="Mandatory" name="emvis132"
      title="Site ID"
      onchange="RemoteEmrLocation(this,UpdateForm.valdrtyp,
                UpdateForm.emvis006);">
      <option></option>
      %EMRWEB02.01.931.2
    </select>
  </td>
</tr>

<tr><td class=DataLabel>Location</td>
    <td><input type=hidden name=name_emvis006 title="Location"
         value="%EMRWEB02.01.106.0">
    <select class="Mandatory" name=emvis006 title="Location">
    </select>
    <td class=DataLabel>
    </td></tr>

<tr><td class=DataLabel>
    <table width=100% align=center border=0 cellspacing=0 cellpadding=0>
    <tr>
      <td>
        Telehealth
      </td>
      <td align=right>
        <div id="InitialAssessorTitleDIV">
          <img class=Icon src=../images/erase.gif
           onclick="clrFields(UpdateForm.emvis110,UpdateForm.n_emvis110,
                              UpdateForm.emvis075,UpdateForm.emvis085);
                    Assessor();AssessorDate();AssessorTime();
                    location.reload();">
          <img notab src="../images/SearchIcon.gif" class=Icon
           onclick="DoctorSearchFrame(UpdateForm.emvis110,
                    UpdateForm.n_emvis110)">        
        </div>
      </td>
    </tr>
    </table>
    </td>
    <td colspan=2>
        <div id="InitialAssessorFieldDIV">
          <input type=text size=6 maxlength=6 name=emvis110 
           title="Initial Assessor" value="%EMRWEB02.01.910.003"
           onblur="Assessor();">
          <input type=text size=18 name=n_emvis110 title="Initial Assessor"
           readonly class=Readonly value="%EMRWEB02.01.910.002">
           Date
          <input type="text" name=emvis075 size="12"
           value="%EMRWEB02.01.235.0" onblur="AssessorDate();"
           class="BackDate" title="Initial Assessor Date">
          <img notab src=../images/DateLookup.gif
           class=Icon onclick="DateLookupFrame(UpdateForm.emvis075);">
          Time
          <input type="text" name=emvis085 size="8" onblur="AssessorTime();"
           value="%EMRWEB02.01.245"
           class='Time' title="Initial Assessor Time">
          <img notab src=../images/TimeLookup.gif class=Icon
           onclick="TimeLookupFrame(UpdateForm.emvis085);">
          <img notab src=../images/DateTimeStamp.gif class=Icon
           onclick="SetCurrentDateTime(UpdateForm.emvis075,UpdateForm.emvis085);">
       <input type=button class="button" value="Arrival Time"
        id="initialasstim" disabled
        onclick="defArrivalTime(UpdateForm.emvis075,UpdateForm.emvis085,'IA');">
       <script type="text/javascript">
        document.getElementById("initialasstim").value=EDArrivalTime;
       </script>

        </div>
    <td>
    </tr>

<tr><td class=DataLabel>
    <table width=100% align=center border=0 cellspacing=0 cellpadding=0>
    <tr>
      <td>
        Senior Doctor
      </td>
      <td align=right>
        <div id="SeniorDoctorTitleDIV">
          <img src=../images/erase.gif class=Icon
           onclick="clrFields(UpdateForm.emvis109,UpdateForm.n_emvis109,
                              UpdateForm.emvis079,UpdateForm.emvis089);
                    SeniorDoctor();SeniorDoctorDate();SeniorDoctorTime();
                    location.reload();">
          <img notab src="../images/SearchIcon.gif" class=Icon
           onclick="DoctorSearchFrame(UpdateForm.emvis109,UpdateForm.n_emvis109)">
        </div>
      </td>
    </tr>
    </table>
    </td>
    <td colspan=2>
        <div id="SeniorDoctorFieldDIV">
          <input type=text size=6 maxlength=6 name=emvis109
           title="Senior Doctor" value="%EMRWEB02.01.909.003"
           onblur="SeniorDoctor();SeniorDoctorDate();SeniorDoctorTime();
                   location.reload();">
          <input type=text size=18 name=n_emvis109 title="Senior Doctor"
           readonly class=Readonly value="%EMRWEB02.01.909.002">
           Date
          <input type="text" name=emvis079 size="12"
           value="%EMRWEB02.01.239.0" onblur="SeniorDoctorDate();"
           class="BackDate" title="Senior Doctor Date">
          <img notab class=Icon src=../images/DateLookup.gif
           onclick="DateLookupFrame(UpdateForm.emvis079);">
          Time
          <input type="text" name=emvis089 size="8" onblur="SeniorDoctorTime();"
           value="%EMRWEB02.01.249"
           class='Time' title="Senior Doctor Time">
          <img notab src=../images/TimeLookup.gif class=Icon
           onclick="TimeLookupFrame(UpdateForm.emvis089);">
          <img notab src=../images/DateTimeStamp.gif class=Icon
           onclick="SetCurrentDateTime(UpdateForm.emvis079,UpdateForm.emvis089);">

       <input type=button class="button" value="Arrival Time"
        id="seniordoctim" disabled
        onclick="defArrivalTime(UpdateForm.emvis079,UpdateForm.emvis089,'SD');">
       <script type="text/javascript">
        document.getElementById("seniordoctim").value=EDArrivalTime;
       </script>

        </div>
    <td>
    </tr>

<tr><td class=DataLabel>
      <table width=100% align=center border=0 cellspacing=0 cellpadding=0>
        <tr>
          <td>
            Treating Doctor
          </td>
          <td align=right>
            <div id="TreatingDoctorTitleDIV">
              <img class=Icon src="../images/erase.gif"
               id="DocDelBut" onclick="DelDoc();">
              <img class=Icon src="../images/SearchIcon.gif"
               onclick="SearchDoctor();">
            </div>
          </td>
        </tr>
      </table>
    </td>
    <td colspan=2>
      <div id="TreatingDoctorFieldDIV">
        <input type=text size=6 maxlength=6 name=emvis007 title="Doctor Code"
         value="%EMRWEB02.01.107.001"
         onblur="UpdDoctor();">
        <input type=text size=18 name=dummy3 title="Doctor Name"
         readonly class=Readonly value="%EMRWEB02.01.107.003">
           Date
          <input type="text" name=emvitrdd size="12"
           value="%EMRWEB02.01.574.1" onblur="TreatingDoctorDate();"
           class="BackDate" title="Treating Doctor Date">
          <img notab src=../images/DateLookup.gif
           class=Icon onclick="DateLookupFrame(UpdateForm.emvitrdd);">
          Time
          <input type="text" name=emvitrdt size="8"
           onblur="TreatingDoctorTime();"
           value="%EMRWEB02.01.574.2"
           class='Time' title="Treating Doctor Time">
          <img notab src=../images/TimeLookup.gif class=Icon
           onclick="TimeLookupFrame(UpdateForm.emvitrdt);">
          <img notab src=../images/DateTimeStamp.gif class=Icon
           onclick="SetCurrentDateTime(UpdateForm.emvitrdd,UpdateForm.emvitrdt);
                    RemoteTreatingDocDateTime()">

       <input type=button class="button" value="Arrival Time"
        id="treatingdoctim" disabled
        onclick="defArrivalTime(UpdateForm.emvitrdd,UpdateForm.emvitrdt,'TD');">
       <script type="text/javascript">
        document.getElementById("treatingdoctim").value=EDArrivalTime;
       </script>

          <input type=button class="Bigbutton" value="Doctor Handover"
           onclick='DoctorData();'>
      </div>
    </td>
</tr>

<tr><td class=DataLabel>
      <table width=100% align=center border=0 cellspacing=0 cellpadding=0>
        <tr>
          <td>
            Treating Nurse
          </td>
          <td align=right>
            <div id="TreatingNurseTitleDIV">
              <img class=Icon src="../images/erase.gif"
               id="NurDelBut" onclick="DelNurse();">
              <img class=Icon src="../images/SearchIcon.gif"
               onclick="NurseSearchFrame(UpdateForm.emvis130,UpdateForm.dummy5)">
            </div>
          </td>
        </tr>
      </table>
    </td>
    <td colspan=2>
    <input type=hidden name=gnm>
      <div id="TreatingNurseFieldDIV">
        <input type=text size=6 name=emvis130 title="Nurse Code"
         onblur='UpdNur(UpdateForm.emvis130);' value="%EMRWEB02.01.164.1">
        <input type=text size=18 name=dummy5 title="Nurse Name" readonly
         class=Readonly value="%EMRWEB02.01.164.0">
           Date
          <input type="text" name=emvitndd size="12"
           value="%EMRWEB02.01.576.1" onblur="TreatingNurseDate();"
           class="BackDate" title="Treating Nurse Date">
          <img notab src=../images/DateLookup.gif
           class=Icon onclick="DateLookupFrame(UpdateForm.emvitndd);">
          Time
          <input type="text" name=emvitndt size="8"
           onblur="TreatingNurseTime();"
           value="%EMRWEB02.01.576.2"
           class='Time' title="Treating Nurse Time">
          <img notab src=../images/TimeLookup.gif class=Icon
           onclick="TimeLookupFrame(UpdateForm.emvitndt);">
          <img notab src=../images/DateTimeStamp.gif class=Icon
           onclick="SetCurrentDateTime(UpdateForm.emvitndd,UpdateForm.emvitndt);
                    RemoteTreatingNurDateTime();">

       <input type=button class="button" value="Arrival Time"
        id="treatingnurtim" disabled
        onclick="defArrivalTime(UpdateForm.emvitndd,UpdateForm.emvitndt,'TN');">
       <script type="text/javascript">
        document.getElementById("treatingnurtim").value=EDArrivalTime;
       </script>

        <input type=button class="Bigbutton"
         value="Nurse Handover" onclick='NurseData();'>
      </div>
    </td>
</tr>

<tr><td>Triage Nurse</td>
    <td><input type=text size=29 name=name_triage title="Triage Nurse" readonly 
         Class=Readonly value="%EMRWEB02.01.161.0">
    </td></tr>

<tr><td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
</tr>
</table>

<table border=0 width=100% align=center cellspacing=0 cellpadding=1>
<tr><td colspan=6 align=center>
    <input type=button class="button" id="btnUpdate" name="btnUpdate"
           value="Update" onclick="tempDisable(this);onUpdate();" />
    <input type=button class="button" value="Clinical" 
     onclick="PatientLink('emrweb02.pbl',1,100);"> 
    <input type=button class="button" value="Registration" 
     onclick="checkurno();">
    <input type=button class="button" value="Injury Data" name=injbuttn
     onclick="SmallFrameEmr('71');"> 
    <input type=button class="button" value="Outstanding" 
     onclick="SmallFrameEmr('51');"> 
    <input type=button class="button" value="Discharge" 
     onclick="checkUR(document.UpdateForm.discstat.value);"> 
    <input type=button class="button" value="Labels & Forms" 
     onclick="SmallFrameEmr('5');"> 
    <input type=button class=RedButton value="Exit" 
     onclick="ReturnToMap();">
    <input type=button class="button" value="Observations" name=obsbuttn
     onclick="PatientLink('cliweb02.pbl',1,001);">
    <input type=button class="button" value="Man. Notes" name=mnnbuttn
     onclick="AddMgtNote()">
    <input type=button class="button" value="Jump Queue"
     onclick="updateNext();">
    </td></tr>
</table>
</form>
</div>

<form name=PatientLinks method=get id=PatientLinks style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=webuseid value="%STANDARD.01.008">
<input type=hidden name=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=admissno value="%EMRWEB02.01.081">
<input type=hidden name=MenuType value="11">
<input type=hidden name=checksub value="0">
<input type=hidden name=emvis147>
<input type=hidden name=d_regiflag value="%EMRWEB02.01.461">
</form>
<form name=HiddenFields style="margin:0">
<input type=hidden name=InjuryIndicator value="%EMRWEB02.01.447">
<input type=hidden name=CheckUr value="%EMRWEB02.01.448">
<input type=hidden name=DoctorCode value="%EMRWEB02.01.107.001">
<input type=hidden name=NurseCode value="%EMRWEB02.01.164.1">
<input type=hidden name=Location value="%EMRWEB02.01.083">
<input type=hidden name=DischargeComplete value="%EMRWEB02.01.147">
<input type=hidden name=Pres01 value="%EMRWEB02.01.104">
<input type=hidden name=Pres02 value="%EMRWEB02.01.105">
<input type=hidden name=Pres03 value="%EMRWEB02.01.174">
<input type=hidden name=Pres04 value="%EMRWEB02.01.175">
<input type=hidden name=Pres05 value="%EMRWEB02.01.176">
<input type=hidden name=Pres06 value="%EMRWEB02.01.177">
<input type=hidden name=linkadmn value="%EMRWEB02.01.081">
<input type=hidden name=d_frstdoct value="%EMRWEB02.01.475.2">
<input type=hidden name=d_frstnurs value="%EMRWEB02.01.496.2">
</form>

<form name="ChangeSiteForm" action="websec01.pbl" method=post style="margin:0">
<input type=hidden name=reportno value="5">
<input type=hidden name=updttype value="U">
<input type=hidden name=username value="%STANDARD.01.008">
<input type=hidden name=wbsec011 value="1">
<input type=hidden name=wbsec010>
</form>

<form name="ChangeHospForm" action="websec01.pbl" method=post style="margin:0">
<input type=hidden name=reportno value="5">
<input type=hidden name=updttype value="U">
<input type=hidden name=chnghosp value="1">
<input type=hidden name=username value="%STANDARD.01.008">
<input type=hidden name=wbsec011 value="1">
<input type=hidden name=wbsec010>
<input type=hidden name=wbsec031>
</form>

<form name="ChangeLoginForm" action="websec01.pbl" method=post style="margin:0">
<input type=hidden name=reportno value="1">
<input type=hidden name=updttype value=" ">
</form>

<script type="text/javascript">
 CTypeAdm="%EMRWEB02.01.252";
 if ( CTypeAdm == "Yes") {
   document.UpdateForm.emvis147.value=1; 
   document.PatientLinks.emvis147.value=1; }
 else { 
   document.UpdateForm.emvis147.value=0; 
   document.PatientLinks.emvis147.value=0; }
 ShowReg="%EMRWEB02.01.461";
 if(ShowReg=="1") {
   checkurno();
 }
 InjData="%EMRWEB02.01.188";
 if ( InjData =="1" ) {
    document.UpdateForm.injbuttn.className="RedButton";
 }
 if(document.HiddenFields.DischargeComplete.value=="4") {
   alert("Warning: This visit is Cancelled");
 }
 hasObservations = "%EMRWEB02.01.473";
 if (hasObservations == "1") {
   document.UpdateForm.obsbuttn.className="RedButton";
  }

 if (!isWhitespace(document.UpdateForm.mntnotes.value)) {
   // has management notes
   document.UpdateForm.mnnbuttn.className="RedButton";
 }

  emvisite="%EMRWEB02.01.185.1";
  for (var i =0 ; i < document.UpdateForm.emvis132.length; i++) {
    if (document.UpdateForm.emvis132.options[i].value==emvisite) {
     document.UpdateForm.emvis132.selectedIndex=i;
    }
  }

  RemoteEmrLocation(document.UpdateForm.emvis132,
                    document.UpdateForm.valdrtyp,
                    document.UpdateForm.emvis006);
  
  emvilocn="%EMRWEB02.01.106.1";
  for (var i =0 ; i < document.UpdateForm.emvis006.length; i++) {
    if (document.UpdateForm.emvis006.options[i].value==emvilocn) {
     document.UpdateForm.emvis006.selectedIndex=i;
    }
  }

  if (document.UpdateForm.emvis110!=undefined) {
    if (isWhitespace(document.UpdateForm.emvis110.value)) {
      document.UpdateForm.emvis110.value=document.UpdateForm.d_wbsedoc.value;
      Assessor();
    }
  }

function ValidOG() {
  // Check indicator 1 of user's OG (Occupational Group)
  // Valid if "E", otherwise invalid
  var p = document.UpdateForm;

  if (p.wbsecocg.value.substr(3,1) != "E") {
    alert("Invalid " + trim("%STANDARD.01.017.w0") + " !");
    return false;
  }

  return true;
}

function ChangeSite(SiteCode) {
  if (!SiteCode || isWhitespace(SiteCode))
    return false;

  var theURL = "websec01.pbl";
  var p = document.ChangeSiteForm;

  p.wbsec010.value = SiteCode;
  var postStr = AJAXPostString(p);

  xmlHttp = createHttpObject();
  xmlHttp.open("POST", theURL, false);
  xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded;");
  xmlHttp.send(postStr);

  if (xmlHttp.status=="200") {
    return true;
  }
  else {
    return false;
  }
}

function ChangeHospSite(HospCode, SiteCode) {
  if (!HospCode || !SiteCode ||
      isWhitespace(HospCode) || isWhitespace(SiteCode))
    return false;

  var theURL = "websec01.pbl";
  var p = document.ChangeHospForm;

  p.wbsec031.value = HospCode;
  p.wbsec010.value = SiteCode;
  var postStr = AJAXPostString(p);

  xmlHttp = createHttpObject();
  xmlHttp.open("POST", theURL, false);
  xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded;");
  xmlHttp.send(postStr);

  if (xmlHttp.status=="200") {
    return true;
  }
  else {
    return false;
  }
}

function ChangeLogin() {
  var theURL = "websec01.pbl";
  var p = document.ChangeLoginForm;

  var postStr = AJAXPostString(p);

  xmlHttp = createHttpObject();
  xmlHttp.open("POST", theURL, false);
  xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded;");
  xmlHttp.send(postStr);

  if (xmlHttp.status=="200") {
    return true;
  }
  else {
    return false;
  }
}

</script>

<span id="InitialAssessorFieldSPAN" style="display:none">
  <input type=text size=6 maxlength=6 name=emvis110
   title="Initial Assessor" value="%EMRWEB02.01.910.003"
   class=Readonly readonly>
  <input type=text size=18 name=n_emvis110 title="Initial Assessor"
   readonly class=Readonly value="%EMRWEB02.01.910.002">
   Date
  <input type="text" name=emvis075 size="12"
   value="%EMRWEB02.01.235.0" readonly
   class="Readonly" title="Initial Assessor Date">
   Time
  <input type="text" name=emvis085 size="8" value="%EMRWEB02.01.245"
   class='Readonly' readonly title="Initial Assessor Time">
</span>

<span id="SeniorDoctorFieldSPAN" style="display:none">
  <input type=text size=6 maxlength=6 name=emvis109
   title="Senior Doctor" value="%EMRWEB02.01.909.003"
   class=Readonly readonly>
  <input type=text size=18 name=n_emvis109 title="Senior Doctor"
   readonly class=Readonly value="%EMRWEB02.01.909.002">
   Date
  <input type="text" name=emvis079 size="12"
   value="%EMRWEB02.01.239.0" readonly
   class="Readonly" title="Senior Doctor Date">
   Time
  <input type="text" name=emvis089 size="8" value="%EMRWEB02.01.249"
   class='Readonly' readonly title="Senior Doctor Time">
</span>

<span id="TreatingDoctorFieldSPAN" style="display:none">
  <input type=text size=6 maxlength=6 name=emvis007 title="Doctor Code"
   value="%EMRWEB02.01.107.001"
   class=Readonly readonly>
  <input type=text size=18 name=dummy3 title="Doctor Name"
   readonly class=Readonly value="%EMRWEB02.01.107.003">
   Date
  <input type="text" name=emvitrdd size="12"
   value="%EMRWEB02.01.574.1" readonly
   class="Readonly" title="Treating Doctor Date">
   Time
  <input type="text" name=emvitrdt size="8"
   value="%EMRWEB02.01.574.2"
   class='Readonly' readonly title="Treating Doctor Time">
</span>

<span id="TreatingNurseFieldSPAN" style="display:none">
  <input type=text size=6 name=emvis130 title="Nurse Code"
   value="%EMRWEB02.01.164.1"
   class=Readonly readonly>
  <input type=text size=18 name=dummy5 title="Nurse Name" readonly
   class=Readonly value="%EMRWEB02.01.164.0">
   Date
  <input type="text" name=emvitndd size="12"
   value="%EMRWEB02.01.576.1" readonly
   class="Readonly" title="Treating Nurse Date">
   Time
  <input type="text" name=emvitndt size="8"
   value="%EMRWEB02.01.576.2"
   class='Readonly' readonly title="Treating Nurse Time">
</span>
