<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome"    content="wahealth">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/EmrMandatory.js"></script>
<script type="text/javascript" src="../js/emrweb0202012.js"></script>
<script type="text/javascript">
function setPatientFields() {
  if (!isWhitespace(document.UpdateForm.emvis118.value))
  {
    document.UpdateForm.emvis111.className="readOnly";
    document.UpdateForm.emvis111.readOnly=true;
    document.UpdateForm.emvis112.className="readOnly";
    document.UpdateForm.emvis112.readOnly=true;
    sexfieldDIV.innerHTML=sexfieldSPAN1.innerHTML;
    document.UpdateForm.emexp005.className="readOnly";
    document.UpdateForm.emexp005.readOnly=true;
    //document.UpdateForm.prescomf.focus();
  } else {
    document.UpdateForm.emvis111.className="";
    document.UpdateForm.emvis111.readOnly=false;
    document.UpdateForm.emvis112.className="";
    document.UpdateForm.emvis112.readOnly=false;
    document.UpdateForm.emexp005.className="";
    document.UpdateForm.emexp005.readOnly=false;
    sexfieldDIV.innerHTML=sexfieldSPAN2.innerHTML;
  }
}

function setAuditField() {
  document.UpdateForm.updfield.value = "19";
  document.UpdateForm.reasonfc.value = "  ";
  getUserIDForLoginName(UpdateForm.secureid,UpdateForm.webuseid);
}

function CancelLink() {
  if (!isWhitespace(document.getElementById("eacregck").value)) {
    location.href = document.getElementById("eacregck").value;
  } else {
document.LinkForm.emexp001.value=document.UpdateForm.emexp001.value.replace(/ /g,"+")
document.LinkForm.submit();
  }
}
function displayDisasterID() {
  p=document.UpdateForm
  if (!isWhitespace(document.UpdateForm.dispt001.value)) {
    disasteridnumbertitleDIV.innerHTML=disasteridnumbertitleSPAN.innerHTML;
    disasteridnumberDIV.innerHTML=disasteridnumberSPAN.innerHTML;
  } else {
    disasteridnumbertitleDIV.innerHTML="";
    disasteridnumberDIV.innerHTML="";
  }

  if (!isWhitespace(disasteridnumberDIV.innerHTML)) {
    var serverURL   = "../cgi-bin/patweb80.pbl?reportno=98" +
                    "&valdcode=" + UpdateForm.urnumber.value.replace(/ /g,"+") +
                    UpdateForm.dispt001.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|");
      if (!isWhitespace(ReturnValue[0])) {
        p.dispt002.value=ReturnValue;
        p.dispt002.className="Readonly";
        p.dispt002.readOnly=true;
      }
    }
  }
}
function defaultDisasterCode() {
  if (document.UpdateForm.urnumber.value=="       0") {
     document.UpdateForm.dispt001.disabled=true;
     return;
  }

  if (!isWhitespace(document.UpdateForm.disacode.value)) {
  for (var i =0 ; i < document.UpdateForm.dispt001.length; i++) {
     if (document.UpdateForm.dispt001.options[i].value==
         document.UpdateForm.disacode.value) {
         document.UpdateForm.dispt001.selectedIndex=i
     }
    }
  }

  displayDisasterID();

  if (!isWhitespace(document.UpdateForm.dispt001.value)) {
    document.UpdateForm.dispt001.className = "Readonly";
    document.UpdateForm.dispt001.onfocus =
    function () {this.defaultIndex=this.selectedIndex};
    document.UpdateForm.dispt001.onchange =
    function () {this.selectedIndex=this.defaultIndex};
  }
}
//-----------------------------------------------------------------
// Function to check for expected patients with the same name or ur
//-----------------------------------------------------------------
function checkExpectedPat(urnum) {
  if (isWhitespace(urnum)) return false;;
  var serverURL = "../cgi-bin/emrweb08.pbl?reportno=16" +
                  "&valdcode="+urnum.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|")

    if(!isWhitespace(ReturnValue[0])) {
      if(confirm("Possible Expected Patient Match.\n" +
                 "U/R - \t\t" + ReturnValue[1].replace(/ /g,"") + "\n" +
                 "Surname - \t" + ReturnValue[2] + "\n" +
                 "Given Name - \t" + ReturnValue[3] + "\n" +
                 "Select OK to register U/R - " + urnum.replace(/ /g,"")  +
                 " using Expected Patient details \n" +
                 "Select Cancel to continue with this registration.")) {
         // Unique no
         top.content.UpdateForm.emexp001.value=ReturnValue[0]
         return true;
      }
    }
  }
  return false;
}
function UpdateSex(){
  if (!isWhitespace(document.UpdateForm.emvis118.value)) {
    UpdateForm.emexp004.value=UpdateForm.selsex.value.substr(0,1);
    if (UpdateForm.selsex.value.substr(0,1)=="R") {
      UpdateForm.d_emexp004.value="Intersex"
    }
    if (UpdateForm.selsex.value.substr(0,1)=="U") {
      UpdateForm.d_emexp004.value="Unknown"
    }
    if (UpdateForm.selsex.value.substr(0,1)=="I") {
      UpdateForm.d_emexp004.value="Indeterminate"
    }
    if (UpdateForm.selsex.value.substr(0,1)=="M") {
      UpdateForm.d_emexp004.value="Male"
    }
    if (UpdateForm.selsex.value.substr(0,1)=="F") {
      UpdateForm.d_emexp004.value="Female"
    }
  } else {

    for (var i =0 ; i < document.UpdateForm.emexp004.length; i++) 
    {
      if (UpdateForm.emexp004.options[i].value == 
          UpdateForm.selsex.value.substr(0,1)) {
        document.UpdateForm.emexp004.selectedIndex=i 
      } 
    }
  }
}
function PatientReturn(x) {

  dispHydro();

  if (isWhitespace(UpdateForm.emvis118.value)) { 
    if (x==1) {
      setPatientFields();
    }
    return;;
  }

  setPatientFields();

  validateUrMerge(8,
               UpdateForm.emvis118,
               UpdateForm.gname,
               UpdateForm.selsex,
               UpdateForm.emexp005,
               UpdateForm.deceased,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.gname,
               UpdateForm.sname);
//
  if (UpdateForm.deceased.value=="1") {
    alert("Patient Deceased")
    UpdateForm.emvis111.value="";
    UpdateForm.emvis112.value="";
    UpdateForm.gname.value="";
    UpdateForm.selsex.value="";
    UpdateForm.emvis118.value="";
    UpdateForm.emexp005.value="";
    dispHydro();
    return; 
  }
//
  if (x==1) {
    if(!CheckEmrVisit(UpdateForm.emvis118.value)) {
      UpdateForm.emvis111.value="";
      UpdateForm.gname.value="";
      UpdateForm.sname.value="";
      UpdateForm.selsex.value="";
      UpdateForm.emvis112.value="";
      if (isWhitespace(document.UpdateForm.emvis118.value)) {
        UpdateForm.emexp004.value="";
        UpdateForm.d_emexp004.value="";
      } else {
        UpdateForm.emexp004.selectedIndex=0;
      }
      UpdateForm.emvis118.value="";
      UpdateForm.emvis118.focus();
      UpdateForm.emexp005.value="";
      dispHydro();
      return;
    }
  }
//
  UpdateForm.emvis111.value=UpdateForm.gname.value.replace(/,/g,"")
  UpdateForm.emvis112.value=UpdateForm.sname.value.replace(/,/g,"")
  if(isWhitespace(UpdateForm.emvis111.value)){
    UpdateForm.emvis118.focus();
    UpdateForm.emvis118.value=" ";
  }
  UpdateSex();
  defaultDisasterCode();
}
function checkReferred() {
  i=document.UpdateForm.emvis061.selectedIndex;
  ind=document.UpdateForm.emvis061.options[i].value.substr(5,1)
  if(ind=="1") {
    TranSrcHeading.innerHTML=transferhd.innerHTML;
    TranSrc.innerHTML=transfersrc.innerHTML;
    validateCode(9,document.UpdateForm.emvis032,
                   document.UpdateForm.trnsfsrc);
  } else {
    TranSrc.innerHTML=transferblank.innerHTML;
    TranSrcHeading.innerHTML="";
  }
  if(ind=="2") {
    if(document.UpdateForm.emvis019!=undefined){
      document.UpdateForm.emvis019.className="Mandatory";}
  }
}
function CheckAmbType() {
  if(document.UpdateForm.emvis013.value.substr(3,1)=="A") {
    document.UpdateForm.emvis034.readOnly=false;
    if(document.UpdateForm.emvis013.value.substr(4,1)=="N") {
      document.UpdateForm.emvis034.className="";
    } else {
      document.UpdateForm.emvis034.className="Mandatory";
    }
  } else {
    document.UpdateForm.emvis034.className="ReadOnly";
    document.UpdateForm.emvis034.readOnly=true;
  }
}
function SetAmbCaseNo() {
  // clear Amb Case No. if Arrival Transport not type Ambulance
  if (document.UpdateForm.emvis013.value.substr(3,1)!="A") {
    document.UpdateForm.emvis034.value="";
  }
}
/*
function LookupCleanup()
{
  var txtSearch = document.getElementById('prescomf');
  if (txtSearch == undefined) return;

  txtSearch.value = ""; // clear search field value
  txtSearch.className = "";
}
*/
function getExpAdvConCookie(){
//  if (GetCookieData("ExpAdvConCookie")!="unknown") {
    document.getElementById("eacindct").value="1";
//    ExpireCookiePath("ExpAdvConCookie");
//  }
}
function getEACTrgCookie() {
  if (GetCookieData("EACTrgCookie")!="unknown") {
    document.getElementById("eacregck").value=GetCookieData("EACTrgCookie");
    ExpireCookiePath("EACTrgCookie");
  }
}
//-----------------------------------------------------------------
// Function to check age and display hydration fields for children
//-----------------------------------------------------------------
function dispHydro(){
  if(checkDate(document.UpdateForm.emexp005)){
    date1=document.UpdateForm.emexp005.value;
    date2=SetDateDDMMMYYYY(document.UpdateForm.currdate.value);
    agedays=(days_between(date1,date2));
    ageyears=(Math.floor(agedays / 365.25));
    if (document.UpdateForm.paedsage.value>=ageyears) {
      PaedsHydroDIV.innerHTML=PaedsHydroSPAN.innerHTML;
      if ((VariableNameExists('PaedsHydro'))&&(PaedsHydro!="")){
        document.getElementById("CapRefillTitleSPAN").innerHTML = PaedsHydro;
        CapRefillTitleDIV.innerHTML=CapRefillTitleSPAN.innerHTML;
        CapRefillDIV.innerHTML=CapRefillSPAN.innerHTML;
      } else {
        CapRefillTitleDIV.innerHTML="";
        CapRefillDIV.innerHTML="";
      }
    } else {
      PaedsHydroDIV.innerHTML="";
      CapRefillTitleDIV.innerHTML="";
      CapRefillDIV.innerHTML="";
    }
  }
}
//-----------------------------------------------------------------
// Function to get Location based on Site ID
//-----------------------------------------------------------------
function RemoteEmrLocation(valdcode,valdrtyp,ReturnSelect) {
  ReturnFunction="" ;
  for (var i=1; i < RemoteEmrLocation.arguments.length; i++) {
    if (typeof(RemoteEmrLocation.arguments[i]) == 'function') {
      ReturnFunction=RemoteEmrLocation.arguments[i];
    }
  }

  var serverURL = "../cgi-bin/emrweb08.pbl?reportno=30" +
                  "&valdcode=" + valdcode.value.replace(/ /g,"+") +
                  "&valdrtyp=" + valdrtyp.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);

  if (returnValue.status==0) {
    ReturnSelect.options.length=0
    ReturnValue=returnValue.return_value.split("|");

    for (var j=0; j < ReturnValue.length; j++) {
      if (!isWhitespace(ReturnValue[j])) {
        SelectValue=ReturnValue[j].split(",");
        ReturnSelect.options[ReturnSelect.options.length]=new Option(SelectValue[1],SelectValue[0]);
      }
    }
  }
}

function SetEmrLocation(valdcode,valdrtyp,ReturnSelect) {
  ReturnFunction="" ;
  for (var i=1; i < SetEmrLocation.arguments.length; i++) {
    if (typeof(SetEmrLocation.arguments[i]) == 'function') {
      ReturnFunction=SetEmrLocation.arguments[i];
    } 
  }

  var serverURL = "../cgi-bin/emrweb08.pbl?reportno=30" +
                  "&valdcode=" + valdcode.value.replace(/ /g,"+") +
                  "&valdrtyp=" + valdrtyp.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);

  if (returnValue.status==0) {
    ReturnSelect.options.length=0
    ReturnValue=returnValue.return_value.split("|");

    for (var j=0; j < ReturnValue.length; j++) {
      if (!isWhitespace(ReturnValue[j])) {
        SelectValue=ReturnValue[j].split(",");
        ReturnSelect.options[ReturnSelect.options.length]=new Option(SelectValue[1],SelectValue[0]);
      }
    }

    var p = document.UpdateForm;
    for (var i =0 ; i < p.emvis006.length; i++) {
      if (p.emvis006.options[i].value == p.d_exploc.value) {
        p.emvis006.options.selectedIndex = i;
        continue;  // terminate current iteration in loop
      }
    }
  }
}

function flagFDV(){
  fdv = document.getElementById('pmsvx122').value;

  if (fdv[5]=='F') {
    document.getElementById('fdvtitle').style.color = "red";
  } else {
    document.getElementById('fdvtitle').style.color = "black";
  }
}

function SubmitForm() {
  f = document.UpdateForm;

  if (!CheckLimits2(f.exptcmnt,999,99900)) {
    return;
  }

  setFormactn();
}
</script>
</head>
%START.OF.PAGE
<body onLoad="PageLoad(event);DisplayDiv();checkReferred();flagFDV();
              defaultDisasterCode();CheckAmbType();
UpCase(document.UpdateForm.emvis118);justifyRight(document.UpdateForm.emvis118);
PatientReturn(0);getExpAdvConCookie();getEACTrgCookie();">
<span class=DFrameTitleBar>
ETS Emergency Triage
</span>

<form name=UpdateForm action="emrweb02.pbl" method=post style="margin:0">
<input type=hidden name=reportno value="02">
<input type=hidden name=template value="013">
<input type=hidden name=formactn>
<input type=hidden name=updttype>
<input type=hidden name=updateky value="">
<input type=hidden name=nextpage value="3">
<input type=hidden name=returnfm value=1>
<input type=hidden name=redirect>
<input type=hidden name=deceased>
<input type=hidden name=selsex>
<input type=hidden name=gname>
<input type=hidden name=sname>
<input type=hidden name=dummy>
<input type=hidden name=dummyadm>
<input type=hidden name=dummsrch value="1">
<input type=hidden name=fpatname>
<input type=hidden name=urnumber>
<input type=hidden name=emvis004>
<input type=hidden name=emvis005>
<input type=hidden name=emvis135>
<input type=hidden name=emvis136>
<input type=hidden name=emvis137>
<input type=hidden name=emvis138>
<input type=hidden name=updfield>
<input type=hidden name=reasonfc>
<input type=hidden name=webuseid>
<input type=hidden name=emexp001 value="%EMRWEB02.02.410">
<input type=hidden name=patsname value="%EMRWEB02.02.411">
<input type=hidden name=patgname value="%EMRWEB02.02.412">
<input type=hidden name=disacode value="%EMRWEB02.02.498">
<input type=hidden name=eacindct id=eacindct value="">
<input type=hidden name=eacregck id=eacregck value="">
<input type=hidden name=currdate value="%STANDARD.01.013">
<input type=hidden name=paedsage id=paedsage value="%EMRWEB02.02.597">
<input type=hidden name=d_catYU id=d_catYU value="%STANDARD.01.017.YU">
<input type=hidden name=valdrtyp value="E">
<input type=hidden name=d_exploc value="%EMRWEB02.02.472">
<input type=hidden name=d_expsit value="%EMRWEB02.02.533">

<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td class=DataLabel width=10%>Site ID</td>
  <td width=20%>
    <select class="Mandatory" name=emvis132 id=emvis132 title="Site ID"
       onchange="RemoteEmrLocation(this,UpdateForm.valdrtyp,
                 UpdateForm.emvis006);">
        <option></option>
        %EMRWEB02.02.185.2
      </select>
  </td>
</tr>
<tr><td class=DataLabel>User Id </td>
    <td><input type=hidden name=securety value="2">
        <input type=hidden name=triguser value="1">
        <input type=text size=12 name=secureid class="Mandatory NoAutoFocus" 
          tabindex=1 title="User ID" value="%STANDARD.01.043">
    Password
      <input type=password size =12 name=securepw class=Mandatory tabindex=1
        title="Password" onfocus="SetCaretPosition('securepw',-1);" 
        onblur="checkPass();">
    </td>
    <td class=DataLabel>U/R 
       <input type=text size=10 maxlength=8 name=emvis118 tabindex=2
       value="%EMRWEB02.02.435" 
       onblur="UpCase(this);justifyRight(this);PatientReturn(1);MandatroyFDV()">
        <img class=Icon src=../images/SearchIcon.gif onclick="PatientSearch();">
    </td>
    <td class=DataLabel>Surname </td>
    <td><input type=text size=25 max=25  name=emvis111 tabindex=3
        value="%EMRWEB02.02.411"></td>
    <td class=DataLabel>Given Name </td>
    <td><input type=text size=25 max=25  name=emvis112 tabindex=4
        value="%EMRWEB02.02.412"></td>
</tr>
<tr><td></td>
    <td></td>
    <td></td>
    <td class=DataLabel>Sex</td>
    <td><div id="sexfieldDIV">
          <select name=emexp004 id=emexp004 class=SelectSml tabindex=5
                  onblur="MandatoryFDV();">
          <option> </option>
          <option value="R">Intersex</option>
          <option value="U">Unknown</option>
          <option value="I">Indeterminate</option>
          <option value="M">Male</option>
          <option value="F">Female</option>
          </select>
        </div>
    </td>
    <td class=DataLabel>Date of Birth </td>
    <td><input type=text size=12 max=11 name=emexp005 id=emexp005 
         value="%EMRWEB02.02.414" tabindex=6
         title="Date of Birth" class="Past Date" onblur="dispHydro();
         MandatoryFDV();">
        <img class=Icon src=../images/DateTimeStamp.gif date=document.UpdateForm.emexp005>
        <img class=Icon src=../images/DateLookup.gif date=document.UpdateForm.emexp005>
        </td></tr>
</table>

<table align=center width=100% border=0 cellspacing=0 cellpadding=1>

<tr valign=top>
    <td class=DataLabel width=10%>Presenting Complaint </td>
    <td width=20%>
      <input type=hidden name=emrviscat value="el">
      <input type="text" size=10 tabindex=7 class="Mandatory"
       value="%EMRWEB02.02.416.0"
       onBlur="DisplayDiv();MandatoryMeth();MandatoryFDV();" name=prescomf
       onfocus="SetCaretPosition('prescomf',-1);"
       onKeyUp="LookupPresComp(event,this,UpdateForm.emvis060,
                UpdateForm.emrviscat);">
     <select name=emvis060 id=emvis060 class="SelectBig Mandatory"
      onchange="DisplayDiv();MandatoryMeth();MandatoryFDV();"
      tabindex=8>
      <option value="%EMRWEB02.02.416.1">%EMRWEB02.02.416.0</option>
     </select>
     <img class=Icon src=../images/SelectLink.gif
      title="Presenting Complaint Lookup"
      onclick="LookupPage(UpdateForm.prescomf,UpdateForm.emvis060,
              'Lookup_EDPC0000_000',prescomf);">
    </td>
    <td colspan=4>
    <textarea name=prcom001 wrap=hard tabindex=9 
     onkeydown="LimitText(this,6,300);"
     cols=50 rows=2></textarea>
    </td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
</tr>

</table>

<div id=Triage></div>

<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td width=10% class=DataLabel>Location</td>
    <td width=20%>
      <input type=hidden name=name_emvis006 title="Location">
      <select class="Mandatory" name="emvis006" title="Location" tabindex=10
         onchange="validateLocation(UpdateForm.emvis006,
                                    UpdateForm.name_emvis006);">
      </select>
    </td>
    <td width=10>Accompanying&nbsp;Person</td>
    <td width=25><input type=text name=emvis038 size=50 maxlength=50 tabindex=11
         title="Accompanying Person"></td>
    <td width=10%>Attendance Type</td>
    <td width=20%><select class="SelectMed" name=emvis053 tabindex=11
         title="Attendance Type">
     <option></option>
     %EMRWEB02.02.213.2
     </select></td>
    <td width=5%>&nbsp;</td>
</tr>

<tr><td class=DataLabel>Arrival Transport</td>
    <td>
      <select name=emvis013 tabindex=11 class="Mandatory SelectMed"
        title="Arrival Transport"
        onchange="document.UpdateForm.emvis034.disabled=0;CheckAmbType();SetAmbCaseNo();">
        <option></option>
        %EMRWEB02.02.423.2
      </select>
    </td>
    <td class=DataLabel>Amb Case No</td>
    <td><input type=text size=20 maxlength=15 name=emvis034 tabindex=12
         onFocus="CheckAmbType();" value="%EMRWEB02.02.469"
         title="Amb Case No"></td>
    <td class=DataLabel>Attendance Source</td>
    <td>
      <select class="Mandatory SelectMed" name=emvis061 tabindex=13
        title="Attendance Source" onchange="checkReferred();">
        <option></option>
        %EMRWEB02.02.462.2
      </select>
    </td>
</tr>

<tr><td></td>
    <td></td>
    <td></td>
    <td></td>
    <td width=5% class=DataLabel><span id=TranSrcHeading></span></td>
    <td width=20%><span id=TranSrc></span></td>
</tr>

<tr><td class=DataLabel>%STANDARD.01.017.eh</td>
    <td><select name=emvis056 tabindex=24 title="%STANDARD.01.017.eh"
         class="SelectBig">
        <option></option>
        %EMRWEB02.02.216.2
        </select></td>
    <td class=DataLabel>Disaster Code</td>
    <td><select name=dispt001 title="Disaster Code"
         onchange="displayDisasterID();" tabindex=25>
        <option></option>
        %EMRWEB02.02.497
        </select>
    </td>
    <td class=DataLabel><div id=disasteridnumbertitleDIV></div></td>
    <td><div id=disasteridnumberDIV></div></td>
    </tr>
</table>

<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr>
    <td class=DataLabel valign=top width=10%><br>Expected Patient Notes</td>
    <td rowspan=3>
      <textarea wrap=hard name=exptcmnt id=exptcmnt tabindex=29
       style="overflow-y:scroll"
       rows=10 cols=104>%EMRWEB02.02.943.001</textarea>
    </td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
</tr>
</table>

<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td colspan=10 class=HeadingCell align=center >
      Primary Assessment</td></tr>

<tr><td class=DataLabel width=10%>%STANDARD.01.017.A1</td>
    <td width=20%><select name=emvis041 title="%STANDARD.01.017.A1"
         class="SelectBig" tabindex=30>
        <option></option>
        %EMRWEB02.02.201.2
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.A5</td>
    <td><select name=emvis045 title="%STANDARD.01.017.A5"
         class="SelectBig" tabindex=35>
        <option></option>
        %EMRWEB02.02.205.2
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.ef</td>
    <td><select name=emvis054 title="%STANDARD.01.017.ef"
         class="SelectBig" tabindex=38>
        <option></option>
        %EMRWEB02.02.214.2
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.ei</td>
    <td><select name=emvis057 title="%STANDARD.01.017.ei"
         class="SelectBig" tabindex=40>
        <option></option>
        %EMRWEB02.02.217.2
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.eo</td>
    <td><select name=emvis063 title="%STANDARD.01.017.eo"
         class="SelectBig" tabindex=42>
        <option></option>
        %EMRWEB02.02.223.2
        </select>
    </td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.A2</td>
    <td><select name=emvis042 title="%STANDARD.01.017.A2"
         class="SelectBig" tabindex=31>
        <option></option>
        %EMRWEB02.02.202.2
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.A6</td>
    <td><select name=emvis046 title="%STANDARD.01.017.A6"
         class="SelectBig" tabindex=36>
        <option></option>
        %EMRWEB02.02.206.2
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.eg</td>
    <td><select name=emvis055 title="%STANDARD.01.017.eg"
         class="SelectBig" tabindex=39>
        <option></option>
        %EMRWEB02.02.215.2
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.ek</td>
    <td><select name=emvis059 title="%STANDARD.01.017.ek"
         class="SelectBig" tabindex=41>
        <option></option>
        %EMRWEB02.02.219.2
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.ep</td>
    <td><select name=emvis064 title="%STANDARD.01.017.ep"
         class="SelectBig" tabindex=43>
        <option></option>
        %EMRWEB02.02.224.2
        </select>
    </td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.A3</td>
    <td><select name=emvis043 title="%STANDARD.01.017.A3"
         class="SelectBig" tabindex=32>
        <option></option>
        %EMRWEB02.02.203.2
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.A7</td>
    <td><select name=emvis047 title="%STANDARD.01.017.A7"
         class="SelectBig" tabindex=37>
        <option></option>
        %EMRWEB02.02.207.2
        </select>
    </td>
    <td class=DataLabel></td>
    <td></td>
    <td class=DataLabel></td>
    <td></td>
    <td class=DataLabel></td>
    <td></td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.A4</td>
    <td><select name=emvis044 title="%STANDARD.01.017.A4"
         class="SelectBig" tabindex=33>
        <option></option>
        %EMRWEB02.02.204.2
        </select>
    </td>
    <td class=DataLabel></td>
    <td></td>
    <td class=DataLabel></td>
    <td></td>
    <td class=DataLabel></td>
    <td></td>
    <td class=DataLabel></td>
    <td></td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.eq</td>
    <td><select name=emvis065 title="%STANDARD.01.017.eq"
         class="SelectBig" tabindex=34>
        <option></option>
        %EMRWEB02.02.225.2
        </select>
    </td>
    <td class=DataLabel></td>
    <td></td>
    <td class=DataLabel></td>
    <td></td>
    <td class=DataLabel></td>
    <td></td>
    <td class=DataLabel></td>
    <td></td>
    </tr>
</table>

<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td colspan=7 class=HeadingCell align=center >
      Trauma Team Criteria</td></tr>
<tr><td class=DataLabel valign=top width=10%>%STANDARD.01.017.E4</td>
    <td valign=top width=20%>
    <div class='CheckBoxCombo' style='height:105;width:250px;'>
    %EMRWEB02.02.528.01.E4.2
    </div>
    </td>
    <td class=DataLabel valign=top width=10%>%STANDARD.01.017.E5</td>
    <td valign=top width=25%>
    <div class='CheckBoxCombo' style='height:105;width:250px;'>
    %EMRWEB02.02.528.01.E5.2
    </div>
    </td>
    <td valign=top width=15%>
    <table align=center width=100% border=0 cellspacing=0 cellpadding=1>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.E6</td>
    <td valign=top>
    %EMRWEB02.02.528.01.E6.3
    </td>
    </tr>

    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.E7</td>
    <td valign=top>
    %EMRWEB02.02.528.01.E7.3
    </td>
    </tr>

    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.E8</td>
    <td valign=top>
    %EMRWEB02.02.528.01.E8.3
    </td>
    </tr>
    </table>
    </td>
    <td width=20%>&nbsp;</td>
<tr>
</table>

<div id=PaedsHydroDIV></div>

<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr>
<td valign=top width=20%>
<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr valign=top>
<td class=DataLabel width=50%><div id=CapRefillTitleDIV></div></td>
<td valign=top><div id=CapRefillDIV></div></td>
</tr>
</table>
</td>
<td width=20%>&nbsp;</td>
<td width=20%>&nbsp;</td>
<td width=20%>&nbsp;</td>
<td width=20%>&nbsp;</td>
</tr>
</table>

<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td colspan=8 class=HeadingCell align=center >
      Other Details </td></tr>

<tr><td class=DataLabel>Weight (Kg)</td>
    <td><input type=text name=pmsvx045 size=8 maxlength=6 tabindex=80
         value="" min=0 title="Weight" class="Number">
    </td>
    <td class=DataLabel>%STANDARD.01.017.en</td>
    <td><select name="emvis062" tabindex=81 class="Mandatory"
         title="%STANDARD.01.017.en">
    <option></option>
    %EMRWEB02.02.222.6.1
    </select>
    </td>
    <td class=DataLabel>Analgesia Taken</td>
    <td><input type="text" name=emvis076 size="12" tabindex=82
    class="BackDate" title="Analgesia Taken Date">
    <img notab src=../images/DateLookup.gif class=Icon 
     onclick="DateLookupFrame(UpdateForm.emvis076);">
    <input type="text" name=emvis086 size="8" tabindex=83
    class='Time' title="Analgesia Taken Time">
    <img notab src=../images/DateTimeStamp.gif class=Icon
    onclick="SetCurrentDateTime(UpdateForm.emvis076,UpdateForm.emvis086);">
    <img notab src=../images/TimeLookup.gif class=Icon
    onclick="TimeLookupFrame(UpdateForm.emvis086);">
    </td>
    <td class=DataLabel>%STANDARD.01.017.et</td>
    <td><select name=emvis068 title="%STANDARD.01.017.et"
     class="SelectBig" tabindex=85>
     <option></option>
     %EMRWEB02.02.228.2
     </select>
     </td>
     </tr>

<tr><td class=DataLabel>%STANDARD.01.017.er</td>
    <td>
    <select name=emvis066 title="%STANDARD.01.017.er"
     class="SelectBig" tabindex=86>
    <option></option>
     %EMRWEB02.02.226.2
    </select>
    </td>
    <td class=DataLabel>Date Last Ate</td>
    <td><input type="text" name=emvis077 size="12" tabindex=87
    class="BackDate" title="Date Last Ate">
    <img notab src=../images/DateLookup.gif class=Icon 
     onclick="DateLookupFrame(UpdateForm.emvis077);">
    <input type="text" name=emvis087 size="8" tabindex=88
    class='Time' title="Time Last Ate">
    <img notab src=../images/DateTimeStamp.gif class=Icon
    onclick="SetCurrentDateTime(UpdateForm.emvis077,UpdateForm.emvis087);">
    <img notab src=../images/TimeLookup.gif class=Icon
    onclick="TimeLookupFrame(UpdateForm.emvis087);">
    </td>
    <td class=DataLabel>Analgesia Declined</td>
    <td><input type="checkbox" name="emvis091" value="1" tabindex=84>
    </td>
    <td class=DataLabel>%STANDARD.01.017.es</td>
    <td>
    <select name=emvis067 title="%STANDARD.01.017.es"
     class="SelectBig" tabindex=91>
    <option></option>
     %EMRWEB02.02.227.2
    </select>
    </td>
     </tr>

<tr><td></td>
    <td>
    </td>
    <td class=DataLabel>Date Last Drank</td>
    <td><input type="text" name=emvis078 size="12" tabindex=89
    class="BackDate" title="Date Last Drank">
    <img notab src=../images/DateLookup.gif
    class=Icon onclick="DateLookupFrame(UpdateForm.emvis078);">
    <input type="text" name=emvis088 size="8" tabindex=90
    class='Time' title="Time Last Drank">
    <img notab src=../images/DateTimeStamp.gif class=Icon
    onclick="SetCurrentDateTime(UpdateForm.emvis078,UpdateForm.emvis088);">
    <img notab src=../images/TimeLookup.gif class=Icon
    onclick="TimeLookupFrame(UpdateForm.emvis088);">
    </td>
    <td>Drug / Alcohol Related</td>
    <td>
      <table align=center width=100% border=0>
       <tr>
        <td>
         <select name=emvis096 id=emvis096 title="Drug / Alcohol Related"
          tabindex=91 onchange="MandatoryMeth();">
          <option value="2">Unknown</option>
          <option value="0">No</option>
          <option value="1">Yes</option>
         </select>
        </td>
        <td id="fdvtitle">FDV Related?<td>
        <td>
         <select name=pmsvx122 id=pmsvx122 title="FDV Related?"
          class="Select200" tabindex=91 onchange="setAuditField();flagFDV();">
          <option></option>
            %EMRWEB02.02.599.008.9.5
         </select>
        </td>
       </tr>
      </table>
    </td>
    <td class=DataLabel>%STANDARD.01.017.ev</td>
    <td>
    <select name=emvis070 title="%STANDARD.01.017.ev"
     class="SelectBig" tabindex=92>
    <option></option>
     %EMRWEB02.02.230.2
    </select>
    </td>
    </tr>

<tr><td class=DataLabel>Triage Date</td>
    <td colspan=3>
    <input type="text" name=emvis128 size="12" tabindex=93
    class="Mandatory BackDate" title="Triage Date"
    value="%STANDARD.01.015">
    <img notab src=../images/DateLookup.gif border=0 hspace=4
    class=Icon onclick="DateLookupFrame(UpdateForm.emvis128);">
    <input type="text" name=emvis129 size="8" tabindex=94
    class='Mandatory Time' title="Triage Time"
    value="%STANDARD.01.016">
    <img notab src=../images/DateTimeStamp.gif class=Icon
    onclick="SetCurrentDateTime(UpdateForm.emvis128,UpdateForm.emvis129);">
    <img notab src=../images/TimeLookup.gif class=Icon
    onclick="TimeLookupFrame(UpdateForm.emvis129);"></td>
    <td class=DataLabel>%STANDARD.01.017.YU</td>
    <td class=DataField>%EMRWEB02.02.528.01.YU.9.1</td>
    <td class=DataLabel>Inform GP</td>
    <td><select name=pmsvx010 title="Inform GP" class="Mandatory" tabindex=95>
    <option></option>
    <option value="0">No</option>
    <option value="1">Yes</option>
    <option value="2">Unknown</option>
    </select></td>
    </tr>

<tr><td class=DataLabel>Triage Category</td>
    <td colspan=5><table border=0 cellspacing=0>
    <tr>
    <td class=Triage1><i>1</i>
    <input type=radio name=emvis003 value=1 tabindex=95 title="Triage Category"
    onclick="CheckMan();"></td>
    <td class=Triage2><i>2</i><input type=radio name=emvis003 value=2
    tabindex=95 onclick="unCheck();"></td>
    <td class=Triage3><i>3</i><input type=radio name=emvis003 value=3
    tabindex=95 onclick="unCheck();"></td>
    <td class=Triage4><i>4</i><input type=radio name=emvis003 value=4
    tabindex=95 onclick="unCheck();"></td>
    <td class=Triage5><i>5</i><input type=radio name=emvis003 value=5
    tabindex=95 onclick="unCheck();"></td>
    </tr></table></td>
    <td class=DataLabel>Print Labels and Forms</td>
    <td><input type="checkbox" name="LabForCB" value="1" tabindex=96
         checked>
    </td>
    </tr>

<tr><td colspan=8 align=center>
    <input type=button value="Add" class="button" tabindex=101 id="Addvisitid"
     onclick="setRedirectWA();
              if (document.UpdateForm.LabForCB.checked==true) {
                SetCookie('TriageLabelsFormsCookie','1');
              }  
              tempDisable(this);SubmitForm();">
    <input type=button value="Cancel" class="button" tabindex=102
     onclick="CancelLink();" onblur="SetFieldFocus('secureid');">
    </td></tr>
</table>
</form>

<form name=LinkForm action="emrweb02.pbl" method=get>
<input type=hidden name=reportno value="02">
<input type=hidden name=template value="011">
<input type=hidden name=formactn value="SP">
<input type=hidden name=emexp001>
</form>

<span id=transferhd style="display:none">
Transfer Source
</span>

<span id=transferblank style="display:none">
   <input type=hidden name=emvis032 value="" notab>
</span>

<span id=transfersrc style="display:none">
    <input type="text" size=8 maxlength=6 name="emvis032" tabindex=19
     title="Transfer Source" class=Mandatory value="%EMRWEB02.02.594"
     onchange='validateCode(9,UpdateForm.emvis032,UpdateForm.trnsfsrc);'>
     <input type=text size=25 name=trnsfsrc readonly notab>
     <img class=Icon src="../images/SearchIcon.gif" notab
     onclick=" TransferSourceFrame(UpdateForm.emvis032,UpdateForm.trnsfsrc)">
</span>

<span id=EmergencyProc style="display:none;">
<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td class=DataLabel width=10%>Place Where Injury Occurred</td>
    <td width=20%><select name="emvis021" class=SelectBig tabindex=15
         title="Place Where Injury Occurred">
    <option></option>
    %EMRWEB02.02.121.2
     </select>
    </td>
    <td class=DataLabel width=10%>Activity When Injured</td>
    <td width=25%>
      <select name="injur006" class=SelectBig title="Activity When Injured"
         tabindex=16>
    <option></option>
      %EMRWEB02.02.183.2
       </select>
    </td>
    <td class=DataLabel width=10>Injury Cause</td>
    <td width=20%><select name="injur004" class=SelectBig title="Injury Cause"
         tabindex=17>
    <option></option>
     %EMRWEB02.02.181.2
     </select>
    </td>
    <td width=5%>&nbsp;</td>
</tr>

<tr valign=top><td class=DataLabel> Human Intent</td>
    <td><select name="injur005" class=SelectBig title="Human Intent"
         tabindex=18>
    <option></option>
     %EMRWEB02.02.182.2
      </select>
    </td>
    <td class=DataLabel>
    Desc. of Injury Event</td>
    <td colspan=3><input type="text" name="injur002" maxlength="50" size="40"
         title="Description of Injury Event" value="" tabindex=19>
    <input type="text" name="injur003" maxlength="50" size="40" value=""
     tabindex=20>
    </td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
</tr>
</table>
</span>

<span id=disasteridnumbertitleSPAN style="display:none">
Disaster Identification #
</span>

<span id=disasteridnumberSPAN style="display:none">
<input type="text" name=dispt002 size=20 maxlength=19 tabindex=26
   title="Disaster Identification Number">
</span>

<script type="text/javascript">
function init(){
for (var i =0 ; i < document.UpdateForm.emexp004.length; i++) {
if  (document.UpdateForm.emexp004.options[i].value== "%EMRWEB02.02.413") {
       document.UpdateForm.emexp004.selectedIndex=i }
 }
var str1= trim("%EMRWEB02.02.417");
    if(!isWhitespace(str1)) { str1+="\n"} 
var str2= trim("%EMRWEB02.02.418");
    if(!isWhitespace(str2)) { str2+="\n"}
var str3= trim("%EMRWEB02.02.419");
    if(!isWhitespace(str3)) { str3+="\n"}
var str4= trim("%EMRWEB02.02.420");
    if(!isWhitespace(str4)) { str4+="\n"}
var str5= trim("%EMRWEB02.02.421");
    if(!isWhitespace(str5)) { str5+="\n"}
var str6= trim("%EMRWEB02.02.422");
UpdateForm.prcom001.value=str1+str2+str3+str4+str5+str6
var ExpectedLocation="%EMRWEB02.02.472"
if(!isWhitespace(ExpectedLocation)) {
  validateLocation(document.UpdateForm.emvis006,document.UpdateForm.name_emvis006);
}
   if(!CheckEmrVisit(UpdateForm.emvis118.value)) {
       UpdateForm.emvis111.value="";
       UpdateForm.gname.value="";
       UpdateForm.sname.value="";
       UpdateForm.selsex.value="";
       UpdateForm.emvis112.value="";
       UpdateForm.emexp004.selectedIndex=0;
       UpdateForm.emvis118.value="";
       UpdateForm.emvis118.focus();
       UpdateForm.emexp005.value="";
       dispHydro();
       return;
   }
}
function DisplayDiv() {
Indicator=document.UpdateForm.emvis060.value.substr(13,1);
  if (Indicator=="I") {
     document.all.Triage.style.display="";
     document.all.Triage.innerHTML=document.all.EmergencyProc.innerHTML;
     }
  else {
     document.all.Triage.style.display="none";
     document.all.Triage.innerHTML="";}
}
//
  var trauma=document.getElementsByName('vscdcode');
  for (var i = 0; i < trauma.length; i++) {
       if(trauma[i].value.substr(0,4) == "01E4") {
          trauma[i].tabIndex="60";
       }
       if(trauma[i].value.substr(0,4) == "01E5") {
          trauma[i].tabIndex="61";
       }
       if(trauma[i].value.substr(0,4) == "01nl") {
          trauma[i].tabIndex="69";
       }
       if(trauma[i].value.substr(0,4) == "01nm") {
          trauma[i].tabIndex="70";
       }
       if(trauma[i].value.substr(0,4) == "01nn") {
          trauma[i].tabIndex="71";
       }
       if(trauma[i].value.substr(0,4) == "01no") {
          trauma[i].tabIndex="72";
       }
       if(trauma[i].value.substr(0,4) == "01np") {
          trauma[i].tabIndex="73";
       }
       if(trauma[i].value.substr(0,4) == "01nq") {
          trauma[i].tabIndex="74";
       }
       if(trauma[i].value.substr(0,4) == "01nr") {
          trauma[i].tabIndex="75";
       }
       if(trauma[i].value.substr(0,4) == "01ns") {
          trauma[i].tabIndex="76";
       }
       if(trauma[i].value.substr(0,4) == "01nt") {
          trauma[i].tabIndex="77";
       }
       if(trauma[i].value.substr(0,4) == "01nu") {
          trauma[i].tabIndex="78";
       }
  }
  document.getElementById('S01E6').tabIndex="62";
  document.getElementById('S01E7').tabIndex="63";
  document.getElementById('S01E8').tabIndex="64";
  if(document.getElementById('S01YU')) {
    document.getElementById('S01YU').tabIndex="91";
    document.getElementById('S01YU').onchange=MandatoryMeth;
  }
function MandatoryMeth() {
  if(!document.getElementById('S01YU')) {
    return;
  }
  if(document.UpdateForm.emvis096.value=="1" ||
     document.UpdateForm.emvis060.value.substr(3,1)=="M") {
    document.getElementById('S01YU').className="Mandatory";
  } else {
    document.getElementById('S01YU').className="";
  }
  if(document.getElementById('S01YU').value.substr(7,1)=="2") {
    document.UpdateForm.emvis096.selectedIndex=2;
    document.getElementById('S01YU').className="Mandatory";
  }
}
</script>


<span id=sexfieldSPAN1 style="display:none;">
<input type=text size=15 max=20 name=d_emexp004 id=emexp004 tabindex=6 
       class='readOnly' readOnly>
<input type=hidden name=emexp004>
</span>

<span id=sexfieldSPAN2 style="display:none;">
  <select name=emexp004 class=SelectSml tabindex=6>
    <option value=" "></option>
    <option value="U">Unknown</option>
    <option value="R">Intersex</option>
    <option value="I">Indeterminate</option>
    <option value="M">Male</option>
    <option value="F">Female</option>
  </select>
</span>

<span id=PaedsHydroSPAN style="display:none">
<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td colspan=7 class=HeadingCell align=center >
      Paediatric Hydration</td></tr>
<tr>
    <td valign=top width=20%>
    <table align=center width=100% border=0 cellspacing=0 cellpadding=1>
    <tr>
    <td class=DataLabel valign=top width=50%>%STANDARD.01.017.nl</td>
    <td valign=top>
    %EMRWEB02.02.528.01.nl.3
    </td>
    </tr>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.nm</td>
    <td valign=top>
    %EMRWEB02.02.528.01.nm.3
    </td>
    </tr>
    </table>
    </td>

    <td valign=top width=20%>
    <table align=center width=100% border=0 cellspacing=0 cellpadding=1>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.nn</td>
    <td valign=top>
    %EMRWEB02.02.528.01.nn.3
    </td>
    </tr>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.no</td>
    <td valign=top>
    %EMRWEB02.02.528.01.no.3
    </td>
    </tr>
    </table>
    </td>

    <td valign=top width=20%>
    <table align=center width=100% border=0 cellspacing=0 cellpadding=1>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.np</td>
    <td valign=top>
    %EMRWEB02.02.528.01.np.3
    </td>
    </tr>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.nq</td>
    <td valign=top>
    %EMRWEB02.02.528.01.nq.3
    </td>
    </tr>
    </table>
    </td>

    <td valign=top width=20%>
    <table align=center width=100% border=0 cellspacing=0 cellpadding=1>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.nr</td>
    <td valign=top>
    %EMRWEB02.02.528.01.nr.3
    </td>
    </tr>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.ns</td>
    <td valign=top>
    %EMRWEB02.02.528.01.ns.3
    </td>
    </tr>
    </table>
    </td>

    <td valign=top width=20%>
    <table align=center width=100% border=0 cellspacing=0 cellpadding=1>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.nt</td>
    <td valign=top>
    %EMRWEB02.02.528.01.nt.3
    </td>
    </tr>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.nu</td>
    <td valign=top>
    %EMRWEB02.02.528.01.nu.3
    </td>
    </tr>
    </table>
    </td>
</tr>
</table>
</span>

<span id=CapRefillTitleSPAN style="display:none">
Cap Refill Time
</span>

<span id=CapRefillSPAN style="display:none">
  <input type=text name=emvis102 size=2 maxlength=2 tabindex=79
         value="0" min=0 max=60 class="Integer">
</span>

<script type="text/javascript">
var p=document.UpdateForm;

// Select the Site ID passed through from Expected Patients List
for (var i =0 ; i < p.emvis132.length; i++) {
  if (p.emvis132.options[i].value == p.d_expsit.value) {
    p.emvis132.options.selectedIndex = i;
    SetEmrLocation(p.emvis132,p.valdrtyp,p.emvis006);
    continue;  // terminate current iteration in loop
  }
}
</script>
