<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script language="javascript" src="../js/allweb02.js"></script>
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientTypeClinic.js"></script>
<script type="text/javascript">
function defaultDisasterCode() {
  if (!isWhitespace(document.UpdateForm.disacode.value)) {
    disastercodeDIV.innerHTML=disastercodeSPAN2.innerHTML;
  } else {
    disastercodeDIV.innerHTML=disastercodeSPAN1.innerHTML;
  }

  displayDisasterID();
}

function displayDisasterID() {
  p = document.UpdateForm;

  if (!isWhitespace(p.dispt001.value)) {
    disasteridnumbertitleDIV.innerHTML=disasteridnumbertitleSPAN.innerHTML;
    disasteridnumberDIV.innerHTML=disasteridnumberSPAN.innerHTML;
  } else {
    disasteridnumbertitleDIV.innerHTML="";
    disasteridnumberDIV.innerHTML="";
  }

  if (!isWhitespace(disasteridnumberDIV.innerHTML)) {
    var serverURL   = "../cgi-bin/patweb80.pbl?reportno=98" +
                    "&valdcode=" + UpdateForm.urnumber.value.replace(/ /g,"+") +
                    UpdateForm.dispt001.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|");
      if (!isWhitespace(ReturnValue[0])) {
        p.dispt002.value=ReturnValue;
        p.dispt002.className="Readonly";
        p.dispt002.readOnly=true;
      }
    }
  }
}

function SetReadOnlyClinicType() {
  p = UpdateForm;
  ddlPrefSite = document.getElementById('alref119');
  ddlClinicType = document.getElementById('alref106');

  DeptClinicType(p.deptcode,ddlPrefSite,ddlClinicType,p.defctype);

  window.setTimeout(function () {
    document.getElementById('d_clityp').value = 
      ddlClinicType.options[ddlClinicType.selectedIndex].text;

    SetTypeClinic(p.alref120,p.deftclid.value,ddlPrefSite.value,ddlClinicType.value);
  }, 500);
}

function SetSite() {
  if (IsEReferral()) { 
    SetReadOnlyClinicType();
    return;
  }

  p = UpdateForm;
  ddlPrefSite = document.getElementById('alref119');
  
  var SetSite;
  if(isWhitespace(ddlPrefSite.value)) {
    SetSite = p.wbsesite.value;
  } else {
    SetSite = ddlPrefSite.value;
  }

  for (var i=0; i < ddlPrefSite.length; i++) {
    if (ddlPrefSite.options[i].value==SetSite.substr(0,6)) {
      ddlPrefSite.selectedIndex=i;
    } 
  }
  SetClinicType();
}

function SetClinicType() {
  p = UpdateForm;
  ddlPrefSite = document.getElementById('alref119');
  ddlClinicType = document.getElementById('alref106');
  ddlClinicType.options.length = 1;
  DeptClinicType(p.deptcode,ddlPrefSite,ddlClinicType,p.defctype);
  SetClinicId();
}

function SetClinicId() {
  p = UpdateForm;
  ddlPrefSite = document.getElementById('alref119');
  ddlClinicType = document.getElementById('alref106');
  p.alref120.options.length = 1;
  SetTypeClinic(p.alref120,p.deftclid.value,ddlPrefSite.value,ddlClinicType.value);
}

function UpdateReferral() {
  if (!isWhitespace(document.UpdateForm.dispt001.value)) {
    var serverURL   = "../cgi-bin/comweb80.pbl?reportno=44" +
                    "&valdcode=" + UpdateForm.dispt001.value.replace(/ /g,"+") +
                    UpdateForm.d_alref019.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) {
      return;
    }
  }

  if(UpdateForm.offdutyb!=undefined){
    if(UpdateForm.offdutyb.checked==true){
      alert("Error: Claim Type invalid for 'Off Duty' personnel.")
      return;
    }
  }

  if(document.UpdateForm.d_pmsvx093.checked==true) {
    document.UpdateForm.pmsvx093.value="1";
  } else {
    document.UpdateForm.pmsvx093.value="0";
  }

  if(validateMandatory(UpdateForm)) {
    if(document.UpdateForm.ptcnxcom.value == "1") {
       setRedirectXComUpd(); 
    }
    document.UpdateForm.submit();
  }
}

function EReferralDefaults() {
  var p = document.UpdateForm;

  if (!IsEReferral()) {
    SetDivSpanContent('preferredSiteDIV','preferredSiteSPAN1');
    SetDivSpanContent('referralPriorityDIV','referralPrioritySPAN1');
    SetDivSpanContent('referralSourceDIV','referralSourceSPAN1');
    SetDivSpanContent('clinicTypeDIV','clinicTypeSPAN1');
  }
  else {
    // Disable some fields since it's an eReferral...

    // Preferred Site
    SetDivSpanContent('preferredSiteDIV','preferredSiteSPAN2');

    // Referral Priority
    SetDivSpanContent('referralPriorityDIV','referralPrioritySPAN2');

    // Clinic Type
    SetDivSpanContent('clinicTypeDIV','clinicTypeSPAN2');

    p.d_alref022.readOnly = true;       // Referred By Dr
    p.d_alref022.className = "Readonly";
    p.imgSrchDr.style.display = "none";
    p.imgEraseDr.style.display = "none";

    p.d_alref023.readOnly = true;       // Referred by Practice
    p.d_alref023.className = "Readonly";
    p.imgSrchPrac.style.display = "none";
    p.imgErasePrac.style.display = "none";

    // Source of Referral
    SetDivSpanContent('referralSourceDIV','referralSourceSPAN2');

    p.alref038.readOnly = true;         // Responsible HCP
    p.alref038.className = "Readonly";
    p.imgSrchHCP.style.display = "none";

    p.aleid004.readOnly = true;         // Referred By Other
    p.aleid004.className = "Readonly";
    p.aleid005.readOnly = true;         // Referrer Contact
    p.aleid005.className = "Readonly";
  }
}

function IsEReferral() {
  if (document.UpdateForm.d_aleid002.value == "eReferrals") {
    return true;
  }
  return false;
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);EReferralDefaults();SetSite();showFundingSource();
 defaultDisasterCode();">
<span class=DFrameTitleBar>
<img border=0 align=right src="../images/ExitIcon.gif" onclick="DFrameExit();">
 %ALLWEB02.02.125.0  Referral  </span>
<div id=PageBodySection style="overflow: auto;">
<form name=UpdateForm action="allweb02.pbl" method=post>
<input type=hidden name=reportno value="2">
<input type=hidden name=updatety value="U">
<input type=hidden name=urnumber value="%ALLWEB02.02.003">
<input type=hidden name=admissno value="%ALLWEB02.02.081">
<input type=hidden name=deptcode value="%ALLWEB02.02.125.1">
<input type=hidden name=redirect value="">
<input type=hidden name=nextpage value="">
<input type=hidden name=dummy>
<input type=hidden name=alref083 value="">
<input type=hidden name=wbsesite value="%STANDARD.01.023">
<input type=hidden name=defctype value="%ALLWEB02.02.167.1">
<input type=hidden name=deftclid value="%ALLWEB02.02.188.1">
<input type=hidden name=ptcnxcom value="%STANDARD.01.025.116.222.0.1">
<input type=hidden name=disacode value="%ALLWEB02.02.514">
<input type=hidden name=disadesc value="%ALLWEB02.02.515">
<input type=hidden name=override value="2">
<input type=hidden name=eidexist value="1">
<input type=hidden name=d_extapp value="%ALLWEB02.02.523.002">
<input type=hidden name=ptcnhdps id=ptcnhdps 
       value="%STANDARD.01.025.080.250.1.1">

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td class=DataLabel width=15%>Department Code</td>
    <td width=45%><input type=text size=24 value="%ALLWEB02.02.125.0"
          readonly class="Readonly"></td>
    <td class=DataLabel width=15%>Entered by</td>
    <td><input type=text size=24 name=d_alref000 
         value="%ALLWEB02.02.163" readonly class="Readonly"></td>
</tr>

<tr><td class=DataLabel>Hospital</td>
    <td><input type=hidden name=alref107 value="%ALLWEB02.02.170.0">
        <input type=text size=24 value="%ALLWEB02.02.170.1" readonly 
         class="Readonly">
    </td>
    <td class=DataLabel>Referral Date</td>
    <td><input type=text name=d_alref019 value="%ALLWEB02.02.119" 
         title="Referral Date" readonly class="Readonly Date" size=12></td>
</tr>

<tr><td class=DataLabel>Preferred Site</td>
    <td><div id=preferredSiteDIV></div></td>
    <td class=DataLabel>Referred By Dr</td>
    <td><input type=hidden name=alref022
         value="%ALLWEB02.02.122.1">
        <input type=text size=24 name=d_alref022 readonly title="Referred By Dr"
         value="%ALLWEB02.02.122.0">
        <img src="../images/SearchIcon.gif" class=Icon name=imgSrchDr
         onclick="HCPSearchFrameExpanded(UpdateForm.alref022,
                  UpdateForm.d_alref022,UpdateForm.genpprov,
                  UpdateForm.alref023,UpdateForm.d_alref023,
                  UpdateForm.alref024);">
        <img src="../images/erase.gif" class=Icon name=imgEraseDr
        onclick="clrFields(UpdateForm.alref022,UpdateForm.d_alref022);">
    </td>
</tr>

<tr><td class=DataLabel>Referral Priority</td>
    <td><div id=referralPriorityDIV></div></td>
    <td class=DataLabel>Referred by Practice</td>
    <td><input type=hidden name=alref023
        value="%ALLWEB02.02.123.0">
        <input type=text size=24 readonly name=d_alref023
         value="%ALLWEB02.02.123.1">
        <img src="../images/SearchIcon.gif" class=Icon name=imgSrchPrac
         onclick="GPHCGSearchFrame(UpdateForm.alref022,UpdateForm.d_alref022,
                  UpdateForm.genpprov,UpdateForm.alref023,
                  UpdateForm.d_alref023,UpdateForm.alref024);">
        <img src="../images/erase.gif" class=Icon name=imgErasePrac
         onclick="clrFields(UpdateForm.alref023,UpdateForm.d_alref023,
                  UpdateForm.alref024,UpdateForm.genpprov);">
        <input type=hidden name=alref024
         value="%ALLWEB02.02.124">
        <input type=hidden name=genpprov
         value="">
        </td>
<tr>

<tr><td class=DataLabel>Source of Referral</td>
    <td><div id=referralSourceDIV></div></td>
    <td class=DataLabel>Referred by Other</td>
    <td><input type=text size=55 maxlength=50 value="%ALLWEB02.02.523.004"
         name=aleid004 title="Referred by Other"></td>
</tr>

<tr><td class=DataLabel>Responsible HCP</td>
    <td><input type=text name=alref038 size=10 maxlength=10
         value="%ALLWEB02.02.138.1" title="Responsible HCP"
         onblur="if (checkAlphanumDesc(event,this) != false) {
                   ValidateHCP(18,13,UpdateForm.alref038,
                   UpdateForm.n_alref038);
                 }" >
        <input type=text name=n_alref038 size=35 readonly title="HCP Name"
         value="%ALLWEB02.02.138.0" class=Readonly>
        <img src="../images/SearchIcon.gif" class=Icon name=imgSrchHCP
         onclick="HCPSearchFrame(UpdateForm.alref038,UpdateForm.n_alref038,4);">
    </td>
    <td class=DataLabel style="vertical-align:top">Referrer Contact</td>
    <td class=DataLabel>
      <textarea rows=2 cols=60 name=aleid005 title="Referrer Contact"
        style="font-size:8pt;font-family:Arial;overflow:hidden"
        onkeyup="LimitText(this,1,100);">%ALLWEB02.02.523.005</textarea>
    </td>
</tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td><table cellspacing=0 cellpadding=0>
        <tr><td>
        <select title="%STANDARD.01.017.CL" name=alref035
         class="Mandatory SelectBig" onchange="showFundingSource();">
        <option></option>
         %ALLWEB02.02.135.9.1.10.2.X
        </select>
        </td>
        <td><div id=FundingHeading></div></td>
        <td><div id=FundingId></div></td>
        </table>
    </td>
    <td class=DataLabel>Validity Period</td>
    <td><select name=alref124 title="Validity Period"
         class=Mandatory>
        <option></option>
         %ALLWEB02.02.186.2
        </select>
    </td>
</tr>

<tr><td class=DataLabel>Reason for Referral</td>
    <td><select class="Mandatory selectBig" name=alref028
        Title="Reason for Referral" maxlength=45>
        <option></option>
         %ALLWEB02.02.128.2
        </select></td>
    <td class=DataLabel>Referral Created Date</td>
    <td><input type=text name=alref039 size=12 value="%ALLWEB02.02.139"
         class="Mandatory Date"
         onblur="WAReceivedDate(this,UpdateForm.alref000);" 
         title="Referral Created Date">
        <img src=../images/DateTimeStamp.gif class=Icon alt="Current"
         date=UpdateForm.alref039 time=null>
        <img src=../images/DateLookup.gif class=Icon alt="Show Calendar"
         date=UpdateForm.alref039>
    </td>
</tr>

<tr><td class=DataLabel>Presenting Complaint</td>
    <td><input type=text size=50 maxlength=50 value="%ALLWEB02.02.181"
         name=alref118 title="Presenting Complaint"></td>
    <td class=DataLabel>Referral Entered Date</td>
    <td><input type=text name=alref000 title="Referral Entered Date"
         value="%ALLWEB02.02.161" readonly class="Readonly Date"></td>
</tr>

<tr><td class=DataLabel>Status</td>
    <td><input type=text value="%ALLWEB02.02.103" size=24
         readonly class=Readonly></td>
    <td class=DataLabel>Link to Visit</td>
    <td><input type=text size=10 maxlength=8 class=DataField 
         Title="Link to Visit" name=alref005 value="%ALLWEB02.02.105"
          onblur="justifyRight(this);
                ValidateVisit(UpdateForm.alref005,UpdateForm.urnumber,
                UpdateForm.dummy);">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="VisitSearchFrame(UpdateForm.urnumber,UpdateForm.alref005);" >
    </td>
</tr>

<tr><td class=DataLabel width=15%>Diagnosis 1</td>
    <td width=45%><select name=alref031 class=selectBig maxlength=45
         title="Diagnosis 1">
        <option></option>
         %ALLWEB02.02.131.2
        </select></td>
    <td class=DataLabel>Event Program</td>
    <td><select class="SelectBig" name=alref145 title="Event Program">
        <option></option>
         %ALLWEB02.02.199.016.2
        </select></td>
</tr>

<tr><td class=DataLabel>Diagnosis 2</td>
    <td><select name=alref032 class=selectBig maxlength=45
         title="Diagnosis 2">
        <option></option>
         %ALLWEB02.02.132.2
        </select></td>
    <td class=DataLabel>Clinic Type</td>
    <td><div id=clinicTypeDIV></div></td>
</tr>

<tr><td class=DataLabel>Diagnosis 3</td>
    <td><select name=alref033 class=selectBig maxlength=45
         title="Diagnosis 1">
        <option></option>
         %ALLWEB02.02.133.2
        </select></td>
    <td class=DataLabel>Clinic Id</td>
    <td><select name=alref120 title="Clinic ID" class="SelectBig">
        <option></option>
        </select></td>
</tr>

<tr><td class=DataLabel>Comments 1</td>
    <td><input type=text size=65 maxlength=60 name=alref088 
         value="%ALLWEB02.02.149"></td>
    <td class=DataLabel width=15%>Preferred Date</td>
    <td><input type=text name=alref090 size=12 value="%ALLWEB02.02.151"
         class="Date" title="Preferred Date">
        <img src=../images/DateTimeStamp.gif class=Icon alt="Current"
         date=UpdateForm.alref090 time=null>
        <img src=../images/DateLookup.gif class=Icon alt="Show Calendar"
         date=UpdateForm.alref090>
    </td>
</tr>

<tr><td class=DataLabel>Comments 2</td>
    <td><input type=text size=65 maxlength=60 name=alref089 
         value="%ALLWEB02.02.150">
    </td>
    <td class=DataLabel width=15%>Disaster Code</td><td>
    <div id=disastercodeDIV></div></td>
</tr>

<tr><td class=DataLabel>Interpreter Required</td>
    <td><input type="hidden" name="pmsvx093" value="">
        <input type="checkbox" name="d_pmsvx093" value="1">
        &nbsp;
        <span class="Red">%ALLWEB02.02.086.002.0</span>  
    </td>
    <td class=DataLabel nowrap><div id=disasteridnumbertitleDIV></div></td>
    <td><div id=disasteridnumberDIV></div></td>
</tr>

<tr><td class=DataLabel>External Referral ID</td>
    <td><input type=text size=32 maxlength=30 name=d_alreorig readonly
         class=Readonly title="External Referral ID" 
         value="%ALLWEB02.02.199.028"></td>
    <td class=DataLabel>&nbsp;</td>
    <td>
      <span id=eRefButtons style="display:none">
        <input type=button class="button" value="Booking Instructions"
         style="width:120px" onclick="BookingInstr();">
        <input type=button class="button" value="Link to Referral"
         style="width:120px" onclick="LinkToRef();">
      </span>
    </td>
</tr>

<tr><td class=DataLabel>Referral Application</td>
    <td><input type=text size=55 maxlength=180 name=d_aleid002 readonly
         class=Readonly title="Referral Application" 
         value="%ALLWEB02.02.523.002"></td>
</tr>

<tr><td class=DataLabel style="vertical-align:top">Service</td>
    <td><textarea rows=2 cols=60 name=d_aleid003 title="Service" readonly
         class=Readonly style="font-size:8pt;font-family:Arial;overflow:hidden"
        >%ALLWEB02.02.523.003</textarea>
    </td>
</tr>

<tr><td class=DataLabel colspan=2>Print Update Referral Letter to Patient 
     &nbsp;&nbsp;  
    <input type=checkbox name=prtupdpt
     title="Upd Referral to pat" value="1">
    </td>
    <td class=DataLabel>Printer </td>
    <td><select name=prtpsl03 class="SelectBig">
    %STANDARD.01.001.ALLUPDPT.01
    </select></td></tr>

<tr><td class=DataLabel colspan=2>Print Update Referral Letter to Referrer
      <input type=checkbox name=prtupdrf
       title="Upd Referral to pat" value="1">
      </td>
      <td class=DataLabel>Printer </td>
      <td><select name=prtpsl04 class="SelectBig">
      %STANDARD.01.001.ALLUPDRF.01
      </select></td></tr>

<tr><td class=DataLabel colspan=2>Referral Labels
    <input type=checkbox value="1" name=prtreflb
        onclick="SetPrinter(UpdateForm.prtpno07,UpdateForm.prtpsl07);">
    Copies
    <select name=prtpno07>
        %STANDARD.01.027.2.1
    </select></td>
    <td class=DataLabel>Printer</td>
    <td><select class="SelectBig" name=prtpsl07 title="Printer">
        <option></option>
        %STANDARD.01.001.LABELALL.01
        </select></td></tr>
</table>

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td colspan=4 align=center><br>
    <input type=button value="OK" class="button"
     id="all02sub" onclick="tempDisable(this);UpdateReferral();">
    <input type=button Value="Close" class="button"
     onclick="DFrameClose();">
    </td></tr>
</table>
</form>
</div>

<span id=offdutyhd style="display:none">
&nbsp;Off Duty&nbsp;
</span>

<span id=offdutyid style="display:none">
<input type="checkbox" name="offdutyb" value="0">
</span>

<span id=blanklabel style="display:none">
<input type=hidden name=pmsvx141 value=" ">
</span>

<span id=fundinghd style="display:none">
&nbsp;Funding Source&nbsp;
</span>

<span id=fundingid style="display:none">
<select name=pmsvx141 title="%STANDARD.01.017.cx">
<option> </option>
%ALLWEB02.02.398.053.5
</select>
</span>

<span id=disasteridnumbertitleSPAN style="display:none">
Disaster Identification #
</span>

<span id=disasteridnumberSPAN style="display:none">
<input type="text" name=dispt002 size=20 maxlength=19
   tabindex=19 title="Disaster Identification Number">
</span>

<span id=disastercodeSPAN1 style="display:none">
  <select name=dispt001 tabindex=300 title="Disaster Code"
   onchange="displayDisasterID();">
    <option></option>
    %ALLWEB02.02.513
  </select>
</span>

<span id=disastercodeSPAN2 style="display:none">
<input type="text" name=n_dispt001 size=30 class=Readonly readonly
  title="Disaster Code" value="%ALLWEB02.02.515">
<input type=hidden name=dispt001 value="%ALLWEB02.02.514">
</span>

<span id=preferredSiteSPAN1 style="display:none">
  <select name=alref119 id="alref119" title="Preferred Site" class="Mandatory"
   onchange="SetClinicType();">
    <option></option>
    %ALLWEB02.02.182.2
  </select>
</span>

<span id=preferredSiteSPAN2 style="display:none">
  <input type="text" name=d_presit size=24 class=Readonly readonly
   title="Preferred Site" value="%ALLWEB02.02.182.0">
</span>

<span id=referralPrioritySPAN1 style="display:none">
  <select class="Mandatory selectBig" name=alref027
   title="Referral Priority">
    <option></option>
    %ALLWEB02.02.127.2
  </select>
</span>

<span id=referralPrioritySPAN2 style="display:none">
  <input type="text" name=d_refpri size=24 class=Readonly readonly
   title="Referral Priority" value="%ALLWEB02.02.127.0">
</span>

<span id=referralSourceSPAN1 style="display:none">
  <select Title="Source of Referral" name=alref034
   class="Mandatory selectBig">
    <option></option>
    %ALLWEB02.02.134.2
  </select>
</span>

<span id=referralSourceSPAN2 style="display:none">
  <input type="text" name=d_refsrc size=24 class=Readonly readonly
   title="Source of Referral" value="%ALLWEB02.02.134.0">
</span>

<span id=clinicTypeSPAN1 style="display:none">
  <select name=alref106 id="alref106" class="Mandatory selectBig" 
   title="Clinic Type"
   onchange="SetClinicId();">
    <option></option>
  </select>
</span>

<span id=clinicTypeSPAN2 style="display:none">
  <input type="text" name=d_clityp id="d_clityp" size=24 class=Readonly readonly
   title="Clinic Type" value="">
</span>

<form name=PatientLinks method=get>
<input type=hidden name=urnumber value="%ALLWEB02.02.003">
<input type=hidden name=admissno value="%ALLWEB02.02.081">
</form>

<script type="text/javascript">
 SACSRef="%ALLWEB02.02.144";
 if ( SACSRef == "Yes") {
   document.UpdateForm.alref083.value=1;
 } else {
   document.UpdateForm.alref083.value=0;
 }
 PMIInterpreter="%ALLWEB02.02.086.001.0";
 VisitInterpreter="%ALLWEB02.02.398.058.0";
 if (PMIInterpreter != "1") {
    UpdateForm.d_pmsvx093.disabled=true;
 } else {
   if (VisitInterpreter == "1") {
      UpdateForm.d_pmsvx093.checked = true;
   }
 }

 if (trim(document.UpdateForm.d_extapp.value) == "eReferrals") {
  document.getElementById('eRefButtons').style.display = "";
 }

 function BookingInstr() {
   linkUrl="allweb02.pbl?reportno=11&template=001" +
     "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+") +
     "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+");
   Left=(document.body.clientWidth-900)/2 - 30;
   DFrameLink(linkUrl,50,Left,950,520)
 }

 function LinkToRef() {
   var URL = trim("%ALLWEB02.02.525");
   var sExtRefID = "%ALLWEB02.02.199.028";
   if (URL.length > 0 ) {
     URL += ("?referralId=" + sExtRefID);
     NewWindow = openNewWindow(URL,"eReferrals");
   }
 }

 var codeList = document.UpdateForm.alref035.options;
 for (var i = 0; i < codeList.length; i++) {
   if (isWhitespace(codeList[i].value)) continue;
   var codeSingle = codeList[i].value.substr(3, 5);
   if (codeSingle.match(/M/g) != null && codeList[i].selected !=true) {
     document.UpdateForm.alref035.options[i].remove(i);
     i--;
   }
 }
</script>
