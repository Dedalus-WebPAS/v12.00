<meta name="TemplateVersion" content="V12.00.01">
<meta name="TemplateHome"    content="wahealth">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/EmrMandatory.js"></script>
<script type="text/javascript" src="../js/emrweb0202003.js"></script>
<script type="text/javascript">
function CancelAction() {
  window.history.go(-1);
/*
  if (top.TogglePanel==null) {
    top.location.reload();
  } else {
    top.TogglePanel();
  }
*/
}
function setPatientFields() {
  if (!isWhitespace(document.UpdateForm.emvis118.value)) 
  {
    document.UpdateForm.emvis111.className="readOnly";
    document.UpdateForm.emvis111.readOnly=true;
    document.UpdateForm.emvis112.className="readOnly";
    document.UpdateForm.emvis112.readOnly=true;
    sexfieldDIV.innerHTML=sexfieldSPAN1.innerHTML;
    document.UpdateForm.emexp005.className="readOnly";
    document.UpdateForm.emexp005.readOnly=true;
    document.UpdateForm.prescomf.focus();
  } else {
    document.UpdateForm.emvis111.className="";
    document.UpdateForm.emvis111.readOnly=false;
    document.UpdateForm.emvis112.className="";
    document.UpdateForm.emvis112.readOnly=false;
    document.UpdateForm.emexp005.className="";
    document.UpdateForm.emexp005.readOnly=false;
    sexfieldDIV.innerHTML=sexfieldSPAN2.innerHTML;
  }
}

function setAuditField() {
  document.UpdateForm.updfield.value = "19";
  document.UpdateForm.reasonfc.value = "  ";
  getUserIDForLoginName(UpdateForm.secureid,UpdateForm.webuseid);
}

function TriageComplete() {
 if (!isWhitespace(UpdateForm.emvis076.value)&&
     !isWhitespace(UpdateForm.emvis086.value)) {
   if (!CheckFutureTime(UpdateForm.emvis076.value,UpdateForm.emvis086)) {
     return; }
 }
 if (!isWhitespace(UpdateForm.emvis077.value)&&
     !isWhitespace(UpdateForm.emvis087.value)) {
   if (!CheckFutureTime(UpdateForm.emvis077.value,UpdateForm.emvis087)) {
     return; }
 }
 if (!isWhitespace(UpdateForm.emvis078.value)&&
     !isWhitespace(UpdateForm.emvis088.value)) {
   if (!CheckFutureTime(UpdateForm.emvis078.value,UpdateForm.emvis088)) {
     return; }
 }
 if(document.getElementById('S01YU')) {
    Meth=document.getElementById('S01YU');
    if(Meth.className.match(/Mandatory/)) {
      if(isWhitespace(Meth.value.substr(4,3))) {
        catYU=trim(document.getElementById('d_catYU').value);
        alert( catYU + " is a required field.\nPlease enter it now." )
        Meth.focus();
        return;
      }
    }
 }
 site = document.UpdateForm.emvis132.value.substr(0,3);
 hosp = document.UpdateForm.emvis132.value.substr(3,3);
  if (ValidOG()) {  // validate Occupational Group
    if (!isWhitespace(hosp)) {
      if (!ChangeHospSite(hosp,site)) {
        alert("Failed to change user Hospital and Site");
        return;
      }
    }
    else {
      if (!ChangeSite(site)) {
        alert("Failed to change user Site");
        return;
      }
    }

    if (ChangeLogin()) {
      // reload top frame
      getTop().menu.location.href = getTop().menu.location.href;
    }
 }
 UpdateForm.AddButton.disabled=true;
 document.UpdateForm.redirect.value="emrweb02.pbl?reportno=1&template=13"
 if (document.UpdateForm.LabForCB.checked==true) {
   SetCookie("TriageLabelsFormsCookie",'1'); 
 }
 if (setFormactnWA()) { 
   UpdateForm.AddButton.disabled=false; 
 } else {
   setTimeout('UpdateForm.AddButton.disabled=false;',5000);
 }
}
function Validateprecom001() {
  onblurHandler()
  var formatedtext=formateText(UpdateForm.prcom001,'50')
  if ((formatedtext.split(/[\r\n]/).length>6) || 
      (UpdateForm.prcom001.value.length > 300)) {
    alert("Presenting Complaint comments - Max 6 lines."
        + "\nPlease remove extra lines to continue.");
    document.UpdateForm.prcom001.focus();
    return; }
}
function displayDisasterID() {
  p=document.UpdateForm
  if (!isWhitespace(document.UpdateForm.dispt001.value)) {
    disasteridnumbertitleDIV.innerHTML=disasteridnumbertitleSPAN.innerHTML;
    disasteridnumberDIV.innerHTML=disasteridnumberSPAN.innerHTML;
  } else {
    disasteridnumbertitleDIV.innerHTML="&nbsp;";
    disasteridnumberDIV.innerHTML="&nbsp;";
  }

  if (!isWhitespace(disasteridnumberDIV.innerHTML)) {
    var serverURL   = "../cgi-bin/patweb80.pbl?reportno=98" +
                    "&valdcode=" + UpdateForm.urnumber.value.replace(/ /g,"+") +
                    UpdateForm.dispt001.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|");
      if (!isWhitespace(ReturnValue[0])) {
        p.dispt002.value=ReturnValue;
        p.dispt002.className="Readonly";
        p.dispt002.readOnly=true;
      }
    }
  }
}
function defaultDisasterCode() {
  if (document.UpdateForm.urnumber.value=="       0") {
     document.UpdateForm.dispt001.disabled=true;
     return;
  }

  if (!isWhitespace(document.UpdateForm.disacode.value)) {
  for (var i =0 ; i < document.UpdateForm.dispt001.length; i++) {
     if (document.UpdateForm.dispt001.options[i].value==
         document.UpdateForm.disacode.value) {
         document.UpdateForm.dispt001.selectedIndex=i
     }
    }
  }

  displayDisasterID();

  if (!isWhitespace(document.UpdateForm.dispt001.value)) {
    document.UpdateForm.dispt001.className = "Readonly";
    document.UpdateForm.dispt001.onfocus =
    function () {this.defaultIndex=this.selectedIndex};
    document.UpdateForm.dispt001.onchange =
    function () {this.selectedIndex=this.defaultIndex};
  }

}
function PatientReturn() {

  if (!isWhitespace(UpdateForm.emvis118.value)) {
    var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=34" +
                      "&valdcode=" + UpdateForm.emvis118.value.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) { 
      if (returnValue.return_value==1) {
        if(confirm("                WARNING\n"+
                   "  Expected Patient Match found\n"+
                   "\n"+
                   "       Do you want to use the\n"+
                   "       expected patient record?")) {
          location.href="emrweb01.pbl?reportno=01&template=009"
          return
        }
      }
    }
  }

  setPatientFields();

  if (isWhitespace(UpdateForm.emvis118.value)) 
  { 
    UpdateForm.emvis111.value="";
    UpdateForm.gname.value="";
    UpdateForm.sname.value="";
    UpdateForm.selsex.value="";
    UpdateForm.sexCode.value="";
    UpdateForm.emvis112.value="";
    UpdateForm.emexp004.selectedIndex=0;
    UpdateForm.emexp005.value=""; 
    dispHydro();
    return;;
  }
  validateUrMerge(8,
               UpdateForm.emvis118,
               UpdateForm.gname,
               UpdateForm.selsex,
               UpdateForm.emexp005,
               UpdateForm.deceased,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.gname,
               UpdateForm.sname,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.dummy,
               UpdateForm.sexCode);
  if (UpdateForm.deceased.value=="1") {
    alert("Patient Deceased")
    UpdateForm.emvis111.value="";
    UpdateForm.emvis112.value="";
    UpdateForm.gname.value="";
    UpdateForm.selsex.value="";
    UpdateForm.sexCode.value="";
    UpdateForm.emvis118.value="";
    UpdateForm.emexp005.value="";
    dispHydro();
    setPatientFields();
    return; }
//
   checkExpectedPat(UpdateForm.emvis118.value)
//
   if(!CheckEmrVisit(UpdateForm.emvis118.value)) {
       UpdateForm.emvis111.value="";
       UpdateForm.gname.value="";
       UpdateForm.sname.value="";
       UpdateForm.selsex.value="";
       UpdateForm.sexCode.value="";
       UpdateForm.emvis112.value="";
       if (isWhitespace(document.UpdateForm.emvis118.value)) {
         UpdateForm.emexp004.value=""; 
         UpdateForm.d_emexp004.value="";
       } else {
         UpdateForm.emexp004.selectedIndex=0;
       }
       UpdateForm.emvis118.value="";
       UpdateForm.emvis118.focus();
       UpdateForm.emexp005.value="";
       dispHydro();
       return;
   }
//
  UpdateForm.emvis111.value=UpdateForm.gname.value.replace(/,/g,"")
  UpdateForm.emvis112.value=UpdateForm.sname.value.replace(/,/g,"")
  if(isWhitespace(UpdateForm.emvis111.value)){
    UpdateForm.emvis118.focus();
    UpdateForm.emvis118.value=" ";
  } else {
    UpdateForm.prescomf.focus();
  }
  UpdateSexWA();
  defaultDisasterCode();
  dispHydro();
}
function checkReferred() {
  i=document.UpdateForm.emvis061.selectedIndex;
  ind=document.UpdateForm.emvis061.options[i].value.substr(5,1)
  if(ind=="1") {
    TranSrcHeading.innerHTML=transferhd.innerHTML;
    TranSrc.innerHTML=transfersrc.innerHTML;
  } else {
    TranSrc.innerHTML=transferblank.innerHTML;
    TranSrcHeading.innerHTML="";
  }
  if(ind=="2") {
    if(document.UpdateForm.emvis019!=undefined){
      document.UpdateForm.emvis019.className="Mandatory";}
  }
}
function CheckAmbType() {
  if (document.UpdateForm.emvis013.value.substr(3,1)=="A") {
    document.UpdateForm.emvis034.readOnly=false;
    if(document.UpdateForm.emvis013.value.substr(4,1)=="N") {
      document.UpdateForm.emvis034.className="";
    } else {
      document.UpdateForm.emvis034.className="Mandatory";
    }
  } else {
    document.UpdateForm.emvis034.value="";
    document.UpdateForm.emvis034.className="ReadOnly";
    document.UpdateForm.emvis034.readOnly=true;
  }
}
/*
function LookupCleanup()
{
  var txtSearch = document.getElementById('prescomf');
  if (txtSearch == undefined) return;

  txtSearch.value = ""; // clear search field value
  txtSearch.className = "";
}
*/
function CheckEmrVisit(urnum) {
  if (isWhitespace(urnum)) {
     return true;
  }
  var serverURL = "../cgi-bin/emrweb08.pbl?reportno=17" +
                  "&valdurno=" + urnum.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|")
    if(!isWhitespace(ReturnValue[0])) {
      if(!confirm("Patient has already presented on.\n" +
                 "Date - \t" + ReturnValue[1] + "\n" +
                 "U/R - \t" + ReturnValue[0].replace(/ /g,"") + "\n" +
                 "Visit - \t" + ReturnValue[2].replace(/ /g,"") + "\n" +
                 "Site - \t" + ReturnValue[3] + "\n" +
                 "Select OK to continue with triage.\n" +
                 "Select Cancel to abort triage.")) {
         return false;
      }
    }
  }
  return true;
}
function expPatSurname() {
  onblurHandler();

  if (isWhitespace(UpdateForm.emvis118.value) &&
      !isWhitespace(UpdateForm.emvis111.value)) {
    var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=35" +
                      "&valdcode=" + UpdateForm.emvis111.value.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      if (returnValue.return_value==1) {
        if(confirm("                WARNING\n"+
                   "  Expected Patient Match found\n"+
                   "\n"+
                   "       Do you want to use the\n"+
                   "       expected patient record?")) {
          location.href="emrweb01.pbl?reportno=01&template=009"
        }
      }
    }
  }
}
//------------------------------------------------------------
// Check if time is in the future
//------------------------------------------------------------
function CheckFutureTime(checkdate,checktime) {
  theField = CheckFutureTime.arguments[1];
  checkTimeTitle= theField.title;
  SetCurrentDateTimeNoFocus(null,UpdateForm.currtime);// UNIX time
  if (SetDateYYYYMMDD(checkdate)==UpdateForm.currdate.value) {
    var n = checktime.length;
    checkTime(checktime);
    var newttime=trim(checktime.value.replace(/:/g,"")) - 0;
    var currentt=trim(UpdateForm.currtime.value.replace(/:/g,"")) - 0;
    if (newttime>currentt) {
      alert(checkTimeTitle +" must be in the past");
      theField.select()
      theField.value="";
      theField.focus();
      return false;
    }
  }
  return true;
}
//-----------------------------------------------------------------
// Function to check for expected patients with the same name or ur
//-----------------------------------------------------------------
function checkExpectedPat(urnum) {
  if (isWhitespace(urnum)) return false;;
  var serverURL = "../cgi-bin/emrweb08.pbl?reportno=16" +
                  "&valdcode="+urnum.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|")

    if(!isWhitespace(ReturnValue[0])) {
      if(confirm("Possible Expected Patient Match.\n" +
                 "U/R - \t\t" + ReturnValue[1].replace(/ /g,"") + "\n" +
                 "Surname - \t" + ReturnValue[2] + "\n" +
                 "Given Name - \t" + ReturnValue[3] + "\n" +
                 "Select OK to register U/R - " + urnum.replace(/ /g,"")  +
                 " using Expected Patient details \n" +
                 "Select Cancel to continue with this registration.")) {
         // Unique no
         top.content.UpdateForm.emexp001.value=ReturnValue[0]
         document.UpdateForm.template.value="012";
         document.UpdateForm.formactn.value="SP"
         tmp=document.UpdateForm.emexp001.value;
         document.UpdateForm.emexp001.value=tmp.replace(/ /g,"+")
         document.UpdateForm.submit()
         return true;
      }
    }
  }
  return false;
}
//-----------------------------------------------------------------
// Function to check age and display hydration fields for children
//-----------------------------------------------------------------
function dispHydro(){
  if(checkDate(document.UpdateForm.emexp005)){
    date1=document.UpdateForm.emexp005.value;
    date2=SetDateDDMMMYYYY(document.UpdateForm.currdate.value);
    agedays=(days_between(date1,date2));
    ageyears=(Math.floor(agedays / 365.25));
    if (document.UpdateForm.paedsage.value>=ageyears) {
      PaedsHydroDIV.innerHTML=PaedsHydroSPAN.innerHTML;
      if ((VariableNameExists('PaedsHydro'))&&(PaedsHydro!="")){
        document.getElementById("CapRefillTitleSPAN").innerHTML = PaedsHydro;
        CapRefillTitleDIV.innerHTML=CapRefillTitleSPAN.innerHTML;
        CapRefillDIV.innerHTML=CapRefillSPAN.innerHTML;
      } else {
        CapRefillTitleDIV.innerHTML="";
        CapRefillDIV.innerHTML="";
      }
    } else {
      PaedsHydroDIV.innerHTML="";
      CapRefillTitleDIV.innerHTML="";
      CapRefillDIV.innerHTML="";
    }
  }
}

function flagFDV(){
  fdv = document.getElementById('pmsvx122').value;

  if (fdv[5]=='F') {
    document.getElementById('fdvtitle').style.color = "red";
  } else {
    document.getElementById('fdvtitle').style.color = "black";
  }
}

function RemoteEmrLocation(valdcode,valdrtyp,ReturnSelect) {
  ReturnFunction="" ;
  for (var i=1; i < RemoteEmrLocation.arguments.length; i++) {
    if (typeof(RemoteEmrLocation.arguments[i]) == 'function') {
      ReturnFunction=RemoteEmrLocation.arguments[i];
    }
  }

  var serverURL = "../cgi-bin/emrweb08.pbl?reportno=30" +
                  "&valdcode=" + valdcode.value.replace(/ /g,"+") +
                  "&valdrtyp=" + valdrtyp.value.replace(/ /g,"+") 
  var returnValue = RSExecute(serverURL);

  if (returnValue.status==0) {
    ReturnSelect.options.length=0
    ReturnValue=returnValue.return_value.split("|");

    for (var j=0; j < ReturnValue.length; j++) {
      if (!isWhitespace(ReturnValue[j])) {
        SelectValue=ReturnValue[j].split(",");
        ReturnSelect.options[ReturnSelect.options.length]=new Option(SelectValue[1],SelectValue[0]);
      } 
    }
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);flagFDV();
              checkReferred();defaultDisasterCode();CheckAmbType();">
<span class=DFrameTitleBar>
ETS Emergency Triage
</span>

<form name=UpdateForm action="emrweb02.pbl" method=post style="margin:0">
<input type=hidden name=reportno value="02">
<input type=hidden name=template value="001">
<input type=hidden name=formactn>
<input type=hidden name=updttype>
<input type=hidden name=updateky value="">
<input type=hidden name=nextpage value="3">
<input type=hidden name=returnfm value=1>
<input type=hidden name=redirect>
<input type=hidden name=deceased>
<input type=hidden name=selsex>
<input type=hidden name=sexCode>
<input type=hidden name=gname>
<input type=hidden name=sname>
<input type=hidden name=dummyadm>
<input type=hidden name=dummy>
<input type=hidden name=dummsrch value="1">
<input type=hidden name=fpatname>
<input type=hidden name=urnumber>
<input type=hidden name=emvis004>
<input type=hidden name=emvis005>
<input type=hidden name=emvis135>
<input type=hidden name=emvis136>
<input type=hidden name=emvis137>
<input type=hidden name=emvis138>
<input type=hidden name=updfield>
<input type=hidden name=reasonfc>
<input type=hidden name=webuseid>
<input type=hidden name=patsname>
<input type=hidden name=patgname>
<input type=hidden name=emexp001 value="">
<input type=hidden name=disacode value="%EMRWEB02.02.498">
<input type=hidden name=currdate value="%STANDARD.01.013">
<input type=hidden name=currtime value="%STANDARD.01.016">
<input type=hidden name=paedsage id=paedsage value="%EMRWEB02.02.597">
<input type=hidden name=valdrtyp value="E">
<input type=hidden name="d_catYU" id="d_catYU" value="%STANDARD.01.017.YU">
<input type=hidden name=wbsecocg value="%STANDARD.01.012.3">

<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td class=DataLabel width=10%>Site ID</td>
  <td width=20%><input type=hidden name=name_emvis132 title="Site ID">
    <select class="Mandatory" name="emvis132"
      title="Site ID"
      onchange="RemoteEmrLocation(this,
                                  UpdateForm.valdrtyp,
                                  UpdateForm.emvis006);">
      %EMRWEB02.02.931.2
    </select>
  </td>
</tr>
<tr><td class=DataLabel>User Id </td>
    <td><input type=hidden name=securety value="2">
        <input type=hidden name=triguser value="1">
        <input type=text size=12 name=secureid class="Mandatory NoAutoFocus" 
          tabindex=1 title="User ID" value="%STANDARD.01.043">
    Password
    <input type=password size =12 name=securepw class=Mandatory tabindex=2
         title="Password" onfocus="SetCaretPosition('securepw',-1);"
         onblur="checkPass();">
    </td>
    <td class=DataLabel>U/R
        <input type="text" size=10 maxlength=8 name=emvis118 tabindex=3
         onblur="UpCase(this);justifyRight(this);PatientReturn();
         MandatoryFDV();">
        <img src=../images/SearchIcon.gif onclick="PatientSearch();"
         class=Icon>
    <td class=DataLabel>Surname</td>
    <td><input type=text size=25 max=25  name=emvis111 tabindex=4 
         onblur="UpCase(this);expPatSurname();"></td>
    <td class=DataLabel>Given Name</td>
    <td><input type=text size=25 max=25  name=emvis112 tabindex=5
         onblur="UpCase(this);onblurHandler();"></td>
    </tr>

<tr><td></td>
    <td></td>
    <td></td>
    <td class=DataLabel>%STANDARD.01.017.G </td>
    <td><div id="sexfieldDIV">
          <select name=emexp004 id=emexp004 class=SelectSml tabindex=6
                  onblur="MandatoryFDV();">
            <option value=" "></option>
              %EMRWEB02.02.086.099.061.9.1.19.3.H
           </select>
        </div>
        </td>
    <td class=DataLabel>Date of Birth </td>
    <td><input type="text" size=12 max=11 name=emexp005 id=emexp005 
         title="Date of Birth" class="Past Date" tabindex=7
         onblur="dispHydro();MandatoryFDV();">
        <img class=Icon src=../images/DateLookup.gif
         date=document.UpdateForm.emexp005>
        </td></tr>
</table>

<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr valign=top>
    <td class=DataLabel width=10%>Presenting Complaint </td>
    <td width=20%>
    <input type=hidden name=emrviscat value="el">
    <input type="text" size=10 tabindex=8 class="Mandatory" name="prescomf"
      onfocus="SetCaretPosition('prescomf',-1);"
      onKeyUp='LookupPresComp(event,this,UpdateForm.emvis060,
               UpdateForm.emrviscat);'
      onBlur='DisplayDiv();MandatoryMeth();MandatoryFDV()'>
    <select name=emvis060 id=emvis060 class="SelectBig Mandatory" 
     onchange="DisplayDiv();MandatoryMeth();MandatoryFDV();" tabindex=9>
    </select>
    <img src=../images/SelectLink.gif 
      title="Presenting Complaint Lookup" class=Icon
      onclick="LookupPage(UpdateForm.prescomf,UpdateForm.emvis060,
              'Lookup_EDPC0000_000',prescomf);">
    </td>
    <td colspan=4>
    <textarea type="text" name=prcom001 wrap=hard cols=50 rows=2 
     onkeydown="LimitText(this,6,300);"
     tabindex=10 
     onblur="TextareaBlurHandler(this);Validateprecom001();"></textarea> 
    </td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
</tr>
</table>

<div id=Triage></div>

<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td width=10% class=DataLabel>Location</td>
    <td width=20%><input type=hidden name=name_emvis006 title="Location">
        <select class="Mandatory" name="emvis006"
         title="Location" tabindex=11
         onchange="validateLocation(UpdateForm.emvis006,
                                    UpdateForm.name_emvis006);">
        </select>
    </td>
    <td width=10%>Accompanying&nbsp;Person</td>
    <td width=25%>
      <input type=text name=emvis038 size=50 maxlength=50 tabindex=11
         title="Accompanying Person"></td>
    <td width=10%>Attendance Type</td>
    <td width=20%><select class="SelectMed" name=emvis053 tabindex=11
         title="Attendance Type">
     <option></option>
     %EMRWEB02.02.213.2
     </select></td>
    <td width=5%>&nbsp;</td>
</tr>

<tr><td class=DataLabel>Arrival Transport</td>
    <td>
      <select name=emvis013 tabindex=12 class="Mandatory SelectMed"
        title="Arrival Transport"
       onchange="document.UpdateForm.emvis034.disabled=0;CheckAmbType();">
        <option></option>
        %EMRWEB02.02.113.2
        </select>
     </td>
    <td class=DataLabel>Amb Case No</td>
    <td><input type=text size=20 maxlength=15 name=emvis034 tabindex=13
         onFocus="CheckAmbType();" value="%EMRWEB02.02.134" 
         title="Amb Case No"></td>
    <td class=DataLabel>Attendance Source</td>
    <td >
       <select class="Mandatory SelectMed" name=emvis061 tabindex=14
         title="Attendance Source" onchange="checkReferred();">
         <option></option>
         %EMRWEB02.02.221.2
       </select>
    </td>
</tr>

<tr><td></td>
    <td></td>
    <td></td>
    <td></td>
    <td width=5% class=DataLabel><span id=TranSrcHeading></span></td>
    <td width=20%><span id=TranSrc></span></td>
</tr>

<tr><td class=DataLabel width=10%>%STANDARD.01.017.eh</td>
    <td width=20>
      <select name=emvis056 tabindex=24 title="%STANDARD.01.017.eh" 
         class="SelectBig">
        <option></option>
        %EMRWEB02.02.216.2
        </select></td>
    <td class=DataLabel>Disaster Code</td>
    <td><select name=dispt001 title="Disaster Code"
         onchange="displayDisasterID();" tabindex=25>
        <option></option>
        %EMRWEB02.02.497
        </select>
    </td>
    <td class=DataLabel><div id=disasteridnumbertitleDIV></div></td>
    <td><div id=disasteridnumberDIV></div></td>
</tr>
</table>

<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td colspan=10 class=HeadingCell align=center >
      Primary Assessment</td></tr>

<tr><td class=DataLabel width=10%>%STANDARD.01.017.A1</td>
    <td width=20%><select name=emvis041 title="%STANDARD.01.017.A1"
         class="SelectBig" tabindex=30>
        <option></option>
        %EMRWEB02.02.201.2
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.A5</td>
    <td><select name=emvis045 title="%STANDARD.01.017.A5"
         class="SelectBig" tabindex=35>
        <option></option>
        %EMRWEB02.02.205.2
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.ef</td>
    <td><select name=emvis054 title="%STANDARD.01.017.ef"
         class="SelectBig" tabindex=38>
        <option></option>
        %EMRWEB02.02.214.2
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.ei</td>
    <td><select name=emvis057 title="%STANDARD.01.017.ei"
         class="SelectBig" tabindex=40>
        <option></option>
        %EMRWEB02.02.217.2
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.eo</td>
    <td><select name=emvis063 title="%STANDARD.01.017.eo"
         class="SelectBig" tabindex=42>
        <option></option>
        %EMRWEB02.02.223.2
        </select>
    </td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.A2</td>
    <td><select name=emvis042 title="%STANDARD.01.017.A2"
         class="SelectBig" tabindex=31>
        <option></option>
        %EMRWEB02.02.202.2
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.A6</td>
    <td><select name=emvis046 title="%STANDARD.01.017.A6"
         class="SelectBig" tabindex=36>
        <option></option>
        %EMRWEB02.02.206.2
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.eg</td>
    <td><select name=emvis055 title="%STANDARD.01.017.eg"
         class="SelectBig" tabindex=39>
        <option></option>
        %EMRWEB02.02.215.2
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.ek</td>
    <td><select name=emvis059 title="%STANDARD.01.017.ek"
         class="SelectBig" tabindex=41>
        <option></option>
        %EMRWEB02.02.219.2
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.ep</td>
    <td><select name=emvis064 title="%STANDARD.01.017.ep"
         class="SelectBig" tabindex=43>
        <option></option>
        %EMRWEB02.02.224.2
        </select>
    </td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.A3</td>
    <td><select name=emvis043 title="%STANDARD.01.017.A3"
         class="SelectBig" tabindex=32>
        <option></option>
        %EMRWEB02.02.203.2
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.A7</td>
    <td><select name=emvis047 title="%STANDARD.01.017.A7"
         class="SelectBig" tabindex=37>
        <option></option>
        %EMRWEB02.02.207.2
        </select>
    </td>
    <td class=DataLabel></td>
    <td></td>
    <td class=DataLabel></td>
    <td></td>
    <td class=DataLabel></td>
    <td></td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.A4</td>
    <td><select name=emvis044 title="%STANDARD.01.017.A4"
         class="SelectBig" tabindex=33>
        <option></option>
        %EMRWEB02.02.204.2
        </select>
    </td>
    <td class=DataLabel></td>
    <td></td>
    <td class=DataLabel></td>
    <td></td>
    <td class=DataLabel></td>
    <td></td>
    <td class=DataLabel></td>
    <td></td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.eq</td>
    <td><select name=emvis065 title="%STANDARD.01.017.eq"
         class="SelectBig" tabindex=34>
        <option></option>
        %EMRWEB02.02.225.2
        </select>
    </td>
    <td class=DataLabel></td>
    <td></td>
    <td class=DataLabel></td>
    <td></td>
    <td class=DataLabel></td>
    <td></td>
    <td class=DataLabel></td>
    <td></td>
    </tr>
</table>

<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td colspan=7 class=HeadingCell align=center >
      Trauma Team Criteria</td></tr>
<tr><td class=DataLabel valign=top width=10%>%STANDARD.01.017.E4</td>
    <td valign=top width=20%>
    <div class='CheckBoxCombo' style='height:105;width:250px;'>
    %EMRWEB02.02.528.01.E4.2
    </div>
    </td>
    <td class=DataLabel valign=top width=10%>%STANDARD.01.017.E5</td>
    <td valign=top width=25%>
    <div class='CheckBoxCombo' style='height:105;width:250px;'>
    %EMRWEB02.02.528.01.E5.2
    </div>
    </td>
    <td valign=top width=15%>
    <table align=center width=100% border=0 cellspacing=0 cellpadding=1>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.E6</td>
    <td valign=top>
    %EMRWEB02.02.528.01.E6.3
    </td>
    </tr>

    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.E7</td>
    <td valign=top>
    %EMRWEB02.02.528.01.E7.3
    </td>
    </tr>

    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.E8</td>
    <td valign=top>
    %EMRWEB02.02.528.01.E8.3
    </td>
    </tr>
    </table>
    </td>
    <td width=20%>&nbsp;</td>
<tr>
</table>

<div id=PaedsHydroDIV></div>

<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr>
<td valign=top width=20%>
<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr valign=top>
<td class=DataLabel width=50%><div id=CapRefillTitleDIV></div></td>
<td valign=top><div id=CapRefillDIV></div></td>
</tr>
</table>
</td>
<td width=20%>&nbsp;</td>
<td width=20%>&nbsp;</td>
<td width=20%>&nbsp;</td>
<td width=20%>&nbsp;</td>
</tr>
</table>

<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td colspan=8 class=HeadingCell align=center >
      Other Details </td></tr>

<tr><td class=DataLabel>Weight (Kg)</td>
    <td><input type=text name=pmsvx045 size=8 maxlength=6 tabindex=80
         value="" min=0 title="Weight" class="Number">
    </td>
    <td class=DataLabel>%STANDARD.01.017.en</td>
    <td><select name="emvis062" tabindex=81 class="Mandatory" 
         title="%STANDARD.01.017.en"> 
    <option></option>
    %EMRWEB02.02.222.6.1
    </select>
    </td>
    <td class=DataLabel>Analgesia Taken</td>
    <td><input type="text" name=emvis076 size="12" tabindex=82
    class="BackDate" title="Analgesia Taken Date">
    <img notab src=../images/DateLookup.gif class=Icon
     onclick="DateLookupFrame(UpdateForm.emvis076);">
    <input type="text" name=emvis086 size="8" tabindex=83
    class='Time' title="Analgesia Taken Time"
           onchange="CheckFutureTime(UpdateForm.emvis076.value,
                     UpdateForm.emvis086);">
    <img notab src=../images/DateTimeStamp.gif class=Icon
    onclick="SetCurrentDateTime(UpdateForm.emvis076,UpdateForm.emvis086);">
    <img notab src=../images/TimeLookup.gif class=Icon
    onclick="TimeLookupFrame(UpdateForm.emvis086);">
    </td>
    <td class=DataLabel>%STANDARD.01.017.et</td>
    <td><select name=emvis068 title="%STANDARD.01.017.et"
     class="SelectBig" tabindex=85>
     <option></option>
     %EMRWEB02.02.228.2
     </select>
     </td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.er</td>
    <td>
    <select name=emvis066 title="%STANDARD.01.017.er"
     class="SelectBig" tabindex=86>
    <option></option>
     %EMRWEB02.02.226.2
    </select>
    </td>
    <td class=DataLabel>Date Last Ate</td>
    <td><input type="text" name=emvis077 size="12" tabindex=87
    class="BackDate" title="Date Last Ate">
    <img notab src=../images/DateLookup.gif class=Icon
    onclick="DateLookupFrame(UpdateForm.emvis077);">
    <input type="text" name=emvis087 size="8" tabindex=88
    class='Time' title="Time Last Ate"
           onchange="CheckFutureTime(UpdateForm.emvis077.value,
                     UpdateForm.emvis087);">
    <img notab src=../images/DateTimeStamp.gif class=Icon
    onclick="SetCurrentDateTime(UpdateForm.emvis077,UpdateForm.emvis087);">
    <img notab src=../images/TimeLookup.gif class=Icon
    onclick="TimeLookupFrame(UpdateForm.emvis087);">
    </td>
    <td class=DataLabel>Analgesia Declined</td>
    <td><input type="checkbox" name="emvis091" value="1" tabindex=84>
    </td>
    <td class=DataLabel>%STANDARD.01.017.es</td>
    <td>
    <select name=emvis067 title="%STANDARD.01.017.es"
     class="SelectBig" tabindex=91>
    <option></option>
     %EMRWEB02.02.227.2
    </select>
    </td>
    </tr>

<tr><td class=DataLabel></td>
    <td>
    </td>
    <td class=DataLabel>Date Last Drank</td>
    <td><input type="text" name=emvis078 size="12" tabindex=89
    class="BackDate" title="Date Last Drank">
    <img notab src=../images/DateLookup.gif class=Icon
     onclick="DateLookupFrame(UpdateForm.emvis078);">
    <input type="text" name=emvis088 size="8" tabindex=90
    class='Time' title="Time Last Drank"
     onchange="CheckFutureTime(UpdateForm.emvis078.value,UpdateForm.emvis088);">
    <img notab src=../images/DateTimeStamp.gif class=Icon
     onclick="SetCurrentDateTime(UpdateForm.emvis078,UpdateForm.emvis088);">
    <img notab src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(UpdateForm.emvis088);">
    </td>
    <td>Drug / Alcohol Related</td>
    <td>
      <table align=center width=100% border=0>
       <tr>
        <td>
         <select name=emvis096 id=emvis096 title="Drug / Alcohol Related"
          tabindex=91
          onchange="MandatoryMeth();">
          <option value="2">Unknown</option>
          <option value="0">No</option>
          <option value="1">Yes</option>
         </select>
        </td>
        <td id="fdvtitle">FDV Related?<td>
        <td>
         <select name=pmsvx122 id=pmsvx122 title="FDV Related?"
          class="Select200" tabindex=91 onchange="setAuditField();flagFDV();">
          <option></option>
            %EMRWEB02.02.599.008.9.5
         </select>
        </td>
       </tr>
      </table>
    </td>
    <td class=DataLabel>%STANDARD.01.017.ev</td>
    <td>
    <select name=emvis070 title="%STANDARD.01.017.ev"
     class="SelectBig" tabindex=92>
    <option></option>
     %EMRWEB02.02.230.2
    </select>
    </td>
    </tr>

<tr><td class=DataLabel>Triage Date</td>
    <td colspan=3>
    <input type="text" name=emvis128 size="12" tabindex=93
    class="Mandatory BackDate" title="Triage Date"
    value="%STANDARD.01.015">
    <img notab src=../images/DateLookup.gif class=Icon
     onclick="DateLookupFrame(UpdateForm.emvis128);">
    <input type="text" name=emvis129 size="8" tabindex=94
     class='Mandatory Time' title="Triage Time"
     value="%STANDARD.01.016">
    <img notab src=../images/DateTimeStamp.gif class=Icon
     onclick="SetCurrentDateTime(UpdateForm.emvis128,UpdateForm.emvis129);">
    <img notab src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(UpdateForm.emvis129);"></td>
    <td class=DataLabel>%STANDARD.01.017.YU</td>
    <td class=DataField>%EMRWEB02.02.528.01.YU.9.1</td>
    <td class=DataLabel>Inform GP</td>
    <td><select name=pmsvx010 title="Inform GP" class="Mandatory" tabindex=95>
    <option></option>
    <option value="0">No</option>
    <option value="1">Yes</option>
    <option value="2">Unknown</option>
    </select></td> 
    </tr>

<tr><td class=DataLabel>Triage Category</td>
    <td colspan=5><table border=0 cellspacing=0>
    <tr>
   <td class=Triage1><i>1</i>
   <input type="radio" name=emvis003 value=1 tabindex=93 title="Triage Category"
   onclick="CheckMan();"></td>
   <td class=Triage2><i>2</i><input type=radio name=emvis003 value=2 tabindex=95
   onclick="unCheck();"></td>
   <td class=Triage3><i>3</i><input type=radio name=emvis003 value=3 tabindex=95
   onclick="unCheck();"></td>
   <td class=Triage4><i>4</i><input type=radio name=emvis003 value=4 tabindex=95
   onclick="unCheck();"></td>
   <td class=Triage5><i>5</i><input type=radio name=emvis003 value=5 tabindex=95
   onclick="unCheck();"></td>
   </tr></table></td>
    <td class=DataLabel>Print Labels and Forms</td>
    <td><input type="checkbox" name="LabForCB" value="1" tabindex=95 checked>
    </td>
   </tr>

<tr><td colspan=8 align=center>
    <input type=button value="Add" class="button" tabindex=101 name="AddButton"
     onclick="tempDisable(this,5);TriageComplete();">
    <input type=button value="Cancel" class="button" tabindex=102
     onblur="SetFieldFocus('secureid');"
     onclick="CancelAction();">
    </td></tr>
</table>
</form>

<form name="ChangeSiteForm" action="websec01.pbl" method=post style="margin:0">
<input type=hidden name=reportno value="5">
<input type=hidden name=updttype value="U">
<input type=hidden name=username value="%STANDARD.01.008">
<input type=hidden name=wbsec011 value="1">
<input type=hidden name=wbsec010>
</form>

<form name="ChangeHospForm" action="websec01.pbl" method=post style="margin:0">
<input type=hidden name=reportno value="5">
<input type=hidden name=updttype value="U">
<input type=hidden name=chnghosp value="1">
<input type=hidden name=username value="%STANDARD.01.008">
<input type=hidden name=wbsec011 value="1">
<input type=hidden name=wbsec010>
<input type=hidden name=wbsec031>
</form>

<form name="ChangeLoginForm" action="websec01.pbl" method=post style="margin:0">
<input type=hidden name=reportno value="1">
<input type=hidden name=updttype value=" ">
</form>

<span id=transferhd style="display:none">
<td class=DataLabel>Transfer Source</td>
</span>

<span id=transferblank style="display:none">
   <input type=hidden name=emvis032 value="" notab>
</span>

<span id=transfersrc style="display:none">
<td><input type="text" size=8 maxlength=6 name="emvis032" tabindex=19
     title="Transfer Source" class=Mandatory
     onchange='validateCode(9,UpdateForm.emvis032,UpdateForm.trnsfsrc);'>
     <input type=text size=25 name=trnsfsrc readonly notab>
     <img src="../images/SearchIcon.gif" class=Icon notab
     onclick=" TransferSourceFrame(UpdateForm.emvis032,UpdateForm.trnsfsrc)">
     </td>
</span>

<span id=EmergencyProc style="display:none;">
<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td class=DataLabel width=10%>Place Where Injury Occurred</td>
    <td width=20%><select name="emvis021" class=SelectBig tabindex=15
         title="Place Where Injury Occurred">
    <option></option>
    %EMRWEB02.02.121.2
     </select></td>
    <td class=DataLabel width=10%>Activity When Injured</td>
    <td width=25%>
      <select name="injur006" class=SelectBig title="Activity When Injured"
         tabindex=16>
    <option></option>
      %EMRWEB02.02.183.2
       </select></td>
    <td class=DataLabel width=10%>Injury Cause</td>
    <td width=20%><select name="injur004" class=SelectBig title="Injury Cause" 
         tabindex=17>
     <option></option>
     %EMRWEB02.02.181.2
     </select>
     </td>
    <td width=5%>&nbsp;</td>
</tr>

<tr valign=top><td class=DataLabel> Human Intent</td>
    <td><select name="injur005" class=SelectBig title="Human Intent"
         tabindex=18>
    <option></option>
     %EMRWEB02.02.182.2
      </select></td>
    <td class=DataLabel>
    Desc. of Injury Event</td>
    <td colspan=3><input type="text" name="injur002" maxlength="50" size="40"
         title="Description of Injury Event" value="" tabindex=19>
    <input type="text" name="injur003" maxlength="50" size="40" value=""
     tabindex=20></td></tr>
</table>
</span>

<span id=disasteridnumbertitleSPAN style="display:none">
Disaster Identification #
</span>

<span id=disasteridnumberSPAN style="display:none">
<input type="text" name=dispt002 size=20 maxlength=19 tabindex=26
   title="Disaster Identification Number">
</span>

<span id=sexfieldSPAN1 style="display:none;">
<input type=text size=15 max=20 name=d_emexp004 id=d_emexp004 tabindex=6
       class='readOnly' readOnly>
<input type=hidden name=emexp004 id=emexp004>
</span>

<span id=sexfieldSPAN2 style="display:none;">
  <select name=emexp004 id=emexp004 class=SelectSml tabindex=6
          onblur="MandatoryFDV();">
    <option value=" "></option>
      %EMRWEB02.02.086.099.061.9.1.19.3.H
  </select>
</span>

<span id=PaedsHydroSPAN style="display:none">
<table align=center width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td colspan=7 class=HeadingCell align=center >
      Paediatric Hydration</td></tr>
<tr>
    <td valign=top width=20%>
    <table align=center width=100% border=0 cellspacing=0 cellpadding=1>
    <tr>
    <td class=DataLabel valign=top width=50%>%STANDARD.01.017.nl</td>
    <td valign=top>
    %EMRWEB02.02.528.01.nl.3
    </td>
    </tr>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.nm</td>
    <td valign=top>
    %EMRWEB02.02.528.01.nm.3
    </td>
    </tr>
    </table>
    </td>

    <td valign=top width=20%>
    <table align=center width=100% border=0 cellspacing=0 cellpadding=1>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.nn</td>
    <td valign=top>
    %EMRWEB02.02.528.01.nn.3
    </td>
    </tr>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.no</td>
    <td valign=top>
    %EMRWEB02.02.528.01.no.3
    </td>
    </tr>
    </table>
    </td>

    <td valign=top width=20%>
    <table align=center width=100% border=0 cellspacing=0 cellpadding=1>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.np</td>
    <td valign=top>
    %EMRWEB02.02.528.01.np.3
    </td>
    </tr>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.nq</td>
    <td valign=top>
    %EMRWEB02.02.528.01.nq.3
    </td>
    </tr>
    </table>
    </td>

    <td valign=top width=20%>
    <table align=center width=100% border=0 cellspacing=0 cellpadding=1>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.nr</td>
    <td valign=top>
    %EMRWEB02.02.528.01.nr.3
    </td>
    </tr>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.ns</td>
    <td valign=top>
    %EMRWEB02.02.528.01.ns.3
    </td>
    </tr>
    </table>
    </td>

    <td valign=top width=20%>
    <table align=center width=100% border=0 cellspacing=0 cellpadding=1>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.nt</td>
    <td valign=top>
    %EMRWEB02.02.528.01.nt.3
    </td>
    </tr>
    <tr>
    <td class=DataLabel valign=top>%STANDARD.01.017.nu</td>
    <td valign=top>
    %EMRWEB02.02.528.01.nu.3
    </td>
    </tr>
    </table>
    </td>
</tr>
</table>
</span>

<span id=CapRefillTitleSPAN style="display:none">
Cap Refill Time
</span>

<span id=CapRefillSPAN style="display:none">
  <input type=text name=emvis102 size=2 maxlength=2 tabindex=79
         value="0" min=0 max=60 class="Integer">
</span>

<script type="text/javascript">
  var trauma=document.getElementsByName('vscdcode');
  for (var i = 0; i < trauma.length; i++) {
       if(trauma[i].value.substr(0,4) == "01E4") {
          trauma[i].tabIndex="60";
       }
       if(trauma[i].value.substr(0,4) == "01E5") {
          trauma[i].tabIndex="61";
       }
       if(trauma[i].value.substr(0,4) == "01nl") {
          trauma[i].tabIndex="69";
       }
       if(trauma[i].value.substr(0,4) == "01nm") {
          trauma[i].tabIndex="70";
       }
       if(trauma[i].value.substr(0,4) == "01nn") {
          trauma[i].tabIndex="71";
       }
       if(trauma[i].value.substr(0,4) == "01no") {
          trauma[i].tabIndex="72";
       }
       if(trauma[i].value.substr(0,4) == "01np") {
          trauma[i].tabIndex="73";
       }
       if(trauma[i].value.substr(0,4) == "01nq") {
          trauma[i].tabIndex="74";
       }
       if(trauma[i].value.substr(0,4) == "01nr") {
          trauma[i].tabIndex="75";
       }
       if(trauma[i].value.substr(0,4) == "01ns") {
          trauma[i].tabIndex="76";
       }
       if(trauma[i].value.substr(0,4) == "01nt") {
          trauma[i].tabIndex="77";
       }
       if(trauma[i].value.substr(0,4) == "01nu") {
          trauma[i].tabIndex="78";
       }
  }
  document.getElementById('S01E6').tabIndex="62";
  document.getElementById('S01E7').tabIndex="63";
  document.getElementById('S01E8').tabIndex="64";
  if(document.getElementById('S01YU')) {
    document.getElementById('S01YU').tabIndex="91";
    document.getElementById('S01YU').onchange=MandatoryMeth;
  }

  RemoteEmrLocation(UpdateForm.emvis132,
                    UpdateForm.valdrtyp,
                    UpdateForm.emvis006);


function MandatoryMeth() {
  if(!document.getElementById('S01YU')) {
    return;
  }
  if(document.UpdateForm.emvis096.value=="1" ||
     document.UpdateForm.emvis060.value.substr(3,1)=="M") {
    document.getElementById('S01YU').className="Mandatory";
  } else {
    document.getElementById('S01YU').className="";
  }
  if(document.getElementById('S01YU').value.substr(7,1)=="2") {
    document.UpdateForm.emvis096.selectedIndex=2;
    document.getElementById('S01YU').className="Mandatory";
  }
}

function ValidOG() {
  // Check indicator 1 of user's OG (Occupational Group)
  // Valid if "E", otherwise invalid
  var p = document.UpdateForm;

  if (p.wbsecocg.value.substr(3,1) != "E") {
    alert("Invalid " + trim("%STANDARD.01.017.w0") + " !");
    return false;
  }

  return true;
}

function ChangeSite(SiteCode) {
  if (!SiteCode || isWhitespace(SiteCode))
    return false;

  var theURL = "websec01.pbl";
  var p = document.ChangeSiteForm;

  p.wbsec010.value = SiteCode;
  var postStr = AJAXPostString(p);

  xmlHttp = createHttpObject();
  xmlHttp.open("POST", theURL, false);
  xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded;");
  xmlHttp.send(postStr);

  if (xmlHttp.status=="200") {
    return true;
  }
  else {
    return false;
  }
}

function ChangeHospSite(HospCode, SiteCode) {
  if (!HospCode || !SiteCode ||
      isWhitespace(HospCode) || isWhitespace(SiteCode))
    return false;

  var theURL = "websec01.pbl";
  var p = document.ChangeHospForm;

  p.wbsec031.value = HospCode;
  p.wbsec010.value = SiteCode;
  var postStr = AJAXPostString(p);

  xmlHttp = createHttpObject();
  xmlHttp.open("POST", theURL, false);
  xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded;");
  xmlHttp.send(postStr);

  if (xmlHttp.status=="200") {
    return true;
  }
  else {
    return false;
  }
}

function ChangeLogin() {
  var theURL = "websec01.pbl";
  var p = document.ChangeLoginForm;

  var postStr = AJAXPostString(p);

  xmlHttp = createHttpObject();
  xmlHttp.open("POST", theURL, false);
  xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded;");
  xmlHttp.send(postStr);

  if (xmlHttp.status=="200") {
    return true;
  }
  else {
    return false;
  }
}
</script>
