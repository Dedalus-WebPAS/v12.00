<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function addSelection() {
  if(!validateMandatory(AddForm)) {
    return;
  }
  if(document.AddForm.d_emrsl006.checked==true) {
    document.AddForm.emrsl006.value="0";
  } else {
    document.AddForm.emrsl006.value="1";
  }
//
  if(document.AddForm.emrsl003.value=="01") {
    if(document.AddForm.prescomf.value > document.AddForm.prescomt.value) {
      alert("Invalid Range Entered " + document.AddForm.prescomf.title +
            " " + document.AddForm.prescomt.title);
      return;
    }
    document.AddForm.emrsl004.value=document.AddForm.prescomf.value;
    document.AddForm.emrsl005.value=document.AddForm.prescomt.value;
  }
//
  if(document.AddForm.emrsl003.value=="02") {
    if(document.AddForm.diagnosf.value > document.AddForm.diagnost.value) {
      alert("Invalid Range Entered " + document.AddForm.diagnosf.title +
            " " + document.AddForm.diagnost.title);
      return;
    }
    document.AddForm.emrsl004.value=document.AddForm.diagnosf.value;
    document.AddForm.emrsl005.value=document.AddForm.diagnost.value;
  }
//
  if(document.AddForm.emrsl003.value=="03") {
    if(parseInt(document.AddForm.agerangf.value,10) >
      parseInt(document.AddForm.agerangt.value,10)) {
      alert("Invalid Range Entered " + document.AddForm.agerangf.title +
            " " + document.AddForm.agerangt.title);
      return;
    }
    document.AddForm.emrsl004.value=document.AddForm.agerangf.value;
    document.AddForm.emrsl005.value=document.AddForm.agerangt.value;
  }
//
  if(document.AddForm.emrsl003.value=="04") {
//    if(document.AddForm.countryf.value > document.AddForm.countryt.value) {
//      alert("Invalid Range Entered " + document.AddForm.countryf.title +
//            " " + document.AddForm.countryt.title);
//      return;
//    }
    document.AddForm.emrsl004.value=document.AddForm.countryf.value;
    document.AddForm.emrsl005.value=document.AddForm.countryt.value;
  }
//
  if(document.AddForm.emrsl003.value=="05") {
    if(document.AddForm.postcodf.value > document.AddForm.postcodt.value) {
      alert("Invalid Range Entered " + document.AddForm.postcodf.title +
            " " + document.AddForm.postcodt.title);
      return;
    }
    document.AddForm.emrsl004.value=document.AddForm.postcodf.value;
    document.AddForm.emrsl005.value=document.AddForm.postcodt.value;
  }
//
  document.AddForm.submit();
}
function ShowSelectionType(type) {
  document.getElementById("PresentingComplaint").style.display="none";
  document.AddForm.prescomf.className="";
  document.AddForm.prescomt.className="";
  document.getElementById("Diagnosis").style.display="none";
  document.AddForm.diagnosf.className="";
  document.AddForm.diagnost.className="";
  document.getElementById("Age").style.display="none";
  document.AddForm.agerangf.className="";
  document.AddForm.agerangt.className="";
  document.AddForm.agerangf.options.length=1;
  document.AddForm.agerangt.options.length=1;
  document.getElementById("Country").style.display="none";
  document.AddForm.countryf.className="";
//  document.AddForm.countryt.className="";
  document.getElementById("PostCode").style.display="none";
  document.AddForm.postcodf.className="";
  document.AddForm.postcodt.className="";
//
  if(type.value=="01") {
    document.getElementById("PresentingComplaint").style.display="";
    document.AddForm.prescomf.className="Mandatory";
    document.AddForm.prescomt.className="Mandatory";
    return;
  } 
  if(type.value=="02") {
    document.getElementById("Diagnosis").style.display="";
    document.AddForm.diagnosf.className="Mandatory";
    document.AddForm.diagnost.className="Mandatory";
    return;
  }
  if(type.value=="03") {
    document.getElementById("Age").style.display="";
    document.AddForm.agerangf.className="Mandatory";
    document.AddForm.agerangt.className="Mandatory";
    p=AddForm;
    SelectNumbers(p.agerangf,0,151,1,"");
    SelectNumbers(p.agerangt,0,151,1,"");
    return;
  }
  if(type.value=="04") {
    document.getElementById("Country").style.display="";
    document.AddForm.countryf.className="Mandatory";
//    document.AddForm.countryt.className="Mandatory";
    return;
  }
  if(type.value=="05") {
    document.getElementById("PostCode").style.display="";
    document.AddForm.postcodf.className="Mandatory";
    document.AddForm.postcodt.className="Mandatory";
    return;
  }
}
function EmrDiagnosisSearch2(ReturnCode,ReturnName)  {
  DFrameStart()
  linkURL="emrweb05.pbl?reportno=7&template=7";
  window.ReturnCode=ReturnCode ;
  window.ReturnName=ReturnName ;
  document.getElementById('PopUpFrame').src=linkURL;
  SearchFrameShow()
}
function LookEmrCode(validType,validName,validCode) {
  window.ValidateName=validName
  window.ValidateCode=validCode
  document.LookUpCode.valdtype.value=validType
  document.LookUpCode.valdcode.value=validCode.value
  document.LookUpCode.target="newWindow"
  newWindow=open("","newWindow",
  "width=1,height=1,top=1024,scrollbars=no,status=no,toolbar=no,menubar=no")
  document.LookUpCode.submit()
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event)">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
<script type="text/javascript">document.write("Add Research Project");</script>
</span>

<form name=AddForm method=post action=emrweb06.pbl >
<input type=hidden name=reportno value="6">
<input type=hidden name=template value="004">
<input type=hidden name=updatety value="S">
<input type=hidden name=emrsl006 value="">
<input type=hidden name=emrsl001 value="%EMRWEB06.06.001.1">
<input type=hidden name=emrsl002 value="%EMRWEB06.06.002">
<input type=hidden name=emrsl004 value="">
<input type=hidden name=emrsl005 value="">

<table align=center width=100% border=0>
<tr><td class=DataLabel width=25%>Selection Type</td>
    <td><select name=emrsl003 class="Mandatory" title="Selection Type"
         onchange="ShowSelectionType(this);">
        <option></option>
        %EMRWEB06.06.203.2
        </select>
    </td></tr>

</table>

<span id="PresentingComplaint" style="display:none">
<table align=center width=100% border=0>
<tr><td class=DataLabel width=25%>Presenting Complaint From</td>
    <td><select name=prescomf
         title="Presenting Complaint From">
        <option></option>
        %STANDARD.01.007.el
        </select>
    </td>
    <td class=DataLabel>To</td>
    <td><select name=prescomt 
         title="Presenting Complaint To">
        <option></option>
        %STANDARD.01.007.el
        </select>
    </td>
    </tr>
</table>
</span>

<span id="Diagnosis" style="display:none">
<table align=center width=100% border=0>
<tr><td class=DataLabel width=25%>Diagnosis From</td>
    <td><input type=text name=diagnosf size=9
         title="Diagnosis From"
         onchange="LookEmrCode('2',AddForm.d_diagnosf,AddForm.diagnosf);">
        <input type=text readonly name=d_diagnosf class="Readonly" size=40
         tabindex=-1>
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="EmrDiagnosisSearch2(AddForm.diagnosf,AddForm.d_diagnosf);">
    </td>
    </tr>
<tr><td class=DataLabel>To</td>
    <td><input type=text name=diagnost size=9
         title="Diagnosis To"
         onchange="LookEmrCode('2',AddForm.d_diagnost,AddForm.diagnost);">
        <input type=text readonly name=d_diagnost class="Readonly" size=40
         tabindex=-1>
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="EmrDiagnosisSearch2(AddForm.diagnost,AddForm.d_diagnost);">
    </td>
    </tr>
</table>
</span>

<span id="Age" style="display:none">
<table align=center width=100% border=0>
<tr><td class=DataLabel width=25%>Age From</td>
    <td><select name=agerangf title="Age Range From">
        <option></option>
        </select>
    </td>
    <td class=DataLabel>To</td>
    <td><select name=agerangt title="Age Range To">
        <option></option>
        </select>
    </td>
    </tr>
</table>
</span>

<span id="Country" style="display:none">
<table align=center width=100% border=0>
<tr><td class=DataLabel width=25%>Country of Birth</td>
    <td><select name=countryf title="Country of Birth"
         onchange="document.AddForm.countryt.value=this.value;">
        <option></option>
        %STANDARD.01.007.C 
        </select>
        <input type=hidden name=countryt value=""> 
    </td>
    </tr>
</table>
</span>

<span id="PostCode" style="display:none">
<table align=center width=100% border=0>
<tr><td class=DataLabel width=25%>Post Code From</td>
    <td><input type=text name=postcodf size=4 maxlength=4
         title="Post Code From">
    </td>
    <td class=DataLabel>To</td>
    <td><input type=text name=postcodt size=4 maxlength=4
         title="Post Code To">
    </td>
    </tr>
</table>
</span>

<table align=center width=100% border=0>
<tr><td class=DataLabel width=25%>Active</td>
    <td><input type=checkbox size=12 name=d_emrsl006 value="0" checked>
    </td>
    </tr>

<tr><td colspan=4 align=center><br>
    <input type=button value="Add" class="button" 
     onclick="addSelection();"> 
    <input type=button value=Close class="button" 
     onclick="DFrameCloseRefresh()">
    </td></tr>
</table>
</form>

<form name=LookUpCode action=emrweb05.pbl method=post>
  <input type=hidden name=reportno value=8>
  <input type=hidden name=template value=1>
  <input type=hidden name=valdtype value="">
  <input type=hidden name=valdcode value="">
</form>
