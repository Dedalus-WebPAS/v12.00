<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script language=javascript src="../js/allweb0210.js"></script>
<script type="text/javascript">
 function UpdateRef() {
   if (document.UpdateForm.superlev.value == "1") {
     if (UpdateForm.pmmms027.selectedIndex != "0" ) {
       alert('Reason for Delete may not be entered for Update');
       UpdateForm.pmmms027.className="";
       return false;
     }
   }
  f=document.UpdateForm;

  if(!IsTimestampBetweenRange(f.admndate,f.admntime,f.discdate,f.disctime,f.pmmms002,f.pmmms003)){
     return false;
  }
  if(!CompareDateToNow(f.pmmms002,f.pmmms003)){
     return false;
  }

  if(validateMandatory(f)) {
     f.updatety.value="O";
     f.submit();
  }
 }
 function DeleteRef() {
   if (validateMandatory(UpdateForm)) {
     if (confirm("Are you sure you want to Delete ?")) {
       UpdateForm.updatety.value="P";
       UpdateForm.submit();
     }
   }
 }
function validateAdmDisRange() {

  if (!isWhitespace(document.getElementById('admndate').value)) {
    if (!CheckDateTimeRange(document.getElementById('admndate'),
                            document.getElementById('admntime'),
                            document.getElementById('pmmms002'),
                            document.getElementById('pmmms003'))) {
      alert('Assessment Date/Time must be after Admission Date/Time');
      return;
    }
  }

  if (!isWhitespace(document.getElementById('discdate').value)) {
    if (!CheckDateTimeRange(document.getElementById('pmmms002'),
                            document.getElementById('pmmms003'),
                            document.getElementById('discdate'),
                            document.getElementById('disctime'))) {
      alert('Assessment Date/Time must be before Discharge Date/Time');
      return;
    }
  }

  UpdateRef();

}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);calcMMSEScore(UpdateForm);UpdateForm.pmmms004.focus();">
<span class=DFrameTitleBar>
 <img align="right" alt="Exit" class="MenuIcon"
      src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
 <script type="text/javascript">
      document.write('Update GEM Standardised Mini Mental State Examination');
 </script>
</span>

<div id=PageBodySection style="overflow: auto;">
 <form name=UpdateForm method=post action=allweb02.pbl style="margin:0">
  <input type=hidden name=reportno value="10">
  <input type=hidden name=template value="016">
  <input type=hidden name=updatety value="">
  <input type=hidden name=urnumber value="%ALLWEB02.10.003">
  <input type=hidden name=admissno value="%ALLWEB02.10.081">
  <input type=hidden name=pmmms001 value="%ALLWEB02.10.808.001">
  <input type=hidden name=superlev value="%ALLWEB02.10.811">
  <input type=hidden name=oldpmm02 id=oldpmm02 value="%ALLWEB02.10.808.002">
  <input type=hidden name=oldpmm03 id=oldpmm03 value="%ALLWEB02.10.808.003">
  <input type=hidden name=admndate id=admndate value="%ALLWEB02.10.602">
  <input type=hidden name=admntime id=admntime value="%ALLWEB02.10.603">
  <input type=hidden name=discdate id=discdate value="%ALLWEB02.10.701">
  <input type=hidden name=disctime id=disctime value="%ALLWEB02.10.702">
  <input type=hidden name=over24hr value="%ALLWEB02.10.816">

  <table align=center width=100% border=1 cellspacing=0 cellpadding=0>
   <tr><td class=DataLabel>Assessment Date</td>
       <td colspan=2>
           <input type=text name=pmmms002 id=pmmms002 
                  value="%ALLWEB02.10.808.002"
                  title="Assessment Date" class="PastDate Mandatory">
             <img src="../images/DateLookup.gif" class=Icon
                  onclick="DateLookupFrame(UpdateForm.pmmms002);">
           Time&nbsp;
           <input type=text size=6 title="Time" value="%ALLWEB02.10.808.003"
                  class="Mandatory Time" name=pmmms003 id=pmmms003>
             <img src="../images/DateTimeStamp.gif" class=Icon
                  onclick="SetCurrentDateTime(null,UpdateForm.pmmms003);">
             <img src="../images/TimeLookup.gif" class=Icon
                 onclick="TimeLookupFrame(UpdateForm.pmmms003);"></td></tr>

   <tr><td class="HeadingCell" align=center width=33%>SMMSE Question Number</td>
       <td class="HeadingCell" align=center width=34%>Cognitive Duration</td>
       <td class="HeadingCell" align=center width=33%>SMMSE Score</td></tr>

   <tr><td class=DataLabel align=center>1</td>
       <td align=center>Orientation - Time</td>
       <td align=center>
           <select class=Mandatory name=pmmms004 title="Orientation - Time"
                   size="1" maxlength="1" type="integer"
                   onchange="calcMMSEScore(UpdateForm);">
            <option></option>
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
           </select></td></tr>

   <tr><td class=DataLabel align=center>2</td>
       <td align=center>Orientation - Place</td>
       <td align=center>
           <select class=Mandatory name=pmmms005 title="Orientation - Place"
                   size="1" maxlength="1" type="integer"
                   onchange="calcMMSEScore(UpdateForm);">
            <option></option>
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
           </select></td></tr>

   <tr><td class=DataLabel align=center>3</td>
       <td align=center>Memory - Immediate</td>
       <td align=center>
           <select class=Mandatory name=pmmms006 title="Memory - Immediate"
                   size="1" maxlength="1" type="integer"
                   onchange="calcMMSEScore(UpdateForm);">
            <option></option>
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
           </select></td></tr>

   <tr><td class=DataLabel align=center>4</td>
       <td align=center>Language/Attention</td>
       <td align=center>
           <select class=Mandatory name=pmmms007 title="Language/Attention"
                   size="1" maxlength="1" type="integer"
                   onchange="calcMMSEScore(UpdateForm);">
            <option></option>
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
           </select></td></tr>

   <tr><td class=DataLabel align=center>5</td>
       <td align=center>Memory - Short</td>
       <td align=center>
           <select class=Mandatory name=pmmms008 title="Memory - Short"
                   size="1" maxlength="1" type="integer"
                   onchange="calcMMSEScore(UpdateForm);">
            <option></option>
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
           </select></td></tr>

   <tr><td class=DataLabel align=center>6</td>
       <td align=center>Language/Memory Long</td>
       <td align=center>
           <select class=Mandatory name=pmmms009 title="Language/Memory Long"
                   size="1" maxlength="1" type="integer"
                   onchange="calcMMSEScore(UpdateForm);">
            <option></option>
            <option value="0">0</option>
            <option value="1">1</option>
           </select></td></tr>

   <tr><td class=DataLabel align=center>7</td>
       <td align=center>Language/Memory Long</td>
       <td align=center>
           <select class=Mandatory name=pmmms010 title="Language/Memory Long 1"
                   size="1" maxlength="1" type="integer"
                   onchange="calcMMSEScore(UpdateForm);">
            <option></option>
            <option value="0">0</option>
            <option value="1">1</option>
           </select></td></tr>

   <tr><td class=DataLabel align=center>8</td>
       <td align=center>Language/Abstract Thinking/Verbal Fluency</td>
       <td align=center>
           <select class=Mandatory name=pmmms011
                   title="Language/Abstract Thinking/Verbal Fluency"
                   size="1" maxlength="1" type="integer"
                   onchange="calcMMSEScore(UpdateForm);">
            <option></option>
            <option value="0">0</option>
            <option value="1">1</option>
           </select></td></tr>

   <tr><td class=DataLabel align=center>9</td>
       <td align=center>Language</td>
       <td align=center>
           <select class=Mandatory name=pmmms012 title="Language"
                   size="1" maxlength="1" type="integer"
                   onchange="calcMMSEScore(UpdateForm);">
            <option></option>
            <option value="0">0</option>
            <option value="1">1</option>
           </select></td></tr>

   <tr><td class=DataLabel align=center>10</td>
       <td align=center>Language/Attention/Comprehension</td>
       <td align=center>
           <select class=Mandatory name=pmmms013 title="Language/Attention/Comprehension"
                   size="1" maxlength="1" type="integer"
                   onchange="calcMMSEScore(UpdateForm);">
            <option></option>
            <option value="0">0</option>
            <option value="1">1</option>
           </select></td></tr>

   <tr><td class=DataLabel align=center>11</td>
       <td align=center>
           Attention/Comprehension/Follow Commands/Constructional</td>
       <td align=center>
           <select class=Mandatory name=pmmms014
                   title="Attention/Comprehension/Follow Commands/Constructional"
                   size="1" maxlength="1" type="integer"
                   onchange="calcMMSEScore(UpdateForm);">
            <option></option>
            <option value="0">0</option>
            <option value="1">1</option>
           </select></td></tr>

   <tr><td class=DataLabel align=center>12</td>
       <td align=center>Attention/Comprehension/Construction/Follow Commands</td>
       <td align=center>
           <select class=Mandatory name=pmmms015
                   title="Attention/Comprehension/Construction/Follow Commands"
                   size="1" maxlength="1" type="integer"
                   onchange="calcMMSEScore(UpdateForm);">
            <option></option>
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
           </select></td></tr>

   <tr><td class="HeadingCell" align=center>&nbsp;</td>
       <td class="HeadingCell" align=center>Total Score</td>
       <td class="HeadingCell" align=center>&nbsp;</td></tr>

   <tr><td class=DataLabel>Total Score</td>
       <td>&nbsp;</td>
       <td align=center><input type=text name=totalScore size="2" maxlength="2"
           title="Total Score" class="Readonly" readonly
           onfocus="this.blur();"></td></tr>

   <tr><td class="HeadingCell" align=center colspan=3>
           <div id="reasonHeading"></div></td></tr>

   <tr><td class=DataLabel><div id="reasonHead"></div></td>
       <td colspan=2><div id="reasonCode"></div></td></tr>

   <tr><td colspan=3 align=center><br>
           <input type=button id=btnUpdate value="Update" class="button"
                  onclick="tempDisable(this);validateAdmDisRange();">
           <span id="deleteButton" style="display: none">
             <input type=button id=btnDelete value="Delete" class="button"
                    onclick='tempDisable(this);
                             UpdateForm.pmmms027.className="Mandatory";
                             DeleteRef();'>
           </span>
           <input type=button value=Cancel class="button"
                  onclick="DFrameCloseRefresh();"></td></tr>
  </table>
 </form>
</div>

<span id="reasonhdg" style="display:none">&nbsp;</span>
<span id="reasonhd" style="display:none">Reason For Delete</span>
<span id="reasoncd" style="display:none">
 <select name="pmmms027" title="Reason for Delete">
      <option></option>
       %ALLWEB02.10.814.2
     </select>
</span>

<script language=javascript>
 for (var i =0 ; i < UpdateForm.pmmms004.length; i++) {
   if (UpdateForm.pmmms004.options[i].value=="%ALLWEB02.10.808.004") {
     UpdateForm.pmmms004.selectedIndex=i; }
 }
 for (var i =0 ; i < UpdateForm.pmmms005.length; i++) {
   if (UpdateForm.pmmms005.options[i].value=="%ALLWEB02.10.808.005") {
     UpdateForm.pmmms005.selectedIndex=i; }
 }
 for (var i =0 ; i < UpdateForm.pmmms006.length; i++) {
   if (UpdateForm.pmmms006.options[i].value=="%ALLWEB02.10.808.006") {
     UpdateForm.pmmms006.selectedIndex=i; }
 }
 for (var i =0 ; i < UpdateForm.pmmms007.length; i++) {
   if (UpdateForm.pmmms007.options[i].value=="%ALLWEB02.10.808.007") {
     UpdateForm.pmmms007.selectedIndex=i; }
 }
 for (var i =0 ; i < UpdateForm.pmmms008.length; i++) {
   if (UpdateForm.pmmms008.options[i].value=="%ALLWEB02.10.808.008") {
     UpdateForm.pmmms008.selectedIndex=i; }
 }
 for (var i =0 ; i < UpdateForm.pmmms009.length; i++) {
   if (UpdateForm.pmmms009.options[i].value=="%ALLWEB02.10.808.009") {
     UpdateForm.pmmms009.selectedIndex=i; }
 }
 for (var i =0 ; i < UpdateForm.pmmms010.length; i++) {
   if (UpdateForm.pmmms010.options[i].value=="%ALLWEB02.10.808.010") {
     UpdateForm.pmmms010.selectedIndex=i; }
 }
 for (var i =0 ; i < UpdateForm.pmmms011.length; i++) {
   if (UpdateForm.pmmms011.options[i].value=="%ALLWEB02.10.808.011") {
     UpdateForm.pmmms011.selectedIndex=i; }
 }
 for (var i =0 ; i < UpdateForm.pmmms012.length; i++) {
   if (UpdateForm.pmmms012.options[i].value=="%ALLWEB02.10.808.012") {
     UpdateForm.pmmms012.selectedIndex=i; }
 }
 for (var i =0 ; i < UpdateForm.pmmms013.length; i++) {
   if (UpdateForm.pmmms013.options[i].value=="%ALLWEB02.10.808.013") {
     UpdateForm.pmmms013.selectedIndex=i; }
 }
 for (var i =0 ; i < UpdateForm.pmmms014.length; i++) {
   if (UpdateForm.pmmms014.options[i].value=="%ALLWEB02.10.808.014") {
     UpdateForm.pmmms014.selectedIndex=i; }
 }
 for (var i =0 ; i < UpdateForm.pmmms015.length; i++) {
   if (UpdateForm.pmmms015.options[i].value=="%ALLWEB02.10.808.015") {
     UpdateForm.pmmms015.selectedIndex=i; }
 }
 if (document.UpdateForm.superlev.value == "1") {
   reasonHeading.innerHTML=reasonhdg.innerHTML;
   reasonHead.innerHTML=reasonhd.innerHTML;
   reasonCode.innerHTML=reasoncd.innerHTML;
   deleteButton.style.display="";
 }
//
</script>
