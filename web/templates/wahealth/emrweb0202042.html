<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/EmrMandatory.js"></script>
<script type="text/javascript" src="../js/emrweb0202010.js"></script>
<script type="text/javascript">
function setTriage() {
  document.UpdateForm.checkTri.value=1;
  if (validateMandatory(UpdateForm)) {
    SetCookie('ExpAdvConCookie','');
    document.UpdateForm.formactn.value="SP"
    tmp=document.UpdateForm.emexp001.value;
    document.UpdateForm.emexp001.value=tmp.replace(/ /g,"+") 
    document.UpdateForm.submit()
    }
}
function setRegistration() {
  document.UpdateForm.checkTri.value=1;
  if (validateMandatory(UpdateForm)) {
    SetCookie('ExpAdvConCookie','');
    document.UpdateForm.formactn.value="SP"
    tmp=document.UpdateForm.emexp001.value;
    document.UpdateForm.emexp001.value=tmp.replace(/ /g,"+")
    document.UpdateForm.template.value="021";
    document.UpdateForm.submit()
    }
}
function setUpdate() {
  document.UpdateForm.checksen.value=1;
  if (validateMandatory(UpdateForm)) {
    document.UpdateForm.formactn.value="AU"
    document.UpdateForm.nextpage.value="2"
    document.UpdateForm.redirect.value="emrweb01.pbl?reportno=1&template=049"
    tmp=document.UpdateForm.emexp001.value;
    document.UpdateForm.emexp001.value=tmp.replace(/ /g,"+") 
    document.UpdateForm.submit()
  }
}
function FN(Name) {
NameFields=Name.split(" ");
 if (NameFields.length > 1) {
  Surname=NameFields[2].substr(0,25);
  FName=NameFields[1].substr(0,25);
  Title=NameFields[0].substr(0,1) + NameFields[0].substr(1,5).toLowerCase()
document.UpdateForm.emexp002.value=trim(Surname);
document.UpdateForm.emexp003.value=trim(FName);
 }
}
function CheckCode(code,selectlist)  {
 var found=0
 strvar=code.value+"   "      
 code.value=strvar.substr(0,3)
 for (var i =0 ; i < selectlist.length; i++) {
   if (selectlist.options[i].value.substr(0,3)==code.value) {
     found=1; selectlist.selectedIndex=i } }
 if (found==0) { alert("Invalid Code Entered");code.focus() }
}
function UpdateCode(code,selectlist) {
  code.value=selectlist.value.substr(0,3)
  UpdateForm.comptext.focus()
}
function setRedirect() {
  if (window.name == "content") {
     document.UpdateForm.redirect.value="emrweb01.pbl?reportno=1&template=2"
   }
  else {
     document.UpdateForm.redirect.value="emrweb01.pbl?reportno=1&template=1"
  }
}
function setFormactn() {
  if (validateMandatory(UpdateForm)) {
    document.UpdateForm.formactn.value="N1"
    document.UpdateForm.updttype.value="REGIS"
    UpdateWin=window.open("","HideUpdateWindow",
    "width=10,height=10,top=1024,directories=no,location=no" +
    ",scrollbars=no,status=no,toolbar=no,menubar=no,resizable=no")
    document.UpdateForm.target="HideUpdateWindow";
    document.UpdateForm.submit()
    }
}
function dispSex(){
for (var i =0 ; i < document.UpdateForm.emexp004.length; i++) {
if  (document.UpdateForm.emexp004.options[i].value.substr(0,1)==UpdateForm.selsex.value.substr(0,1)) {
       document.UpdateForm.emexp004.selectedIndex=i } };
}
function submitFormRedirect() {
 if (IsDirty(UpdateForm)){
   if(document.UpdateForm.checksen.value==1) {return;;}
   if(document.UpdateForm.checkTri.value==1) {return;;}
   SubmitForm()
 }
}
function SubmitForm() {
   setUpdate()
}
function IsDirty(eForm) {
  for (var i=0; i < eForm.length; i++) {
    var eElem = eForm.elements[i];
    if ("text" == eElem.type || "textarea" == eElem.tagName)
    {
      if (trim(eElem.value) != trim(eElem.defaultValue))  {
        if(eElem.name=="prcom001") {
          if (UpdateForm.prcom001.value == UpdateForm.savdesc1.value) {
              return false; }
        }
        if(eElem.name=="adcom001") {
          if (UpdateForm.adcom001.value == UpdateForm.savdesc2.value) {
              return false; }
        }
        return true;
      }
    }
  }
  return false;
}

//Dummy function to override function
function setPatientFields() {}

//Checks whether there is a UR
function checkUR(UR) {

var URnumber=UR;

//If there isn't, ignores
if (isWhitespace(URnumber.value)) { return;;}

//Otherwise loads patient details based on UR
  justifyRight(URnumber);
  PatientReturnWA();
  document.getElementById("genderDisp").innerHTML = 
      document.UpdateForm.selsex.value; 
}

function Validateprecom001() {
  onblurHandler()
  var formatedtext=formateText(UpdateForm.prcom001,'50')
  if ((formatedtext.split(/[\r\n]/).length>6) || 
        (UpdateForm.prcom001.value.length > 300)) {
    alert("Presenting Complaint comments - Max 6 lines."
           +"\nPlease remove extra rows to continue.");
    document.UpdateForm.prcom001.focus();
    return; }
}
function Validateaddcom001() {
  onblurHandler()
  var formatedtext=formateText(UpdateForm.adcom001,'100')
  if ((formatedtext.split(/[\r\n]/).length>5) ||
        (UpdateForm.adcom001.value.length > 500)) {
    alert("Additional Information comments - Max 5 lines."
           +"\nPlease remove extra rows to continue.");
    document.UpdateForm.adcom001.focus();
    return; }
}
function CheckAmbType() {
  if(document.UpdateForm.emexp014.value.substr(3,1)=="A") {
    document.UpdateForm.emexp026.readOnly=false;
    if(document.UpdateForm.emexp014.value.substr(4,1)=="N") {
      document.UpdateForm.emexp026.className="";
    } else {
      document.UpdateForm.emexp026.className="Mandatory";
    }
  } else {
    document.UpdateForm.emexp026.value="";
    document.UpdateForm.emexp026.className="";
//    document.UpdateForm.emexp026.className="ReadOnly";
//    document.UpdateForm.emexp026.readOnly=true;
  }
}
function checkSOR() {
  if (document.getElementById("emexp019").value.substr(5,1)=="1") {
    document.getElementById("emexp031").className="Mandatory";
  } else {
    document.getElementById("emexp031").className="";
  }
}
function checkrR() {
  if (!isWhitespace(document.getElementById("emexp030").value)) {
    document.getElementById("emexp029").value="0";
  } else {
    document.getElementById("emexp029").value="";
  }
}
function getEACRedirectCookie() {

  if (GetCookieData("EACRedirectCookie")!= "unknown") {
    document.getElementById("eacredck").value = 
    GetCookieData("EACRedirectCookie");
    ExpireCookiePath("EACRedirectCookie");
  }

}
function GetTransferSource() {
  f = document.UpdateForm;
  validateCode(9,f.d_emexp031,
               f.d_trnsfsrc);
  var codedesc=f.d_emexp031.value + " " + f.d_trnsfsrc.value;
  transrcDIV.innerHTML=codedesc ;
}
</script>
</head>
%START.OF.PAGE
<body onLoad="PageLoad(event);
              checkUR(document.UpdateForm.emexp018);
              GetTransferSource();
              getEACRedirectCookie();"
      onBeforeUnload="submitFormRedirect();">
<span class=DFrameTitleBar>
Expected, Advised, Contact Details
</span>
<form name=UpdateForm action="emrweb02.pbl" method=post
 onsubmit='return validateMandatory(this);'>
  <input type=hidden name=reportno value="02">
  <input type=hidden name=template value="012">
  <input type=hidden name=formactn>
  <input type=hidden name=updttype>
  <input type=hidden name=updateky value="">
  <input type=hidden name=nextpage value="1">
  <input type=hidden name=redirect>
  <input type=hidden name=emexp001 value="%EMRWEB02.02.410">
  <input type=hidden name=selsex>
  <input type=hidden name=dummyadm>
  <input type=hidden name=dummsrch value="1">
  <input type=hidden name=gname>
  <input type=hidden name=sname>
  <input type=hidden name=savdesc1>
  <input type=hidden name=savdesc2>
  <input type=hidden name=dummy>
  <input type=hidden name=dummy1>
  <input type=hidden name=dummy2>
  <input type=hidden name=checksen value="0">
  <input type=hidden name=checkTri value="0">
  <input type=hidden name=patsname value="%EMRWEB02.02.411">
  <input type=hidden name=patgname value="%EMRWEB02.02.412">
  <input type=hidden name=deceased>
  <input type=hidden name=emexp002>
  <input type=hidden name=emexp003>
  <input type=hidden name=emexp005>
  <input type=hidden name=emexp026>
  <input type=hidden name=d_emexp004>
  <input type=hidden name=emexp018 id=emexp018 value="%EMRWEB02.02.435">
  <input type=hidden name=emexpsit value="%EMRWEB02.02.533">
  <input type=hidden name=emexp029 id=emexp029 value="">
  <input type=hidden name=d_emexp028 id=d_emexp028 value="%EMRWEB02.02.596">
  <input type=hidden name=d_trnsfsrc id=d_trnsfsrc value="">
  <input type=hidden name=d_emexp031 id=d_emexp031 value="%EMRWEB02.02.594">
  <input type=hidden name=eacredck id=eacredck value="">
  <input type=hidden name=ptcnhdps id=ptcnhdps
       value="%STANDARD.01.025.080.250.1.1">

<table align=center width=98% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width="10%">U/R </td>
    <td class=DataField width="15%">%EMRWEB02.02.435</td>
    <td class=DataLabel width="10%">Surname </td>
    <td class=DataField width="15%">%EMRWEB02.02.411</td>
    <td class=DataLabel width="10%">Given Name </td>
    <td class=DataField width="15%">%EMRWEB02.02.412</td>
    </tr>

<tr><td class=DataLabel></td>
    <td class=DataLabel></td>
    <td class=DataLabel>%STANDARD.01.017.G </td>
    <td class=DataField id="genderDisp">%EMRWEB02.02.941.0</td>
    <td class=DataLabel>Date of Birth </td>
    <td class=DataField>%EMRWEB02.02.414</td>
    </tr>
</table>

<table align=center width=98% border=0 cellspacing=0 cellpadding=0>
<tr><td colspan=6><hr></td></tr>

<tr>
  <td width=10%>Patient Encounter Type</td>
  <td width=50%>
    <input type=radio name=emexp028 id=emex028e value="1"
      disabled>Expected Patient</input>
    <input type=radio name=emexp028 id=emex028a value="2"
      disabled>Advice Call</input>
    <input type=radio name=emexp028 id=emex028c value="3"
      disabled>Contact List</input>
  </td>
  <td width=8%>&nbsp;</td>
  <td width=15%>&nbsp;</td>
  <td width=17%>&nbsp;</td>
</tr>

<tr><td class=DataLabel>Date Notified</td>
   <td>
      <table align=center width=100% border=0 cellspacing=0 cellpadding=0>
       <tr>
         <td class=DataField>%EMRWEB02.02.424
          &nbsp;&nbsp;&nbsp; Time &nbsp; %EMRWEB02.02.425
         </td>
         <td class=DataLabel>ETA</td>
         <td class=DataField nowrap>%EMRWEB02.02.465
          &nbsp;&nbsp;&nbsp; Time &nbsp; %EMRWEB02.02.466 
         </td>
         <td></td>
         <td></td>
       </tr>
      </table>
    </td>
    <td class=DataLabel nowrap>Accepting Source</td>
    <td class=DataField>%EMRWEB02.02.463.0</td>
</tr>

<tr>
    <td></td>
    <td></td>
    <td>%STANDARD.01.017.EA </td>
    <td><b>%EMRWEB02.02.423.0</b></td>
</tr>

<tr>
    <td></td>
    <td></td>
    <td class=DataLabel>Amb Case No</td>
    <td><b>%EMRWEB02.02.469</b></td>
</tr>

<tr valign=top><td class=DataLabel>Presenting Complaint </td>
    <td colspan=3 class=DataField>
    %EMRWEB02.02.417 
    <br>
    %EMRWEB02.02.418
    <br>
    %EMRWEB02.02.419
    <br>
    %EMRWEB02.02.420
    <br>
    %EMRWEB02.02.421
    <br>
    %EMRWEB02.02.422 
    </td>
</tr>

<tr>
    <td class=DataLabel valign=top><br>Expected Patient Notes<br><br>
    </td>
    <td rowspan=3>
        <textarea name=exptcmnt id=exptcmnt rows=10 cols=100 wrap=hard
         class=Readonly readonly
         title="Notes">%EMRWEB02.02.942.001
        </textarea>
    </td>
    <td class=DataLabel>%STANDARD.01.017.em </td>
    <td class=DataField>%EMRWEB02.02.462.0</td>
</tr>

<tr>
    <td></td>
    <td class=DataLabel>Transfer Source</td>
    <td class=DataField>
     <div id="transrcDIV"></div></td>
</tr>

<tr>
    <td></td>
    <td class=DataLabel>%STANDARD.01.017.rR </td>
    <td class=DataField>%EMRWEB02.02.595.0</td>
</tr>

<tr><td>&nbsp;</td></tr>
<tr>
  <td class=DataLabel nowrap valign=top>
    Caller Name and Contact Number
  </td>
  <td class=DataField valign=top>%EMRWEB02.02.593</td>
  <td></td>
  <td></td>
</tr>

<tr><td colspan=6 align=center><br>
    <input type=button value="Cancel" class="button" tabindex=23
     onClick="if (!isWhitespace(document.getElementById('eacredck').value)) {
                location.href = document.getElementById('eacredck').value;
              } else {
                location.href='emrweb01.pbl?reportno=01&template=049';
              }">
    </td></tr>
</table>
</td></tr>
</table>
</form>
<script type="text/javascript">

function init(){
  if (document.getElementById("d_emexp028").value == "1") {
    document.UpdateForm.emexp028[0].checked = true;
  }

  if (document.getElementById("d_emexp028").value == "2") {
    document.UpdateForm.emexp028[1].checked = true;
  }

  if (document.getElementById("d_emexp028").value == "3") {
    document.UpdateForm.emexp028[2].checked = true;
  }

}

function checkWhite(UR) {
var URnumber=UR;
if (isWhitespace(URnumber.value)) {
  setPatientFields();
  return;;
}
  justifyRight(URnumber);
  PatientReturnWA();
}
</script>

<span id=sexfieldSPAN1 style="display:none;">
<input type=text size=15 max=20 name=d_emexp004 tabindex=6" class='readOnly'
 readOnly value="%EMRWEB02.02.941.0">
<input type=hidden name=emexp004>
</span>

<span id=sexfieldSPAN2 style="display:none;">
  <select name=emexp004 class=SelectSml tabindex=6>
    <option value=" "></option>
     %EMRWEB02.02.941.9.1.19.3.H
  </select>
</span>

