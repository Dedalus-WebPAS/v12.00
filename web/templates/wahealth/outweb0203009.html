<meta name="TemplateVersion" content="V12.00.03">
<meta name="TemplateHome"    content="wahealth">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true"> 
<script type="text/javascript" src="../js/OutExtraTemplates.js"></script>
<script type="text/javascript" src="../js/outweb02.js"></script>
<script type="text/javascript" src="../js/CustomMyhrConsent.js"></script>
<script type="text/javascript">
function defaultDisasterCode() {
  if (!isWhitespace(document.UpdateForm.disacode.value)) {
    disastercodeDIV.innerHTML=disastercodeSPAN2.innerHTML;
  } else {
    disastercodeDIV.innerHTML=disastercodeSPAN1.innerHTML;
  }

  displayDisasterID();

}

function displayDisasterID() {
 p=document.UpdateForm
  if (!isWhitespace(document.UpdateForm.dispt001.value)) {
    disasteridnumbertitleDIV.innerHTML=disasteridnumbertitleSPAN.innerHTML;
    disasteridnumberDIV.innerHTML=disasteridnumberSPAN.innerHTML;
  } else {
    disasteridnumbertitleDIV.innerHTML="";
    disasteridnumberDIV.innerHTML="";
  }

  if (!isWhitespace(disasteridnumberDIV.innerHTML)) {
    var serverURL   = "../cgi-bin/patweb80.pbl?reportno=98" +
                    "&valdcode=" + UpdateForm.urnumber.value.replace(/ /g,"+") +
                    UpdateForm.dispt001.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|");
      if (!isWhitespace(ReturnValue[0])) {
        p.dispt002.value=ReturnValue;
        p.dispt002.className="Readonly";
        p.dispt002.readOnly=true;
      }
    }
  }
}
function ClinicSearch() {
   if (!isWhitespace(UpdateForm.newslotk.value)) {
     cancelSlot(UpdateForm.newslotk.value,ClinicSearchLink)
   }
}
function ClinicSearchLink() {
 ClinicSearchFrame(UpdateForm.newslotk,UpdateForm.clindesc,UpdateForm.clindate,
                   UpdateForm.defclnty,UpdateForm.defclnid)
}
function AppointSearch() {
   if (!isWhitespace(UpdateForm.newslotk.value)) {
     cancelSlot(UpdateForm.newslotk.value,AppointSearchLink)
   }
}
function AppointSearchLink() {
AppointmentSearchFrame(UpdateForm.newslotk,UpdateForm.clindesc,
                       UpdateForm.clindate,UpdateForm.defclnty,
                       UpdateForm.defclnid,UpdateForm.defvisty);
}
function UpdateApp() {
  p=document.UpdateForm;
  if(p.offdutyb!=undefined){
    if(p.offdutyb.checked==true){
      alert("Error: Claim Type invalid for 'Off Duty' personnel.")
      return;
    }
  }
  if(p.d_outbb071.checked==true) {
    p.outbb071.value="1";
  } else {
    p.outbb071.value="0";
  }
  validateSuspension(p.urnumber,p.dateclin,p.datefrom,p.dateto);
  if(p.datefrom.value!='0'){
       ans=confirm("Warning : Patient has a Suspension record for period \n" +
             "\t" + p.datefrom.value  + " - " + p.dateto.value);
       if (ans!=true) {
          return; }
  } 

  if (!isWhitespace(document.UpdateForm.dispt001.value)) {
    var serverURL   = "../cgi-bin/comweb80.pbl?reportno=44" +
                    "&valdcode=" + UpdateForm.dispt001.value.replace(/ /g,"+") +
                    UpdateForm.dateclin.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) {
      return;
    }
  }


  setRedirect()
  if(document.UpdateForm.d_pmsvx093.checked==true) {
    document.UpdateForm.pmsvx093.value="1";
  } else {
    document.UpdateForm.pmsvx093.value="0";
  }
  if (validateMandatory(UpdateForm)) {
    EnableLetterFields(UpdateForm);
    ReEnableFields();
    valReferralClaim();
    UpdateForm.submit() }
}
function setRedirect() {
  if (document.UpdateForm.ptcnxcom != undefined) {
    if (document.UpdateForm.ptcnxcom.value == "1") {
      setRedirectXCom();
      return;
    }
  }

  strTemplate="" ;
  scrName="";
  checkInd=document.UpdateForm.outbb002.value.substr(3,5)
  if(checkInd.search(/W/g) >= 0) {
    strTemplate="041";
    scrName="WC";}
  if(checkInd.search(/M/g) >= 0) {
    strTemplate="042";
    scrName="TAC";}
  if(checkInd.search(/V/g) >= 0) {
    strTemplate="043";
    scrName="VA";}
  if(checkInd.search(/D/g) >= 0) {
    strTemplate="081";
    scrName="DF";}

  checkInd=document.UpdateForm.outbb002.value.substr(8,1)
  if(checkInd.search(/C/g) >= 0) {
    strTemplate="048";
    scrName="CT";}

  if (strTemplate=="") {
    if ((document.UpdateForm.ptcnueoc.value==1) &&
        (document.UpdateForm.outbb002.value.substr(5,1)=='A')) {
      scrName="ACC";
      document.UpdateForm.nextpage.value="6"
      document.UpdateForm.redirect.value="eocweb01.pbl?reportno=1&template=006"
        + "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")
        + "&returncd=OUT";
    }
    else {
      document.UpdateForm.redirect.value="outweb02.pbl?reportno=3&template=1" +
                                      "&shwprint=1" 
    }
  }
  else {
    document.UpdateForm.nextpage.value="6"
    document.UpdateForm.redirect.value="patweb89.pbl?reportno=01" +
               "&template=" + strTemplate +
               "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")  }

  if(chkExtraTempl(document.UpdateForm,"B",document.UpdateForm.newslotk.value,
                PatientLinks.urnumber.value.replace(/ /g,"+"),scrName)) {
    document.UpdateForm.nextpage.value="6";
  }
  if(chkExtraTempl(document.UpdateForm,"B",document.UpdateForm.newslotk.value,
                PatientLinks.urnumber.value.replace(/ /g,"+"),scrName)) {
    document.UpdateForm.nextpage.value="6";
  }
}
function setRedirectXCom() {
  strTemplate="" ;
  scrName="";
  checkComp=document.UpdateForm.outbb002.value.substr(3,1)
    if (checkComp=="D") {
     strTemplate="081";
     scrName="DF";}
    if (checkComp=="A") {
     strTemplate="240";
     scrName="AD"; }
   if (checkComp=="O") {
     strTemplate="241";
     scrName="OD"; }
   if (checkComp=="M" || document.UpdateForm.opwamvny.value == "1") {
     strTemplate="342";
     //strTemplate="242";
     scrName="MV"; }
   if (checkComp=="F") {
     strTemplate="243";
     scrName="FD"; }
   if (checkComp=="H") {
     strTemplate="244";
     scrName="PR"; }
   if (checkComp=="S") {
     strTemplate="245";
     scrName="SH"; }
   if (checkComp=="V") {
     strTemplate="246";
     scrName="WV"; }
   if (checkComp=="W") {
     strTemplate="247";
     scrName="WW"; }
   if (checkComp=="E") {
     strTemplate="248";
     scrName="OS"; }
   if (checkComp=="G") {
     strTemplate="249";
     scrName="OV"; }

  if (strTemplate=="") {
    if ((document.UpdateForm.ptcnueoc.value==1) &&
        (document.UpdateForm.outbb002.value.substr(5,1)=='A')) {
      scrName="ACC";
      document.UpdateForm.nextpage.value="6"
      document.UpdateForm.redirect.value="eocweb01.pbl?reportno=1&template=006"
        + "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")
        + "&returncd=OUT";
    }
    else {
     if(document.UpdateForm.outbb023.value.substr(3,1)=="C") {
     document.UpdateForm.nextpage.value="6"
     document.UpdateForm.redirect.value="outweb02.pbl?reportno=3&template=001" +
         "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+") +
         "&admissno=" + PatientLinks.admissno.value.replace(/ /g,"+") +
         "&showtran=1";
     }
    }
  }
  else {
    document.UpdateForm.nextpage.value="6"
    document.UpdateForm.redirect.value="patweb89.pbl?reportno=01" +
               "&template=" + strTemplate +
               "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+") +
               "&admissno=" + PatientLinks.admissno.value.replace(/ /g,"+");
    document.UpdateForm.redirect.value+= "&pmext049=" + 
    document.UpdateForm.opwamvny.value + "&chckcomp="+ checkComp+"O";
  }

  if(chkExtraTempl(document.UpdateForm,"B",document.UpdateForm.newslotk.value,
                PatientLinks.urnumber.value.replace(/ /g,"+"),scrName)) {
    document.UpdateForm.nextpage.value="6";
  }
}
function DisplayWarning(){
  if(UpdateForm.outbb070.value.substr(3,1)=="W"){
     alert("Warning: This code is only to be used \n"
           +"when the patient or carer is not present.");
  }
}
function ShowTelehealth() {
  if(document.UpdateForm.teleindc.value.substr(4,1)=="T") {
     BlankLine.innerHTML=blankline.innerHTML;
     TeleHlthStatus.innerHTML=telestatushead.innerHTML;
     TeleHlthStVal.innerHTML=telestatusvalue.innerHTML;
     TeleHlthRecSite.innerHTML=telerecsitehead.innerHTML;
     TeleHlthRecSiteVal.innerHTML=telerecsiteval.innerHTML;
     TeleHlthWaitRoom.innerHTML=telewaitroomhead.innerHTML;
     TeleHlthWaitRoomVal.innerHTML=telewaitroomval.innerHTML;
     TeleHlthDialInNum.innerHTML=teledialinnumhead.innerHTML;
     TeleHlthDialInNumVal.innerHTML=teledialinnumval.innerHTML;
  }
}
function DisabledFields(){
  f = document.UpdateForm;
  f.outbb068.disabled = true;
  f.outbb072.disabled = true;
  f.outbb069.disabled = true;
}
function ReEnableFields(){
  f = document.UpdateForm;
  f.outbb068.disabled = false;
  f.outbb072.disabled = false;
  f.outbb069.disabled = false;
}
function valReferralClaim() {
  var claimCodeVal = UpdateForm.outbb002.value.substr(0,3);
  var serverURL = "../cgi-bin/outweb02.pbl?reportno=9&updatety=19" +
                  "&admissno="+PatientLinks.admissno.value.replace(/ /g,"+") +
                  "&outbb002="+claimCodeVal +
                  "&urnumber="+PatientLinks.urnumber.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    if (ReturnValue[0] === '1') {
      var categoryName = ReturnValue[3].trim();
      var ans=confirm("The Outpatient Appointment " + categoryName +
      " does not match the Referral " + categoryName + ".\n\n" +
      "Outpatient Appointment " + categoryName + " = " + ReturnValue[2] +
      "\n" +
      "Referral " + categoryName + " = " + ReturnValue[1] + "\n\n" +
      "Press OK to update the Referral " + categoryName + " code.\n" +
      "Press Cancel to leave the Referral " +categoryName+ " code unchanged.");
      if (ans) {

        var fundingSourceVal = " ";
        if (UpdateForm.pmsvx141 !== undefined) {
          fundingSourceVal = UpdateForm.pmsvx141.value.substr(0,3);
        }
        var serverURL = "../cgi-bin/outweb02.pbl?reportno=9&updatety=20" +
                        "&admissno="+PatientLinks.admissno.value.replace(/ /g,"+") +
                        "&outbb002="+claimCodeVal+"&pmsvx141="+fundingSourceVal +
                        "&urnumber="+PatientLinks.urnumber.value.replace(/ /g,"+");
        var returnValue = RSExecute(serverURL);
      }
    }
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);
              makeCheck();
              SendLetter(UpdateForm);
              showFundingSource(UpdateForm);
              defaultDisasterCode();
              ValVisitType();
              ShowTelehealth();
              DisabledFields();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Update Appointment - %OUTWEB02.03.618.1 - %OUTWEB02.03.002
</span>
<div id=PageBodySection style="overflow: auto;">
<form action=outweb02.pbl method=post name=UpdateForm id=UpdateForm
 onsubmit='return validateMandatory(this);' >
<input type=hidden name=reportno id=reportno value="04">
<input type=hidden name=template id=template value="004">
<input type=hidden name=urnumber id=urnumber value="%OUTWEB02.03.003">
<input type=hidden name=admissno id=admissno value="%OUTWEB02.03.081">
<input type=hidden name=casekeys id=casekeys value="%OUTWEB02.03.366" >
<input type=hidden name=updatety id=updatety value="6">
<input type=hidden name=defclnty id=defclnty value="%OUTWEB02.03.308">
<input type=hidden name=defclnid id=defclnid value="%OUTWEB02.03.303.0">
<input type=hidden name=defvisty id=defvisty value="%OUTWEB02.03.310.1">
<input type=hidden name=defclmty id=defclmty value="%OUTWEB02.03.321.1">
<input type=hidden name=redirect id=redirect value="">
<input type=hidden name=nextpage id=nextpage value="">
<input type=hidden name=ptcnueoc id=ptcnueoc value="%OUTWEB02.03.616">
<input type=hidden name=dumdate  id=dumdate value="">
<input type=hidden name=dumInput id=dumInput value="">
<input type=hidden name=clinindc id=clinindc value="%OUTWEB02.03.628">
<input type=hidden name=ptcnuebb id=ptcnuebb value="">
<input type=hidden name=obacompd id=obacompd value="%OUTWEB02.03.321.3">
<input type=hidden name=dateclin id=dateclin value="%OUTWEB02.03.304">
<input type=hidden name=ibcnumci id=ibcnumci value="%STANDARD.01.025.000.132.0.1">
<input type=hidden name=otmaumci id=otmaumci value="%OUTWEB02.03.634">
<input type=hidden name=datefrom id=datefrom>
<input type=hidden name=dateto   id=dateto>
<input type=hidden name=otheccar id=otheccar value="%OUTWEB02.03.641">
<input type=hidden name=outbb065 id=outbb065 value="%OUTWEB02.03.327.001">
<input type=hidden name=othendps id=othendps value="%OUTWEB02.03.658">
<input type=hidden name=currdate id=currdate value="%STANDARD.01.015">
<input type=hidden name=ptcnxcom id=ptcnxcom value="%STANDARD.01.025.116.222.0.1">
<input type=hidden name=outbb071 id=outbb071 value="">
<input type=hidden name=disacode id=disacode value="%OUTWEB02.03.661">
<input type=hidden name=disadesc id=disadesc value="%OUTWEB02.03.662">
<input type=hidden name=otheclhr id=otheclhr value="%OUTWEB02.03.640.042">
<input type=hidden name=teleindc id=teleindc value="%OUTWEB02.03.327.006.3">
<input type=hidden name=opclcin1>

<table cellspacing=0 cellpadding=0 border=0 width=95% align=center>
<tr><td width=15% class=DataLabel>Clinic</td>
 <td class=DataField>
<input type=hidden name=newslotk id=newslotk value="%OUTWEB02.03.366">
<input type=text size=30 name=clindesc id=clindesc readonly class=ReadOnly
 title="Clinic" value="%OUTWEB02.03.327.011.1" tabindex=-1>
</td>
  <td class=DataLabel> Date </td>
  <td class=DataField>
  <input type=text size=35 name=clindate id=clindate readonly class=ReadOnly tabindex=-1
   value="%OUTWEB02.03.313 %OUTWEB02.03.304 at %OUTWEB02.03.316">
  </td>
</tr>
<tr><td class=DataLabel>Visit Type</td>
    <td class=DataField>
    <select name=outbb047 id=outbb047 title="Visit Type" class="SelectBig Mandatory"
     tabindex=1 onchange="SendLetter(UpdateForm);ValVisitType();">
    %OUTWEB02.03.399
    </select>
    </td></tr>

<tr valign=top>
    <td class=DataLabel>Presenting Complaint</td>
    <td class=DataField>
    <input type=text name=pmsvx052 id=pmsvx052 size=50 maxlength=50 tabindex=2
      value="%OUTWEB02.03.852">
</td></tr>

<tr valign=top>
    <td class=DataLabel>Diagnosis</td>
    <td class=DataField colspan=5>
    <input type=text size=15 name=outbb045 id=outbb045 value="%OUTWEB02.03.364" tabindex=3
     onblur="validateCode(6,UpdateForm.outbb045,UpdateForm.outbb046);">
    <input type=text name=outbb046 id=outbb046 readonly class=Readonly size=75 tabindex=-1
     maxlength=50 value="%OUTWEB02.03.365">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.outbb045,UpdateForm.outbb046);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb045,UpdateForm.outbb046);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=5>
    <input type=text size=15 name=outbb055 id=outbb055 value="%OUTWEB02.03.379" tabindex=4
     onblur="validateCode(6,UpdateForm.outbb055,UpdateForm.outbb056);">
    <input type=text name=outbb056 id=outbb056 readonly class=Readonly
     size=75 tabindex=-1 maxlength=50 value="%OUTWEB02.03.380">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.outbb055,UpdateForm.outbb056);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb055,UpdateForm.outbb056);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=5>
    <input type=text size=15 name=outbb057 id=outbb057 value="%OUTWEB02.03.381" tabindex=5
     onblur="validateCode(6,UpdateForm.outbb057,UpdateForm.outbb058);">
    <input type=text size=75 maxlength=50 name=outbb058 id=outbb058
     readonly tabindex=-1 class=Readonly value="%OUTWEB02.03.382">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.outbb057,UpdateForm.outbb058);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb057,UpdateForm.outbb058);">
    </td></tr>
<tr><td>&nbsp;</td>
    <td class=DataField colspan=5>
    <input type=text size=15 name=outbb059 id=outbb059 value="%OUTWEB02.03.383" tabindex=6
     onblur="validateCode(6,UpdateForm.outbb059,UpdateForm.outbb060);">
   <input type=text size=75 maxlength=50 name=outbb060 id=outbb060
    readonly tabindex=-1 class=Readonly value="%OUTWEB02.03.384" >
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.outbb059,UpdateForm.outbb060);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb059,UpdateForm.outbb060);">
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td><table cellspacing=0 cellpadding=0>
        <tr><td>
        <select name=outbb002 id=outbb002 class="Mandatory SelectBig" tabindex=7
        title="%STANDARD.01.017.CL" onchange="showFundingSource(UpdateForm);">
        <option></option>
        %OUTWEB02.03.321.9.1.10.2.X
        </select>
        </td>
        <td><div id=FundingHeading></div></td>
        <td><div id=FundingId></div></td>
        </table>
    </td>
    <td class=DataLabel>Referring GP</td>
    <td class=DataField>
    <input type=hidden name=outbb029 id=outbb029 value='%OUTWEB02.03.390'>
    <input type=hidden name=dummy1 id=dummy1 value="6">
    <input type=text readonly name=genpname id=genpname class=Readonly tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="HCPSearchFrame(outbb029,genpname,dummy1.value)">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(outbb029,genpname);">
    </td>
    </tr>

<tr>
    <td class=DataLabel>
      Has this patient been in a Motor Vehicle Accident?
    </td>
    <td>
      <select class="Mandatory" name=opwamvny tabindex=1
       title="Has this patient been in a Motor Vehicle Accident?">
        %OUTWEB02.03.699.012.099.050
      </select>
    </td>
  </tr>


<tr><td class=DataLabel>NMDS Code</td>
    <td class=DataField><select name=outbb068 id=outbb068 class=SelectBig tabindex=8>
        <option></option>
        %OUTWEB02.03.327.004.2
        </select>
    </td>
    <td class=DataLabel>Transport</td>
    <td><select name=outbb023 id=outbb023 class=SelectBig tabindex=21>
        <option value="   ">NO</option>
        %OUTWEB02.03.342.2
        </select>&nbsp;%OUTWEB02.03.659.1</td>
    </tr>

<tr><td class=DataLabel>Tier 2 Code</td>
    <td class=DataField><select name=outbb072 id=outbb072 tabindex=8
        class="SelectBig" title="Tier 2 Code">
        <option></option>
        %OUTWEB02.03.327.012.2
        </select>
    </td>
    <td class=DataLabel>Service Delivery Mode</td>
    <td class=DataField><select name=outbb070 id=outbb070 class=SelectBig tabindex=21
     onchange="DisplayWarning();">
        <option></option>
        %OUTWEB02.03.327.006.2
        </select>
        </td>
    </tr>

<tr><td class=DataLabel valign=top><div id=BlankLine></div></td>
    <td class=DataLabel valign=top><div id=BlankLine></div></td>
    <td class=DataLabel valign=top><div id=TeleHlthStatus></div></td>
    <td class=DataField valign=top style="word-break:break-all;"><div id=TeleHlthStVal></div></td>
</tr>

<tr><td class=DataLabel valign=top><div id=BlankLine></div></td>
    <td class=DataLabel valign=top><div id=BlankLine></div></td>
    <td class=DataLabel valign=top><div id=TeleHlthRecSite></div></td>
    <td class=DataField valign=top style="word-break:break-all;"><div id=TeleHlthRecSiteVal></div></td>
</tr>

<tr><td class=DataLabel valign=top><div id=BlankLine></div></td>
    <td class=DataLabel valign=top><div id=BlankLine></div></td>
    <td class=DataLabel valign=top><div id=TeleHlthWaitRoom></div></td>
    <td class=DataField valign=top style="word-break:break-all;"><div id=TeleHlthWaitRoomVal></div></td>
</tr>

<tr><td class=DataLabel valign=top><div id=BlankLine></div></td>
    <td class=DataLabel valign=top><div id=BlankLine></div></td>
    <td class=DataLabel valign=top><div id=TeleHlthDialInNum></div></td>
    <td class=DataField valign=top style="word-break:break-all;"><div id=TeleHlthDialInNumVal></div></td>
</tr>

<tr><td class=DataLabel>Care Type</td>
    <td class=DataField><select name=outbb069 id=outbb069 class=SelectBig tabindex=9>
        <option></option>
        %OUTWEB02.03.327.005.2
        </select>
    </td>
    <td class=DataLabel>Clinical High Risk</td>
    <td><input type=checkbox value=1 name=d_outbb071 id=d_outbb071 tabindex=22></td>
    </tr>

<tr><td class=DataLabel>Notify GP</td>
    <td><input type=checkbox value=1 name=outbb036 id=outbb036 tabindex=10></td>
    <td class=DataLabel>Generate Letter date</td>
    <td><input type=text name=outbb066 id=outbb066 size=12 tabindex=23
     onblur="checkDate(this,'Date');CheckLetterDate(UpdateForm);"
     value="%OUTWEB02.03.327.002"
     class="Date" title="Generate Letter Date">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.outbb066
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.outbb066>
    </td>
    </tr>

<tr><td class=DataLabel>Consent MyHR upload?</td>
    <td><select name=outbb017 id=outbb017 tabindex=10 title="Consent MyHR Upload" class=DataField>
         <option></option>
         %OUTWEB02.03.336.2
         </select>&nbsp;(<a href="javascript:patientMyhrConsentForm();">form</a>)
    </td>
    <td></td>
    <td></td>
    </tr>

<tr><td class=DataLabel>Send Letter</td>
    <td><select name=outbb067 id=outbb067 title="Send Letter" tabindex=11
         onchange="SendLetterDate(UpdateForm);CheckLetterDate(UpdateForm);">
         <option></option>
         %OUTWEB02.03.327.003.2
         </select>
    </td>
    <td>Disaster Code</td>
    <td>
    <div id=disastercodeDIV></div>
    </td>
    </tr>
<tr>
    <td>Interpreter Required</td>
    <td><input type="hidden" name="pmsvx093" id="pmsvx093" value="">
        <input type="checkbox" name="d_pmsvx093" id="d_pmsvx093" value="1" tabindex=12>
    &nbsp;
    <span class="Red">%OUTWEB02.03.086.002.0</span>
    </td>
    <td class=DataLabel><div id=disasteridnumbertitleDIV></div></td>
    <td><div id=disasteridnumberDIV></div></td>
</tr>

      <tr>
        <td>
          <table border=0 width=100% class=TableBody cellpadding=0
                 cellspacing=0>
            <tr><td class=DataLabel>Appointment Comments</td></tr>
            <tr><td colspan=6 align=left>
                <input type=button value="Add" class="button"
                 name="AddComm" id="AddComm"
                 onclick="tempDisable(this);AddComment();"></td></tr>
            <tr><td>&nbsp;</td></tr>
            <tr><td>&nbsp;</td></tr>
          </table>
        </td>
        <td colspan=6 align=left>
          <textarea wrap=hard name=outptcoa id=outptcoa class=Readonly readonly
           rows=4 cols=75>%OUTWEB02.03.327.016.005</textarea>
        </td>
      </tr>

<tr valign=top><td class=DataLabel>Patient Instructions (Printable)</td>
   <td class=DataField colspan=5>
   <textarea name=patinstr id=patinstr wrap=hard cols=60 rows=4 tabindex=61
    onkeydown="LimitText(this,99,200);">%OUTWEB02.03.680</textarea>
   </td></tr>

</table>

<div id=ShowXCmbs></div>
<div id=ShowCarer></div>

<table border=0 width=95% cellspacing=0 cellpadding=0 align=center>
<tr><td colspan=5 align=center>
    <input type=button class="button" value="Ok" id="out02sub" tabindex=100
     onclick="tempDisable(this);UpdateApp();">
    <input type=button class="button" value="Cancel" tabindex=101
     onclick="DFrameCloseRefresh();">
    </td></tr>
</table>
</form>
</div>

<span id=extracmbs style="display:none">
<table border=0 width=95% cellspacing=0 cellpadding=0 align=center>

<tr><td width=15% class=DataLabel>CMBS Code</td>
    <td class=DataField>
    <input type=hidden name=otbit001 id=otbit001 title="Item Type"
     value="%OUTWEB02.03.624. 1.0">
    <input type=text size=9 name=otbit002 id=otbit002 title="Item Code"
     tabindex=70
     value="%OUTWEB02.03.625. 1"
     onchange="validatePMBS(otbit002,mbsdesc1,otbit001,otbit003,dateclin,mbsamnt1);">
    <input type=text size=3 name=otbit003 id=otbit003 title="Sub-Item Code"
     tabindex=71 value="%OUTWEB02.03.626. 1"
     onchange="validatePMBS(otbit002,mbsdesc1,otbit001,otbit003,dateclin,mbsamnt1);">
    <input type=text size=30 name=mbsdesc1 id=mbsdesc1 value="%OUTWEB02.03.627. 1.0"
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt1 id=mbsamnt1 value="%OUTWEB02.03.627. 1.1"
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
     onclick=PriMbsSearchFrame(otbit001,otbit002,otbit003,dumdate,mbsdesc1,dumInput,TypeDesc1)>
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(otbit002,otbit003,mbsdesc1,mbsamnt1,otbit016);">
    <input type=text maxlength=20 size=22 name=otbit016 id=otbit016 title="Provider Usage"
     tabindex=72 value="%OUTWEB02.03.635. 1">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit004 id=otbit004 title="Item Type 2"
     value="%OUTWEB02.03.624. 2.0">
    <input type=text size=9 name=otbit005 id=otbit005 title="Item Code 2"
     tabindex=73 value="%OUTWEB02.03.625. 2"
     onchange="validatePMBS(otbit005,mbsdesc2,otbit004,otbit006,dateclin,mbsamnt2);">
    <input type=text size=3 name=otbit006 id=otbit006 title="Sub-Item Code 2"
     tabindex=74 value="%OUTWEB02.03.626. 2"
     onchange="validatePMBS(otbit005,mbsdesc2,otbit004,otbit006,dateclin,mbsamnt2);">
    <input type=text size=30 name=mbsdesc2 id=mbsdesc2 value="%OUTWEB02.03.627. 2.0"
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt2 id=mbsamnt2 value="%OUTWEB02.03.627. 2.1"
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick=PriMbsSearchFrame(otbit004,otbit005,otbit006,dumdate,mbsdesc2,dumInput,TypeDesc2)>
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(otbit005,otbit006,mbsdesc2,mbsamnt2,otbit017);">
    <input type=text maxlength=20 size=22 name=otbit017 id=otbit017 title="Provider Usage 2"
     tabindex=75 value="%OUTWEB02.03.635. 2">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit007 id=otbit007 title="Item Type 3"
     value="%OUTWEB02.03.624. 3.0">
    <input type=text size=9 name=otbit008 id=otbit008 title="Item Code 3"
     tabindex=76 value="%OUTWEB02.03.625. 3"
     onchange="validatePMBS(otbit008,mbsdesc3,otbit007,otbit009,dateclin,mbsamnt3);" >
    <input type=text size=3 name=otbit009 id=otbit009 title="Sub-Item Code 3"
     tabindex=77 value="%OUTWEB02.03.626. 3"
     onchange="validatePMBS(otbit008,mbsdesc3,otbit007,otbit009,dateclin,mbsamnt3);" >
    <input type=text size=30 name=mbsdesc3 id=mbsdesc3 value="%OUTWEB02.03.627. 3.0"
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt3 id=mbsamnt3 value="%OUTWEB02.03.627. 3.1"
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick=PriMbsSearchFrame(otbit007,otbit008,otbit009,dumdate,mbsdesc3,dumInput,TypeDesc3)>
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(otbit008,otbit009,mbsdesc3,mbsamnt3,otbit018);">
    <input type=text maxlength=20 size=22 name=otbit018 id=otbit018 title="Provider Usage 3"
     tabindex=78 value="%OUTWEB02.03.635. 3">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit010 id=otbit010 title="Item Type 4"
     value="%OUTWEB02.03.624. 4.0">
    <input type=text size=9 name=otbit011 id=otbit011 title="Item Code 4"
     tabindex=79 value="%OUTWEB02.03.625. 4"
     onchange="validatePMBS(otbit011,mbsdesc4,otbit010,otbit012,dateclin,mbsamnt4);" >
    <input type=text size=3 name=otbit012 id=otbit012 title="Sub-Item Code 4"
     tabindex=80 value="%OUTWEB02.03.626. 4"
     onchange="validatePMBS(otbit011,mbsdesc4,otbit010,otbit012,dateclin,mbsamnt4);" >
    <input type=text size=30 name=mbsdesc4 id=mbsdesc4 value="%OUTWEB02.03.627. 4.0"
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt4 id=mbsamnt4 value="%OUTWEB02.03.627. 4.1"
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick=PriMbsSearchFrame(otbit010,otbit011,otbit012,dumdate,mbsdesc4,dumInput,TypeDesc4)>
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(otbit011,otbit012,mbsdesc4,mbsamnt4,otbit019);">
    <input type=text maxlength=20 size=22 name=otbit019 id=otbit019 title="Provider Usage 4"
     tabindex=81 value="%OUTWEB02.03.635. 4">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit013 id=otbit013 title="Item Type 5"
     value="%OUTWEB02.03.624. 5.0">
    <input type=text size=9 name=otbit014 id=otbit014 title="Item Code 5"
     tabindex=82 value="%OUTWEB02.03.625. 5"
     onchange="validatePMBS(otbit014,mbsdesc5,otbit013,otbit015,dateclin,mbsamnt5);" >
    <input type=text size=3 name=otbit015 id=otbit015 title="Sub-Item Code 5"
     tabindex=83 value="%OUTWEB02.03.626. 5"
     onchange="validatePMBS(otbit014,mbsdesc5,otbit013,otbit015,dateclin,mbsamnt5);" >
    <input type=text size=30 name=mbsdesc5 id=mbsdesc5 value="%OUTWEB02.03.627. 5.0"
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt5 id=mbsamnt5 value="%OUTWEB02.03.627. 5.1"
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick=PriMbsSearchFrame(otbit013,otbit014,otbit015,dumdate,mbsdesc5,dumInput,TypeDesc5)>
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(otbit014,otbit015,mbsdesc5,mbsamnt5,otbit020);">
    <input type=text maxlength=20 size=22 name=otbit020 id=otbit020 title="Provider Usage 5"
     tabindex=84 value="%OUTWEB02.03.635. 5">
    </td>
    </tr>

<tr><td>Use CMBS Template</td>
    <td><input type=checkbox value=1 name=cmbsload id=cmbsload onclick="TemplateCmbs();"
         tabindex=85>
    &nbsp;
    <select class="SelectBig" name=cmbstemp id=cmbstemp title="CMBS Template"
     tabindex=86 onchange="TemplateCmbs();">
          <option></option>
          %OUTWEB02.03.629
          </select></td>
    </tr>

<tr><td>Print Medicare Claims</td>
    <td><input type=checkbox value=1 name=claimprt id=claimprt tabindex=87>
    &nbsp;
    <select class="SelectBig" name=claimpsl id=claimpsl title="Printer" tabindex=88>
          <option></option>
          %STANDARD.01.001.OUTCLAIM.03
          </select></td>
    </tr>
</table>
</span>

<span id=sendcarer style="display:none">
<table border=0 width=95% cellspacing=0 cellpadding=0 align=center>
<tr><td width=15% class=DataLabel>Send Correspondence to Carer</td>
    <td class=DataField>
      <input type=checkbox value=1 name=d_outbb065 id=d_outbb065
       tabindex=90 onclick="SetCare();">
    </td>
</tr>
</table>
</span>

<span id=offdutyhd style="display:none">
&nbsp;Off Duty&nbsp;
</span>

<span id=offdutyid style="display:none">
<input type="checkbox" name="offdutyb" id="offdutyb" value="0">
</span>

<span id=blanklabel style="display:none">
<input type=hidden name=pmsvx141 id=pmsvx141 value=" ">
</span>

<span id=fundinghd style="display:none">
&nbsp;Funding Source&nbsp;
</span>

<span id=fundingid style="display:none">
<select name=pmsvx141 id=pmsvx141 title="%STANDARD.01.017.cx" tabindex=7>
<option> </option>
%OUTWEB02.03.899.009.5
</select>
</span>

<form name=PatientLinks id=PatientLinks method=get>
<input type=hidden name=reportno id=reportno value=1>
<input type=hidden name=template id=template value=004>
<input type=hidden name=urnumber id=urnumber value="%OUTWEB02.03.003">
<input type=hidden name=admissno id=admissno value="%OUTWEB02.03.081">
<input type=hidden name=MenuType id=MenuType value="%OUTWEB02.03.088">
<input type=hidden name=casekeys id=casekeys value="%OUTWEB02.03.366">
</form>

<script type="text/javascript">
function init(){
 var title = "%OUTWEB02.03.348.003"
 var gname  = "%OUTWEB02.03.348.004"
 var surname = "%OUTWEB02.03.348.005"

 UpdateForm.genpname.value = trim(title)+" "+trim(gname)+" "+trim(surname);
}

function makeCheck() {
 if ("%OUTWEB02.03.355" == "1") {
    UpdateForm.outbb036.checked = 1
 }
 if ("%OUTWEB02.03.327.007.1" == "1") {
    UpdateForm.d_outbb071.checked = 1
    UpdateForm.outbb071.value = 1
    if(document.UpdateForm.otheclhr.value=="1") {
      document.UpdateForm.d_outbb071.disabled=true;
    }
 }
}

DisplayXCmbs();
DisplayCarer();
ReferralNumber='%OUTWEB02.03.753.001';
ClinicHIC='%OUTWEB02.03.634';
UsingHIC='%STANDARD.01.025.000.132.0.1';
if (document.UpdateForm.clinindc.value=="P") {
  if(isWhitespace(ReferralNumber) && ClinicHIC=='1' && UsingHIC=='1') {
    alert("Warning - No referral linked to this visit.");
  }
}

PMIInterpreter="%OUTWEB02.03.086.001.0";
VisitInterpreter="%OUTWEB02.03.893.0";
if (PMIInterpreter != "1") {
  UpdateForm.d_pmsvx093.disabled=true;
} else {
 if (VisitInterpreter == "1") {
    UpdateForm.d_pmsvx093.checked = true;
 }
}

function ValVisitType() {
  if (UpdateForm.outbb047.value.substr(10,1) == "C") {
    // Visit Type is 'Chart Only'; disable 'Interpreter Required' checkbox
    UpdateForm.d_pmsvx093.checked=false;
    UpdateForm.d_pmsvx093.disabled=true;
  }
  else {
    UpdateForm.d_pmsvx093.disabled=false;
    PMIInterpreter="%OUTWEB02.03.086.001.0";
    if (PMIInterpreter != "1") {
      UpdateForm.d_pmsvx093.disabled=true;
    }
  }
}

var codeList = document.UpdateForm.outbb002.options;
var codeVal = document.UpdateForm.defclmty.value;
for (var i = 0; i < codeList.length; i++) {
  if (isWhitespace(codeList[i].value)) continue;
  var codeSingle = codeList[i].value.substr(3, 5);
  var codeVal2 = codeList[i].value.substr(0, 3);
  if (!isWhitespace(codeVal)) {
    if (codeVal == codeVal2) {
      var codeInd1 = codeSingle.substr(0, 1);
      if (codeInd1=="M") {
        document.UpdateForm.opclcin1.value = codeInd1;
        continue;
      }
    }
  }
  if (codeSingle.match(/M/g) != null && codeList[i].selected !=true) {
    document.UpdateForm.outbb002.options[i].remove(i);
    i--;
  }
}

MVAccYN="%OUTWEB02.03.699.012.050"
if (MVAccYN == "1") {
  document.UpdateForm.opwamvny.value = "1";
}
</script>

<span id=disasteridnumbertitleSPAN style="display:none">
Disaster Identification #
</span>

<span id=disasteridnumberSPAN style="display:none">
<input type="text" name=dispt002 id=dispt002 size=20 maxlength=19
   tabindex=24 title="Disaster Identification Number">
</span>

<span id=disastercodeSPAN1 style="display:none">
  <select name=dispt001 id=dispt001 tabindex=24 title="Disaster Code" class=SelectBig
   onchange="displayDisasterID();">
    <option></option>
    %OUTWEB02.03.660
  </select>
</span>

<span id=disastercodeSPAN2 style="display:none">
<input type="text" name=n_dispt001 id=n_dispt001 size=30 class=Readonly readonly
 tabindex=-1
  title="Disaster Code" value="%OUTWEB02.03.662">
<input type=hidden name=dispt001 id=dispt001 value="%OUTWEB02.03.661">
</span>

<span id=blankline       style="display:none"> </span>
<span id=telestatushead  style="display:none"> Telehealth Status </span>
<span id=telestatusvalue style="display:none"> %OUTWEB02.03.901.0 </span>

<span id=telerecsitehead style="display:none"> Telehealth Receiving Site </span>
<span id=telerecsiteval  style="display:none"> %OUTWEB02.03.902 </span>

<span id=telewaitroomhead style="display:none"> Telehealth Waiting Room </span>
<span id=telewaitroomval  style="display:none"> %OUTWEB02.03.905 </span>

<span id=teledialinnumhead style="display:none">Telehealth Dial-In Number</span>
<span id=teledialinnumval  style="display:none"> %OUTWEB02.03.906 </span>

