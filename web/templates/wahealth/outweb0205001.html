<meta name="TemplateVersion" content="V12.00.02">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/OutExtraTemplates.js"></script>
<script type="text/javascript" src="../js/outweb0205.js"></script>
<script type="text/javascript">
function displayDisasterID() {
 p=document.AddForm
  if (!isWhitespace(document.AddForm.dispt001.value)) {
    document.getElementById("disasteridnumbertitleDIV").innerHTML=
    document.getElementById("disasteridnumbertitleSPAN").innerHTML;
    document.getElementById("disasteridnumberDIV").innerHTML=
    document.getElementById("disasteridnumberSPAN").innerHTML;
  } else {
    document.getElementById("disasteridnumbertitleDIV").innerHTML="";
    document.getElementById("disasteridnumberDIV").innerHTML="";
  }

  if (!isWhitespace(disasteridnumberDIV.innerHTML)) {
    var serverURL   = "../cgi-bin/patweb80.pbl?reportno=98" +
                    "&valdcode=" + AddForm.urnumber.value.replace(/ /g,"+") +
                    AddForm.dispt001.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|");
      if (!isWhitespace(ReturnValue[0])) {
        p.dispt002.value=ReturnValue;
        p.dispt002.className="Readonly";
        p.dispt002.readOnly=true;
      }
    }
  }
}
function SubmitFinal() {
  if(document.AddForm.d_outbb071.checked==true) {
    document.AddForm.outbb071.value="1";
  } else {
    document.AddForm.outbb071.value="0";
  }
  p=document.AddForm
  if(p.offdutyb!=undefined){
    if(p.offdutyb.checked==true){
      alert("Error: Claim Type invalid for 'Off Duty' personnel.")
      return;
    }
  }

  validateSuspension(p.urnumber,p.dateclin,p.datefrom,p.dateto);
  if(p.datefrom.value!='0'){
       ans=confirm("Warning : Patient has a Suspension record for period \n" +
             "\t" + p.datefrom.value  + " - " + p.dateto.value);
       if (ans!=true) {
          return; }
  } 

  if (!isWhitespace(document.AddForm.dispt001.value)) {
    var serverURL   = "../cgi-bin/comweb80.pbl?reportno=44" +
                    "&valdcode=" + AddForm.dispt001.value.replace(/ /g,"+") +
                    AddForm.dateclin.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) {
      return;
    }
  }


  setRedirect()
  if(document.AddForm.d_pmsvx093.checked==true) {
    document.AddForm.pmsvx093.value="1";
  } else {
    document.AddForm.pmsvx093.value="0";
  }
  if (validateMandatory(AddForm)) {
    ReEnableFields();
    valReferralClaim();
    AddForm.submit() }
}

//-----------------------------------------------------------------
// Function To check Referral Letters
//-----------------------------------------------------------------
function checkRefLetter(urnumber) {
  if (isWhitespace(urnumber)) return;;
  ReturnFunction="" ;
  for (var i=1; i < checkRefLetter.arguments.length; i++) {
   if (typeof(checkRefLetter.arguments[i]) == 'function') {
     ReturnFunction=checkRefLetter.arguments[i] } }
  var serverURL = "../cgi-bin/outweb02.pbl?reportno=9&updatety=6" +
                  "&urnumber="+urnumber.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  ReturnValue=returnValue.return_value.split("|");
  if (returnValue.status==0) {

    if (ReturnValue[0] == 1) {    // Unbooked referral exists
 
      // Construct warning message
      if (isWhitespace(ReturnValue[1])) 
        { ReturnValue[1] = "Unknown Date"; }
      if (isWhitespace(ReturnValue[2])) 
        { ReturnValue[2] = "Unknown"; }
      if (isWhitespace(ReturnValue[3])) 
        { ReturnValue[3] = "Unknown"; }
      var message = "Warning : Referral Letter Exists for " + ReturnValue[1] +
                    "; Clinic Type " + ReturnValue[2] + "; Clinic Id " +
                    ReturnValue[3] + "\nClick OK to continue " +
                    "without selecting the letter, Cancel to select letter.";

      ans=confirm(message)
      if (!ans) { 
        PatientLinkTo("allweb02.pbl",2,22,0,0,0);
      }
    }
    if (typeof(ReturnFunction) == 'function') { ReturnFunction() } 
  }
}
function setRedirect() {
  if (document.AddForm.ptcnxcom != undefined) {
    if (document.AddForm.ptcnxcom.value == "1") {
      setRedirectXCom();
      return;
    }
  }

  strTemplate="" ;
  scrName="";
  checkInd=document.AddForm.outbb002.value.substr(3,5)
  if(checkInd.search(/W/g) >= 0) {
    strTemplate="041"; 
    scrName="WC";}
  if(checkInd.search(/M/g) >= 0) {
    strTemplate="042";
    scrName="TAC";}
  if(checkInd.search(/V/g) >= 0) {
    strTemplate="043"; 
    scrName="VA";}
  if(checkInd.search(/D/g) >= 0) {
    strTemplate="081";
    scrName="DF";}
  checkInd=document.AddForm.outbb002.value.substr(8,1)
  if(checkInd.search(/C/g) >= 0) {
    strTemplate="048"; 
    scrName="CT";}

  if (strTemplate=="") {
    if ((document.AddForm.ptcnueoc.value==1) &&
        (document.AddForm.outbb002.value.substr(5,1)=='A')) {
      scrName="ACC";
      document.AddForm.redirect.value="eocweb01.pbl?reportno=1&template=006"
        + "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")
        + "&returncd=OUT";
    }
    else {
      document.AddForm.redirect.value="outweb02.pbl?reportno=3&template=1" +
                                      "&shwprint=1" 
    }
  }
  else {
    document.AddForm.redirect.value="patweb89.pbl?reportno=01" +
               "&template=" + strTemplate +
               "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")  
  }
  if(chkExtraTempl(document.AddForm,"B",document.AddForm.newslotk.value,
                PatientLinks.urnumber.value.replace(/ /g,"+"),scrName)) {
    document.AddForm.redirect.value = document.AddForm.redirect.value +
                                      "&shwprint=1"
  }
}

function setRedirectXCom() {
  strTemplate="" ;
  scrName="";
  checkComp=document.AddForm.outbb002.value.substr(3,1)
    if (checkComp=="D") {
     strTemplate="081";
     scrName="DF";}
    if (checkComp=="A") {
     strTemplate="240";
     scrName="AD"; }
   if (checkComp=="O") {
     strTemplate="241";
     scrName="OD"; }
   if (checkComp=="F") {
     strTemplate="243";
     scrName="FD"; }
   if (checkComp=="H") {
     strTemplate="244";
     scrName="PR"; }
   if (checkComp=="S") {
     strTemplate="245";
     scrName="SH"; }
   if (checkComp=="V") {
     strTemplate="246";
     scrName="WV"; }
   if (checkComp=="W") {
     strTemplate="247";
     scrName="WW"; }
   if (checkComp=="E") {
     strTemplate="248";
     scrName="OS"; }
   if (checkComp=="G") {
     strTemplate="249";
     scrName="OV"; }
   if (checkComp=="M" || document.AddForm.opwamvny.value == "1") {
     //strTemplate="242";
     strTemplate="342";
     scrName="MV"; }

  if (strTemplate=="") {
    if ((document.AddForm.ptcnueoc.value==1) &&
        (document.AddForm.outbb002.value.substr(5,1)=='A')) {
      scrName="ACC";
      document.AddForm.redirect.value="eocweb01.pbl?reportno=1&template=006"
        + "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")
        + "&returncd=OUT";
    }
    else {
      document.AddForm.redirect.value="outweb02.pbl?reportno=3&template=1" +
                                      "&shwprint=1"
    }
  }
  else {
    document.AddForm.redirect.value="patweb89.pbl?reportno=01" +
               "&template=" + strTemplate +
               "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+") +
               "&pmext049=" + document.AddForm.opwamvny.value+
               "&chckcomp=" + checkComp+"O";
  }
  if(chkExtraTempl(document.AddForm,"B",document.AddForm.newslotk.value,
                PatientLinks.urnumber.value.replace(/ /g,"+"),scrName)) {
    document.AddForm.redirect.value = document.AddForm.redirect.value +
                                      "&shwprint=1"
  }
}

function ClinicSearch() {
  cancelSlot(AddForm.newslotk.value,ClinicSearchLink)
}
function ClinicSearchLink() {
  window.ReturnFunction="" ;
  window.ReturnFunction=DisplayXCmbs;
  ClinicSearchFrame(AddForm.newslotk,AddForm.clindesc,AddForm.clindate,
                    AddForm.defclnty,AddForm.defclnid,AddForm.defvisty,
                    AddForm.deftovrd,AddForm.refrlvis)
}
function AppointSearch() {
  cancelSlot(AddForm.newslotk.value,AppointSearchLink)
}
function AppointSearchLink() {
  window.ReturnFunction="" ;
  window.ReturnFunction=DisplayXCmbs;
  AppointmentSearchFrame(AddForm.newslotk,AddForm.clindesc,AddForm.clindate,
                         AddForm.defclnty,AddForm.defclnid,AddForm.defvisty,
                         AddForm.deftovrd,AddForm.refrlvis)
}

function fnCancel() {
 if (isWhitespace(AddForm.newslotk.value)) {
   history.back(); }
 else {
   cancelSlot(AddForm.newslotk.value,SessionLink);
  }
}
function SessionLink() {
   if(AddForm.redirflg.value=="1") {
     SESSKEYS=AddForm.newslotk.value.substr(0,28).replace(/ /g,"+")
     location.href="outweb02.pbl?reportno=2&template=011&sesskeys="+SESSKEYS
   } else {
     SESSKEYS=AddForm.newslotk.value.substr(0,28).replace(/ /g,"+")
     location.href="outweb02.pbl?reportno=2&template=4&sesskeys="+SESSKEYS
   }
}
function valClaimCode() {
  validateCode(41,AddForm.urnumber,AddForm.claimc);
  for (var i =0 ; i < document.AddForm.outbb002.length; i++) {
//    alert(AddForm.outbb002.options[i].value.substr(0,3));
    if (document.AddForm.claimc.value==
        trim(document.AddForm.outbb002.options[i].value.substr(0,3))){
          document.AddForm.outbb002.selectedIndex=i;
    }
  }
  showFundingSource(AddForm);
  if(document.AddForm.otheclhr.value=="1") {
    document.AddForm.d_outbb071.checked=true;
    document.AddForm.d_outbb071.disabled=true;
  }
}
function DisplayWarning(){
  if(AddForm.outbb070.value.substr(3,1)=="W"){
     alert("Warning: This code is only to be used \n"
           +"when the patient or carer is not present.");
  }
}
function DisabledFields(){
  f = document.AddForm;
  f.outbb068.disabled = true;
  f.outbb072.disabled = true;
  f.outbb069.disabled = true;
}
function ReEnableFields(){
  f = document.AddForm;
  f.outbb068.disabled = false;
  f.outbb072.disabled = false;
  f.outbb069.disabled = false;
  f.outbb067.disabled = false;
}
function valReferralClaim() {
  var claimCodeVal = AddForm.outbb002.value.substr(0,3);
  var serverURL = "../cgi-bin/outweb02.pbl?reportno=9&updatety=19" +
                  "&admissno="+PatientLinks.admissno.value.replace(/ /g,"+") +
                  "&outbb002="+claimCodeVal +
                  "&urnumber="+PatientLinks.urnumber.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    if (ReturnValue[0] === '1') {
      var categoryName = ReturnValue[3].trim();
      var ans=confirm("The Outpatient Appointment " + categoryName +  
      " does not match the Referral " + categoryName + ".\n\n" +
      "Outpatient Appointment " + categoryName + " = " + ReturnValue[2] +
      "\n" +
      "Referral " + categoryName + " = " + ReturnValue[1] + "\n\n" +
      "Press OK to update the Referral " + categoryName + " code.\n" +
      "Press Cancel to leave the Referral " +categoryName+ " code unchanged.");
      if (ans) {
        var fundingSourceVal = AddForm.pmsvx141.value.substr(0,3);
        var serverURL = "../cgi-bin/outweb02.pbl?reportno=9&updatety=20" +
                        "&admissno="+PatientLinks.admissno.value.replace(/ /g,"+") +
                        "&outbb002="+claimCodeVal+"&pmsvx141="+fundingSourceVal +
                        "&urnumber="+PatientLinks.urnumber.value.replace(/ /g,"+");
        var returnValue = RSExecute(serverURL);
      }
    }
  }
}
</script>
</head>
%START.OF.PAGE
<script type="text/javascript">
function SetAppointDefaults() {
  if(document.AddForm.slotbtyp.value=="1") {  // OP booking from add slot
    document.AddForm.defclnty.value="%OUTWEB02.05.353.067.1";
    document.AddForm.defclnid.value="%OUTWEB02.05.353.088.1";
    document.AddForm.defvisty.value="%OUTWEB02.05.353.095";
    document.AddForm.defclaim.value="%OUTWEB02.05.353.035.1";
    document.AddForm.deffunds.value="%OUTWEB02.05.499.009.1";
    document.AddForm.outbb045.value="%OUTWEB02.05.353.031.1";
    document.AddForm.outbb046.value="%OUTWEB02.05.353.031.0";
    document.AddForm.outbb055.value="%OUTWEB02.05.353.032.1";
    document.AddForm.outbb056.value="%OUTWEB02.05.353.032.0";
    document.AddForm.outbb057.value="%OUTWEB02.05.353.033.1";
    document.AddForm.outbb058.value="%OUTWEB02.05.353.033.0";
    document.AddForm.deftovrd.value="1";
    for (var i=0; i < document.AddForm.outbb002.length; i++) {
     if (document.AddForm.outbb002.options[i].value.substr(0,3)==
         document.AddForm.defclaim.value.substr(0,3)){
         document.AddForm.outbb002.selectedIndex=i;
     }
    }
    showFundingSource(AddForm);
    if(document.AddForm.pmsvx141!=undefined &&
       !isWhitespace(document.AddForm.deffunds.value)) {
      for (var i=0; i < document.AddForm.pmsvx141.length; i++) {
       if (document.AddForm.pmsvx141.options[i].value.substr(0,3)==
           document.AddForm.deffunds.value.substr(0,3)){
           document.AddForm.pmsvx141.selectedIndex=i;
       }
      }
    }
    document.AddForm.outbb029.value=document.HiddenFields.alrerhcp.value
    document.AddForm.genpname.value=document.HiddenFields.d_alrerhcp.value
    if (!isWhitespace("%OUTWEB02.05.353.081")) {
      document.AddForm.pmsvx052.value=trim("%OUTWEB02.05.353.081");
    }
    document.AddForm.bookflag.value="2";
    document.AddForm.refrlvis.value=document.AddForm.slotrefn.value;
  } else if (document.AddForm.slotbtyp.value=="2") {    // Appointment Request
    document.AddForm.bookflag.value="3";
    document.AddForm.refrlvis.value=document.AddForm.slotrefn.value;
    document.AddForm.requestk.value=document.AddForm.slotreqk.value;
    document.AddForm.defclnty.value="%OUTWEB02.05.362.010.1"; // Clinic Type
    document.AddForm.defclnid.value="%OUTWEB02.05.362.011.1"; // Clinic Id
    document.AddForm.defvisty.value="%OUTWEB02.05.362.012.1"; // Slot Type
    document.AddForm.defclaim.value="%OUTWEB02.05.362.015.1"; // Claim Code
    document.AddForm.deffunds.value="%OUTWEB02.05.362.042.1"; // Funding Source
    for (var i=0; i < document.AddForm.outbb002.length; i++) {
     if (document.AddForm.outbb002.options[i].value.substr(0,3)==
         document.AddForm.defclaim.value.substr(0,3)){
         document.AddForm.outbb002.selectedIndex=i;
     }
    }

    //Display funding source, and sets it to correct value
    showFundingSource(AddForm);
    if(document.AddForm.pmsvx141!=undefined &&
       !isWhitespace(document.AddForm.deffunds.value)) {
      for (var i=0; i < document.AddForm.pmsvx141.length; i++) {
       if (document.AddForm.pmsvx141.options[i].value.substr(0,3)==
           document.AddForm.deffunds.value.substr(0,3)){
           document.AddForm.pmsvx141.selectedIndex=i;
       }
      }
    }

    document.AddForm.outptcom.value=document.getElementById("apprcomm").value;
    if (!isWhitespace("%OUTWEB02.05.362.014")) {
      document.AddForm.pmsvx052.value=trim("%OUTWEB02.05.362.014");   // Presenting C
    }
//    document.AddForm.outbb023.value="%OUTWEB02.05.362.013.3"; // Transport
      defTransport="%OUTWEB02.05.362.013.3"; // Transport
      for (var i=0; i < document.AddForm.outbb023.length; i++) {
       if (document.AddForm.outbb023.options[i].value.substr(0,3)==
           defTransport.substr(0,3)){
           document.AddForm.outbb023.selectedIndex=i;
       }
      }
  }
  if(isWhitespace(document.AddForm.slotrefn.value)) {
    checkRefLetter(document.AddForm.urnumber.value);
  }
  ExpireCookiePath("AppointmentTypeCookie");
}
function ValVisitType() {
  if (AddForm.outbb047.value.substr(10,1) == "C") {
    // Visit Type is 'Chart Only'; disable 'Interpreter Required' checkbox
    AddForm.d_pmsvx093.checked=false;
    AddForm.d_pmsvx093.disabled=true;
  }
  else {
    AddForm.d_pmsvx093.disabled=false;
    PMIInterpreter="%OUTWEB02.05.086.001.0";
    if (PMIInterpreter != "1") {
      AddForm.d_pmsvx093.disabled=true;
    }
  }
}

function SetSendLetter(){
 for (var i=0 ; i<document.AddForm.outbb067.length; i++) {
  if (document.AddForm.outbb067.options[i].value == '1' ) {
       document.AddForm.outbb067.selectedIndex=i;
       break;
  }
 }
}

function SendLetter(theForm) {
if(theForm.outbb067 != undefined) {
  if(theForm.outbb047.value.substr(10,1) == "C" ||
    (SetDateYYYYMMDD(theForm.clindate.value.substr(4,11)) <
     SetDateYYYYMMDD(theForm.currdate.value))) {   // Ind 8 - Chart Only or
    theForm.outbb067.selectedIndex=3;              // new booking less than
    theForm.outbb067.className="Readonly";         // today set send letter
    theForm.outbb067.disabled=true;                // N/A
    theForm.outbb036.checked=false;
    theForm.outbb036.disabled=true;
  } else {
    ResetLetter(AddForm);
    if(theForm.outbb067.disabled==true) {          // Default send letter to
       SetSendLetter();
    }
    theForm.outbb067.className="";
    theForm.outbb067.disabled=false;
    theForm.outbb067.className="";
    theForm.outbb036.disabled=false;
  }
  SendLetterDate(theForm);
}
}

function ResetLetter(theForm) {
    SetSendLetter();
    theForm.outbb066.value="";
    theForm.outbb066.readOnly=false;
    theForm.outbb066.className="Date";
}


</script>
<body onload="PageLoad(event);
              valClaimCode();
              DisplayXCmbs();
              SetAppointDefaults();
              ValVisitType();
              DisabledFields();">
<div id=HeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OUTWEB02.05.003";
PatientVIS="%OUTWEB02.05.081";
PatientNAM="%OUTWEB02.05.002";
PatientSTA="%OUTWEB02.05.086.078";
PatientALT="%OUTWEB02.05.084";
PatientSEX="%OUTWEB02.05.019";
PatientDOB="%OUTWEB02.05.020";
PatientAGE="%OUTWEB02.05.021";
PatientLOC="%OUTWEB02.05.083";
DoctorCOD="%OUTWEB02.05.082.003";
PatientPRI="%OUTWEB02.05.086.066.1";
PatientUNT="%OUTWEB02.05.066.0";
DoctorNAM="%OUTWEB02.05.082.002";
PatientAID="%OUTWEB02.05.086.090";
PatientIND="%OUTWEB02.05.086.091";
PatientCUR="%OUTWEB02.05.086.092";
PatientCLC="%OUTWEB02.05.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OUTWEB02.05.086.094";
PatientCDM="%OUTWEB02.05.086.095";
PatientVDH="%OUTWEB02.05.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<table cellspacing=0 cellpadding=1 border=0 width=100% >
<tr><td class=HeadingCell align=center width=100% >
    Make New Appointment</td></tr>
</table>
<form name=AddForm action=outweb02.pbl method=post style="margin:0">
<input type=hidden name=reportno value="06">
<input type=hidden name=template value="004">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="">
<input type=hidden name=urnumber value="%OUTWEB02.05.003">
<input type=hidden name=admissno value="%OUTWEB02.05.081">
<input type=hidden name=updatety value="5">
<input type=hidden name=bookflag value="">
<input type=hidden name=ptcnueoc value="%OUTWEB02.05.216">
<input type=hidden name=clinctyp value="%OUTWEB02.05.205.1">
<input type="hidden" name="claimc">
<input type=hidden name=datefrom>
<input type=hidden name=dateto>
<input type=hidden name=refrlvis value="">
<input type=hidden name=dumdate value="">
<input type=hidden name=dumInput value="">
<input type=hidden name=clinindc value="%OUTWEB02.05.228">
<input type=hidden name=ptcnuebb value="">
<input type=hidden name=dateclin value="%OUTWEB02.05.104">
<input type=hidden name=nslotkey value="%OUTWEB02.05.166">
<input type=hidden name=ibcnumci value="%STANDARD.01.025.000.132.0.1">
<input type=hidden name=otmaumci value="%OUTWEB02.05.234">
<input type=hidden name=otheccar value="%OUTWEB02.05.241">
<input type=hidden name=otheclhr value="%OUTWEB02.05.240.042">
<input type=hidden name=redirflg value="%OUTWEB02.05.236">
<input type=hidden name=othendps value="%OUTWEB02.05.258">
<input type=hidden name=currdate value="%STANDARD.01.015">
<input type=hidden name=ptcnxcom value="%STANDARD.01.025.116.222.0.1">
<input type=hidden name=outbb071 value="">

<!-- Referral Default Fields -->
<input type=hidden name=slotbtyp value="%OUTWEB02.05.270">
<input type=hidden name=slotrefn value="%OUTWEB02.05.268.0">
<input type=hidden name=slotreqk value="%OUTWEB02.05.271">
<input type=hidden name=defclnty value="">
<input type=hidden name=defclnid value="">
<input type=hidden name=defvisty value="">
<input type=hidden name=defclaim value="">
<input type=hidden name=deffunds value="">
<input type=hidden name=deftovrd value="">
<input type=hidden name=requestk value="">
<input type=hidden name=slotrtrn>
<table cellspacing=0 cellpadding=0 border=0 width=90% align=center>

<!-- Referral Default Fields -->

<tr><td class=DataLabel width=15%>Clinic</td>
    <td class=DataField colspan=3>
    <input type=hidden name=newslotk value="%OUTWEB02.05.166" >
    <input type=text size=30 name=clindesc Title="Clinic" 
     tabindex=-1
     value="%OUTWEB02.05.192" readonly class=Mandatory>
     <img src="../images/SearchIcon.gif" class=Icon onclick="AppointSearch();">
     <img src="../images/LookupIcon.gif" class=Icon onclick="ClinicSearch();">
    </td></tr>
<tr><td class=DataLabel>Date</td>
   <td class=DataField colspan=3>
   <input type=text size=35 name=clindate readonly  class=Mandatory title="date"
    tabindex=-1
    value="%OUTWEB02.05.113 %OUTWEB02.05.104 %OUTWEB02.05.116">
    </td></tr>

<tr><td class=DataLabel>Visit Type</td>
    <td class=DataField colspan=3>
    <select name=outbb047 title="Visit Type" class="Mandatory SelectBig"
     tabindex=1 onchange="DisplayXCmbs();ValVisitType();">
    <option></option>
    %OUTWEB02.05.199
    </select>
    </td></tr>

<tr valign=top>
    <td class=DataLabel>Presenting Complaint</td>                              
    <td class=DataField colspan=3>
    <input type=text name=pmsvx052 size=50 maxlength=50 tabindex=2
      value="">
</td></tr>     

<tr valign=top>
    <td class=DataLabel>Diagnosis</td>

    <td class=DataField colspan=3>
    <input type=text size=12 name=outbb045 value="" tabindex=3
     onblur="validateCode(6,AddForm.outbb045,AddForm.outbb046);">
    <input type=text name=outbb046 size=70 maxlength=50 tabindex=-1
     readonly class=Readonly value="">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(AddForm.outbb045,AddForm.outbb046);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb045,AddForm.outbb046);">
    </td></tr>

<tr>
<td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=12 name=outbb055 value="" tabindex=4
     onblur="validateCode(6,AddForm.outbb055,AddForm.outbb056);">
    <input type=text name=outbb056 size=70 maxlength=50 tabindex=-1 
     readonly class=Readonly value="">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(AddForm.outbb055,AddForm.outbb056);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb055,AddForm.outbb056);">
    </td></tr>
<tr>
<td>&nbsp;</td>
<td class=DataField colspan=3>
     <input type=text size=12 name=outbb057 value="" tabindex=5
     onblur="validateCode(6,AddForm.outbb057,AddForm.outbb058);">
     <input type=text size=70 maxlength=50 name=outbb058 tabindex=-1
      readonly class=Readonly value="">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(AddForm.outbb057,AddForm.outbb058);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb057,AddForm.outbb058);">
    </td></tr>
<tr>
<td>&nbsp;</td>
<td class=DataField colspan=3>
    <input type=text size=12 name=outbb059 value="" tabindex=6
    onblur="validateCode(6,AddForm.outbb059,AddForm.outbb060);">
    <input type=text size=70 maxlength=50 name=outbb060 tabindex=-1
     readonly class=Readonly value="">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(AddForm.outbb059,AddForm.outbb060);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb059,AddForm.outbb060);">
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td><table cellspacing=0 cellpadding=0>
        <tr><td>
        <select name=outbb002 class="Mandatory SelectBig" tabindex=7
        title="%STANDARD.01.017.CL" onchange="showFundingSource(AddForm);">
        <option></option>
        %OUTWEB02.05.197.9.1.10.2.X
        </select>
        </td>
        <td><div id=FundingHeading></div></td>
        <td><div id=FundingId></div></td>
        </table>
     </td>

    <td class=DataLabel>Referring GP</td>
    <td class=DataField>
    <input type=hidden name=outbb029>
    <input type=hidden name=dummy1 value="6">
    <input type=text name=genpname readonly Class=Readonly>
    <img src="../images/SearchIcon.gif" tabindex=-1 class="Icon"
     onclick="HCPSearchFrame(AddForm.outbb029,AddForm.genpname,
              AddForm.dummy1.value)">
    <img src="../images/erase.gif" class="Icon"
     onclick="clrFields(AddForm.outbb029,AddForm.genpname);">
    </td></tr>

<tr>
  <td class=DataLabel>
    Has this patient been in a Motor Vehicle accident?
  </td>
  <td>
    <select class="Mandatory" name=opwamvny tabindex=1
     title="Has the patient been in a Motor Vehicle Accident?">
      %OUTWEB02.05.299.012.099.050
    </select>
  </td>
</tr>

<tr><td class=DataLabel>NMDS Code</td>
    <td class=DataField><select name=outbb068 class=SelectBig tabindex=8>
        <option></option>
        %OUTWEB02.05.240.039.2
        </select>
    </td>
    <td class=DataLabel>Transport</td>
    <td class=DataField><select name=outbb023 class=SelectBig tabindex=21>
        <option></option>
        %OUTWEB02.05.142.2
        </select></td>
    </tr>

<tr><td class=DataLabel>Tier 2 Code</td>
    <td class=DataField><select name=outbb072 tabindex=8
        class="SelectBig" title="Tier 2 Code">
        <option></option>
         %OUTWEB02.05.240.047.2
        </select>
    </td>
    <td class=DataLabel>Service Delivery Mode</td>
    <td class=DataField><select name=outbb070 class=SelectBig tabindex=22
     onchange="DisplayWarning();">
        <option></option>
        %OUTWEB02.05.240.041.2
        </select>
        </td>
    </tr>

<tr><td class=DataLabel>Care Type</td>
    <td class=DataField><select name=outbb069 class=SelectBig tabindex=9>
        <option></option>
        %OUTWEB02.05.240.040.2
        </select>
    </td>
    <td class=DataLabel>Clinical High Risk</td>
    <td><input type=checkbox value=1 name=d_outbb071 tabindex=23></td>
    </tr>

<tr><td class=DataLabel>Notify GP</td>
    <td><input type=checkbox value=1 name=outbb036 tabindex=10></td>
    <td class=DataLabel></td>
    <td class=DataField></td>
    </tr>

<tr><td class=DataLabel>Send Letter</td>
    <td><select name=outbb067 title="Send Letter" tabindex=11
         onchange="SendLetterDate(AddForm);CheckLetterDate(AddForm);">
        <option></option>
        <option value="0">No</option>
        <option value="1">Yes</option>
        <option value="2">N/A</option>
        </select>
    </td>
    <td class=DataLabel>Generate Letter date</td>
    <td><input type=text name=outbb066 size=12 tabindex=24
     onblur="checkDate(this,'Date');CheckLetterDate(AddForm);" value=""
     class="Date" title="Generate Letter Date">
    <img src=../images/DateTimeStamp.gif class=Icon date=AddForm.outbb066
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=AddForm.outbb066>
</td>
</tr>

<tr><td>Interpreter Required</td>
    <td><input type="hidden" name="pmsvx093" value="">
        <input type="checkbox" name="d_pmsvx093" value="1" tabindex=12>
    &nbsp;
    <span class="Red">%OUTWEB02.05.086.002.0</span>
    </td>
    <td>Disaster Code</td>
    <td><select name=dispt001 title="Disaster Code" tabindex=25
         onchange="displayDisasterID();">
         <option></option>
          %OUTWEB02.05.260
        </select>
       </td>
</tr>

<tr>
    <td></td>
    <td></td>
    <td class=DataLabel><div id=disasteridnumbertitleDIV></div></td>
    <td><div id=disasteridnumberDIV></div></td>
</tr>

<tr valign=top><td class=DataLabel>Appointment Comments</td>
    <td class=DataField colspan=3>
    <textarea name=outptcom wrap=hard cols=70 rows=3 tabindex=61></textarea>
    </td></tr>

<tr valign=top><td class=DataLabel>Patient Instructions (Printable)</td>
    <td class=DataField colspan=3>
    <textarea name=patinstr wrap=hard cols=60 rows=3 tabindex=61
     onkeydown="LimitText(this,99,200);">%OUTWEB02.05.281</textarea>
    </td></tr>
</table>

<div id=ShowXCmbs></div>
<div id=ShowCarer></div>

<table border=0 width=90% cellspacing=0 cellpadding=0 align=center>
<tr><td colspan=4 align=center>
    <input type=button class="button" value="Ok" tabindex=100 id="out02sub"
    onclick="tempDisable(this);
    checkSlot(AddForm.newslotk.value,AddForm.urnumber.value,SubmitFinal);">
    <input type=button class="button" value="Cancel" tabindex=101
     onclick='fnCancel();'>
    </td></tr>
</table>
</form>

<span id=extracmbs style="display:none">
<table border=0 width=90% cellspacing=0 cellpadding=0 align=center>

<tr><td width=15% class=DataLabel>CMBS Code</td>
    <td class=DataField>
    <input type=hidden name=otbit001 title="Item Type" value="MBS">
    <input type=text size=9 name=otbit002 title="Item Code" value=""
     tabindex=70
     onchange="validatePMBS(AddForm.otbit002,AddForm.mbsdesc1,
               AddForm.otbit001,AddForm.otbit003,
               AddForm.dateclin,AddForm.mbsamnt1);">
    <input type=text size=3 name=otbit003 title="Sub-Item Code" value=""
     tabindex=71
     onchange="validatePMBS(AddForm.otbit002,AddForm.mbsdesc1,
               AddForm.otbit001,AddForm.otbit003,
               AddForm.dateclin,AddForm.mbsamnt1);">
    <input type=text size=30 name=mbsdesc1 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt1 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
     onclick="PriMbsSearchFrame(AddForm.otbit001,AddForm.otbit002,
              AddForm.otbit003,AddForm.dumdate,
              AddForm.mbsdesc1,AddForm.dumInput,TypeDesc1);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(AddForm.otbit002,AddForm.otbit003,
              AddForm.mbsdesc1,AddForm.mbsamnt1,AddForm.otbit016);">
    <input type=text maxlength=20 size=22 name=otbit016 title="Provider Usage" 
     tabindex=72 value="">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit004 title="Item Type 2" value="MBS">
    <input type=text size=9 name=otbit005 title="Item Code 2" value=""
     tabindex=73
     onchange="validatePMBS(AddForm.otbit005,AddForm.mbsdesc2,
               AddForm.otbit004,AddForm.otbit006,
               AddForm.dateclin,AddForm.mbsamnt2);">
    <input type=text size=3 name=otbit006 title="Sub-Item Code 2" value=""
     tabindex=74
     onchange="validatePMBS(AddForm.otbit005,AddForm.mbsdesc2,
               AddForm.otbit004,AddForm.otbit006,
               AddForm.dateclin,AddForm.mbsamnt2);">
    <input type=text size=30 name=mbsdesc2 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt2 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick="PriMbsSearchFrame(AddForm.otbit004,AddForm.otbit005,
             AddForm.otbit006,AddForm.dumdate,
             AddForm.mbsdesc2,AddForm.dumInput,TypeDesc2);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(AddForm.otbit005,AddForm.otbit006,
              AddForm.mbsdesc2,AddForm.mbsamnt2,AddForm.otbit017);">
    <input type=text maxlength=20 size=22 name=otbit017 title="Provider Usage 2"
     tabindex=75 value="">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit007 title="Item Type 3" value="MBS">
    <input type=text size=9 name=otbit008 title="Item Code 3" value=""
     tabindex=76
     onchange="validatePMBS(AddForm.otbit008,AddForm.mbsdesc3,
               AddForm.otbit007,AddForm.otbit009,
               AddForm.dateclin,AddForm.mbsamnt3);">
    <input type=text size=3 name=otbit009 title="Sub-Item Code 3" value=""
     tabindex=77
     onchange="validatePMBS(AddForm.otbit008,AddForm.mbsdesc3,
               AddForm.otbit007,AddForm.otbit009,
               AddForm.dateclin,AddForm.mbsamnt3);">
    <input type=text size=30 name=mbsdesc3 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt3 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick="PriMbsSearchFrame(AddForm.otbit007,AddForm.otbit008,
             AddForm.otbit009,AddForm.dumdate,
             AddForm.mbsdesc3,AddForm.dumInput,TypeDesc3);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(AddForm.otbit008,AddForm.otbit009,
              AddForm.mbsdesc3,AddForm.mbsamnt3,AddForm.otbit018);">
    <input type=text maxlength=20 size=22 name=otbit018 title="Provider Usage 3"
     tabindex=78 value="">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit010 title="Item Type 4" value="MBS">
    <input type=text size=9 name=otbit011 title="Item Code 4" value=""
     tabindex=79
     onchange="validatePMBS(AddForm.otbit011,AddForm.mbsdesc4,
               AddForm.otbit010,AddForm.otbit012,
               AddForm.dateclin,AddForm.mbsamnt4);">
    <input type=text size=3 name=otbit012 title="Sub-Item Code 4" value=""
     tabindex=80
     onchange="validatePMBS(AddForm.otbit011,AddForm.mbsdesc4,
               AddForm.otbit010,AddForm.otbit012,
               AddForm.dateclin,AddForm.mbsamnt4);">
    <input type=text size=30 name=mbsdesc4 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt4 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick="PriMbsSearchFrame(AddForm.otbit010,AddForm.otbit011,
             AddForm.otbit012,AddForm.dumdate,
             AddForm.mbsdesc4,AddForm.dumInput,TypeDesc4);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(AddForm.otbit011,AddForm.otbit012,
              AddForm.mbsdesc4,AddForm.mbsamnt4,AddForm.otbit019);">
    <input type=text maxlength=20 size=22 name=otbit019 title="Provider Usage 4"
     tabindex=81 value="">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit013 title="Item Type 5" value="MBS">
    <input type=text size=9 name=otbit014 title="Item Code 5" value=""
     tabindex=82
     onchange="validatePMBS(AddForm.otbit014,AddForm.mbsdesc5,
               AddForm.otbit013,AddForm.otbit015,
               AddForm.dateclin,AddForm.mbsamnt5);">
    <input type=text size=3 name=otbit015 title="Sub-Item Code 5" value=""
     tabindex=83
     onchange="validatePMBS(AddForm.otbit014,AddForm.mbsdesc5,
               AddForm.otbit013,AddForm.otbit015,
               AddForm.dateclin,AddForm.mbsamnt5);">
    <input type=text size=30 name=mbsdesc5 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt5 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick="PriMbsSearchFrame(AddForm.otbit013,AddForm.otbit014,
             AddForm.otbit015,AddForm.dumdate,
             AddForm.mbsdesc5,AddForm.dumInput,TypeDesc5);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(AddForm.otbit014,AddForm.otbit015,
              AddForm.mbsdesc5,AddForm.mbsamnt5,AddForm.otbit020);">
    <input type=text maxlength=20 size=22 name=otbit020 title="Provider Usage 5"
     tabindex=84 value="">
    </td>
    </tr>

<tr><td>Use CMBS Template</td>
    <td><input type=checkbox value=1 name=cmbsload tabindex=85
         onclick="TemplateCmbs();">
    &nbsp;
    <select class="SelectBig" name=cmbstemp title="CMBS Template"
     tabindex=86 onchange="TemplateCmbs();">
          <option></option>
          %OUTWEB02.05.229
          </select></td>
    </tr>

<tr><td>Print Medicare Claims</td>
    <td><input type=checkbox value=1 name=claimprt tabindex=87>
    &nbsp;
    <select class="SelectBig" name=claimpsl title="Printer" tabindex=88>
          <option></option>
          %STANDARD.01.001.OUTCLAIM.03
          </select></td>
    <tr>
</table>
</span>

<span id=sendcarer style="display:none">
<table border=0 width=90% cellspacing=0 cellpadding=0 align=center>
<tr><td width=15% class=DataLabel>Send Correspondence to Carer</td>
    <td class=DataField><input type=checkbox value=1 name=outbb065 checked
                         tabindex=90>
    </td></tr>
</table>
</span>

<span id=offdutyhd style="display:none">
&nbsp;Off Duty&nbsp;
</span>

<span id=offdutyid style="display:none">
<input type="checkbox" name="offdutyb" value="0" tabindex=7>
</span>

<span id=blanklabel style="display:none">
<input type=hidden name=pmsvx141 value=" ">
</span>

<span id=fundinghd style="display:none">
&nbsp;Funding Source&nbsp;
</span>

<span id=fundingid style="display:none">
<select name=pmsvx141 title="%STANDARD.01.017.cx" tabindex=7>
<option> </option>
%OUTWEB02.05.499.009.4
</select>
</span>

<span id=disasteridnumbertitleSPAN style="display:none">
Disaster Identification #
</span>

<span id=disasteridnumberSPAN style="display:none">
<input type="text" name=dispt002 size=20 maxlength=19
   tabindex=26 title="Disaster Identification Number">
</span>

<form name=HiddenFields method=get style="margin:0">
<input type=hidden name=alrerhcp value="%OUTWEB02.05.353.022.1">
<input type=hidden name=d_alrerhcp value="%OUTWEB02.05.353.022.0">
</form>

<span id="ApptReqComm" style="display:none">
<textarea name="apprcomm" id="apprcomm" wrap=hard cols=60 rows=3
tabindex=60>%OUTWEB02.05.299.002</textarea>
</span>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%OUTWEB02.05.003">
<input type=hidden name=admissno value="%OUTWEB02.05.081">
<input type=hidden name=MenuType value="%OUTWEB02.05.088">
<input type=hidden name=casekeys value="%OUTWEB02.05.166">
</form>

<script type="text/javascript">
 PMIInterpreter="%OUTWEB02.05.086.001.0";
 if (PMIInterpreter != "1") {
    AddForm.d_pmsvx093.disabled=true;
 } else {
    AddForm.d_pmsvx093.checked=true;
 }

 var codeList = document.AddForm.outbb002.options;
 for (var i = 0; i < codeList.length; i++) {
   if (isWhitespace(codeList[i].value)) continue;
   var codeSingle = codeList[i].value.substr(3, 5);
   if (codeSingle.match(/M/g) != null) {
     document.AddForm.outbb002.options[i].remove(i);
     i--;
   }
 }
</script>
