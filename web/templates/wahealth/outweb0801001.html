<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientClinicId.js"></script>
<script type="text/javascript" src="../js/outweb0801001.js"></script>
<script type="text/javascript" src="../js/OutpatientTypeClinic.js"></script>
<script type="text/javascript">

function compareObjectKey(a,b) {
  if (a.key < b.key)
     return -1;
  if (a.key > b.key)
    return 1;
  return 0;
}

function buildSeribKey() {

  var inputarray = document.getElementsByTagName("input");
  var seribkeyarray = new Array();
  var seribtimarray = new Array();
  var serisessarray = new Array();
  var sortArray = new Array();
  var objectContent = null;
  var input = null;

  for (x=0; x<inputarray.length; x++) {
    if (inputarray[x].name.match(/^seribkey\d+$/)) {
      if (!isWhitespace(inputarray[x].value)) {
        seribkeyarray.push(inputarray[x]);
        seribtimarray.push(inputarray[x+1]);
        serisessarray.push(inputarray[x-1]);
      }
    }
  }

  for (y=0; y<seribkeyarray.length; y++) {
    objectContent = new Object();
    objectContent.key = seribkeyarray[y].value.substr(12,8) +
                        seribtimarray[y].value;
    objectContent.seribkey = seribkeyarray[y].value;
    objectContent.seribtimarray = seribtimarray[y].value;
    objectContent.serisessarray = serisessarray[y].value;
    sortArray.push(objectContent);
  }

  sortArray.sort(compareObjectKey);

  for (x=0; x<AddForm.elements.length; x++) {
    if(AddForm.elements[x].name.match(/seribkey/)) {
      AddForm.elements[x].setAttribute("name","serib_d_key");
    }
//    if(AddForm.elements[x].name.match(/seribtim/)) {
//      AddForm.elements[x].setAttribute("name","serib_d_tim");
//    }
//    if(AddForm.elements[x].name.match(/serisess/)) {
//      AddForm.elements[x].setAttribute("name","seri_d_sess");
//    }
  }

  for (z=0; z<sortArray.length; z++) {

  input = document.createElement('input');
  input.type = 'hidden';
  input.name = 'seribkey';
  input.value = sortArray[z].seribkey;
  AddForm.appendChild(input);

//    alert(seribkeyarray[y].value+" "+
//          seribtimarray[y].value+" "+
//          serisessarray[y].value);

//    alert(sortArray[z].key+" "+sortArray[z].seribkey);
  }

//  for (x=0; x<AddForm.elements.length; x++) {
//    if(AddForm.elements[x].name.match(/seribkey/)) {
//    alert(AddForm.elements[x].value);
//    }
//  }
}
function SetLists() {
  if(SearchForm.bookflag.value=="2"){
    if(isWhitespace(SearchForm.defctype.value)
      && isWhitespace(SearchForm.deftclid.value)){
      SearchForm.defctype.value=SearchForm.refrclty.value;
      SearchForm.deftclid.value=SearchForm.refrclid.value;
    }
  }
SetClinicType(SearchForm.srchclty,SearchForm.defctype.value,SearchForm.usersite.value);
 SetLists2();
 if(isWhitespace(SearchForm.showdate.value)) {
   if((SearchForm.bookflag.value!="1") && (SearchForm.bookflag.value!="2")) {
     checkRefLetter(SearchForm.urnumber.value);
   }
 }
}

function SetLists2() {
var p=document.SearchForm
 p.srchclid.options.length=1;
 SetTypeClinic(p.srchclid,p.deftclid.value,p.usersite.value,p.srchclty.value);
}
function CancelButton() {
  if(document.SearchForm.bookflag.value=="2") {
     PatientLinkTo("allweb02.pbl",2,1,0,0,0);
  } else {
     PatientLinkTo("outweb08.pbl",1,1,0,0,0);
  }
}
var SessCount=0;
</script>
%START.OF.PAGE
<body onload="PageLoad(event);setTimeout('initA()',100);">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OUTWEB08.01.003";
PatientVIS="%OUTWEB08.01.081";
PatientNAM="%OUTWEB08.01.002";
PatientSTA="%OUTWEB08.01.086.078";
PatientALT="%OUTWEB08.01.084";
PatientSEX="%OUTWEB08.01.019";
PatientDOB="%OUTWEB08.01.020";
PatientAGE="%OUTWEB08.01.021";
PatientLOC="%OUTWEB08.01.083";
PatientUNT="%OUTWEB08.01.066.0";
PatientPRI="%OUTWEB08.01.086.066.1";
DoctorCOD="%OUTWEB08.01.082.003";
DoctorNAM="%OUTWEB08.01.082.002";
PatientAID="%OUTWEB08.01.086.090";
PatientIND="%OUTWEB08.01.086.091";
PatientCUR="%OUTWEB08.01.086.092";
PatientCLC="%OUTWEB08.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OUTWEB08.01.086.094";
PatientCDM="%OUTWEB08.01.086.095";
PatientVDH="%OUTWEB08.01.086.099.015";
InsertPatientHeader()
</script>

<div id=PatientMenu></div>
<div id=PageHeadingSection>
<form name=SearchForm action=outweb08.pbl method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%OUTWEB08.01.003">
<input type=hidden name=admissno value="%OUTWEB08.01.081">
<!--Added here-->
<input type=hidden name=refrlvis value="%OUTWEB08.01.130">
<input type=hidden name=bookflag value="%OUTWEB08.01.214">
<input type=hidden name=refrclty value="%OUTWEB08.01.353.067.1">
<input type=hidden name=refrclid value="%OUTWEB08.01.353.088.1">
<!--End here-->
<input type=hidden name=refrldat value="%OUTWEB08.01.135">
<!--
<input type=hidden name=refrlexp value="OUTWEB08.01.136">
-->
<input type=hidden name=norecord value=99>
<input type=hidden name=defctype value="%OUTWEB08.01.101">
<input type=hidden name=deftclid value="%OUTWEB08.01.102">
<input type=hidden name=usersite value="%STANDARD.01.023">
<input type=hidden name=defdaywe value="%OUTWEB08.01.106">
<input type=hidden name=defcycle value="%OUTWEB08.01.115">
<input type=hidden name=deftdays value="%OUTWEB08.01.116">
<input type=hidden name=deftmond value="%OUTWEB08.01.107">
<input type=hidden name=defttues value="%OUTWEB08.01.108">
<input type=hidden name=deftwedn value="%OUTWEB08.01.109">
<input type=hidden name=deftthur value="%OUTWEB08.01.110">
<input type=hidden name=deftfrid value="%OUTWEB08.01.111">
<input type=hidden name=deftsatu value="%OUTWEB08.01.112">
<input type=hidden name=deftsund value="%OUTWEB08.01.113">
<input type=hidden name=deftfrst value="%OUTWEB08.01.117">
<input type=hidden name=srchcare value="">
<input type=hidden name=deftcask value="">
<input type=hidden name=tmotfrst value="40">
<input type=hidden name=tmotnext value="40">
<input type=hidden name=showdate value="%OUTWEB08.01.131">
<table width="100%" align=center bgcolor=#CCCCCC cellpadding=0 cellspacing=1 
 border=0>
<tr><td class=HeadingCell align=center colspan=5>
     Series Bookings
    </td></tr>
<tr><td class=DataLabel width=40%>Clinic Type&nbsp;
    <select name=srchclty class=SelectBig title="Clinic Type"
     onchange="SetLists2();">
        <option></option>
        </select></td>
    <td class=DataLabel width=8%>Clinic</td>
    <td><select name=srchclid class=SelectBig title="Clinic Id">
        <option></option>
        </select></td>
    </tr>

<tr><td class=DataLabel>
    <input type="radio" name=srchftyp value=1 checked
     title="Daily" onclick="DisplayFreq(this.value);">
     &nbsp;Daily&nbsp;
    <input type="radio" name=srchftyp value=2 
     title="Weekly" onclick="DisplayFreq(this.value);">
     &nbsp;Weekly&nbsp;
    <input type="radio" name=srchftyp value=3  
     title="Monthly" onclick="DisplayFreq(this.value);">
     &nbsp;Monthly&nbsp;
    <input type="radio" name=srchftyp value=4 
     title="Yearly" onclick="DisplayFreq(this.value);">
     &nbsp;Yearly&nbsp;
    <input type="radio" name=srchftyp value=5 
     title="Template" onclick="DisplayFreq(this.value);">
     &nbsp;Template&nbsp;
    </td>
    <td class=DataLabel>Frequency</td><td><div id=Frequency></div></td>
    <td class=DataLabel colspan=2><div id=DayOptions></div></td>
    </tr>

<tr><td class=DataLabel>Duration Effective&nbsp;
    <input type=text size=12 maxlength=12 name=srchdatf
    onblur="checkDate(this,'Date')" value="%OUTWEB08.01.104"
    class="Mandatory" title="Duration Effective">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Duration Effective" date="SearchForm.srchdatf">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="SearchForm.srchdatf">
    </td>
    <td class=DataLabel>Duration Until</td>
    <td colspan=2><input type=text size=12 maxlength=12 name=srchdatt
    onblur="checkDate(this,'Date')" value="%OUTWEB08.01.105"
    class="Mandatory" title="Duration Until">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Duration Until" date="SearchForm.srchdatt">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="SearchForm.srchdatt">
    <input type=button value="Search" class="button" onclick="PostSearch();">
    <input type=button value="Care Team" class="button" 
     onclick="PostSearchCare();">
    </td>
    </tr>

<tr><td>
<div id=ShowDates></div>
</td></tr>
</table>
</form>
</div>

<div id=PageBodySection>

<form name=AddForm action=outweb08.pbl method=get>
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%OUTWEB08.01.003">
<input type=hidden name=admissno value="%OUTWEB08.01.081">
<input type=hidden name=updttype value=A>
<table align=center cellspacing=0 cellpadding=1 border=1 width=100%>
<tr><td class=HeadingCell width=10%>Date</td>
    <td class=HeadingCell width=5%>Day</td>
    <td class=HeadingCell width=5%>Start</td>
    <td class=HeadingCell width=25%>Clinic Type</td>
    <td class=HeadingCell width=25%>Clinic Id</td>
    <td class=HeadingCell>New Time</td>
    <td class=HeadingCell>Booked Time</td>
    <td class=HeadingCell>Avail New</td>
    <td class=HeadingCell>Booked New</td>
    <td class=HeadingCell>Avail Rev</td>
    <td class=HeadingCell>Booked Rev</td>
    </tr>
%OUTWEB08.01.103.0
</table>

<table align=center cellspacing=1 cellpadding=0 border=0 width=95%>
  <tr><td align=center><hr width=100%></td></tr>
  <tr><td align=center>
    <input type=button value="OK" class="button"
     onclick="buildSeribKey();PostBookings();">
    <input type=button class="button"  value="Cancel" 
     onclick="CancelButton();">
  </td> </tr>
</table>
</form>
</div>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%OUTWEB08.01.003">
<input type=hidden name=admissno value="%OUTWEB08.01.081">
<input type=hidden name=MenuType value="%OUTWEB08.01.088">
<input type=hidden name=bookflag value="%OUTWEB08.01.214">
</form>

<span id=DayFrequency style="display:none">
  <td><select title="Frequency" name=srchcycl class=Mandatory>
      <option></option>
      <option value="1"> Every Day</option>
      <option value="2"> Every 2 Day(s)</option>
      <option value="3"> Every 3 Day(s)</option>
      <option value="4"> Every 4 Day(s)</option>
      <option value="5"> Every 5 Day(s)</option>
      <option value="6"> Every 6 Day(s)</option>
      <option value="7"> Every 7 Day(s)</option>
      </select>
      </td>
</span>
<span id=WeekFrequency style="display:none">
  <td><select title="Frequency" name=srchcycl class=Mandatory>
      <option></option>
      <option value="1"> Every 1 Week(s) </option>
      <option value="2"> Every 2 Week(s) </option>
      <option value="3"> Every 3 Week(s) </option>
      <option value="4"> Every 4 Week(s) </option>
      </select>
      </td>
</span>
<span id=MonthFrequency style="display:none">
  <td><select title="Frequency" name=srchfrst class=Mandatory>
      <option></option>
      <option value="1">First</option>
      <option value="2">Second </option>
      <option value="3">Third</option>
      <option value="4">Fourth</option>
      <option value="5">Fifth</option>
      </select>
      &nbsp;Date&nbsp;
      <select title="Date" name=srchdays class=Mandatory>
      <option></option>
      <option value="1">Monday</option>
      <option value="2">Tuesday</option>
      <option value="3">Wednesday</option>
      <option value="4">Thursday</option>
      <option value="5">Friday</option>
      <option value="6">Saturday</option>
      <option value="7">Sunday</option>
      </select>
      &nbsp;of&nbsp;
      <select title="Date of" name=srchcycl class=Mandatory >
      <option></option>
      <option value="1">1 Month(s)</option>
      <option value="2">2 Month(s)</option>
      <option value="3">3 Month(s)</option>
      <option value="4">4 Month(s)</option>
      <option value="5">5 Month(s)</option>
      <option value="6">6 Month(s)</option>
      <option value="7">7 Month(s)</option>
      <option value="8">8 Month(s)</option>
      <option value="9">9 Month(s)</option>
      <option value="10">10 Month(s)</option>
      <option value="11">11 Month(s)</option>
      <option value="12">12 Month(s)</option>
      </select>
      </td>
</span>
<span id=YearFrequency style="display:none">
  <td><select title="Frequency" name=srchfrst class=Mandatory>
      <option></option>
      <option value="1">First</option>
      <option value="2">Second </option>
      <option value="3">Third</option>
      <option value="4">Fourth</option>
      <option value="5">Fifth</option>
      </select>
      &nbsp;Date&nbsp;
      <select title="Date" name=srchdays class=Mandatory >
      <option></option>
      <option value="1">Monday</option>
      <option value="2">Tuesday</option>
      <option value="3">Wednesday</option>
      <option value="4">Thursday</option>
      <option value="5">Friday</option>
      <option value="6">Saturday</option>
      <option value="7">Sunday</option>
      </select>
      &nbsp;of&nbsp;
      <select title="Date of" name=srchcycl class=Mandatory >
      <option></option>
      <option value="01">January</option>
      <option value="02">February</option>
      <option value="03">March</option>
      <option value="04">April</option>
      <option value="05">May</option>
      <option value="06">June</option>
      <option value="07">July</option>
      <option value="08">August</option>
      <option value="09">September</option>
      <option value="10">October</option>
      <option value="11">November</option>
      <option value="12">December</option>
      </select>
      </td>
</span>
<span id=ShowDay style="display:none">
  <td><input type="checkbox" name=srchmond value="1">&nbsp;Mon&nbsp;
      <input type="checkbox" name=srchtues value="1">&nbsp;Tue&nbsp;
      <input type="checkbox" name=srchwedn value="1">&nbsp;Wed&nbsp;
      <input type="checkbox" name=srchthur value="1">&nbsp;Thur&nbsp;
      <input type="checkbox" name=srchfrid value="1">&nbsp;Fri&nbsp;
      <input type="checkbox" name=srchsatu value="1">&nbsp;Sat&nbsp;
      <input type="checkbox" name=srchsund value="1">&nbsp;Sun&nbsp;
      </td>
</span>
<span id=NoDay style="display:none">
  <td>&nbsp;</td>
</span>
<span id=ShowTemplate style="display:none">
  <td><select title="Frequency" name=srchdays class=Mandatory >
      <option></option>
      <option value="1">Monday</option>
      <option value="2">Tuesday</option>
      <option value="3">Wednesday</option>
      <option value="4">Thursday</option>
      <option value="5">Friday</option>
      <option value="6">Saturday</option>
      <option value="7">Sunday</option>
      </select>
      </td>
</span>

<script type="text/javascript">
  PageBodySection.style.height=document.body.clientHeight -
                               PageHeadingSection.clientHeight;
//
 RadioIndex="%OUTWEB08.01.106"           // Starts at 0 so sub 1
 if(RadioIndex!=" ") {
   RadioIndex=RadioIndex-1
   document.SearchForm.srchftyp[RadioIndex].checked=1 // Set Curr Checked Value
 }
//
</script>
