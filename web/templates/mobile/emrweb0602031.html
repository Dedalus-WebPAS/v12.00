Content-Type: text/html
Cache-Control: no-cache

<!DOCTYPE HTML>
<head>
<!--"TemplateVersion"  : "V12.00.00"
    "TemplateHome"     : "mobile"-->
<title>Add Diagnosis</title>
<script type="text/javascript" src="../html/iphone/iphone.js"> </script>
<script type="text/javascript" src="../html/iphone/iphone-emr.js"> </script>
<link   rel="stylesheet" href="../html/iphone/iphone.css" type="text/css">
<script type="text/javascript"> 
function init() {
 document.UpdateForm.redirect.value="emrweb06.pbl?reportno=2&template=21"+
       "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+") +
       "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+")
 FormInit();
}
function setFormactn(type) {
  document.UpdateForm.updatety.value=type;
  if (validateMandatory(UpdateForm)) {
    if (type=="D") {
      confirmMsg="Are you sure you want to Delete this record ?";
      alertify.confirm(confirmMsg, function (e) {    
        if (e) {
          el=parent.document.getElementById("sectionFormTitle")
          el.innerHTML="Add Diagnosis";
          document.UpdateForm.submit() 
        } 
      });
    }
    if (type=="U") {
      el=parent.document.getElementById("sectionFormTitle")
      el.innerHTML="Add Diagnosis";
      document.UpdateForm.submit();
    }
  }
}
function cancelForm() {
  el=parent.document.getElementById("sectionFormTitle")
  el.innerHTML="Add Diagnosis";
  document.location.href="emrweb06.pbl?reportno=2&template=21"+
       "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+") +
       "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+")
}
function getDiagnosis(SearchField,ReturnSelect) {
  var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=1" +
                    "&valdcode=" + SearchField.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnSelect.options.length=0;
    document.UpdateForm.emvcd005.value="";
    document.UpdateForm.mbsdesc1.value="";
    ReturnValue=returnValue.return_value.split("|");
    for (var j=0; j < ReturnValue.length; j++) {
       if (!isWhitespace(ReturnValue[j])) {
         SelectValue=ReturnValue[j].split(",");
         ReturnSelect.options[ReturnSelect.options.length]=
          new Option(SelectValue[1],SelectValue[0]); 
          if (j==0) {
            document.UpdateForm.emvcd005.value=SelectValue[0];
            document.UpdateForm.mbsdesc1.value=SelectValue[1]; 
    } } } }
}
function SetDiag(theField) {
  document.UpdateForm.emvcd005.value=
    theField.options[theField.selectedIndex].value;
  document.UpdateForm.mbsdesc1.value=
    theField.options[theField.selectedIndex].text;
}
</script>
</head>
%START.OF.PAGE
<body onload="init();">
<form name=Dummy>
<ul class=sectionList>
<li class=sectionItem>diagnosis search
<span class=commentText><br>
 <input type=text oninput='getDiagnosis(this,Dummy.diagselt);'
  placeholder="Search" size=25 style='width:270px'><br>
 <select name=diagselt style='width:270px' onchange='SetDiag(this);'></select>
</span>
</li>
</ul>
</form>

<form name=UpdateForm method=post action=emrweb06.pbl
 onsubmit='return validateMandatory(this);'>
<input type=hidden name=reportno value="2">
<input type=hidden name=template value="003">
<input type=hidden name=updatety>
<input type=hidden name=admissno value="%EMRWEB06.02.081">
<input type=hidden name=recordky value="%EMRWEB06.02.132">
<input type=hidden name=updateky value="%EMRWEB06.02.133">
<input type=hidden name=nextpage value="1">
<input type=hidden name=urnumber value="%EMRWEB06.02.003">
<input type=hidden name=redirect value="">

<input type=hidden name=emvcd001 value="%EMRWEB06.02.101">
<input type=hidden name=emvcd002 value="005">
<input type=hidden name=emvcd003 value="%EMRWEB06.02.103">
<input type=hidden name=emvcd004 value="5">
<input type=hidden name=emuty001 value="EMRD">
<ul class=sectionList>
<li class=sectionItem>
diagnosis code
<span class=sectionText>
<input type=text name=emvcd005 value="%EMRWEB06.02.105.1" size=9
 class=Mandatory title="Diagnosis" readonly>
</span>
</li>
<li class=sectionItem>
diagnosis 
<span class=commentText><br>
<textarea name=mbsdesc1 rows=3 cols=25 
 readonly disabled="disabled" >%EMRWEB06.02.105.0</textarea>
</li>
<li class=sectionItem>
Send in Extract 
<span class=checkBoxRight>
<input type=checkbox name=emvcd031 value=1>
</span>
</li>
<li class=sectionItem>
Primary Diagnosis 
<span class=checkBoxRight>
<input type=checkbox name=primdiag value=1>
</span>
</li>
</ul>
<input type=button value="Update" class="green" onClick=setFormactn('U');>
<input type=button value="Delete" class="red" onClick=setFormactn('D');>
<input type=button value="Cancel" class="red" onClick=cancelForm();>

</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=urnumber value="%EMRWEB06.02.003">
<input type=hidden name=admissno value="%EMRWEB06.02.081">
<input type=hidden name=MenuType value="%EMRWEB06.02.088">
</form>
<script type="text/javascript">
function FormInit() {
if  ("%EMRWEB06.02.131" == "1") {
    document.UpdateForm.emvcd031.checked="1"; }
}
if  ("%EMRWEB06.02.106" == "000") {
    document.UpdateForm.primdiag.checked="1";
}
</script>
</body>
