Content-Type: text/html
Cache-Control: no-cache

<!DOCTYPE HTML>
<head>
<!--"TemplateVersion"  : "V12.00.00"
    "TemplateHome"     : "mobile"-->
<title>Results</title>
<script type="text/javascript" src="../html/iphone/iphone.js"> </script>
<link   rel="stylesheet" href="../html/iphone/iphone.css" type="text/css">
<script type="text/javascript">
var MoreResults;
var MoreStartKey;
function ProcessSubmit() {
  var sForm=document.SelectPeriod
  var so=document.getElementById("searchOptions");
  var sr=document.getElementById("searchResults");
  if (sr.style.display=="none") {
    sForm.submit() }
  else {
    so.style.display="";
    sr.style.display="none" }
}
//------------------------------------------------------------
// Function : Init Page
//------------------------------------------------------------
function init(){
 if (isWhitespace(document.SelectPeriod.status.value)){
                 (document.SelectPeriod.status.value="07")}
 for (var i =0 ; i < document.SelectPeriod.viewtype.length; i++) {
  if (document.SelectPeriod.viewtype.options[i].value==document.SelectPeriod.view.value) {
     document.SelectPeriod.viewtype.selectedIndex=i } };
 for (var i =0 ; i < document.SelectPeriod.docttype.length; i++) {
  if (document.SelectPeriod.docttype.options[i].value==document.SelectPeriod.status.value) {
       document.SelectPeriod.docttype.selectedIndex=i } };
 InitTable();
}
function selectView(viewTypeValue) {
  document.SelectPeriod.viewtype.value=viewTypeValue
  document.SelectPeriod.submit();
}
function ShowMore(NextResultKey) {
  document.SelectPeriod.startkey.value=NextResultKey
  document.SelectPeriod.submit();
}
function ShowAll() {
  document.SelectPeriod.template.value=1
  document.SelectPeriod.submit();
}
function toggleUnread() {
   var el1=document.getElementById("Unread");
   if (el1.className.indexOf('togButtonOff')>0) {
     el1.className='togButton togButtonOn noHighlight';
     document.SelectPeriod.template.value="9"
   }
   else {
     el1.className='togButton togButtonOff noHighlight';
     document.SelectPeriod.template.value="8"
   }
}
</script>
%START.OF.PAGE
<body onload=init();>
<div class=HeadingDiv>
<table border=0 padding=0 style='width:100%;border:0;margin:0;padding:4px 0px'>
<tr><td class=HeadLeft><span class="goBack"
    onclick="location.href=top.getCookie('HomePageURL');">Back</span></td>
    <td class=HeadTitle>Results</td>
    <td class=HeadRight>
    <span class=goBack onclick='ProcessSubmit();'>Search</span>
    </td>
</tr></table>
</div>
<form name=linkForm action=patweb98.pbl method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=81>
<input type=hidden name=urnumber value="  ">
<input type=hidden name=admissno value="  ">
</form>
<form name=SelectPeriod action=cliweb03.pbl method=get>
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=8>
<input type=hidden name=startkey value="">
<input type=hidden name=view value="%CLIWEB03.03.110">
<input type=hidden name=status value="%CLIWEB03.03.113">
<div id=searchOptions class="w-table">
<ul class=sectionList>
<li class=sectionItem>
      %CLIWEB03.03.107
    </li>
<li class=sectionItem>
     <select name=docttype onchange='this.form.submit()'>
       <option value="  ">                     </option>
       <option value="07">Attending Doctor only</option>
       <option value="08">Referring Doctor only</option>
       <option value="03">Attending & Referring</option>
       <option value="05">GP                   </option>     
      </select>
    </li>
<li class=sectionItem>
   <select name=viewtype  onchange='this.form.submit()'>
   <option value=0>View by Day</option>
   <option value=1>View by Week</option>
   <option value=2>View by Month</option>
   </select>
</li>
<li class=sectionItem>
    Exclude Read Results
   <a id=Unread class="togButton togButtonOff noHighlight" href="javascript:toggleUnread();"></a>
  </li>
</ul>
</form>
</div>

<div id=searchResults class=w-table>
<div class="section" id="sectionList" style="display:none;" ></div>
</div>

<div id="noResults" style="display:none;" >
<ul class=sectionList>
<li style='text-align:center;color:darkred;' class=sectionItem>
No Results for Search Criteria
</li></ul>
</div>


<script type="text/javascript">
function InitTable() {
 ListLocation = document.getElementById("sectionList");
 t = new Table("ListRes","ItemRes");
 t.addColumn("Patient","PatientResult",2,2,"","pathology.gif","0","");
 t.addColumn("Flag","PatientStatusImage",4,4,"","ResultStatus","","");
 t.addColumn("","CenterSubscript",3,3,"","","","");
 t.addColumn("","LeftDateTime",1,1,"left nowrap","","","");
 t.addColumn("Status","RightSubscript",7,7,"","","","");
 t.addColumn("","EndAnchor",1,1,"","","","");

 %CLIWEB03.03.112.cliweb10.01.001

  var so=document.getElementById("searchOptions");
  var sr=document.getElementById("searchResults");
  var nr=document.getElementById("noResults");
  if (t.rows.length>0) {
    so.style.display="none"
    TableOutput(4,2);
    if (MoreResults) {
      ListLocation.innerHTML += "<ul class=ListRes>" +
                                "<li class=ListMore onclick=ListMoreResults(MoreStartKey);>"+
                                "Next 20 Results</li></ul>"
    }
    else {
      ListLocation.innerHTML += "<ul class=ListRes>" +
                             "<li class=ListMore>No More Results</li></ul>"
    }
    ListLocation.style.display="block";
    nr.style.display="none"
  }
  else {
    sr.style.display="none"
    so.style.display=""
    nr.style.display=""
  }
}
function ListMoreResults(StartKey) {
 el=document.SelectPeriod
 theURL="cliweb03.pbl"+
        "?reportno="+el.reportno.value +
        "&template=18" +
        "&startkey="+StartKey +
        "&viewtype="+el.viewtype.options[el.viewtype.selectedIndex].value +
        "&docttype="+el.docttype.options[el.docttype.selectedIndex].value 

 xmlHttp = createHttpObject();
 var h  = document.getElementsByTagName("head")[0];
 xmlHttp.open("GET", theURL, false);
 xmlHttp.send();
 if (xmlHttp.responseText!=""&&xmlHttp.status == 200) {
   var s = document.createElement("script");
   s.type="text/javascript";
   h.appendChild(s);
   s.text=xmlHttp.responseText;
   AddResults()
   TableOutput(4,2);
   if (MoreResults) {
     ListLocation.innerHTML += "<ul class=ListRes>" +
                               "<li class=ListMore onclick=ListMoreResults(MoreStartKey);>"+
                               "Next 20 Results</li></ul>"
    }
    else {
      ListLocation.innerHTML += "<ul class=ListRes>" +
                                "<li class=ListMore>No More Results</li></ul>"
    }
  }
}
</script>
