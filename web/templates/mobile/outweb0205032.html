Content-Type: text/html
Cache-Control: no-cache

<!DOCTYPE HTML>
%START.OF.PAGE
<head>
<title>Appointment Details</title>
<meta name="ServerID"        content="%STANDARD.01.004">
<meta name="ServerName"      content="%STANDARD.01.005">
<meta name="ServerVersion"   content="%STANDARD.01.006">
<meta name="ServerOption"    content="%STANDARD.01.002">
<meta name="ServerTemplate"  content="%STANDARD.01.003">
<meta name="TemplateFile"    content="outweb0205032.html">
<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome"    content="mobile">
<meta name="HelpFileName"    content="NoContextSet.html">
<script type="text/javascript" src="../html/ipad/ipad.js"> </script>
<script type="text/javascript" src="../html/ipad/ipadform.js"> </script>
<script type="text/javascript" src="../html/ipad/AutoSuggestionPopup/AutoSuggestionPopup.class.js"></script>
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientTypeClinic.js"></script>
<link   rel="stylesheet" href="../html/ipad/ipad.css" type="text/css">
<link   rel="stylesheet" href="../html/ipad/AutoSuggestionPopup/AutoSuggestionPopup.css" type="text/css">
<script type="text/javascript">
var SearchJSON = new Object();
var SlotCode;
var SlotDate;
var SlotName;
function AddAppointment(objectNo) {
  document.AddForm.newslotk.value=SearchJSON[objectNo].code;
  document.AddForm.clindesc.value=SearchJSON[objectNo].clinic;
  document.AddForm.clindate.value=SearchJSON[objectNo].value;
  visittyp=SearchJSON[objectNo].visitcode;
  el=document.AddForm.outbb047
  for (var i=0;i<el.options.length;i++) {
    if (visittyp.substr(0,3)==el.options[i].value.substr(0,3)) { el.selectedIndex=i; }
    if (el.options[i].value.substr(9,1)=='U') { el.options[i].style.display='none'; }
  }
  document.AddForm.clinindc.value=SearchJSON[objectNo].clinindc;
  document.AddForm.nslotkey.value=SearchJSON[objectNo].code;
  document.AddForm.defclnty.value=SearchJSON[objectNo].typecode;
  document.AddForm.outbb016.value=SearchJSON[objectNo].typecode;
  document.AddForm.otmaumci.value=SearchJSON[objectNo].otmaumci;
  document.AddForm.otheccar.value=SearchJSON[objectNo].otheccar;
  document.AddForm.othendps.value=SearchJSON[objectNo].othendps;
  // NMDS Code AddForm
//  nmds=SearchJSON[objectNo].othenmds;
//  for (var i =0 ; i < document.AddForm.outbb068.length; i++) {
//    if (trim(document.AddForm.outbb068.options[i].value.substr(0,3))== trim(nmds)) {
//      document.AddForm.outbb068.selectedIndex=i 
//    }
//  }
  // Care Type AddForm
//  caret=SearchJSON[objectNo].othecart;
//  for (var i =0 ; i < document.AddForm.outbb069.length; i++) {
//    if (trim(document.AddForm.outbb069.options[i].value.substr(0,3))== trim(caret)) {
//      document.AddForm.outbb069.selectedIndex=i 
//    }
//  }
  // Service Delivery AddForm
//  servd=SearchJSON[objectNo].othesrvd;
//  for (var i =0 ; i < document.AddForm.outbb070.length; i++) {
//    if (trim(document.AddForm.outbb070.options[i].value.substr(0,3))== trim(servd)) {
//      document.AddForm.outbb070.selectedIndex=i
//    }
//  }

//  if (SearchJSON[objectNo].otheclhr=="1") {
//    document.AddForm.d_outbb071.checked=true;
//    document.AddForm.d_outbb071.disabled=true;
//  } else {
//    document.AddForm.d_outbb071.checked=false;
//    document.AddForm.d_outbb071.disabled=false;
//  }
  reserveSlot(code,"","","",UpdatePage)
}
function UpdatePage() {
  document.AddForm.newslotk.value=SlotCode
  document.AddForm.clindesc.value=SlotName
  document.AddForm.clindate.value=SlotDate
  document.getElementById('PopUpScreen').style.display="none"
}
//-----------------------------------------------------------------
// Function To check Referral Letters
//-----------------------------------------------------------------
function checkRefLetter(urnumber) {
  if (isWhitespace(urnumber)) return;;
  ReturnFunction="" ;
  for (var i=1; i < checkRefLetter.arguments.length; i++) {
    if (typeof(checkRefLetter.arguments[i]) == 'function') {
      ReturnFunction=checkRefLetter.arguments[i] } }
  var serverURL = "../cgi-bin/outweb02.pbl?reportno=9&updatety=6" +
                  "&urnumber="+urnumber.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  ReturnValue=returnValue.return_value.split("|");
  if (returnValue.status==0) {
    if (ReturnValue[0] == 1) {    // Unbooked referral exists
      // Construct warning message
      if (isWhitespace(ReturnValue[1])) 
        { ReturnValue[1] = "Unknown Date"; }
      if (isWhitespace(ReturnValue[2])) 
        { ReturnValue[2] = "Unknown"; }
      if (isWhitespace(ReturnValue[3])) 
        { ReturnValue[3] = "Unknown"; }
      var confirmMsg = "Warning : Referral Letter Exists for " + ReturnValue[1] +
                    "; Clinic Type " + ReturnValue[2] + "; Clinic Id " +
                    ReturnValue[3] + "\nClick OK to continue " +
                    "without selecting the letter, Cancel to select letter.";

      alertify.confirm(confirmMsg, function (e) {    
        if (!e) {  
          DFrameExit();
          PatientLinkTo("allweb02.pbl",2,22,0,0,0);
        } 
      } );
    }
    if (typeof(ReturnFunction) == 'function') { ReturnFunction() } 
  }
}
function SubmitFinal() {
   p=document.AddForm
  if(p.otcnureq.value == "1") {
    if(!CheckAppRequest(p.urnumber,p.newslotk,p.outbb022,p.refrlvis,p.requestk)) {
      return;
    }
  }
  setRedirect()
  if (!validateMandatory(document.AddForm)) {
     return;
  }
  p=document.AddForm
  p.dummydat.value=p.clindate.value.substr(4,11);
  validateSuspension(p.urnumber,p.dummydat,p.datefrom,p.dateto);
  if(p.datefrom.value!='0'){
    confirmMsg="Warning : Patient has a Suspension record for period " +
               + p.datefrom.value  + " - " + p.dateto.value+
               " <br>Click Ok to continue?";
    alertify.confirm(confirmMsg, function (e) {    
      if (!e) { return; } } );
  }
//
  if(document.AddForm.bookflag.value == 2) {               // Check if referral is valid
    document.AddForm.checkdat.value=document.AddForm.clindate.value.substr(4,11);
    if(!CheckDateRange(document.AddForm.refrdate,document.AddForm.checkdat)) {
       alertify.alert("Invalid referral date range for this booking.");
       return;
    }
    if(!isWhitespace(document.AddForm.refrexpd)) {
      if(CheckDateRange(document.AddForm.checkdat,document.AddForm.refrexpd)) {
        alertify.alert("Invalid referral date range for this booking.");
        return;
      }
    }
    document.AddForm.submit() ;
  } else {
      document.AddForm.submit() 
  }
}
function setRedirect() {
  if (document.AddForm.ptcnxcom != undefined) {
    if (document.AddForm.ptcnxcom.value == "1") {
      setRedirectXCom();
      return;
    }
  }

  strTemplate="" ;
  scrName="";
  checkInd=document.AddForm.outbb002.value.substr(3,5)
  if(checkInd.search(/W/g) >= 0) {
    strTemplate="041";
    scrName="WC";}
  if(checkInd.search(/M/g) >= 0) {
    strTemplate="042";
    scrName="TAC";}
  if(checkInd.search(/V/g) >= 0) {
    strTemplate="043";
    scrName="VA";}
  if(checkInd.search(/D/g) >= 0) {
    strTemplate="081";
    scrName="DF";}
  checkInd=document.AddForm.outbb002.value.substr(8,1)
  if(checkInd.search(/C/g) >= 0) {
    strTemplate="048";
    scrName="CT";}
  if (strTemplate=="") {
    if ((document.AddForm.ptcnueoc.value==1) &&
        (document.AddForm.outbb002.value.substr(5,1)=='A')) {
      scrName="ACC";
      document.AddForm.redirect.value="eocweb01.pbl?reportno=1&template=006"
        + "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")
        + "&returncd=OUT";
    }
    else {
      document.AddForm.redirect.value="outweb02.pbl?reportno=3&template=1" +
                                      "&shwprint=1" 
    if (!isWhitespace(document.AddForm.waitflag.value)) {
    document.AddForm.redirect.value=document.AddForm.redirect.value +
               "&waitflag=" + document.AddForm.waitflag.value
    }
    }
  }
  else {
    document.AddForm.redirect.value="patweb89.pbl?reportno=01" +
               "&template=" + strTemplate +
               "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")  
    if (!isWhitespace(document.AddForm.waitflag.value)) {
    document.AddForm.redirect.value=document.AddForm.redirect.value +
               "&waitflag=" + document.AddForm.waitflag.value
    }
  }
  if(chkExtraTempl(document.AddForm,"B",document.AddForm.newslotk.value,
                PatientLinks.urnumber.value.replace(/ /g,"+"),scrName)) {
    document.AddForm.redirect.value = document.AddForm.redirect.value +
                                      "&shwprint=1"
  }
}
function setRedirectXCom() {
  strTemplate="" ;
  scrName="";
  checkComp=document.AddForm.outbb002.value.substr(3,1)
    if (checkComp=="D") {
     strTemplate="081";
     scrName="DF";}
    if (checkComp=="A") {
     strTemplate="240";
     scrName="AD"; }
   if (checkComp=="O") {
     strTemplate="241";
     scrName="OD"; }
   if (checkComp=="M") {
     strTemplate="242";
     scrName="MV"; }
   if (checkComp=="F") {
     strTemplate="243";
     scrName="FD"; }
   if (checkComp=="H") {
     strTemplate="244";
     scrName="PR"; }
   if (checkComp=="S") {
     strTemplate="245";
     scrName="SH"; }
   if (checkComp=="V") {
     strTemplate="246";
     scrName="WV"; }
   if (checkComp=="W") {
     strTemplate="247";
     scrName="WW"; }
   if (checkComp=="E") {
     strTemplate="248";
     scrName="OS"; }
   if (checkComp=="G") {
     strTemplate="249";
     scrName="OV"; }

  if (strTemplate=="") {
    if ((document.AddForm.ptcnueoc.value==1) &&
        (document.AddForm.outbb002.value.substr(5,1)=='A')) {
      scrName="ACC";
      document.AddForm.redirect.value="eocweb01.pbl?reportno=1&template=006"
        + "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")
        + "&returncd=OUT";
    }
    else {
      document.AddForm.redirect.value="outweb02.pbl?reportno=3&template=1" +
                                      "&shwprint=1"
    if (!isWhitespace(document.AddForm.waitflag.value)) {
    document.AddForm.redirect.value=document.AddForm.redirect.value +
               "&waitflag=" + document.AddForm.waitflag.value
    }
    }
  }
  else {
    document.AddForm.redirect.value="patweb89.pbl?reportno=01" +
               "&template=" + strTemplate +
               "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")
    if (!isWhitespace(document.AddForm.waitflag.value)) {
    document.AddForm.redirect.value=document.AddForm.redirect.value +
               "&waitflag=" + document.AddForm.waitflag.value
    }
  }
  if(chkExtraTempl(document.AddForm,"B",document.AddForm.newslotk.value,
                PatientLinks.urnumber.value.replace(/ /g,"+"),scrName)) {
    document.AddForm.redirect.value = document.AddForm.redirect.value +
                                      "&shwprint=1"
  }
}
function SetAppointDefaults(refletter) {
  if (refletter == 1) {  // New Appointment from Refferal Letters
    document.AddForm.defclnty.value="%OUTWEB02.05.327.1";
    document.AddForm.defclnid.value="%OUTWEB02.05.304.1";
    document.AddForm.outbb013.value="%OUTWEB02.05.307.3";
    document.AddForm.outbb029.value="%OUTWEB02.05.302.001";
    document.AddForm.name_outbb029.value="%OUTWEB02.05.302.081";
    document.AddForm.pmsvx052.value="%OUTWEB02.05.306";
  } else if (refletter == 2) {
    document.AddForm.defclnty.value="%OUTWEB02.05.353.067.1";
    document.AddForm.defclnid.value="%OUTWEB02.05.353.088.1";
    document.AddForm.defvisty.value="%OUTWEB02.05.353.095";
    document.AddForm.defclaim.value="%OUTWEB02.05.353.035.1";
    document.AddForm.defprob1.value="%OUTWEB02.05.353.028.0";
    document.AddForm.defprob2.value="%OUTWEB02.05.353.029.0";
    document.AddForm.defprob3.value="%OUTWEB02.05.353.030.0";
    document.AddForm.outbb045.value="%OUTWEB02.05.353.031.1";
    document.AddForm.outbb046.value="%OUTWEB02.05.353.031.0";
    document.AddForm.outbb055.value="%OUTWEB02.05.353.032.1";
    document.AddForm.outbb056.value="%OUTWEB02.05.353.032.0";
    document.AddForm.outbb057.value="%OUTWEB02.05.353.033.1";
    document.AddForm.outbb058.value="%OUTWEB02.05.353.033.0";
    for (var i=0; i < document.AddForm.outbb002.length; i++) {
     if (document.AddForm.outbb002.options[i].value.substr(0,3)==
         document.AddForm.defclaim.value.substr(0,3)){
         document.AddForm.outbb002.selectedIndex=i;
     }
    }
    document.AddForm.outbb013.value="%OUTWEB02.05.353.027.3";
    document.AddForm.outbb001.value="%OUTWEB02.05.353.034.3";
    document.AddForm.outbb029.value="%OUTWEB02.05.353.022.1";
    document.AddForm.name_outbb029.value="%OUTWEB02.05.353.022.0";
    document.AddForm.pmsvx052.value="%OUTWEB02.05.353.081";
    var problems="";
    if(!isWhitespace(document.AddForm.defprob1.value)) {
       problems+=trim(document.AddForm.defprob1.value);
    }
    if(!isWhitespace(document.AddForm.defprob2.value)) {
      if(problems!="") { problems+=" ; ";}
      problems+=trim(document.AddForm.defprob2.value);
    }
    if(!isWhitespace(document.AddForm.defprob3.value)) {
      if(problems!="") { problems+=" ; ";}
       problems+=trim(document.AddForm.defprob3.value);
    }
    document.AddForm.outptcom.value=problems
  } else if (refletter == 3) {              // Appointment Request
    document.AddForm.slotbtyp.value="2";
    document.AddForm.defclnty.value="%OUTWEB02.05.362.010.1"; // Clinic Type
    document.AddForm.defclnid.value="%OUTWEB02.05.362.011.1"; // Clinic Id
    document.AddForm.defvisty.value="%OUTWEB02.05.362.012.1"; // Slot Type
    document.AddForm.outbb013.value="%OUTWEB02.05.362.016.3"; // Priority
    document.AddForm.defclaim.value="%OUTWEB02.05.362.015.1"; // Claim Code
    for (var i=0; i < document.AddForm.outbb002.length; i++) {
     if (document.AddForm.outbb002.options[i].value.substr(0,3)==
         document.AddForm.defclaim.value.substr(0,3)){
         document.AddForm.outbb002.selectedIndex=i;
     }
    }
    document.AddForm.pmsvx052.value="%OUTWEB02.05.362.014";   // Presenting C
    document.AddForm.outbb023.value="%OUTWEB02.05.362.013.3"; // Transport
    document.AddForm.outbb054.value="%OUTWEB02.05.362.018.3"; // Special Arr
    document.AddForm.outbb001.value="%OUTWEB02.05.362.017.3"; // Source of Ref
    document.AddForm.outbb022.value="%OUTWEB02.05.362.006.3"; // Unit
  } else {
    if(document.AddForm.waitflag.value=="1") {
      document.AddForm.defclnty.value="%STANDARD.01.025.111.012.0.6";
      document.AddForm.outbb002.value="%OUTWEB02.05.256.3";
      document.AddForm.outptcom.value="%OUTWEB02.05.257";
    }
    if(document.AddForm.waitflag.value=="2") {
      document.AddForm.defclnty.value="%STANDARD.01.025.111.018.0.6";
      document.AddForm.outbb002.value="%OUTWEB02.05.256.3";
      document.AddForm.outptcom.value="%OUTWEB02.05.257";
    }
    if(document.AddForm.defclnty.value=="000000") {
       document.AddForm.defclnty.value="        ";
    }
    checkRefLetter(document.AddForm.urnumber.value);
  }
}
function ShowAppointments() {
  SearchJSON = new Object();
  var srchrefn=document.AddForm.refrlvis.value.replace(/ /g,"+");
  el = document.getElementById("startnum");
  var startnum=el.value.replace(/ /g,"+");
  el = document.getElementById("filtctyp");
  var clinicty=el.options[el.selectedIndex].value.replace(/ /g,"+");
  el = document.getElementById("filtclid");
  var clinicid=el.options[el.selectedIndex].value.replace(/ /g,"+");
  el = document.getElementById("visittyp");
  var visittyp=el.options[el.selectedIndex].value.replace(/ /g,"+");
  el = document.getElementById("srchtime");
  var srchtime=el.options[el.selectedIndex].value.replace(/ /g,"+");
  el = document.getElementById("srchperd");
  var srchperd=el.options[el.selectedIndex].value.replace(/ /g,"+");
  el = document.getElementById("srchdate");
  var srchdate="";
  if (el.selectedIndex>0) srchdate=el.options[el.selectedIndex].value.replace(/ /g,"+");
  var SelectOptionStartDate=new Date();
  var FirstAppointment=""
  top.setCookie("outweb0203035-srchperd",srchperd.replace(/\+/g," "));
  var url   = "outweb01.pbl?reportno=2&template=5&norecord=20&srchflag=1"+
              "&startnum="+ startnum +
              "&clinicid="+ clinicid +
              "&clinicty="+ clinicty +
              "&srchdate="+ srchdate +
              "&srchperd="+ srchperd +
              "&visittyp="+ visittyp +
              "&srchtime="+ srchtime +
              "&srchrefn="+ srchrefn; 
  var xmlHttp = createHttpObject();
  xmlHttp.open('GET',url,true);
  xmlHttp.send();
  xmlHttp.onreadystatechange = function() {
    if (xmlHttp.readyState == 4) {
      if (xmlHttp.status == 200) {
        SearchJSON = eval("("+xmlHttp.responseText+")"); //convert text to javascript object
        if (SearchJSON.length == 0) {
          ListLocation = document.getElementById("SearchResults");
          ListLocation.innerHTML = "<ul class='sectionList'>"+
                                   "<li class='sectionItem' style='text-align:center'>"+
                                   "No Available Appointments Found</li></ul>";
          return;
        }
        var availApp=0;
        var OS2="<ul class='sectionList'> ";
        for(var i =0; i < SearchJSON.length; i++) {
         if (SearchJSON[i].code.substring(0,5) != "Error") {
          if (FirstAppointment=="") FirstAppointment=SearchJSON[i].code;
          availApp++;
          OS2 += "<li class=sectionItem onclick=\"AddAppointment("+i+
                 ",'"+SearchJSON[i].code+"','"+SearchJSON[i].visitcode+
                 "','"+SearchJSON[i].clinic+"','"+SearchJSON[i].value+"');\" />"+
                 SearchJSON[i].value +
                 "<br /><span class=subText>"+SearchJSON[i].clinic + " - " + SearchJSON[i].type +
                  " - " + SearchJSON[i].visit + "</span></li>"; 
          }
        }
        if (availApp==0) {
          OS2+="<li class='sectionItem' style='text-align:center'>"+
               "No Valid Appointments Found<br>Check Referral Details</li>";
        }
        ListLocation = document.getElementById("SearchResults");
        ListLocation.innerHTML = OS2+"</ul>";
        } else {
        alertify.alert("Web Service Call Failed Error : "+xmlHttp.status);
      }
    }
    if (FirstAppointment!="") {
      var setDay=FirstAppointment.substr(18,2);
      var setMonth=parseInt(FirstAppointment.substr(16,2),10)-1;
      var setYear=FirstAppointment.substr(12,4);
      SelectOptionStartDate = new Date(setYear,setMonth,setDay,0,0,0);       // midnight
    }
    el = document.getElementById("srchdate");
    el.options.length=1;
    dateSelectionList(el,SelectOptionStartDate,84)
  }
}
function dateSelectionList(el,StartDate,noDays) {
  var theDay;
  var weekday=new Array(7);
  weekday[0]="Sun";
  weekday[1]="Mon";
  weekday[2]="Tue";
  weekday[3]="Wed";
  weekday[4]="Thu";
  weekday[5]="Fri";
  weekday[6]="Sat";
  for (var i=0;i<noDays;i++) {
     theDay = new Date(StartDate.getTime()+(i*24*60*60*1000));
     dayVal = "0"+theDay.getDate();
     mthVal = "0"+(theDay.getMonth()+1);
     dayVal=dayVal.substr(dayVal.length-2,2);
     mthVal=mth3Name(mthVal.substr(mthVal.length-2,2));
     dateVal = dayVal+' ' + mthVal + ' ' +  theDay.getFullYear();
     dateName=weekday[theDay.getDay()] + ' ' + dateVal;
     el.options[el.options.length]=new Option(dateName,dateVal);
  }
}
function SelectType() {
 el=document.SelectPeriod;
 filtctyp=el.filtctyp.options[el.filtctyp.selectedIndex].value;
 document.SelectPeriod.filtclid.options.length=1;
 filtclid=document.SelectPeriod.clinicid.value;
 SetTypeClinic(SelectPeriod.filtclid,'',SelectPeriod.usersite.value,SelectPeriod.filtctyp.value);
 el = document.getElementById("visittyp");
 el.selectedIndex=0;
 ShowAppointments();
}
function SelectClin() {
 ShowAppointments();
}
function setButtons() {
//
//  SetAppointDefaults(%OUTWEB02.05.214);
//
  filtctyp=document.SelectPeriod.clinicty.value;
  SetClinicType(SelectPeriod.filtctyp,filtctyp,SelectPeriod.usersite.value);
  filtclid=document.SelectPeriod.clinicid.value;
  SetTypeClinic(SelectPeriod.filtclid,filtclid,SelectPeriod.usersite.value,SelectPeriod.filtctyp.value);

  var actionBtn = parent.document.getElementById('actionButton');
  if(actionBtn) {
    actionBtn.className = actionBtn.className.replace(/SpanButton/g,"");
    actionBtn.className = actionBtn.className.replace(/Blue/g,"");
    actionBtn.className = actionBtn.className + " SpanButtonBlue";
    actionBtn.innerText = "Save";
    actionBtn.onclick = function() { submitUpdate() }
  }
  theForm=document.AddForm
  for (i=0; i<theForm.elements.length; i++) {
    el=theForm.elements[i]
    if (el.type=="text")  el.value=trim(el.value);
    if (el.type=="textarea"){
      el.value=el.value.replace(/ *$/gm,'');
      el.value=el.value.replace(/^(\r\n)|(\n)$/gm,'');
    }
  }
}
function submitUpdate() {
// alertify.alert("WIP: Facility Not Yet Available.");
// return;
//
// tempDisable(this);
// checkSlot(AddForm.newslotk.value,AddForm.urnumber.value,SubmitFinal);
//
  var bool = validateMandatory(AddForm);
  if(bool) {
    theURL=document.AddForm.action;
    var postStr=AJAXPostString2(document.AddForm)
    var xmlHttp = createHttpObject();
    xmlHttp.open("POST", theURL, false);
    xmlHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    xmlHttp.send(postStr);
    if (xmlHttp.status=="200") {
      if (xmlHttp.responseText.match(/PROCESSING|OK/i)) {
        var ldt= new Date()
        top.setCookieTime("AccessDateTime",ldt,"60")
        parent.frames['PatFrame'].refreshScreen();
        parent.CloseDocument();
      } else {
        alertify.alert(xmlHttp.responseText.replace(/.*alert../i,"").replace(/.\).*/i,""));
      }
    } else {
      alertify.alert("Web Service Not Available. Check your Connection and Try Again.");
    }
  }
  return bool
}
</script>
</head>
<body onload="setButtons();">
<ul class=sectionList>
  <li class=sectionItem>
  <div style='text-align:center;font-family:Arial;'>
  %OUTWEB02.05.002
  (%OUTWEB02.05.019,  %OUTWEB02.05.020,  %OUTWEB02.05.021, %OUTWEB02.05.003) <br />
  </div>
  </li>
</ul>

<form name=AddForm action=outweb02.pbl method=POST>
<input type=hidden name=reportno value="06">
<input type=hidden name=template value="004">
<input type=hidden name=urnumber value="%OUTWEB02.05.003">
<input type=hidden name=updatety value="5">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="PROCESSING|OK">
<input type=hidden name=defclnty value="%OUTWEB02.05.108">
<input type=hidden name=defclnid value="%OUTWEB02.05.103.0">
<input type=hidden name=defvisty value="%OUTWEB02.05.110.1">
<input type=hidden name=defclaim value="">
<input type=hidden name=dummy value="">
<input type=hidden name=dummydat value="">
<input type=hidden name=outbb016 value="" >
<input type=hidden name=srchclid value="%OUTWEB02.05.103.0">
<input type=hidden name=bookflag value="%OUTWEB02.05.214">
<input type=hidden name=admissno value="%OUTWEB02.05.081">
<input type=hidden name=refrlvis value="%OUTWEB02.05.353.001">
<input type=hidden name=refrdate value="%OUTWEB02.05.353.019">
<input type=hidden name=refrexpd value="%OUTWEB02.05.353.087">
<input type=hidden name=refrclin value="%OUTWEB02.05.353.088.1">
<input type=hidden name=refrctyp value="%OUTWEB02.05.353.067.1">
<input type=hidden name=tmplredi value="">
<input type=hidden name=ptcnueoc value="%OUTWEB02.05.216">
<input type=hidden name=clinctyp value="%OUTWEB02.05.205.1">
<input type=hidden name="claimc">
<input type=hidden name=waitlkey value="%OUTWEB02.05.219">
<input type=hidden name=waitflag value="%OUTWEB02.05.220">
<input type=hidden name=otcncsum value="%OUTWEB02.05.222">
<input type=hidden name=checkdat value="">
<input type=hidden name=dumdate  value="">
<input type=hidden name=dumInput value="">
<input type=hidden name=clinindc value="">
<input type=hidden name=dateclin value="%OUTWEB02.05.104">
<input type=hidden name=nslotkey value="">
<input type=hidden name=ibcnumci value="%STANDARD.01.025.000.132.0.1">
<input type=hidden name=otmaumci value="">
<input type=hidden name=otheccar value="">
<input type=hidden name=datefrom>
<input type=hidden name=dateto>
<input type=hidden name=deftovrd value="">
<input type=hidden name=defprob1 value="">
<input type=hidden name=defprob2 value="">
<input type=hidden name=defprob3 value="">
<input type=hidden name=requestk value="%OUTWEB02.05.362.041">
<input type=hidden name=otcnureq value="%STANDARD.01.025.032.136.0.1">
<input type=hidden name=othendps value="%OUTWEB02.05.258">
<input type=hidden name=currdate value="%STANDARD.01.015">
<input type=hidden name=ptcnxcom value="%STANDARD.01.025.116.222.0.1">
<input type=hidden name="slotbtyp" value="1">

<table border="0" cellspacing=0 cellpadding=1 width=100%>
<tr valign=top>
<td>
<ul class=sectionList>
  <li class=sectionItem>
  <span class="labelText">Clinic</span>
  <span class="sectionText">
    <input type=hidden name=newslotk value="DEFAULT">
    <input type=text size=40 name=clindesc class=Mandatory title="Clinic"
     readonly value="%OUTWEB02.05.103.1">
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Date </span>
  <span class="sectionText">
    <input type=text size=40 name=clindate class=Mandatory title="date"
     readonly value="%OUTWEB02.05.113 %OUTWEB02.05.104 %OUTWEB02.05.107">
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Visit Type </span>
  <span class="sectionText">
    <select style='width:250px;' name=outbb047 title="Visit Type" class="SelectBig Mandatory">
    <option></option>
    %OUTWEB02.05.199
    </select>
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Presenting Complaint </span>
  <span class="sectionText">
    <input type=text name=pmsvx052 size=40 maxlength=50 value="">
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Diagnosis</span>
  <span class="sectionText">
   <input type=hidden id=outbb045 name=outbb045 value="">
   <input type="text" size="40" id="outbb046" name="outbb046"
    placeholder="Diagnosis" class="searchFormInput"
    searchType="6" returnId="outbb045" onfocus="this.value='';"
    value="" oninput="AutoSuggest();">

   <input type=hidden id=outbb055 name=outbb055 value="">
   <input type="text" size="40" id="outbb056" name="outbb056"
    placeholder="Diagnosis" class="searchFormInput"
    searchType="6" returnId="outbb055" onfocus="this.value='';"
    value="" oninput="AutoSuggest();">

   <input type=hidden id=outbb057 name=outbb057 value="">
   <input type="text" size="40" id="outbb058" name="outbb058"
    placeholder="Diagnosis" class="searchFormInput"
    searchType="6" returnId="outbb057" onfocus="this.value='';"
    value="" oninput="AutoSuggest();">

   <input type=hidden id=outbb059 name=outbb059 value="">
   <input type="text" size="40" id="outbb060" name="outbb060"
    placeholder="Diagnosis" class="searchFormInput"
    searchType="6" returnId="outbb059" onfocus="this.value='';"
    value="" oninput="AutoSuggest();">
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Transport</span>
  <span class="sectionText">
    <select style='width:250px;' name=outbb023 class=SelectBig title=Transport>
        <option></option>
        %OUTWEB02.05.142.2
        </select>
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Priority</span>
  <span class="sectionText">
    <select style='width:250px;' name=outbb013 class=SelectBig title=Priority>
   	<option></option>
   	%OUTWEB02.05.132.2
   	</select>
  </span></li>

  <li class=sectionItem>
  <span class="labelText">%STANDARD.01.017.CL</span>
  <span class="sectionText">
    <select style='width:250px;' name=outbb002 class="Mandatory SelectBig" title="%STANDARD.01.017.CL">
    <option></option>
    %OUTWEB02.05.197.9.1.10.2.X
    </select>
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Unit</span>
  <span class="sectionText">
    <select style='width:250px;' name=outbb022 class="SelectBig" title="Unit">
   	<option></option>
   	%OUTWEB02.05.141.2
	   </select>
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Source of Referral</span>
  <span class="sectionText">
    <select style='width:250px;' name=outbb001 class="Mandatory SelectBig" title="Source of Referral">
    <option></option>
    %OUTWEB02.05.120.2
    </select>
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Reports Required</span>
  <span class="sectionText">
    <select style='width:250px;' name=outbb017 class=SelectBig>
    <option></option>
    %OUTWEB02.05.136.2
    </select>
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Special Arrangements</span>
  <span class="sectionText">
    <select style='width:250px;' name=outbb054 class=SelectBig title="Special Arrangements">
    <option> </option>
    %OUTWEB02.05.178.2
    </select>
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Referring GP</span>
  <span class="sectionText">
    <input type=hidden name=dummy1 value="6">
    <input type=hidden name=outbb029 >
    <input type=text size=40 readonly name=name_outbb029 value="%OUTWEB02.05.148.004" class=Readonly>
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Notify GP</span>
  <span class="sectionText">
    <input type=checkbox value=1 name=outbb036>
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Send Letter</span>
  <span class="sectionText">
    <select name=outbb067 title="Send Letter" onchange="SendLetterDate(AddForm);">
    <option></option>
    <option value="0">No</option>
    <option value="1">Yes</option>
    <option value="2">N/A</option>
    </select>
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Generated Letter Date</span>
  <span class="sectionText">
    <input type=text name=outbb066 size=12 onblur="checkDate(this,'Date')" value=""
     class="Date" title="Generate Letter Date">
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Comments</span>
  <span class="sectionText">
    <textarea name=outptcom wrap=hard cols=40 rows=3></textarea>
  </span></li>
</form>
</ul>
  </td>
<form name=SelectPeriod>
<input type=hidden name=defclnty value="" id=clinicty>
<input type=hidden name=defclnid value="" id=clinicid>
<input type=hidden name=defvisty value="">
  <td width=35%>
  <ul id=SearchAppointment class=sectionList>
    <li class='sectionItem' style='text-align:center'>
    <select style='width:250px;margin-bottom:10px;' id=filtctyp name=filtctyp 
     onchange="SelectType();" title="Clinic Type">
    <option value="">Select Clinic Type</option>
    </select>
    <select style='width:250px;margin-bottom:10px;' id=filtclid name=filtclid 
     onchange="SelectClin();" title="Clinic">
    <option value="">Select Clinic </option>
    </select>
    <select name=visittyp style='width:250px;margin-bottom:10px;'
     onchange='ShowAppointments()' id=visittyp title='Visit Type'>
    <option value="">Select Visit Type</option>
    %OUTWEB02.05.199
    </select>
    <select name=srchperd style='width:250px;margin-bottom:10px;'
     onchange='ShowAppointments()' id=srchperd title='Next Appoinment'>
     <option value="   ">After Today</option>
     <option value="01D">Tomorrow</option>
     <option value="02D">After 2 days</option>
     <option value="03D">After 3 days</option>
     <option value="04D">After 4 days</option>
     <option value="05D">After 5 days</option>
     <option value="06D">After 6 days</option>
     <option value="01W">After 1 week</option>
     <option value="02W">After 2 weeks</option>
     <option value="03W">After 3 weeks</option>
     <option value="04W">After 4 weeks</option>
     <option value="05W">After 5 weeks</option>
     <option value="06W">After 6 weeks</option>
     <option value="07W">After 7 weeks</option>
     <option value="08W">After 8 weeks</option>
     <option value="01M">After 1 month</option>
     <option value="02M">After 2 months</option>
     <option value="03M">After 3 months</option>
     <option value="04M">After 4 months</option>
     <option value="05M">After 5 months</option>
     <option value="06M">After 6 months</option>
     <option value="07M">After 7 months</option>
     <option value="08M">After 8 months</option>
     <option value="09M">After 9 months</option>
     <option value="10M">After 10 months</option>
     <option value="11M">After 11 months</option>
     <option value="12M">After 12 months</option>
    </select>
    <select name=srchtime style='width:250px;margin-bottom:10px;'
     onchange='ShowAppointments()' id=srchtime title='Preferred Time'>
     <option value="00:0024:00">Any Time</option>
     <option value="07:0012:00">Morning</option>
     <option value="12:0018:00">Afternoon</option>
     <option value="18:0024:00">Evening</option>
     <option value="07:0010:00">7am to 10am</option>
     <option value="16:0020:00">4pm to 8pm</option>
     <option value="12:0014:00">Lunch Time</option>
    </select>
    <select name=srchdate style='width:250px;margin-bottom:10px;'
     onchange='ShowAppointments()' id=srchdate title='Available on or After'>
    <option value="">Appointments on or After</option>
    </select>
    </li>
  </ul>
  <div id=SearchResults></div>
  </td>
  </tr>
  </table>
<input type=hidden name=usersite value="%STANDARD.01.023">
<input type=hidden name=startnum id=startnum value=0>
</form>

<div id='-suggestion-panel-wrapper' style='display:none;'>
 <div id='-suggestion-panel-wrapper2' style='width:100%'>
  <ul id='-suggestion-table' style='width:100%'></ul>
 </div>
</div>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%OUTWEB02.05.003">
<input type=hidden name=admissno value="%OUTWEB02.05.081">
<input type=hidden name=MenuType value="%OUTWEB02.05.088">
<input type=hidden name=casekeys value="%OUTWEB02.05.166">
</form>
</body>
