<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="svmp">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src=../js/TableSort.js></script>
<script type="text/javascript" src=../js/oprweb03.js></script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Columns Available
//  0 - HTML Link   
//  1 - Date & Time
//  2 - U/R
//  3 - Patient
//  4 - Theatre
//  5 - Surgeon
//  6 - Ward
//  7 - Bed
//  8 - DOSA Time
//  9 - Time arrived
// 10 - Time called for
// 11 - Date Time Stamp Link
// 12 - Nursing Station Extension
//
//
// 19 - Patient Alerts
//---------------------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
 t = new Table(1,0,2,"100%","center",35,50);
 t.addColumn("Date Time","DateTime",1,1,"left","","",105)
 t.addColumn("U/R","String",2,2,"left","","",50)
 t.addColumn("Patient","ImageText",20,20,"left","PatientFolder","17",150,16)
 t.addColumn("Alerts","String",19,-1,"left","","",30)
 t.addColumn("Theatre","String",4,4,"left","UpdateLink.gif","5",150)
 t.addColumn("Surgeon","String",6,6,"left","","",80)
 t.addColumn("Ward","String",7,7,"left","","",25)
 t.addColumn("Bed","String",8,8,"left","","",25)
 t.addColumn("Nursing Station","String",11,11,"left","","",35)
 t.addColumn("DOSA Time","String",9,9,"left","","",40)
 t.addColumn("Time Called For","String",12,12,"left","DateTimeStamp.gif","14",55)
 t.addColumn("Time Arrived","String",10,10,"left","DateTimeStamp.gif","0",55)
 AddTableRows()
 TableOutput(2,1);
 break; }
 }
}
 function CaseLink(casekeys) {
  LinkForm.casekeys.value=casekeys;
  DFrameSubmit(LinkForm,30,50,750,300);
}

 function UpdateLink(casekey) {
  linkurl="oprweb01.pbl?reportno=4&template=14&casekeys="+casekey;
  DFrameLink(linkurl,30,50,350,180);
}
 function submitTimeForm(viewtype,lastdate,theacode, 
                         vyearmth,surgc001,opdunqid,
                         listtype,oparatim) {
 var serverURL = "../cgi-bin/patweb80.pbl?reportno=1";
 var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValues=returnValue.return_value.split("|")
      document.TimeForm.surgc001.value=ReturnValues[1].substr(0,5);
       }
  document.TimeForm.viewtype.value=viewtype;
  document.TimeForm.lastdate.value=lastdate;
  document.TimeForm.theacode.value=theacode;
  document.TimeForm.vyearmth.value=vyearmth;
  document.TimeForm.opdunqid.value=opdunqid;
  document.TimeForm.listtype.value=listtype;
  document.TimeForm.submit();
}
 function UpdateTime(viewtype,lastdate,theacode, 
                    vyearmth,surgc001,opdunqid,
                    listtype,oparatim) {
  time1=surgc001.substring(0,2)+surgc001.substring(3,5);
  time2=oparatim.substring(0,2)+oparatim.substring(3,5);
//alert(time1+" "+time2);
  if(time1 > time2) {
    if (!isWhitespace(time2)) {
      if(confirm("Time Called for cannot be after the Arrival Time." +
        "\n Do you want to override")) {
        submitTimeForm(viewtype,lastdate,theacode, 
                       vyearmth,surgc001,opdunqid,
                       listtype,oparatim);
      }
    } else {
      submitTimeForm(viewtype,lastdate,theacode, 
                     vyearmth,surgc001,opdunqid,
                     listtype,oparatim);
    }
  } else {
    submitTimeForm(viewtype,lastdate,theacode, 
                   vyearmth,surgc001,opdunqid,
                   listtype,oparatim);
  }
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0); dispDayCmt();">
<div id=HeadingSection>
<form name=SelectPeriod action=oprweb03.pbl method=get>
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=4>
<input type=hidden name=viewtype value="%OPRWEB03.03.010">
<input type=hidden name=opcnscom id=opcnscom
       value="%STANDARD.01.025.042.241.0.1">
<input type=hidden name=dispdayc id=dispdayc
       value="%OPRWEB03.03.030.023" >
<input type=hidden name=daycmcnt id=daycmcnt
       value="%OPRWEB03.03.030.024">
<input type=hidden name=currdate id=currdate
       value="%STANDARD.01.015">
     
<table cellpadding=3 cellspacing=0 bgcolor=#CCCCCC border=0 width=100%>
<tr><td>
   <input type=button value="<<" class=SmallButton
   onClick='location.href="%OPRWEB03.03.002"'>
   %OPRWEB03.03.007
   <input type=button value=">>" class=SmallButton
   onClick='location.href="%OPRWEB03.03.001"'>
   &nbsp;&nbsp;
 Theatre
 <select class=PMenuSelectList name=theacode onchange='SelectPeriod.submit()'
    id=theacode>
    <option value=" ">All </option>
          %OPRWEB03.03.014 
    </select> 
   &nbsp;&nbsp;
 List 
 <select class=PMenuSelectList name=listtype onchange='SelectPeriod.submit()'
    id=listtype>
          %OPRWEB03.03.015
    </select>
   &nbsp;&nbsp;
   %STANDARD.01.017.YD
   <select class=PMenuSelectList name=surgtype onchange='SelectPeriod.submit()'
    id=surgtype>
   <option value="ALL">All</option>
    %OPRWEB03.03.018.2
   </select>
   &nbsp;&nbsp;
   Time Period
   <select class=PMenuSelectList name=filttper onchange='SelectPeriod.submit()'
    id=filttper>
   <option value="">All</option>
    %OPRWEB03.03.021.2
   </select>
</td>

  <!--T0846427-start-->
  <td align=left id="dispdcmmt" style="display:none"><b>Comments for today: </b>
   &nbsp;&nbsp;%OPRWEB03.03.030.022</td>
  <td align=left id="dispdcmbt" style="display:none"><b>Comments for today: </b>
      &nbsp;&nbsp;%OPRWEB03.03.030.022
      &nbsp;&nbsp;<input type=button name=daycmtbutton id=daycmtbutton
       class=button value="Day Comments"
       onClick="DayCommentsUpd(currdate);"></td>
  <!--T0846427-end-->

<td align=right>
  <a href='javascript:SelectDateFrame();'>
  <img src="../images/DateLookup.gif" class=Icon
   alt="Select Date" align=absmiddle></a>
  <a href='javascript:SelectView("0");'>
  <img src=../images/DayIcon.gif class=Icon
   alt="View Today" align=absmiddle></a>
  <a href='javascript:SelectView("1");'>
  <img src=../images/WeekIcon.gif class=Icon
   alt="View This Week" align=absmiddle></a>
  <a href='javascript:SelectView("2");'>
  <img src=../images/MonthIcon.gif class=Icon
   alt="View This Month" align=absmiddle></a>
</td></tr>
</table>
</form>
<form name=LinkForm method=get action=oprweb01.pbl>
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=3>
<input type=hidden name=casekeys >
</form>
<form name=TimeForm method=post action=oprweb03.pbl>
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=4>
<input type=hidden name=updttype value='U'>
<input type=hidden name=nextpage value=1>
<input type=hidden name=viewtype>
<input type=hidden name=lastdate>
<input type=hidden name=theacode>
<input type=hidden name=vyearmth>
<input type=hidden name=surgc001>
<input type=hidden name=opdunqid>
<input type=hidden name=listtype>
</form>
</div>
<div id=TableLocation></div>
<script type="text/javascript">
function AddTableRows() {
%OPRWEB03.03.013.oprweb01.04.003.0
}
function PatientAlerts(urnumber,admissno) {
  linkurl="patweb98.pbl?reportno=1&template=003" +
          "&urnumber=" + urnumber + "&admissno=" + admissno
  location.href=linkurl
}
</script>
