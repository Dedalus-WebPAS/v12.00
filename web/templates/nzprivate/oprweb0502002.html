<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="nzprivate">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb05.js"></script>
<script type="text/javascript" src="../js/TheatreScreensHoverInfo.js"></script>
<script type="text/javascript">
function AssignAddForm() {
  parent.AddForm.reportno.value=document.AddForm.reportno.value;
  parent.AddForm.template.value=document.AddForm.template.value;
  parent.AddForm.updttype.value=document.AddForm.updttype.value;
  parent.AddForm.opses003.value=document.AddForm.opses003.value;
  parent.AddForm.respnvar.value=document.AddForm.respnvar.value;
  parent.AddForm.startime.value=document.AddForm.startime.value;
  parent.AddForm.endtime.value=document.AddForm.endtime.value;
  parent.AddForm.sesstime.value="";
  parent.AddForm.duration.value=document.AddForm.duration.value;
  parent.AddForm.overrid1.value=document.AddForm.overrid1.value;
  parent.AddForm.overrid2.value=document.AddForm.overrid2.value;
  parent.AddForm.overrid3.value=document.AddForm.overrid3.value;
  parent.AddForm.overrid4.value=document.AddForm.overrid4.value;
  parent.AddForm.overrid5.value=document.AddForm.overrid5.value;
  parent.AddForm.overrid6.value=document.AddForm.overrid6.value;
  parent.AddForm.opses001.value=document.AddForm.opses001.value;
  parent.AddForm.opses002.value=document.AddForm.opses002.value;
  parent.AddForm.opses007.value=document.AddForm.opses007.value;
  parent.AddForm.opses008.value=document.AddForm.opses008.value;
  parent.AddForm.opses009.value=document.AddForm.opses009.value;
  parent.AddForm.opses010.value=document.AddForm.opses010.value;
  parent.AddForm.opses013.value=document.AddForm.opses013.value;
  parent.AddForm.opses011.value=document.AddForm.opses011.value;
  parent.AddForm.opses012.value=document.AddForm.opses012.value;
  parent.AddForm.opses015.value=document.AddForm.opses015.value;
  parent.AddForm.opses014.value=document.AddForm.opses014.value;
  parent.AddForm.opses064.value=document.AddForm.opses064.value;
  parent.AddForm.opses069.value=document.AddForm.opses069.value;
  parent.AddForm.opses070.value=document.AddForm.opses070.value;
  parent.AddForm.opses071.value=document.AddForm.opses071.value;
  parent.AddForm.opses067.value=document.AddForm.opses067.value;
  parent.AddForm.opses068.value=document.AddForm.opses068.value;
  if(document.AddForm.ibcnmhos.value=="1") {
    parent.AddForm.opses074.value=document.AddForm.opses074.value;
  }
}
function GetOpr() {
   selectOptions2(20,AddForm.opses074,AddForm.opses013);
}

function DeftHosp() {
  if (document.AddForm.ibcnmhos.value == "1") 
  {
    document.getElementById('multihosp').style.visibility = "visible";
    document.AddForm.opsem019.value = document.AddForm.wbsehosp.value;
  }
  GetOpr();
}     
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DeftHosp();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
<script type="text/javascript">document.write(self.document.title);</script>
</span>

   <form name=AddForm method=get action=oprweb05.pbl>
   <input type=hidden name=reportno value="2">
   <input type=hidden name=template value="002">
   <input type=hidden name=updttype value="A">
   <input type=hidden name=opses003 value="%OPRWEB05.02.001">
   <input type=hidden name=respnvar value="">
   <input type=hidden name=startime value="">
   <input type=hidden name=endtime value="">
   <input type=hidden name=duration value="">
   <input type=hidden name=overrid1 value="">
   <input type=hidden name=overrid2 value="">
   <input type=hidden name=overrid3 value="">
   <input type=hidden name=overrid4 value="">
   <input type=hidden name=overrid5 value="">
   <input type=hidden name=overrid6 value="">
   <input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
   <input type=hidden name=wbsehosp value="%STANDARD.01.032">
   <input type=hidden name=opses073 value="" />
   <input type=hidden name=opses074 value="%STANDARD.01.032">
   <input type=hidden name=opsmhosp value="%OPRWEB05.02.026" />
<table cellspacing=0 cellpadding=0 width=100% >

<tr><td align=center class=Heading>
            <b> AdHoc Session for %OPRWEB05.02.002 (%OPRWEB05.02.001)</b></td>
</table>

<table align=center cellspacing=0 cellpadding=1 width=95% border=0>
<tr><td class=DataLabel>Session Date</td>
    <td><input type=text name=opses001 class=Mandatory title="session Date"
    id=opses001 size=12 maxlength=12 onblur="checkDate(this,'Session Date');">    
    <img src=../images/DateLookup.gif class=Icon
     onclick="DateLookupFrame(opses001);">
    <img src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="AddForm.opses001">
    </td></tr>

<tr><td class=DataLabel>Start Time</td>
    <td><input type=text name=opses002 class=Mandatory title="Start Time"
         size=6 maxlength=6 id=opses002
         onblur="checkTime(this);CheckOvernight(opses002,opses007,opses008);">
        <img src=../images/TimeLookup.gif class=Icon
      onclick="TimeLookupFrame(opses002);">
    </td></tr>

<tr><td class=DataLabel>End Time</td>
    <td><input type=text name=opses007 class=Mandatory title="End Time"
         size=6 maxlength=6 id=opses007
         onblur="checkTime(this);CheckOvernight(opses002,opses007,opses008);">
        <img src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(opses007);">
    </td></tr>

<tr><td colspan=2><hr></td></tr>

<tr><td class=DataLabel>Duration (min)</td>
    <td><input type=text name=opses008 class=Readonly title="Duration"
         size=6 maxlength=3 readonly tabindex=-1
         onclick="CheckOvernight(opses002,opses007,opses008);">
    </td></tr>

<tr><td class=DataLabel>Time for Breaks (min)</td>
    <td><input type=text name=opses009 class=Mandatory title="time for Breaks"
         size=6 maxlength=3>
    </td></tr>

<tr><td class=DataLabel>Prep Time per Patient (min)</td>
    <td><input type=text name=opses010 class=Mandatory 
         title="Prep time per Patient" size=6 maxlength=2>
    </td></tr>

<!-- Multi-Hospital Selection List when IBCNMHOS=1
% OPRWEB05.02.179.2
-->
<tr id="multihosp" style="visibility:hidden;">                                                                                                     
    <td class="DataLabel">Hospital</td>                                                                                                            
    <td><input type="text" value="%OPRWEB05.02.025.1" size="50"                                                                                    
        readonly class="readonly"/>                                                                                                                
        <input type="hidden" name="opsem019" value="   " />                                                                           
     </td></tr> 

<tr><td class=DataLabel>Operating Room</td>
    <td><select name=opses013 title="Operating Room">
          <option></option>
          %OPRWEB05.02.114.2            
          </select>
    </td></tr>

<tr><td class=DataLabel>Time Period</td>
    <td><select name=opses011 class=Mandatory title="Time Period">
          <option></option>
          %OPRWEB05.02.112.2            
          </select>
    </td></tr>

<tr><td class=DataLabel>Unit</td>
    <td><select name=opses012 class=Mandatory title="Unit">
          <option></option>
          %OPRWEB05.02.007.2            
          </select>
    </td></tr>
 
<tr><td class=DataLabel>Usual Anaesthetist</td>
    <td><input type=text name=opses015 title="Usual Anaesthetist" id=opses015
         size=6 maxlength=6 onblur="validateCode(31,opses015,name_opses015);">
    <input type=text name=name_opses015 title="Usual Anaesthetist" id=name_opses015
     size=22 maxlength=30 class=Readonly readonly tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
    onclick="DoctorSearchFrame(opses015,name_opses015);">
    <img src="../images/erase.gif" class=Icon
    onclick="clrDoc(opses015,name_opses015);">
</td></tr>
 
<tr><td class=DataLabel>Session Co-ordinator</td>
    <td><input type=text name=opses014 title="session Co-ordinator" id=opses014
         size=6 maxlength=6 onblur="validateCode(31,opses014,name_opses014);">
    <input type=text name=name_opses014 title="session Co-ordinator"
     size=22 maxlength=30 class=Readonly readonly tabindex=-1 id=name_opses014>
    <img src="../images/SearchIcon.gif" class=Icon
    onclick="DoctorSearchFrame(opses014,name_opses014);">
    <img src="../images/erase.gif" class=Icon
    onclick="clrDoc(opses014,name_opses014);">
</td></tr>

<tr><td class=DataLabel>Extra Doctor</td>
    <td><input type=text name=opses064 title="Extra Doctor" id=opses064
         size=6 maxlength=6 onblur="validateCode(31,opses064,name_opses064);">
    <input type=text name=name_opses064 title="Extra Doctor" id=name_opses064
     size=22 maxlength=30 class=Readonly readonly tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
    onclick="DoctorSearchFrame(opses064,name_opses064);">
    <img src="../images/erase.gif" class=Icon
    onclick="clrDoc(opses064,name_opses064);">
</td></tr>

<tr><td class=DataLabel>Number of Days to Lock Session</td>
    <td><input type=text name=opses069 title="Number of Days to Lock Session" 
         class=DataField size=6 maxlength=2 min=0 
         onblur=checkInteger(this,this.title)>
    </td>
</tr>
<tr><td class=DataLabel>Session Type</td>
    <td><select name=opses070 class=Mandatory title="Session Type">
          <option></option>
          %OPRWEB05.02.169.4
          </select>
          <img src="../images/HelpIcon.gif" class="Icon"
               onmouseover="showPopUp(AddAdHoc)";>
    </td>
</tr>
<tr><td class=DataLabel>%STANDARD.01.017.YD</td>
    <td><select name=opses071 class=Mandatory 
         title="%STANDARD.01.017.YD">
          <option></option>
          %OPRWEB05.02.175.4
          </select>
    </td>
</tr>
<tr><td class=DataLabel>Special Instructions 1</td>
    <td><input type=text name=opses067 title="Special Instructions 1" 
         class=DataField size=60>
    </td>
</tr>
<tr><td class=DataLabel>Special Instructions 2</td>
    <td><input type=text name=opses068 title="Special Instructions 2" 
         class=DataField size=60>
    </td>
</tr>

</td></tr>
<tr><td colspan=2 align=center>
    <input type=button value="Add" class="button" 
           onclick="validateTheatreAvailability();">
    <input type=button value="Close" class="button" onclick='DFrameCloseRefresh()'>
</td></tr>
</table>
</form>
<script>
function validateTheatreAvailability() {

  if (!validateMandatory(document.AddForm)) {
    return;
  }

  if (checkTheatreAvailability(document.AddForm.opses013,
                               document.AddForm.opses001.value,
                               document.AddForm.opses002.value,
                               document.AddForm.opses007.value)) {
    AssignAddForm();
    SubmitHidden(AddForm);
  }
}

</script>
