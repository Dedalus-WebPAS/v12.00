<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="hea">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript" src="../js/oprweb06.js"> </script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link
//  1 - Staff
//  2 - Name
//  3 - Start Time
//  4 - End Time
//  5 - Supervisor/Level
//---------------------------------------------------------------------------
function InitTable(TableView) {
    switch (TableView) {
      case 0: {
       document.title="Staff Members"
       t = new Table(1,0,2,"100%","center",25,30);
       t.addColumn("Staff","String",6,6,"left","MaintenanceIcon.gif","0",160)
       t.addColumn("Name","String",2,2,"left","","",150)
       t.addColumn("Count","String",7,7,"left","","",40)
       t.addColumn("Start Time","String",3,3,"left","","",80)
       t.addColumn("End Time","String",4,4,"left","DateTimeStamp.gif","8",80)
       AddTableRows();
       TableOutput(0,2);    // Order Column,Asc Dsc
       break; }
    }
}
// Add Team
function AddTeam() {
   if(document.UpdateForm.teamnumb.length==9){
      alert("Cannot add more than 9 Teams");
      return;  
    }
    if(!confirm("Are you sure you want to add a new team?")) {
      return;
    }
    if(!validateMandatory(document.UpdateForm)) {
      return;
    }
    document.UpdateForm.teamnumb.className=""
    document.UpdateForm.teamnumb.value=""; 
    document.UpdateForm.updatety.value="A";
    formSubmit();
} 
// Update Team
function UpdateTeam() {

   if (document.UpdateForm.ovrnight.checked == true) 
     document.UpdateForm.opsrg071.value = "1";
   if(!isWhitespace(document.UpdateForm.opsrg006.value) &&
       isWhitespace(document.UpdateForm.opsrg004.value)) {
     alert("Warning: Dressing Time must be entered before recovery");
   }      
   if (document.UpdateForm.ptcnpros.value == 1) {
     document.UpdateForm.opdea043.value=document.UpdateForm.d_opdea043.value;
 }

   if (!checkVisitDatesTimes()) {return;}

   document.UpdateForm.updatety.value="U";
   formSubmit();
}

// Delete Team
function DeleteTeam() {
   if(!CheckTeamNumber())
        return;
   if(confirm("Are you sure you want to delete")) {
       document.UpdateForm.updatety.value="D";
       formSubmit();
    }
}
// Avoid deletion of First Team
function CheckTeamNumber(){
   if(document.UpdateForm.teamnumb.selectedIndex==0){
      alert("Cannot delete first Team");
      return false; 
   }
   index=document.UpdateForm.teamnumb.selectedIndex;
   SelectedValue=document.UpdateForm.teamnumb.options[index].value; 
   if(SelectedValue!=document.UpdateForm.teamnumb.length){
      message="Can delete only highest Team number which is "+
              document.UpdateForm.teamnumb.length+" in this case";
      alert( message);
      return false;
   } 
   return true;
}
// Refresh Page
function RefreshPage() {
   if (document.UpdateForm.d_opsrg074.checked == true)
     document.UpdateForm.opsrg074.value = "1";

   document.UpdateForm.method="get"
   document.UpdateForm.updatety.value="";
   if(document.UpdateForm.d_opsrg074.checked == true){
      document.UpdateForm.opsrg074.value = "1";
      document.UpdateForm.opsrg005.value="";
      document.UpdateForm.opsrg006.value="";
      document.UpdateForm.opsrg060.selectedIndex=0;
      document.UpdateForm.opsrg005.disabled=false;
      document.UpdateForm.opsrg006.disabled=false;
      document.UpdateForm.opsrg060.disabled=false;
   }
   document.UpdateForm.submit();
}
// Link To Add Staff
function goToStaff() {
    if (document.UpdateForm.ovrnight.checked == true) 
      document.UpdateForm.opsrg071.value = "1";
    temp=document.UpdateForm.teamnumb.value;
    supr=document.UpdateForm.suprlevl.value;
    linkurl="oprweb06.pbl?reportno=1&template=2&casekeys="+
    document.UpdateForm.casekeys.value+"&teamnumb="+temp+"&suprlevl="+supr;
    Left=(document.body.clientWidth-750)/2
    DFrameLink(linkurl,100,Left,750,350)
}
//  Update Staff End Time and Date
function UpdateEndTime(linkkeys) {
   casekey=document.UpdateForm.casekeys.value.substr(0,26);
   casekey=casekey.replace(/ /g,"+");
   uniqkey=document.UpdateForm.uniqueky.value
   uniqkey=uniqkey.replace(/ /g,"+");
   document.UpdateForm.redirect.value="oprweb06.pbl?reportno=1&template=001&"+
                             "uniqueky="+uniqkey;
   document.UpdateForm.opdunqid.value=linkkeys;
   document.UpdateForm.nextpage.value=1;
   document.UpdateForm.updatety.value="E";
   formSubmit();
}
// Link to Update Staff
function UpdateLink(scasekey,staftype,stafcode,stardate,startime) {
   temp=document.UpdateForm.teamnumb.value;
   supr=document.UpdateForm.suprlevl.value;
   linkurl="oprweb06.pbl?reportno=1&template=3&casekeys="+
   scasekey+"&teamnumb="+temp+"&optsm001="+
   staftype+"&optsm002="+stafcode+"&optsm003="+
   stardate+"&optsm004="+startime+
   "&suprlevl="+supr;
   Left=(document.body.clientWidth-750)/2
   DFrameLink(linkurl,100,Left,750,350)
}
// Form Submit
function formSubmit() {
   if(validateMandatory(document.UpdateForm)) {
      casekey=document.UpdateForm.casekeys.value.substr(0,26);
      casekey=casekey.replace(/ /g,"+");
      uniqkey=document.UpdateForm.uniqueky.value
      uniqkey=uniqkey.replace(/ /g,"+");
      if(document.UpdateForm.suprlevl.value=="S") {
      document.UpdateForm.redirect.value="oprweb01.pbl?reportno=4&template=013&"+
                                 "casekeys="+casekey; }
      else {
      document.UpdateForm.redirect.value="oprweb06.pbl?reportno=1&template=001&"+
                                 "uniqueky="+uniqkey+"&teamnumb="; }
      if(document.UpdateForm.d_opsrg074.checked == true){
         document.UpdateForm.opsrg074.value = "1";
         document.UpdateForm.opsrg005.value="";
         document.UpdateForm.opsrg006.value="";
         document.UpdateForm.opsrg060.selectedIndex=0;
         document.UpdateForm.opsrg005.disabled=false;
         document.UpdateForm.opsrg006.disabled=false;
         document.UpdateForm.opsrg060.disabled=false;
      }
      document.UpdateForm.submit();
    }
}
// Set Team no.
function set(){
 PatientLinks.teamnumb.value=document.UpdateForm.teamnumb.value;
}
// Validate Surgical Time
function ChkPrep() {
if(isWhitespace(document.UpdateForm.opsrg003.value)) {
   alert("Prep Time missing. Please enter it now");
   document.UpdateForm.opsrg003.focus();
   return;
  }
 ChkDelaySurg();
}
function ChkDelaySurg() {
  catTVtitleDIV.style.display = "none";
  catTVfieldDIV.style.display = "none";

  if(!isWhitespace(document.UpdateForm.opsrg005.value)) {
    var prepTime = trim(document.UpdateForm.opsrg003.value.replace(/:/g,""))
    var surgStrt = trim(document.UpdateForm.opsrg005.value.replace(/:/g,""))
    prepTime=prepTime.substr(0,4)
    surgStrt=surgStrt.substr(0,4)
    prepTime=prepTime - 0;
    surgStrt=surgStrt - 0;
    if(prepTime > surgStrt) {
      if(!confirm("Surgery Start Time cannot be less than Prep Time" +
         "\n Do you want to override")) {
         document.UpdateForm.opsrg005.value="";
         document.UpdateForm.opsrg005.focus();
         return;
      }
    }
  }
  var anastime = trim(document.UpdateForm.anaestim.value.replace(/:/g,""));
  anastime=anastime.substr(0,4)
  anastime=anastime - 0;

  if (parseInt(document.getElementById('opcnacss').value) == 0) {
    catTVtitleDIV.style.display = "none";
    catTVfieldDIV.style.display = "none";
    document.UpdateForm.opsrg007.selectedIndex=0; 
  } else {
    var MaxDelay=(parseInt(anastime) + 
                  parseInt(document.getElementById('opcnacss').value))
    var Minutes=parseInt(MaxDelay) % 100
    var Hour=parseInt(MaxDelay) / 100
    if (Minutes>=60) {
       Minutes=Minutes - 60
       Hour=parseInt(Hour) + 1
       MaxDelay = (Hour*100) + Minutes
    }
    if (MaxDelay <= surgStrt) {
       catTVtitleDIV.style.display = "";
       catTVfieldDIV.style.display = "";
       document.UpdateForm.opsrg007.className="Mandatory"
    } else {
       catTVtitleDIV.style.display = "none";
       catTVfieldDIV.style.display = "none";
       document.UpdateForm.opsrg007.selectedIndex=0;
       document.UpdateForm.opsrg007.className=""
    }
  }
}
function ManInfection() {
if(!isWhitespace(document.UpdateForm.opsrg005.value)) {
// Bug SV46
  document.UpdateForm.opsrg060.className="Mandatory";
 }
}
function ChkStart() {
if(isWhitespace(document.UpdateForm.opsrg005.value)) {
   alert("Start Time missing. Please enter it now");
   document.UpdateForm.opsrg005.focus();
   return;
  }
if(!isWhitespace(document.UpdateForm.opsrg006.value)) {
  surgStrt = trim(document.UpdateForm.opsrg005.value.replace(/:/g,""))
  surgEnd  = trim(document.UpdateForm.opsrg006.value.replace(/:/g,""))
  if(surgStrt < surgEnd) {
    CheckFutureTime(document.UpdateForm,document.UpdateForm.opsedate.value,document.UpdateForm.opsrg006);
  }
  if(surgStrt > surgEnd) {
    if(confirm("Is Surgery End the day after Surgery Start Time?" +
       "\nClick OK=Yes, Cancel=No")){
     document.UpdateForm.dateflag.value="1";
     document.UpdateForm.ovrnight.checked=true;
     }
    else {
        CheckFutureTime(document.UpdateForm,document.UpdateForm.opsedate.value,document.UpdateForm.opsrg006);
          document.UpdateForm.dateflag.value="0";
          document.UpdateForm.opsrg006.focus();
        }
     }
  }
}
function ChkEnd() {
  if (isWhitespace(document.UpdateForm.opsrg006.value)) {
    alert("End Time missing. Please enter it now"); 
    document.UpdateForm.opsrg006.focus();
    return;
  }
  valPrepDress();
} 
// Help for Infection Control
function AlertICC() {
alert("A  DIRTY\n" +
      "    Operations in which a perforated viscus or\n" + 
      "    pus is found\n" +
      "B  CONTAMINATED\n" +
      "    Operations breaching the G.I.T, R.T. and\n" +
      "    G./U.T. or in which a major break in aseptic\n" +
      "    technique occurs, and traumatic wounds\n" +
      "C  CLEAN\n" +
      "    All other operations where the criteria set out\n" +
      "    in A and B do not apply");
}
// Validate Prep Time > Anasthetic Time
function ChkAnas() {
  if (!isWhitespace(document.UpdateForm.opsrg003.value)) {
    var anastime=trim(document.UpdateForm.anaestim.value.replace(/:/g,""));
    var prepstrt=trim(document.UpdateForm.opsrg003.value.replace(/:/g,""));
    if (anastime > prepstrt) {
      if(!confirm("Prep Start Time should be after Anaesthetic time " +
                document.UpdateForm.anaestim.value + "\n Do you want to override")) {
        document.UpdateForm.opsrg003.value=""
        document.UpdateForm.opsrg003.focus();
        return;
      }
    }
    valPrepDress();
  }
}
// Change Theatre
function ChgOpr() {
linkurl="oprweb01.pbl?reportno=4&template=014&casekeys="
         +document.UpdateForm.casekeys.value; 
  Left=(document.body.clientWidth-350)/2
  DFrameLink(linkurl,100,Left,350,180)
 }
// Procedure Description to be made Mandatory
function ProcMan() {
if(!isWhitespace(document.UpdateForm.opsrg004.value)) { 
   document.UpdateForm.opdea014.className="Mandatory";
 }
if(!isWhitespace(document.UpdateForm.opsrg005.value)) {
//  Bug SV46
   document.UpdateForm.opsrg060.className="Mandatory";
 }
}

// Validate 'Prep Start' and 'Dressing' Times
function valPrepDress() {
  var prepTime = trim(document.UpdateForm.opsrg003.value.replace(/:/g,""));
  var dressTime = trim(document.UpdateForm.opsrg004.value.replace(/:/g,""));
  if (isWhitespace(dressTime) || isWhitespace(prepTime)) 
    return;

  if ((dressTime < prepTime) && (document.UpdateForm.ovrnight.checked != true)) {
    if(confirm("Is Time Dressing the day after Prep Start time?" +
       "\nClick OK=Yes, Cancel=No"))
      document.UpdateForm.ovrnight.checked=true;
    else 
      document.UpdateForm.opsrg004.focus();
  }

  if ((dressTime >= prepTime) && (document.UpdateForm.ovrnight.checked == true)) {
    if(!confirm("Warning: The Overnight Indicator is set - Time difference " +
       "between\nPrep Start time and Time Dressing is greater than 24 hours!"))
      FocusDelay(document.UpdateForm.ovrnight);
  }
}
function ChkBirth() {
 if (document.UpdateForm.oldtbrth.value != "1") {
  if (document.UpdateForm.theabrth.checked == true) {
    caseKeys=document.UpdateForm.casekeys.value.replace(/ /g,"+");
    Admnumb=PatientLinks.admissno.value.replace(/ /g,"+");
    SetCookie("birthCookie",
         "oprweb06.pbl?reportno=18&template=001&casekeys="+
         caseKeys + "&admissno="+Admnumb);
  }
 }
}
function GetBirth() {
 if (GetCookieData("birthCookie") != "unknown") {
   document.UpdateForm.brthcook.value=GetCookieData("birthCookie");
   ExpireCookiePath("birthCookie");

  caseKeys=document.UpdateForm.casekeys.value.replace(/ /g,"+");
  Admnumb=PatientLinks.admissno.value;
  linkurl="oprweb06.pbl?reportno=18&template=001&casekeys="+caseKeys+
          "&admissno="+Admnumb;
  Left=(document.body.clientWidth-1000)/2
  DFrameLink(linkurl,100,Left,1000,500)
 }
}

function ToggleCA(){

  dU = document.UpdateForm;

  if(dU.d_opsrg074.checked){
     dU.opsrg005.disabled=true;
     dU.opsrg005.className = "Readonly";
     dU.opsrg006.disabled=true;
     dU.opsrg006.className = "Readonly";
     dU.opsrg060.disabled=true;
     dU.opsrg060.className = "Readonly";
  }
  else{
     dU.opsrg005.disabled=false;
     dU.opsrg005.className = "";
     dU.opsrg006.disabled=false;
     dU.opsrg006.className = "";
     dU.opsrg060.disabled=false;
     dU.opsrg060.className = "";
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);set();ProcMan();LoadDefTeam();GetBirth();ChkDelaySurg();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OPRWEB06.01.003";
PatientVIS="%OPRWEB06.01.081";
PatientNAM="%OPRWEB06.01.002";
PatientSTA="%OPRWEB06.01.086.078";
PatientALT="%OPRWEB06.01.084";
PatientSEX="%OPRWEB06.01.019";
PatientDOB="%OPRWEB06.01.020";
PatientAGE="%OPRWEB06.01.021";
PatientLOC="%OPRWEB06.01.083";
PatientPRI="%OPRWEB06.01.086.066.1";
PatientUNT="%OPRWEB06.01.066.0";
DoctorCOD="%OPRWEB06.01.082.003";
DoctorNAM="%OPRWEB06.01.082.002";
PatientAID="%OPRWEB06.01.086.090";
PatientIND="%OPRWEB06.01.086.091";
PatientCUR="%OPRWEB06.01.086.092";
PatientCLC="%OPRWEB06.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OPRWEB06.01.086.094";
PatientCDM="%OPRWEB06.01.086.095";
PatientVDH="%OPRWEB06.01.086.099.015";
InsertPatientHeader()
</script>
<div id="PatientMenu"></div>

<div id="TheatreCaseHeading"></div>
<script type="text/javascript">
TheatreHeading="Theatre Details"
CombinedCMBS="%STANDARD.01.025.113.003.0.1"
InsertTheatreCaseHead()
</script>

<form name=UpdateForm method=post action="oprweb06.pbl">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=updatety value="">
<input type=hidden name=urnumber value='%OPRWEB06.01.003'>
<input type=hidden name=casekeys value="%OPRWEB06.01.101">
<input type=hidden name=uniqueky value='%OPRWEB06.01.110'>
<input type=hidden name=opsedate value='%OPRWEB06.01.402'>
<input type=hidden name=currdate value='%STANDARD.01.013'>
<input type=hidden name=currtime>
<input type=hidden name=recordty value="">
<input type=hidden name=rcounter value="">
<input type=hidden name=redirect value="">
<input type=hidden name=nextpage value=1>
<input type=hidden name=anaestim value="%OPRWEB06.01.542">
<input type=hidden name=dateflag>
<input type=hidden name=suprlevl value="%OPRWEB06.01.313">
<input type=hidden name=surgc001 value="">
<input type=hidden name=opdunqid value="">
<input type=hidden name=opsrg071 value=" ">
<input type=hidden name=opsedtcm id=opsedtcm value="%OPRWEB06.01.483">
<input type=hidden name=brthcook value="">
<input type=hidden name=oldtbrth value="%OPRWEB06.01.350">
<input type=hidden name=ptcnpros value="%STANDARD.01.025.118.115.0.1">
<input type=hidden name=opdea043 value="%OPRWEB06.01.174">
<input type=hidden name=opsrg074>
<input type=hidden name=opsework id=opsework value='%OPRWEB06.01.402'
 title="Session Date">
<input type=hidden name="admndate" id="admndate" value="%OPRWEB06.01.351"
 title="Admission Date">
<input type=hidden name="admntime" id="admntime" value="%OPRWEB06.01.352">
<input type=hidden name="discdate" id="discdate" value="%OPRWEB06.01.353"
 title="Discharge Date">
<input type=hidden name="disctime" id="disctime" value="%OPRWEB06.01.354">
<input type=hidden name="updatmmb" id="updatmmb" value="1">
<input type=hidden name="opcnacss" id="opcnacss" value="%STANDARD.01.025.113.055.0.2">
<input type=hidden name=opard002 value="%OPRWEB06.01.502">

<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr><td class=DataLabel width=6%>Theatre</td>
    <td class=DataField width=12%>%OPRWEB06.01.302</td> 
    <td class=DataLabel width=10%>Date </td>
    <td class=DataField width=14%>%OPRWEB06.01.406 %OPRWEB06.01.402</td>
    <td class=DataLabel width=10%>Unit</td>
    <td class="DataField" width=15%>%OPRWEB06.01.413.0 </td></tr>
<tr><td class=DataLabel>Consultant</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB06.01.404.003")' notab>
    %OPRWEB06.01.404.002 </a></td>
    <td class=DataLabel>Operating Surgeon</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB06.01.311.003")' notab>
    %OPRWEB06.01.311.002 </a></td>
    <td class=DataLabel>Supervisor Level</td>
    <td><select name=optsm007 class=SelectBig notab >
        <option></option>
         %OPRWEB06.01.325.2
        </select></td></tr>
<tr><td class=DataLabel>Anaesthetist</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB06.01.416.003")' notab>
    %OPRWEB06.01.416.002 </a></td></tr>

<tr><td colspan=6>
<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr><td class=DataLabel>Procedure&nbsp;</td>
    <td><input type=text size=116 name=opdea014 maxlength=80 tabindex=1
          title="Procedure Description" value="%OPRWEB06.01.305"></td></tr>
<tr><td class=DataLabel>&nbsp;&nbsp;</td>
    <td><input type=text size=116 name=opdea015 maxlength=80 tabindex=2
     title="Procedure Description" value="%OPRWEB06.01.343"></td></tr> 
<tr><td class=DataLabel>&nbsp;&nbsp;</td>
    <td><input type=text size=116 name=opdea016 maxlength=80 tabindex=3
         title="Procedure Description" value="%OPRWEB06.01.344">
    </td></tr>
</table>
</td></tr>
</table>
<hr>
<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr valign=top><td class=DataLabel>Team No</td>
   <td class=DataField>
   <select name=teamnumb title="Theatre Team" class=Mandatory tabindex=5
    onchange="RefreshPage()">
    %OPRWEB06.01.148
   </select></td>
   <td class=DataLabel>Overnight Indicator</td>
   <td><input type=checkbox name=ovrnight title="Overninght Indicator" tabindex=6
        value="1" onblur="valPrepDress();"></td>
    <td class="DataLabel" >Prep.Soln.</td>
   <td><select name=opsrg050 title="Prep.Soln code1" class=SelectBig tabindex=17>
         <option></option>
         %OPRWEB06.01.250.2
       </select></td></tr>
<tr><td class=DataLabel>Time Out Performed</td>
    <td class=DataField><input type=text name=opard029 size=8 maxlength=10
       title="Anaesthetic/Prep Time" value="%OPRWEB06.01.529" tabindex=10
       onblur="checkTime(this,this.title);">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,UpdateForm.opard029);">
      <img src="../images/TimeLookup.gif" class=Icon
       onclick="TimeLookupFrame(UpdateForm.opard029);"></td>
    <td class=DataLabel>Time Dressing</td>
    <td class=DataField><input type=text name=opsrg004 size=8 maxlength=8
     tabindex=14 value="%OPRWEB06.01.336"
     onblur="checkTime(this,'Time Dressing');ProcMan();
     ChkEnd();CheckFutureTime(UpdateForm,UpdateForm.opsedate.value,UpdateForm.opsrg004);">
    <img src="../images/DateTimeStamp.gif" class=Icon time=UpdateForm.opsrg004>
    <img src="../images/TimeLookup.gif" class=Icon time=UpdateForm.opsrg004>
    </td>
    <td class="DataLabel" >Prep.Soln.</td>
    <td><select name=opsrg051 title="Prep.Soln code2" class=SelectBig
          tabindex=18>
        <option></option>
         %OPRWEB06.01.251.2
        </select></td></tr>
<tr><td class=DataLabel>Prep Start </td>
    <td class=DataField><input type=text name=opsrg003 size=8 maxlength=8
     value="%OPRWEB06.01.335" onblur="checkTime(this,'Prep Start');ChkAnas();
     CheckFutureTime(UpdateForm,UpdateForm.opsedate.value,UpdateForm.opsrg003);"
     tabindex=11>
    <img src="../images/DateTimeStamp.gif" class=Icon time=UpdateForm.opsrg003>
    <img src="../images/TimeLookup.gif" class=Icon time=UpdateForm.opsrg003>
    </td>
    <td class=DataLabel><div id=catTVtitleDIV>%STANDARD.01.035.TV </div></td>
    <td class=DataField>
    <div id=catTVfieldDIV>
    <select name=opsrg007 tabindex=15 title="%STANDARD.01.035.TV ">
    <option></option>
    %OPRWEB06.01.339.2
    </select>
    </div>
    </td>
    <td class="DataLabel" >Prep.Soln.</td>
    <td><select name=opsrg052 title="Prep.Soln code3" class=SelectBig
         tabindex=19>
        <option></option>
         %OPRWEB06.01.252.2
        </select></td></tr>
<tr><td class=DataLabel>Surgery Start</td>
    <td class=DataField>
    <input type=text name=opsrg005 size=8 maxlength=8 tabindex=12
     value="%OPRWEB06.01.337" 
     onblur="checkTime(this,'Surgery Start');ChkPrep();ManInfection();
     CheckFutureTime(UpdateForm,UpdateForm.opsedate.value,UpdateForm.opsrg005);">
    <img src="../images/DateTimeStamp.gif" class=Icon time=UpdateForm.opsrg005>
    <img src="../images/TimeLookup.gif" class=Icon time=UpdateForm.opsrg005>
    </td>
    <td class=DataLabel>Count Correct </td>
    <td class=DataField>
    <select name=opsrg008 title="Count Correct" tabindex=16>
    <option></option>
    <option value=1>No</option>
    <option value=2>Yes</option>
    </select></td>
    <td class="DataLabel">Infection Control Class</td>
    <td><select name=opsrg060 title="Infection Control Class" tabindex=20>
        <option></option>
         %OPRWEB06.01.260.2
        </select>
        <img src="../images/HelpIcon.gif" class=Icon onclick="AlertICC();">
    </td></tr>

<tr><td class=DataLabel>Surgery End</td>
    <td class=DataField>
    <input type=text name=opsrg006 size=8 maxlength=8 tabindex=13
     value="%OPRWEB06.01.338" onblur="checkTime(this,'Surgery End');ChkStart();">
    <img src="../images/DateTimeStamp.gif" class=Icon time=UpdateForm.opsrg006>
    <img src="../images/TimeLookup.gif" class=Icon time=UpdateForm.opsrg006>
    </td>
    <td colspan=2>&nbsp;</td>
    <td class="DataLabel">Blood Loss (mml)</td>
    <td><input type=text size=6 name=opard034 maxlength=6 tabindex=21 min=0 max=999999
         class="Number" title="Blood Loss (mml)" value="%OPRWEB06.01.534">
    </td></tr>

<tr>
   <td class=DataLabel>Case Abandoned</td>
   <td><input type=checkbox name=d_opsrg074 title="Case Abandoned" value="1" onclick="ToggleCA()" tabindex=-1></td>
    <td class=DataLabel>Birth in Theatre</td>
    <td class=DataField><input type=checkbox name=theabrth tabindex=21 title="Birth in Theatre"></td>
</tr>

<tr>
    <td colspan=2>&nbsp;</td>
    <td colspan=2>&nbsp;</td>
    <td class=DataLabel width=13%><div id=ProComp1></div></td>
    <td class=DataField tabindex=14><div id=ProComp2></div></td>
</tr>

<tr><td colspan=4 align=center>
    <input type=button value="Add Staff" class="button" tabindex=30 onclick="goToStaff();">
    <input type=button value="Add Team" class="button" tabindex=31 id="opr06sub1" onclick="tempDisable(this);AddTeam();">
    <input type=button value="Change Theatre" class="Bigbutton" tabindex=32 onclick="ChgOpr();">
    </td>
    <td colspan=4>
    <input type=button value=Update class="button" tabindex=40 id="opr06sub2" 
     onclick="tempDisable(this);CheckDefaultTeamCompleted();ChkBirth();UpdateTeam();">
    <input type=button value=Delete class="button" tabindex=41 onclick="DeleteTeam();">
    <input type=button value=Cancel class="button" tabindex=42 onclick="RefreshPage();">
</td></tr>
</table>
</form>

<div id=TableLocation></div>

<span id=ProsCompDesc style="display:none">
  Prosthetic Input Complete
</span>

<span id=ProsCompField style="display:none">
  <select name=d_opdea043 class="Mandatory" title="Prosthetic Input Complete">
    <option></option>
    <option value="0">No</option>
    <option value="1">Yes</option>
    <option value="2">N/A</option>
  </select>
</span>
<span id=Blank style="display:none">
  <input type=hidden name=opdea043 value="0">
</span>

<script type="text/javascript">
function AddTableRows() {
%OPRWEB06.01.329
CorrectCount="%OPRWEB06.01.340"
UpdateForm.opsrg008.selectedIndex =CorrectCount ; 
}
</script>
<form  name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value='%OPRWEB06.01.003'>
<input type=hidden name=admissno value='%OPRWEB06.01.081'>
<input type=hidden name=MenuType value='%OPRWEB06.01.088'>
<input type=hidden name=casekeys value='%OPRWEB06.01.101'>
<input type=hidden name=sesskeys value='%OPRWEB06.01.102.oprweb01.03.003'>
<input type=hidden name=uniqueky value='%OPRWEB06.01.110'>
<input type=hidden name=teamnumb value='%OPRWEB06.01.334'>
</form>
<script type="text/javascript">
if (document.UpdateForm.suprlevl!=undefined) {
  if (document.ShowActionMenu.sactions!=undefined) {
    if (document.UpdateForm.suprlevl.value=="S") {
      document.ShowActionMenu.sactions.disabled=true;
    }
  }
}

if ("%OPRWEB06.01.271" == "Yes") {
  document.UpdateForm.ovrnight.checked=1;
}
if ("%OPRWEB06.01.350" == "1") {
  document.UpdateForm.theabrth.checked=1;
  document.UpdateForm.theabrth.readOnly=true;
  document.UpdateForm.theabrth.disabled=true;
}

 if (document.UpdateForm.ptcnpros.value == 1) {
   ProComp1.innerHTML = ProsCompDesc.innerHTML;
   ProComp2.innerHTML = ProsCompField.innerHTML;
   for (var i =0 ; i < document.UpdateForm.d_opdea043.length; i++) {
    if (trim(document.UpdateForm.d_opdea043.options[i].value)==
        trim(document.UpdateForm.opdea043.value)){
        document.UpdateForm.d_opdea043.selectedIndex=i } };
 } else {
   ProComp1.innerHTML = Blank.innerHTML;
   ProComp2.innerHTML = "";
 }
if("%OPRWEB06.01.274" == "Yes") {
   document.UpdateForm.d_opsrg074.checked=1;
   ToggleCA();
}
</script>
