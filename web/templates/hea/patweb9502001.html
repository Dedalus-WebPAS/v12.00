<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="hea">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src=../js/TableSort.js>  </script>
<style type="text/css">
  span.ProgressBar {
    color:black;
    background-image:url(../images/ProgressBar.gif);
    height:10px;
    width:200px;
    text-align:center;
  }
</style>
<script type="text/javascript">
function ExportToExcel() {
  var tab_text = '', tab_data = '';

  for (i=0; i < TableLocation.childNodes.length; i++ ) {
    tab_data += TableLocation.childNodes[i].innerHTML;
  }
  tab_data = tab_data.replace(/<a[^>]*>|<\/a>/gi,"");  // removes links
  tab_data = tab_data.replace(/<img[^>]*>/gi,"");      // removes images

  tab_text += '<html xmlns:x="urn:schemas-microsoft-com:office:excel">';
  tab_text += '<head><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet>';
  tab_text += '<x:Name>Hospital Ward List</x:Name>';
  tab_text += '<x:WorksheetOptions><x:Panes></x:Panes></x:WorksheetOptions></x:ExcelWorksheet>';
  tab_text += '</x:ExcelWorksheets></x:ExcelWorkbook></xml></head><body>';
  tab_text += tab_data;
  tab_text += '</body></html>';

  var ua = window.navigator.userAgent;
  var msie = ua.indexOf("MSIE ");

  if (msie > 0) {  // Older IE browsers
    frmExport.document.open("txt/html","replace");
    frmExport.document.write(tab_text);
    frmExport.document.close();
    frmExport.focus();

    sa = frmExport.document.execCommand("SaveAs",true,"Hospital Ward List.xls");
  }
  else if (ua.match(/Trident.*rv\:11\./)) {  // IE11
    if (window.navigator.msSaveBlob) {
      var blob = new Blob([tab_text], {
                   type: "application/csv;charset=utf-8;"
                 });
      navigator.msSaveBlob(blob, 'Hospital Ward List.xls');
    }
    return;
  }
  else {  // Other browsers
    sa = window.open("data:application/vnd.ms-excel," + encodeURIComponent(tab_text));
  }

  return (sa);
}
// Get Cached Result and Trigger background Refresh of Cache
function AJAXRefresh1() {
  theURL = "patweb95.pbl?reportno=2&template=10"
  AJAXRefresh(theURL);
}
function AJAXRefresh(theURL) {
   startDate = new Date();
   startTime = startDate.getTime();
   ProgressBar.innerHTML='Loading Page ....';
   ProgressBar.style.backgroundImage='url(../images/ProgressBar.gif)';
   var xmlHttp = createHttpObject();
   xmlHttp.open("GET", theURL, true);
   xmlHttp.onreadystatechange=function() {
     if (xmlHttp.readyState==4) {
        if (xmlHttp.responseText!="") {
          startDate = new Date();
          endTime = startDate.getTime();
          ServerTime=((endTime-startTime)/1000)
          ProgressBar.style.backgroundImage='url()';
          startDate = new Date();
          endTime = startDate.getTime();
          PageTime=((endTime-startTime)/1000)
          ProgressBar.innerHTML='';
       }
     }
   }
   xmlHttp.send();
}
function BBRefresh(timeOut) {
  if (timeOut == 0) {
     window.setInterval('AJAXRefresh1()',5 * 60 * 1000);
  }
  else {
    window.setInterval('AJAXRefresh1()',timeOut * 60 * 1000);
  }
}
function ModAvailableBed() {
  linkurl="patweb95.pbl?reportno=5&template=001&fromlist=1"
  location.href=linkurl;
} 
function RefreshClicked() {
  linkurl="patweb95.pbl?reportno=2&template=001"
  location.href=linkurl;
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);
              InitTable();
              AJAXRefresh1();
              BBRefresh(%STANDARD.01.025.114.142.0.3);">
<span id=WaitBoxDisplay class=WaitBox style="display:none">
<img class=WaitImage src="../images/wait.gif">
<p>Please Wait ...</p>
</span>
<div id=PageLayer class=DimmedLayer style="display:none"></div>
<script type="text/javascript">  
 ShowWaitScreen();
 setTimeout('HideWaitScreen();',10000);
</script>
<div id=HeadingSection>
<form name=SelectPeriod action=disweb01.pbl method=get style="margin:0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=1>
<input type=hidden name=d_filttype value="%DISWEB01.04.006">
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=ptcnudpd value="%DISWEB01.04.114">
<input type=hidden name=filtexcl value="%DISWEB01.04.007">

<table cellpadding=1 cellspacing=1 border=0 width=100%>
<tr>
  <td class=HeadingCell width=5%>
    <input type=button class="NoAutoFocus button" 
     value="Refresh" name=btnRefr id=btnRefr
     onclick="tempDisable();RefreshClicked();">
  </td>
  <td align=left class=HeadingCell width=10%>
    <span id=ProgressBar class=ProgressBar>  Loading Page...  </span>
  </td>
  <td class=HeadingCell width=65%>
  </td>
  <td class=HeadingCell width=10%>
    <input type=button class=button value="Export to Excel"
     name=btnExcel id=btnExcel
     onclick="ExportToExcel();">
  </td>
  <td class=HeadingCell width=10%>
    <input type=button class=button value="Mod Avail Beds"
     name=btnAvail id=btnAvail
     onclick="ModAvailableBed();">
  </td>
</tr>
</table>
</form>
</div>

<div id=TableLocation align=center></div>
<script type="text/javascript">
function InitTable() {
//
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//
 t = new Table(1,0,1,"100%","center",35,20);
//
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
//
 t.addColumn("Ward","String",1,1,"left","","0",120)
 t.addColumn("Beds on Ward","Number",5,5,"right","","",40)
 t.addColumn("Open","Number",11,11,"right","","",40)
 t.addColumn("Patients","Number",6,6,"right","","",40)
 t.addColumn("On Leave","Number",19,19,"right","","",40)
 t.addColumn("# Outliers","Number",12,12,"right","","",40)
 t.addColumn("Empty","Number",7,7,"right","","",40)
 t.addColumn("Percent","Number",8,8,"right","","",40)
 t.addColumn("Exp Direct Adm","Number",13,13,"right","","",40)
 t.addColumn("Exp Post Op","Number",14,14,"right","","",40)
 t.addColumn("Exp Bed Req In","Number",15,15,"right","","",40)
 t.addColumn("Total Expects","Number",10,10,"right","","",40)
 t.addColumn("Confirmed DC's","Number",16,16,"right","","",40)
 t.addColumn("Tentative DC's","Number",17,17,"right","","",40)
 t.addColumn("Bed Requests Out","Number",18,18,"right","","",40)
//
// Add Rows to Table (Output from Web Server)
//
%PATWEB95.02.015.patweb93.01.032

 if (t.rows.length != 0 ) {
   OrderColumn=0; 
   AscDsc=1;
   lastOrderColumn=OrderColumn;
   TableOutput(OrderColumn,AscDsc);
   HideWaitScreen();
 }
}
</script>

<iframe name=frmExport id=frmExport style="display:none"></iframe>
