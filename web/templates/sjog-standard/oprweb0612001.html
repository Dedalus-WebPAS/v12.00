<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="sjog-standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb06.js"> </script>
<script type="text/javascript">
function validateNurse(code,name) {
  validateCode('17',code,name,document.UpdateForm.gnm);
  SetNurseName(name);
}
function SetNurseName(name) {
  name.value=UpdateForm.gnm.value.replace(/\s*$/g,"") + " " +
             name.value.replace(/\s*$/g,"")
}
function checkReadyToDepartExist()
{
  var opard085 = document.getElementById("opard085");
  var adverseEventDiv = document.getElementById("adverseEventDiv");

  if(opard085.value.replace(/ /g,"").length != 0)
  {
    adverseEventDiv.style.display = "";
  }
}
function setReadyDepartTime(opard085)
{
  SetCurrentDateTime(null,opard085);
  checkReadyToDepartExist();

}
function changeTextForAdverseEvent()
{
 var adverseText = document.getElementById("adverseText");

 if(EventExist.replace(/ /g,"").length != 0 )
 {
    if(EventExist == 1) {
        adverseText.innerHTML = "<b>Would you like to modify the adverse events?</b>";
        return true;
   }else {
        adverseText.innerHTML = "<b>Did an adverse event occur?</b>";
        return false;
   }
 }else {
    adverseText.innerHTML = "<b>Did an adverse event occur?</b>";
    return false;
 }
}

function checkAdverseResponse()
{
 var adverseDropDown = document.getElementById("adverseDropDown");
 var adverseEventDiv = document.getElementById("adverseEventDiv");
 var casekeys = document.getElementById("casekeys");

 var bool = changeTextForAdverseEvent();

 if(adverseDropDown.value == "Yes" && !bool)
 {
   var url = "oprweb06.pbl?reportno=10&template=010";

   url += "&urnumber="+PatientURN;
   url += "&admissno="+PatientVIS;
   url += "&nodressg=1";
   url += "&casekeys="+casekeys.value;

   adverseEventDiv.style.display = "none";
   ShowDetail01(url);
 }
 else if(adverseDropDown.value == "Yes" && bool)
 {
   var url = "oprweb06.pbl?reportno=10&template=011";

   url += "&urnumber="+PatientURN;
   url += "&admissno="+PatientVIS;
   url += "&nodressg=1";
   url += "&casekeys="+casekeys.value;

   adverseEventDiv.style.display = "none";

   ShowDetail01(url);
 }
 else
 {
   adverseEventDiv.style.display = "none";
 }

}

function ShowDetail01(linkurl)
{
  Left=(document.body.clientWidth-900)/2
  var frame = document.getElementById("PopUpFrame");
  frame.style.overflow = "auto";
  frame.style.height = 700 +"px";

  DFrameLink(linkurl,0,Left,900,700)
}



function warnProcDesc(){
  if(!isWhitespace(document.UpdateForm.opsrg006.value)){
    alert("Has the procedure description been updated?");
    UpdateForm.opdea014.className="Mandatory";
  } else {
    UpdateForm.opdea014.className="";
  }
}
function warnProcDescLoad(){
  if(!isWhitespace(document.UpdateForm.opsrg006.value)){
    UpdateForm.opdea014.className="Mandatory";
  } else {
    UpdateForm.opdea014.className="";
  }
}

function chkTime(field){
  if(isWhitespace(field.value))
    return;

  if(document.UpdateForm.d_opsrg074.checked==true)
    return;

  endTime=UpdateForm.opsrg006.value.replace(/:/g,"");
  if(isWhitespace(endTime)){
     alert("Surgery End Time must be entered first");
     field.value=""
     return;
  }
  OperDate=document.UpdateForm.casekeys.value.substring(3,11);
  if(document.UpdateForm.currdate.value > OperDate) {
    return;
  }
  if(field.value.replace(/:/g,"")<=endTime){
    if(!confirm(""+field.title+" must be after Surgery End." +
                "\n Do you want to override")) {
      field.value="";
    }
  }
}

function ChgSurgeon() {
  if (UpdateDayProc()) {
    SetCookie("DayProcPopup","4","15");
  }
}

function showChgSur() {
  caseKeys=UpdateForm.casekeys.value.replace(/ /g,"+");
  teamNumb=UpdateForm.teamnumb.value;
  linkurl="oprweb06.pbl?reportno=12&template=005&casekeys="+caseKeys+
          "&teamnumb="+teamNumb;
  Left=(document.body.clientWidth-750)/2
  DFrameLink(linkurl,100,Left,750,350)
}

// Change Theatre
function ChgOpr() {
  if (UpdateDayProc()) {
    SetCookie("DayProcPopup","5","15");
  }
}

function showChgOpr() {
  linkurl="oprweb01.pbl?reportno=4&template=014&casekeys="
           +UpdateForm.casekeys.value; 
  Left=(document.body.clientWidth-350)/2
  DFrameLink(linkurl,100,Left,350,180)
}

function AddMBSItem() {
  if (document.UpdateForm.d_opsrg074.checked == false) {
    if(document.UpdateForm.opsrg005.value=="") {
      alert("Surgery Start Time must be entered first.");
      return;
    }
  }
 if(UpdateForm.opcncomb.value=="1") {
    caseKeys=UpdateForm.casekeys.value.replace(/ /g,"+");
    teamNumb=UpdateForm.teamnumb.value;
    UpdateForm.redirect.value="oprweb06.pbl?reportno=03&template=004&casekeys="+
                             caseKeys+"&teamnumb="+teamNumb
    UpdateDayProc();
 } else {
    if (UpdateDayProc()) {
      SetCookie("DayProcPopup","1","15");
    }
 }
}

function BillMBSItems() {
  if(document.UpdateForm.opsrg005.value=="") {
     alert("Surgery Start Time must be entered first.");
     return;
   }

  document.UpdateForm.updatety.value="B";

  if (UpdateForm.ovrnight.checked == true)
    UpdateForm.opsrg071.value = "1";

  if (UpdateForm.d_opsrg074.checked == true)
    UpdateForm.opsrg074.value = "1";

  if (UpdateForm.d_opsrg075.checked == true)
    UpdateForm.opsrg075.value = "1";

  formSubmit();
}

function showMBS() {
  caseKeys=UpdateForm.casekeys.value.replace(/ /g,"+");
  teamNumb=UpdateForm.teamnumb.value;
  Left=(document.body.clientWidth-600)/2
  DFrameLink("oprweb06.pbl?reportno=02&template=002&casekeys="+caseKeys +
             "&teamnumb="+teamNumb,100,Left,600,350);
}

function AddImplant(){
  if (UpdateDayProc()) {
    SetCookie("DayProcPopup","2","15");
  }
}

function showImplant() {
  Left=(document.body.clientWidth-750)/2
  LinkUrl="oprweb06.pbl?reportno=7&template=4&casekeys=" +
           PatientLinks.casekeys.value+"&teamnumb="+
           PatientLinks.teamnumb.value;
  DFrameLink(LinkUrl,100,Left,750,350);
}

function AddExpItem() {
  if (UpdateDayProc()) {
    SetCookie("DayProcPopup","3","15");
  }
}

function showExpItem() {
  Left=(document.body.clientWidth-650)/2
  LinkUrl="oprweb06.pbl?reportno=4&template=2" +
          "&casekeys=" + UpdateForm.casekeys.value.replace(/ /g,"+") +
          "&teamnumb=" + UpdateForm.teamnumb.value.replace(/ /g,"+") ;
  DFrameLink(LinkUrl,100,Left,650,430);
}

function ChkRecovDelay() {
  var timeInRec ="";
  if(!isWhitespace(UpdateForm.opard071.value)) {
    timeInRec = UpdateForm.opard071.value;
  } else if(!isWhitespace(UpdateForm.opard074.value)) { 
    timeInRec = UpdateForm.opard074.value;
  } else {
    timeInRec = UpdateForm.opard077.value;
  }
  var timeThrExit = UpdateForm.opard080.value;
  if ((isWhitespace(timeInRec)) || (isWhitespace(timeThrExit))) {
    UpdateForm.opard084.className="";
    return;
  }

  var recTime = new Date();
  var exitTime = new Date();

  // Set Recovery-Day Time
  recTime.setHours(timeInRec.substr(0,2));
  recTime.setMinutes(timeInRec.substr(3,2));
  recTime.setSeconds(timeInRec.substr(6,2));
  var recTimeSec = recTime.getTime();

  // Set Theatre Exit Time
  exitTime.setHours(timeThrExit.substr(0,2));
  exitTime.setMinutes(timeThrExit.substr(3,2));
  exitTime.setSeconds(timeThrExit.substr(6,2));
  var exitTimeSec = exitTime.getTime();

  // Calculate difference
  var timeDif = exitTimeSec - recTimeSec;
  // If time difference is greater than 6 hours then set 'Recovery Delay 
  // Reason' to be a mandatory field
  if (timeDif > 21600000)              // 6 hours = 21600000 miliseconds
    UpdateForm.opard084.className="Mandatory";
  else
    UpdateForm.opard084.className="";
}
function SetPrinter(SelectList) {
 if (SelectList.className=="SelectBig") {
     SelectList.className="Mandatory SelectBig" }
 else {
     SelectList.className="SelectBig" }
}

// Update Day Procedure Details
function UpdateDayProc() {

   if (!checkVisitDatesTimes()) {return;}

   document.UpdateForm.updatety.value="U";

   // Set Anaesthetic Prep Time to be equal to Anaesthetic Start Time.  
   document.UpdateForm.opard041.value = document.UpdateForm.opard042.value;

   // Set Prep Time to be equal to Surgery Start Time. This is required
   // for calculation of Actual Operation Minutes.
   document.UpdateForm.opsrg003.value = document.UpdateForm.opsrg005.value;

   // Set Dressing Time to be equal to Surgery End Time. This is required
   // for calculation of Actual Operation Minutes.
   document.UpdateForm.opsrg004.value = document.UpdateForm.opsrg006.value;

   // Set Ready To Depart Time to be equal to the Exit Theatre Complex Time.
   //This is needed as opard085 is not displayed on the screen
///   document.UpdateForm.opard085.value = document.UpdateForm.opard080.value;

   if (UpdateForm.ovrnight.checked == true)
     UpdateForm.opsrg071.value = "1";

   if (UpdateForm.d_opsrg074.checked == true)
     UpdateForm.opsrg074.value = "1";

   if (UpdateForm.d_opsrg075.checked == true)
     UpdateForm.opsrg075.value = "1";

// Set flag to only default staff if anaesthetic time exists
   if (isWhitespace(UpdateForm.opard042.value)) {
     UpdateForm.stafflag.value="1";         // don't default
   } else {
     UpdateForm.stafflag.value="2";         // default
   }

   return(formSubmit());

}

function setETTime(extime) {
  document.UpdateForm.opard080.value=extime.value;
  ChgRTD();
}

function ChgRTD() {
  if(!isWhitespace(UpdateForm.opard080.value)) {
    UpdateForm.opard080.className= "Mandatory"
  }
  else {
    UpdateForm.opard080.className=" "
  }
}

// Refresh Page
function RefreshPage() {
   document.UpdateForm.method="get"
   document.UpdateForm.updatety.value="";
   document.UpdateForm.submit();
}
// Link To Staff List
function goToStaff() {
  caseKey=UpdateForm.casekeys.value.replace(/ /g,"+")
  temp=document.UpdateForm.teamnumb.value;
  supr=document.UpdateForm.suprlevl.value;
  UpdateForm.redirect.value="oprweb06.pbl?reportno=12&template=2&casekeys="+
                             caseKey+"&teamnumb="+temp+"&suprlevl="+supr;
  UpdateDayProc();
}

// Form Submit
function formSubmit() {
   if(validateMandatory(UpdateForm)) {
      casekey=UpdateForm.casekeys.value.substr(0,26);
      casekey=casekey.replace(/ /g,"+");
      uniqkey=UpdateForm.uniqueky.value
      uniqkey=uniqkey.replace(/ /g,"+");
      if (isWhitespace(UpdateForm.redirect.value)) {
        UpdateForm.redirect.value="oprweb06.pbl?reportno=12&template=001"+
                                  "&uniqueky="+uniqkey+"&teamnumb="; 
      }
      if(checkTimeOrder())
      {
       document.UpdateForm.submit();
        return true;
      }
    }
    else
      return false;
}
// Set Team no.
function set(){
 PatientLinks.teamnumb.value=UpdateForm.teamnumb.value;
}

// Procedure Description to be made Mandatory
function ProcMan() {
  if(!isWhitespace(UpdateForm.opard077.value) ||
     !isWhitespace(UpdateForm.opard074.value) ||
     !isWhitespace(UpdateForm.opard071.value))  
    UpdateForm.opdea014.className="Mandatory";
  else
    UpdateForm.opdea014.className="";
}

// Validate Prep Start/Surgery Start and Dressing/Surgery End Times
function valPrepDress() {
   if(UpdateForm.ovrnight.checked == true)
    {
      if(!confirm("Warning: Did this case run over midnight?")) {
         UpdateForm.ovrnight.checked = false;
         UpdateForm.ovrnight.focus();
       }
    }

}
function checkTimeOrder()
{

 var arriveTime = UpdateForm.opard002;
 var anseatTime = UpdateForm.opard042;
 var surgStTime = UpdateForm.opsrg005;
 var surgEnTime = UpdateForm.opsrg006;
 var exitThTime = UpdateForm.opard080;
 var recovFrontTime = UpdateForm.opard071;
 var recovBackTime = UpdateForm.opard074;
 var dayRecTime = UpdateForm.opard077;
 var ICUtime = UpdateForm.opard083;

 var arrayObj = new Array();

 arrayObj.push(arriveTime);
 arrayObj.push(anseatTime);
 arrayObj.push(surgStTime);
 arrayObj.push(surgEnTime);

 if (document.UpdateForm.d_opsrg074.checked==false) {

   if(!isWhitespace(recovFrontTime.value) ||
     (isWhitespace(recovBackTime.value) && isWhitespace(dayRecTime.value) &&
      isWhitespace(ICUtime.value))) {
      arrayObj.push(recovFrontTime);
   }
   if(recovBackTime.value != "")
   {
      arrayObj.push(recovBackTime);
   }
   if(dayRecTime.value != "")
   {
      arrayObj.push(dayRecTime);
   }
   if(ICUtime.value != "")
   {
      arrayObj.push(ICUtime);
   }
   arrayObj.push(exitThTime);

 } 

 for(var i = 1; i < arrayObj.length; i++)
 {
   if(arrayObj[i].value != "")
   {
     if(checkTimeEnter(arrayObj[i-1]))
       return false;

     if(UpdateForm.ovrnight.checked != true)
     {
       if(validateGreatestTime(arrayObj[i-1],arrayObj[i]))
          return false;
     }
    }
 }

 return true;

}
function checkTimeEnter(obj)
{
   if(obj.value == 0)
   {
     alert(obj.title+" must be entered first");
     obj.focus();
     obj.select();
     return true;
   }
  return false;
}
function ShowPop() {
  PopScreen=GetCookieData("DayProcPopup");
  if (PopScreen!="unknown") {
     if(PopScreen=="1") {
       showMBS();
     } else if(PopScreen=="2") {
       showImplant();
     } else if(PopScreen=="3") {
       showExpItem();
     } else if(PopScreen=="4") {
       showChgSur();
     } else if(PopScreen=="5") {
       showChgOpr();
     }
  }
  ExpireCookiePath("DayProcPopup")
}

function checkPostProcedure()
{
  var fastPostProcedure = document.getElementById("opsrg072");
  var admitPostProcedure = document.getElementById("opsrg073");
 
  if(fastPostProcedure)
  {
     if(fastPostProcedure.value.replace(/ /g,"") == "Yes")
     {
        (document.getElementById("d_"+fastPostProcedure.id)).checked = true;
        fastPostProcedure.value = 1
     }
     else
     {
        (document.getElementById("d_"+fastPostProcedure.id)).checked = false;
        fastPostProcedure.value = 0;
 
      }
  }

  if(admitPostProcedure)
  {
    if(admitPostProcedure.value.replace(/ /g,"") == "Yes")
    {
        (document.getElementById("d_"+admitPostProcedure.id)).checked = true;
        admitPostProcedure.value = 1;
    }
    else
    {
        (document.getElementById("d_"+admitPostProcedure.id)).checked = false;
        admitPostProcedure.value = 0;
    }
      
  }
}
// Validate Anaesthetic Comm > Anasthetic Time
function ChkTimeout() {
  if (!isWhitespace(UpdateForm.opsrg005.value) ) {
    var timeouttime=trim(UpdateForm.opard029.value.replace(/:/g,""));
    var prepstrt=trim(UpdateForm.opsrg005.value.replace(/:/g,""));
    if (timeouttime>prepstrt) {
      if(!confirm("Time Out time should be before Anaesthetic Comm " +
                UpdateForm.opsrg005.value + "\n Do you want to override")) {
        UpdateForm.opard029.value=""
        UpdateForm.opard029.focus();
        return;
      }
    }
    valPrepDress();
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);UpdateForm.opard002.focus();set(); setStage1();
              warnProcDescLoad();ChkRecovDelay();delayIntoRecovery();ShowPop();
              checkPostProcedure();LoadDefTeam();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OPRWEB06.12.003";
PatientVIS="%OPRWEB06.12.081";
PatientNAM="%OPRWEB06.12.002";
PatientSTA="%OPRWEB06.12.086.078";
PatientALT="%OPRWEB06.12.084";
PatientSEX="%OPRWEB06.12.019";
PatientDOB="%OPRWEB06.12.020";
PatientAGE="%OPRWEB06.12.021";
PatientLOC="%OPRWEB06.12.083";
PatientPRI="%OPRWEB06.12.086.066.1";
PatientUNT="%OPRWEB06.12.066.0";
DoctorCOD="%OPRWEB06.12.082.003";
DoctorNAM="%OPRWEB06.12.082.002";
PatientAID="%OPRWEB06.12.086.090";
PatientIND="%OPRWEB06.12.086.091";
PatientCUR="%OPRWEB06.12.086.092";
PatientCLC="%OPRWEB06.12.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OPRWEB06.12.086.094";
PatientCDM="%OPRWEB06.12.086.095";
PatientVDH="%OPRWEB06.12.086.099.015";

EventExist="%OPRWEB06.12.543";

InsertPatientHeader()
</script>
<div id="PatientMenu"></div>

<div id=PageBodySection>
<form name=UpdateForm method=post action="oprweb06.pbl" style="margin:0"
 autocomplete="off">
<input type=hidden name=reportno value=12>
<input type=hidden name=template value=1>
<input type=hidden name=updatety value="">
<input type=hidden name=urnumber value='%OPRWEB06.12.003'>
<input type=hidden name=casekeys id=casekeys value="%OPRWEB06.12.101">
<input type=hidden name=uniqueky value='%OPRWEB06.12.110'>
<input type=hidden name=redirect value="">
<input type=hidden name=nextpage value=1>
<input type=hidden name=gnm>
<input type=hidden name=nodressg value=1>
<input type=hidden name=suprlevl value="%OPRWEB06.12.313">
<input type=hidden name=opdunqid value="">
<input type=hidden name=teamnumb value="%OPRWEB06.12.334">
<input type=hidden name=currdate value="%STANDARD.01.013">
<input type=hidden name=opard041>
<input type=hidden name=opsrg003>
<input type=hidden name=opsrg004>
<input type=hidden name=opsrg071 value=" ">
<input type=hidden name=opcncomb value="%STANDARD.01.025.113.003.0.1">
<input type=hidden name=opsrg074 value=" ">
<input type=hidden name=opsrg075 value=" ">
<input type=hidden name=stafflag value=" ">
<input type=hidden name=opsedtcm id=opsedtcm value="%OPRWEB06.12.483">
<input type=hidden name=opsework id=opsework value='%OPRWEB06.12.402'
 title="Session Date">
<input type=hidden name="admndate" id="admndate" value="%OPRWEB06.12.351"
 title="Admission Date">
<input type=hidden name="admntime" id="admntime" value="%OPRWEB06.12.352">
<input type=hidden name="discdate" id="discdate" value="%OPRWEB06.12.353"
 title="Discharge Date">
<input type=hidden name="disctime" id="disctime" value="%OPRWEB06.12.354">

<table border="0" cellpadding="0" cellspacing="0" width="100%" align=center>
<tr><td class=HeadingCell align=left>
    <img src=../images/ListIcon.gif class=Icon onclick='SessCaseList();'></td>
    <td align=center class=HeadingCell width=85%>Day Procedures</td>
    <td align=right class=HeadingCell><font color=red>
     %OPRWEB06.12.208</font></td></tr>

</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%" align=center>
<tr><td class=DataLabel>Consultant</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB06.12.404.003")'>
    %OPRWEB06.12.404.002 </a></td>
    <td class=DataLabel>Operating Surgeon</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB06.12.311.003")'>
    %OPRWEB06.12.311.002 </a></td>
    <td class=DataField>
    <input type=button value="Change Surgeon" class="Bigbutton"
     onclick="showChgSur();"></td>
</tr>

<tr><td class=DataLabel>Unit</td>
    <td class="DataField">
       <select name=opses012 title="Unit" class=SelectBig>
        <option></option>
         %OPRWEB06.12.413.2
        </select></td>
    <td class=DataLabel>Theatre</td>
    <td class=DataField>%OPRWEB06.12.302</td>
    <td class=DataField>
       <input type=button value="Change Theatre" class="Bigbutton" 
        onclick="ChgOpr();"></td></tr> 

<tr><td class=DataLabel>Date </td>
    <td class=DataField>%OPRWEB06.12.406 %OPRWEB06.12.402</td>
    <td class=DataLabel>Time </td>
    <td class=DataField>%OPRWEB06.12.403</td></tr>
</table>

<hr>

<table border="0" cellpadding="0" cellspacing="0" width="100%" align=center>
<tr><td class=DataLabel>Procedure&nbsp;</td>
    <td> <input type=text size=116 name=opdea014 maxlength=80
          title="Procedure Description" value="%OPRWEB06.12.305"></td></tr>
<tr><td class=DataLabel>&nbsp;&nbsp;</td>
    <td> <input type=text size=116 name=opdea015 maxlength=80
     title="Procedure Description" value="%OPRWEB06.12.343"></td></tr> 
<tr><td class=DataLabel>&nbsp;&nbsp;</td>
    <td> <input type=text size=116 name=opdea016 maxlength=80
         title="Procedure Description" value="%OPRWEB06.12.344">
    </td></tr>
</table>

<br>
<table border="0" cellpadding="0" cellspacing="0" width="100%" align=center>

<tr><td class=DataLabel title='Time of patient "sign in" (when pt. arrives in Operating Suite)'>
      Time Arrived</td>
    <td class=DataField>
      <input type=text name=opard002 id=opard002 size=8 maxlength=8
       title="Time Arrived" value="%OPRWEB06.12.502" tabindex=1
       onblur="checkTime(this,this.title);">
      <img src="../images/DateTimeStamp.gif" class=Icon 
        onclick="SetCurrentDateTime(null,opard002);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opard002);"></td>

    <td class=DataLabel>Admitting Nurse</td>
    <td class=DataField>
      <input type=text name=opard003 id=opard003 title="Admitting Nurse Code" 
       size=6 class=DataField  maxlength=6 value="%OPRWEB06.12.503.1" tabindex=-1
       onblur="validateNurse(opard003,name_opard003);">
      <input type=text name=name_opard003 id=name_opard003 title="Admitting Nurse" 
       tabindex=-1 class=ReadOnly readonly size=20 maxlength=30 
       value="%OPRWEB06.12.503.0">
      <img src="../images/SearchIcon.gif" class=Icon
       onclick="NurseSearchFrame(opard003,name_opard003);"></td>

    <td class=DataLabel>MBS Items</td>
    <td><input type=text size=15 class=Readonly readonly name=mbsitem id=mbsitem
         tabindex=-1 value="%OPRWEB06.12.202">
        <input type=button name="mbsbill" id="mbsbill" value="BILL" disabled
         color=red tabindex=-1 onclick="BillMBSItems();"> 
        </td>
    <td><input class="button" type=button name="mbsbutton" value="Add MBS"
         tabindex=-1 onclick="AddMBSItem();">
    </td></tr>

<tr><td class=DataLabel title='Time uninterupted attention by anaesthetist commences, or in the absence of an aneasthetist,
when the monitoring nurse begins to attach ECG, NIBP or other monitoring equipment eg. CVIL or endoscopy'>
    Anaesthetic Comm</td>
    <td class=DataField>
      <input type=text name=opard042 id=opard042 size=8 maxlength=8
       title="Anaesthetic Comm" value="%OPRWEB06.12.542" tabindex=2 
       onblur="checkTime(this,this.title);">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,opard042);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opard042);"></td>

    <td class=DataLabel>Anaesthetic</td>
    <td class=DataField>
      <select name=opdea003 title="Anaesthetic" tabindex=-1>
        <option></option>
         %OPRWEB06.12.113.2
      </select></td>

    <td class=DataLabel>Implant Items</td>
    <td><input type=text size=15 readonly tabindex=-1 class=Readonly 
         value=%OPRWEB06.12.204></td>
    <td><input class="button" type=button name="impbutton" value="Add Implant"
         tabindex=-1 onclick="AddImplant();">
    </td></tr>
<tr><td class=DataLabel title='Time "Time out" procedure commences'>
     Time Out Performed</td>
    <td class=DataField><input type=text name=opard029 id=opard029 size=8 
       maxlength=8 title="Time Out Performed" value="%OPRWEB06.12.529" tabindex=3
       onblur="checkTime(this,this.title);ChkTimeout();">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,opard029);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opard029);"></td>

    <td class=DataLabel>Did this case run over midnight?</td>
  <td><input type=checkbox name=ovrnight id=ovrnight 
        title="Did this case run over midnight"
        tabindex=-1 value="1" onblur="valPrepDress();"></td>

    <td class=DataLabel>Expensive Items</td>
    <td><input type=text size=15 readonly tabindex=-1 class=Readonly
         value=%OPRWEB06.12.206></td>
    <td><input class="button" type=button name="expbutton" value="Add Exp Item" 
         tabindex=-1 onclick="AddExpItem();">
    </td></tr>

<tr><td class=DataLabel title='Earliest time of pt. positioning, skin prep or draping'>
    Surgery Start</td>
    <td class=DataField>
      <input type=text name=opsrg005 id=opsrg005 size=8 maxlength=8
       title="Surgery Start" value="%OPRWEB06.12.337" tabindex=10
       onblur="checkTime(this,this.title);">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,opsrg005);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opsrg005);"></td>
    <td class=DataLabel title='Arrival time in Recovery/PACU or DPU.
(If>15 minute delay between this and "Surgery End" 
field a drop-down box for "reason for delay" to activate* - mandatory completion in this case). 
If pt went directly to ICU from OR this field is not required.'>
    Time in Recovery - Stage 1</td>
    <td class=DataField>
      <input type=text name=opard071 id=opard071 size=8 maxlength=8 tabindex=35
       title="Time in Recovery - Stage 1" value="%OPRWEB06.12.571"
       onblur="checkTime(this,this.title);chkTime(this);
               ChkRecovDelay();delayIntoRecovery();">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,opard071);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(opard071);"></td>

  <td class=DataLabel title='Time patient left OR Suite for transfer to ICU
(this field may be activated direct from either OR, recovery/PACU or DPU screens)'>
    Time to ICU/CCU</td>
    <td class=DataField>
      <input type=text name=opard083 id=opard083 size=8 maxlength=8 tabindex=-1
       title="Time to ICU/CCU" value="%OPRWEB06.12.583" 
       onblur="checkTime(this,this.title);chkTime(this);setETTime(this);">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,opard083);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(opard083);"></td>

    <td><input class="button" type=button value="Staff Members"
         tabindex=-1 onclick="goToStaff();">
    </td></tr>
    <tr><td></td><td></td>
    <td id=ov_label style="display:none" class=DataLabel>
        %STANDARD.01.017.ov</td>
      <td class=DataField id=ov_data style="display:none">
      <select name=opard087 id=opard087 title="%STANDARD.01.017.ov">
        <option></option>
         %OPRWEB06.12.587.2
      </select></td></tr>

<tr><td class=DataLabel 
    title='Latest time of suturing, dressing or plastering complete'>
    Surgery End</td>
    <td class=DataField>
      <input type=text name=opsrg006 id=opsrg006 size=8 maxlength=8
       title="Surgery End" value="%OPRWEB06.12.338" tabindex=20
       onblur="checkTime(this,this.title);warnProcDesc();">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,opsrg006);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opsrg006);"></td>
    <td class=DataLabel title='Time of arrival in Stage 2 recovery, if applicable'>
    Time in Recovery - Stage 2</td>
    <td class=DataField>
      <input type=text name=opard074 id=opard074 size=8 maxlength=8 tabindex=40
       title="Time in Recovery - Stage 2" value="%OPRWEB06.12.574"
       onblur="checkTime(this,this.title);chkTime(this);
               ChkRecovDelay();delayIntoRecovery();">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,opard074);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(opard074);"></td>

    <td class=DataLabel title='Time patient died'>Time Patient Died</td>
    <td class=DataField>
      <input type=text name=opard082 id=opard082 size=8 maxlength=8  tabindex=-1
       title="Time Patient Died" value="%OPRWEB06.12.582" 
       onblur="checkTime(this,this.title);">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,opard082);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(opard082);"></td>

    <td>&nbsp;</td></tr>

<tr><td class=DataLabel title='Time patient departs the Operating/Procedure Room'>
    Pt Departure - Operating Room</td>
    <td class=DataField>
      <input type=text name=opard104 id=opard104 size=8 maxlength=8 tabindex=21
       title="Pt Departure - Operating Room" value="%OPRWEB06.12.599.004"
       onblur="checkTime(this,this.title);delayIntoRecovery();">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,opard104);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opard104);"></td>
    <td class=DataLabel title='Time of arrival in Stage 3 recovery, if applicable'>
    Time in Recovery - Stage 3</td>
    <td class=DataField>
      <input type=text name=opard077 id=opard077 size=8 maxlength=8 tabindex=40
       title="Time in Recovery - Stage 3" value="%OPRWEB06.12.577"
       onblur="checkTime(this,this.title);chkTime(this);
               ChkRecovDelay();">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,opard077);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(opard077);"></td>
    <td class=DataLabel>Reason for Overnight</td>
    <td class=DataField>
      <select name=opard086 id=opard086 title="Reason for Overnight">
        <option></option>
         %OPRWEB06.12.586.2
      </select></td>
    <td>&nbsp;</td></tr>
<tr><td class=DataLabel>Straight to DPU</td>
    <td><input type=checkbox name=d_opsrg075 id=d_opsrg075 
         title="Straight to DPU" value="1" onclick=setStage1();></td>
    <td class=DataLabel 
title='Time the patient is ready to return to the ward or DPU from recovery/DPU'>
    Ready to Depart</td>
    <td class=DataField>
    <input type=text name=opard085 id=opard085 size=8 title="Ready to Depart"
     value='%OPRWEB06.12.585' tabindex=41
     onblur="checkTime(this,this.title);chkTime(this);ChgRTD();"
     onchange="checkReadyToDepartExist();">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="setReadyDepartTime(opard085);">
    <img src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(opard085);">
 </td>

    <td class="DataLabel">Fast Post Procedure</td>
    <td class="DataField">
    <input type="hidden"
           name="opsrg072"
           id="opsrg072"
           class="CheckBox"
           value="%OPRWEB06.12.672" />
    </td>
</tr>


<tr><td class=DataLabel title='Time patient exits Recovery/PACU'>
    Exit Theatre Complex/DPU</td>
    <td class=DataField>
      <input type=text name=opard080 id=opard080 size=8 maxlength=8 tabindex=50
       title="Exit Theatre Complex/DPU" value="%OPRWEB06.12.580"
       onblur="checkTime(this,this.title);chkTime(this);ChkRecovDelay();
               ChgRTD();">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,opard080);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(opard080);"></td>
    <td class=DataLabel>Nurse Attend Pat 1</td>
    <td class=DataField>
      <input type=text name=opard078 id=opard078 size=6 value="%OPRWEB06.12.578.1"
       title="Nurse Attend Pa1 1 - Code" tabindex=-1
       onblur="validateNurse(opard078,name_opard078);">
      <input type=text readonly name=name_opard078 id=name_opard078 class=Readonly 
       size=46 title="Nures Attend Pat 1" tabindex=-1 value="%OPRWEB06.12.578.0">
      <img src="../images/SearchIcon.gif" class=Icon
       onclick="NurseSearchFrame(opard078,name_opard078);"></td>
    <td class="DataLabel">Admit Post Procedure</td>
    <td class="DataField">
    <input type="hidden"
           name="opsrg073"
           id="opsrg073"
           class="CheckBox"
           value="%OPRWEB06.12.673" />
    </td>

<tr><td class=DataLabel>Case Abandoned</td>
    <td><input type=checkbox name=d_opsrg074 id=d_opsrg074 title="Case Abandoned"
         value="1"></td>
    <td class=DataLabel>Nurse Attend Pat 2</td>
    <td class=DataField>
      <input type=text name=opard079 id=opard079 size=6 value="%OPRWEB06.12.579.1"
       title="Nurse Attend Pat 2 - Code" tabindex=-1
       onblur="validateNurse(opard079,name_opard079);">
      <input type=text readonly name=name_opard079 id=name_opard079 class=Readonly 
       size=20 title="Nurse Attend Pat 2" tabindex=-1 value="%OPRWEB06.12.579.0">
      <img src="../images/SearchIcon.gif" class=Icon
       onclick="NurseSearchFrame(opard079,name_opard079);"></td>
    <td class=DataLabel>%STANDARD.01.017.Ou</td>
    <td class=DataField >
      <select name=opard084 title="%STANDARD.01.017.Ou">
        <option></option>
         %OPRWEB06.12.584.2
      </select></td></tr>
<tr><td class=DataLabel>Op Registration Form</td>
    <td class=DataField><input type=checkbox name=printreg value="1"
    onclick="SetPrinter(UpdateForm.schdprnt);"></td>
    <td class=DataLabel>Printer</td>
    <td><select name=schdprnt title="Printer" class="SelectBig">
        <option></option>
        %STANDARD.01.001.IBAOPR45.01
        </select>
    </td>
</tr>

<tr><td class=DataLabel>Count Correct </td>
    <td class=DataField>
    <select name=opsrg008 title="Count Correct" >
    <option></option>
    <option value=1>No</option>
    <option value=2>Yes</option>
    </select></td>
</tr>

</table>

<table border="0" cellpadding="0" cellspacing="0" width="100%" align=center>
<tr valign=top><td class=DataLabel>Comments</td>
    <td class=DataField tabindex=-1>
        <div id=CommentText></div> 
    </td>
</tr>

<tr><td colspan=2 align=center><br>
    <input type=button value=Update class="button" tabindex=60 id="opr06sub"
     onclick="tempDisable(this);CheckDefaultTeamCompleted();UpdateDayProc();">
    <input type=button value=Cancel class="button" tabindex=65 
     onclick="RefreshPage();">
</td></tr>
</table>
</form>
</div>

<form  name=PatientLinks method=get>
<input type=hidden name=reportno value=12>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value='%OPRWEB06.12.003'>
<input type=hidden name=admissno value='%OPRWEB06.12.081'>
<input type=hidden name=MenuType value='%OPRWEB06.12.088'>
<input type=hidden name=casekeys value='%OPRWEB06.12.101'>
<input type=hidden name=sesskeys value='%OPRWEB06.12.102.oprweb01.03.003'>
<input type=hidden name=uniqueky value='%OPRWEB06.12.110'>
<input type=hidden name=teamnumb value='%OPRWEB06.12.334'>
</form>

<div id="adverseEventDiv" name="adverseEventDiv"
     style="background-color:white;position:absolute;width:600px;height:110px;top:100px;right:25%;
            border:3px outset grey;display:none">
 <table width="100%" cellpadding="0" cellspacing="0">
   <span class="DFrameTitleBar">Recovery Event</span>
   <tr><td colspan=2>&nbsp;</td></tr>
   <tr align="center" width="100%">
      <td width="60%">
         <span id="adverseText"><b>Did an adverse event occur?</b></span>
       </td>
       <td>
         <select class="Mandatory" id="adverseDropDown" name="adverseDropDown" >
           <option value="No">No</option>
           <option value="Yes">Yes</option>
         </select>
       </td>
   </tr>
   <tr></tr>
 </table>
 <br />
 <table width="100%">
   <tr width="100%" align="center">
     <td><input type="button"
                value="Ok"
                class="button"
                onclick="checkAdverseResponse();"
         />
     </td>
   </tr>
 </table>
</div>


<span id=ThtrCom style="display:none">
  <textarea wrap=hard cols=70 rows=3 name=opcom008> 
%OPRWEB06.12.143.008
  </textarea>
</span>

<span id=BookCom style="display:none">
  <textarea wrap=hard cols=70 rows=3 name=opcom008> 
%OPRWEB06.12.143.009
  </textarea>
</span>

<script type="text/javascript">

if ("%OPRWEB06.12.674" == "Yes") {
  document.UpdateForm.d_opsrg074.checked=1;
}
if ("%OPRWEB06.12.675" == "Yes") {
  document.UpdateForm.d_opsrg075.checked=1;
}

if ("%OPRWEB06.12.671" == "Yes") {
  document.UpdateForm.ovrnight.checked=1;
}
var mbsCount = %OPRWEB06.12.201
if (mbsCount >= 1)
  document.UpdateForm.mbsbutton.className="RedButton";

var impCount = %OPRWEB06.12.203
if (impCount > 1)
  document.UpdateForm.impbutton.className="RedButton";

var expCount = %OPRWEB06.12.205
if (expCount > 1)
  document.UpdateForm.expbutton.className="RedButton";

// Default MBS Item from Booking
if (isWhitespace(document.UpdateForm.mbsitem.value))
  document.UpdateForm.mbsitem.value="%OPRWEB06.12.345";

// Set 'BILL' button for MBS Items
var mbsBilled = %OPRWEB06.12.212
if ((!isWhitespace(document.UpdateForm.mbsitem.value)) && mbsBilled !=1)
  document.UpdateForm.mbsbill.disabled=false;

// Default Comment from Booking
if (%OPRWEB06.12.211 == 0)                       // First display of this page?
  CommentText.innerHTML = BookCom.innerHTML;     // Yes, default from booking
else
  CommentText.innerHTML = ThtrCom.innerHTML;     // No, use Day Proc comments
// Set exit theatre complex time to be mandatory if there is a time to ICU
  if(!isWhitespace(UpdateForm.opard083.value)) {
    UpdateForm.opard080.className= "Mandatory"
  }
CorrectCount="%OPRWEB06.12.340"
UpdateForm.opsrg008.selectedIndex =CorrectCount ;
</script>

