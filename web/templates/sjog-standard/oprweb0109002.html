<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="sjog-standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb0109002.js"> </script>
%START.OF.PAGE
<script type="text/javascript" >

function getPortalCookie() {
  if (GetCookieData("sjogwaPortalCOOKIE") != 'unknown') {
    ExpireCookiePath("sjogwaPortalCOOKIE");
    sjogprtl = "1";
  }
}

var sjogprtl = "";
getPortalCookie();

if("%STANDARD.01.025.119.182.0.1" == "1" &&
   sjogprtl != "1") {  // ptcnepis
  var src="../js/eAdmissionReg.js";
  var script = document.createElement("script");
               script.setAttribute("src", src);
               script.setAttribute("type", "text/javascript");
  document.getElementsByTagName("head")[0].appendChild(script);
}
//------------------------------------------------------------
// Validate Operation Duration Average
//------------------------------------------------------------
function validateOprDurAve(ReturnCode,ReturnDoct,ReturnName) {
  if (isWhitespace(ReturnCode.value)) return;;
  var serverURL   = "../cgi-bin/patweb80.pbl?reportno=78" +
                    "&valdcode=" + ReturnCode.value.replace(/ /g,"+") +
                    "&valddoct=" + ReturnDoct.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|")
    if (!isWhitespace(ReturnValue[0])) {
      if(document.AddForm.opcnfdur.value=="1") {
        ReturnName.value=trim(ReturnValue[0])
      } else { 
        for (var i =0 ; i < document.AddForm.operexpd.length; i++) {
         x=trim(document.AddForm.operexpd.options[i].value)
         if (x==trim(ReturnValue[0])){
            document.AddForm.operexpd.options[i].selected=true;
            break;}
        }
      }
    }
    return true;
  } else {
    ReturnCode.select();
    ReturnCode.focus();
    return false;
  }
}
function setBokURCookie() {
  document.cookie="ReturnPathURNO="+escape(document.AddForm.urnumber.value)+";"
}
function RemoveQuote(Field) {
    Field.value=Field.value.replace(/\"/g,"");
}
function changeOperation(theForm) {   
for (var i = 0; i < theForm.operpref.length; i++) {
 if (theForm.operpref.options[i].selected == true) {
  theForm.elements["operdes1"].value=theForm.operpref.options[i].text }
 }
}
function changeAdmitDate(theForm) {   
for (var i = 0; i < theForm.patadmdt.length; i++) {
 if (theForm.patadmdt.options[i].selected == true) {
  theForm.elements["operdes3"].value="Admit:"+theForm.patadmdt.options[i].text }
  }
}
function Check(){
 if(!validateMandatory(AddForm)) 
   return; 
 AddForm.bkrec006.disabled=false
 AddForm.bkrec007.disabled=false
 AddForm.patadmdt.disabled=false
 AddForm.bkrec005.disabled=false
//
 if(!CheckBookDate()) {
   return;
 }
//
 if(document.AddForm.opdausr1.disabled!=true) {
   document.AddForm.operusr1.value=
   document.AddForm.opdausr1.value.substr(0,3);
 }
//
var timecalc = parseInt(document.getElementById('operexpd').value) + 
                parseInt(AddForm.sesendtm.value) +
                parseInt(AddForm.sesprptm.value)
if (timecalc > AddForm.sesdurtm.value) {
   if(confirm("Session will be Overbooked, Ok to Continue")) {
       formSubmit();
       }
   else document.CancelBook.submit();
    }
else formSubmit();
}
function chkDOL() {
if(!isWhitespace(AddForm.listdate.value)){
  if(!ChkDateTime(AddForm.listdate,null,AddForm.patadmdt,null)){
      alert("Confirmed admission date cannot be before Date on List");}
  }
}

function formSubmit() {
  p=document.AddForm
  validateSuspension(p.urnumber,p.opdadate,p.datefrom,p.dateto);
  if(p.datefrom.value!='0'){
         ans=confirm("Warning : Patient has a Suspension record for period \n" +
               "\t" + p.datefrom.value  + " - " + p.dateto.value);
         if (ans!=true) {
            return;
            }
         } 
 validateWLKeySuspension(p.wattrkey,p.patadmdt,p.datefromwl,p.datetowl);
 if(p.datefromwl.value!='0'){
   alert("Error: Patient has a Suspension record for period \n" +
            "\t" + p.datefromwl.value  + " - " + p.datetowl.value);
   return;
 }
if(!isWhitespace(AddForm.listdate.value)){
  if(!ChkDateTime(AddForm.listdate,null,AddForm.patadmdt,null)){
      alert("Confirmed admission date cannot be before Date on List");
      return;}
 }
if(!isWhitespace(AddForm.listdate.value)){
 if(AddForm.ptcnhdps.value=="3"){
 if(ChkDateTime(AddForm.bookdate,AddForm.booktime,AddForm.bkrec034,null)){
    alert("Date booking created cannot be after Theatre date.")
      return;}
 if(days_between(document.AddForm.bkrec034.value,document.AddForm.bookdate.value)>365){
   alert("Error: Over one year difference between data entry and Theatre date");
   return;}}
 }

 if(isWhitespace(AddForm.patadmdt.value)) {
     if(document.getElementById("ptcnepis").value=="1" &&
        typeof eAdmCookie != 'undefined' && eAdmCookie!="unknown" &&
        !isWhitespace(AddForm.admisnid.value) &&
        sjogprtl != "1") {
          document.AddForm.nextlink.value=eAdmCookie;
     } else {
        CaseList=GetContentCookie("CasePath");
        if (CaseList!="unknown") {
          AddForm.nextlink.value=CaseList;
        }
     }
     AddForm.submit(); 
     return;
 }
  
 if(ChkDateTime(AddForm.patadmdt,null,AddForm.bookdate,null)){
    if(document.getElementById("ptcnepis").value=="1" &&
        typeof eAdmCookie != 'undefined' && eAdmCookie!="unknown" &&
        !isWhitespace(AddForm.admisnid.value) &&
        sjogprtl != "1") {
          document.AddForm.nextlink.value=eAdmCookie;
    } else {
        CaseList=GetContentCookie("CasePath");
        if (CaseList!="unknown") {
          AddForm.nextlink.value=CaseList;
        }
     }
     AddForm.submit(); 
 }
 else {
       alert("Theatre Booking cannot be before Admission Date");
  }
}
function setCombo(){
  MenuOver(AddForm.operknow);
}
function checkWatEntry(){
   if (AddForm.bkrec006.value != "") {
     AddForm.bkrec006.disabled=true
     AddForm.bokrx002.focus()
   }else {
     AddForm.bkrec006.focus()
   }
   if (AddForm.bkrec007.value != "") {
     AddForm.bkrec007.disabled=true
   }
   if (AddForm.patadmdt.value != "") {
     AddForm.patadmdt.disabled=true
   }
   if (AddForm.bkrec005.value != "") {
     AddForm.bkrec005.disabled=true
   }
//  AddForm.watread1.disabled=true;
}
function DisableIcon(field) {
  if (field.disabled == true) {
    alert(field.title+" is for display only")
    AddForm.bokrx002.focus()
  }
}
// Check if booking date is in the past (warning)
function CheckBookDate(){
      var strtDay  = document.AddForm.bookdate.value.substring(0,2);
      var strtMon  = document.AddForm.bookdate.value.substring(3,6);
      var strtYear = document.AddForm.bookdate.value.substring(7,11);
      strtMon = GetMonthNumber(strtMon);

      var strtDate = strtYear + strtMon + strtDay
      if(!CheckFuture(strtDate)){
        if(!confirm("Warning: Booking date is prior to current date.")){
          return false;
        }
      }
      return true;
}
function valClaimCode() {
  if (document.AddForm.patclaim.value=="") {
  validateCode(41,AddForm.urnumber,AddForm.claimc);
  for (var i =0 ; i < document.AddForm.patclaim.length; i++) {
    if (document.AddForm.claimc.value==
        trim(document.AddForm.patclaim.options[i].value.substr(0,3))){
          document.AddForm.patclaim.selectedIndex=i;
    }
  }
 }
}
function assignPBRAuthBy() {
  PBRFieldDIV.innerHTML=PBRFieldHiddenSPAN.innerHTML;
  AuthByFieldDIV.innerHTML=AuthByFieldHiddenSPAN.innerHTML;
}
function validateDateBookingRules() {

  var admdate;
  var wtldate;
  var admdateDATEOBJECT;
  var wtldateDATEOBJECT;
  var oneDay = 24*60*60*1000;
  var diffDays = 0;

  if (isWhitespace(AddForm.patadmdt.value) ||
      isWhitespace(AddForm.watldate.value)) {
     PBRTitleDIV.innerHTML="";
     PBRFieldDIV.innerHTML="";

     AuthByTitleDIV.innerHTML="";
     AuthByFieldDIV.innerHTML="";
    return;
  }

  admdate = SetDateYYYYMMDD(AddForm.patadmdt.value);
  wtldate = AddForm.watldate.value;

  if (admdate < wtldate ) {

    PBRTitleDIV.innerHTML="";
    PBRFieldDIV.innerHTML="";

    AuthByTitleDIV.innerHTML="";
    AuthByFieldDIV.innerHTML="";

    return;
  }

  admdateDATEOBJECT = new Date();
  wtldateDATEOBJECT = new Date();

  admdateDATEOBJECT.setFullYear(admdate.substr(0,4));
  admdateDATEOBJECT.setMonth(parseInt(admdate.substr(4,2)-1));
  admdateDATEOBJECT.setDate(admdate.substr(6,2));


  wtldateDATEOBJECT.setFullYear(wtldate.substr(0,4));
  wtldateDATEOBJECT.setMonth(parseInt(wtldate.substr(4,2)-1));
  wtldateDATEOBJECT.setDate(wtldate.substr(6,2));

  diffDays = Math.round(Math.abs((admdateDATEOBJECT.getTime() -
                                  wtldateDATEOBJECT.getTime())/(oneDay)));


  if (diffDays > 31 && diffDays <= 91) {

    if (document.AddForm.watprior.value.substr(14,1) != 3) {
      return;
    }

    if (AddForm.bokrx045!=undefined) {
      if (!isWhitespace(AddForm.bokrx045.value)) {
        return;
      }
    }

    if (confirm("Booking date is less than 91 days and does not meet \n" +
                 "the Category 3 guidelines. Select OK to accept this \n" +
                 "date, Select Cancel to clear the date.")) {
      assignWaitingListBookingSpans();
      return;
      } else {
      document.AddForm.patadmdt.value="";
      return;
    }
  } else {
    if (diffDays <= 31) {

      if (document.AddForm.watprior.value.substr(14,1) != 2 &&
          document.AddForm.watprior.value.substr(14,1) != 3) {
        return;
      }

      if (AddForm.bokrx045!=undefined) {
        if (!isWhitespace(AddForm.bokrx045.value)) {
          return;
        }
      }

      if (document.AddForm.watprior.value.substr(14,1) == 2) {
        if (confirm("Booking date is less than 31 days and does not meet \n" +
                     "the Category 2 guidelines. Select OK to accept this \n" +
                     "date, Select Cancel to clear the date.")) {
          assignWaitingListBookingSpans();
          return;
        } else {
          document.AddForm.patadmdt.value="";
          return;
        }
      }

      if (document.AddForm.watprior.value.substr(14,1) == 3) {
        if (confirm("Booking date is less than 91 days and does not meet \n" +
                    "the Category 3 guidelines. Select OK to accept this \n" +
                    "date, Select Cancel to clear the date.")) {
          assignWaitingListBookingSpans();
          return;
        } else {
          document.AddForm.patadmdt.value="";
          return;
        }
      }
    }
  }

  PBRTitleDIV.innerHTML="";
  PBRFieldDIV.innerHTML="";

  AuthByTitleDIV.innerHTML="";
  AuthByFieldDIV.innerHTML="";

}

function assignWaitingListBookingSpans() {

  PBRTitleDIV.innerHTML=PBRTitleVisibleSPAN.innerHTML;
  PBRFieldDIV.innerHTML=PBRFieldVisibleSPAN.innerHTML;

  AuthByTitleDIV.innerHTML=AuthByTitleVisibleSPAN.innerHTML;
  AuthByFieldDIV.innerHTML=AuthByFieldVisibleSPAN.innerHTML;

}
function getTheatreCancelButtonCookie() {
  if (GetCookieData("TheatreCancelButtonCookie")!="unknown") {
    document.getElementById("thcanbut").value=
    GetCookieData("TheatreCancelButtonCookie");
    ExpireCookiePath("TheatreCancelButtonCookie");
  }
}
function portalBooking() {
  if(document.getElementById("ptcnepis").value=="1" &&
   sjogprtl != "1") {
    OnlinePreadmission();
    eAdmPreList();
  }
}
function clrCookieReturn() {
  if(!isWhitespace(document.getElementById('thcanbut').value)) {
     location.href=document.getElementById('thcanbut').value;
  } else {
    if(document.getElementById("ptcnepis").value=="1" &&
       typeof eAdmCookie != 'undefined' && eAdmCookie!="unknown" &&
       !isWhitespace(document.AddForm.admisnid.value) &&
       sjogprtl != "1") {
       document.AddForm.showflag.value = "1";
       getTop().content.location.href=eAdmCookie;
    } else {
      window.history.go(-1);
    }
  }
}
</script>
</head>
<body onload="PageLoad(event);checkWatEntry();setCombo();
              GetTheatreRequestCookies();
              ChkInp();
              valClaimCode();setBokURCookie();assignPBRAuthBy();
              getTheatreCancelButtonCookie();
              selectOptions2('31',AddForm.bkrec015,AddForm.bkrec018);
              selectOptions2('31',AddForm.bokrx002,AddForm.bokrx038);
              setTimeout('portalBooking()',700);">
<div id=PageHeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OPRWEB01.09.003";
PatientVIS="%OPRWEB01.09.081";
PatientNAM="%OPRWEB01.09.002";
PatientSTA="%OPRWEB01.09.086.078";
PatientALT="%OPRWEB01.09.084";
PatientSEX="%OPRWEB01.09.019";
PatientDOB="%OPRWEB01.09.020";
PatientAGE="%OPRWEB01.09.021";
PatientLOC="%OPRWEB01.09.083";
PatientPRI="%OPRWEB01.09.086.066.1";
PatientUNT="%OPRWEB01.09.066.0";
DoctorCOD="%OPRWEB01.09.082.003";
DoctorNAM="%OPRWEB01.09.082.002";
PatientAID="%OPRWEB01.09.086.090";
PatientIND="%OPRWEB01.09.086.091";
PatientCUR="%OPRWEB01.09.086.092";
PatientCLC="%OPRWEB01.09.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OPRWEB01.09.086.094";
PatientCDM="%OPRWEB01.09.086.095";
PatientVDH="%OPRWEB01.09.086.099.015";
InsertPatientHeader()
</script>

<div id=PatientMenu></div>
</div>
<div id=PageBodySection>

<form name=AddForm  method=post action=oprweb01.pbl>
<input type=hidden name=reportno value=10>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%OPRWEB01.09.003">
<input type=hidden name=admissno value="%OPRWEB01.09.081">
<input type=hidden name=nextlink value="%OPRWEB01.09.102.oprweb01.03.003">
<input type=hidden name=bkrec008 value="THE">
<input type=hidden name=sesskeys value="%OPRWEB01.09.101">
<input type=hidden name=wattrkey value="%OPRWEB01.09.301">
<input type=hidden name=casekeys value="%OPRWEB01.09.301">
<input type=hidden name=bookdate value="%OPRWEB01.09.202">
<input type=hidden name=booktime value="%OPRWEB01.09.203">
<input type=hidden name=admisnum >
<input type=hidden name=admndate value="%OPRWEB01.09.702">
<input type=hidden name=admntime value="%OPRWEB01.09.703">
<input type=hidden name=bkrec002 value="%OPRWEB01.09.204.003">
<input type=hidden name=sesdurtm value="%OPRWEB01.09.209">
<input type=hidden name=sesprptm value="%OPRWEB01.09.211">
<input type=hidden name=sesendtm value="%OPRWEB01.09.218">
<input type=hidden name=ptmis027 value="%OPRWEB01.09.726.1"> 
<input type=hidden name=ptmis068 value="%OPRWEB01.09.705.1">
<input type=hidden name=ptvis043 value="%OPRWEB01.09.729">
<input type=hidden name=ptmis009 value="%OPRWEB01.09.710.1">
<input type=hidden name=ptmas024 value="%OPRWEB01.09.712.1">
<input type=hidden name=admpoint value="%OPRWEB01.09.503.1">
<input type=hidden name=listdate value="%OPRWEB01.09.309">
<input type=hidden name=caretype value="%OPRWEB01.09.713.3">
<input type=hidden name=ptcnhdps value="%OPRWEB01.09.801">
<input type=hidden name=admstats value="%OPRWEB01.09.704">
<input type=hidden name=currflag value="%OPRWEB01.09.802">
<input type=hidden name=opdadate value="%OPRWEB01.09.202">
<input type=hidden name=datefrom>
<input type=hidden name=dateto>
<input type=hidden name=datefromwl>
<input type=hidden name=datetowl>
<input type=hidden name=claimc>
<input type=hidden name=operusr1 value="%OPRWEB01.09.616.1">
<input type=hidden name=uvthindi value=1>
<input type=hidden name=pthvflag value="%OPRWEB01.09.807">
<input type=hidden name=opcnfdur value="%STANDARD.01.025.113.002.0.1">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect >
<input type=hidden name=ptcndwaw value="%STANDARD.01.025.105.216.1.1">
<input type=hidden name=watprior value="%OPRWEB01.09.317.3">
<input type=hidden name=watldate value="%OPRWEB01.09.396">
<input type=hidden id=thcanbut value="">
<input type=hidden name=sjogpowb id=sjogpowb>
<input type=hidden name="nobkdes2" value="1">
<input type="hidden" name="ptcnepis" id="ptcnepis"
 value="%STANDARD.01.025.119.182.0.1" />
<input type=hidden name=admisnid id=admisnid value="%OPRWEB01.09.820">
<input type=hidden name=showflag value="0">
<input type=hidden name=bkthvick value=" ">
<input type=hidden name=bkthrdck value=" ">
<input type=hidden name=requestn value=" ">
<input type=hidden name=thetrqin id=thetrqin value=" ">
<input type=hidden name=thetrqvl id=thetrqvl value=" ">

<table border="0" cellpadding="1" cellspacing="0" width="100%">
<tr><td align=center class=HeadingCell>Theatre Booking Form</td></tr>
</table>

<table border="0" cellpadding="1" cellspacing="0" width="95%" align=center>
<tr><td width=15% class=DataLabel>Surgeon   </td>
    <td ><a href='javascript:DoctorViewFrame("%OPRWEB01.09.204.003")'>
         <b>%OPRWEB01.09.204.002 &nbsp; </b></a></td>
    <td width=15%>Anaesthetist   </td>
    <td><a href='javascript:DoctorViewFrame("%OPRWEB01.09.216.003")'>
         %OPRWEB01.09.216.002</a></td></tr>
<tr><td class=DataLabel>Unit</td>
    <td class=DataField>%OPRWEB01.09.213  </td></tr>

<tr><td width=15% class=DataLabel>Theatre  </td>
    <td class=DataField> %OPRWEB01.09.214.0 </td>
    <td class=DataLabel>Session Type</td>
    <td class=DataField>%OPRWEB01.09.269.0  </td></tr>

<tr><td class=DataLabel>Date  </td>
    <td class=DataField>%OPRWEB01.09.206 %OPRWEB01.09.202</td>
    <td class=DataLabel>Time  </td>
    <td class=DataField> %OPRWEB01.09.203 to %OPRWEB01.09.208</td></tr>

<tr><td colspan=4 align=center><hr width=100%></td></tr>
<tr><td class=DataLabel>Pre-Assesment</td>
    <td class=DataLabel>
    <input type=text id=bkrec006 name=bkrec006 size=12 maxlength=11 class=""
     onblur="checkDate(this,'Date')"
     title="Pre-Assesment Date" value="%OPRWEB01.09.327">
    <img src=../images/DateLookup.gif class=Icon 
    onclick='javascript:DateLookupFrame(AddForm.bkrec006)'
     onfocus='javascript:DisableIcon(AddForm.bkrec006)' tabindex=-1>
    Time
    <input type=text id=bkrec007 name=bkrec007 size=7 class="" 
     title="Pre-Assesment Time" value="%OPRWEB01.09.428">
    <img src=../images/DateTimeStamp.gif class=Icon 
    onclick='javascript:SetCurrentDateTime(AddForm.bkrec006,AddForm.bkrec007)'
     onfocus='javascript:DisableIcon(AddForm.bkrec007)' tabindex=-1> 
    <img src=../images/TimeLookup.gif class=Icon 
    onclick='javascript:TimeLookupFrame(AddForm.bkrec007)'
    onfocus='javascript:DisableIcon(AddForm.bkrec007)' tabindex=-1> 
    </td>
    <td class=DataLabel>Confirmed Admission</td>
    <td class=DataLabel>
     <input type=text id=patadmdt name=patadmdt size=12 maxlength=11
     onblur="if(checkDate(this,'Date')){validateDateBookingRules();}
             chkDOL();" class=Mandatory
     title="Admission Date" value="%OPRWEB01.09.506">
    <img src=../images/DateLookup.gif class=Icon 
     onclick='javascript:DateLookupFrame(AddForm.patadmdt)'
     onfocus='javascript:DisableIcon(AddForm.patadmdt)' tabindex=-1>
    Time
    <input type=text id=bkrec005 name=bkrec005 size=6 class=Mandatory
            title="Admission Time">
    <img src=../images/DateTimeStamp.gif class=Icon 
     onclick='javascript:SetCurrentDateTime(AddForm.patadmdt,AddForm.bkrec005)'
     onfocus='javascript:DisableIcon(AddForm.bkrec005)'>
    <img src=../images/TimeLookup.gif class=Icon 
    onclick='javascript:TimeLookupFrame(AddForm.bkrec005)'
     onfocus='javascript:DisableIcon(AddForm.bkrec005)'>
    </td></tr>

<tr>
  <td></td>
  <td></td>
  <td><div id="PBRTitleDIV"></div></td>
  <td><div id="PBRFieldDIV"></div></td>
</tr>

<tr>
  <td></td>
  <td></td>
  <td><div id="AuthByTitleDIV"></div></td>
  <td><div id="AuthByFieldDIV"></div></td>
</tr>

<tr><td class=DataLabel>Admitting Point</td>
    <td class=DataField>
    <select name=bokrx003 title="Admitting Point"  class=Mandatory>
    <option></option>
    %OPRWEB01.09.406.5
    </select></td>
    <td class=DataLabel>Planned Length of Stay </td>
    <td class=DataLabel>
    <input type=text name=bkrec033 size=4 maxlength=3 class=Integer
    value=%OPRWEB01.09.316 title="Planned Length of Stay">(days)</td>
</tr>

<tr><td class=DataLabel>Expected Ward</td>
    <td class=DataLabel>
    <select id=bkrec015 name=bkrec015 title="Expected Ward" 
     onchange="selectOptions2('31',AddForm.bkrec015,AddForm.bkrec018);">
    <option></option>
    %OPRWEB01.09.405.2
    </select>
    Bed
    <select name=bkrec018 title="Expected Bed" >
    <option></option>
    </select>
    </td>
    <td class=DataLabel>Exp.Post Op Ward</td>
    <td class=DataLabel>
    <select id=bokrx002 name=bokrx002 title="Exp.Post Op Ward"
     onchange="selectOptions2('31',AddForm.bokrx002,AddForm.bokrx038);" >
    <option></option>
    %OPRWEB01.09.405.2
    </select>
    Bed
    <select name=bokrx038 title="Expected Post-Op Bed">
    <option></option>
    </select>
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.P </td>
    <td class=DataField>
    <select name=bkrec019 title="%STANDARD.01.017.P ">
    <option></option>
    %STANDARD.01.007.P 
    </select></td>
     <td class=DataLabel>Admission Source</td>
     <td class=DataField>
     <select name="opdea037" title="Admission Source">
     <option></option>
     %OPRWEB01.09.655.2
     </select></td>
 </tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td class=DataField>
    <select name="patclaim" title="%STANDARD.01.017.CL" class=Mandatory >
     <option></option>
     %OPRWEB01.09.115.9.1.10.2.X
     </select></td>
    <td class=DataLabel> Duration </td>
    <td><div id=Duration></div></td>
</tr>

<tr valign=top>
    <td class=DataLabel>Anaesthetic Type</td>
    <td><select name="operanae" 
             title="Anaesthetic"
             class=Mandatory>
    <option></option>
    %OPRWEB01.09.106.4
    </select></td>
<td class=DataLabel>%STANDARD.01.017.Y6</td>
    <td class=DataField>
    <select name=opdausr1 title="%STANDARD.01.017.Y6">
    <option></option>
    %STANDARD.01.007.Y6
    </select></td>
</tr>

<tr><td class=DataLabel>MBS Codes</td>
    <td><input type=text name=operprv1 size=9 value="%OPRWEB01.09.303"
	  id=operprv1
           onblur='validateCode(4,
                                AddForm.operprv1,
                                AddForm.mbsdesc1,
                                AddForm.bookdate);
                   validateOprDurAve(operprv1,bkrec002,operexpd);'
           title="Expected MBS Item 1" >
        <input type=text readonly id=mbsdesc1 name=mbsdesc1 size=30
           title="Expected MBS Item 1 Name" tabindex=-1
              value="%OPRWEB01.09.306" >
     <img src="../images/SearchIcon.gif" class=Icon
     onclick="MbsSearchFrame(AddForm.operprv1,
                             AddForm.mbsdesc1,
                             AddForm.bookdate)"></td>
    <td class=DataLabel>Infection Status </td>
    <td><select name="operknow" 
             title="Infection Status">
    <option></option>
    %OPRWEB01.09.640.2
    </select>
    </td></tr>

<tr><td></td><td><input type=text id=operprv2 name=operprv2 size=9
           onblur='validateCode(4,
                                AddForm.operprv2,
                                AddForm.mbsdesc2,
                                AddForm.bookdate)'
           title="Expected MBS Item 2" >
    <input type=text readonly id=mbsdesc2 name=mbsdesc2 size=30
           title="Expected MBS Item 2 Name" tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="MbsSearchFrame(AddForm.operprv2,
                             AddForm.mbsdesc2,
                             AddForm.bookdate)"></td>
    <td class=DataLabel>Equipment Required 1</td>
    <td><select name="opdea032" 
             title="Equipment Required 1">
    <option></option>
    %OPRWEB01.09.645.2
    </select>
    </td></tr>

<tr><td></td><td><input type=text id=operprv3 name=operprv3 size=9
           onblur='validateCode(4,
                                AddForm.operprv3,
                                AddForm.mbsdesc3,
                                AddForm.bookdate)'
           title="Expected MBS Item 3" >
    <input type=text readonly id=mbsdesc3 name=mbsdesc3 size=30
           title="Expected MBS Item 3 Name" tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="MbsSearchFrame(AddForm.operprv3,
                             AddForm.mbsdesc3,
                             AddForm.bookdate)"></td>
    <td class=DataLabel>Equipment Required 2</td>
    <td><select name="opdea033" 
             title="Equipment Required 2">
    <option></option>
    %OPRWEB01.09.646.2
    </select>
    </td></tr>

<tr valign=top>
    <td class=DataLabel>Full Description</td>
    <td><input type="text" size="45" maxlength=80 name="operdes1" 
           id=operdes1 value="%OPRWEB01.09.306" class=AlphanumSpec4
           title="Operation Description 1" onblur="RemoveQuote(this);
            checkAlphanumSpec4(this);"></td>
    <td class=DataLabel>Equipment Required 3</td>
    <td><select name="opdea035"
             title="Equipment Required 3">
    <option></option>
    %OPRWEB01.09.649.2
    </select>
    </td></tr>


<tr><td></td><td><input type="text" size="45" maxlength=80 name="operdes2" 
           title="Operation Description 2" onblur="RemoveQuote(this);
            checkAlphanumSpec4(this);"
	    id=operdes2 class=AlphanumSpec4></td>
    <td class=DataLabel>Equipment Loaned</td>
    <td><select name="opdea034" 
             title="Equipment Loaned">
    <option></option>
    %OPRWEB01.09.647.2
    </select>
    </td></tr>


<tr><td></td><td><input type="text" size="45" maxlength=80 name="operdes3" 
           title="Operation Description 3" onblur="RemoveQuote(this); 
            checkAlphanumSpec4(this);"
	    id=operdes3 class=AlphanumSpec4></td>
    <td class=DataLabel>Operating Unit</td>
    <td class=DataField>
    <select name=opdea036 title="Operating Unit" class="Mandatory">
    <option></option>
     %OPRWEB01.09.213.2
    </select></td>
    </tr>

<tr><td class=DataLabel>Prosthesis Required</td>
    <td> <input type="text" size="45" maxlength=40 name="opercomm" 
           title="Prosthesis Comment " > </td>
    <td class=DataLabel>Date Created        </td>
    <td class=DataField><input type=text size=12 name=bkrec034 class=Mandatory
        id=bkrec034 title="Date Created" value="%STANDARD.01.015">
        <img notab src=../images/DateLookup.gif class=Icon 
        onclick="DateLookupFrame(AddForm.bkrec034);">
        </td></tr>
<tr><td></td>
    <td></td>
    <td class=DataLabel>Created By        </td>
    <td class=DataField><input type=text size=25 class=Readonly 
        value="%STANDARD.01.009">
</td></tr>

<tr><td class=DataLabel>Comments</td>
    <td colspan=3>
<textarea wrap=hard cols=60 rows=3 name=opcom009>%OPRWEB01.09.643.009</textarea>
    </td></tr>

<tr><td colspan=4>&nbsp;</td></tr>

<tr><td colspan=4 align="center">
  <input type=button id="opr01sub" class="button" value="Ok"
  onclick="tempDisable(this);Check();">
  <input type=button class="button" value="Cancel" 
   onclick="clrCookieReturn();">
    </td></tr>
</table>
</form>
</div>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=9>
<input type=hidden name=template value=002>
<input type=hidden name=urnumber value="%OPRWEB01.09.003">
<input type=hidden name=admissno value="%OPRWEB01.09.081">
<input type=hidden name=MenuType value="%OPRWEB01.09.088">
<input type=hidden name=casekeys value="%OPRWEB01.09.101">
<input type=hidden name=sesskeys value="%OPRWEB01.09.101">
</form>
<form name=CancelBook method=get>
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=003>
<input type=hidden name=sesskeys value="%OPRWEB01.09.101">
</form>
<form name=LinkForm method=get action=oprweb02.pbl>
<input type=hidden name=reportno value=03>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value="%OPRWEB01.09.003">
<input type=hidden name=admissno value="%OPRWEB01.09.081">
</form>

<span id=SDuration style="display:none">
<select name="operexpd" id="operexpd"
             title="Operation Expected Duration"
             class=Mandatory>
    <option value=""></option>
    <option value="  10">10 min</option>
    <option value="  15">15 Min</option>
    <option value="  20">20 Min</option>
    <option value="  30">30 min</option>
    <option value="  40">40 min</option>
    <option value="  50">50 min</option>
    <option value="  60">60 min</option>
    <option value="  70">70 min</option>
    <option value="  80">80 min</option>
    <option value="  90">90 min</option>
    <option value=" 100">100 min</option>
    <option value=" 110">110 min</option>
    <option value=" 120">120 Min</option>
    <option value=" 130">130 min</option>
    <option value=" 140">140 min</option>
    <option value=" 150">150 min</option>
    <option value=" 160">160 min</option>
    <option value=" 170">170 min</option>
    <option value=" 180">180 min</option>
    <option value=" 190">190 min</option>
    <option value=" 200">200 min</option>
    <option value=" 210">210 min</option>
    <option value=" 220">220 min</option>
    <option value=" 230">230 min</option>
    <option value=" 240">240 min</option>
    <option value=" 250">250 min</option>
    <option value=" 260">260 min</option>
    <option value=" 270">270 min</option>
    <option value=" 280">280 min</option>
    <option value=" 290">290 min</option>
    <option value=" 300">300 min</option>
    <option value=" 310">310 min</option>
    <option value=" 320">320 Min</option>
    <option value=" 330">330 min</option>
    <option value=" 340">340 min</option>
    <option value=" 350">350 min</option>
    <option value=" 360">360 min</option>
    <option value=" 370">370 min</option>
    <option value=" 380">380 min</option>
    <option value=" 390">390 min</option>
    <option value=" 400">400 min</option>
    <option value=" 410">410 min</option>
    <option value=" 420">420 min</option>
    <option value=" 430">430 min</option>
    <option value=" 440">440 min</option>
    <option value=" 450">450 min</option>
    </select>
</span>
<span id=FDuration style="display:none">
  <input type=text name="operexpd" id="operexpd" size=6 maxlength=4 min=0
           title="Operation Expected Duration" class="Mandatory Integer"
            value="%OPRWEB01.09.305">
      (minutes)
</span>
<span id=PBRFieldHiddenSPAN style="display:none">
<input type=hidden name=bokrx045 value="">
<input type=hidden name=bokrx047 value="">
</span>
<span id=AuthByFieldHiddenSPAN style="display:none">
<input type=hidden name=bokrx046 value="">
</span>
<span id=PBRTitleVisibleSPAN style="display:none">
%STANDARD.01.017.b1
</span>
<span id=PBRFieldVisibleSPAN style="display:none">
<select name="bokrx045" title="%STANDARD.01.017.b1" class=Mandatory>
    <option></option>
    %STANDARD.01.007.b1
</select>
<input type=hidden name=bokrx047 value="%STANDARD.01.008">
</span>
<span id=AuthByTitleVisibleSPAN style="display:none">
%STANDARD.01.017.b2
</span>
<span id=AuthByFieldVisibleSPAN style="display:none">
<select name="bokrx046" title="%STANDARD.01.017.b2" class=Mandatory>
    <option></option>
    %STANDARD.01.007.b2
</select>
</span>
<script type="text/javascript" >
if(document.AddForm.opcnfdur.value=="1") {
  Duration.style.display="";
  Duration.innerHTML=FDuration.innerHTML;
} else {
  Duration.style.display="";
  Duration.innerHTML=SDuration.innerHTML;
  for (var i =0 ; i < document.AddForm.operexpd.length; i++) {
  x=trim(document.AddForm.operexpd.options[i].value)
     if (x==trim(%OPRWEB01.09.305)){
         document.AddForm.operexpd.options[i].selected=true;
         break;} };
}
for (var i =0 ; i < document.AddForm.bokrx002.length; i++) {
     if (document.AddForm.bokrx002.options[i].value=="%OPRWEB01.09.405.1") {
         document.AddForm.bokrx002.selectedIndex=i } };

function AdmissionLinkSearchFrame(urnumb,session,RETadmis,RETdate,RETtime,
                                  RETacare,RETaclaim){
 DFrameStart();
  window.urnumber=urnumb;
  window.sesskeys=session; 
  document.getElementById('PopUpFrame').src="../lookups/AdmissionLinkSearchFrame.html";
  SearchFrameShow();
}

function ChkInp() {
 if (AddForm.currflag.value=="1"||AddForm.currflag.value=="2") {
   if(confirm("Use the current Admission or Create a new booking\n" +
              "   Ok to use the Current, Cancel to Create New")) {
  AdmissionLinkSearchFrame(AddForm.urnumber,AddForm.sesskeys,AddForm.admissno,
                           AddForm.admndate,AddForm.admntime);
   return;
   }
  }
}
function defaultAdmission(){
   AddForm.admisnum.value=AddForm.admissno.value
   AddForm.patadmdt.value=AddForm.admndate.value
   AddForm.bkrec005.value=AddForm.admntime.value
//Intended Length of Stay
   AddForm.bkrec033.value=AddForm.ptvis043.value
//Financial Class
   for (var i =0 ; i < document.AddForm.patclaim.length; i++) {
     if (document.AddForm.patclaim.options[i].value.substr(0,3)==document.AddForm.ptmis027.value.substr(0,3)) {
         document.AddForm.patclaim.selectedIndex=i } };
//Admitting Point
   for (var i =0 ; i < document.AddForm.bokrx003.length; i++) {
     if (document.AddForm.bokrx003.options[i].value.substr(0,3)==document.AddForm.admpoint.value.substr(0,3)) {
         document.AddForm.bokrx003.selectedIndex=i } };
//Expected Ward  
   for (var i =0 ; i < document.AddForm.bokrx002.length; i++) {
     if (document.AddForm.bokrx002.options[i].value.substr(0,3)==document.AddForm.ptmis068.value.substr(0,3)) {
         document.AddForm.bokrx002.selectedIndex=i } };
//Admission Source  
   for (var i =0 ; i < document.AddForm.opdea037.length; i++) {
     if (document.AddForm.opdea037.options[i].value.substr(0,3)==document.AddForm.ptmis009.value.substr(0,3)) {
         document.AddForm.opdea037.selectedIndex=i } };
//Patient Type  
   for (var i =0 ; i < document.AddForm.bkrec019.length; i++) {
     if (document.AddForm.bkrec019.options[i].value.substr(0,3)==document.AddForm.ptmas024.value.substr(0,3)) {
         document.AddForm.bkrec019.selectedIndex=i } };
//Unplanned Visit To Theatre
   for (var i =0 ; i < document.AddForm.opdausr1.length; i++) {
     if (document.AddForm.opdausr1.options[i].value.substr(0,3)==document.AddForm.operusr1.value.substr(0,3)) {
         document.AddForm.opdausr1.selectedIndex=i } };

}
ibcnmhos="%OPRWEB01.09.799.008"
if(ibcnmhos=="1"){
  AddForm.bokrx002.className="Mandatory"
}
</script>
