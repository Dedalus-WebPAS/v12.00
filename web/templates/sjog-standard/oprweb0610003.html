<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="sjog-standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb06.js"> </script>
<script type="text/javascript">
function init() {
  if (isWhitespace(UpdateForm.opcom003.value)) {
    UpdateForm.opcom003.value= PatientNotes.Prothesis.value + "\n" +
                               PatientNotes.AnaeNote.value + "\n" +
                               PatientNotes.WaitNote.value 
  }
}
function SetPrinter(SelectList) {
 if (SelectList.className=="SelectBig") {
     SelectList.className="Mandatory SelectBig" }
 else {
     SelectList.className="SelectBig" }
}
function ChkReg() {
  if(isWhitespace(document.UpdateForm.opard080.value)) {
     PrintReg.innerHTML="";
     PrintReg.style.display="none";
  } else {
     PrintReg.style.display="";
     PrintReg.innerHTML=ShowPrintReg.innerHTML;
  }
}
function chkTime(field){
  if(isWhitespace(field.value))
   return;

  if(document.UpdateForm.caseabdn.value=="Yes")
   return;

  endTime=UpdateForm.suentime.value.replace(/:/g,"");
  if(isWhitespace(endTime)){
     alert("Surgery End Time must be entered first");
     field.value=""
     return;
  }
  if(field.value.replace(/:/g,"")<=endTime){ 
  Message=(""+field.title+" must be after Surgery End Time ")
          + UpdateForm.suentime.value
  alert(Message)
  field.value="";
  }
}
function setETTime(extime) {
document.UpdateForm.opard080.value=extime.value;
document.UpdateForm.opard085.value=extime.value;
 ChgRTD();
}
function valTime(){
  RecFront=UpdateFront.opard071.value.replace(/:/g,"");
  RecBack=UpdateFront.opard074.value.replace(/:/g,"");
  DepartTime=UpdateFront.opard085.value.replace(/:/g,"");
}
function ChgRTD() {
if(!isWhitespace(UpdateForm.opard080.value)) {
     UpdateForm.opard080.className= "Mandatory"
     UpdateForm.opard085.className= "Mandatory"
     }
else {
     UpdateForm.opard080.className=" "
     UpdateForm.opard085.className=" "
     }
}
function chkMan() {
var ToDepTime=trim(UpdateForm.opard085.value.replace(/:/g,""))
var ThExitTime=trim(UpdateForm.opard080.value.replace(/:/g,""))
ToDepTime=ToDepTime.substr(0,4)
ThExitTime=ThExitTime.substr(0,4)
ToDepTime=ToDepTime - 0;
ThExitTime=ThExitTime - 0;
var MaxDelay=(parseInt(ToDepTime) + 30 )
var Minutes=parseInt(MaxDelay) % 100
var Hour=parseInt(MaxDelay) / 100
if (Minutes>=60) { 
   Minutes=Minutes - 60
   Hour=parseInt(Hour) + 1 
   MaxDelay = (Hour*100) + Minutes
}
if (MaxDelay < ThExitTime) {
   UpdateForm.opard084.className="Mandatory" }
else {
   UpdateForm.opard084.className=""
   }
}


/******************************************************************************
 * adverse Event code
 *****************************************************************************/
function checkReadyToDepartExist()
{
  var opard085 = document.getElementById("opard085");
  var adverseEventDiv = document.getElementById("adverseEventDiv");

  if(opard085.value.replace(/ /g,"").length != 0)
  {
    adverseEventDiv.style.display = "";
  }
}

function setReadyDepartTime(opard085)
{
  SetCurrentDateTime(null,opard085);
  //checkReadyToDepartExist();

}

function changeTextForAdverseEvent()
{
 var adverseText = document.getElementById("adverseText");

 if(EventExist.replace(/ /g,"").length != 0 )
 {
    if(EventExist == 1) {
        adverseText.innerHTML = "<b>Would you like to modify the adverse events?</b>";
        return true;
   }else {
        adverseText.innerHTML = "<b>Did an adverse event occur?</b>";
        return false;
   }
 }else {
    adverseText.innerHTML = "<b>Did an adverse event occur?</b>";
    return false;
 }
}

function checkAdverseResponse()
{
 var adverseDropDown = document.getElementById("adverseDropDown");
 var adverseEventDiv = document.getElementById("adverseEventDiv");
 var casekeys = document.getElementById("casekeys");

 var bool = changeTextForAdverseEvent();

 if(adverseDropDown.value == "Yes" && !bool)
 {
   var url = "oprweb06.pbl?reportno=10&template=010";

   url += "&urnumber="+PatientURN;
   url += "&admissno="+PatientVIS;
   url += "&nodressg=1";
   url += "&casekeys="+casekeys.value;

   adverseEventDiv.style.display = "none";
   ShowDetail01(url);
 }
 else if(adverseDropDown.value == "Yes" && bool)
 {
   var url = "oprweb06.pbl?reportno=10&template=011";

   url += "&urnumber="+PatientURN;
   url += "&admissno="+PatientVIS;
   url += "&nodressg=1";
   url += "&casekeys="+casekeys.value;

   adverseEventDiv.style.display = "none";

   ShowDetail01(url);
 }
 else
 {
   adverseEventDiv.style.display = "none";
 }

}

function ShowDetail01(linkurl)
{
  Left=(document.body.clientWidth-900)/2
  var frame = document.getElementById("PopUpFrame");
  frame.style.overflow = "auto";
  frame.style.height = 700 +"px";

  DFrameLink(linkurl,0,Left,900,700)
}


</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);setTimeout('ChkReg()',100);changeTextForAdverseEvent();
  delayIntoRecovery();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Theatre Case Recovery Details
</span>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OPRWEB06.10.003";
PatientVIS="%OPRWEB06.10.081";
PatientNAM="%OPRWEB06.10.002";
PatientSTA="%OPRWEB06.10.086.078";
PatientALT="%OPRWEB06.10.084";
PatientSEX="%OPRWEB06.10.019";
PatientDOB="%OPRWEB06.10.020";
PatientAGE="%OPRWEB06.10.021";
PatientLOC="%OPRWEB06.10.083";
PatientPRI="%OPRWEB06.10.086.066.1";
PatientUNT="%OPRWEB06.10.066.0";
DoctorCOD="%OPRWEB06.10.082.003";
DoctorNAM="%OPRWEB06.10.082.002";
PatientAID="%OPRWEB06.10.086.090";
PatientIND="%OPRWEB06.10.086.091";
PatientCUR="%OPRWEB06.10.086.092";
PatientCLC="%OPRWEB06.10.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OPRWEB06.10.086.094";
PatientCDM="%OPRWEB06.10.086.095";
PatientVDH="%OPRWEB06.10.086.099.015";
InsertPatientHeader();
EventExist="%OPRWEB06.10.743";

</script>
<div id="PatientMenu"></div>

<div id="TheatreCaseHeading"></div>
<script type="text/javascript">
TheatreHeading="Theatre Case Recovery Details"
</script>
<div id=PageBodySection>
<form name=UpdateForm method=post action=oprweb06.pbl style="margin:0"
 onSubmit='return validateMandatory(this)'>
<input type=hidden name=reportno value=10>
<input type=hidden name=template value=001>
<input type=hidden name=updatety value="U">
<input type=hidden name=casekeys value="%OPRWEB06.10.101">
<input type=hidden name=nextpage value="0">
<input type=hidden name=suentime value="%OPRWEB06.10.306">
<input type=hidden name=opsrg071 value="%OPRWEB06.10.371" />
<input type=hidden name=opsrg006 value="%OPRWEB06.10.306" />
<input type=hidden name=opard104 value="%OPRWEB06.10.299.004" />
<input type=hidden name=caseabdn value="%OPRWEB06.10.374" />
<input type=hidden name=exittime value='%OPRWEB06.10.299.017'>
<table border=0 cellpadding=2 cellspacing=0 width="100%" align=center >
<tr><td class=DataLabel width=20% title='Arrival time in Recovery/PACU or DPU.(If>15 minute delay between this and "Surgery End" field a drop down box for
"reason for delay" to activate - mandatory completion in this case.)
If pt went directly to ICU from OR this field is not required.'>
Time into Recovery Stage 1 </td>
    <td class=DataField width=20%>
    <input type=text name=opard071 size=8 title="Time in Recovery - Stage 1"
     value='%OPRWEB06.10.271' 
     onBlur="checkTime(this);chkTime(this);delayIntoRecovery();">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(null,UpdateForm.opard071);">
    <img src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(UpdateForm.opard071);">
    </td><td class=DataLabel width=20%>Nurse Attending Patient</td>
    <td><input type=text name=opard072 size=6 value="%OPRWEB06.10.272.1"
     onblur="validateCode(17,UpdateForm.opard072,UpdateForm.name_opard072);">
    <input type=text readonly name=name_opard072 class=Readonly size=30
     value="%OPRWEB06.10.272.0" notab>
    <img src="../images/SearchIcon.gif" class=Icon notab
     onclick="NurseSearchFrame(UpdateForm.opard072,UpdateForm.name_opard072);">
    </td></tr>
<tr><td id=ov_label style="display:none" class=DataLabel>
      %STANDARD.01.017.ov</td>
      <td class=DataField id=ov_data style="display:none">
      <select name=opard087 title="%STANDARD.01.017.ov">
        <option></option>
         %OPRWEB06.10.287.2
      </select></td></tr>
<tr><td class=DataLabel> &nbsp; </td>
    <td class=DataField> &nbsp; </td>
    <td class=DataLabel>Nurse Attending Patient</td>
    <td><input type=text name=opard073 size=6 value="%OPRWEB06.10.273.1"
     onblur="validateCode(17,UpdateForm.opard073,UpdateForm.name_opard073);">
    <input type=text readonly name=name_opard073 class=Readonly size=30
     value="%OPRWEB06.10.273.0">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="NurseSearchFrame(UpdateForm.opard073,UpdateForm.name_opard073);">
    </td></tr>
<tr><td class=DataLabel title="Time of arrival in Stage 2 recovery, if applicable.">Time into Recovery Stage 2 </td>
    <td class=DataField>
    <input type=text name=opard074 size=8 title="Time in Recovery - Stage 2"
     value='%OPRWEB06.10.274'
     onBlur="checkTime(this);chkTime(this);delayIntoRecovery();">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(null,UpdateForm.opard074);">
    <img src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(UpdateForm.opard074);">
    </td><td class=DataLabel>Nurse Attending Patient</td>
    <td><input type=text name=opard075 size=6 value="%OPRWEB06.10.275.1"
     onblur="validateCode(17,UpdateForm.opard075,UpdateForm.name_opard075);">
    <input type=text readonly name=name_opard075 class=Readonly size=30
     value="%OPRWEB06.10.275.0">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="NurseSearchFrame(UpdateForm.opard075,UpdateForm.name_opard075);">
    </td></tr>
<tr><td class=DataLabel> &nbsp; </td>
    <td class=DataField> &nbsp; </td>
    <td class=DataLabel>Nurse Attending Patient</td>
    <td><input type=text name=opard076 size=6 value="%OPRWEB06.10.276.1"
     onblur="validateCode(17,UpdateForm.opard076,UpdateForm.name_opard076);">
    <input type=text readonly name=name_opard076 class=Readonly size=30
     value="%OPRWEB06.10.276.0">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="NurseSearchFrame(UpdateForm.opard076,UpdateForm.name_opard076);">
    </td></tr>
<tr><td class=DataLabel title='Time of arrival in Stage 3 recovery, if applicable.'>Time into Recovery Stage 3</td>
    <td class=DataField>
    <input type=text name=opard077 size=8 title="Time in Recovery - Stage 3"
     value='%OPRWEB06.10.277' onBlur="checkTime(this);chkTime(this);">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(null,UpdateForm.opard077);">
    <img src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(opard077);">
    </td><td class=DataLabel>Nurse Attending Patient</td>
    <td><input type=text name=opard078 size=6 value="%OPRWEB06.10.278.1"
     onblur="validateCode(17,UpdateForm.opard078,UpdateForm.name_opard078);">
    <input type=text readonly name=name_opard078 class=Readonly size=30
     value="%OPRWEB06.10.278.0">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="NurseSearchFrame(UpdateForm.opard078,UpdateForm.name_opard078);">
    </td></tr>
<tr><td class=DataLabel> &nbsp; </td>
    <td class=DataField> &nbsp; </td>
    <td class=DataLabel>Nurse Attending Patient</td>
    <td><input type=text name=opard079 size=6 value="%OPRWEB06.10.279.1"
     onblur="validateCode(17,UpdateForm.opard079,UpdateForm.name_opard079);">
    <input type=text readonly name=name_opard079 class=Readonly size=30
     value="%OPRWEB06.10.279.0">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="NurseSearchFrame(UpdateForm.opard079,UpdateForm.name_opard079);">
    </td></tr>
<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField></td>
    <td class=DataLabel>Time Patient Went to ICU/CCU</td>
    <td class=DataField>
    <input type=text name=opard083 size=8 title="Time Patient Went to ICU/CCU"
     value='%OPRWEB06.10.283'
     onBlur="checkTime(this);chkTime(this);setETTime(this);">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(null,UpdateForm.opard083);">
    <img src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(UpdateForm.opard083);">
    </td></tr>
<tr><td class=DataLabel>Ready to Depart Time</td>
    <td class=DataField>
    <input type=text name=opard085 size=8 title="Ready to Depart Time"
     value='%OPRWEB06.10.285' onBlur="checkTime(this);chkTime(this);ChgRTD();"
     id=opard085>
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="setReadyDepartTime(UpdateForm.opard085);">
    <img src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(UpdateForm.opard085);">
    </td><td class=DataLabel>%STANDARD.01.017.Ou</td>
    <td class=DataField>
    <select name=opard084 class=DataField title="%STANDARD.01.017.Ou">
    <option></option>
     %OPRWEB06.10.284.2
    </select>
    </td></tr>
<tr><td class=DataLabel>Exit Theatre Complex/DPU</td>
    <td class=DataField>
    <input type=text name=opard080 size=8 title="Exit Theatre Complex/DPU"
     value='%OPRWEB06.10.280' 
     onBlur="checkTime(this);chkTime(this);ChgRTD();chkMan();ChkReg();">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(null,UpdateForm.opard080);">
    <img src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(UpdateForm.opard080);"></td>
<td class=DataLabel>Prosthesis</td>
   <td class=DataField >
  <input type=text name=opard013 value="%OPRWEB06.10.213" maxlength=40 size=40>
  </td>
<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    <td class=DataLabel>Time of Death</td>
    <td class=DataField><input type=text name=opard082 size=8 
     title="Time Patient Died"
     value='%OPRWEB06.10.282' onBlur="checkTime(this);chkTime(this);">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(null,UpdateForm.opard082);">
    <img src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(UpdateForm.opard082);"></td>
  </tr>
</table>

<div id=PrintReg></div>

<table border=0 cellpadding=2 cellspacing=0 width="100%" align=center >
<tr valign=top>
    <td class=DataLabel width=20%>Preadmission and<br> Operation Notes
    <td colspan=3>
    <textarea wrap=hard cols=60 rows=3 
     name=opcom003>%OPRWEB06.10.143.003</textarea>
    <img src="../images/LookupIcon.gif" class=Icon
     onclick='LookupPage(null,UpdateForm.opcom003,"Lookup_00300000_000");'>
    </td></tr>
<tr><td colspan=4 align=center>
    <input class="button" type=button value="Ok" id="opr06sub"
     onclick="tempDisable(this);document.UpdateForm.submit();">
    <input class="button" type=button value="Cancel" onclick="DFrameExit();">
    </td></tr>
</table>
</form>

<form name=PatientNotes method=get style="margin:0">
<textarea wrap=hard cols=60 rows=3 style='display:none;'
name=Prothesis>%OPRWEB06.10.128
</textarea>
<textarea wrap=hard cols=60 rows=3 style='display:none;'
name=AnaeNote>%OPRWEB06.10.143.002</textarea>
<textarea wrap=hard cols=60 rows=3 style='display:none;'
name=WaitNote>%OPRWEB06.10.459</textarea>
</form>
<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=10>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value='%OPRWEB06.10.003'>
<input type=hidden name=admissno value='%OPRWEB06.10.081'>
<input type=hidden name=MenuType value='%OPRWEB06.10.088'>
<input type=hidden name=casekeys value='%OPRWEB06.10.101'>
<input type=hidden name=teamnumb value="1">
</form>
</div>

<div id="adverseEventDiv" name="adverseEventDiv"
     style="background-color:white;position:absolute;width:600px;height:100px;top:100px;right:10%;
            border:3px outset grey;display:none">
 <table width="100%" cellpadding="0" cellspacing="0">
   <tr class="DFrameTitleBar"><td colspan="2">Recovery Event</td></tr>
   <tr><td>&nbsp;</td></tr>
   <tr align="center" width="100%">
      <td width="60%">
         <span id="adverseText"><b>Did an adverse event occur?</b></span>
       </td>
       <td>
         <select class="Mandatory" id="adverseDropDown" name="adverseDropDown" >
           <option value="No">No</option>
           <option value="Yes">Yes</option>
         </select>
       </td>
   </tr>
   <tr></tr>
 </table>
 <br />
 <table width="100%">
   <tr width="100%" align="center">
     <td><input type="button"
                value="Ok"
                class="button"
                onclick="checkAdverseResponse();"
         />
     </td>
   </tr>
 </table>
</div>


<div id="ShowPrintReg" style="display:none;">
<table border=0 cellpadding=2 cellspacing=0 width="100%" align=center >
<tr><td class=DataLabel width=20%>Op Registration Form</td>
    <td class=DataField width=20%>
    <input type=checkbox name=printreg value="1"
    onclick="SetPrinter(UpdateForm.schdprnt);"></td>
    <td class=DataLabel width=20%>Printer</td>
    <td><select name=schdprnt title="Printer" class="SelectBig">
        <option></option>
        %STANDARD.01.001.IBAOPR45.01
        </select>
    </td>
    </tr>
</table>
</div>

<script type="text/javascript">
setStage1Recovery("%OPRWEB06.10.375");

if(isWhitespace(document.UpdateForm.opard080.value)) {
  document.UpdateForm.opard080.value = document.UpdateForm.exittime.value;
}

</script>
