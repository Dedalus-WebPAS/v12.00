<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="sjog-standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src=../js/TableSort.js></script>
<script type="text/javascript" src=../js/oprweb06.js></script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Columns Available
//  0 - Patient     
//  1 - U/R
//  2 - Theatre
//  3 - Surgeon
//  4 - Time into Recovery
//  5 - Date Time Stamp Link
//  6 - Ready to Depart   
//  7 - Exit Recovery Time
//  8 - Date Time Stamp Link
//  9 - Post Ward/Bed
//---------------------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
t = new Table(1,0,2,"100%","center",0,40);
t.addColumn("Patient","ImageText",0,0,"left","PatientFolder","12",150,11)
t.addColumn("U/R","String",1,1,"left","","",40)
t.addColumn("Theatre","String",2,2,"left","","",90)
t.addColumn("Surgeon","String",3,3,"left","TheatreSessionIcon.gif","14",100)
t.addColumn("Time into Recovery","String",4,4,"left","DateTimeStamp.gif","5",60)
t.addColumn("Ready to Depart","String",6,6,"left","DateTimeStamp.gif","13",50)
//t.addColumn("Estimated Discharge Time","String",10,10,"left","","",50)
t.addColumn("Exit Recovery Time","String",7,7,"left","DateTimeStamp.gif","5",60)
t.addColumn("Post Op Ward/Bed","String",9,9,"left","","",50)
 AddTableRows()
 TableOutput(0,1);
 break; }
 }
}

//overrides Standard.js DFrame function 
function DFrameSubmit(SubmitForm,FrameTop,FrameLeft,FrameWidth,FrameHeight)
{
  DFrameStart();
  SubmitForm.target="PopUpFrame";
  SubmitForm.submit();

  var PopUpScreen = document.getElementById('PopUpScreen');

  var MaxWidth  = document.body.clientWidth  - FrameLeft;
  var MaxHeight = document.body.clientHeight - FrameTop;
  var w = (FrameWidth  > MaxWidth)  ? MaxWidth  : FrameWidth;
  var h = FrameHeight;
  var top = FrameTop + document.body.scrollTop;

  PopUpScreen.style.top     = top + 'px';
  PopUpScreen.style.left    = FrameLeft + 'px';
  PopUpScreen.style.width   = w + 'px';
  PopUpScreen.style.height  = h + 'px';
  PopUpScreen.style.display = "";
}


function CaseLink(casekeys) {
  LinkForm.casekeys.value=casekeys;
  Left=(document.body.clientWidth-900)/2
  DFrameSubmit(LinkForm,0,Left,900,800);
}
function TheatreList() {
  location.href="oprweb03.pbl?reportno=1&template=4";
}
function SubmitPage() {
  SelectPeriod.submit();
}
function SetRecoveryFull() {
  if(SelectPeriod.d_recovful.checked==true) {
    SelectPeriod.recovful.value="1";
  } else {
    SelectPeriod.recovful.value="0";
  }
  RecoveryFull(SelectPeriod.surgtype,SelectPeriod.recovful,SubmitPage);
}

function setExitedRecoveryToday()
{
  if(SelectPeriod.d_exitRecoveryToday.checked == true)
    SelectPeriod.exttoday.value = "1";
  else
    SelectPeriod.exttoday.value = "0";

  SubmitPage();
}

function checkExttodayOnLoad()
{
  if(SelectPeriod.exttoday.value == "1")
    SelectPeriod.d_exitRecoveryToday.checked = true;
  else
    SelectPeriod.d_exitRecoveryToday.checked = false;

}

function PageLoadExtended()
{
 PageLoad();
 InitTable(0);
 SetCookiePath('Recovery');
 SetCookiePath('CasePath');
 SetReturnPathCookie();
 checkExttodayOnLoad();
 getCasekey();
}

function getCasekey() {
    var casekeys = getQueryString('casekeys');

    if(typeof casekeys != 'undefined' && casekeys != "") {
        //display popup msg - "Did an adverse event occur?"
          var adverseEventDiv = document.getElementById("adverseEventDiv");
          adverseEventDiv.style.display = "";
    }
}  

function checkAdverseResponse()
{
 var adverseDropDown = document.getElementById("adverseDropDown");
 var adverseEventDiv = document.getElementById("adverseEventDiv");
 var casekeys = document.getElementById("casekeys");
 var PatientURN = getQueryString("urnumber");
 var PatientVIS = getQueryString("admissno");
 var casekeys = getQueryString('casekeys');

 if(adverseDropDown.value == "Yes"){
   var url = "oprweb06.pbl?reportno=10&template=011";
   url += "&urnumber="+PatientURN;
   url += "&admissno="+PatientVIS;
   url += "&nodressg=1";
   url += "&casekeys="+casekeys;

   adverseEventDiv.style.display = "none";
   ShowDetail01(url);
 } else {
   adverseEventDiv.style.display = "none";
 }

}

function ShowDetail01(linkurl)
{
  Left=(document.body.clientWidth-900)/2
  var frame = document.getElementById("PopUpFrame");
  frame.style.overflow = "auto";
  frame.style.height = 600 +"px";

  DFrameLink(linkurl,0,Left,900,600)
}


 
</script>
</head>
%START.OF.PAGE
<body onload="PageLoadExtended();">
<div id=HeadingSection>
<form name=SelectPeriod action=oprweb06.pbl method=get style="margin:0">
<input type=hidden name=reportno value=10>
<input type=hidden name=template value=2>
<input type=hidden name=updatety value="E">
<input type=hidden name=viewtype value="%OPRWEB06.10.510">
<input type=hidden name=recovful value="">
<input type=hidden name=nodressg value="1">
<input type=hidden name=exttoday value="%OPRWEB06.10.515"/>
<input type=hidden name=dlyrsnrc value="%OPRWEB06.10.520">
<input type=hidden name=d_opcnvrrd value="%STANDARD.01.025.113.017.0.2"/>

<table cellpadding=3 cellspacing=0 bgcolor=#CCCCCC border=0 width=100%>
<tr><td>
   <img src=../images/ListIcon.gif class=Icon
    alt="Theatre List" onclick='TheatreList();'>
   &nbsp;
   <input type=button value="<<" class=SmallButton
   onclick='location.href="%OPRWEB06.10.502"'>
   %OPRWEB06.10.507
   <input type=button value=">>" class=SmallButton
   onclick='location.href="%OPRWEB06.10.501"'>
   &nbsp;&nbsp;
    %STANDARD.01.017.YD
   <select class=PMenuSelectList name=surgtype onchange='SelectPeriod.submit()'>
   <option value="ALL">All</option>
    %OPRWEB06.10.513.2
   </select>
   &nbsp;&nbsp;
   Recovery Full
   <input type=checkbox name=d_recovful value="1"
    onclick="SetRecoveryFull();">
   &nbsp;&nbsp;
      Exited Recovery
   <input type=checkbox name=d_exitRecoveryToday
          id="d_exitRecoveryToday"
          value="%OPRWEB06.10.515"
          onclick="setExitedRecoveryToday();"
          />
</td>
<td align=left id="displayrecovery" class="Red Bold Large">
</td>
<td align=right>
  <a href='javascript:SelectDateFrame();'>
  <img src="../images/DateLookup.gif" class="Icon"
   alt="Select Date"></a>
  <a href='javascript:SelectView("0");'>
  <img src=../images/DayIcon.gif class="Icon"
   alt="View Today"></a>
  <a href='javascript:SelectView("1");'>
  <img src=../images/WeekIcon.gif class="Icon"
   alt="View This Week"></a>
  <a href='javascript:SelectView("2");'>
  <img src=../images/MonthIcon.gif class="Icon"
   alt="View This Month"></a>
</td></tr>
</table>
</form>

<form name=LinkForm method=get action=oprweb06.pbl style="margin:0">
<input type=hidden name=reportno value=10>
<input type=hidden name=template value=3>
<input type=hidden name=nodressg value="1">
<input type=hidden name=casekeys >
</form>
</div>
<div id=TableLocation></div>
<script type="text/javascript">
function AddTableRows() {
 %OPRWEB06.10.511.oprweb06.10.003
}
document.getElementById('displayrecovery').innerHTML="";
if(SelectPeriod.surgtype.value!="ALL") {
  if(SelectPeriod.surgtype.value.substr(14,1)=="F") {
    SelectPeriod.d_recovful.checked=true;
    document.getElementById('displayrecovery').innerHTML="RECOVERY FULL";
  } 
} else {
 rec_full=true
 for (var i =0 ; i < SelectPeriod.surgtype.length; i++) {
  if (SelectPeriod.surgtype.options[i].value.substr(0,3)!="ALL" &&
      SelectPeriod.surgtype.options[i].value.substr(14,1)!="F") {
      rec_full=false} };
  if(rec_full) {
    SelectPeriod.d_recovful.checked=true;
    document.getElementById('displayrecovery').innerHTML="RECOVERY FULL";
  }
}
</script>
<div id="adverseEventDiv" name="adverseEventDiv"
     style="background-color:white;position:absolute;width:600px;height:100px;top:100px;right:25%;
            border:3px outset grey;display:none">
 <table width="100%" cellpadding="0" cellspacing="0">
   <tr class="DFrameTitleBar"><td colspan="2">Recovery Event</td></tr>
   <tr><td>&nbsp;</td></tr>
   <tr align="center" width="100%">
      <td width="60%">
         <span id="adverseText"><b>Did an adverse event occur?</b></span>
       </td>
       <td>
         <select class="Mandatory" id="adverseDropDown" name="adverseDropDown" >
           <option value="No">No</option>
           <option value="Yes">Yes</option>
         </select>
       </td>
   </tr>
   <tr></tr>
 </table>
 <br />
 <table width="100%">
   <tr width="100%" align="center">
     <td><input type="button"
                value="Ok"
                class="button"
                onclick="checkAdverseResponse();"
         />
     </td>
   </tr>
 </table>
</div>
    
