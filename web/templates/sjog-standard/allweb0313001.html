<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome"    content="sjog-standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript" src="../js/allweb03.js"></script>
<script type="text/javascript">
function PackComments(){
AddForm.alenc107.value=AddForm.comments.value.substring(0,80);
AddForm.alenc108.value=AddForm.comments.value.substring(80,160);
}
function GetBookings() {
  p=parent
  if(!isWhitespace(AddForm.bulkenck.value)) {
    if(p.UpdateStatus==undefined) {
      p=parent.parent
    }
    Appointments.innerHTML+="<input type=hidden name=bulkekey id=bulkekey" +
                            " value='" + AddForm.bulkenck.value + "'>"
    if(p.UpdateStatus.d_multic!=undefined) {
      if(p.UpdateStatus.d_multic.value=="1"){
         p.UpdateStatus.othedurn.value=document.AddForm.d_othedurn.value;
         p.UpdateStatus.xocadoct.value=document.AddForm.d_xocadoct.value;
      }
    }
    if (p.UpdateStatus.othedurn!=undefined) {
      calculateDirectUnits();
    }
//
    if(p.SelectPeriod.sesskeys!=undefined) {
      EDate=p.SelectPeriod.sesskeys.options[p.SelectPeriod.sesskeys.selectedIndex].text;
      document.AddForm.alenc005.value=EDate.substr(4,11);
    } else {
      if(p.SelectPeriod.lastdate!=undefined) {
        if (!isWhitespace(p.SelectPeriod.lastdate.value)) {
//        alert(p.SelectPeriod.lastdate.value.substr(0,4));
          document.AddForm.alenc005.value = 
          p.SelectPeriod.lastdate.value.substr(6,2) + " " +
          GetMonthName(p.SelectPeriod.lastdate.value.substr(4,2)) + " " +
          p.SelectPeriod.lastdate.value.substr(0,4); 
        }
      }
    }

    if(!isWhitespace(p.UpdateStatus.xocadoct.value)) {
      document.AddForm.alenc004.value=p.UpdateStatus.xocadoct.value;
      ValidateHCP(18,0,AddForm.alenc004,AddForm.SProvider);
    }
//
    DefaultCMBSItemEnc(AddForm.d_obavisit,AddForm.d_slotkey) 
    document.AddForm.AddButton.disabled=false;
    return;
  }
  Flag=0
  Appointments.innerHTML="";
  for (var e = 0; e < parent.UpdateForm.elements.length; e++) {
    var el=parent.UpdateForm.elements[e] ;
    if(el.name.match(/referral/) && el.checked==true) {
    Appointments.innerHTML+="<input type=hidden name=bulkekey id=bulkekey" +
                            " value='" + el.value + "'>"
    }
  }

  if (parent.UpdateForm.othedurn!=undefined) {
    document.AddForm.alenc011.value=parent.UpdateForm.othedurn.value;
  }
//
    if(p.SelectPeriod.sesskeys!=undefined) {
    EDate=p.SelectPeriod.sesskeys.options[p.SelectPeriod.sesskeys.selectedIndex].text;
    document.AddForm.alenc005.value=EDate.substr(4,11);
    } else {
      document.AddForm.alenc005.value=p.UpdateStatus.dateclin.value;
    }
  if(!isWhitespace(parent.SelectPeriod.xocadoct.value)) {
    document.AddForm.alenc004.value=parent.SelectPeriod.xocadoct.value;
    ValidateHCP(18,0,AddForm.alenc004,AddForm.SProvider);
  }
//
  document.AddForm.AddButton.disabled=false;
}
function calculateDirectUnits() {
  document.AddForm.alenc011.value=p.UpdateStatus.othedurn.value;
//
  slots=(trim(document.AddForm.dd_obavisit.value.substr(22,6)));
  duration=(trim(p.UpdateStatus.othedurn.value));
  if(isWhitespace(slots) || isWhitespace(duration)) {
     return;
  }
  slots = parseInt(slots,10);
  duration = parseInt(duration,10);
  if(slots==0 || slots==1 || duration==0) {
    return;
  }
  total_duration = slots * duration;
  document.AddForm.alenc011.value=total_duration;
}
function AddEncounter() {
    if(!validateContactTime()) { return; }
    if(!checkFutureContactTime()) { return; }
    if(AddForm.checkbx3.checked==true){
      AddForm.nextpage.value="4";
      AddForm.redirect.value="allweb02.pbl?reportno=02&template=002" +
             "&urnumber=" + AddForm.urnumber.value.replace(/ /g,"+") +
           "&admissno=" + AddForm.bulkenck.value.substr(0,8).replace(/ /g,"+") +
             "&deptcode=" + AddForm.deptcode.value.replace(/ /g,"+");
      if (parent.name=="PopUpFrame") {
        document.AddForm.nextpage.value="7";
      }

//  Create cookie for close referral dframe redirect

      closereferralstring="allweb02.pbl?reportno=02&template=004" +
             "&urnumber=" + AddForm.urnumber.value.replace(/ /g,"+") +
           "&admissno=" + AddForm.bulkenck.value.substr(0,8).replace(/ /g,"+") +
             "&deptcode=" + AddForm.deptcode.value.replace(/ /g,"+");


      SetCookie("CloseReferralCookie",closereferralstring);

    }

  getCheckInTimeCookie();
  getTimeSeenCookie();
  getDepartureTimeCookie();
  SubmitHidden(AddForm);
}
</script>
</head>

%START.OF.PAGE
<body onload="PageLoad(event);GetBookings();CommonContact(AddForm);">
<span class=DFrameTitleBar>
<img border=0 align=right src="../images/ExitIcon.gif"
 onclick="DFrameExitRefresh()">
Add Contact for %ALLWEB03.13.017 %ALLWEB03.13.216 %ALLWEB03.13.217
</span>

<form name=AddForm id=AddForm action="allweb03.pbl" method=post>
<input type=hidden name=reportno id=reportno value=13>
<input type=hidden name=deptcode id=deptcode value="%ALLWEB03.13.012">
<input type=hidden name=deptlcod id=deptlcod value="%ALLWEB03.13.036.3">
<input type=hidden name=updatety id=updatety value="A">
<input type=hidden name=flag id=flag value="%ALLWEB03.13.023">
<input type=hidden name=alenc107 id=alenc107 value="">
<input type=hidden name=alenc108 id=alenc108 value="">
<input type=hidden name=bulkenck id=bulkenck value="%ALLWEB03.13.030">
<input type=hidden name=alcndoos id=alcndoos value="%STANDARD.01.025.106.226.0.1">
<input type=hidden name=redirect id=redirect value="">
<input type=hidden name=urnumber id=urnumber value="%ALLWEB03.13.015">
<input type=hidden name=admissno id=admissno value="%ALLWEB03.13.035">
<input type=hidden name=nextpage id=nextpage value="">
<input type=hidden name=urnockie id=urnockie value="">
<input type=hidden name=admnckie id=admnckie value="">
<input type=hidden name=rwnockie id=rwnockie value="">
<input type=hidden name=clnockie id=clnockie value="">
<input type=hidden name=caseckie id=caseckie value="">
<input type=hidden name=dummyret id=dummyret value="">
<input type=hidden name=dummysit id=dummysit value="">
<input type=hidden name=mbs id=mbs value="M">
<input type=hidden name=lnkoctyp id=lnkoctyp value="%ALLWEB03.13.205">
<input type=hidden name=prevcomp id=prevcomp value="%ALLWEB03.13.207">
<input type=hidden name=d_otbbcitm id=d_otbbcitm value="%ALLWEB03.13.038">
<input type=hidden name=d_obavisit id=d_obavisit value="%ALLWEB03.13.039">
<input type=hidden name=dd_obavisit id=dd_obavisit value="%ALLWEB03.13.041.3">
<input type=hidden name=d_slotkey id=d_slotkey value="%ALLWEB03.13.040">
<input type=hidden name=currdate id=currdate value="">
<input type=hidden name=currtime id=currtime value="">
<input type=hidden name=d_alrecomp id=d_alrecomp value="%ALLWEB03.13.535.1">
<input type=hidden name=d_obacomp id=d_obacomp value="%ALLWEB03.13.225">
<input type=hidden name=d_othedurn id=d_othedurn value="%ALLWEB03.13.227">
<input type=hidden name=d_xocadoct id=d_xocadoct value="%ALLWEB03.13.226.1">

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td>
    <div id=Appointments></div>
    </td></tr>

<tr><td class=DataLabel width=15%>Department</td>
    <td><input type=text readonly size=40 name=dept id=dept class="ReadOnly" tabindex=-1
         value="%ALLWEB03.13.017">
    </td>
    <td class=DataLabel width=15%>Entered By</td>
    <td>
    <input type=text readonly size=25 name=usnm id=usnm class="ReadOnly" tabindex=-1
     value="%STANDARD.01.009">
    </td>
    </tr>

<tr><td class=DataLabel>Contact Date</td>
    <td class=DataLabel>
    <input type=text readonly name=alenc005 id=alenc005 value="" tabindex=-1
     title="Contact Date" class="ReadOnly" Size=12
     onblur="checkDate(this,'Date');">
     Time
    <input type=text size=8 title="Time" value="" class="Mandatory"
     name=alenc006 id=alenc006 tabindex=1>
    <img notab src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(null,alenc006);">
    <img src="../images/TimeLookup.gif" class=Icon
     onclick="TimeLookupFrame(alenc006);">
    </td>
    <td class=DataLabel>Linked Visit Number</td>
    <td colspan=3>
    <input type=text size=20 readonly name=lvis id=lvis
     value="" class=Readonly tabindex=-1>
    </td>
    </tr>

<tr><td class=DataLabel>Health Care Provider</td>
    <td class=DataLabel colspan=3>
    <input type=text name=alenc004 id=alenc004 size=10 maxlength=10 class=Mandatory
     onblur="ValidateHCP(18,0,alenc004,SProvider);"
     title="Health Care Provider" tabindex=2>
    <input type=text name=SProvider id=SProvider size=25 class=Readonly readonly
      title="Health Care Provider" tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="HCPSearchFrame(alenc004,SProvider,0);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(alenc004,SProvider);">
    </td>
    </tr>

<tr><td class=DataLabel>Direct Units</td>
    <td class=DataField>
    <input type=text size=12 name=alenc011 id=alenc011 maxlength=6 
      class=Mandatory title="Direct Units" tabindex=3
      onblur="checkInteger(this,this.title);"></td>
    <td class=DataLabel>Indirect Units</td>
    <td class=DataField><input type=text size=12 name=alenc013 id=alenc013 maxlength=6 
      tabindex=9
      onblur="checkInteger(this,this.title);"></td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td class=DataField><select class="Mandatory SelectBig" tabindex=4
        name=alenc115 id=alenc115 title="%STANDARD.01.017.CL">
    <option></option>
    %ALLWEB03.13.176.2
    </select>
    </td>
    <td class=DataLabel>Travel Time</td>
    <td class=DataField>
    <input type=text size=12 maxlength=8 name=alenc106 id=alenc106 title="Travel time" min=0
     tabindex=10
    onblur="checkInteger(this,this.title)"></td>
    </tr>

<tr><td class=DataLabel>Client Present Status</td>
    <td class=DataField>
    <select class="Mandatory SelectBig" name=alenc083 id=alenc083 tabindex=5
     title="Client Present Status">
    <option></option>
     %ALLWEB03.13.147.37.5
    </select></td>
    <td class=DataLabel>Service Activity 1</td>
    <td class=DataField>
    <input type=text size=10 name=itemn001 id=itemn001 title="Service Activity 1"
     tabindex=11
     onblur="validatePMBS(itemn001,dummy);">
    <input type=text size=20 name=dummy id=dummy value="" readonly class=Readonly
     tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="PriMbsSearchFrame(dummyret,itemn001,dummysit,dummyret,dummy,mbs)">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(itemn001,dummy);">
    </td></tr>

<tr><td class=DataLabel>Delivery Mode</td>
    <td class=DataField><select class="Mandatory SelectBig" name=alenc084 id=alenc084
       title="Delivery Mode" tabindex=6>
      <option></option>
      %ALLWEB03.13.147.38.5
      </select></td>
    <td class=DataLabel>Service Activity 2</td>
    <td class=DataField>
    <input type=text size=10 name=itemn002 id=itemn002 title="Service Activity 2"
     tabindex=12
     onblur="validatePMBS(itemn002,dummy2);">
    <input type=text size=20 name=dummy2 id=dummy2 value="" readonly class=Readonly
     tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
    onclick="PriMbsSearchFrame(dummyret,itemn002,dummysit,dummyret,dummy2,mbs)">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(itemn002,dummy2);">
    </td></tr>

<tr><td class=DataLabel>Delivery Setting</td>
    <td class=DataField><select class="Mandatory SelectBig" name=alenc086 id=alenc086
       title="Delivery Setting" tabindex=7>
      <option></option>
      %ALLWEB03.13.147.40.5
      </select>
    </td>
    <td class=DataLabel>Service Activity 3</td>
    <td class=DataField>
    <input type=text size=10 name=itemn003 id=itemn003 title="Service Activity 3"
     tabindex=13
     onblur="validatePMBS(itemn003,dummy3);">
    <input type=text size=20 name=dummy3 id=dummy3 value="" readonly class=Readonly
     tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
    onclick="PriMbsSearchFrame(dummyret,itemn003,dummysit,dummyret,dummy3,mbs)">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(itemn003,dummy3);">
    </td></tr>

<tr><td class=DataLabel>Session Type</td>
    <td class=DataField><select class="Mandatory SelectBig" name=alenc081 id=alenc081
       title="Session Type" tabindex=8>
      <option></option>
      %ALLWEB03.13.147.35.5
      </select>
    </td>
    <td class=DataLabel>Service Activity 4</td>
    <td class=DataField>
    <input type=text size=10 name=itemn004 id=itemn004 title="Service Activity 4"
     tabindex=14
     onblur="validatePMBS(itemn004,dummy4);">
    <input type=text size=20 name=dummy4 id=dummy4 value="" readonly class=Readonly
     tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
    onclick="PriMbsSearchFrame(dummyret,itemn004,dummysit,dummyret,dummy4,mbs)">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(itemn004,dummy4);">
    </td></tr>

<tr><td class=DataLabel>The Patient is being discharged</td>
    <td class=DataField>
        <input type=checkbox name=checkbx3 id=checkbx3 value="1" tabindex=20></td>
    <td class=DataLabel>Service Activity 5</td>
    <td class=DataField>
    <input type=text size=10 name=itemn005 id=itemn005 title="Service Activity 5"
     tabindex=15
     onblur="validatePMBS(itemn005,dummy5);">
    <input type=text size=20 name=dummy5 id=dummy5 value="" readonly class=Readonly
     tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
    onclick="PriMbsSearchFrame(dummyret,itemn005,dummysit,dummyret,dummy5,mbs)">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(itemn005,dummy5);">
    </td></tr>

<tr><td class=DataLabel></td>
    <td class=DataField></td>
    <td class=DataLabel>Service Activity 6</td>
    <td class=DataField>
    <input type=text size=10 name=itemn006 id=itemn006 title="Service Activity 6"
     tabindex=16
     onblur="validatePMBS(itemn006,dummy6);">
    <input type=text size=20 name=dummy6 id=dummy6 value="" readonly class=Readonly
     tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
    onclick="PriMbsSearchFrame(dummyret,itemn006,dummysit,dummyret,dummy6,mbs)">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(itemn006,dummy6);">
    </td></tr>

<tr><td class=DataLabel>Comments</td>
    <td class=DataField colspan=3>
    <textarea rows=3 cols=60 onblur="PackComments()" name=comments id=comments
     tabindex=30 onkeydown="LimitText(this,3,160);"></textarea>
    </td></tr>

<tr><td class=DataLabel>Additional HCP</td>
    <td><input type=checkbox name=addithcp id=addithcp value="1" tabindex=31
         onclick="CheckAddHCP();">
    </td></tr>
</table>

<div id=AdditionalHCP></div>

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td colspan=4 align=center><br>
    <input type=button value="Add" class="button" tabindex=100
     disabled name=AddButton id=AddButton onclick="AddEncounter()">
    <input type=button Value="Cancel" class="button" tabindex=101
     onclick="DFrameCloseRefresh();">
    </td></tr>
</table>
</form>

<span id="ShowAdditionalHCP" style="display:none;">
<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td class=DataLabel width=15%>Additional HCP 1</td>
    <td><input type=text name=alenc025 id=alenc025 size=10 maxlength=10
         title="Additional HCP 1" tabindex=40
         onblur="ValidateHCP(18,0,alenc025,d_alenc025);">
        <input type=text name=d_alenc025 id=d_alenc025 size=20 class=Readonly readonly
         title="Additional HCP 1">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(alenc025,d_alenc025,0);">
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(alenc025,d_alenc025);">
    </td>
    <td class=DataLabel width=15%>Additional HCP 2</td>
    <td><input type=text name=alenc026 id=alenc026 size=10 maxlength=10
         title="Additional HCP 2" tabindex=42
         onblur="ValidateHCP(18,0,alenc026,d_alenc026);">
        <input type=text name=d_alenc026 id=d_alenc026 size=20 class=Readonly readonly
         title="Additional HCP 2">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(alenc026,d_alenc026,0);">
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(alenc026,d_alenc026);">
    </td></tr>

<tr><td class=DataLabel>Additional HCP 3</td>
    <td><input type=text name=alenc027 id=alenc027 size=10 maxlength=10
         title="Additional HCP 3" tabindex=43
         onblur="ValidateHCP(18,0,alenc027,d_alenc027);">
        <input type=text name=d_alenc027 id=d_alenc027 size=20 class=Readonly readonly
         title="Additional HCP 3">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(alenc027,d_alenc027,0);">
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(alenc027,d_alenc027);">
    </td>
    <td class=DataLabel>Additional HCP 4</td>
    <td><input type=text name=alenc028 id=alenc028 size=10 maxlength=10
         title="Additional HCP 4" tabindex=44
         onblur="ValidateHCP(18,0,alenc028,d_alenc028);">
        <input type=text name=d_alenc028 id=d_alenc028 size=20 class=Readonly readonly
         title="Additional HCP 4">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(alenc028,d_alenc028,0);">
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(alenc028,d_alenc028);">
    </td></tr>
</table>
</span>

<script type="text/javascript">
 document.AddForm.lvis.value=document.AddForm.bulkenck.value.substr(8,16);
 if(!isWhitespace(document.AddForm.d_obacomp.value)) {
   for(var i =0 ; i < document.AddForm.alenc115.length; i++) {
    if(document.AddForm.alenc115.options[i].value.substr(0,3) ==
       document.AddForm.d_obacomp.value) {
       document.AddForm.alenc115.selectedIndex=i }
   }
 }
</script>
