<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="private">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript">
function UpdateCondition(urnumber,admissno) {
  linkurl="patweb93.pbl?reportno=5&template=002" +
          "&urnumber=" + urnumber + "&admissno=" + admissno;

  Width=1000;
  Height=500;
  Left=(document.body.clientWidth-Width)/2;
  DFrameLink(linkurl,50,Left,Width,Height);
}
function TickPrintAll() {
  var c = new Array();
  c = document.getElementsByTagName('INPUT');

  for (var i = 0; i < c.length; i++) {
    if (c[i].type == 'checkbox') {
      if (c[i].name.substring(0,5) == 'prt00') {
        if (document.SelectPeriod.printall.checked==true) {
          c[i].checked=true;
        } else {
          c[i].checked=false;
        }
      }
    }
  }
}
function NotPrintAll() {
  document.SelectPeriod.printall.checked=false;
}
function GoProcess() {
  var printstat = ChkPrtBox();

  if (printstat==true) {
    var serverURL = "../cgi-bin/patweb62.pbl?reportno=4" +
                    "&progname=PATWEB71" +
                    "&reptnumb=19" +
          "&prntcode=" + document.SelectPeriod.selprint.value.replace(/ /g,"+");

    if (IEBrowser) {
      var returnValue = RSExecute(serverURL);

      if (returnValue.status==0) {
        SubmitPrintJobs();
      }
    }
    else {
      var returnValue = RSExecuteFetch(serverURL);

      returnValue.then(
        function (returnValue) {
          returnValue = ParseFetchData(returnValue);  // parse fetch() result

          if (returnValue.status==0) {
            SubmitPrintJobs();
          }
        }
      );
    }
  }
}
function SubmitPrintJobs() {
  var c = new Array();
  c = document.getElementsByTagName('INPUT');

  for (var i = 0; i < c.length; i++) {
    if (c[i].type == 'checkbox') {
      if (c[i].name.substring(0,5) == 'prt00') {
        y=(c[i].name);
        x= 'adm00' + c[i].name.substring(5,8);

        if (c[i].checked==true) {
          AddField(y,1);
          AddField(x,c[i].value);
        } else {
          AddField(y,0);
          AddField(x,c[i].value);
        }
      }
    }
  }

  document.PrintForm.selprint.value=document.SelectPeriod.selprint.value;
  SubmitHidden(PrintForm);
}
function ChkPrtBox() {
  var c = new Array();
  c = document.getElementsByTagName('INPUT');
  for (var i = 0; i < c.length; i++) {

   if (c[i].type == 'checkbox') {
    if (c[i].name.substring(0,5) == 'prt00' && c[i].checked==true) {
        return true;
    }
   }
  }
  alert('No Patient selected.');
  return false;
}
function AddField(a,b) {
  var the_field;
  var billingForm = document.getElementById('PrintForm');

  the_field = document.createElement('INPUT');
  the_field.setAttribute('type','hidden');
  the_field.setAttribute('name',a);
  the_field.id = a;
  the_field.setAttribute('value',b);
  the_field.value = b;
  billingForm.appendChild(the_field);
}
function CheckPrint() {
  if (document.SelectPeriod.deftview.value == "1") {
    document.getElementById('BillStat').innerHTML =
      document.getElementById('PrtBillStat').innerHTML;
  } else {
    document.getElementById('BillStat').innerHTML = "";
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="initTable(%PATWEB93.11.016);">
<div id=HeadingSection>
<form name=SelectPeriod action=patweb93.pbl method=get style="margin:0">
<input type=hidden name=reportno value=11>
<input type=hidden name=template value=1>
<input type=hidden name=viewtype value="%PATWEB93.11.011">
<input type=hidden name=deftview value="%PATWEB93.11.016">

<table cellpadding=3 bgcolor=#CCCCCC border=0 width=100%>
<tr>
  <td>
    <img src="../images/TableViewIcon.gif" class=Icon
     alt="Default View" title="Default View"
     onclick='initTable(0);CheckPrint();'>
    <img src="../images/TableViewIcon.gif" class=Icon
     alt="View 1" title="View 1" 
     onclick='initTable(1);CheckPrint();'>
  </td>
  <td class=DataLabel>Discharge Preparation Status&nbsp;&nbsp;
    <select name=filtdpst class=SelectMed title="Discharge Preparation Status"
     onchange="SelectPeriod.submit();">
      <option value="">All</option>
      %PATWEB93.11.013.2
    </select>
  </td>
  <td class=DataLabel>Claim Code&nbsp;&nbsp;
    <select name=filtclai class=SelectMed title="Claim Code"
     onchange="SelectPeriod.submit();">
      <option value="  ">ALL</option>
      %PATWEB93.11.014.2
    </select>
  </td>
  <td class=DataLabel>Ward&nbsp;&nbsp;
    <select name=wardcode class=SelectMed title="Ward"
     onchange="SelectPeriod.submit();">
      <option value="  ">ALL</option>
      %PATWEB93.11.015
    </select>
  </td>
  <td>
    <div id=BillStat></div>
  </td>
  <td align=right>
    <input type=button value="<<" class=SmallButton title="Previous"
     onclick='location.href="%PATWEB93.11.002"'>
    %PATWEB93.11.007
    <input type=button value=">>" class=SmallButton title="Next"
     onclick='location.href="%PATWEB93.11.001"'>
    <a href='javascript:SelectDateFrame();'>
    <img src="../images/DateLookup.gif" class=Icon 
     alt="Select Date" title="Select Date"></a>
    <a href='javascript:SelectView("0");'>
    <img src="../images/DayIcon.gif" class=Icon
     alt="View Today" title="View Today"></a>
    <a href='javascript:SelectView("1");'>
    <img src="../images/WeekIcon.gif" class=Icon 
     alt="View This Week" title="View This Week"></a>
    <a href='javascript:SelectView("2");'>
    <img src="../images/MonthIcon.gif" class=Icon 
     alt="View This Month" title="View This Month"></a>
  </td>
</tr>
</table>

</form>
</div>

<div id=TableLocation></div>

<span id=PrtBillStat style="display:none">
  Select all to Print Billing Statement
  <input type=checkbox name=printall value="0" onclick="TickPrintAll();">
  &nbsp;&nbsp;Printer
  <select class="Mandatory" name="selprint" title="Printer">
    %STANDARD.01.001.PATWEB71.19
  </select>&nbsp;
  <input type=button value="Go" class=SlimButton id=Gobutton name=Gobutton 
         onclick="tempDisable(this);GoProcess();">
</span>

<span>
  <input type=hidden name=selprint value="">
</span>

<script type="text/javascript">
function initTable(TableView) {
 document.title="Expected Discharges " 
 t = new Table(1,0,1,"100%","center",30,45);    // Create New Table Object
 template = 1

switch (TableView) {
case 0: {
  document.SelectPeriod.deftview.value="0";
//
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column,Align
//
 t.addColumn("Patient Name","ImageText",0,0,"left","PatientFolder","8",140,15)
 t.addColumn("U/R","String",10,10,"left","","",30)
 t.addColumn("Doctor","String",4,4,"left","","",90)
 t.addColumn("Ward/Bed","String",11,11,"left","","",30)
 t.addColumn("Diagnosis","String",3,3,"left","","",70)
 t.addColumn("Patient Condition","ImageText",13,13,"left","","12",90,14)
 t.addColumn("%STANDARD.01.017.U2","String",18,18,"left","","",55)
 t.addColumn("Discharge Preparation Status","String",17,17,"left","","",55)
 t.addColumn("Exp Disch.Date","DateTime",9,9,"left","","",80,"","","",16)
 AddTableRows()
 TableOutput(3,1);    // By Ward
 t.sortTable(2,1);    // By Doctor
 t.sortTable(6,1);    // By Date
 break; }

case 1: {
 document.SelectPeriod.deftview.value="1";
 t = new Table(1,0,1,"100%","center",30,45);    // Create New Table Object
 t.addColumn("Patient Name","ImageText",0,0,"left","PatientFolder","8",140,15)
 t.addColumn("Doctor","String",4,4,"left","","",90)
 t.addColumn("Ward/Bed","String",11,11,"left","","",50)
 t.addColumn("Diagnosis","String",3,3,"left","","",70)
 t.addColumn("Patient Condition","ImageText",13,13,"left","","12",90,14)
 t.addColumn("%STANDARD.01.017.U2","String",18,18,"left","","",40)
 t.addColumn("Discharge Preparation Status","String",17,17,"left","","",55)
 t.addColumn("Claim Code","String",19,19,"left","","",40)
 t.addColumn("Health Fund","String",20,20,"left","","",40)
 t.addColumn("Total OOP","String",21,21,"right","","",40)
 t.addColumn("Payment Received","String",22,22,"right","","",40)
 t.addColumn("Print Billing Statement","String",23,23,"center","","",50)
 t.addColumn("Exp Disch.Date","DateTime",9,9,"left","","",80,"","","",16)
 AddTableRows()
 TableOutput(2,1);    // By Ward
 t.sortTable(1,1);    // By Doctor
 t.sortTable(5,1);    // By Date
 break; }
 }
}

function AddTableRows() {
  %PATWEB93.11.008.patweb98.01.001
}
//

CheckPrint();
</script>

<form name=PrintForm id=PrintForm method=post action=patweb71.pbl
 style="margin:0">
  <input type=hidden name=reportno value=19>
  <input type=hidden name=template value=036>
  <input type=hidden name=nextpage value="0">
  <input type=hidden name=admissno value="">
  <input type=hidden name=selprint value="">
 <input type=hidden name=redirect value="patweb93.pbl?reportno=11&template=001">
</form>
