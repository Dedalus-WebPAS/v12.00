<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="private">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/outweb01.js"></script>
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientTypeClinic.js"></script>
<script type="text/javascript">
function SetLists() {
 SetClinicType(SelectPeriod.clinicty,SelectPeriod.defctype.value,SelectPeriod.usersite.value);
 SetLists2()
}
function SetLists2() {
 p=SelectPeriod
 p.clinicid.options.length=1;
 SetTypeClinic(p.clinicid,p.deftclid.value,p.usersite.value,p.clinicty.value);
 setVisitTypeList(p.usersite,p.clinicty,p.visittyp,p.deftvtyp);
}
function SubmitSearch() {
  if(isWhitespace(SelectPeriod.clinicty.value) && 
     isWhitespace(SelectPeriod.clinicid.value)) {
     alert("Clinic Type or Clinic ID are mandatory for search.");
     return;
  }
//
  if(SelectPeriod.deftovrd.value=="1") { // Don't Allow override of ref default
    if(!isWhitespace(SelectPeriod.defctype.value)) {
      if(SelectPeriod.defctype.value == SelectPeriod.clinicty.value) {
         SelectPeriod.submit();
         return;
      }
    }
    if(!isWhitespace(SelectPeriod.deftclid.value)) {
      if(SelectPeriod.deftclid.value == SelectPeriod.clinicid.value) {
         SelectPeriod.submit();
         return;
      }
    }
    if(!isWhitespace(SelectPeriod.defctype.value) ||
       !isWhitespace(SelectPeriod.deftclid.value)) { 
       alert("Invalid referral clinic type & clinic for search .");
       return;
    }
  }
//
  SelectPeriod.submit();
}
</script>

</head>
%START.OF.PAGE
<body onload="PageLoad(event);self.focus();setTimeout('SetLists()',100);">

<span class=DFrameTitleBar>
<img border=0 align=right src=../images/ExitIcon.gif onclick="SearchFrameExit()">
Appointment Search
</span>

<div id=PageBodySection style="background-color:#cccccc;height:100%;">
<form name=SelectPeriod action=outweb01.pbl method=get target=SearchResults>
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=3>
<input type=hidden name=srchflag value=1>
<input type=hidden name=defctype value="%OUTWEB01.02.012">
<input type=hidden name=deftclid value="%OUTWEB01.02.009.1">
<input type=hidden name=deftovrd value="%OUTWEB01.02.013">
<input type=hidden name=deftvtyp value="%OUTWEB01.02.016">
<input type=hidden name=usersite value="%STANDARD.01.023">
<input type=hidden name=srchrefn value="%OUTWEB01.02.014">
<input type=hidden name=mosaiqrs value="%OUTWEB01.02.017">

<table width="90%" align=center cellpadding=0 cellspacing=0 border=0>
<tr><td class=DataLabel>Clinic Type</td>
    <td><select name=clinicty onchange="SetLists2();">
        <option></option>
        </select></td>
    <td class=DataLabel>Search from</td>
    <td><select name=srchperd>
        <option value="   ">Today</option>
        <option value="01D">Tomorrow</option>
        <option value="02D">After 2 days</option>
        <option value="03D">After 3 days</option>
        <option value="04D">After 4 days</option>
        <option value="05D">After 5 days</option>
        <option value="06D">After 6 days</option>
        <option value="01W">After 1 week</option>
        <option value="02W">After 2 weeks</option>
        <option value="03W">After 3 weeks</option>
        <option value="04W">After 4 weeks</option>
        <option value="05W">After 5 weeks</option>
        <option value="06W">After 6 weeks</option>
        <option value="07W">After 7 weeks</option>
        <option value="08W">After 8 weeks</option>
        <option value="01M">After 1 month</option>
        <option value="02M">After 2 months</option>
        <option value="03M">After 3 months</option>
        <option value="04M">After 4 months</option>
        <option value="05M">After 5 months</option>
        <option value="06M">After 6 months</option>
        <option value="07M">After 7 months</option>
        <option value="08M">After 8 months</option>
        <option value="09M">After 9 months</option>
        <option value="10M">After 10 months</option>
        <option value="11M">After 11 months</option>
        <option value="12M">After 12 months</option>
        </select>
        </td></tr>

<tr><td class=DataLabel>Clinic</td>
    <td><select name=clinicid>
        <option></option>
        </select></td>

    <td class=DataLabel>Time</td>
    <td><select name=srchtime>
        <option value="00:0024:00"></option>
        <option value="07:0012:00">Morning</option>
        <option value="12:0018:00">Afternoon</option>
        <option value="18:0024:00">Evening</option>
        </select>
        </td></tr>
<tr><td class=DataLabel>Visit Type</td>
    <td><select name=visittyp>
        <option></option>
        </select></td>
    <td></td>
    <td>
    <script type="text/javascript">
      if(%STANDARD.01.044.032.144.001){
         document.write("&nbsp;");
      }
      else{
         document.write("<input type=button class='button' value='Search' onclick='SubmitSearch();'>");
      }
    </script>
    </td></tr>
    <script type="text/javascript">
      if(%STANDARD.01.044.032.144.001){
         document.write("<tr style='visiiblity:visible'>");
      }
      else{
         document.write("<tr style='visibility:hidden'>");
      }
    </script>
    <td class=DataLabel>Location</td>
    <td>
      <select name=srchltyp onchange="SubmitSearch();">
        <option value=""></option>
        %STANDARD.01.007.CT
      </select>
    </td>
    <td>
      <input type=button class="button" value="Search" 
       onclick="SubmitSearch();">
    </td>
  </tr>
</table>
</form>
</div>

<script type="text/javascript">
  if(%STANDARD.01.044.032.144.001){
     locationCode = "%OUTWEB02.01.026";
     ds = document.SelectPeriod;

     for(i=0; i<ds.srchltyp.length; i++) {
         if(ds.srchltyp.options[i].value.substr(0,3)==locationCode){
            ds.srchltyp.selectedIndex = i;
         }
     }
  }
</script>

