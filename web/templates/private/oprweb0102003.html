<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="private">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript">
function SessionLink(SessionKey,FinalDate) {
 if (!isWhitespace(FinalDate)) {
   alert("ERROR - Session is finalized - No new bookings can be made.\n" +
         "Please reset to Provisional to make changes to this session.");
 }
 else {

   if (typeof parent.sjogprtl != 'undefined' && parent.sjogprtl == "1") {
     SetCookie("sjogwaPortalCOOKIE","");
   }

   if (!isWhitespace(document.SelectPeriod.bkthurck.value)) {
     parent.LinkForm.urnumber.value=
     document.SelectPeriod.bkthurck.value.replace(/\+/g," ");
     parent.LinkForm.reportno.value=9;
     parent.LinkForm.template.value=2;
   }

   parent.LinkForm.sesskeys.value=SessionKey;

   SetCookie("BookTheatreReqVisitnoCookie",
             document.SelectPeriod.bkthvick.value);
   SetCookie("BookTheatreReqReqnumCookie",
             document.SelectPeriod.bkthrqck.value);
   SetCookie("TheatreRequestRedirect",
             document.SelectPeriod.bkthrdck.value);
   parent.LinkForm.submit();
   DFrameExit();
 }
}
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link   
//  1 - Session Date & Time
//  2 - Surgeon
//  3 - Anaesthetist
//  4 - Theatre
//  5 - Session Type(Cat-ST)
//  6 - Status
//  7 - Booking Graph 0 - 120
//  8 - Available Min
//  9 - Booked Min
// 10 - Actual Min
// 17 - Session Type(Cat-TU)
//---------------------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
 t = new Table(1,0,2,"100%","center",25,25);
 t.addColumn("Session","DateTime",1,1,"left","AppointmentIcon.gif","0",140)
 t.addColumn("Surgeon","String",2,2,"left","","",150)
 t.addColumn("Theatre","String",4,4,"left","","",150)
 t.addColumn("Session Type","String",17,17,"left","","",120)
 AddTableRows()
 TableOutput(1,1);
 break; }
case 1: {
 t = new Table(1,0,2,"100%","center",35,25);
 t.addColumn("Session","DateTime",1,1,"left","AppointmentIcon.gif","0",140)
 t.addColumn("Anaesthetist","String",3,3,"left","","",150)
 t.addColumn("Theatre","String",4,4,"left","","",150)
 t.addColumn("Avail. Op Min","String",8,8,"right","","",45)
 t.addColumn("Booked Op Min","String",9,9,"right","","",45)
 t.addColumn("Actual Op Min","String",10,10,"right","","",45)
 AddTableRows()
 TableOutput(1,1);
 break; }
 }

  if (document.all.BodyDivision!=undefined) {
     BodyDivision.style.height=document.body.clientHeight - 70 -
                               BodyDivision.offsetTop
  }

}
function GetTheatreRequestCookies() {
  if (GetCookieData("BookTheatreReqUrnumberCookie")!="unknown") {
    document.SelectPeriod.bkthurck.value=
    GetCookieData("BookTheatreReqUrnumberCookie");
  }
  ExpireCookiePath("BookTheatreReqUrnumberCookie");

  if (GetCookieData("BookTheatreReqVisitnoCookie")!="unknown") {
    document.SelectPeriod.bkthvick.value=
    GetCookieData("BookTheatreReqVisitnoCookie");
  }
  ExpireCookiePath("BookTheatreReqVisitnoCookie");

  if (GetCookieData("BookTheatreReqReqnumCookie")!="unknown") {
    document.SelectPeriod.bkthrqck.value=
    GetCookieData("BookTheatreReqReqnumCookie");
  }
  ExpireCookiePath("BookTheatreReqReqnumCookie");

  if (GetCookieData("TheatreRequestRedirect")!="unknown") {
    document.SelectPeriod.bkthrdck.value=
    GetCookieData("TheatreRequestRedirect");
  }
  ExpireCookiePath("TheatreRequestRedirect");
}
function SetTheatreRequestCookies() {
  SetCookie("BookTheatreReqUrnumberCookie",
            document.SelectPeriod.bkthurck.value);
  SetCookie("BookTheatreReqVisitnoCookie",
            document.SelectPeriod.bkthvick.value);
  SetCookie("BookTheatreReqReqnumCookie",
            document.SelectPeriod.bkthrqck.value);
  SetCookie("TheatreRequestRedirect",
            document.SelectPeriod.bkthrdck.value);
}
function AddEventToDate() {
  if (document.SelectPeriod.vyearmth != undefined) {
    document.SelectPeriod.vyearmth.onchange =
    function () { SetTheatreRequestCookies(); this.form.submit(); };
  }
  if (document.SelectPeriod.lastdate != undefined) {
    document.SelectPeriod.lastdate.onchange =
    function () { SetTheatreRequestCookies(); this.form.submit(); };
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);
              GetTheatreRequestCookies();AddEventToDate();">
<div id=HeadingSection>
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Theatre Session Search
</span>
<form name=SelectPeriod action=oprweb01.pbl method=get style=margin:0
 onsubmit="SetTheatreRequestCookies();">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=3>
<input type=hidden name=viewtype value="%OPRWEB01.02.011">
<input type=hidden name=doctcode value="%OPRWEB01.02.103">
<input type=hidden name=bkthurck value=" ">
<input type=hidden name=bkthvick value=" ">
<input type=hidden name=bkthrqck value=" ">
<input type=hidden name=bkthrdck value=" ">
<table border=0 cellpadding=3 cellspacing=0 width=100% bgcolor=#cccccc>
<tr>
  <td nowrap>
    <a href=javascript:InitTable(0)>
     <img src="../images/TableViewIcon.gif" class=Icon 
      alt="Default View" title="Default View" border=0></a>
    <a href=javascript:InitTable(1)>
     <img src="../images/TableViewIcon.gif" class=Icon 
      alt="Show Times" title="Show Times" border=0></a>&nbsp;&nbsp;&nbsp;
    Unit&nbsp;
    <select name=docttype id=docttype title="Unit"
     onchange="SetTheatreRequestCookies();SelectPeriod.submit(this);">
     <option value=" "> </option>
     %OPRWEB01.02.013
    </select>&nbsp;&nbsp;&nbsp;
    Doctor&nbsp;
    <select name=doctcode id=doctcode title="Doctor"
     onchange="SetTheatreRequestCookies();SelectPeriod.submit(this);">
     <option value="  "> </option>
     %OPRWEB01.02.012
    </select>
  </td>
  <td align=right>
    <input type=button value="<<" class=SmallButton title="Previous"
     onclick='SetTheatreRequestCookies();location.href="%OPRWEB01.02.002"'>
    %OPRWEB01.02.007
    <input type=button value=">>" class=SmallButton title="Next"
     onclick='SetTheatreRequestCookies();location.href="%OPRWEB01.02.001"'>
    &nbsp;
    <a href='javascript:SelectDateFrame();'>
     <img src="../images/DateLookup.gif" border=0
      alt="Select Date" title="Select Date" class=Icon></a>
    <a href='javascript:SetTheatreRequestCookies();SelectView("0");'>
     <img src="../images/DayIcon.gif" border=0
      alt="View Today" title="View Today" class=Icon></a>
    <a href='javascript:SetTheatreRequestCookies();SelectView("1");'>
     <img src="../images/WeekIcon.gif" border=0 
      alt="View This Week" title="View This Week" class=Icon></a>
    <a href='javascript:SetTheatreRequestCookies();SelectView("2");'>
     <img src="../images/MonthIcon.gif" border=0 
      alt="View This Month" title="View This Month" class=Icon></a>
  </td>
</tr>
</table>
</form>
</div>

<div id=TableLocation></div>

<script type="text/javascript">
function AddTableRows() {
%OPRWEB01.02.014.oprweb01.03.003
}
</script>
