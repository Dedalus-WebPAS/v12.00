<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="private">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/mrtweb02.js"></script>
<script type="text/javascript" src="../js/TheatreScreensHoverInfo.js"></script>
<script type="text/javascript">
var OperationDateTime=true; // Parameter to turn Operation Date + Time display
function init() {
  f = document.UpdateForm;
  AddItem();
  ChkHoldInv();
  DisWeight();
  setTimeout('SetFocusSTV()',100);
  ICU();
  Cpap(document.UpdateForm);
  DisCareType();
  if(document.UpdateForm.d_pvitype.value=="2") {
    if(document.getElementById('optitle')) {
      document.getElementById('optitle').innerHTML=
      "<font color=red>OUTPATIENT</font>"
    }
  }
  if(typeof(CodingDischargeStatus) != "undefined") {
    if(CodingDischargeStatus == true) {
      document.UpdateForm.ptecd008.className="SelectMed Mandatory";
    }
  }
  if (document.getElementById('ptcnoenc').value == "2" ) {
    WebInterface();
    if(GetCookieData("mrtweb02cf")=="1") {
      ExpireCookiePath("mrtweb02cf");
      EncInputFileExists(btnInitInstance);
    }
  }
  getPSDCookie();
  if(document.getElementById('ptcnhdps').value == "4"){
     document.getElementById('hrsicu03').maxLength=5;
  }
  if (f.mrcneaca.value=="1" || f.mrcneaca.value=="2") {
    document.getElementById('MissHdr').style.display = "";
    document.getElementById('MissDet').style.display = "";
    document.getElementById('MissUpdBut').style.display = "";
  } else {
    document.getElementById('MissHdr').style.visibility = "hidden";
    document.getElementById('MissDet').style.visibility = "hidden";
    document.getElementById('MissUpdBut').style.visibility = "hidden";
  }
}
function getUnplannedReadmission(){
  if(typeof NotUsingUnplannedReadmission != 'undefined'){
     if(NotUsingUnplannedReadmission=="1"){
        return;  //Don't care about entering value
     }
  }
  if(document.UpdateForm.hrsicu08.value!=""){
     return;  //Value entered
  }
  if(document.UpdateForm.unplread.value=="1"){
     alert("This patient's admission is a readmission within 28 days. Please\n" +
           "review this and the previous admission and complete the 'Unplanned\n" +
           "Readmission' field as appropriate.");
  }
}
function Codding() {
  f = document.UpdateForm;
  SetMissingDetails();

  if(f.hrsicu04!=undefined) {
    if((f.psageday.value <= f.ptcnbage.value) &&
       (f.hrsicu04.value) > 9999 ) {
      alert("Warning: Patient <= " + f.ptcnbage.value +
            " days and Admission weight >  9999g");
    }
  }
  if (!ValidateAss(UpdateForm)) { return; }
  if (!chkFormComplete(UpdateForm)) {return; }
  SubmitCodding()
}
function ShowMissingDetailComment() {
  f = document.UpdateForm;
  if (isWhitespace(f.mrpsfmt1.value)) {
    f.commflag.checked = false;
  }
  else {
    f.commflag.checked = true;
  }
 
  linkurl="mrtweb02.pbl?reportno=1&template=005" +
          "&urnumber=" + f.urnumber.value + "&admissno=" + f.admissno.value +
          "&retfield=commflag" + "&cdatafld=mrpsfmt1" 
  Left=(document.body.clientWidth-800)/2
  DFrameLink(linkurl,200,Left,800,200)
} 
function SetMissingCommentFlag(CflagFld,CdataFld,DataComm) {
  f = document.UpdateForm;
  var cflgCtrl = document.getElementById(CflagFld);
  var cdatCtrl = document.getElementById(CdataFld);
  if (cflgCtrl != undefined) {
    if (isWhitespace(DataComm)) {
      cflgCtrl.checked = false;
      cdatCtrl.value = "";
    }
    else {
      cflgCtrl.checked = true;
      cdatCtrl.value = DataComm;
    }
  }
}
function ShowStatusHistory() {
  f = document.UpdateForm;

  linkurl="mrtweb04.pbl?reportno=8&template=001" +
          "&urnumber=" + f.urnumber.value + "&admissno=" + f.admissno.value
  location.href=linkurl
}
</script>
</head>
%START.OF.PAGE
<body onLoad="PageLoad(event);getUnplannedReadmission();"
 onunload="BreakLock();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%MRTWEB02.01.003";
PatientVIS="%MRTWEB02.01.081";
PatientNAM="%MRTWEB02.01.002";
PatientSTA="%MRTWEB02.01.086.078";
PatientALT="%MRTWEB02.01.084";
PatientSEX="%MRTWEB02.01.019";
PatientDOB="%MRTWEB02.01.020";
PatientAGE="%MRTWEB02.01.021";
PatientLOC="%MRTWEB02.01.083";
PatientPRI="%MRTWEB02.01.086.066.1";
PatientUNT="%MRTWEB02.01.066.0";
DoctorCOD="%MRTWEB02.01.082.003";
DoctorNAM="%MRTWEB02.01.082.002";
PatientAID="%MRTWEB02.01.086.090";
PatientIND="%MRTWEB02.01.086.091";
PatientCUR="%MRTWEB02.01.086.092";
PatientCLC="%MRTWEB02.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%MRTWEB02.01.086.094";
PatientCDM="%MRTWEB02.01.086.095";
PatientVDH="%MRTWEB02.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>

<form name=UpdateForm action=mrtweb02.pbl method=post style="margin:0">
<input type=hidden name=reportno value=01>
<input type=hidden name=template value=001>
<input type=hidden name=updttype value="">
<input type=hidden name=urnumber value="%MRTWEB02.01.003">
<input type=hidden name=admissno value="%MRTWEB02.01.081">
<input type=hidden name=pripre value="%MRTWEB02.01.401">
<input type=hidden name=seqpre value="%MRTWEB02.01.402">
<input type=hidden name=compre value="%MRTWEB02.01.403">
<input type=hidden name=asspre value="%MRTWEB02.01.404">
<input type=hidden name=lofpre value="%MRTWEB02.01.405">
<input type=hidden name=dispre value="%MRTWEB02.01.406">
<input type=hidden name=oprpre value="%MRTWEB02.01.407">
<input type=hidden name=morpre value="%MRTWEB02.01.420">
<input type=hidden name=stateflg id=stateflg value="%MRTWEB02.01.422">
<input type=hidden name=wghtindc value="%MRTWEB02.01.410">
<input type=hidden name=oprtdate value="%MRTWEB02.01.416">
<input type=hidden name=oprttime value="%MRTWEB02.01.417">
<input type=hidden name=intubatn value="%MRTWEB02.01.426">
<input type=hidden name=hspbirth value="%MRTWEB02.01.110.3">
<input type=hidden name=usingicu value="%MRTWEB02.01.309">
<input type=hidden name=icubedtp value="%MRTWEB02.01.310.0">
<input type=hidden name=ccubedtp value="%MRTWEB02.01.310.2">
<input type=hidden name=mechwarn value="%MRTWEB02.01.428">
<input type=hidden name=diffhosp value="%MRTWEB02.01.415">
<input type=hidden name=override value="">
<input type=hidden name=mrcnclin value="%MRTWEB02.01.441">
<input type=hidden name=losofsty value="%MRTWEB02.01.431">
<input type=hidden name=usngcpap value="%MRTWEB02.01.430">
<input type=hidden name=usngecod value="%MRTWEB02.01.432">
<input type=hidden name=morbdesc value="%MRTWEB02.01.433">
<input type=hidden name=dischdte id=dischdte value="%MRTWEB02.01.434">
<input type=hidden name=hrsicu06 value="%MRTWEB02.01.304.1">
<input type=hidden name=cpyadmno value="">
<input type=hidden name=allwnpre>
<input type=hidden name=mrcnepsc value="%STANDARD.01.025.060.133.1.1">
<input type=hidden name=lockepno value="%MRTWEB02.01.449">
<input type=hidden name=adate value="%MRTWEB02.01.102">
<input type=hidden name=admistat value="%MRTWEB02.01.199.020">
<input type=hidden name=admisdes value="%MRTWEB02.01.104">
<input type=hidden name=unplread value="%MRTWEB02.01.457">
<input type=hidden name=d_pvitype value="%MRTWEB02.01.321">
<input type=hidden name=notmcler id=notmcler>
<input type=hidden name=mrcngrup id=mrcngrup value="%STANDARD.01.025.097.145.1.1">
<input type=hidden name=admnclss id=admnclss value="%MRTWEB02.01.112.3">
<input type=hidden name=ptcnbage value="%STANDARD.01.025.021.046.1.3">
<input type=hidden name=psageday value="%MRTWEB02.01.323">
<input type=hidden name=invchold value="%MRTWEB02.01.325">
<input type=hidden name=hinvcode value="%MRTWEB02.01.327.3">

<input type=hidden name=ckweight value="1">
<input type=hidden name=ptcnoenc id=ptcnoenc value="%STANDARD.01.025.079.092.1.1">
<input type=hidden name=webcoder id=webcoder value="%MRTWEB02.01.465">
<input type=hidden name=wbsehosp value="%STANDARD.01.032">
<input type=hidden name=dfprlst1 value="%MRTWEB02.01.504.1">
<input type=hidden name=dfprdsc1 value="%MRTWEB02.01.504.2">
<input type=hidden name=dfprlst2 value="%MRTWEB02.01.505.1">
<input type=hidden name=dfprdsc2 value="%MRTWEB02.01.505.2">
<input type=hidden name=dfprlst3 value="%MRTWEB02.01.506.1">
<input type=hidden name=dfprdsc3 value="%MRTWEB02.01.506.2">
<input type=hidden name=mrcndfpr value="%MRTWEB02.01.503">
<input type=hidden name=d_ptecd008 value="%MRTWEB02.01.306.1">
<input type=hidden name="d_mrcnpcld" id="d_mrcnpcld"
 value="%STANDARD.01.025.097.247.0.1">
<input type=hidden name=ptcnhdps value="%STANDARD.01.025.080.250.1.1"
id="ptcnhdps">
<input type=hidden name=mscom001 id=mscom001 value="%MRTWEB02.01.473">
<input type=hidden name=mscom002 id=mscom002 value="%MRTWEB02.01.474">
<input type=hidden name=mscom003 id=mscom003 value="%MRTWEB02.01.475">
<input type=hidden name=mscom004 id=mscom004 value="%MRTWEB02.01.476">
<input type=hidden name=mscom005 id=mscom005 value="%MRTWEB02.01.477">
<input type=hidden name=mscom006 id=mscom006 value="%MRTWEB02.01.478">
<input type=hidden name=mscom007 id=mscom007 value="%MRTWEB02.01.479">
<input type=hidden name=mscom008 id=mscom008 value="%MRTWEB02.01.480">
<input type=hidden name=mrcneaca id=mrcneaca
 value="%STANDARD.01.025.097.248.1.1">
<input type=hidden name=mrpsfmt1 id=mrpsfmt1 value="%MRTWEB02.01.483">
  <input type=hidden name=mrcnicct id=mrcnicct
   value="%STANDARD.01.025.097.249.1.1">
  <input type=hidden name=ckviscmt value="%MRTWEB02.01.331">
  <input type=hidden name=ckvismdt value="%MRTWEB02.01.320">

<table cellspacing=0 cellpadding=1 border=0 width=100%>
<tr><td class=HeadingCell align=center colspan=9>Associated Details</td>
    <td class="HeadingCell" id="optitle"></td></tr>

<tr><td class=DataLabel >Attendance</td>
    <td class=DataField >%MRTWEB02.01.444 - %MRTWEB02.01.445 </td>
    <td class=DataLabel >Length of Stay</td>
    <td class=DataField >%MRTWEB02.01.447 </td>
    <td class=DataLabel >Ward</td>
    <td class=DataField >%MRTWEB02.01.224 </td>
    <td class=DataLabel >Unit</td>
    <td class=DataField >%MRTWEB02.01.124.1 </td></tr>

<tr><td class=DataLabel>Episode No</td>
    <td><input type=text name=epscd001 size=2 maxlength=2
        class="Number Mandatory" title="Episode No" min=1 max=20 
        value="%MRTWEB02.01.413" onblur='CheckEps(epscd001);'></td>
    <td class=DataLabel>Hrs ICU </td>
    <td><input type=text name=hrsicu01 size=5 maxlength=5 class=Integer
        title="Hrs ICU" value="%MRTWEB02.01.301"></td>
    <td class=DataLabel>Hrs CCU</td>
    <td><input type=text name=hrsicu02 size=5 maxlength=5 class=Integer
        title="Hrs CCU" value="%MRTWEB02.01.302"></td>
    <td class=DataLabel>Hrs MV</td>
    <td><input type=text name=hrsicu03 id=hrsicu03 size=5 maxlength=5
        class=Integer title="Hrs MV" value="%MRTWEB02.01.303">
        <script type="text/javascript">
        if (document.getElementById('ptcnhdps').value == "3" ||
            document.getElementById('ptcnhdps').value == "4") {
          document.write("&nbsp;&nbsp;mins&nbsp;" + 
            "<input type=text name=hrsicu15 id=hrsicu15 " +
            "size=1 maxlength=2 class=Integer title='Mins MV'" +
            " value='%MRTWEB02.01.319'>");
        }
        </script>
    </td>
    <td class=DataLabel>Hrs NIV</td>
    <td><input type=text name=hrsicu10 size=5 maxlength=5 class=Integer 
        title="Hrs NIV" value="%MRTWEB02.01.313"></td></tr>

  <tr><td class=DataLabel>%STANDARD.01.017.KB</td>
      <td><select name=hrsicu09 class="SelectMed Mandatory" tabindex=1
           title="%STANDARD.01.017.KB">
          <option></option>
          %MRTWEB02.01.312.5
          </select></td>

      <td class=DataLabel>%STANDARD.01.017.CP</td>
      <td><select name=ptecd008 id=ptecd008 class=SelectMed 
           title="%STANDARD.01.017.CP">
          <option></option>
          %MRTWEB02.01.306.5
          </select></td>

      <td><div id=InvOnHold></div></td>
      <td colspan=3><div id=InvReasonHold1></div></td>

      <td><div id=WeightLabel></div></td>
      <td><div id=WeightField></div></td>

   </tr>

<tr><td class=DataLabel>%STANDARD.01.017.KO</td>
    <td><select id=hrsicu08 name=hrsicu08 class=SelectBig tabindex=3
         title="%STANDARD.01.017.KO">
        <option></option>
         %MRTWEB02.01.311.5
        </select>
    </td>
    <td id=MissHdr>Missing Details</td>
    <td id=MissDet rowspan=2>
      <table cellspacing=0 cellpadding=1 border=0 width=100% align=center>
      <tr>
        <td width=6% align=center class=DataLabel>1</td>
        <td width=6% align=center class=DataLabel>2</td>
        <td width=6% align=center class=DataLabel>3</td>
        <td width=6% align=center class=DataLabel>4</td>
        <td width=6% align=center class=DataLabel>5</td>
        <td width=6% align=center class=DataLabel>6</td>
        <td width=10% align=center class=DataLabel>&nbsp;</td>
        <td width=10% align=center class=DataLabel>Comment</td>
        <td width=44%>&nbsp;</td>
      </tr>
      <tr>
        <td align=center class=DataLabel>
          <input type=checkbox name=d_mscom001 value="0"
           onmouseover="showMouseOverText(MRCodingMissingDetails1);">
        </td>
        <td align=center class=DataLabel>
          <input type=checkbox name=d_mscom002 value="0"
           onmouseover="showMouseOverText(MRCodingMissingDetails2);">
        </td>
        <td align=center class=DataLabel>
          <input type=checkbox name=d_mscom003 value="0"
           onmouseover="showMouseOverText(MRCodingMissingDetails3);">
        </td>
        <td align=center class=DataLabel>
          <input type=checkbox name=d_mscom004 value="0"
           onmouseover="showMouseOverText(MRCodingMissingDetails4);">
        </td>
        <td align=center class=DataLabel>
          <input type=checkbox name=d_mscom005 value="0"
           onmouseover="showMouseOverText(MRCodingMissingDetails5);">
        </td>
        <td align=center class=DataLabel>
          <input type=checkbox name=d_mscom006 value="0"
           onmouseover="showMouseOverText(MRCodingMissingDetails6);">
        </td>
        <td align=center class=DataLabel>

          <img notab src="../images/MaintenanceIcon.gif" class=Icon
           onmouseover="showMouseOverText('Post Discharge Status History details');"
           onclick="ShowStatusHistory();">
        </td>
        <td align=center class=DataLabel>
          <input type=checkbox name=commflag id=commflag
           title="Click to maintain missing details comment" value="0"
           onclick="ShowMissingDetailComment();">
        </td>
        <td>&nbsp;</td>
      </tr>
      </table>
    </td>
    <td id=MissUpdBut>
      <input type=button class=button name='btnUptCom' id=btnUptCom
       value="Update"
       onclick="UpdatePostDischargeComment();">
    </td>
    <td ><div id=InvReasonHold2></div></td>
</tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td>&nbsp;</td>
    <td><div id=CareTypeLab></div></td>
    <td class=DataField><div id=CareTypeDes></div></td>
    <td>&nbsp;</td>
</tr>

</table>

<table cellspacing=0 cellpadding=1 border=0 width=100% align=center>
  <tr><td class=HeadingCell width=34% align=left>
    <img src=../images/DiagnosisSearchIcon.gif class=Icon border=0
    onclick='javascript:Icd10DisNext(UpdateForm.dischdte.value);'> 
    Diagnosis
    <img src=../images/ProcedureSearchIcon.gif class=Icon border=0
    onclick='javascript:Icd10ProNext(UpdateForm.dischdte.value);'> 
    Procedure
    &nbsp;&nbsp;&nbsp;
    Counter <input type=text name=countcod size=2 readonly>
    </td>
    <td class=HeadingCell align=center >
     ICD10 Coding </td>
    <td class=HeadingCell width=45% align=right>
    Coding Template
    <select name=mrcodtem 
     onchange='if (document.UpdateForm.hrsicu08.className=="Mandatory" &&
                   isWhitespace(document.UpdateForm.hrsicu08.value) &&
                   !isWhitespace(this.value)) 
               {alert("Unplanned Readmission is Mandatory.");
                this.selectedIndex=0;}
               else {TemplateSelect(this);}'
     class=SelectBig>
    <option></option>
     %MRTWEB02.01.411
    </select>
    </td></tr>
</table>

<div id=RecordCoding></div> 

<table cellspacing=0 cellpadding=1 border=0 width=95% align=center>
<tr><td colspan=5 align=center><br>
   <input type=button class="button" value="Ok" id=okbutton
    onclick='tempDisable(this,8);Codding();'>
   <span id=encbutts style="display: %MRTWEB02.01.436;">
   <input type=button class="button" value="Export Encoder"
    id="exbutton" onclick='tempDisable(this,5);Export();'>
   <input type=button class="button" value="Load Encoder"
    id="ldbutton" onclick='tempDisable(this,5);Encoder();'>
   </span> 

   <span id=tbobutts style="display: %MRTWEB02.01.469;">
   <input type=button class="button" value="Export TG"
    id="exportturbo" onclick='tempDisable(this);TurboExport();'>
   <input type=button class="button" value="Import TG"
    id="loadturbo" onclick='tempDisable(this);TurboLoad();'>
   </span>

   <input type=button class="button" value=Associated
     onclick='Associated();'> 
   <span id=cpbutt>
   <input type=button class="button" value=Copy 
    onclick="if (document.UpdateForm.hrsicu08.className=='Mandatory' &&
                 isWhitespace(document.UpdateForm.hrsicu08.value)) 
             {alert('Unplanned Readmission is Mandatory.');} else    
             {CopyCodesCheck();}">
   </span>
   <input type=button class="button" value=Cancel
    onclick='CancelButton();'>
   <input type=button class="button" value=CMBS
    onclick='DFrameLink("%MRTWEB02.01.001.patweb98.01.022",100,100,600,300);'>

   <span id=spnCommButt>
     <input type=button class=button name=CommButton
       value="Comments" style="width:100px"
       onclick='commentButtonClicked();'>
   </span>

   </td></tr>
</table>

<table cellspacing="0" width="100%" align=center>
<tr><td colspan="2"><input type="hidden" id="3MMessage" value="" size="137"
        readonly=""/>
        <input type="hidden" id="3MURL" value="%MRTWEB02.01.466">
        <input type="hidden" id="3MSession" value="%MRTWEB02.01.467">
        <input type="hidden" id="3MUser" value="%STANDARD.01.043"></td></tr>
</table>

</form>

  <iframe name="wcFrame" id="wcFrame" height="0" width="0"
   frameborder="0" style="display: none;"></iframe>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%MRTWEB02.01.003">
<input type=hidden name=admissno value="%MRTWEB02.01.081">
<input type=hidden name=epscd001 value="%MRTWEB02.01.413">
<input type=hidden name=MenuType value="%MRTWEB02.01.088">
</form>
<form name=MoveForm method=post action=mrtweb02.pbl>
<input type=hidden name=reportno value="3">
<input type=hidden name=template value="001">
<input type=hidden name=updttype value="">
<input type=hidden name=urnumber value="%MRTWEB02.01.003">
<input type=hidden name=admissno value="%MRTWEB02.01.081">
<input type=hidden name=epsoindc value="%MRTWEB02.01.308">
<input type=hidden name=nextpage value="5">
<input type=hidden name=redirect value="%MRTWEB02.01.001.mrtweb02.06.001">
<input type=hidden name=encoderf>
<input type=hidden name=mrcnautg id=mrcnautg
 value="%STANDARD.01.025.060.247.0.1">

<table cellspacing="0" width="100%" align=center>
<tr><td><textarea name="3MInput" id="3MInput" cols="50" rows="25"
         style="display:none">%MRTWEB02.01.464 </textarea></td>
    <td><textarea name="3MOutput" id="3MOutput" cols="50" rows="25"
         style="display:none">
        </textarea></td></tr>
</table>

</form>
</div>

<span id=DispOnHold style="display:none">
    <input type=button class="button" value="On Hold"
     onclick="OnHold();">
</span>

<span id=DispHoldDes1 style="display:none">
    <font color=red>%MRTWEB02.01.326.0</font>
</span>

<span id=DispHoldDes2 style="display:none">
    <font color=red>%MRTWEB02.01.326.1</font>
</span>

<span id=showweightlabel style="display:none">Adm. Weight</span> 
<span id=showweightfield style="display:none">
      <input type=text name=hrsicu04 size=6 maxlength=6 
       class="Number Mandatory" title="Admission Weight" tabindex=2 
       value="%MRTWEB02.01.412">gm
</span> 

<span id=showCareType style="display:none">Care Type</span>
<span id=showCareTypeDes style="display:none">%MRTWEB02.01.446.0</span>

<script type="text/javascript">

f = document.UpdateForm; 
if (document.getElementById('mrcngrup').value == "2" ) {
  document.getElementById('encbutts').style.display = "none";
  document.getElementById('cpbutt').style.display = "none";
}
if(f.mscom001.value=="1") {
  f.d_mscom001.checked=1;
}
if(f.mscom002.value=="1") {
  f.d_mscom002.checked=1;
}
if(f.mscom003.value=="1") {
  f.d_mscom003.checked=1;
}
if(f.mscom004.value=="1") {
  f.d_mscom004.checked=1;
}
if(f.mscom005.value=="1") {
  f.d_mscom005.checked=1;
}
if(f.mscom006.value=="1") {
  f.d_mscom006.checked=1;
}
if(!isWhitespace(f.mrpsfmt1.value)) {
  f.commflag.checked=1;
}

ShowCodingCommentButton();

function UpdatePostDischargeComment() {
  f = document.UpdateForm;
  SetMissingDetails();

  if(f.hrsicu04!=undefined) {
    if((f.psageday.value <= f.ptcnbage.value) &&
       (f.hrsicu04.value) > 9999 ) {
      alert("Warning: Patient <= " + f.ptcnbage.value +
            " days and Admission weight >  9999g");
    }
  }

  if (!ValidateAss(UpdateForm)) { return; }

  SubmitUpdateNoCodding();
}

function SubmitUpdateNoCodding() {
  f = document.UpdateForm;
  pripre = f.pripre.value;
  compre = f.compre.value;
  stateflg = f.stateflg.value;
  var hospbith=f.hspbirth.value.substr(14,1);

  // Now do Admission Warnings if within Age Range!
  if (f.wghtindc.value=="1") { // Age Range Parameter
    if (!isWhitespace(f.hrsicu04.value)) {
      weight=parseInt(f.hrsicu04.value,10); //Convert to an Int!
      if ((weight >= "1000") && (weight <= "2499")) {
        WarnWght=true;
        for (var i=0; i < f.length; i++) {
          if (f.elements[i].name.match(/mricd/)) {
            if (f.elements[i].value.match(/P07.1/)) {
              WarnWght=false; break; }
            if (f.elements[i].value.match(/P07.3/)) {
              WarnWght=false; break; }
            if (f.elements[i].value.match(/P05/)) {
              WarnWght=false; break; }
            if (f.elements[i].value.match(/P96.4/)) {
              WarnWght=false; break; }
            if (f.elements[i].value.match(/P01.8/)) {
              WarnWght=false; break; }
          }
        }
        if (WarnWght) {
          Continue=confirm('Warning: ' +
                       'Admission Weight b/w 1000-2499g, No Matching Disease\n'+
                       'Code. Please add a code of either P07.1*, P07.3*,' +
                       ' P05*, P96.4 or P01.8\n\n' +
                       'Click Ok if you want to Override Warning.\n')
          if (!Continue) { return false ;; }
        }
      }
      // Only do the following warning if Adm Source HDP="Y"-birth in hosp
      var hospbith = f.hspbirth.value.substr(14,1);
      if (hospbith=="Y") {
        if (weight > "6000") {
          WarnWght=true;
          for (var i=0; i < f.length; i++) {
            if (f.elements[i].name.match(/mricd/)) {
              if (f.elements[i].value.match(/P08.0/)) {
                WarnWght=false; break; }
              if (f.elements[i].value.match(/P08.1/)) {
                WarnWght=false; break; }
            }
          }
          if (WarnWght) {
            Continue=confirm('Warning: ' +
                         'Admission Weight > 6000g, No Matching Disease\n'+
                         'Code. Please add a code of either P08.0, P08.1\n\n' +
                         'Click Ok if you want to Override Warning.\n')
            if (!Continue) { return false ;; }
          }
        }
      }
    }
  }

//
//  CPAP(NIV) hrs error checking. Only for Victoria
//  usngcpap=1 : Patient is under 10 days of age at time of Admission
//
  if (stateflg=="3") {  // State flag 3=Vic
    if (f.usngcpap.value=="1") {  // Is flag set?
      if (!isWhitespace(f.hrsicu10.value)) {
        WarnCpap=false;
        for (var i=0; i < f.length; i++) {
          if (f.elements[i].name.match(/mricd/)) {
            if (f.elements[i].value.match(/Z38/)) {
              WarnCpap=true; break; }
          }
        }
        if (WarnCpap) {
            Continue=confirm('Warning: Healthy Newborn with NIV Duration.\n' +
                'NIV hrs exist and a Z38 code has been entered!');
            if (!Continue) { return false ;; }
        }
      }
    }
  }
//
//   Submit Form
//
  f.updttype.value="N";
  if (validateMandatoryNoRecordCoding(f)) {
    f.target="PopUpFrame";
    location.href='patweb98.pbl?reportno=02&template=001'; 
    f.submit();
  }

  return true;
}
function SetMissingDetails() {
  f = document.UpdateForm;
  if (f.d_mscom001.checked) {
    f.mscom001.value = "1";
  }
  else {
    f.mscom001.value = "0";
  }
  if (f.d_mscom002.checked) {
    f.mscom002.value = "1";
  }
  else {
    f.mscom002.value = "0";
  }
  if (f.d_mscom003.checked) {
    f.mscom003.value = "1";
  }
  else {
    f.mscom003.value = "0";
  }
  if (f.d_mscom004.checked) {
    f.mscom004.value = "1";
  }
  else {
    f.mscom004.value = "0";
  }
  if (f.d_mscom005.checked) {
    f.mscom005.value = "1";
  }
  else {
    f.mscom005.value = "0";
  }
  if (f.d_mscom006.checked) {
    f.mscom006.value = "1";
  }
  else {
    f.mscom006.value = "0";
  }
}
//========================================================================
// Function  : validateMandatory
//
// Operation : Check a each form input field
//             Mandatory Fields Defined with
//             class=Mandatory
//             title=string describing the field
// Example   :
// <select name=pattitle tabindex=1 class=Mandatory title="Patient Title">
//
//========================================================================
function validateMandatoryXX(theForm) {
  for (i=0; i<theForm.elements.length; i++) {
    el=theForm.elements[i];
//
// Ignore ICD10 Coding line data
//
    var icdfield = false;
    ename = el.name.substr(0,5);
    if (ename == "mripr" || ename == "mricd" || ename == "mride" ||
        ename == "oprcl" || ename == "oprdt" || ename == "oprst" ||
        ename == "opred" || ename == "oprbl") {
      icdfield = true;
    }
    if (icdfield = false) {
      if (el.className.match(/Integer/) && el.type=="text") {
        if (!checkInteger(el,el.title)) {
          return false
        }
      }
      if (el.className.match(/Number/) && el.type=="text") {
        if (!checkNumber(el)) {
          return false
        }
      }
      if (el.title.match(/Date/) && el.type=="text") {
        if (!checkDate(el,el.title)) {
          return false
        }
      }
      if (el.title.match(/Time/) && el.type=="text") {
        if (!checkTime(el,el.title)) {
          return false
        }
      }
      if (el.className.match(/Mandatory/)) {
        if (!checkString(el,el.title)) {
          return false
        }
      }
    }
  }
  return true;
}
</script>
