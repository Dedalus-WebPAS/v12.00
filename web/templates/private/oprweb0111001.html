<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="private">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb0111.js"></script>
%START.OF.PAGE
<script type="text/javascript" >
if("%STANDARD.01.025.119.182.0.1" == "1") {  // Episoft ptcnepis
  var src="../js/eAdmissionReg.js";
  var script = document.createElement("script");
               script.setAttribute("src", src);
               script.setAttribute("type", "text/javascript");
  document.getElementsByTagName("head")[0].appendChild(script);
}

function switchPresIll() {
  if (document.UpdateForm.presilsw.checked==true) {
    document.UpdateForm.operprv1.className="OECRequired";
    document.UpdateForm.mbsdesc1.className="OECRequired";
    document.UpdateForm.ptvis111.className="";
    document.UpdateForm.ptvis111.selectedIndex=0;
    document.UpdateForm.ptvis111.style.visibility="hidden";
    document.getElementById("catillab").style.display = 'none';
  } else {
    document.UpdateForm.operprv1.className="";
    document.UpdateForm.mbsdesc1.className="";
    if (!document.UpdateForm.ptvis111.disabled) {
      document.UpdateForm.ptvis111.className="OECRequired";
    }
    document.UpdateForm.ptvis111.style.visibility="visible";
    document.getElementById("catillab").style.display = '';
  }
}
function chkDOS(datefield) {
  if(!isWhitespace(datefield.value)){
    if(!ChkDateTime(UpdateForm.ptmis001,null,datefield,null)){
      alert(datefield.title+" cannot be before Admission Date");
      return false;
    }
  }
  return true;
}
function ItemCodeSearchFrame(ItemType,ItemCode,ItemDescription) {
  if (ItemType.value=="6") {
    MiscChargeSearchFrame(ItemCode,ItemDescription);
  }
  if (ItemType.value=="3") {
    MbsSearchFrame(ItemCode,ItemDescription);
  }
}
function validateItemCode(ItemType,ItemCode,ItemClam,ItemFund,ItemTabl,ItemDescription) {
  if (ItemType.value=="6") {
    validateMsc1(ItemCode,ItemClam,ItemFund,ItemTabl,ItemDescription);
  }
    if (ItemType.value=="3") {
    validateCode(4,ItemCode,ItemDescription);
  }
}
function mandatoryItemCode(ItemCode,DateofService,ServiceQuantity) {
  if(!isWhitespace(ItemCode.value)) {
    DateofService.className="Mandatory FutureDate";
    ServiceQuantity.className="Mandatory Integer";
  } else {
    DateofService.className="FutureDate";
    ServiceQuantity.className="Integer";
  }
}
function validateOECRequired(theForm) {
  for (i=0; i<theForm.elements.length; i++) {
    el=theForm.elements[i]
    if (el.className.match(/OECRequired/)) {
      if (!checkOECString(el,el.title)) {
         return false } }
    }
    if (isWhitespace(document.UpdateForm.patsurnm.value)) {
      alertOEC(document.UpdateForm.patsurnm);
      return false;
    }
    if (isWhitespace(document.UpdateForm.patgivnm.value)) {
      alertOEC(document.UpdateForm.patgivnm);
      return false;
    }
    if (isWhitespace(document.UpdateForm.patntdob.value)) {
      alertOEC(document.UpdateForm.patntdob);
      return false;
    }
    if (!isWhitespace(document.UpdateForm.ptvis111.value) &&
        !isWhitespace(document.UpdateForm.operprv1.value)) {
      alert("Both Presenting Illness Code and first MBS Code cannot be populated.");
      return;
    }
  return true;
}
function checkOECString (theField, s, emptyOK) {
  if (checkOECString.arguments.length == 2) emptyOK = false;
   if ((emptyOK == true) && (isEmpty(theField.value))) return true;
   if (isWhitespace(theField.value))
     return warnOECEmpty (theField, s);
   else return true;
}
function warnOECEmpty (theField, s) {
  alert("Patient OEC mandatory fields are incomplete. Request Not Processed.\n"
        + s + " is a required OEC field.\nPlease enter it now." )
  theField.focus()
  return false
}
function disableOECRequired() {
  if(document.UpdateForm.oecchbox.checked == true) {
     UpdateForm.ptvis111.disabled=true;
     UpdateForm.ptvis043.disabled=true;
     UpdateForm.ptmis020.disabled=true;
     UpdateForm.ptmis027.disabled=true;
//     UpdateForm.ptmis013.disabled=true;
//     UpdateForm.ptmis014.disabled=true;
     UpdateForm.ptmis013.readOnly=true;
     UpdateForm.ptmis014.readOnly=true;
     UpdateForm.ptmis030.disabled=true;
     UpdateForm.ptvis076.disabled=true;
//     UpdateForm.ptmis015.disabled=true;
     UpdateForm.ptmis015.readOnly=true;
     UpdateForm.ptmis001.disabled=true;
     UpdateForm.ptmis002.disabled=true;
     UpdateForm.ptelg014.className="OECRequired";
     UpdateForm.ptelg033.className="OECRequired";
     UpdateForm.admdteicon.disabled=true;
     UpdateForm.curtimeicon.disabled=true;
     UpdateForm.admtmeicon.disabled=true;
     UpdateForm.hlthfndicon.disabled=true;
     UpdateForm.hlthfnderase.disabled=true;
  }
}
function OECRequired() {
  if(document.UpdateForm.oecchbox.checked == true) {
     if (UpdateForm.ptvis111.className=="Mandatory") {
       UpdateForm.ptvis111.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptvis111.className="OECRequired";  //Presenting Illness
     }
     if (UpdateForm.ptvis043.className=="Mandatory") {
       UpdateForm.ptvis043.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptvis043.className="OECRequired";  //Intended Stay
     }
     if (UpdateForm.ptmis020.className=="Mandatory") {
       UpdateForm.ptmis020.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis020.className="OECRequired";  //Diagnosis
     }
     if (UpdateForm.ptmis027.className=="Mandatory") {
       UpdateForm.ptmis027.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis027.className="OECRequired";  //Claim Type
     }
     if (UpdateForm.ptmis013.className=="Mandatory") {
       UpdateForm.ptmis013.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis013.className="OECRequired";  //Health Fund Code
     }
     if (UpdateForm.ptmis014.className=="Mandatory") {
       UpdateForm.ptmis014.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis014.className="OECRequired";  //Health Fund Code
     }
     UpdateForm.ptmis030.className="OECRequired Integer";    //Planned Length
     UpdateForm.ptvis076.className="OECRequired";            //Discharge Inten
     UpdateForm.ptmis015.className="OECRequired";            //Member Nunber
     UpdateForm.ptmis001.className="OECRequired Mandatory Date";
     UpdateForm.ptmis002.className="OECRequired Mandatory ";
     UpdateForm.ptelg014.className="OECRequired";
     UpdateForm.ptelg033.className="OECRequired";
  }
}
function defTypeOECFields() {
//  if (document.UpdateForm.adstat.value=="1") {
//    OECRequired();
//  }
  if (document.UpdateForm.adstat.value=="2") {
    disableOECRequired();
  } else {
    OECRequired();
  }
}
function checkTableadm() {
  if(!isWhitespace(document.UpdateForm.ptmis013.value)) {
    document.UpdateForm.ptmis014.className="Mandatory";
  } else {
    document.UpdateForm.ptmis014.value="";
    document.UpdateForm.ptmis014.className="";
    document.UpdateForm.tabldesc.value="";
  }
}
function defaultOECFields() {
  for (var i =0 ; i < document.UpdateForm.ptvis111.length; i++) {
    if (document.UpdateForm.ptvis111.options[i].value.substring(0,3)==
        document.UpdateForm.presill.value.substring(0,3)){
          document.UpdateForm.ptvis111.selectedIndex=i;
    }
  }
  for (var i =0 ; i < document.UpdateForm.ptvis043.length; i++) {
    if (document.UpdateForm.ptvis043.options[i].value.substring(0,3)==
        document.UpdateForm.intdstay.value.substring(0,3)){
          document.UpdateForm.ptvis043.selectedIndex=i;
    }
  }
  for (var i =0 ; i < document.UpdateForm.ptelg014.length; i++) {
    if (document.UpdateForm.ptelg014.options[i].value ==
        document.UpdateForm.peaindic.value){
          document.UpdateForm.ptelg014.selectedIndex=i;
    }
  }
  document.UpdateForm.ptmis030.value=trim(document.UpdateForm.ploastay.value);
  for (var i =0 ; i < document.UpdateForm.ptelg033.length; i++) {
    if (document.UpdateForm.ptelg033.options[i].value ==
        document.UpdateForm.emeradm.value){
          document.UpdateForm.ptelg033.selectedIndex=i;
    }
  }
  for (var i =0 ; i < document.UpdateForm.ptvis076.length; i++) {
    if (document.UpdateForm.ptvis076.options[i].value.substring(0,3)==
        document.UpdateForm.disinten.value.substring(0,3)){
          document.UpdateForm.ptvis076.selectedIndex=i;
    }
  }

  if (!isWhitespace(document.UpdateForm.hlthfnd.value)) {
    document.UpdateForm.ptmis013.value=trim(document.UpdateForm.hlthfnd.value);
  } else {
    document.UpdateForm.ptmis013.value=trim(document.UpdateForm.mastfnd.value);
  }

  validateCode(16,document.UpdateForm.ptmis013,document.UpdateForm.funddesc);
  checkTableadm();

  if (!isWhitespace(document.UpdateForm.hlthftbl.value)) {
    document.UpdateForm.ptmis014.value=trim(document.UpdateForm.hlthftbl.value);
  } else {
    document.UpdateForm.ptmis014.value=trim(document.UpdateForm.mastftbl.value);
  }

  validateHFT(20,document.UpdateForm.ptmis013,
                 document.UpdateForm.ptmis014,
                 document.UpdateForm.funddesc,
                 document.UpdateForm.tabldesc);
  document.UpdateForm.ptmis001.value=trim(document.UpdateForm.patadmdt.value);
  document.UpdateForm.ptmis002.value=trim(document.UpdateForm.bkrec005.value);

  if (!isWhitespace(document.UpdateForm.hlthfnmn.value)) {
    document.UpdateForm.ptmis015.value=trim(document.UpdateForm.hlthfnmn.value);
  } else {
    document.UpdateForm.ptmis015.value=trim(document.UpdateForm.mastfnmn.value);
  }

  for (var i =0 ; i < document.UpdateForm.ptmis027.length; i++) {
    if (document.UpdateForm.ptmis027.options[i].value.substring(0,3)==
        document.UpdateForm.patclaim.value.substring(0,3)){
          document.UpdateForm.ptmis027.selectedIndex=i;
    }
  }
  document.UpdateForm.ptmis020.value=trim(document.UpdateForm.diagno.value);
}
function ShowOECFields() {

  if (document.UpdateForm.oecchbox == undefined) {return;}

  if(document.UpdateForm.oecchbox.checked == true) {
    OECFields.innerHTML=oecfields.innerHTML;
    OECFields3.innerHTML=oecfields3.innerHTML;
    defaultOECFields();
    defTypeOECFields();
    if (!isWhitespace(document.UpdateForm.operprv1.value)) {
      document.UpdateForm.presilsw.checked=true;
      switchPresIll();
    }
  } else {
    document.UpdateForm.operprv1.className="";
    document.UpdateForm.mbsdesc1.className="";
    OECFields.innerHTML=blanklabel.innerHTML;
    OECFields3.innerHTML=blanklabel.innerHTML;
  }
}
function CheckAdmisChBox() {
//  if (document.UpdateForm.adstat.value!="1" &&
//      document.UpdateForm.adstat.value!="2") {
//    alert("Patient OEC Consent: Booking must use a current pre-admission/admission.");
//    document.UpdateForm.oecchbox.checked=false;
//    return;
//  }
/////////
  ShowOECFields();
}
function CheckAdmis() {
//  if (document.UpdateForm.adstat.value!="1" &&
//      document.UpdateForm.adstat.value!="2") {
//    alert("Patient OEC Consent: Booking must use a current pre-admission/admission.");
//    document.UpdateForm.oecchbox.checked=false;
//    return;
//  }
/////////

  validateOEC();

/////////
//  ShowOECFields();
}
function validateOECHF() {

  if (isWhitespace(document.UpdateForm.ptmis013.value) &&
      document.UpdateForm.patclaim.value.substr(3,1) == 'H' ) {

    document.UpdateForm.oecchbox.checked=false;
    ShowOECFields();
    return;

  }

  if (isWhitespace(document.UpdateForm.ptmis013.value)) {return;}

  if (validateParticipantNoErrors(document.UpdateForm.ptmis013.value,"OEC")) {
//    document.UpdateForm.oecchbox.checked=true;
//    ShowOECFields();
//    OECRequired();
  } else {
    document.UpdateForm.oecchbox.checked=false;
    ShowOECFields();
//    OECRequired();
//    document.UpdateForm.oecchbox.disabled=true;
//    oecTitleDIV.innerHTML="";
//    oecChBoxDIV.innerHTML="";
  }

}
function validateOEC() {

  if (isWhitespace(document.UpdateForm.mastfnd.value) &&
      isWhitespace(document.UpdateForm.hlthfnd.value) &&
      document.UpdateForm.patclaim.value.substr(14,1) == 'P' ) {

    document.UpdateForm.oecchbox.checked=false;
    ShowOECFields();
    return;

  }

  if (validateParticipantNoErrors(document.UpdateForm.hlthfnd.value,"OEC")) {
    document.UpdateForm.oecchbox.checked=true;
    ShowOECFields();
//    OECRequired();
  } else {
    if (validateParticipantNoErrors(document.UpdateForm.mastfnd.value,"OEC")) {
      document.UpdateForm.oecchbox.checked=true;
      ShowOECFields();
//    OECRequired();
    } else {
      document.UpdateForm.oecchbox.checked=false;
      ShowOECFields();
//      OECRequired();
//      document.UpdateForm.oecchbox.disabled=true;
//      oecTitleDIV.innerHTML="";
//      oecChBoxDIV.innerHTML="";
    }
  }
}
function validateOECCL() {

  if (document.UpdateForm.oecchbox == undefined) {return};

  if (document.UpdateForm.ptmis013 != undefined) {
    if (isWhitespace(document.UpdateForm.ptmis013.value) &&
        document.UpdateForm.patclaim.value.substr(3,1) == 'H' ) {

      document.UpdateForm.oecchbox.checked=false;
      ShowOECFields();

    }
  } else {
    if (isWhitespace(document.UpdateForm.hlthfnd.value) &&
        document.UpdateForm.patclaim.value.substr(3,1) == 'H' ) {

      document.UpdateForm.oecchbox.checked=false;
      ShowOECFields();

    }
  }
}
function alertOEC(OECpmifield) {
  alert("Patient OEC mandatory fields are incomplete. Request Not Processed.\n"+
        OECpmifield.title+" is a required OEC PMI field.\n"+
        "Please enter it now.");
}

function RemoveQuote(Field) {
  Field.value=Field.value.replace(/\"/g,"");
}
function changeOperation(theForm) {
  for (var i = 0; i < theForm.operpref.length; i++) {
   if (theForm.operpref.options[i].selected == true) {
    theForm.elements["operdes1"].value=theForm.operpref.options[i].text }
  }
}
function changeAdmitDate(theForm) {
  for (var i = 0; i < theForm.patadmdt.length; i++) {
   if (theForm.patadmdt.options[i].selected == true) {
    theForm.elements["operdes3"].value="Admit:"+theForm.patadmdt.options[i].text }
  }
}
function CancelBooking(linkurl) {
  Left=(document.body.clientWidth-640)/2
  DFrameLink(linkurl,0,Left,640,290)
}
function Check() {

 if (document.UpdateForm.oecchbox != undefined) {
   if (document.UpdateForm.oecchbox.checked==true) {
     if (!validateOECRequired(document.UpdateForm)) {
       return;
     }
     if (!validateParticipant(document.UpdateForm.ptmis013.value,"OEC")) {
       return;
     }
   }
 }

  if (UpdateForm.deceased.value=="Yes") {
    var i=UpdateForm.bkrec028.selectedIndex
    if (UpdateForm.bkrec028.options[i].value.substr(28,1)!="D") {
      alert("Patient is Deceased.\n\n" +
            "Please correct care type to continue with booking");
      return;
    }
  }
  if (!validateMandatory(UpdateForm))
    return;
  UpdateForm.bkrec006.disabled=false
  UpdateForm.bkrec007.disabled=false
  UpdateForm.patadmdt.disabled=false
  UpdateForm.bkrec005.disabled=false

  if (UpdateForm.oes01007!=undefined) {
    if (!chkDOS(UpdateForm.oes01007)) {
      return;
    }
    if (!chkDOS(UpdateForm.oes02007)) {
      return;
    }
    if (!chkDOS(UpdateForm.oes03007)) {
      return;
    }
    if (!chkDOS(UpdateForm.oes04007)) {
      return;
    }
    if (!chkDOS(UpdateForm.oes05007)) {
      return;
    }
  }

  if (document.UpdateForm.opdausr1.disabled!=true) {
    document.UpdateForm.operusr1.value=
    document.UpdateForm.opdausr1.value.substr(0,3);
  }
  if (isWhitespace(UpdateForm.patadmdt.value)) {
    UpdateForm.redirect.value="oprweb01.pbl?reportno=04&template=001"+
                  "&caseuniq="+UpdateForm.caseuniq.value.replace(/ /g,"+")
    if(document.getElementById("ptcnepis").value=="1") { // Episoft ptcnepis
       postUpdateEAdmissionStatus();
    }

        if (document.UpdateForm.oecchbox != undefined) {
          if(document.UpdateForm.oecchbox.checked == true) {

            if (trim(document.UpdateForm.mastfnd.value) !=
                trim(document.UpdateForm.ptmis013.value) ||
                trim(document.UpdateForm.mastftbl.value) !=
                trim(document.UpdateForm.ptmis014.value) ||
                trim(document.UpdateForm.mastfnmn.value) !=
                trim(document.UpdateForm.ptmis015.value)) {

              if(confirm("Update Patient Master File Health Fund Details?")) {

                document.UpdateForm.ptmis013.disabled=false;
                document.UpdateForm.ptmis014.disabled=false;
                document.UpdateForm.ptmis015.disabled=false;

                document.UpdateForm.oecmindc.value="1";
              }

            }

            document.UpdateForm.bokrx039.value="1";
            document.UpdateForm.admisnum.value=document.PatientLinks.admissno.value;
          } else {
            document.UpdateForm.bokrx039.value="0";
          }
        }

    UpdateForm.submit();
    return;
  }
  if (ChkDateTime(UpdateForm.patadmdt,null,UpdateForm.bookdate,null)){
    UpdateForm.redirect.value="oprweb01.pbl?reportno=04&template=001"+
                  "&caseuniq="+UpdateForm.caseuniq.value.replace(/ /g,"+")
    if(document.getElementById("ptcnepis").value=="1") { // Episoft ptcnepis
       postUpdateEAdmissionStatus();
    }

        if (document.UpdateForm.oecchbox != undefined) {
          if(document.UpdateForm.oecchbox.checked == true) {
            document.UpdateForm.bokrx039.value="1";

            if (document.UpdateForm.adstat.value=="1" ||
                document.UpdateForm.adstat.value=="2") {
              document.UpdateForm.admisnum.value=
              document.PatientLinks.admissno.value;
            }

            if (trim(document.UpdateForm.mastfnd.value) !=
                trim(document.UpdateForm.ptmis013.value) ||
                trim(document.UpdateForm.mastftbl.value) !=
                trim(document.UpdateForm.ptmis014.value) ||
                trim(document.UpdateForm.mastfnmn.value) !=
                trim(document.UpdateForm.ptmis015.value)) {

              if(confirm("Update Patient Master File Health Fund Details?")) {

                document.UpdateForm.ptmis013.disabled=false;
                document.UpdateForm.ptmis014.disabled=false;
                document.UpdateForm.ptmis015.disabled=false;

                document.UpdateForm.oecmindc.value="1";
              }

            }

          } else {
            document.UpdateForm.bokrx039.value="0";
          }
        }

    UpdateForm.submit();
  } else {
    alert("Theatre Booking cannot be before Admission Date");
  }
}
function postUpdateEAdmissionStatus() {
  var admisnid = getQueryString('admisnid');
  if(!isWhitespace(admisnid)) {
    if(eAdmCookie!="unknown") {
      UpdateForm.redirect.value =eAdmCookie;
    }
  }
}
function checkWatEntry(){
  if (UpdateForm.bkrec006.value != "") {
    UpdateForm.bokrx002.focus()
  } else {
    UpdateForm.bkrec006.focus()
  }
}
function DisableIcon(field) {
  if (field.disabled == true) {
    alert(field.title+" is for display only")
    UpdateForm.bokrx002.focus()
  }
}
function ChkMBSBox1() {
 if (document.UpdateForm.d_mbsbox1.checked == true ) {
    document.UpdateForm.mbsbox1.checked = true
    ExtraMBS1.innerHTML=extrambs1.innerHTML;

    if (document.UpdateForm.d_mbsbox2.checked == true ) {
      document.UpdateForm.mbsbox1.disabled = true;
      document.UpdateForm.mbsbox2.checked = true
      ExtraMBS2.innerHTML=extrambs2.innerHTML;
    } else {
      document.UpdateForm.mbsbox2.checked = false
      ExtraMBS2.innerHTML=blanklabel.innerHTML;
    }
  } else {
    ExtraMBS1.innerHTML=blanklabel.innerHTML;
    ExtraMBS2.innerHTML=blanklabel.innerHTML;
  }
}
function ShowMBSFields1() {
  if(document.UpdateForm.mbsbox1.checked == true) {
    ExtraMBS1.innerHTML=extrambs1.innerHTML;
  } else {
    document.UpdateForm.operprv6.value="";
    document.UpdateForm.operprv7.value="";
    document.UpdateForm.operprv8.value="";
    document.UpdateForm.operprv9.value="";
    document.UpdateForm.operpr10.value="";
    ExtraMBS1.innerHTML=blanklabel.innerHTML;
  }
}
function ShowMBSFields2() {
  if(document.UpdateForm.mbsbox2.checked == true) {
    document.UpdateForm.mbsbox1.disabled = true;
    ExtraMBS2.innerHTML=extrambs2.innerHTML;
  } else {
    document.UpdateForm.mbsbox1.disabled = false;
    document.UpdateForm.operpr11.value="";
    document.UpdateForm.operpr12.value="";
    document.UpdateForm.operpr13.value="";
    document.UpdateForm.operpr14.value="";
    document.UpdateForm.operpr15.value="";
    ExtraMBS2.innerHTML=blanklabel.innerHTML;
  }
}
function portalBooking() {
  if(document.getElementById("ptcnepis").value=="1") { // Episoft ptcnepis
    OnlinePreadmission();
    eAdmPreList();
  }
}
//------------------------------------------------------------------------------
// Go Back on Cancel depending if eAdmission Cookie is set or not
//------------------------------------------------------------------------------
function chkeAdmGobck() {
  if(document.getElementById("ptcnepis").value=="1") { // Episoft ptcnepis
     var admisnid = getQueryString('admisnid');
     if (admisnid != undefined ) {
        if (isWhitespace(admisnid)) {
            history.go(-1);
        } else {
            if (eAdmCookie!="unknown") {
               getTop().content.location.href=eAdmCookie; 
            }
        }
     } else { history.go(-1); }
  } else {
    history.go(-1);
  }
}

function checkOECParameter() {
  if (document.UpdateForm.ptcnoect.value != "1") {
    oecTitleDIV.innerHTML="";
    oecChBoxDIV.innerHTML="";
    return;
  }
  CheckAdmis()
}

</script>
</head>
<body onload="PageLoad(event);checkWatEntry();UpdateForm.patclaim.focus();
      ChkMBSBox1();setTimeout('portalBooking()',700);checkOECParameter();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OPRWEB01.11.203";
PatientVIS="%OPRWEB01.11.281";
PatientNAM="%OPRWEB01.11.202";
PatientSTA="%OPRWEB01.11.286.078";
PatientALT="%OPRWEB01.11.284";
PatientSEX="%OPRWEB01.11.219";
PatientDOB="%OPRWEB01.11.220";
PatientAGE="%OPRWEB01.11.221";
PatientLOC="%OPRWEB01.11.283";
PatientPRI="%OPRWEB01.11.286.066.1";
PatientUNT="%OPRWEB01.11.266.0";
DoctorCOD="%OPRWEB01.11.282.003";
DoctorNAM="%OPRWEB01.11.282.002";
PatientAID="%OPRWEB01.11.286.090";
PatientIND="%OPRWEB01.11.286.091";
PatientCUR="%OPRWEB01.11.286.092";
PatientCLC="%OPRWEB01.11.286.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OPRWEB01.11.286.094";
PatientCDM="%OPRWEB01.11.286.095";
PatientVDH="%OPRWEB01.11.286.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>

<div id=PageBodySection>
 <form name=UpdateForm onSubmit="return validateMandatory(this);"
       action=oprweb01.pbl method=post style="margin:0">
  <input type=hidden name=reportno value=12>
  <input type=hidden name=template value=1>
  <input type=hidden name=casekeys value="%OPRWEB01.11.001">
  <input type=hidden name=caseuniq value="%OPRWEB01.11.710">
  <input type=hidden name=bookdate value="%OPRWEB01.11.102">
  <input type=hidden name=nextpage value="1">
  <input type=hidden name=redirect >
  <input type=hidden name=uvthindi value="1">
  <input type=hidden name=operusr1 value="%OPRWEB01.11.716.1">
  <input type=hidden name=currflag value="%OPRWEB01.11.067">
  <input type=hidden name=pthvflag value="%OPRWEB01.11.068">
  <input type=hidden name=opcnfdur value="%STANDARD.01.025.113.002.0.1">
  <input type=hidden name=deceased value="%OPRWEB01.11.233">
  <input type=hidden name=d_mbsbox1 value="">
  <input type=hidden name=d_mbsbox2 value="">
  <input type=hidden name=firstbok value="1">
  <input type="hidden" name="ptcnepis" id="ptcnepis"
   value="%STANDARD.01.025.119.182.0.1" />
  <input type=hidden name=admisnid id=admisnid value="%OPRWEB01.11.069">
  <input type=hidden name=showflag value="0">
  <input type=hidden name=adstat value="%OPRWEB01.11.999. 20">
  <input type=hidden name=intdstay value="%OPRWEB01.11.072. 42">
  <input type=hidden name=disinten value="%OPRWEB01.11.072. 42">
  <input type=hidden name=diagno value="%OPRWEB01.11.072. 44">
  <input type=hidden name=peaindic value="%OPRWEB01.11.072. 45">
  <input type=hidden name=emeradm value="%OPRWEB01.11.072. 46">
  <input type=hidden name=hlthfnd value="%OPRWEB01.11.072. 48">
  <input type=hidden name=hlthftbl value="%OPRWEB01.11.072. 49">
  <input type=hidden name=hlthfnmn value="%OPRWEB01.11.072. 50">

  <input type=hidden name=mastfnd value="%OPRWEB01.11.240.0">
  <input type=hidden name=mastftbl value="%OPRWEB01.11.241.0">
  <input type=hidden name=mastfnmn value="%OPRWEB01.11.242">

  <input type=hidden name=ploastay value="%OPRWEB01.11.072. 51">
  <input type=hidden name=bokrx039>
  <input type=hidden name=presill value="%OPRWEB01.11.072. 53">
  <input type="hidden" name="patsurnm"
         title="Patient Surname" value="%OPRWEB01.11.209">
  <input type="hidden" name="patgivnm"
         title="Patient Given Name" value="%OPRWEB01.11.210">
  <input type="hidden" name="patntdob"
         title="Patient Date of Birth" value="%OPRWEB01.11.220">
  <input type="hidden" name="medicrdn"
         title="Medicare Card Number" value="%OPRWEB01.11.227">
  <input type="hidden" name="medicrdr"
         title="Medicare Card Reference Number" value="%OPRWEB01.11.285.049">
<input type=hidden name=ptcnoect value="%STANDARD.01.025.128.196.0.1">
 <input type=hidden name=admisnum>
  <input type=hidden name=oecmindc value=" ">

<table border="0" cellpadding="0" cellspacing="0" width="100%" align=center>
   <tr><td align=center class=HeadingCell>Update Booking Form</td></tr>
</table>

  <table border="0" cellpadding="0" cellspacing="0" width="95%" align=center>
   <tr><td width=15% class=DataLabel>Surgeon   </td>
       <td><a href='javascript:DoctorViewFrame("%OPRWEB01.11.104.003")'>
             <strong>%OPRWEB01.11.104.002 &nbsp;</strong></a></td>
       <td width=15%>Anaesthetist   </td>
       <td><a href='javascript:DoctorViewFrame("%OPRWEB01.11.116.003")'>
              %OPRWEB01.11.116.002</a></td></tr>

   <tr><td class=DataLabel>Unit  </td>
       <td class=DataField> %OPRWEB01.11.113.0</td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td class=DataLabel>Theatre  </td>
       <td class=DataField> %OPRWEB01.11.114.0 </td>
       <td class=DataLabel>Session Type       </td>
       <td class=DataField>%OPRWEB01.11.169.0  </td></tr>

   <tr><td class=DataLabel>Date  </td>
       <td class=DataField>%OPRWEB01.11.106 %OPRWEB01.11.102</td>
       <td class=DataLabel>Time  </td>
       <td class=DataField> %OPRWEB01.11.103 to %OPRWEB01.11.108</td></tr>

   <tr><td colspan=4 align=center><hr></td></tr>

  <tr><td class=DataLabel></td>
      <td></td>
    <td><div id="oecTitleDIV"><strong>Patient OEC Consent</strong></div></td>
    <td><div id="oecChBoxDIV"><input type="checkbox" name="oecchbox" value="0"
                  onclick='CheckAdmisChBox();'></div></td>
      </tr>

   <tr><td class=DataLabel>Pre-Assesment</td>
       <td><input type=text name=bkrec006 id=bkrec006 
                  size=12 maxlength=11 class=""
                  value="%OPRWEB01.11.808" onblur="checkDate(this,'Date')"
                  title="Pre-Assesment Date" tabindex=1 >
             <img src=../images/DateLookup.gif border=0 hspace=4 align=absmiddle
                  onclick='javascript:DateLookupFrame(bkrec006)'
                  onFocus='javascript:DisableIcon(bkrec006)' tabindex=-1>
           Time
           <input type=text name=bkrec007 id=bkrec007 
                  size=7 title="Pre-Assesment Time"
                  tabindex=2 value="%OPRWEB01.11.809">
             <img src=../images/DateTimeStamp.gif  
                  border=0 hspace=4 align=absmiddle
                  onClick="SetCurrentDateTime(bkrec006,bkrec007);"
                  onFocus='javascript:DisableIcon(bkrec007)' tabindex=-1>
             <img src=../images/TimeLookup.gif border=0 hspace=4 align=absmiddle
                  onclick="TimeLookupFrame(bkrec007);"
                  onFocus='javascript:DisableIcon(bkrec007)' tabindex=-1></td>
       <td class=DataLabel>Confirmed Admission</td>
       <td><input type=text name=patadmdt id=patadmdt 
                  size=12 maxlength=11 tabindex=3
                  onblur="checkDate(this,'Date')" title="Confirmed Admission"
                  value="%OPRWEB01.11.806" class=Mandatory>
             <img src=../images/DateLookup.gif border=0 hspace=4 align=absmiddle
                  onclick='javascript:DateLookupFrame(patadmdt)'
                  onFocus='javascript:DisableIcon(patadmdt)' tabindex=-1>
           Time
           <input type=text name=bkrec005 id=bkrec005 
                  size=7 title="Admission Time"
                  value='%OPRWEB01.11.807' tabindex=4 class=Mandatory>
             <img src=../images/DateTimeStamp.gif  
                  border=0 hspace=4 align=absmiddle
                  onclick='javascript:SetCurrentDateTime(patadmdt,bkrec005)'
                  onFocus='javascript:DisableIcon(bkrec005)' tabindex=-1>
             <img src=../images/TimeLookup.gif border=0 hspace=4 align=absmiddle
                  onclick='javascript:TimeLookupFrame(bkrec005)'
                  onFocus='javascript:DisableIcon(bkrec005)' tabindex=-1></td></tr>

   <tr><td class=DataLabel>Admitting Point</td>
       <td><select name=bokrx003 title="Admitting Point" class=Mandatory tabindex=5>
            <option></option>
             %OPRWEB01.11.603.2
           </select></td>
       <td class=DataLabel>Planned Length of Stay </td>
       <td><input type=text name=bkrec033 size=4 maxlength=3 class=Integer
                  title="Planned Length of Stay" tabindex=6>(days)</td></tr>

   <tr><td class=DataLabel>Exp.Post Op Ward</td>
       <td><select name=bokrx002 title="Exp.Post Op Ward" tabindex=7>
            <option></option>
              %OPRWEB01.11.602.2
           </select></td></tr>

   <tr><td class=DataLabel>%STANDARD.01.017.P </td>
       <td><select name=bkrec019 title="%STANDARD.01.017.P " tabindex=8>
            <option></option>
              %OPRWEB01.11.823.2
          </select></td></tr>

   <tr><td class=DataLabel>%STANDARD.01.017.CL</td>
       <td><select name="patclaim" title="%STANDARD.01.017.CL" class=Mandatory
                   tabindex=9 onchange="validateOECCL();">
            <option></option>
              %OPRWEB01.11.827.9.1.10.2.X
           </select></td>
       <td class=DataLabel>Admission Source</td>
       <td><select name="bokrx031" title="Admission Source" tabindex=10>
            <option></option>
              %OPRWEB01.11.631.2
           </select></td></tr>

   <tr><td class=DataLabel>Anaesthetic Type</td>
       <td><select name="operanae" title="Anaesthetic" class=Mandatory
                tabindex=11>
            <option></option>
              %OPRWEB01.11.006.2
           </select></td>
       <td class=DataLabel> Duration </td>
       <td><div id=Duration></div></td></tr>

   <tr><td class=DataLabel>MBS Codes</td>
       <td><input type=text name=operprv1 size=9
              onblur='validateMBSCode(17,
                                      UpdateForm.operprv1,
                                      UpdateForm.mbsdesc1,
                                      UpdateForm.casekeys,
                                      UpdateForm.bookdate)'
              title="Expected MBS Item 1" tabindex=13>
           <input type=text class=ReadOnly readonly name=mbsdesc1 size=35
                  title="Expected MBS Item 1 Name "
                  value="%OPRWEB01.11.721.0" >
            <img src="../images/SearchIcon.gif"
              onClick="MbsSearchFrame(UpdateForm.operprv1,
                                      UpdateForm.mbsdesc1,
                                      UpdateForm.bookdate)"></td>
       <td class=DataLabel>%STANDARD.01.017.Y6</td>
       <td><select name=opdausr1 title="%STANDARD.01.017.Y6" tabindex=30>
            <option></option>
              %STANDARD.01.007.Y6
           </select></td></tr>

   <tr><td>&nbsp;</td>
       <td><input type=text name=operprv2 size=9
              onblur='validateCode(4,
                                   UpdateForm.operprv2,
                                   UpdateForm.mbsdesc2,
                                   UpdateForm.bookdate)'
              title="Expected MBS Item 2" tabindex=14>
           <input type=text readonly name=mbsdesc2 size=35
              title="Expected MBS Item 2 Name" class=ReadOnly
              value="%OPRWEB01.11.722.0">
            <img src="../images/SearchIcon.gif"
              onClick="MbsSearchFrame(UpdateForm.operprv2,
                                      UpdateForm.mbsdesc2,
                                      UpdateForm.bookdate)"></td>
       <td class=DataLabel>Infection Status </td>
       <td><select name="operknow" title="Infection Status" tabindex=31>
            <option></option>
              %OPRWEB01.11.740.2
           </select></td></tr>

   <tr><td>&nbsp;</td>
       <td><input type=text name=operprv3 size=9
              onblur='validateCode(4,
                                   UpdateForm.operprv3,
                                   UpdateForm.mbsdesc3,
                                   UpdateForm.bookdate)'
              title="Expected MBS Item 3" tabindex=15>
           <input type=text readonly name=mbsdesc3 size=35
              title="Expected MBS Item 3 Name" class=ReadOnly
              value="%OPRWEB01.11.723.0">
            <img src="../images/SearchIcon.gif"
              onClick="MbsSearchFrame(UpdateForm.operprv3,
                                      UpdateForm.mbsdesc3,
                                      UpdateForm.bookdate)"></td>
       <td class=DataLabel>%STANDARD.01.017.XE 1</td>
       <td><select name="opdea032" title="%STANDARD.01.017.XE 1" tabindex=32>
            <option></option>
              %OPRWEB01.11.745.2
           </select></td></tr>

<tr><td>&nbsp;</td>
       <td><input type=text name=operprv4 size=9 value="%OPRWEB01.11.070.001.0"
              onblur='validateCode(4,
                                   UpdateForm.operprv4,
                                   UpdateForm.mbsdesc4,
                                   UpdateForm.bookdate)'
              title="Expected MBS Item 4" tabindex=16>
           <input type=text readonly name=mbsdesc4 size=35 class=ReadOnly
              title="Expected MBS Item 4 Name" value="%OPRWEB01.11.070.001.1">
            <img src="../images/SearchIcon.gif"
              onClick="MbsSearchFrame(UpdateForm.operprv4,
                                      UpdateForm.mbsdesc4,
                                      UpdateForm.bookdate)"></td>
       <td class=DataLabel>%STANDARD.01.017.XE 2</td>
       <td><select name="opdea033" title="%STANDARD.01.017.XE 2" tabindex=33>
            <option></option>
             %OPRWEB01.11.746.2
           </select></td></tr>

<tr><td>&nbsp;</td>
       <td><input type=text name=operprv5 size=9 value="%OPRWEB01.11.070.002.0"
              onblur='validateCode(4,
                                   UpdateForm.operprv5,
                                   UpdateForm.mbsdesc5,
                                   UpdateForm.bookdate)'
              title="Expected MBS Item 5" tabindex=16>
           <input type=text readonly name=mbsdesc5 size=35 class=ReadOnly
              title="Expected MBS Item 5 Name" value="%OPRWEB01.11.070.002.1">
            <img src="../images/SearchIcon.gif"
              onClick="MbsSearchFrame(UpdateForm.operprv5,
                                      UpdateForm.mbsdesc5,
                                      UpdateForm.bookdate)"></td>
       <td class=DataLabel>%STANDARD.01.017.XE 3</td>
       <td><select name="opdea035" title="%STANDARD.01.017.XE 3" tabindex=34>
            <option></option>
              %OPRWEB01.11.749.2
           </select></td></tr>

   <tr><td>&nbsp;</td>
       <td>Show Extra MBS Codes
           <input type="checkbox" name="mbsbox1" value="0"
                  onclick='ShowMBSFields1();'></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td class=DataLabel>Full Description</td>
       <td><input type="text" size="55" maxlength=80 name="operdes1"
                  title="Operation Description 1" tabindex=16
                  onblur="RemoveQuote(this);"></td>
       <td class=DataLabel>Equipment Loaned</td>
       <td><select name="opdea034" title="Equipment Loaned" tabindex=35>
            <option></option>
             %OPRWEB01.11.747.2
           </select></td></tr>

   <tr><td>&nbsp;</td>
       <td><input type="text" size="55" maxlength=80 name="operdes2"
                  title="Operation Description 2" tabindex=17
                  onblur="RemoveQuote(this);"></td>
       <td class=DataLabel>Operating Unit</td>
       <td><select name=opdea036 title="Operating Unit" class="Mandatory"
                   tabindex=36>
            <option></option>
              %OPRWEB01.11.750.2
           </select></td></tr>

   <tr><td>&nbsp;</td>
       <td><input type="text" size="55" maxlength=80 name="operdes3"
                  title="Operation Description 2" onblur="RemoveQuote(this);"
                  tabindex=18> </td>
<td colspan=2 rowspan=5 valign=top><div id=OECFields3></div></td>
       </tr>

   <tr><td class=DataLabel>Prosthesis Required</td>
       <td><input type="text" size="40" maxlength=40 name=opercomm tabindex=19
                  title="Prosthesis Required" value='%OPRWEB01.11.728'></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td class=DataLabel>%STANDARD.01.017.CC</td>
       <td><select name=bkrec028 title="%STANDARD.01.017.CC" tabindex=20>
            <option></option>
             %STANDARD.01.007.CC
            </select></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr valign=top><td class=DataLabel>Comments
       <td><textarea wrap=hard cols=60 rows=3  tabindex=49
                      title="Comments"
                         name=opcom009>%OPRWEB01.11.743.009</textarea></td></tr>

   <tr><td colspan=3><div id=ExtraMBS1></div></td></tr>
   <tr><td colspan=3><div id=ExtraMBS2></div></td></tr>

   <tr><td colspan=4><div id=OECFields></div></td></tr>

   <tr><td colspan=4 align="center">
           <input type=button id="opr01sub" class="button" value="Ok" 
                  tabindex=50
                  onclick="tempDisable(this);Check();">
           <input type=button class="button" value="Cancel" tabindex=51
                  onclick="chkeAdmGobck();"></td></tr>
 </table>
</form>
</div>

<form name=PatientLinks method=get>
 <input type=hidden name=reportno value=9>
 <input type=hidden name=template value=002>
 <input type=hidden name=urnumber value="%OPRWEB01.11.203">
 <input type=hidden name=admissno value="%OPRWEB01.11.281">
 <input type=hidden name=MenuType value="%OPRWEB01.11.288">
 <input type=hidden name=casekeys value="%OPRWEB01.11.001">
</form>

<span id=SDuration style="display:none">
  <select name="operexpd" title="Operation Expected Duration" class=Mandatory
          tabindex=12>
    <option value=""></option>
    <option value="  10">10 min</option>
    <option value="  15">15 Min</option>
    <option value="  20">20 Min</option>
    <option value="  30">30 min</option>
    <option value="  40">40 min</option>
    <option value="  50">50 min</option>
    <option value="  60">60 min</option>
    <option value="  70">70 min</option>
    <option value="  80">80 min</option>
    <option value="  90">90 min</option>
    <option value=" 100">100 min</option>
    <option value=" 110">110 min</option>
    <option value=" 120">120 Min</option>
    <option value=" 130">130 min</option>
    <option value=" 140">140 min</option>
    <option value=" 150">150 min</option>
    <option value=" 160">160 min</option>
    <option value=" 170">170 min</option>
    <option value=" 180">180 min</option>
    <option value=" 190">190 min</option>
    <option value=" 200">200 min</option>
    <option value=" 210">210 min</option>
    <option value=" 220">220 min</option>
    <option value=" 230">230 min</option>
    <option value=" 240">240 min</option>
    <option value=" 250">250 min</option>
    <option value=" 260">260 min</option>
    <option value=" 270">270 min</option>
    <option value=" 280">280 min</option>
    <option value=" 290">290 min</option>
    <option value=" 300">300 min</option>
    <option value=" 310">310 min</option>
    <option value=" 320">320 Min</option>
    <option value=" 330">330 min</option>
    <option value=" 340">340 min</option>
    <option value=" 350">350 min</option>
    <option value=" 360">360 min</option>
    <option value=" 370">370 min</option>
    <option value=" 380">380 min</option>
    <option value=" 390">390 min</option>
    <option value=" 400">400 min</option>
    <option value=" 410">410 min</option>
    <option value=" 420">420 min</option>
    <option value=" 430">430 min</option>
    <option value=" 440">440 min</option>
    <option value=" 450">450 min</option>
    </select>
</span>

<span id=FDuration style="display:none">
  <input type=text name="operexpd" size=6 maxlength=4 min=0 tabindex=12
         title="Operation Expected Duration" class="Mandatory Integer"
         value="%OPRWEB01.11.038">
  (minutes)
</span>

<span id=extrambs1 style="display:none">
 <table border="0" cellpadding="0" cellspacing="0" width="92%">

   <tr><td class=DataLabel>Extra MBS Codes</td>
       <td><input type=text name=operprv6 size=9 value="%OPRWEB01.11.070.003.0"
              onblur='validateCode(4,
                                   UpdateForm.operprv6,
                                   UpdateForm.mbsdesc6,
                                   UpdateForm.bookdate)'
              title="Expected MBS Item 6" >
           <input type=text readonly name=mbsdesc6 size=30 tabindex=-1
              title="Expected MBS Item 6 Name" value="%OPRWEB01.11.070.003.1">
            <img src="../images/SearchIcon.gif"
              onClick="MbsSearchFrame(UpdateForm.operprv6,
                                      UpdateForm.mbsdesc6,
                                      UpdateForm.bookdate)"></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td>&nbsp;</td>
       <td><input type=text name=operprv7 size=9 value="%OPRWEB01.11.070.004.0"
              onblur='validateCode(4,
                                   UpdateForm.operprv7,
                                   UpdateForm.mbsdesc7,
                                   UpdateForm.bookdate)'
              title="Expected MBS Item 7" >
           <input type=text readonly name=mbsdesc7 size=30 tabindex=-1
              title="Expected MBS Item 7 Name" value="%OPRWEB01.11.070.004.1">
            <img src="../images/SearchIcon.gif"
              onClick="MbsSearchFrame(UpdateForm.operprv7,
                                      UpdateForm.mbsdesc7,
                                      UpdateForm.bookdate)"></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td>&nbsp;</td>
       <td><input type=text name=operprv8 size=9 value="%OPRWEB01.11.070.005.0"
              onblur='validateCode(4,
                                   UpdateForm.operprv8,
                                   UpdateForm.mbsdesc8,
                                   UpdateForm.bookdate)'
              title="Expected MBS Item 8" >
           <input type=text readonly name=mbsdesc8 size=30 tabindex=-1
              title="Expected MBS Item 8 Name" value="%OPRWEB01.11.070.005.1">
            <img src="../images/SearchIcon.gif"
              onClick="MbsSearchFrame(UpdateForm.operprv8,
                                      UpdateForm.mbsdesc8,
                                      UpdateForm.bookdate)"></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td>&nbsp;</td>
       <td><input type=text name=operprv9 size=9 value="%OPRWEB01.11.070.006.0"
              onblur='validateCode(4,
                                   UpdateForm.operprv9,
                                   UpdateForm.mbsdesc9,
                                   UpdateForm.bookdate)'
              title="Expected MBS Item 9" >
           <input type=text readonly name=mbsdesc9 size=30
              value="%OPRWEB01.11.070.006.1"
              title="Expected MBS Item 9 Name" tabindex=-1>
            <img src="../images/SearchIcon.gif"
              onClick="MbsSearchFrame(UpdateForm.operprv9,
                                      UpdateForm.mbsdesc9,
                                      UpdateForm.bookdate)"></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td>&nbsp;</td>
       <td><input type=text name=operpr10 size=9 value="%OPRWEB01.11.070.007.0"
              onblur='validateCode(4,
                                   UpdateForm.operpr10,
                                   UpdateForm.mbsdes10,
                                   UpdateForm.bookdate)'
              title="Expected MBS Item 10" >
           <input type=text readonly name=mbsdes10 size=30 tabindex=-1
              title="Expected MBS Item 10 Name" value="%OPRWEB01.11.070.007.1">
            <img src="../images/SearchIcon.gif"
              onClick="MbsSearchFrame(UpdateForm.operpr10,
                                      UpdateForm.mbsdes10,
                                      UpdateForm.bookdate)"></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td>&nbsp;</td>
       <td>Show Extra MBS Codes
           <input type="checkbox" name="mbsbox2" value="0"
                  onclick='ShowMBSFields2();'></td>
       <td colspan=2>&nbsp;</td></tr>

 </table>
</span>

<span id=extrambs2 style="display:none">
 <table border="0" cellpadding="0" cellspacing="0" width="92%">

   <tr><td class=DataLabel>Extra MBS Codes</td>
       <td><input type=text name=operpr11 size=9 value="%OPRWEB01.11.070.008.0"
              onblur='validateCode(4,
                                   UpdateForm.operpr11,
                                   UpdateForm.mbsdes11,
                                   UpdateForm.bookdate)'
              title="Expected MBS Item 11">
           <input type=text readonly name=mbsdes11 size=30
              value="%OPRWEB01.11.070.008.1"
              title="Expected MBS Item 1 Name" tabindex=-1>
            <img src="../images/SearchIcon.gif"
              onClick="MbsSearchFrame(UpdateForm.operpr11,
                                      UpdateForm.mbsdes11,
                                      UpdateForm.bookdate)"></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td>&nbsp;</td>
       <td><input type=text name=operpr12 size=9 value="%OPRWEB01.11.070.009.0"
              onblur='validateCode(4,
                                   UpdateForm.operpr12,
                                   UpdateForm.mbsdes12,
                                   UpdateForm.bookdate)'
              title="Expected MBS Item 12">
           <input type=text readonly name=mbsdes12 size=30
              value="%OPRWEB01.11.070.009.1"
              title="Expected MBS Item 12 Name" tabindex=-1>
            <img src="../images/SearchIcon.gif"
              onClick="MbsSearchFrame(UpdateForm.operpr12,
                                      UpdateForm.mbsdes12,
                                      UpdateForm.bookdate)"></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td>&nbsp;</td>
       <td><input type=text name=operpr13 size=9 value="%OPRWEB01.11.070.010.0"
              onblur='validateCode(4,
                                   UpdateForm.operpr13,
                                   UpdateForm.mbsdes13,
                                   UpdateForm.bookdate)'
              title="Expected MBS Item 13">
           <input type=text readonly name=mbsdes13 size=30
              value="%OPRWEB01.11.070.010.1"
              title="Expected MBS Item 13 Name" tabindex=-1>
            <img src="../images/SearchIcon.gif"
              onClick="MbsSearchFrame(UpdateForm.operpr13,
                                      UpdateForm.mbsdes13,
                                      UpdateForm.bookdate)"></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td>&nbsp;</td>
       <td><input type=text name=operpr14 size=9 value="%OPRWEB01.11.070.011.0"
              onblur='validateCode(4,
                                   UpdateForm.operpr14,
                                   UpdateForm.mbsdes14,
                                   UpdateForm.bookdate)'
              title="Expected MBS Item 14" >
           <input type=text readonly name=mbsdes14 size=30
              value="%OPRWEB01.11.070.011.1"
              title="Expected MBS Item 14 Name" tabindex=-1>
            <img src="../images/SearchIcon.gif"
              onClick="MbsSearchFrame(UpdateForm.operpr14,
                                      UpdateForm.mbsdes14,
                                      UpdateForm.bookdate)"></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td>&nbsp;</td>
       <td><input type=text name=operpr15 size=9 value="%OPRWEB01.11.070.012.0"
              onblur='validateCode(4,
                                   UpdateForm.operpr15,
                                   UpdateForm.mbsdes15,
                                   UpdateForm.bookdate)'
              title="Expected MBS Item 15" >
           <input type=text readonly name=mbsdes15 size=30
              value="%OPRWEB01.11.070.012.1"
              title="Expected MBS Item 15 Name" tabindex=-1>
            <img src="../images/SearchIcon.gif"
              onClick="MbsSearchFrame(UpdateForm.operpr15,
                                      UpdateForm.mbsdes15,
                                      UpdateForm.bookdate)"></td>
       <td colspan=2>&nbsp;</td></tr>

 </table>
</span>

<span id=oecfields style="display:none">
 <table border="0" cellpadding="1" cellspacing="0" width="100%">

  <tr><td class=DataLabel width=15%>Health Fund </td>
      <td>
         <input type=text size=6 maxlength=6 name=ptmis013
                title="Health Fund" class="IgnorePortalField"
                onblur="validateCode(16,document.UpdateForm.ptmis013,funddesc);
                checkTableadm();validateOECHF();">
          <input type=text size=25 maxlength=30 name=funddesc class=readonly
                  Readonly>
          Level
          <input name="ptmis014" size=8 maxlength=8 title="Level"
           class="IgnorePortalField"
                 onblur="validateHFT(20,ptmis013,ptmis014,funddesc,tabldesc);">
          <input type="text" size=15 maxlength=17 name="tabldesc"
                 class=readonly Readonly>
            <img src=../images/SearchIcon.gif class=Icon
                 border=0 hspace=0 align=absmiddle name=hlthfndicon
                 onclick="HealthFundSearchFrame(ptmis013,funddesc,
                                                ptmis014,tabldesc);">
            <img src="../images/erase.gif" align=absmiddle name=hlthfnderase
                 onclick="clrDoc(ptmis013,ptmis014);clrDoc(funddesc,tabldesc);
                  checkTableadm();validateOECHF();"></td></tr>

  <tr>
      <td class=DataLabel> Member Number </td>
      <td><input type=text size=20 maxlength=19 name=ptmis015
           class="IgnorePortalField"
           title="Member Number"></td></tr>

  <tr>
<td class=DataLabel>Diagnosis </td>
      <td><input type=text name="ptmis020" size=50 maxlength=80
          class="IgnorePortalField" title="Diagnosis"></td>
  </tr>

  <tr><td class=DataLabel> %STANDARD.01.017.VI </td>
      <td class=DataLabel>
          <select name=ptvis043 title="%STANDARD.01.017.VI"
           class="IgnorePortalField">
           <option> </option>
             %STANDARD.01.007.VI
          </select></td>
     <td class=DataLabel></td>
     <td></td></tr>

  <tr><td class=DataLabel> Planned Length of Stay</td>
       <td><input type=text size=5 maxlength=5 name=ptmis030
                  title='Planned Length of Stay'
                  class="Integer IgnorePortalField"
            onblur="checkInteger(this,this.value);"></td>
       <td class=DataLabel></td>
       <td></td></tr>

  <tr><td class=DataLabel>%STANDARD.01.017.CL</td>
      <td><select name=ptmis027 title="%STANDARD.01.017.CL"
           class="IgnorePortalField">
            <option> </option>
              %STANDARD.01.007.CL
              </select></td>
      <td class=DataLabel></td>
      <td></td></tr>

 </table>

 <table border=0 colspan=0 width=80% cellspacing=0 cellpadding=1>
  <tr><td colspan=4>&nbsp;</td></tr>

  <tr><td><b>Date</b></td>
      <td><b>Type</b></td>
      <td><b>Item / Description</b></td>
      <td><b>Quantity</b></td></tr>

  <tr><td width=20%>
         <input type=text size=12 name=oes01007 id=oes01007
                class="FutureDate" title="OES Service 1 Date"
                onblur=checkDate(this,this.title);>
           <img src=../images/DateTimeStamp.gif border=0 hspace=4
                align=absmiddle onclick="SetCurrentDateTime(UpdateForm.oes01007,null);">
           <img src=../images/DateLookup.gif border=0 hspace=4
               align=absmiddle onclick="DateLookupFrame(UpdateForm.oes01007);"></td>
      <td width=12%>
          <select name=oes01004 title="Type"
                 onchange="clrFields(oes01005,d_oes01005);
                 mandatoryItemCode(document.UpdateForm.oes01005,
                                   document.UpdateForm.oes01007,
                                   document.UpdateForm.oes01006);">
           <option value="6">Misc.Item</option>
           <option value="3">MBS Item</option>
          </select></td>
      <td><input type=text name=oes01005 title="Item Code" size=10
                 maxlength=10
                 onblur="validateItemCode(document.UpdateForm.oes01004,
                                          document.UpdateForm.oes01005,
                                          document.UpdateForm.ptmis027,
                                          document.UpdateForm.ptmis013,
                                          document.UpdateForm.ptmis014,
                                          document.UpdateForm.d_oes01005);
                 mandatoryItemCode(this,document.UpdateForm.oes01007,
                                        document.UpdateForm.oes01006);
                 document.UpdateForm.oes01006.value=1;
                 justifyRight(document.UpdateForm.oes01006);">
          <input type=text name=d_oes01005 size=50 readonly
                 class=Readonly tabindex=-1 title="Item Description">
            <img src="../images/SearchIcon.gif" class=Icon
                 onclick="ItemCodeSearchFrame(document.UpdateForm.oes01004,
                                              document.UpdateForm.oes01005,
                                              document.UpdateForm.d_oes01005);">
            <img src="../images/erase.gif"
                  onclick="clrFields(oes01005,d_oes01005);
                  mandatoryItemCode(document.UpdateForm.oes01005,
                                    document.UpdateForm.oes01007,
                                    document.UpdateForm.oes01006);"></td>
      <td><input type=text name=oes01006 title="Quantity" size=5 maxlength=3
                 onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
           </td></tr>

  <tr><td><input type=text size=12 name=oes02007 id=oes02007
                 class="FutureDate" title="OES Service 2 Date"
                 onblur=checkDate(this,this.title);>
            <img src=../images/DateTimeStamp.gif border=0 hspace=4
                 align=absmiddle onclick="SetCurrentDateTime(UpdateForm.oes02007,null);">
            <img src=../images/DateLookup.gif border=0 hspace=4
                 align=absmiddle onclick="DateLookupFrame(UpdateForm.oes02007);"></td>
      <td><select name=oes02004 title="Type"
                  onchange="clrFields(oes02005,d_oes02005);
                  mandatoryItemCode(document.UpdateForm.oes02005,
                                    document.UpdateForm.oes02007,
                                    document.UpdateForm.oes02006);">
           <option value="6">Misc.Item</option>
           <option value="3">MBS Item</option>
          </select></td>
      <td><input type=text name=oes02005 title="Item Code" size=10 maxlength=10
                 onblur="validateItemCode(document.UpdateForm.oes02004,
                                          document.UpdateForm.oes02005,
                                          document.UpdateForm.ptmis027,
                                          document.UpdateForm.ptmis013,
                                          document.UpdateForm.ptmis014,
                                          document.UpdateForm.d_oes02005);
                 mandatoryItemCode(this,document.UpdateForm.oes02007,
                                        document.UpdateForm.oes02006);
                                        document.UpdateForm.oes02006.value=1;
                 justifyRight(document.UpdateForm.oes02006);">
          <input type=text name=d_oes02005 size=50 readonly
                 class=Readonly tabindex=-1 title="Item Description">
            <img src="../images/SearchIcon.gif" class=Icon
                 onclick="ItemCodeSearchFrame(document.UpdateForm.oes02004,
                                              document.UpdateForm.oes02005,
                                              document.UpdateForm.d_oes02005);">
           <img src="../images/erase.gif" onclick="clrFields(oes02005,d_oes02005);
                mandatoryItemCode(document.UpdateForm.oes02005,
                                  document.UpdateForm.oes02007,
                                  document.UpdateForm.oes02006);"></td>
      <td><input type=text name=oes02006 title="Quantity" size=5 maxlength=3
                 onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
          </td></tr>

  <tr><td><input type=text size=12 name=oes03007 id=oes03007
                 class="FutureDate" title="OES Service 3 Date"
                 onblur=checkDate(this,this.title);>
            <img src=../images/DateTimeStamp.gif border=0 hspace=4
                 align=absmiddle onclick="SetCurrentDateTime(UpdateForm.oes03007,null);">
            <img src=../images/DateLookup.gif border=0 hspace=4
                 align=absmiddle onclick="DateLookupFrame(UpdateForm.oes03007);"></td>
      <td><select name=oes03004 title="Type"
                  onchange="clrFields(oes03005,d_oes03005);
                  mandatoryItemCode(document.UpdateForm.oes03005,
                                    document.UpdateForm.oes03007,
                                    document.UpdateForm.oes03006);">
           <option value="6">Misc.Item</option>
           <option value="3">MBS Item</option>
          </select></td>
      <td><input type=text name=oes03005 title="Item Code" size=10 maxlength=10
                 onblur="validateItemCode(document.UpdateForm.oes03004,
                                          document.UpdateForm.oes03005,
                                          document.UpdateForm.ptmis027,
                                          document.UpdateForm.ptmis013,
                                          document.UpdateForm.ptmis014,
                                          document.UpdateForm.d_oes03005);
                 mandatoryItemCode(this,document.UpdateForm.oes03007,
                                        document.UpdateForm.oes03006);
                                        document.UpdateForm.oes03006.value=1;
                justifyRight(document.UpdateForm.oes03006);">
         <input type=text name=d_oes03005 size=50 readonly
                class=Readonly tabindex=-1 title="Item Description">
           <img src="../images/SearchIcon.gif" class=Icon
                onclick="ItemCodeSearchFrame(document.UpdateForm.oes03004,
                                             document.UpdateForm.oes03005,
                                             document.UpdateForm.d_oes03005);">
           <img src="../images/erase.gif" onclick="clrFields(oes03005,d_oes03005);
                mandatoryItemCode(document.UpdateForm.oes03005,
                                  document.UpdateForm.oes03007,
                                  document.UpdateForm.oes03006);"></td>
      <td><input type=text name=oes03006 title="Quantity" size=5 maxlength=3
                 onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
          </td></tr>

  <tr><td><input type=text size=12 name=oes04007 id=oes04007
                 class="FutureDate" title="OES Service 4 Date"
                 onblur=checkDate(this,this.title);>
            <img src=../images/DateTimeStamp.gif border=0 hspace=4
                 align=absmiddle onclick="SetCurrentDateTime(UpdateForm.oes04007,null);">
            <img src=../images/DateLookup.gif border=0 hspace=4
                 align=absmiddle onclick="DateLookupFrame(UpdateForm.oes04007);"></td>
      <td><select name=oes04004 title="Type"
                  onchange="clrFields(oes04005,d_oes04005);
                  mandatoryItemCode(document.UpdateForm.oes04005,
                                    document.UpdateForm.oes04007,
                                    document.UpdateForm.oes04006);">
           <option value="6">Misc.Item</option>
           <option value="3">MBS Item</option>
          </select></td>
      <td><input type=text name=oes04005 title="Item Code" size=10 maxlength=10
                 onblur="validateItemCode(document.UpdateForm.oes04004,
                                          document.UpdateForm.oes04005,
                                          document.UpdateForm.ptmis027,
                                          document.UpdateForm.ptmis013,
                                          document.UpdateForm.ptmis014,
                                          document.UpdateForm.d_oes04005);
                 mandatoryItemCode(this,document.UpdateForm.oes04007,
                                        document.UpdateForm.oes04006);
                                        document.UpdateForm.oes04006.value=1;
                justifyRight(document.UpdateForm.oes04006);">
         <input type=text name=d_oes04005 size=50 readonly
                class=Readonly tabindex=-1 title="Item Description">
           <img src="../images/SearchIcon.gif" class=Icon
                onclick="ItemCodeSearchFrame(document.UpdateForm.oes04004,
                                             document.UpdateForm.oes04005,
                                             document.UpdateForm.d_oes04005);">
           <img src="../images/erase.gif" onclick="clrFields(oes04005,d_oes04005);
                mandatoryItemCode(document.UpdateForm.oes04005,
                                  document.UpdateForm.oes04007,
                                  document.UpdateForm.oes04006);"></td>
      <td><input type=text name=oes04006 title="Quantity" size=5 maxlength=3
                 onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
          </td></tr>

  <tr><td><input type=text size=12 name=oes05007 id=oes05007
                 class="FutureDate" title="OES Service 5 Date"
                 onblur=checkDate(this,this.title);>
            <img src=../images/DateTimeStamp.gif border=0 hspace=4
                 align=absmiddle onclick="SetCurrentDateTime(UpdateForm.oes05007,null);">
            <img src=../images/DateLookup.gif border=0 hspace=4
                 align=absmiddle onclick="DateLookupFrame(UpdateForm.oes05007);"></td>
      <td><select name=oes05004 title="Type"
                  onchange="clrFields(oes05005,d_oes05005);
                  mandatoryItemCode(document.UpdateForm.oes05005,
                                    document.UpdateForm.oes05007,
                                    document.UpdateForm.oes05006);">
           <option value="6">Misc.Item</option>
           <option value="3">MBS Item</option>
          </select></td>
      <td><input type=text name=oes05005 title="Item Code" size=10 maxlength=10
                 onblur="validateItemCode(document.UpdateForm.oes05004,
                                          document.UpdateForm.oes05005,
                                          document.UpdateForm.ptmis027,
                                          document.UpdateForm.ptmis013,
                                          document.UpdateForm.ptmis014,
                                          document.UpdateForm.d_oes05005);
                 mandatoryItemCode(this,document.UpdateForm.oes05007,
                                        document.UpdateForm.oes05006);
                                        document.UpdateForm.oes05006.value=1;
                justifyRight(document.UpdateForm.oes05006);">
          <input type=text name=d_oes05005 size=50 readonly
                 class=Readonly tabindex=-1 title="Item Description">
            <img src="../images/SearchIcon.gif" class=Icon
                 onclick="ItemCodeSearchFrame(document.UpdateForm.oes05004,
                                              document.UpdateForm.oes05005,
                                              document.UpdateForm.d_oes05005);">
            <img src="../images/erase.gif" onclick="clrFields(oes05005,d_oes05005);
                 mandatoryItemCode(document.UpdateForm.oes05005,
                                   document.UpdateForm.oes05007,
                                   document.UpdateForm.oes05006);"></td>
      <td><input type=text name=oes05006 title="Quantity" size=5 maxlength=3
                 onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
          </td></tr>
 </table>
</span>

<span id=oecfields3 style="display:none">
<table border=0 colspan=0 width=100% cellspacing=0 cellpadding=1>
  <tr><td class=DataLabel>Admission Date </td>
      <td><input type=text size=12 name=ptmis001 id=ptmis001
                 class="Mandatory Date IgnorePortalField"
                 title="Admission Date">
            <img src=../images/DateLookup.gif border=0 hspace=4
                 align=absmiddle onclick="DateLookupFrame(UpdateForm.ptmis001);"
                 name=admdteicon>
          Time
          <input class="Mandatory IgnorePortalField"
           type=text name=ptmis002 id=ptmis002 size=8
                 title="Admission Time">
            <img src=../images/DateTimeStamp.gif border=0 hspace=4
                 align=absmiddle onclick="SetCurrentDateTime(null,UpdateForm.ptmis002);"
                 name=curtimeicon>
            <img src=../images/TimeLookup.gif border=0 hspace=4
                 align=absmiddle
                 onclick="TimeLookupFrame(ptmis002);" name=admtmeicon></td>
      </tr>
<tr>
<td class=DataLabel width=31%>Discharge Intention</td>
      <td><select name=ptvis076 title="Discharge Intention" class="IgnorePortalField">
           <option> </option>
             %STANDARD.01.007.KN
          </select></td>
</tr>
<tr>
<td class=DataLabel> PEA Indicator </td>
     <td><select name=ptelg014 title="PEA Indicator"
          class="IgnorePortalField">
          <option value="0">No</option>
          <option value="1">Yes</option>
         </select></td>
</tr>
<tr>
<td class=DataLabel> Emergency Admission </td>
       <td><select name=ptelg033 title="Emergency Admission">
            <option value="0">No</option>
            <option value="1">Yes</option>
           </select></td>
</tr>
  <tr><td class=DataLabel><div id=catillab> %STANDARD.01.017.il </div></td>
      <td><select name=ptvis111  title="%STANDARD.01.017.il"
           class="IgnorePortalField">
           <option> </option>
             %STANDARD.01.007.il
          </select>
          <input type="checkbox" name="presilsw" value="1"
                 title="Presenting Illness MBS"
                 onclick="switchPresIll();"> &nbsp;
                 Switch to MBS Presenting Illness Number</td></tr>
</table>
</span>

<span id=blanklabel style="display:none">&nbsp;</span>

<script type="text/javascript">
if(document.UpdateForm.opcnfdur.value=="1") {
  Duration.style.display="";
  Duration.innerHTML=FDuration.innerHTML;
} else {
  Duration.style.display="";
  Duration.innerHTML=SDuration.innerHTML;
  for (var i =0 ; i < document.UpdateForm.operexpd.length; i++) {
    if (document.UpdateForm.operexpd.options[i].value=="%OPRWEB01.11.038") {
        document.UpdateForm.operexpd.selectedIndex=i } };
}
document.UpdateForm.bkrec033.value="%OPRWEB01.11.830" ;
document.UpdateForm.operprv1.value="%OPRWEB01.11.046" ;
document.UpdateForm.operprv2.value="%OPRWEB01.11.047" ;
document.UpdateForm.operprv3.value="%OPRWEB01.11.048" ;
document.UpdateForm.operdes1.value="%OPRWEB01.11.751" ;
document.UpdateForm.operdes2.value="%OPRWEB01.11.752" ;
document.UpdateForm.operdes3.value="%OPRWEB01.11.753" ;
for (var i =0 ; i < document.UpdateForm.patadmdt.length; i++) {
  if (document.UpdateForm.patadmdt.options[i].value=="%OPRWEB01.11.036") {
      document.UpdateForm.patadmdt.selectedIndex=i } };
for (var i =0 ; i < document.UpdateForm.opdausr1.length; i++) {
  if (document.UpdateForm.opdausr1.options[i].value.substr(0,3)==
      document.UpdateForm.operusr1.value) {
      document.UpdateForm.opdausr1.selectedIndex=i } };
if (document.UpdateForm.pthvflag.value=="0") {
    document.UpdateForm.opdausr1.className="readonly";
    document.UpdateForm.opdausr1.disabled=true;
   }
document.UpdateForm.patclaim.focus();
if ("%OPRWEB01.11.233" == "Yes") {
  UpdateForm.bkrec028.className="Mandatory";
} else {
  UpdateForm.bkrec028.className="";
}
if (UpdateForm.deceased.value=="No ") {
  acare="%OPRWEB01.11.913.1";
  if (!isWhitespace(acare)) {
    for (var i =0 ; i < document.UpdateForm.bkrec028.length; i++) {
       if (document.UpdateForm.bkrec028.options[i].value.substr(0,3)==acare) {
         document.UpdateForm.bkrec028.selectedIndex=i
       }
    }
  }
}
 if ("%OPRWEB01.11.769" == "1") {
     document.UpdateForm.d_mbsbox1.checked = false;
     document.UpdateForm.d_mbsbox2.checked = false;
 } else {
     document.UpdateForm.d_mbsbox1.checked = true;
     if ("%OPRWEB01.11.770" == "1") {
       document.UpdateForm.d_mbsbox2.checked = false;
     } else {
       document.UpdateForm.d_mbsbox2.checked = true;
     }
 }

</script>
