<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome"    content="tmc">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript" src="../js/preadmission.js"></script>
<script type="text/javascript" src="../js/ReportStandard.js"></script>

<script type="text/javascript">
function SubmitAdm() {
  MandatoryOk=true;
  if  (!validateMandatory(UpdateForm)) {
      return;
  }
  if (!isWhitespace(UpdateForm.ptmis013.value)) {
      if (!validateHFT(20,UpdateForm.ptmis013,UpdateForm.ptmis014,
                          UpdateForm.funddesc,UpdateForm.tabldesc)) {
         ans=confirm("Select another active health fund table? ");
         if (ans==true) {
            return;
         }
      }
  }
  if(document.UpdateForm.mvmedre1.checked == true) {
     document.UpdateForm.mvmedrec.value="1";
  } else {
     document.UpdateForm.mvmedrec.value="0";
  }
  if (MandatoryOk) {
    SetRedirect1();
    UpdateForm.ptmis004.value=UpdateForm.ptmis068.value;
    SubmitHidden(UpdateForm);
   }
}
function valDoctorUnit() {
  validateCode(31,UpdateForm.ptmis007,UpdateForm.doctnam2);
  selectOptions("30",UpdateForm.ptmis007,UpdateForm.ptmis024);
 UpdateForm.ptmis024.selectedIndex=1
}
function AdmitMandatory() {
 if(document.UpdateForm.admitbox.checked == true) {
     document.UpdateForm.admitbox.value="1";
     UpdateForm.ptmis011.className="Mandatory";  //admission type
     UpdateForm.ptmis009.className="Mandatory";  //admission source
     UpdateForm.ptmis012.className="Mandatory";  //care type
     UpdateForm.ptmis068.className="Mandatory";  //ward
     UpdateForm.ptmis005.className="mandatory";  //bed
     UpdateForm.ptmis007.className="Mandatory";  //Admitting Doctor
     UpdateForm.doctnam2.className="Mandatory";  //Admitting Doctor description
     UpdateForm.ptmis024.className="Mandatory";  //Unit
     UpdateForm.ptmis027.className="Mandatory";  //Financial Class
     UpdateForm.ptmis010.className="Mandatory";  //CMBS Class
     UpdateForm.ptvis043.className="Mandatory";  //Intended Stay
     UpdateForm.ptvis046.className="Mandatory";  //Admitting Point
  } else {
     document.UpdateForm.admitbox.value="0";
     UpdateForm.ptmis011.className="";  //admission type
     UpdateForm.ptmis009.className="";  //admission source
     UpdateForm.ptmis012.className="";  //care type
     UpdateForm.ptmis068.className="";  //ward
     UpdateForm.ptmis005.className="";  //bed
     UpdateForm.ptmis007.className="";  //Admitting Doctor
     UpdateForm.doctnam2.className="";  //Admitting Doctor description
     UpdateForm.ptmis024.className="";  //Unit
     UpdateForm.ptmis027.className="";  //Financial Class
     UpdateForm.ptmis010.className="";  //CMBS Class
     UpdateForm.ptvis043.className="";  //Intended Stay
     UpdateForm.ptvis046.className="";  //Admitting Point
  }
}
function SetRedirect1(){
    document.UpdateForm.redirect.value="patweb89.pbl?reportno=07&template=001"
     + "&urnumber=" + document.UpdateForm.urnumber.value
     + "&admissno=";
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);document.UpdateForm.ptmis001.focus();
              DisplayTrnSrc();defaultTMCFields();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.01.003";
PatientVIS="%PATWEB89.01.081";
PatientNAM="%PATWEB89.01.002";
PatientSTA="%PATWEB89.01.086.078";
PatientALT="%PATWEB89.01.084";
PatientSEX="%PATWEB89.01.019";
PatientDOB="%PATWEB89.01.020";
PatientAGE="%PATWEB89.01.021";
PatientLOC="%PATWEB89.01.083";
PatientPRI="%PATWEB89.01.086.066.1";
PatientUNT="%PATWEB89.01.066.0";
DoctorCOD="%PATWEB89.01.082.003";
DoctorNAM="%PATWEB89.01.082.002";
PatientAID="%PATWEB89.01.086.090";
PatientIND="%PATWEB89.01.086.091";
PatientCUR="%PATWEB89.01.086.092";
PatientCLC="%PATWEB89.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.01.086.094";
PatientCDM="%PATWEB89.01.086.095";
PatientVDH="%PATWEB89.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>

<form name=UpdateForm id=UpdateForm method=post action=patweb89.pbl>
<input type=hidden name=reportno id=reportno value="2">
<input type=hidden name=updatety id=updatety value="1">
<input type=hidden name=redirect id=redirect 
       value="%PATWEB89.01.001.patweb98.01.001">
<input type=hidden name=urnumber id=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno id=admissno value="%PATWEB89.01.101">
<input type=hidden name=allocate id=allocate value="1">
<input type=hidden name=chckname id=chckname value="0">
<input type=hidden name=emradmit id=emradmit value="0">
<input type=hidden name=emradmis id=emradmis value="0">
<input type=hidden name=admitnow id=admitnow value="1">
<input type=hidden name=newbmand id=newbmand value="0">
<input type=hidden name=agebmand id=agebmand value="0">
<input type=hidden name=ptmis004 id=ptmis004 value="0">
<input type=hidden name=mhadmflg id=mhadmflg value="1">
<input type=hidden name=mvmedrec id=mvmedrec>
<input type=hidden name=cfinan   id=cfinan   value="%PATWEB89.01.932">
<input type=hidden name=exstward id=exstward value="%PATWEB89.01.449.1">
<input type=hidden name=ptmis013 id=ptmis013 value="%PATWEB89.01.114.0">
<input type=hidden name=ptcnhdps id=ptcnhdps 
       value="%STANDARD.01.025.080.250.1.1">

<table border=0 width=100% cellspacing=1 cellpadding=1>
<tr><td class=HeadingCell align=center>
    Patient Pre-Admission Details(from Previous MH Details)
</td><tr>

<tr><td>
      <table border=0 width=100% class=TableBody cellpadding=0 cellspacing=0>
     <tr> <td>&nbsp;</td><td>&nbsp;</td>
         <td align=left><b>Admit Now?</b></td>
        <td align=left>
        <input type="checkbox" name="admitbox" id="admitbox" value="0" tabindex=26
           onclick='AdmitMandatory()'>
        </td></tr>

        <tr><td class=DataLabel>Admission Date</td>
            <td class=DataLabel><input type="text" size="12" tabindex=1
             name=ptmis001 id=ptmis001 value="%STANDARD.01.015" class=Mandatory 
             title="Admission Date" onblur="checkDate(this,'Admission Date')">
            <img src=../images/DateLookup.gif class=Icon
             onclick="DateLookupFrame(ptmis001);"> 
             Time <input type=text name=ptmis002 id=ptmis002 tabindex=2 size=8
                   value="%STANDARD.01.016" class=Mandatory title="Admission 
                    Time">
            <img src=../images/DateTimeStamp.gif class=Icon
             onclick="SetCurrentDateTime(null,ptmis002);">
            <img src=../images/TimeLookup.gif class=Icon
             onclick="TimeLookupFrame(ptmis002);"> 
            </td>

        <td class=DataLabel>Ward / Bed </td>
       <td><input type=hidden name=bedstat1 id=bedstat1>
         <input type=hidden name=warddesc id=warddesc>
         <select name=ptmis068 id=ptmis068 tabindex=12 title="Ward">
         <option> </option>
            %PATWEB89.01.449.2
         </select>
         <input type=text name=ptmis005 id=ptmis005 maxlength=3 size=3 
                title="Bed">
         <img src=../images/SearchIcon.gif class=Icon
         onclick="WardBedSearchFrame(ptmis068,warddesc,ptmis005,bedstat1);">
       </td></tr>

      <tr><td class=DataLabel>%STANDARD.01.017.P </td>
          <td><select name=ptmis011 id=ptmis011 tabindex=3  
               title="%STANDARD.01.017.P ">
              <option> </option>
                 %PATWEB89.01.112.2
              </select></td>

           <td class=DataLabel>Clinician on Admission</td>
            <td>
               <input type="text" size=8 maxlength=6 name="ptmis007" id="ptmis007" tabindex=13
                 value="%PATWEB89.01.108.003" 
                 title='Admitting Doctor'
                 onblur="UpCase(this);valDoctorUnit();">
               <input type=text readonly size=25 name=doctnam2 id=doctnam2
                 value="%PATWEB89.01.108.002">
               <img src="../images/SearchIcon.gif" class=Icon
                 onclick="DoctorSearchFrame(ptmis007,doctnam2)">
            </td></tr>

        <tr><td class=DataLabel>%STANDARD.01.017.S </td>
            <td><select name=ptmis009 id=ptmis009 tabindex=3 title="Admission Source"
                 onchange="DisplayTrnSrc()" 
             class=SelectBig>
                <option> </option>
                %PATWEB89.01.110.2
               </select>
            </td>
          <td class=DataLabel>%STANDARD.01.017.AC</td>
           <td><select name=ptmis024 id=ptmis024 tabindex=14
               title='%STANDARD.01.017.AC'>
               <option> </option>
                %PATWEB89.01.124.2
               </select>
           </td><tr>

      <tr><td><div id=TranSrcHeading></div></td>
          <td><div id=TranSrc></div></td>

        <td class=DataLabel>Referring Doctor</td>
        <td>
          <input type="text" size=10 maxlength=10 name="ptvis028" id="ptvis028" tabindex=17
               value="%PATWEB89.01.231.1"
               onblur="ValidateHCP(18,0,ptvis028,doctnam1);">
            <input type="text" size=25 readonly name="doctnam1" id="doctnam1"
               value="%PATWEB89.01.231.0">
            <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(UpdateForm.ptvis028,UpdateForm.doctnam1,0);">
      </td></tr>

      <tr><td class=DataLabel>%STANDARD.01.017.VI</td>
          <td><select name=ptvis043 id=ptvis043 tabindex=9 title="%STANDARD.01.017.VI">
          <option> </option>
          %PATWEB89.01.246.2
          </select>
          </td>

    <td class=DataLabel>Practice</td>
    <td><input type=text name=genpprac id=genpprac size=35 readonly
                 value="%PATWEB89.01.232.0">
          <input type=hidden name=ptvis029 id=ptvis029 value="%PATWEB89.01.232.1">
          <input type=hidden name=ptvis030 id=ptvis030 value="%PATWEB89.01.233.1">
          <input type=hidden name=genpprov id=genpprov value="">
          <img src="../images/SearchIcon.gif" class=Icon
    onclick="GPHCGSearchFrame(ptvis028,genpname,genpprov,ptvis029,genpprac,ptvis030)">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(ptvis029,genpprac,ptvis030,genpprov);">
     </td>
     </tr>

  <tr><td class=DataLabel>%STANDARD.01.017.KN</td>
      <td><select name=ptvis076 id=ptvis076 tabindex=8
           title="%STANDARD.01.017.KN" class=SelectBig>
          <option> </option>
           %PATWEB89.01.292.2
          </select></td>
          <td class=DataLabel>Admission Diagnosis </td>
          <td><input type=text name="ptmis020" id="ptmis020" size=50 maxlength=80 tabindex=15
               value="%PATWEB89.01.121"></td></tr>

<tr>
    <td class=DataLabel>%STANDARD.01.017.SG</td>
    <td><select name=ptvis101 id=ptvis101 tabindex=9 class=SelectBig
         title="%STANDARD.01.017.SG">
         <option></option>
          %PATWEB89.01.298.023.2
         </select></td>
          <td class=DataLabel>%STANDARD.01.017.KO</td>
          <td><select name=ptvis078 id=ptvis078 tabindex=13 class=SelectBig
           title="%STANDARD.01.017.KO">
          <option> </option>
           %PATWEB89.01.294.2
          </select></td>
</tr>

<tr>
    <td class=DataLabel>%STANDARD.01.017.SI</td>
    <td><select name=ptvis103 id=ptvis103 tabindex=10 class=SelectBig
         title="%STANDARD.01.017.SI">
         <option></option>
          %PATWEB89.01.298.025.2
         </select></td>
    <td class=DataLabel>%STANDARD.01.017.LS</td>
    <td><select name=ptvis074 id=ptvis074 tabindex=18 class=SelectBig
         title="%STANDARD.01.017.LS">
         <option></option>
          %PATWEB89.01.289.2
         </select></td>
</tr>

<tr>
    <td class=DataLabel>%STANDARD.01.017.SH</td>
    <td><select name=ptvis102 id=ptvis102 tabindex=11 class=SelectBig
         title="%STANDARD.01.017.SH">
         <option></option>
          %PATWEB89.01.298.024.2
         </select></td>
    <td class=DataLabel>%STANDARD.01.017.KG</td>
      <td><select name=ptvis077 id=ptvis077 tabindex=19
           title="%STANDARD.01.017.KG" class=SelectBig
           >
          <option> </option>
           %PATWEB89.01.293.2
          </select></td>
</tr>

<tr>
    <td class=DataLabel>%STANDARD.01.017.KD</td>
    <td><select name=ptvis104 id=ptvis104 tabindex=11 class=SelectBig
         title="%STANDARD.01.017.KD">
         <option></option>
          %PATWEB89.01.298.026.2
         </select></td>
    <td>Admitting Point</td>
    <td><select name=ptvis046 id=ptvis046 tabindex=19 title="Admitting Point"
         class=SelectBig onchange="defaultWard()">
         <option></option>
          %PATWEB89.01.290.2
        </select>
       </td></tr>

    <tr><td class=DataLabel> Planned Length of Stay</td>
        <td>
        <input type=text size=5 maxlength=5 name=ptmis030 id=ptmis030
         tabindex=10 title='Expected Length of Stay' value="%PATWEB89.01.129"
         class=Integer onblur="checkInteger(this,this.value);">
        </td></tr>

<tr align=left>
         <td align=center colspan="4">
         <hr>
         </td>
</tr>

   <tr align=left><td class=DataLabel>%STANDARD.01.017.CL</td>
       <td align=left><select name=ptmis027 id=ptmis027 tabindex=23
         title="%STANDARD.01.017.CL" onchange="defaultTMCFields();">
         <option> </option>
         %PATWEB89.01.126.9.1.10.2.X
         </select>
         </td>

    <td class=DataLabel>Health Fund</td>
    <td class=DataLabel colspan=2>
        <input type=text size=35 name="funddesc" id="funddesc" maxlength="30"
         value="%PATWEB89.01.114.1" notab readonly> Table
        <input type=hidden name="ptmis014" id="ptmis014" value="%PATWEB89.01.115.0">
        <input type="text" size=20 maxlength=30 name="tabldesc" id="tabldesc"
         value="%PATWEB89.01.115.1" notab readonly>
        <img src=../images/SearchIcon.gif class=Icon
         onclick="HealthFundSearchFrameNoFocus(ptmis013,funddesc,
                                               ptmis014,tabldesc);">
        <img src="../images/erase.gif" class=Icon
         onclick="clrDoc(funddesc,tabldesc);clrDoc(ptmis013,ptmis014);">
    </td>
</tr>

       <tr><td class=DataLabel>%STANDARD.01.017.A </td>
           <td><select name=ptmis010 id=ptmis010 tabindex=22 
                 title="%STANDARD.01.017.A ">
                <option> </option>
                 %PATWEB89.01.111.2
                </select>
           </td>
        <td class=DataLabel>Member Number &nbsp; </td>
        <td><input type=text size=20 maxlength=19 
        value="%PATWEB89.01.116" name='ptmis015' id='ptmis015' tabindex=24></td>

       <tr><td class=DataLabel>%STANDARD.01.017.CC</td>
            <td><select name=ptmis012 id=ptmis012 tabindex=8 class=SelectBig
                 title="%STANDARD.01.017.CC">
              <option> </option>
               %PATWEB89.01.113.2
            </select>
            </td>

          <td align=left>No of days of hosptilisation</td>
          <td><input type=text name=ptmis031 id=ptmis031 
            title='No of days of hospitalisation'
            class=Integer size=5 maxlength=3 tabindex=5
            onblur="checkInteger(this,this.title);" value="%PATWEB89.01.130">
         </td>
       </tr>

<tr>
      <td class=DataLabel>Casepayment Y/N</td>
      <td><select name=ptmis075 id=ptmis075 title="Casepayment Y/N"
           tabindex=33 >
          <option> </option>
           %PATWEB89.01.197.2
          </select>
        </td>
      <td class=DataLabel>GST Applicable</td>
      <td><select name=ptmis074 id=ptmis074 tabindex=53 >
          <option> </option>
           %PATWEB89.01.189.2
          </select>
        </td>
</tr>

<tr>
      <td class=DataLabel>Casemix Code</td>
          <td class=DataLabel>
       <input type=text name=ptmis073 id=ptmis073 size=10 maxlength=9 tabindex=34
              value="%PATWEB89.01.198.0"
               onblur='validateCode(35,ptmis073,cmixdesc1)'>
          <input type=text notab readonly name=cmixdesc1 id=cmixdesc1 size=35 
              value="%PATWEB89.01.198.1">
              <img notab src="../images/SearchIcon.gif" class=Icon
               onclick="CmixSearchFrame(ptmis073,cmixdesc1)">
          </td>
        <td align=left>Move Medical Record</td>
        <td align=left>
        <input type="checkbox" name="mvmedre1" id="mvmedre1" value="1" tabindex=53>
        </td>
</tr>

<tr><td class=DataLabel> Admission Comments </td>
<td colspan=6 align=left>
<textarea wrap=hard name=adcommnt id=adcommnt rows=4 cols=70 tabindex=60>
</textarea></td></tr>

    <tr align=left><td align=left> </td>
        <td align=left> </td>
    <tr align=left><td colspan=4 align=center><br>
         <input type=button value="Ok" class="button" tabindex=26
          id="pat89sub"
        onclick="tempDisable(this);checkBedStatus(UpdateForm.ptmis068.value,
                 UpdateForm.ptmis005.value,UpdateForm.ptmis001.value,
                 UpdateForm.ptmis030.value,SubmitAdm)">
       <input tabindex=27 type=button value="Cancel" class="button"
             onclick="PatientLinkTo('patweb98.pbl',1,1,0);">
    </table></td></tr>
</table>
</form>
</div>

<form name=linkForm id=linkForm action=patweb89.pbl method=post>
<input type=hidden name=reportno id=reportno value=1>
<input type=hidden name=template id=template value=1>
<input type=hidden name=urnumber id=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno id=admissno value="%PATWEB89.01.101">
</form>

<form name=PatientLinks id=PatientLinks method=get>
<input type=hidden name=reportno id=reportno value=1>
<input type=hidden name=template id=template value=004>
<input type=hidden name=urnumber id=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno id=admissno value="%PATWEB89.01.081">
<input type=hidden name=MenuType id=MenuType value="%PATWEB89.01.088">
</form>

<span id=WaitingList style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Date of Referral</td>
    <td><input type=text size=12 name=ptmis058 id=ptmis058 tabindex=18
         onblur="checkDate(this,'ReferralDate')">
         <img notab src=../images/DateLookup.gif class=Icon
          onclick="DateLookupFrame(ptmis058);"></td></tr>
<tr><td class=DataLabel>Date of 1st Spec Consult</td>
  <td><input type=text size=12 name=ptmis059 id=ptmis059 tabindex=19
         onblur="checkDate(this,'SpecConDate')">
    <img notab src=../images/DateLookup.gif class=Icon
          onclick="DateLookupFrame(ptmis059);"></td></tr>
</table>
</span>

<span id=BabyAge style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr>
  <td class=DataLabel width=37%>Admission Weight</td>
  <td>
   <input type=text name=ptmis051 id=ptmis051 size=8 maxlength=6 tabindex=20
    onchange="justifyRight(this);">grams</td></tr>
</table>
</span>

<span id=NewBorn style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Gestation Period</td>
  <td><input type=text name=ptmis041 id=ptmis041 maxlength=3 size=4 tabindex=21> weeks
    </td></tr>
</table>
</span>

<script type="text/javascript">
 if ("%PATWEB89.01.905" == "1") {
  alert("Warning: Patient is currently admitted");
 }
 if ("%PATWEB89.01.908" == "1") {
  alert("Warning: Patient has a pre-admission record");
 }
</script>

<span id=transferhd style="display:none">
Transfer Source
</span>

<span id=transfersrc style="display:none">
<input type="text" size=7 maxlength=5 name=trnsfsrc id=trnsfsrc class=Mandatory
 title="Transfer Source" tabindex=5 value="%PATWEB89.01.193.0"
 onchange="validateCode(9,trnsfsrc,trandesc);">
<input type=text size=27 name=trandesc id=trandesc notab
 class=Readonly readonly value="%PATWEB89.010193.1">
<img src="../images/SearchIcon.gif" class=Icon
 onclick="TransferSourceFrame(trnsfsrc,trandesc)">
</span>

<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc id=trnsfsrc>
</span>
