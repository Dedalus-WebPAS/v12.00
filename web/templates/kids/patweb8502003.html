<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="kids">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script language=javascript src=../js/TableSort.js></script>
<script type="text/javascript" src="../js/patweb85.js"></script>
<script type="text/javascript" src="../js/MrtLocations.js"></script>
<script type="text/javascript" src="../js/MrtMultiLocations.js"></script>
<script language=javascript>
function ReservFill(request){
if (document.SelectPeriod.viewtype.value==2) {
 linkurl="patweb85.pbl?reportno=5&template=001&viewtype=1" +
        "&requestn=" + request.replace(/ /g,"+") + 
        "&viewtype=" + document.SelectPeriod.viewtype.value.replace(/ /g,"+") +
        "&vyearmth=" + document.SelectPeriod.vyearmth.value.replace(/ /g,"+") +
        "&filledrc=" + document.SelectPeriod.filledrc.value.replace(/ /g,"+")
 }  
else {
 linkurl="patweb85.pbl?reportno=5&template=001" +
        "&requestn=" + request.replace(/ /g,"+") + 
        "&viewtype=" + document.SelectPeriod.viewtype.value.replace(/ /g,"+") +
        "&lastdate=" + document.SelectPeriod.lastdate.value.replace(/ /g,"+") +
        "&filledrc=" + document.SelectPeriod.filledrc.value.replace(/ /g,"+")
 }  
  location.href=linkurl
}
// ------------------------------------------------------------
// Columns Available
//  0 - HTML Link    
//  1 - Request No  
//  2 - Person Requesting Record
//  3 - Destination/Location Required
//  4 - Pers. Resp. Phone No/Extension No
//  5 - Pers. Resp. Pager No
//  6 - Number of Records Requested
//  7 - Date/Time Required
//  8 - Date/Time Requested          
//  9 - Comments
// 10 - Outstanding Requests Count
// ------------------------------------------------------------
function InitTable(TableView) {
  switch (TableView) {
   case 0: {
     document.title="Medical Records Bulk Request List"
     t = new Table(1,0,1,"100%","center");
     t.addColumn("Request No.","String",1,1,"left","MaintenanceIcon.gif","0",70)
     t.addColumn("Pers. Resp.","String",2,2,"left","","",80)
     t.addColumn("Destination","String",3,3,"","","",60)
     t.addColumn("Pers. Resp. Phone","String",4,4,"left","","",80)
     t.addColumn("Pers. Resp. Pager","String",5,5,"left","","",80)
     t.addColumn("No. of Req's","String",6,6,"center","","",45)
     t.addColumn("Outstanding","String",10,10,"center","","",50)
     t.addColumn("Date/Time Required","DateTime",7,7,"","","",90)
     t.addColumn("Date/Time Requested","DateTime",8,8,"","","",90)
     AddTableRows()
     TableOutput(0,1);    // Order Column,Asc Dsc
     break;
   }
 }
}
function SetHos() {
  SetFiltLocn(SelectPeriod);
}
function CheckHospital() {
  if (document.SelectPeriod.ibcnmhos.value=="1") {
     if (isWhitespace(document.SelectPeriod.filthosp.value)) {
         alert("A valid Hospital must be selected");
         return;
     }
  }
  document.SelectPeriod.dflthosp.value = document.SelectPeriod.filthosp.value;
  document.SelectPeriod.dfltlocn.value = document.SelectPeriod.filtlocn.value;
  reSubmit()
}
function reSubmit() {
// document.SelectPeriod.updatety.value="";
  document.SelectPeriod.submit();
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);SetHos();InitTable(0);">
<div id=HeadingSection>
 <form name=SelectPeriod action=patweb85.pbl method=get style="margin:0">
 <input type=hidden name=reportno value=2>
 <input type=hidden name=template value=3>
 <input type=hidden name=viewtype value="%PATWEB85.02.210">
 <input type=hidden name=mrtrecky>
 <input type=hidden name=urnumber>
 <input type=hidden name=showflag value="1">
 <input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
 <input type=hidden name=dflthosp value="%PATWEB85.02.134.0">
 <input type=hidden name=dfltlocn value="%PATWEB85.02.134.1">
 <input type=hidden name=usefiltr value=" ">
 <input type=hidden name=superlev value="%PATWEB85.02.135">

<table cellpadding=1 cellspacing=1 bgcolor=#CCCCCC border=1 width=100%>
<tr><td>
 <table cellpadding=1 cellspacing=1 bgcolor=#CCCCCC border=0 width=100%>
 <tr><td id="Hospital"></td>
   <td id="HospitalReq"></td>
   <td>Destination<br>
   <select name=filtlocn id=filtlocn onchange='CheckHospital()'>
   <option value="    ">All</option>
   </select></td>

   <td>Filled<br>
   <select name=filledrc id=filledrc onchange='this.form.submit()'>
    %PATWEB85.02.220
   </select></td>
   <td class=DataLabel align=right>
   <br><input type=button value="<<" class=smallbutton
    onclick='%PATWEB85.02.202'>
    %PATWEB85.02.207
    <input type=button value=">>" class=smallbutton
    onclick='%PATWEB85.02.201'>

   <a href='javascript:SelectDateFrame();'>
   <img src="../images/CalendarLookup.gif" border=0
    alt="Select Date" align=absmiddle></a>
   <a href='javascript:SelectView("0");'>
   <img src=../images/DayIcon.gif border=0
    alt="View Today" align=absmiddle></a>
   <a href='javascript:SelectView("1");'>
   <img src=../images/WeekIcon.gif border=0
    alt="View This Week" align=absmiddle></a>
   <a href='javascript:SelectView("2");'>
   <img src=../images/MonthIcon.gif border=0
    alt="View This Month" align=absmiddle></a>
   </td>
   </tr>

</table>
</td></tr>
</table>
</form>
</div>
<div id=TableLocation></div>

  <span id="ShowHomeHosp" style="display:none">
    Hospital<br />
    <select name="filthhos" id=filthhos title="Hospital" class="Mandatory"
     onchange="reSubmit();">
    <option value="   ">All</option>
    %PATWEB85.02.139
    </select>
  </span>

  <span id="ShowNoHomeHosp" style="display:none">
     <input type=hidden name=filthhos id=filthhos value="    ">
  </span>

  <span id="ShowRequHosp" style="display:none">
    Hospital Required<br />
    <select name=filthosp id=filthosp title="Hospital" class="Mandatory"
     onchange="SetFiltLocn(SelectPeriod);reSubmit();">
     <option value="    ">All</option>
    %PATWEB85.02.140
    </select>
  </span>

  <span id="ShowNoRequHosp" style="display:none">
     <input type=hidden name=filthosp id=filthosp value="    ">
  </span>

<script language="Javascript">
function AddTableRows() {
  %PATWEB85.02.232
}

var ibcnmhos=%STANDARD.01.025.000.043.1.1;
if (ibcnmhos=="1") {
  document.getElementById('Hospital').innerHTML=
    document.getElementById('ShowHomeHosp').innerHTML;
  document.getElementById('HospitalReq').innerHTML=
    document.getElementById('ShowRequHosp').innerHTML;
} else {
  document.getElementById('Hospital').innerHTML=
    document.getElementById('ShowNoHomeHosp').innerHTML;
  document.getElementById('HospitalReq').innerHTML=
    document.getElementById('ShowNoRequHosp').innerHTML;
}
</script>
