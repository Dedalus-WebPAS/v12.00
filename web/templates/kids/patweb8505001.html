<meta name="TemplateVersion" content="V12.00.00">
<meta name="TemplateHome" content="kids">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script language=javascript src=../js/TableSort.js></script>
<script language=javascript>
function ValidateMRTS() {
  var serverURL = "../cgi-bin/mrtweb04.pbl?reportno=6" +
                  "&valdmrts=" + SelectPeriod.mrtsecno.value.replace(/ /g,"+")

  var returnValue = RSExecute(serverURL);

  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    SelectPeriod.mrtsecid.value=ReturnValue[0];
    return true;
  } else {
    SelectPeriod.mrtsecno.select();
    return false }
}

function moveRecords() {
  if (validateMandatory(SelectPeriod)) {

    if (SelectPeriod.mrtsecno!=undefined) {
      ans=ValidateMRTS();
      if (ans==false) { return; }
    }
    document.SelectPeriod.submit();
  }
}

function UpdateFilled(CheckBox){

  if (!validateMandatory(SelectPeriod)) {
    if (CheckBox.checked) {
        CheckBox.checked=false; }
    else {
        CheckBox.checked=true; }
        return;
    }

    if (SelectPeriod.mrtsecno!=undefined) {
      ans=ValidateMRTS();
      if (ans==false) {
        if (CheckBox.checked) {
            CheckBox.checked=false; }
        else {
            CheckBox.checked=true; }
            return;
      }
    }
    UpdateSeque=1
    UpdateValue=0
    if (CheckBox.checked) {
       eval("can"+CheckBox.name.substr(3,4)).checked=false
       eval("prc"+CheckBox.name.substr(3,4)).checked=false
       UpdateValue=1 }
    var serverURL = "../cgi-bin/patweb85.pbl?reportno=3" +
                  "&mrtrecky=" + CheckBox.value.replace(/ /g,"+") +
                  "&checkbox=" + UpdateValue +
                  "&sequence=" + UpdateSeque +
                  "&mrtsecid=" + SelectPeriod.mrtsecid.value.replace(/ /g,"+") +
                  "&mrtsecno=" + SelectPeriod.mrtsecno.value.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) {
      ReturnCode.select();  }
}

function UpdateCancel(CheckBox){

  if (!validateMandatory(SelectPeriod)) {
    if (CheckBox.checked) {
        CheckBox.checked=false; }
    else {
        CheckBox.checked=true; }
        return;
    }

    if (SelectPeriod.mrtsecno!=undefined) {
      ans=ValidateMRTS();
      if (ans==false) {
        if (CheckBox.checked) {
            CheckBox.checked=false; }
        else {
            CheckBox.checked=true; }
            return;
      }
    }

    UpdateSeque=2
    UpdateValue=0
    if (CheckBox.checked) {
       eval("fil"+CheckBox.name.substr(3,4)).checked=false
       eval("prc"+CheckBox.name.substr(3,4)).checked=false
       UpdateValue=1 }
    var serverURL = "../cgi-bin/patweb85.pbl?reportno=3" +
                  "&mrtrecky=" + CheckBox.value.replace(/ /g,"+") +
                  "&checkbox=" + UpdateValue +
                  "&sequence=" + UpdateSeque +
                  "&mrtsecid=" + SelectPeriod.mrtsecid.value.replace(/ /g,"+") +
                  "&mrtsecno=" + SelectPeriod.mrtsecno.value.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) {
      ReturnCode.select();  }
}

function UpdateProgrs(CheckBox){

  if (!validateMandatory(SelectPeriod)) {
    if (CheckBox.checked) {
        CheckBox.checked=false; }
    else {
        CheckBox.checked=true; }
        return;
    }

    if (SelectPeriod.mrtsecno!=undefined) {
      ans=ValidateMRTS();
      if (ans==false) {
        if (CheckBox.checked) {
            CheckBox.checked=false; }
        else {
            CheckBox.checked=true; }
            return;
      }
    }

    UpdateSeque=3
    UpdateValue=0
    if (CheckBox.checked) {
       eval("can"+CheckBox.name.substr(3,4)).checked=false
       eval("fil"+CheckBox.name.substr(3,4)).checked=false
       UpdateValue=1 }
    var serverURL = "../cgi-bin/patweb85.pbl?reportno=3" +
                  "&mrtrecky=" + CheckBox.value.replace(/ /g,"+") +
                  "&checkbox=" + UpdateValue +
                  "&sequence=" + UpdateSeque +
                  "&mrtsecid=" + SelectPeriod.mrtsecid.value.replace(/ /g,"+") +
                  "&mrtsecno=" + SelectPeriod.mrtsecno.value.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) {
      ReturnCode.select();  }
}
function UpdateHeader(mrtkey,urno){
  SelectPeriod.reportno.value=2
  SelectPeriod.template.value=2
  SelectPeriod.mrtrecky.value=mrtkey
  SelectPeriod.urnumber.value=urno
  Left=(document.body.clientWidth-450)/2
  DFrameSubmit(SelectPeriod,100,Left,450,250)
}
function returnPrevious() {
if (document.SelectPeriod.viewtype.value==2) {
 linkurl="patweb85.pbl?reportno=2&template=003&" +                   
        "&viewtype=" + document.SelectPeriod.viewtype.value.replace(/ /g,"+") +
        "&vyearmth=" + document.SelectPeriod.vyearmth.value.replace(/ /g,"+") +
        "&filledrc=" + document.SelectPeriod.filledrc.value.replace(/ /g,"+")
 }                                                                             
else {
 linkurl="patweb85.pbl?reportno=2&template=003" +                              
        "&viewtype=" + document.SelectPeriod.viewtype.value.replace(/ /g,"+") +
        "&lastdate=" + document.SelectPeriod.lastdate.value.replace(/ /g,"+") +
        "&filledrc=" + document.SelectPeriod.filledrc.value.replace(/ /g,"+")
 }
  location.href=linkurl
}
// ------------------------------------------------------------
// Columns Available
//  0 - HTML Link    
//  1 - Request No  
//  2 - UR          
//  3 - Date/Time           
//  4 - Movement Reasion Description
//  5 - Current Location
//  6 - Destination    
//  7 - Volume Number 
//  8 - Filled Status
//  9 - Process    
// 10 - Filled           
// 11 - Cancel           
// 12 - Movement Reason Code      
// 13 - Patient Name     
// ------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
 document.title="Bulk Request Reservation Fill List For Request No : " +
                document.SelectPeriod.requestn.value;
 t = new Table(1,0,1,"100%","center");
 t.addColumn("UR No.","String",2,8,"left","MaintenanceIcon.gif","0",90)
// t.addColumn("UR No.","String",2,8,"center","","",50)
 t.addColumn("Patient Name","String",14,14,"left","","",160)
// t.addColumn("Date/Time","DateTime",3,3,"","","",98)
 t.addColumn("Reason","String",13,13,"left","","",45)
 t.addColumn("Destination","String",6,6,"","","",60)
 t.addColumn("Held by","String",9,9,"","","",60)
 t.addColumn("Current Location","String",5,5,"","","",60)
 t.addColumn("Vol.","String",7,7,"center","","",25)
 t.addColumn("Status","String",21,21,"center","","",60)
 t.addColumn("Process","String",10,10,"center","","",47)
 t.addColumn("Filled","String",11,11,"center","","",35)
 t.addColumn("Cancel","String",12,12,"center","","",40)
 AddTableRows()
 TableOutput(0,1);    // Order Column,Asc Dsc
 break;
 }
 }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);">
<div id=HeadingSection>
<form name=SelectPeriod action=patweb85.pbl method=get style="margin:0">
<input type=hidden name=reportno value=5>
<input type=hidden name=template value=1>
<input type=hidden name=viewtype value="%PATWEB85.05.210">
<input type=hidden name=vyearmth value="%PATWEB85.05.225">
<input type=hidden name=lastdate value="%PATWEB85.05.226">
<input type=hidden name=mrtrecky>
<input type=hidden name=urnumber>
<input type=hidden name=requestn value="%PATWEB85.05.001">
<input type=hidden name=mrtsecid value="">

<table cellpadding=1 cellspacing=1 bgcolor=#CCCCCC border=1 width=100%>
<tr><td>
<table cellpadding=1 cellspacing=1 bgcolor=#CCCCCC border=0 width=100%>
<tr><td>Filled<br>
   <select name=filledrc id=filledrc onchange='this.form.submit()'>
    %PATWEB85.05.220
   </select></td>
   <td align=center><br><input type=button value="Return to Request Summary" 
      onclick="returnPrevious();"></td>
   <td align=right class=DataLabel>MRT Security Number<br>
       <input type=password name=mrtsecno id=mrtsecno size=16 maxlength=8
        title="MRT Security Number" class=Mandatory
        onKeyDown="return TrapEnterKey();"></td>
   <td align=center><br><input type=button class=SmallButton value="Move"
       onclick="moveRecords();"></td>
</tr>
</table>
</td></tr>
</table>
</form>
</div>
<div id=TableLocation></div>

<script language="Javascript">
function AddTableRows() {
%PATWEB85.05.011
}
</script>
